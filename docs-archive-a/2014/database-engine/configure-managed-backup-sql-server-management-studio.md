---
title: Configurer la sauvegarde managée (SQL Server Management Studio) | Microsoft Docs
description: Utilisez la boîte de dialogue sauvegarde managée pour configurer le paramètre SQL Server sauvegarde managée sur Azure par défaut. En savoir plus sur les options que vous devez prendre en compte.
ms.custom: ''
ms.date: 08/23/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
f1_keywords:
- sql12.swb.managedbackup.configure.f1
ms.assetid: 79397cf6-0611-450a-b0d8-e784a76e3091
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: e952ef1102ac67bd0ed9f72d0c201d54b320b5ca
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600240"
---
# <a name="configure-managed-backup-sql-server-management-studio"></a><span data-ttu-id="8873e-104">Configuration de la sauvegarde managée (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="8873e-104">Configure Managed Backup (SQL Server Management Studio)</span></span>
  <span data-ttu-id="8873e-105">La boîte de dialogue **sauvegarde managée** permet de configurer les valeurs [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] par défaut pour l'instance.</span><span class="sxs-lookup"><span data-stu-id="8873e-105">The **Managed Backup** dialog allows you to configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] defaults for the instance.</span></span> <span data-ttu-id="8873e-106">Cette rubrique explique comment utiliser cette boîte de dialogue pour configurer les paramètres [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] par défaut de l'instance et les options à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="8873e-106">This topic describes how to use this dialog to configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] default settings for the instance and options you must consider when doing so.</span></span> <span data-ttu-id="8873e-107">Lorsque [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] est configuré pour l'instance, les paramètres sont appliqués aux nouvelles bases de données créées par la suite.</span><span class="sxs-lookup"><span data-stu-id="8873e-107">When [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] is configured for the instance, the settings are applied to any new database created thereafter.</span></span>  
  
 <span data-ttu-id="8873e-108">Si vous souhaitez configurer [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] pour une base de données spécifique, consultez [activer et configurer SQL Server sauvegarde managée sur Azure pour une base de données](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md#DatabaseConfigure).</span><span class="sxs-lookup"><span data-stu-id="8873e-108">If you want to configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for a specific database, see [Enable and Configure SQL Server Managed Backup to Azure for a Database](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md#DatabaseConfigure).</span></span>  
 
> [!NOTE] 
> <span data-ttu-id="8873e-109">La Gestion de sauvegarde SQL Server n’est pas prise en charge avec les serveurs proxy.</span><span class="sxs-lookup"><span data-stu-id="8873e-109">SQL Server Managed Backup is not supported with proxy servers.</span></span> 
  
## <a name="task-list"></a><span data-ttu-id="8873e-110">Liste des tâches</span><span class="sxs-lookup"><span data-stu-id="8873e-110">Task List</span></span>  
  
## <a name="ss_smartbackup-functions-using-managed-backup-interface-in-sql-server-management-studio"></a>[!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] <span data-ttu-id="8873e-111">Fonctions utilisant l’interface de sauvegarde managée dans SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="8873e-111">Functions Using Managed Backup Interface in SQL Server Management Studio</span></span>  
 <span data-ttu-id="8873e-112">Dans cette version, vous pouvez uniquement configurer des paramètres par défaut au niveau de l'instance à l'aide de l’interface de **gestion de sauvegarde**.</span><span class="sxs-lookup"><span data-stu-id="8873e-112">In this release, you can only configure instance level default settings using the **Management Backup** interface.</span></span> <span data-ttu-id="8873e-113">Vous ne pouvez pas configurer [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] pour une base de données, suspendre ou reprendre des opérations [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] ou configurer des notifications par courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="8873e-113">You cannot configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] for a database, pause or resume [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] operations, or setup email notifications.</span></span> <span data-ttu-id="8873e-114">Pour plus d’informations sur la façon d’effectuer des opérations qui ne sont pas actuellement prises en charge par le biais de l’interface de **sauvegarde managée** , consultez [SQL Server les paramètres de stockage et de rétention de sauvegarde Azure](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md).</span><span class="sxs-lookup"><span data-stu-id="8873e-114">For information on how to perform operations not currently supported through the **Managed Backup** interface, see [SQL Server Managed Backup to Azure - Retention and Storage Settings](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md).</span></span>  
  
## <a name="permissions"></a><span data-ttu-id="8873e-115">Autorisations</span><span class="sxs-lookup"><span data-stu-id="8873e-115">Permissions</span></span>  
 <span data-ttu-id="8873e-116">L' **affichage du nœud de sauvegarde géré est SQL Server Management Studio :** Pour afficher le nœud de **sauvegarde managé** dans l' **Explorateur d’objets**, vous devez être un administrateur système ou disposer des autorisations suivantes spécifiquement accordées à votre compte d’utilisateur :</span><span class="sxs-lookup"><span data-stu-id="8873e-116">**View Managed Backup Node is SQL Server Management Studio:** To view  **Managed Backup** node in **Object Explorer**, you must either be a System Admin or have the following permissions specifically granted to your user account:</span></span>  
  
-   `db_backupoperator`  
  
-   `VIEW SERVER STATE`  
  
-   `ALTER ANY CREDENTIAL`  
  
-   `VIEW ANY DEFINITION`  
  
-   <span data-ttu-id="8873e-117">`EXECUTE` sur `smart_admin.fn_is_master_switch_on`.</span><span class="sxs-lookup"><span data-stu-id="8873e-117">`EXECUTE` on `smart_admin.fn_is_master_switch_on`.</span></span>  
  
-   <span data-ttu-id="8873e-118">`SELECT` sur `smart_admin.fn_backup_instance_config`.</span><span class="sxs-lookup"><span data-stu-id="8873e-118">`SELECT` on `smart_admin.fn_backup_instance_config`.</span></span>  
  
 <span data-ttu-id="8873e-119">**Pour configurer des sauvegardes managées :** pour configurer [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] dans SQL Server Management Studio, vous devez être un administrateur système ou disposer des autorisations suivantes :</span><span class="sxs-lookup"><span data-stu-id="8873e-119">**To Configure Managed Backup:** to configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] in SQL Server Management Studio, you must be a System Administrator or have the following permissions:</span></span>  
  
 <span data-ttu-id="8873e-120">L'appartenance au rôle de base de données `db_backupoperator`, avec autorisations `ALTER ANY CREDENTIAL` et autorisations `EXECUTE` sur la procédure stockée `sp_delete_backuphistory`.</span><span class="sxs-lookup"><span data-stu-id="8873e-120">Membership in `db_backupoperator` database role, with `ALTER ANY CREDENTIAL` permissions, and `EXECUTE` permissions on `sp_delete_backuphistory` stored procedure.</span></span>  
  
 <span data-ttu-id="8873e-121">`SELECT`autorisations sur la `smart_admin.fn_get_current_xevent_settings` fonction.</span><span class="sxs-lookup"><span data-stu-id="8873e-121">`SELECT` permissions on the `smart_admin.fn_get_current_xevent_settings` function.</span></span>  
  
 <span data-ttu-id="8873e-122">`EXECUTE`autorisations sur la `smart_admin.sp_get_backup_diagnostics` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="8873e-122">`EXECUTE` permissions on the `smart_admin.sp_get_backup_diagnostics` stored procedure.</span></span> <span data-ttu-id="8873e-123">En outre, nécessite les autorisations `VIEW SERVER STATE`, car elle appelle en interne d'autres objets système qui nécessitent cette autorisation.</span><span class="sxs-lookup"><span data-stu-id="8873e-123">In addition, it requires `VIEW SERVER STATE` permissions as it internally calls other system objects that require this permission.</span></span>  
  
 <span data-ttu-id="8873e-124">Autorisations `EXECUTE` sur `smart_admin.sp_set_instance_backup` et `smart_admin.sp_backup_master_switch`.</span><span class="sxs-lookup"><span data-stu-id="8873e-124">`EXECUTE` permissions on `smart_admin.sp_set_instance_backup`, and `smart_admin.sp_backup_master_switch`.</span></span>  
  
## <a name="configure-ss_smartbackup-using-sql-server-management-studio"></a><span data-ttu-id="8873e-125">Configuration de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] à l'aide de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="8873e-125">Configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] using SQL Server Management Studio</span></span>  
 <span data-ttu-id="8873e-126">À partir de l’**Explorateur d'objets**, développez le nœud **gestion** et cliquez avec le bouton droit sur **sauvegarde managée**.</span><span class="sxs-lookup"><span data-stu-id="8873e-126">From the **object explorer**, expand the **Management** node, and right click on **Managed Backup**.</span></span> <span data-ttu-id="8873e-127">Sélectionnez **Configurer**.</span><span class="sxs-lookup"><span data-stu-id="8873e-127">Select **Configure**.</span></span> <span data-ttu-id="8873e-128">La boîte de dialogue **Sauvegarde managée** s'ouvre.</span><span class="sxs-lookup"><span data-stu-id="8873e-128">This opens the **Managed Backup** dialog.</span></span>  
  
 <span data-ttu-id="8873e-129">Cochez l’option **Activer la sauvegarde managée** et spécifiez les valeurs de configuration :</span><span class="sxs-lookup"><span data-stu-id="8873e-129">Check **Enable Managed Backup** option and specify the configuration values:</span></span>  
  
 <span data-ttu-id="8873e-130">La période de **rétention de fichier** est spécifiée en jours et doit être comprise entre 1 et 30.</span><span class="sxs-lookup"><span data-stu-id="8873e-130">The **File retention** period is specified in days and should be between 1 and 30.</span></span>  
  
 <span data-ttu-id="8873e-131">Les **informations d’identification SQL** que vous sélectionnez doivent correspondre au compte de stockage.</span><span class="sxs-lookup"><span data-stu-id="8873e-131">The **SQL Credential** you select should match the storage account.</span></span> <span data-ttu-id="8873e-132">Si vous n’avez pas d’informations d’identification SQL qui stockent les informations d’authentification, vous pouvez en créer une en cliquant sur **créer**.</span><span class="sxs-lookup"><span data-stu-id="8873e-132">If you currently do not have a SQL Credential that stores the authentication information, you can create one by clicking **Create**.</span></span> <span data-ttu-id="8873e-133">Vous pouvez également créer des informations d'identification à l'aide de l'instruction Transact-SQL CREATE CREDENTIAL et fournir le nom du compte de stockage d'identité et la clé d'accès pour les paramètres SECRET.</span><span class="sxs-lookup"><span data-stu-id="8873e-133">You can also create credential by using the CREATE CREDENTIAL Transact-SQL statement, and provide the storage account name for Identity and the access key for the SECRET parameters.</span></span> <span data-ttu-id="8873e-134">Pour plus d’informations, consultez [créer des informations d’identification](../relational-databases/backup-restore/sql-server-backup-to-url.md#credential).</span><span class="sxs-lookup"><span data-stu-id="8873e-134">For more information, see [Create a Credential](../relational-databases/backup-restore/sql-server-backup-to-url.md#credential).</span></span>  
  
 <span data-ttu-id="8873e-135">Spécifiez l' **URL de stockage** pour le compte de stockage Azure, les informations d’identification SQL qui stockent les informations d’authentification pour le compte de stockage et la période de rétention pour les fichiers de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="8873e-135">Specify the **Storage URL** for the Azure storage account, the SQL Credential that stores the authentication information for the storage account, and the retention period for the backup files.</span></span>  
  
 <span data-ttu-id="8873e-136">Le format de l’URL de stockage est : https:// \<StorageAccount> . blob.Core.Windows.net/</span><span class="sxs-lookup"><span data-stu-id="8873e-136">The storage URL format is: https://\<StorageAccount>.blob.core.windows.net/</span></span>  
  
 <span data-ttu-id="8873e-137">Pour définir les paramètres de chiffrement au niveau de l'instance, cochez l’option **Chiffrement de la sauvegarde** et spécifiez l'algorithme de chiffrement et le certificat ou la clé asymétrique à utiliser pour le chiffrement.</span><span class="sxs-lookup"><span data-stu-id="8873e-137">To set the encryption settings at the instance level, check **Encrypt Backup** option, and specify the algorithm and a Certificate or Asymmetric Key to use for the encryption.</span></span>  <span data-ttu-id="8873e-138">Cette valeur définie au niveau de l'instance est utilisée pour toutes les nouvelles bases de données créées une fois cette configuration appliquée.</span><span class="sxs-lookup"><span data-stu-id="8873e-138">This is set at the instance level is used for all the new databases created once this configuration has been applied.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="8873e-139">Cette boîte de dialogue ne peut pas être utilisée pour spécifier les options de chiffrement sans configuration de [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8873e-139">This dialog cannot be used to specify the encryption options without configuring [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span></span> <span data-ttu-id="8873e-140">Ces options de chiffrement s'appliquent uniquement aux opérations [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8873e-140">These encryption options only apply to [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] operations.</span></span> <span data-ttu-id="8873e-141">Pour utiliser le chiffrement pour d’autres procédures de sauvegarde, consultez [chiffrement](../relational-databases/backup-restore/backup-encryption.md)de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="8873e-141">To use encryption for other backup procedures, see [Backup Encryption](../relational-databases/backup-restore/backup-encryption.md).</span></span>  
  
### <a name="considerations"></a><span data-ttu-id="8873e-142">Considérations</span><span class="sxs-lookup"><span data-stu-id="8873e-142">Considerations</span></span>  
 <span data-ttu-id="8873e-143">Si vous configurez [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] au niveau de l'instance, les paramètres sont appliqués aux nouvelles bases de données créées par la suite.</span><span class="sxs-lookup"><span data-stu-id="8873e-143">If you configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] at the instance level, the settings are applied to any new database created thereafter.</span></span>  <span data-ttu-id="8873e-144">Toutefois, une base de données existante n’hérite pas automatiquement de ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="8873e-144">However, existing database will not automatically inherit these settings.</span></span> <span data-ttu-id="8873e-145">Pour configurer [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] sur des bases de données existantes, vous devez configurer spécifiquement chaque base de données.</span><span class="sxs-lookup"><span data-stu-id="8873e-145">To configure [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] on previously existing databases, you must configure each database specifically.</span></span> <span data-ttu-id="8873e-146">Pour plus d’informations, consultez [activer et configurer SQL Server sauvegarde managée sur Azure pour une base de données](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md#DatabaseConfigure).</span><span class="sxs-lookup"><span data-stu-id="8873e-146">For more information, see [Enable and Configure SQL Server Managed Backup to Azure for a Database](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-retention-and-storage-settings.md#DatabaseConfigure).</span></span>  
  
 <span data-ttu-id="8873e-147">Si [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] a été suspendu à l’aide de `smart_admin.sp_backup_master_switch` , vous verrez un message d’avertissement « la sauvegarde managée est désactivée et les configurations actuelles ne prendront pas effet... » Lorsque vous essayez d’effectuer la configuration.</span><span class="sxs-lookup"><span data-stu-id="8873e-147">If [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] has been paused using the `smart_admin.sp_backup_master_switch`, you will see a warning message " Managed Backup is disabled and the current configurations will not take effect..." when you try to complete the configuration.</span></span> <span data-ttu-id="8873e-148">Utilisez le `smart_admin.sp_backup_master_switch` stocké et définissez @new_state = 1.</span><span class="sxs-lookup"><span data-stu-id="8873e-148">Use the `smart_admin.sp_backup_master_switch` stored and set the @new_state=1.</span></span> <span data-ttu-id="8873e-149">Cela relance les services [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] et les paramètres de configuration prennent effet.</span><span class="sxs-lookup"><span data-stu-id="8873e-149">This will resume [!INCLUDE[ss_smartbackup](../includes/ss-smartbackup-md.md)] services and the configuration settings will take into effect.</span></span> <span data-ttu-id="8873e-150">Pour plus d’informations sur la procédure stockée, consultez [smart_admin. sp_ backup_master_switch &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-master-switch-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="8873e-150">For more information on the stored procedure, see [smart_admin.sp_ backup_master_switch &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/managed-backup-sp-backup-master-switch-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8873e-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8873e-151">See Also</span></span>  
 [<span data-ttu-id="8873e-152">Sauvegarde managée SQL Server sur Azure : Interopérabilité et coexistence</span><span class="sxs-lookup"><span data-stu-id="8873e-152">SQL Server Managed Backup to Azure: Interoperability and Coexistence</span></span>](../../2014/database-engine/sql-server-managed-backup-to-windows-azure-interoperability-and-coexistence.md)  
  
  
