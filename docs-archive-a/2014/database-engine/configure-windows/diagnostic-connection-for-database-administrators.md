---
title: Connexion de diagnostic pour les administrateurs de base de données | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- server management [SQL Server], connections
- administrator connections [SQL Server]
- ports [SQL Server], DAC
- DAC
- network connections [SQL Server], dedicated administrator
- diagnostic connections [SQL Server]
- connections [SQL Server], dedicated administrator
- ports [SQL Server]
- dedicated administrator connections [SQL Server]
ms.assetid: 993e0820-17f2-4c43-880c-d38290bf7abc
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0d452ca155a5187136c910e81e8bd073e34cad56
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87610856"
---
# <a name="diagnostic-connection-for-database-administrators"></a><span data-ttu-id="59041-102">Connexion de diagnostic pour les administrateurs de base de données</span><span class="sxs-lookup"><span data-stu-id="59041-102">Diagnostic Connection for Database Administrators</span></span>
  [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59041-103">fournit aux administrateurs une connexion de diagnostic spéciale lorsque des connexions standard au serveur sont impossibles.</span><span class="sxs-lookup"><span data-stu-id="59041-103">provides a special diagnostic connection for administrators when standard connections to the server are not possible.</span></span> <span data-ttu-id="59041-104">Cette connexion de diagnostic permet aux administrateurs d'accéder à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour exécuter des requêtes de diagnostic et résoudre des problèmes, même lorsque [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne répond pas à des demandes de connexion standard.</span><span class="sxs-lookup"><span data-stu-id="59041-104">This diagnostic connection allows an administrator to access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to execute diagnostic queries and troubleshoot problems even when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is not responding to standard connection requests.</span></span>  
  
 <span data-ttu-id="59041-105">Cette connexion administrateur dédiée (DAC) prend en charge le chiffrement et d'autres fonctions de sécurité de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59041-105">This dedicated administrator connection (DAC) supports encryption and other security features of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="59041-106">Elle permet uniquement de changer de contexte utilisateur pour un autre administrateur.</span><span class="sxs-lookup"><span data-stu-id="59041-106">The DAC only allows changing the user context to another admin user.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59041-107">effectue chaque tentative pour établir la connexion DAC, mais cela peut échouer dans des situations extrêmes.</span><span class="sxs-lookup"><span data-stu-id="59041-107">makes every attempt to make DAC connect successfully, but under extreme situations it may not be successful.</span></span>  
  
||  
|-|  
|<span data-ttu-id="59041-108">**S’applique à**: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ( [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] jusqu’à la [version actuelle](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59041-108">**Applies to**: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] through [current version](https://go.microsoft.com/fwlink/p/?LinkId=299658)), [!INCLUDE[sqldbesa](../../includes/sqldbesa-md.md)].</span></span>|  
  
## <a name="connecting-with-dac"></a><span data-ttu-id="59041-109">Connexion avec DAC</span><span class="sxs-lookup"><span data-stu-id="59041-109">Connecting with DAC</span></span>  
 <span data-ttu-id="59041-110">Par défaut, la connexion est uniquement autorisée à partir d'un client s'exécutant sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="59041-110">By default, the connection is only allowed from a client running on the server.</span></span> <span data-ttu-id="59041-111">Les connexions réseau sont autorisées uniquement si elles sont configurées en utilisant la procédure stockée sp_configure avec [l’option remote admin connections](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="59041-111">Network connections are not permitted unless they are configured by using the sp_configure stored procedure with the [remote admin connections option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="59041-112">Seuls les membres du rôle administrateur système [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peuvent se connecter à l'aide de la connexion DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-112">Only members of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sysadmin role can connect using the DAC.</span></span>  
  
 <span data-ttu-id="59041-113">La connexion DAC est disponible et prise en charge par le biais de l’utilitaire d’invite de commandes **sqlcmd** , au moyen d’un commutateur d’administrateur spécial (**-A**).</span><span class="sxs-lookup"><span data-stu-id="59041-113">The DAC is available and supported through the **sqlcmd** command-prompt utility using a special administrator switch (**-A**).</span></span> <span data-ttu-id="59041-114">Pour plus d’informations sur l’utilisation de **sqlcmd**, consultez [Utiliser sqlcmd avec des variables de script](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span><span class="sxs-lookup"><span data-stu-id="59041-114">For more information about using **sqlcmd**, see [Use sqlcmd with Scripting Variables](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md).</span></span> <span data-ttu-id="59041-115">Vous pouvez également vous connecter en ajoutant le préfixe `admin:` au nom de l’instance au format **sqlcmd-Sadmin :** _<instance_name>._</span><span class="sxs-lookup"><span data-stu-id="59041-115">You can also connect prefixing `admin:`to the instance name in the format **sqlcmd -Sadmin:**_<instance_name>._</span></span> <span data-ttu-id="59041-116">Vous pouvez également initier une DAC à partir d’un [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] éditeur de requête en vous connectant à `admin:` \<*instance_name*> .</span><span class="sxs-lookup"><span data-stu-id="59041-116">You can also initiate a DAC from a [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Query Editor by connecting to `admin:`\<*instance_name*>.</span></span>  
  
## <a name="restrictions"></a><span data-ttu-id="59041-117">Restrictions</span><span class="sxs-lookup"><span data-stu-id="59041-117">Restrictions</span></span>  
 <span data-ttu-id="59041-118">Comme la connexion DAC n'est prévue que pour diagnostiquer des problèmes de serveur dans de rares circonstances, certaines restrictions sont imposées sur la connexion :</span><span class="sxs-lookup"><span data-stu-id="59041-118">Because the DAC exists solely for diagnosing server problems in rare circumstances, there are some restrictions on the connection:</span></span>  
  
-   <span data-ttu-id="59041-119">Pour garantir que des ressources sont disponibles pour la connexion, une seule connexion DAC est autorisée par instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59041-119">To guarantee that there are resources available for the connection, only one DAC is allowed per instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="59041-120">Si une connexion DAC est déjà active, toute nouvelle demande de connexion établie par son intermédiaire est refusée avec l'erreur 17810.</span><span class="sxs-lookup"><span data-stu-id="59041-120">If a DAC connection is already active, any new request to connect through the DAC is denied with error 17810.</span></span>  
  
-   <span data-ttu-id="59041-121">Pour préserver les ressources, [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] n'écoute pas le port DAC à moins qu'il soit démarré avec l'indicateur de trace 7806.</span><span class="sxs-lookup"><span data-stu-id="59041-121">To conserve resources, [!INCLUDE[ssExpress](../../includes/ssexpress-md.md)] does not listen on the DAC port unless started with a trace flag 7806.</span></span>  
  
-   <span data-ttu-id="59041-122">Au départ, la connexion DAC tente une connexion à la base de données par défaut associée à la connexion.</span><span class="sxs-lookup"><span data-stu-id="59041-122">The DAC initially attempts to connect to the default database associated with the login.</span></span> <span data-ttu-id="59041-123">Une fois la connexion établie, vous pouvez vous connecter à la base de données master.</span><span class="sxs-lookup"><span data-stu-id="59041-123">After it is successfully connected, you can connect to the master database.</span></span> <span data-ttu-id="59041-124">Si la base de données par défaut est hors connexion ou non disponible pour une raison quelconque, la connexion retourne l'erreur 4060.</span><span class="sxs-lookup"><span data-stu-id="59041-124">If the default database is offline or otherwise not available, the connection will return error 4060.</span></span> <span data-ttu-id="59041-125">Cependant, elle réussit si vous remplacez la base de données par défaut pour vous connecter à la base de données master au lieu d'utiliser la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="59041-125">However, it will succeed if you override the default database to connect to the master database instead using the following command:</span></span>  
  
     <span data-ttu-id="59041-126">**sqlcmd-A-d maître**</span><span class="sxs-lookup"><span data-stu-id="59041-126">**sqlcmd -A -d master**</span></span>  
  
     <span data-ttu-id="59041-127">Nous vous conseillons de vous connecter à la base de données master avec la connexion DAC, car la disponibilité de la base de données master est garantie en cas de démarrage de l’instance du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59041-127">We recommend that you connect to the master database with the DAC because master is guaranteed to be available if the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is started.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59041-128">interdit l'exécution de requêtes ou de commandes parallèles avec la connexion DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-128">prohibits running parallel queries or commands with the DAC.</span></span> <span data-ttu-id="59041-129">Par exemple, l'erreur 3637 est générée si vous exécutez l'une des instructions ci-dessous avec la connexion DAC :</span><span class="sxs-lookup"><span data-stu-id="59041-129">For example, error 3637 is generated if you execute either of the following statements with the DAC:</span></span>  
  
    -   <span data-ttu-id="59041-130">RESTORE</span><span class="sxs-lookup"><span data-stu-id="59041-130">RESTORE</span></span>  
  
    -   <span data-ttu-id="59041-131">BACKUP</span><span class="sxs-lookup"><span data-stu-id="59041-131">BACKUP</span></span>  
  
-   <span data-ttu-id="59041-132">Seules des ressources limitées sont garanties disponibles avec la connexion DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-132">Only limited resources are guaranteed to be available with the DAC.</span></span> <span data-ttu-id="59041-133">N'utilisez pas la connexion DAC pour exécuter des requêtes à utilisation intensive des ressources (par exemple,</span><span class="sxs-lookup"><span data-stu-id="59041-133">Do not use the DAC to run resource-intensive queries (for example.</span></span> <span data-ttu-id="59041-134">une jointure complexe sur une grande table) ou des requêtes pouvant créer des blocages.</span><span class="sxs-lookup"><span data-stu-id="59041-134">a complex join on large table) or queries that may block.</span></span> <span data-ttu-id="59041-135">Cela permet d'éviter que la connexion DAC n'amplifie d'éventuels problèmes de serveur existants.</span><span class="sxs-lookup"><span data-stu-id="59041-135">This helps prevent the DAC from compounding any existing server problems.</span></span> <span data-ttu-id="59041-136">Pour éviter les scénarios de blocages potentiels, si vous devez exécuter des requêtes pouvant créer un blocage, exécutez la requête sous des niveaux d'isolement basés si possible sur un instantané ; sinon, réglez le niveau d'isolement des transactions à READ UNCOMMITTED et attribuez à LOCK_TIMEOUT une valeur faible, par exemple 2 000 millisecondes, ou les deux.</span><span class="sxs-lookup"><span data-stu-id="59041-136">To avoid potential blocking scenarios, if you have to run queries that may block, run the query under snapshot-based isolation levels if possible; otherwise, set the transaction isolation level to READ UNCOMMITTED and set the LOCK_TIMEOUT value to a short value such as 2000 milliseconds, or both.</span></span> <span data-ttu-id="59041-137">Vous éviterez ainsi le blocage de la session DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-137">This will prevent the DAC session from getting blocked.</span></span> <span data-ttu-id="59041-138">Cependant, selon l'état de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , la session DAC pourrait se bloquer sur un verrou.</span><span class="sxs-lookup"><span data-stu-id="59041-138">However, depending on the state that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is in, the DAC session might get blocked on a latch.</span></span> <span data-ttu-id="59041-139">Vous pourriez être en mesure de terminer la session DAC en appuyant sur CTRL-C, mais ce n'est pas garanti.</span><span class="sxs-lookup"><span data-stu-id="59041-139">You might be able to terminate the DAC session using CNTRL-C but it is not guaranteed.</span></span> <span data-ttu-id="59041-140">Dans ce cas, la seule option consiste à redémarrer [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59041-140">In that case, your only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="59041-141">Pour garantir la connectivité et le dépannage avec la connexion DAC, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] réserve des ressources limitées pour traiter les commandes exécutées sur la connexion DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-141">To guarantee connectivity and troubleshooting with the DAC, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] reserves limited resources to process commands run on the DAC.</span></span> <span data-ttu-id="59041-142">Ces ressources ne permettent généralement que de simples fonctions de diagnostic et de dépannage, telles que celles répertoriées ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="59041-142">These resources are typically only enough for simple diagnostic and troubleshooting functions, such as those listed below.</span></span>  
  
 <span data-ttu-id="59041-143">Même si vous pouvez théoriquement exécuter toute instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] qui ne doit pas nécessairement être exécutée en parallèle sur la connexion DAC, nous vous recommandons instamment de n'utiliser que les commandes de diagnostic et de dépannage suivantes :</span><span class="sxs-lookup"><span data-stu-id="59041-143">Although you can theoretically run any [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that does not have to execute in parallel on the DAC, we strongly recommend that you restrict usage to the following diagnostic and troubleshooting commands:</span></span>  
  
-   <span data-ttu-id="59041-144">Interrogation de vues de gestion dynamique (DMV) pour des diagnostics de base tels que sys.dm_tran_locks pour l'état de verrouillage, sys.dm_os_memory_cache_counters pour vérifier l'état des mémoires caches, et sys.dm_exec_requests et sys.dm_exec_sessions pour des sessions et des demandes actives.</span><span class="sxs-lookup"><span data-stu-id="59041-144">Querying dynamic management views for basic diagnostics such as sys.dm_tran_locks for the locking status, sys.dm_os_memory_cache_counters to check the health of caches, and sys.dm_exec_requests and sys.dm_exec_sessions for active sessions and requests.</span></span> <span data-ttu-id="59041-145">Évitez les DMV à utilisation intensive des ressources (par exemple, sys.dm_tran_version_store analyse le magasin de versions complet et peut provoquer des E/S intensives et soutenues) ou qui utilisent des jointures complexes.</span><span class="sxs-lookup"><span data-stu-id="59041-145">Avoid dynamic management views that are resource intensive (for example, sys.dm_tran_version_store scans the full version store and can cause extensive I/O) or that use complex joins.</span></span> <span data-ttu-id="59041-146">Pour plus d'informations sur les implications sur les performances, consultez la documentation relative à la [vue de gestion dynamique](../../relational-databases/views/views.md)spécifique.</span><span class="sxs-lookup"><span data-stu-id="59041-146">For information about performance implications, see the documentation for the specific [dynamic management view](../../relational-databases/views/views.md).</span></span>  
  
-   <span data-ttu-id="59041-147">Interrogation d'affichages catalogue.</span><span class="sxs-lookup"><span data-stu-id="59041-147">Querying catalog views.</span></span>  
  
-   <span data-ttu-id="59041-148">Les commandes DBCC de base telles que DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` et DBCC SQLPERF.</span><span class="sxs-lookup"><span data-stu-id="59041-148">Basic DBCC commands such as DBCC FREEPROCCACHE, DBCC FREESYSTEMCACHE, DBCC DROPCLEANBUFFERS`,` and DBCC SQLPERF.</span></span> <span data-ttu-id="59041-149">N’exécutez pas de commandes gourmandes en ressources telles que **DBCC** CHECKDB, DBCC DBREINDEX ou DBCC SHRINKDATABASE.</span><span class="sxs-lookup"><span data-stu-id="59041-149">Do not run resource-intensive commands such as **DBCC** CHECKDB, DBCC DBREINDEX, or DBCC SHRINKDATABASE.</span></span>  
  
-   <span data-ttu-id="59041-150">Commande [!INCLUDE[tsql](../../includes/tsql-md.md)] KILL *\<spid>* .</span><span class="sxs-lookup"><span data-stu-id="59041-150">[!INCLUDE[tsql](../../includes/tsql-md.md)] KILL*\<spid>* command.</span></span> <span data-ttu-id="59041-151">Selon l'état de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la commande KILL risque de ne pas toujours aboutir ; dans ce cas, la seule option consiste à redémarrer [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="59041-151">Depending on the state of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the KILL command might not always succeed; then the only option may be to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="59041-152">Voici quelques directives générales :</span><span class="sxs-lookup"><span data-stu-id="59041-152">The following are some general guidelines:</span></span>  
  
    -   <span data-ttu-id="59041-153">Vérifiez que le SPID a été supprimé en interrogeant `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="59041-153">Verify that the SPID was actually killed by querying `SELECT * FROM sys.dm_exec_sessions WHERE session_id = <spid>`.</span></span> <span data-ttu-id="59041-154">S'il ne retourne aucune ligne, la session a été supprimée.</span><span class="sxs-lookup"><span data-stu-id="59041-154">If it returns no rows, it means the session was killed.</span></span>  
  
    -   <span data-ttu-id="59041-155">Si la session est toujours active, vérifiez si des tâches sont affectées à cette session en exécutant la requête `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span><span class="sxs-lookup"><span data-stu-id="59041-155">If the session is still there, verify whether there are tasks assigned to this session by running the query `SELECT * FROM sys.dm_os_tasks WHERE session_id = <spid>`.</span></span> <span data-ttu-id="59041-156">Si vous y voyez la tâche, votre session est très probablement en cours de fermeture.</span><span class="sxs-lookup"><span data-stu-id="59041-156">If you see the task there, most likely your session is currently being killed.</span></span> <span data-ttu-id="59041-157">Notez que cette opération peut prendre beaucoup de temps et risque même d'échouer.</span><span class="sxs-lookup"><span data-stu-id="59041-157">Note that this may take considerable amount of time and may not succeed at all.</span></span>  
  
    -   <span data-ttu-id="59041-158">En l'absence de tâches dans le sys.dm_os_tasks associé à cette session, mais si la session est maintenue dans sys.dm_exec_sessions après l'exécution de la commande KILL, vous ne disposez d'aucun thread de travail.</span><span class="sxs-lookup"><span data-stu-id="59041-158">If there are no tasks in the sys.dm_os_tasks associated with this session, but the session remains in sys.dm_exec_sessions after executing the KILL command, it means that you do not have a worker available.</span></span> <span data-ttu-id="59041-159">Sélectionnez l'une des tâches en cours d'exécution (une tâche répertoriée dans la vue sys.dm_os_tasks avec un `sessions_id <> NULL`), puis supprimez la session qui lui est associée pour libérer le thread de travail.</span><span class="sxs-lookup"><span data-stu-id="59041-159">Select one of the currently running tasks (a task listed in the sys.dm_os_tasks view with a `sessions_id <> NULL`), and kill the session associated with it to free up the worker.</span></span> <span data-ttu-id="59041-160">Notez que la suppression d'une session unique ne sera peut-être pas suffisante : vous devrez éventuellement en supprimer plusieurs.</span><span class="sxs-lookup"><span data-stu-id="59041-160">Note that it may not be enough to kill a single session: you may have to kill multiple ones.</span></span>  
  
## <a name="dac-port"></a><span data-ttu-id="59041-161">Port DAC</span><span class="sxs-lookup"><span data-stu-id="59041-161">DAC Port</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="59041-162">est à l'écoute de la connexion DAC sur le port TCP 1434 s'il est disponible ou un port TCP attribué dynamiquement lors du démarrage du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="59041-162">listens for the DAC on TCP port 1434 if available or a TCP port dynamically assigned upon [!INCLUDE[ssDE](../../includes/ssde-md.md)] startup.</span></span> <span data-ttu-id="59041-163">Le journal des erreurs contient le numéro de port sur lequel la connexion DAC écoute.</span><span class="sxs-lookup"><span data-stu-id="59041-163">The error log contains the port number the DAC is listening on.</span></span> <span data-ttu-id="59041-164">Par défaut, l'écouteur DAC n'accepte une connexion que sur le port local.</span><span class="sxs-lookup"><span data-stu-id="59041-164">By default the DAC listener accepts connection on only the local port.</span></span> <span data-ttu-id="59041-165">Pour voir un exemple de code qui active des connexions d’administration à distance, consultez [remote admin connections (option de configuration de serveur)](remote-admin-connections-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="59041-165">For a code sample that activates remote administration connections, see [remote admin connections Server Configuration Option](remote-admin-connections-server-configuration-option.md).</span></span>  
  
 <span data-ttu-id="59041-166">Une fois que la connexion d'administration distante est configurée, l'écouteur DAC est activé sans nécessiter un redémarrage de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ; un client peut maintenant se connecter à la DAC à distance.</span><span class="sxs-lookup"><span data-stu-id="59041-166">After the remote administration connection is configured, the DAC listener is enabled without requiring a restart of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and a client can now connect to the DAC remotely.</span></span> <span data-ttu-id="59041-167">Vous pouvez permettre à l'écouteur DAC d'accepter des connexions à distance même si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne répond pas en vous connectant d'abord à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en utilisant la DAC localement, et en exécutant ensuite la procédure stockée sp_configure pour accepter la connexion à partir de connexions distantes.</span><span class="sxs-lookup"><span data-stu-id="59041-167">You can enable the DAC listener to accept connections remotely even if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive by first connecting to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] using the DAC locally, and then executing the sp_configure stored procedure to accept connection from remote connections.</span></span>  
  
 <span data-ttu-id="59041-168">Sur les configurations cluster, la connexion DAC est désactivée par défaut.</span><span class="sxs-lookup"><span data-stu-id="59041-168">On cluster configurations, the DAC will be off by default.</span></span> <span data-ttu-id="59041-169">Les utilisateurs peuvent exécuter l'option remote admin connection de sp_configure pour permettre à l'écouteur DAC d'accéder à une connexion distante.</span><span class="sxs-lookup"><span data-stu-id="59041-169">Users can execute the remote admin connection option of sp_configure to enable the DAC listener to access a remote connection.</span></span> <span data-ttu-id="59041-170">Si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne répond pas et si l'écouteur DAC n'est pas activé, vous risquez de devoir redémarrer [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour établir une connexion avec la DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-170">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is unresponsive and the DAC listener is not enabled, you might have to restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to connect with the DAC.</span></span> <span data-ttu-id="59041-171">Nous recommandons par conséquent d'activer l'option de configuration remote admin connections sur les systèmes en cluster.</span><span class="sxs-lookup"><span data-stu-id="59041-171">Therefore, we recommend that you enable the remote admin connections configuration option on clustered systems.</span></span>  
  
 <span data-ttu-id="59041-172">Le port DAC est affecté dynamiquement par [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pendant le démarrage.</span><span class="sxs-lookup"><span data-stu-id="59041-172">The DAC port is assigned dynamically by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] during startup.</span></span> <span data-ttu-id="59041-173">Lors d’une connexion à l’instance par défaut, la DAC évite d’utiliser une demande SSRP ( [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resolution Protocol) à SQL Server Browser Service lors de la connexion.</span><span class="sxs-lookup"><span data-stu-id="59041-173">When connecting to the default instance, the DAC avoids using a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Resolution Protocol (SSRP) request to the SQL Server Browser Service when connecting.</span></span> <span data-ttu-id="59041-174">Elle se connecte d'abord sur le port TCP 1434.</span><span class="sxs-lookup"><span data-stu-id="59041-174">It first connects over TCP port 1434.</span></span> <span data-ttu-id="59041-175">Si cette tentative échoue, elle effectue un appel SSRP pour obtenir le port.</span><span class="sxs-lookup"><span data-stu-id="59041-175">If that fails, it makes an SSRP call to get the port.</span></span> <span data-ttu-id="59041-176">Si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser n'écoute pas les demandes SSRP, la demande de connexion retourne une erreur.</span><span class="sxs-lookup"><span data-stu-id="59041-176">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Browser is not listening for SSRP requests, the connection request returns an error.</span></span> <span data-ttu-id="59041-177">Reportez-vous au journal des erreurs pour trouver le numéro de port que la DAC écoute.</span><span class="sxs-lookup"><span data-stu-id="59041-177">Refer to the error log to find the port number DAC is listening on.</span></span> <span data-ttu-id="59041-178">Si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est configuré pour accepter les connexions d'administration distante, la DAC doit être initialisée avec un numéro de port explicite :</span><span class="sxs-lookup"><span data-stu-id="59041-178">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept remote administration connections, the DAC must be initiated with an explicit port number:</span></span>  
  
 <span data-ttu-id="59041-179">**sqlcmd-STCP :** _ \<server> , \<port> _</span><span class="sxs-lookup"><span data-stu-id="59041-179">**sqlcmd-Stcp:** _\<server>,\<port>_</span></span>  
  
 <span data-ttu-id="59041-180">Le journal des erreurs de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] indique le numéro de port de la connexion DAC, qui est 1434 par défaut.</span><span class="sxs-lookup"><span data-stu-id="59041-180">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] error log lists the port number for the DAC, which is 1434 by default.</span></span> <span data-ttu-id="59041-181">Si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est configuré pour accepter uniquement des connexions DAC locales, connectez-vous au moyen de l'adaptateur de bouclage en utilisant la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="59041-181">If [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured to accept local DAC connections only, connect using the loopback adapter using the following command:</span></span>  
  
 <span data-ttu-id="59041-182">**sqlcmd-s 127.0.0.1**,`1434`</span><span class="sxs-lookup"><span data-stu-id="59041-182">**sqlcmd-S127.0.0.1**,`1434`</span></span>  
  
## <a name="example"></a><span data-ttu-id="59041-183">Exemple</span><span class="sxs-lookup"><span data-stu-id="59041-183">Example</span></span>  
 <span data-ttu-id="59041-184">Dans cet exemple, un administrateur note que le serveur `URAN123` ne répond pas et souhaite diagnostiquer le problème.</span><span class="sxs-lookup"><span data-stu-id="59041-184">In this example, an administrator notices that server `URAN123` is not responding and wants to diagnose the problem.</span></span> <span data-ttu-id="59041-185">Pour ce faire, l'utilisateur active l'utilitaire de ligne de commande `sqlcmd` et se connecte au serveur `URAN123` en utilisant `-A` pour indiquer la connexion DAC.</span><span class="sxs-lookup"><span data-stu-id="59041-185">To do this, the user activates the `sqlcmd` command prompt utility and connects to server `URAN123` using `-A` to indicate the DAC.</span></span>  
  
 `sqlcmd -S URAN123 -U sa -P <xxx> -A`  
  
 <span data-ttu-id="59041-186">L'administrateur peut maintenant exécuter des requêtes pour diagnostiquer le problème et éventuellement terminer les sessions sans réponse.</span><span class="sxs-lookup"><span data-stu-id="59041-186">The administrator can now execute queries to diagnose the problem and possibly terminate the unresponsive sessions.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="59041-187">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="59041-187">Related Tasks</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="59041-188">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="59041-188">Related Content</span></span>  
 [<span data-ttu-id="59041-189">Utiliser sqlcmd avec des variables de script</span><span class="sxs-lookup"><span data-stu-id="59041-189">Use sqlcmd with Scripting Variables</span></span>](../../relational-databases/scripting/sqlcmd-use-with-scripting-variables.md)  
  
 [<span data-ttu-id="59041-190">Utilitaire sqlcmd</span><span class="sxs-lookup"><span data-stu-id="59041-190">sqlcmd Utility</span></span>](../../tools/sqlcmd-utility.md)  
  
 [<span data-ttu-id="59041-191">SELECT &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-191">SELECT &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/queries/select-transact-sql)  
  
 [<span data-ttu-id="59041-192">sp_who &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-192">sp_who &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql)  
  
 [<span data-ttu-id="59041-193">sp_lock &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-193">sp_lock &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-lock-transact-sql)  
  
 [<span data-ttu-id="59041-194">KILL &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-194">KILL &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/language-elements/kill-transact-sql)  
  
 [<span data-ttu-id="59041-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-195">DBCC CHECKALLOC &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkalloc-transact-sql)  
  
 [<span data-ttu-id="59041-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-196">DBCC CHECKDB &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql)  
  
 [<span data-ttu-id="59041-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-197">DBCC OPENTRAN &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-opentran-transact-sql)  
  
 [<span data-ttu-id="59041-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-198">DBCC INPUTBUFFER &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-inputbuffer-transact-sql)  
  
 [<span data-ttu-id="59041-199">Options de configuration de serveur &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-199">Server Configuration Options &#40;SQL Server&#41;</span></span>](server-configuration-options-sql-server.md)  
  
 [<span data-ttu-id="59041-200">Fonctions et vues de gestion dynamique relatives aux transactions &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-200">Transaction Related Dynamic Management Views and Functions &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/transaction-related-dynamic-management-views-and-functions-transact-sql)  
  
 [<span data-ttu-id="59041-201">Indicateurs de trace &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="59041-201">Trace Flags &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql)  
  
  
