---
title: affinity Input-Output mask (option de configuration de serveur) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- affinity I/O mask option
- processor affinity [SQL Server]
- binding processors [SQL Server]
- CPU affinity mask option
ms.assetid: 9950a8c9-9fe0-4003-95df-6f0d1becb0e7
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 3d0606e2a3f5480b27e27a4a585562f4b289b640
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600232"
---
# <a name="affinity-input-output-mask-server-configuration-option"></a><span data-ttu-id="45340-102">affinity Input-Output mask (option de configuration de serveur)</span><span class="sxs-lookup"><span data-stu-id="45340-102">affinity Input-Output mask Server Configuration Option</span></span>
  <span data-ttu-id="45340-103">Pour exécuter des travaux multitâche, [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 2000 et Windows Server 2003 transfèrent parfois des threads de processus entre différents processeurs.</span><span class="sxs-lookup"><span data-stu-id="45340-103">To carry out multitasking, [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 2000 and Windows Server 2003 sometimes move process threads among different processors.</span></span> <span data-ttu-id="45340-104">Bien qu’efficace du point de vue du système d’exploitation, cette activité peut réduire les performances de [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sous des charges de système intenses, car des données sont rechargées de façon répétée dans chaque cache de processeur.</span><span class="sxs-lookup"><span data-stu-id="45340-104">Although efficient from an operating system point of view, this activity can reduce [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performance under heavy system loads, as each processor cache is repeatedly reloaded with data.</span></span> <span data-ttu-id="45340-105">L'affectation de processeurs à des threads spécifiques peut améliorer les performances sous ces conditions en éliminant les rechargements de processeur ; une telle association entre un thread et un processeur est qualifiée d'affinité de processeur.</span><span class="sxs-lookup"><span data-stu-id="45340-105">Assigning processors to specific threads can improve performance under these conditions by eliminating processor reloads; such an association between a thread and a processor is called processor affinity.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="45340-106">prend en charge l’affinité du processeur au moyen de deux options de masque d’affinité : **affinity mask** (également appelé **CPU affinity mask**) et **affinity I/O mask**.</span><span class="sxs-lookup"><span data-stu-id="45340-106">supports processor affinity by means of two affinity mask options: **affinity mask** (also known as **CPU affinity mask**) and **affinity I/O mask**.</span></span> <span data-ttu-id="45340-107">Pour plus d’informations sur l’option **affinity mask** , consultez [affinity mask (option de configuration de serveur)](affinity-mask-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="45340-107">For more information on the **affinity mask** option, see [affinity mask Server Configuration Option](affinity-mask-server-configuration-option.md).</span></span> <span data-ttu-id="45340-108">La prise en charge de l’affinité du processeur et d’E/S pour les serveurs dotés de 33 à 64 processeurs nécessite l’utilisation supplémentaire de [l’option de configuration de serveur affinity64 mask](affinity64-mask-server-configuration-option.md) et de [l’option de configuration du serveur affinity64 Input-Output mask](affinity64-input-output-mask-server-configuration-option.md) , respectivement.</span><span class="sxs-lookup"><span data-stu-id="45340-108">CPU and I/O affinity support for servers with 33 to 64 processors requires the additional use of the [affinity64 mask Server Configuration Option](affinity64-mask-server-configuration-option.md) and [affinity64 Input-Output mask Server Configuration Option](affinity64-input-output-mask-server-configuration-option.md) respectively.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="45340-109">La prise en charge de l'affinité pour les serveurs dotés de 33 à 64 processeurs est uniquement disponible sur les systèmes d'exploitation 64 bits.</span><span class="sxs-lookup"><span data-stu-id="45340-109">Affinity support for servers with 33 to 64 processors is only available on 64-bit operating systems.</span></span>  
  
 <span data-ttu-id="45340-110">L’option **affinity I/O mask** lie les E/S disque de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à un sous-ensemble de processeurs spécifié.</span><span class="sxs-lookup"><span data-stu-id="45340-110">The **affinity I/O mask** option binds [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O to a specified subset of CPUs.</span></span> <span data-ttu-id="45340-111">Dans les environnements de traitement transactionnel en ligne (OLTP) [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] haut de gamme, cette extension permet d'améliorer les performances des threads [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] émettant des E/S.</span><span class="sxs-lookup"><span data-stu-id="45340-111">In high-end [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] online transactional processing (OLTP) environments, this extension can enhance the performance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] threads issuing I/Os.</span></span> <span data-ttu-id="45340-112">Cette amélioration ne prend pas en charge l'affinité matérielle pour les disques ou les contrôleurs de disques individuels.</span><span class="sxs-lookup"><span data-stu-id="45340-112">This enhancement does not support hardware affinity for individual disks or disk controllers.</span></span>  
  
 <span data-ttu-id="45340-113">La valeur de **affinity I/O mask** spécifie quels processeurs dans un ordinateur multiprocesseur sont éligibles pour le traitement d’opérations d’E/S disque [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="45340-113">The value for **affinity I/O mask** specifies which CPUs in a multiprocessor computer are eligible to process [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations.</span></span> <span data-ttu-id="45340-114">Le masque est un bitmap dans lequel le bit le plus à droite spécifie le processeur d'ordre le plus bas CPU(0), le bit à sa gauche immédiate spécifie le processeur d'ordre le plus bas suivant CPU(1), etc.</span><span class="sxs-lookup"><span data-stu-id="45340-114">The mask is a bitmap in which the rightmost bit specifies the lowest-order CPU(0), the bit to its immediate left specifies the next-lowest-order CPU(1), and so on.</span></span> <span data-ttu-id="45340-115">Pour configurer plus de 32 processeurs, définissez les options **affinity I/O mask** et **affinity64 I/O mask**.</span><span class="sxs-lookup"><span data-stu-id="45340-115">To configure more than 32 processors, set both the **affinity I/O mask** and the **affinity64 I/O mask**.</span></span>  
  
 <span data-ttu-id="45340-116">Les valeurs de l’option **affinity I/O mask** sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="45340-116">The values for **affinity I/O mask** are as follows:</span></span>  
  
-   <span data-ttu-id="45340-117">Un masque **affinity I/O mask** à 1 octet prend en charge jusqu’à 8 processeurs sur un ordinateur multiprocesseur.</span><span class="sxs-lookup"><span data-stu-id="45340-117">A 1-byte **affinity I/O mask** covers up to 8 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="45340-118">Un masque **affinity I/O mask** à 2 octets prend en charge jusqu’à 16 processeurs sur un ordinateur multiprocesseur.</span><span class="sxs-lookup"><span data-stu-id="45340-118">A 2-byte **affinity I/O mask** covers up to 16 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="45340-119">Un masque **affinity I/O mask** à 3 octets prend en charge jusqu’à 24 processeurs sur un ordinateur multiprocesseur.</span><span class="sxs-lookup"><span data-stu-id="45340-119">A 3-byte **affinity I/O mask** covers up to 24 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="45340-120">Un masque **affinity I/O mask** à 4 octets prend en charge jusqu’à 32 processeurs sur un ordinateur multiprocesseur.</span><span class="sxs-lookup"><span data-stu-id="45340-120">A 4-byte **affinity I/O mask** covers up to 32 CPUs in a multiprocessor computer.</span></span>  
  
-   <span data-ttu-id="45340-121">Pour prendre en charge plus de 32 processeurs, configurez un masque **affinity I/O mask** à 4 octets pour les 32 premiers processeurs et un masque **affinity64 I/O mask** jusqu’à 4 octets pour les autres processeurs.</span><span class="sxs-lookup"><span data-stu-id="45340-121">To cover more than 32 CPUs, configure a four-byte **affinity I/O mask** for the first 32 CPUs and up to a four-byte **affinity64 I/O mask** for the remaining CPUs.</span></span>  
  
 <span data-ttu-id="45340-122">Un bit à 1 dans le modèle d'affinité d'E/S spécifie que le processeur correspondant peut effectuer des opérations d'E/S de disque [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ; un bit à 0 spécifie qu'aucune opération d'E/S de disque [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne doit être planifiée pour le processeur correspondant.</span><span class="sxs-lookup"><span data-stu-id="45340-122">A 1 bit in the affinity I/O pattern specifies that the corresponding CPU is eligible to perform [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations; a 0 bit specifies that no [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O operations should be scheduled for the corresponding CPU.</span></span> <span data-ttu-id="45340-123">Lorsque tous les bits sont à zéro ou lorsque l’option **affinity I/O mask** n’est pas spécifiée, l’E/S disque de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est confiée à n’importe lequel des processeurs éligibles au traitement de threads [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="45340-123">When all bits are set to zero, or **affinity I/O mask** is not specified, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] disk I/O is scheduled to any of the CPUs eligible to process [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] threads.</span></span>  
  
 <span data-ttu-id="45340-124">Le paramétrage de l’option [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **affinity I/O mask** étant une opération spécialisée, elle ne doit être utilisée qu’exceptionnellement.</span><span class="sxs-lookup"><span data-stu-id="45340-124">Because setting the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **affinity I/O mask** option is a specialized operation, it should be used only when necessary.</span></span> <span data-ttu-id="45340-125">Dans la plupart des cas, l’option d’affinité par défaut de Windows 2000 ou de Windows Server 2003 offre des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="45340-125">In most cases, the Windows 2000 or Windows Server 2003 default affinity provides the best performance.</span></span>  
  
 <span data-ttu-id="45340-126">Lorsque vous spécifiez l’option **affinity I/O mask** , vous devez l’utiliser avec l’option de configuration **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="45340-126">When specifying the **affinity I/O mask** option, you must use it with the **affinity mask** configuration option.</span></span> <span data-ttu-id="45340-127">Évitez d’activer sur le même processeur le commutateur **affinity I/O mask** et l’option **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="45340-127">Do not enable the same CPU in both the **affinity I/O mask** switch and the **affinity mask** option.</span></span> <span data-ttu-id="45340-128">Les bits correspondant à chaque processeur doivent être dans l'un des trois états suivants :</span><span class="sxs-lookup"><span data-stu-id="45340-128">The bits corresponding to each CPU should be in one of the following three states:</span></span>  
  
-   <span data-ttu-id="45340-129">0 pour l’option **affinity I/O mask** et pour l’option **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="45340-129">0 in both the **affinity I/O mask** option and the **affinity mask** option.</span></span>  
  
-   <span data-ttu-id="45340-130">1 pour l’option **affinity I/O mask** et 0 pour l’option **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="45340-130">1 in the **affinity I/O mask** option and 0 in the **affinity mask** option.</span></span>  
  
-   <span data-ttu-id="45340-131">0 pour l’option **affinity I/O mask** et 1 pour l’option **affinity mask** .</span><span class="sxs-lookup"><span data-stu-id="45340-131">0 in the **affinity I/O mask** option and 1 in the **affinity mask** option.</span></span>  
  
 <span data-ttu-id="45340-132">L’option **affinity I/O mask** est une option avancée.</span><span class="sxs-lookup"><span data-stu-id="45340-132">The **affinity I/O mask** option is an advanced option.</span></span> <span data-ttu-id="45340-133">Si vous utilisez la `sp_configure` procédure stockée système pour modifier le paramètre, vous ne pouvez modifier l’option **Affinity I/O mask** que si la valeur 1 a été attribuée à l' **option Afficher les options avancées** .</span><span class="sxs-lookup"><span data-stu-id="45340-133">If you are using the `sp_configure` system stored procedure to change the setting, you can change **affinity I/O mask** only when **show advanced options** is set to 1.</span></span> <span data-ttu-id="45340-134">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], reconfigurer l’option **affinity I/O mask** requiert un redémarrage de l’instance [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="45340-134">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], reconfiguring the **affinity I/O mask** option requires a restart of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="45340-135">Évitez de configurer l'affinité de processeur dans le système d'exploitation Windows et le masque d'affinité dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="45340-135">Do not configure CPU affinity in the Windows operating system and also configure the affinity mask in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="45340-136">Ces paramètres tentent d'obtenir le même résultat et, si les configurations sont incohérentes, les résultats risquent d'être imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="45340-136">These settings are attempting to achieve the same result, and if the configurations are inconsistent, you may have unpredictable results.</span></span> <span data-ttu-id="45340-137">L'affinité de processeur de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est configurée de façon optimale à l'aide de l'option `sp_configure` dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="45340-137">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] CPU affinity is best configured using the `sp_configure` option in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="45340-138">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="45340-138">See Also</span></span>  
 <span data-ttu-id="45340-139">[Analyser l’utilisation des ressources &#40;Moniteur système&#41;](../../relational-databases/performance-monitor/monitor-resource-usage-system-monitor.md) </span><span class="sxs-lookup"><span data-stu-id="45340-139">[Monitor Resource Usage &#40;System Monitor&#41;](../../relational-databases/performance-monitor/monitor-resource-usage-system-monitor.md) </span></span>  
 <span data-ttu-id="45340-140">[RECONFIGURE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/reconfigure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="45340-140">[RECONFIGURE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/reconfigure-transact-sql) </span></span>  
 <span data-ttu-id="45340-141">[Options de configuration de serveur &#40;SQL Server&#41;](server-configuration-options-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="45340-141">[Server Configuration Options &#40;SQL Server&#41;](server-configuration-options-sql-server.md) </span></span>  
 [<span data-ttu-id="45340-142">sp_configure &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="45340-142">sp_configure &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql)  
  
  
