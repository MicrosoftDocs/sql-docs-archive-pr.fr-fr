---
title: Résoudre les problèmes de la Utilitaire SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: f5f47c2a-38ea-40f8-9767-9bc138d14453
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: 3c139f9f084374aeb711e905ac0c315acc25c6ac
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704367"
---
# <a name="troubleshoot-the-sql-server-utility"></a><span data-ttu-id="4944b-102">Résolution des problèmes liés à l’utilitaire SQL Server</span><span class="sxs-lookup"><span data-stu-id="4944b-102">Troubleshoot the SQL Server Utility</span></span>
  <span data-ttu-id="4944b-103">Les problèmes à résoudre liés à l'utilitaire [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] peuvent inclure la résolution d'une opération ayant échoué d'inscription d'une instance de SQL Server avec un UCP, de l'échec de la collecte de données qui grise des icônes dans le mode Liste de l'instance gérée sur un UCP, l'atténuation des goulots d'étranglement des performances, ou la résolution des problèmes d'intégrité des ressources.</span><span class="sxs-lookup"><span data-stu-id="4944b-103">Troubleshooting [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility issues might include resolving a failed operation to enroll an instance of SQL Server with a UCP, troubleshooting failed data collection resulting in gray icons in the managed instance list view on a UCP, mitigating performance bottlenecks, or resolving resource health issues.</span></span> <span data-ttu-id="4944b-104">Pour plus d’informations sur l’atténuation des problèmes d’intégrité des ressources identifiés par un [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] UCP, consultez [Troubleshoot SQL Server Resource Health &#40;utilitaire SQL Server&#41;](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md).</span><span class="sxs-lookup"><span data-stu-id="4944b-104">For more information about mitigating resource health issues identified by a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] UCP, see [Troubleshoot SQL Server Resource Health &#40;SQL Server Utility&#41;](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md).</span></span>  
  
## <a name="failed-operation-to-enroll-an-instance-of-sql-server-into-a-sql-server-utility"></a><span data-ttu-id="4944b-105">Opération d'inscription d'une instance de SQL Server dans un utilitaire SQL Server ayant échoué</span><span class="sxs-lookup"><span data-stu-id="4944b-105">Failed Operation to Enroll an Instance of SQL Server into a SQL Server Utility</span></span>  
 <span data-ttu-id="4944b-106">Si vous utilisez l'authentification [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] pour vous connecter à l'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] à inscrire, et que vous spécifiez un compte proxy qui appartient à un domaine Active Directory différent du domaine où l'UCP se trouve, la validation d'instance réussit, mais l'opération d'inscription échoue avec le message d'erreur suivant :</span><span class="sxs-lookup"><span data-stu-id="4944b-106">If you connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll using [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Authentication, and you specify a proxy account that belongs to a different Active Directory domain than the domain where the UCP is located, instance validation succeeds, but the enrollment operation fails with the following error message:</span></span>  
  
 <span data-ttu-id="4944b-107">Une exception s'est produite lors de l'exécution d'une instruction ou d'un lot Transact-SQL ou lot.</span><span class="sxs-lookup"><span data-stu-id="4944b-107">An exception occurred while executing a Transact-SQL statement or batch.</span></span> <span data-ttu-id="4944b-108">(Microsoft.SqlServer.ConnectionInfo)</span><span class="sxs-lookup"><span data-stu-id="4944b-108">(Microsoft.SqlServer.ConnectionInfo)</span></span>  
  
 <span data-ttu-id="4944b-109">Informations supplémentaires :  Impossible d'obtenir des informations sur l'utilisateur ou le groupe '\<DomainName\AccountName>', code d'erreur 0x5.</span><span class="sxs-lookup"><span data-stu-id="4944b-109">Additional information:  Could not obtain information about Windows NT group/user '\<DomainName\AccountName>', error code 0x5.</span></span> <span data-ttu-id="4944b-110">(Microsoft SQL Server, erreur : 15404)</span><span class="sxs-lookup"><span data-stu-id="4944b-110">(Microsoft SQL Server, Error: 15404)</span></span>  
  
 <span data-ttu-id="4944b-111">Dans ce scénario d'exemple, vous pouvez rencontrer le problème suivant :</span><span class="sxs-lookup"><span data-stu-id="4944b-111">This issue occurs in the following example scenario:</span></span>  
  
1.  <span data-ttu-id="4944b-112">L'UCP est un membre de « Domain_1 ».</span><span class="sxs-lookup"><span data-stu-id="4944b-112">The UCP is a member of "Domain_1."</span></span>  
  
2.  <span data-ttu-id="4944b-113">Une relation d'approbation de domaine unidirectionnelle est en place : autrement dit, « Domain_1 » n'est pas approuvé par « Domain_2 » mais « Domain_2 » est approuvé par « Domain_1 ».</span><span class="sxs-lookup"><span data-stu-id="4944b-113">A one-way domain trust relationship is in place: that is, "Domain_1" is not trusted by "Domain_2" but "Domain_2" is trusted by "Domain_1."</span></span>  
  
3.  <span data-ttu-id="4944b-114">L'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] à inscrire dans l'utilitaire [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] est également un membre de « Domain_1 ».</span><span class="sxs-lookup"><span data-stu-id="4944b-114">The instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll into the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility is also a member of "Domain_1."</span></span>  
  
4.  <span data-ttu-id="4944b-115">Pendant l’opération d’inscription, connectez-vous à l’instance de pour procéder à l' [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] inscription à l’aide de « sa ».</span><span class="sxs-lookup"><span data-stu-id="4944b-115">During the enroll operation, connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll using "sa".</span></span> <span data-ttu-id="4944b-116">Spécifiez un compte proxy de « Domain_2 ».</span><span class="sxs-lookup"><span data-stu-id="4944b-116">Specify a proxy account from "Domain_2."</span></span>  
  
5.  <span data-ttu-id="4944b-117">La validation réussit mais l'inscription échoue.</span><span class="sxs-lookup"><span data-stu-id="4944b-117">Validation succeeds but enrollment fails.</span></span>  
  
 <span data-ttu-id="4944b-118">La solution de contournement pour ce problème, à l’aide de l’exemple ci-dessus, consiste à se connecter à l’instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] pour s’inscrire à l' [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] utilitaire à l’aide de « sa » et fournir un compte proxy à partir de « Domain_1 ».</span><span class="sxs-lookup"><span data-stu-id="4944b-118">The workaround for this issue, using the example above, is to connect to the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to enroll into the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility using "sa" and provide a proxy account from "Domain_1."</span></span>  
  
## <a name="failed-wmi-validation"></a><span data-ttu-id="4944b-119">Échec de validation WMI</span><span class="sxs-lookup"><span data-stu-id="4944b-119">Failed WMI Validation</span></span>  
 <span data-ttu-id="4944b-120">Si WMI n'est pas configuré correctement sur une instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], les opérations Créer un UCP et Inscrire une instance gérée affichent un avertissement, mais l'opération n'est pas bloquée.</span><span class="sxs-lookup"><span data-stu-id="4944b-120">If WMI is not properly configured on an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the Create UCP and Enroll Managed Instance operations display a warning, but the operation is not blocked.</span></span> <span data-ttu-id="4944b-121">En outre, si vous modifiez la configuration du compte de l'Agent [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] afin que l'Agent [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] n'ait pas l'autorisation d'accès aux classes WMI obligatoire, la collecte de données sur l'instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] affectée ne parvient pas à télécharger à l'UCP.</span><span class="sxs-lookup"><span data-stu-id="4944b-121">Additionally, if you change the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent account configuration so that [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent does not have permission to required WMI classes, data collection on the affected managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] fails to upload to the UCP.</span></span> <span data-ttu-id="4944b-122">Cela provoque des icônes grises dans l'UCP.</span><span class="sxs-lookup"><span data-stu-id="4944b-122">This results in gray icons in the UCP.</span></span>  
  
 <span data-ttu-id="4944b-123">L'échec de la collecte de données provoque des icônes d'état grises en mode Liste de l'UCP pour les instances managées affectées de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-123">Failed data collection results in gray status icons in the UCP list view for affected managed instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="4944b-124">L'historique des travaux sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] indique un échec de sysutility_mi_collect_and_upload à l'étape 2 (Données d'étape collectées à partir du script PowerShell).</span><span class="sxs-lookup"><span data-stu-id="4944b-124">The job history on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] shows that sysutility_mi_collect_and_upload fails on step 2 (Stage Data Collected from PowerShell Script).</span></span>  
  
 <span data-ttu-id="4944b-125">Les messages d'erreur simplifiés sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="4944b-125">The simplified error messages are:</span></span>  
  
 <span data-ttu-id="4944b-126">L'exécution de la commande s'est arrêtée, car la variable d'environnement « ErrorActionPreference » a la valeur Stop : accès refusé.</span><span class="sxs-lookup"><span data-stu-id="4944b-126">Command execution stopped because the shell variable "ErrorActionPreference" is set to Stop: Access denied.</span></span>  
  
 <span data-ttu-id="4944b-127">ERREUR : \<Date-time (MM/DD/YYYY HH:MM:SS)> : Exception interceptée lors de la collecte des propriétés de l’UC.</span><span class="sxs-lookup"><span data-stu-id="4944b-127">ERROR: \<Date-time (MM/DD/YYYY HH:MM:SS)>: Caught exception while collecting cpu properties.</span></span>  <span data-ttu-id="4944b-128">Une requête WMI a peut-être échoué.</span><span class="sxs-lookup"><span data-stu-id="4944b-128">A WMI query might have failed.</span></span>  <span data-ttu-id="4944b-129">AVERTISSEMENT.</span><span class="sxs-lookup"><span data-stu-id="4944b-129">WARNING.</span></span>  
  
 <span data-ttu-id="4944b-130">Pour résoudre ce problème, vérifiez les paramètres de configuration suivants :</span><span class="sxs-lookup"><span data-stu-id="4944b-130">To resolve this issue, verify the following configuration settings:</span></span>  
  
-   <span data-ttu-id="4944b-131">Sur Windows Server 2003, le compte de service Agent SQL Serverdoit appartenir au groupe d'analyse des performances de Windows sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-131">On Windows Server 2003, the SQL Server Agent service must be part of the Windows Performance Monitoring group on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="4944b-132">Le service WMI doit être activé et configuré sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-132">The WMI service must be enabled and configured on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="4944b-133">La base de données de référentiel WMI est peut-être endommagée sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-133">The WMI repository might be corrupt on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="4944b-134">La bibliothèque de performance peut être manquante ou endommagée sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-134">The performance library might be missing or corrupt on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="4944b-135">Pour vérifier que l'instance spécifiée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] est configurée correctement sur les données de rapport de l'UCP, vérifiez que les classes suivantes sont disponibles sur l'instance spécifiée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], et qu'elles sont accessibles au compte de service Agent SQL Server :</span><span class="sxs-lookup"><span data-stu-id="4944b-135">To verify that the specified instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is configured properly to report data to the UCP, verify that the following classes are available on the specified instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], and that they are accessible to SQL Server Agent service account:</span></span>  
  
-   <span data-ttu-id="4944b-136">Win32_MountPoint</span><span class="sxs-lookup"><span data-stu-id="4944b-136">Win32_MountPoint</span></span>  
  
-   <span data-ttu-id="4944b-137">Win32_PerfRawData_PerfProc_Process</span><span class="sxs-lookup"><span data-stu-id="4944b-137">Win32_PerfRawData_PerfProc_Process</span></span>  
  
-   <span data-ttu-id="4944b-138">Win32_PerfRawData_PerfOS_Processor</span><span class="sxs-lookup"><span data-stu-id="4944b-138">Win32_PerfRawData_PerfOS_Processor</span></span>  
  
-   <span data-ttu-id="4944b-139">Win32_Processor</span><span class="sxs-lookup"><span data-stu-id="4944b-139">Win32_Processor</span></span>  
  
-   <span data-ttu-id="4944b-140">Win32_Volume</span><span class="sxs-lookup"><span data-stu-id="4944b-140">Win32_Volume</span></span>  
  
-   <span data-ttu-id="4944b-141">Win32_LogicalDisk</span><span class="sxs-lookup"><span data-stu-id="4944b-141">Win32_LogicalDisk</span></span>  
  
 <span data-ttu-id="4944b-142">Vous pouvez utiliser l'applet de commande PowerShell de get-WmiObject sur chacune des classes pour vérifier que chaque classe est accessible.</span><span class="sxs-lookup"><span data-stu-id="4944b-142">You can use the Get-WmiObject PowerShell cmdlet on each of the classes to verify that each class is accessible.</span></span> <span data-ttu-id="4944b-143">Exécutez les applets de commande suivantes sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="4944b-143">Run the following cmdlets on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]:</span></span>  
  
```  
Get-WmiObject Win32_MountPoint -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_PerfRawData_PerfProc_Process -ErrorAction Stop| Out-Null  
Get-WmiObject Win32_PerfRawData_PerfOS_Processor -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_Processor -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_Volume -ErrorAction Stop | Out-Null  
Get-WmiObject Win32_LogicalDisk -ErrorAction Stop | Out-Null  
```  
  
 <span data-ttu-id="4944b-144">Pour plus d'informations sur la résolution des problèmes liés à WMI, consultez [Dépannage de WMI](https://go.microsoft.com/fwlink/?LinkId=178250).</span><span class="sxs-lookup"><span data-stu-id="4944b-144">For more information about troubleshooting WMI, see [Troubleshooting WMI](https://go.microsoft.com/fwlink/?LinkId=178250).</span></span> <span data-ttu-id="4944b-145">Notez que les requêtes dans ces opérations de l'utilitaire SQL Server s'exécutent localement, donc le DCOM et le contenu de résolution des problèmes à distance ne s'appliquent pas.</span><span class="sxs-lookup"><span data-stu-id="4944b-145">Note that queries in these SQL Server Utility operations are running locally, so the DCOM and remote troubleshooting content does not apply.</span></span>  
  
## <a name="failed-data-collection"></a><span data-ttu-id="4944b-146">Échec de la collecte de données</span><span class="sxs-lookup"><span data-stu-id="4944b-146">Failed Data Collection</span></span>  
 <span data-ttu-id="4944b-147">Si des événements de collecte de données de l'utilitaire [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] échouent, envisagez les possibilités suivantes :</span><span class="sxs-lookup"><span data-stu-id="4944b-147">If [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility data collection events fail, consider the following possibilities:</span></span>  
  
-   <span data-ttu-id="4944b-148">Ne modifiez pas les propriétés du jeu d’éléments de collecte « Informations sur l’utilitaire » sur une instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], et n’activez pas ou ne désactivez pas manuellement la collecte de données, car la collecte de données est contrôlée par un travail d’agent Utilitaire.</span><span class="sxs-lookup"><span data-stu-id="4944b-148">Do not change any properties of the "Utility Information" collection set on a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], and do not turn data collection on/off manually, as data collection is controlled by a Utility agent job.</span></span>  
  
-   <span data-ttu-id="4944b-149">Validation WMI ayant échoué ou non prise en charge.</span><span class="sxs-lookup"><span data-stu-id="4944b-149">Failed or unsupported WMI validation.</span></span> <span data-ttu-id="4944b-150">Pour plus d'informations, consultez la section « Échec de validation VMI », plus haut dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4944b-150">For more information, see the Failed WMI Validation section earlier in this topic.</span></span>  
  
-   <span data-ttu-id="4944b-151">Actualisez les données dans le mode Liste de l'instance managée, car les données dans les points de vue de l'utilitaire [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] ne s'actualisent pas automatiquement.</span><span class="sxs-lookup"><span data-stu-id="4944b-151">Refresh data in the managed instance list view, as data in [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Utility viewpoints does not refresh automatically.</span></span> <span data-ttu-id="4944b-152">Pour actualiser les données, cliquez avec le bouton droit sur le nœud **Instances managées** dans le volet **Navigation de l'Explorateur de l'utilitaire** , puis sélectionnez **Actualiser**, ou cliquez avec le bouton droit sur le nom de l'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] dans le mode Liste, puis sélectionnez **Actualiser**.</span><span class="sxs-lookup"><span data-stu-id="4944b-152">To refresh data, right-click the **Managed Instances** node in the **Utility Explorer Navigation** pane, then select **Refresh**, or right-click on the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] instance name in the list view, then select **Refresh**.</span></span> <span data-ttu-id="4944b-153">Notez qu'une fois qu'une instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] a été inscrite avec un UCP, cela peut prendre jusqu'à 30 minutes pour que les données s'affichent d'abord dans le tableau de bord et les points de vue dans le volet Contenu de l'Explorateur de l'utilitaire.</span><span class="sxs-lookup"><span data-stu-id="4944b-153">Note that after an instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] has been enrolled with a UCP, it can take up to 30 minutes for data to first appear in the dashboard and viewpoints in the Utility Explorer content pane.</span></span>  
  
-   <span data-ttu-id="4944b-154">Utilisez le Gestionnaire de configuration SQL Server pour vérifier que l'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] s'exécute.</span><span class="sxs-lookup"><span data-stu-id="4944b-154">Use SQL Server Configuration Manager to verify that the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is running.</span></span>  
  
-   <span data-ttu-id="4944b-155">Si la collecte ou le téléchargement de données échouent en raison de problèmes de délais d'attente, mettez à jour la fonction dbo.fn_sysutility_mi_get_collect_script() dans la base de données MSDB.</span><span class="sxs-lookup"><span data-stu-id="4944b-155">If data collection or data upload fail due to timeout issues, update the function dbo.fn_sysutility_mi_get_collect_script() in the MSDB database.</span></span> <span data-ttu-id="4944b-156">Plus particulièrement, dans la fonction Invoke-BulkCopyCommand(), ajoutez la ligne :</span><span class="sxs-lookup"><span data-stu-id="4944b-156">Specifically, in the function "Invoke-BulkCopyCommand()" add line:</span></span>  
  
    ```
    $bulkCopy.BulkCopyTimeout=180  
    ```  
  
     <span data-ttu-id="4944b-157">La valeur de délai d'attente par défaut est de 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="4944b-157">The default timeout value is 30 seconds.</span></span>  
  
-   <span data-ttu-id="4944b-158">Si l'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] n'est pas un cluster, vérifiez que le service [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent s'exécute et que le service est configuré pour démarrer automatiquement sur l'UCP et sur l'instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-158">If the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is not clustered, verify that the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service is running and that the service is set to start automatically on the UCP and on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="4944b-159">Vérifiez qu'un compte valide est utilisé pour exécuter la collecte de données sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-159">Verify that a valid account is being used to run data collection on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="4944b-160">Par exemple, le mot de passe a pu expirer.</span><span class="sxs-lookup"><span data-stu-id="4944b-160">For example, the password may have expired.</span></span> <span data-ttu-id="4944b-161">Si le mot de passe du proxy a expiré, mettez à jour les informations d'identification relatives au mot de passe dans SSMS, comme suit :</span><span class="sxs-lookup"><span data-stu-id="4944b-161">If the proxy password has expired, update password credentials in SSMS, as follows:</span></span>  
  
    1.  <span data-ttu-id="4944b-162">Dans SSMS **Explorateur d'objets**, développez le nœud **Sécurité** , puis le nœud **Informations d'identification** .</span><span class="sxs-lookup"><span data-stu-id="4944b-162">In SSMS **Object Explorer**, expand the **Security** node, then expand the **Credentials** node.</span></span>  
  
    2.  <span data-ttu-id="4944b-163">Cliquez avec le bouton droit sur \*\*UtilityAgentProxyCredential_ \<GUID> \*\* , puis sélectionnez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="4944b-163">Right-click on **UtilityAgentProxyCredential_\<GUID>** and select **Properties**.</span></span>  
  
    3.  <span data-ttu-id="4944b-164">Dans la boîte de dialogue Propriétés des informations d’identification, mettez à jour les informations d’identification nécessaires pour les informations d’identification de \*\*UtilityAgentProxyCredential_ \<GUID> \*\* .</span><span class="sxs-lookup"><span data-stu-id="4944b-164">On the Credential Properties dialog, update credentials as necessary for the **UtilityAgentProxyCredential_\<GUID>** credential.</span></span>  
  
    4.  <span data-ttu-id="4944b-165">Cliquez sur **OK** pour confirmer la modification.</span><span class="sxs-lookup"><span data-stu-id="4944b-165">Click **OK** to confirm the change.</span></span>  
  
-   <span data-ttu-id="4944b-166">TCP/IP doit être activé sur l'UCP et sur l'instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4944b-166">TCP/IP should be enabled on the UCP and on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="4944b-167">Activez TCP/IP via le Gestionnaire de configuration [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="4944b-167">Enable TCP/IP through [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   <span data-ttu-id="4944b-168">Le service SQL Server Browser sur l'UCP doit être démarré et configuré pour démarrer automatiquement.</span><span class="sxs-lookup"><span data-stu-id="4944b-168">The SQL Server Browser service on the UCP should be started and configured to start automatically.</span></span> <span data-ttu-id="4944b-169">Si votre organisation empêche d'utiliser le service SQL Server Browser, utilisez la procédure suivante pour autoriser une instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] à se connecter à l'UCP :</span><span class="sxs-lookup"><span data-stu-id="4944b-169">If your organization prevents use of the SQL Server Browser service, use the following steps to allow a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] to connect to the UCP:</span></span>  
  
    1.  <span data-ttu-id="4944b-170">Dans la barre des tâches Windows sur l’instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , cliquez sur **Démarrer**, puis sur **exécuter...**.</span><span class="sxs-lookup"><span data-stu-id="4944b-170">On the Windows taskbar on the managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], click **Start**, then click **Run...**.</span></span>  
  
    2.  <span data-ttu-id="4944b-171">Tapez « cliconfg.exe » dans l'espace fourni, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="4944b-171">Type "cliconfg.exe" in the space provided, then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="4944b-172">Si vous êtes invités à autoriser « SQL Client Configuration Utility EXE » à démarrer, cliquez sur «**Continuer**».</span><span class="sxs-lookup"><span data-stu-id="4944b-172">If prompted to allow "SQL Client Configuration Utility EXE" to start, click "**Continue**."</span></span>  
  
    4.  <span data-ttu-id="4944b-173">Dans la boîte de dialogue **SQL Server utilitaire réseau client** , sélectionnez l’onglet **alias** , puis cliquez sur **Ajouter..**..</span><span class="sxs-lookup"><span data-stu-id="4944b-173">On the **SQL Server Client Network Utility** dialog box, select the **Alias** tab, then click **Add...**.</span></span>  
  
    5.  <span data-ttu-id="4944b-174">Dans la boîte de dialogue **Ajouter la nouvelle configuration de la bibliothèque réseau** :</span><span class="sxs-lookup"><span data-stu-id="4944b-174">On the **Add Network Library Configuration** dialog box:</span></span>  
  
    6.  <span data-ttu-id="4944b-175">Spécifiez TCP/IP dans la liste des bibliothèques réseau.</span><span class="sxs-lookup"><span data-stu-id="4944b-175">Specify TCP/IP from the list of network libraries.</span></span>  
  
    7.  <span data-ttu-id="4944b-176">Spécifiez le ComputerName\InstanceName de l'UCP dans la zone de texte **Alias du serveur** .</span><span class="sxs-lookup"><span data-stu-id="4944b-176">Specify the ComputerName\InstanceName of the UCP in the **Server Alias** text box.</span></span>  
  
    8.  <span data-ttu-id="4944b-177">Spécifiez le ComputerName de l'UCP dans la zone de texte **Nom du serveur** .</span><span class="sxs-lookup"><span data-stu-id="4944b-177">Specify the ComputerName of the UCP in the **Server Name** text box.</span></span>  
  
    9. <span data-ttu-id="4944b-178">Désactivez la case à cocher **Déterminer le port de manière dynamique** .</span><span class="sxs-lookup"><span data-stu-id="4944b-178">Uncheck the **Dynamically determine port** checkbox.</span></span>  
  
    10. <span data-ttu-id="4944b-179">Spécifiez le numéro de port que l'UCP écoute dans la zone de texte **Numéro du port** .</span><span class="sxs-lookup"><span data-stu-id="4944b-179">Specify the port number that the UCP is listening on in the **Port number** text box.</span></span>  
  
    11. <span data-ttu-id="4944b-180">Cliquez sur **OK** pour enregistrer vos modifications.</span><span class="sxs-lookup"><span data-stu-id="4944b-180">Click **OK** to save your changes.</span></span>  
  
    12. <span data-ttu-id="4944b-181">Répétez ces étapes pour chaque instance gérée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] qui se connecte à un UCP où le service SQL Server Browser n'est pas activé.</span><span class="sxs-lookup"><span data-stu-id="4944b-181">Repeat these steps for each managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] that connects to a UCP where the SQL Server Browser service is not enabled.</span></span>  
  
-   <span data-ttu-id="4944b-182">Assurez-vous que les instances managées de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] sont connectées au réseau.</span><span class="sxs-lookup"><span data-stu-id="4944b-182">Ensure that managed instances of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] are connected to the network.</span></span>  
  
-   <span data-ttu-id="4944b-183">S'il existe des bases de données avec le même nom mais des paramètres différents de sensibilité à la casse sur une instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], l'identification entre la base de données et ses points de vue peut être incorrecte, ce qui provoque un échec de la collecte de données.</span><span class="sxs-lookup"><span data-stu-id="4944b-183">If there are databases with the same name but different case-sensitivity settings on a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the identification between the database and its viewpoints can be incorrect, resulting in failed data collection.</span></span> <span data-ttu-id="4944b-184">Par exemple, une base de données nommée « MYDATABASE » peut afficher des états d'intégrité pour une base de données nommée « MyDatabase ».</span><span class="sxs-lookup"><span data-stu-id="4944b-184">For example, a database named "MYDATABASE" might show health states for a database named "MyDatabase".</span></span> <span data-ttu-id="4944b-185">Aucune erreur n'est générée dans ce scénario.</span><span class="sxs-lookup"><span data-stu-id="4944b-185">No error is generated in this scenario.</span></span> <span data-ttu-id="4944b-186">L'échec de la collecte de données peut également résulter du non respect de la casse dans d'autres objets affichés dans l'UCP, comme fichier de base de données et les noms de groupes de fichiers.</span><span class="sxs-lookup"><span data-stu-id="4944b-186">Failed data collection can also result from case-sensitivity mismatches in other objects displayed in the UCP, like database file and file group names.</span></span>  
  
-   <span data-ttu-id="4944b-187">Si une instance managée de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] est hébergée sur un ordinateur Windows Server 2003, le compte du service [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent doit appartenir au groupe de sécurité Utilisateurs de l'Analyseur de performances ou au groupe local Administrateurs.</span><span class="sxs-lookup"><span data-stu-id="4944b-187">If a managed instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] is hosted on a Windows Server 2003 computer, then the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service account must belong to the Performance Monitor Users security group or the local Administrators group.</span></span> <span data-ttu-id="4944b-188">Sinon, la collecte de données échouera avec une erreur d'accès refusé.</span><span class="sxs-lookup"><span data-stu-id="4944b-188">Otherwise, data collection will fail with an access denied error.</span></span> <span data-ttu-id="4944b-189">Pour ajouter un compte du service [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent au groupe de sécurité Utilisateurs de l'Analyseur de performances, suivez la procédure suivante :</span><span class="sxs-lookup"><span data-stu-id="4944b-189">To add a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service account to the Performance Monitor Users security group, use the following steps:</span></span>  
  
    1.  <span data-ttu-id="4944b-190">Ouvrez **Gestion de l'ordinateur**, puis **Utilisateurs et groupes locaux**, puis **Groupes**.</span><span class="sxs-lookup"><span data-stu-id="4944b-190">Open **Computer Management**, then **Local Users and Groups**, then **Groups**.</span></span>  
  
    2.  <span data-ttu-id="4944b-191">Cliquez avec le bouton droit sur **Utilisateurs de l'Analyseur de performances** et sélectionnez **Ajouter au groupe**.</span><span class="sxs-lookup"><span data-stu-id="4944b-191">Right-click **Performance Monitor Users** and select **Add to Group**.</span></span>  
  
    3.  <span data-ttu-id="4944b-192">Cliquez sur **Add**.</span><span class="sxs-lookup"><span data-stu-id="4944b-192">Click **Add**.</span></span>  
  
    4.  <span data-ttu-id="4944b-193">Entrez le compte sous lequel le service Agent SQL Server s'exécute, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="4944b-193">Enter the account that the SQL Server Agent service is running under, then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="4944b-194">Si l'instance de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] a déjà été inscrite avec l'UCP avant d'ajouter l'utilisateur à ce groupe, redémarrez le service [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="4944b-194">If the instance of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] was already enrolled with the UCP before adding the user to this group, restart the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Agent service.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4944b-195">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4944b-195">See Also</span></span>  
 <span data-ttu-id="4944b-196">[Fonctionnalités et tâches de l'utilitaire SQL Server](../relational-databases/manage/sql-server-utility-features-and-tasks.md) </span><span class="sxs-lookup"><span data-stu-id="4944b-196">[SQL Server Utility Features and Tasks](../relational-databases/manage/sql-server-utility-features-and-tasks.md) </span></span>  
 [<span data-ttu-id="4944b-197">Résoudre les problèmes de contrôle d’intégrité de SQL Server &#40;utilitaire SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4944b-197">Troubleshoot SQL Server Resource Health &#40;SQL Server Utility&#41;</span></span>](../relational-databases/manage/troubleshoot-sql-server-resource-health-sql-server-utility.md)
