---
title: Réduire le temps d’arrêt pour les bases de données mises en miroir lors de la mise à niveau des instances de serveur | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- upgrading SQL Server, rolling upgrade of mirrored databases
- database mirroring [SQL Server], upgrading system
- rolling upgrades [SQL Server]
ms.assetid: 0e73bd23-497d-42f1-9e81-8d5314bcd597
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 0a343e6b9e93aa1910c82f436f3a50daf00d57bc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604136"
---
# <a name="minimize-downtime-for-mirrored-databases-when-upgrading-server-instances"></a><span data-ttu-id="e20cb-102">Réduire le temps d'indisponibilité des bases de données mises en miroir lors de la mise à niveau d'instances de serveur</span><span class="sxs-lookup"><span data-stu-id="e20cb-102">Minimize Downtime for Mirrored Databases When Upgrading Server Instances</span></span>
  <span data-ttu-id="e20cb-103">Lors de la mise à niveau d’instances de serveur vers [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , vous pouvez réduire le temps d’arrêt de chaque base de données mise en miroir à un seul basculement manuel en effectuant une mise à niveau séquentielle, appelée mise à niveau *propagée*.</span><span class="sxs-lookup"><span data-stu-id="e20cb-103">When upgrading server instances to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you can reduce downtime for each mirrored database to only a single manual failover by performing a sequential upgrade, known as a *rolling upgrade*.</span></span> <span data-ttu-id="e20cb-104">Une mise à niveau propagée est un processus en plusieurs étapes qui, dans sa forme la plus simple, consiste à mettre à niveau l'instance de serveur qui agit actuellement en tant que serveur miroir dans une session de mise en miroir, puis à basculer manuellement la base de données mise en miroir, à mettre à niveau l'ancien serveur principal et à reprendre la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-104">A rolling upgrade is a multi-stage process that in its simplest form involves upgrading the server instance that is currently acting as the mirror server in a mirroring session, then manually failing over the mirrored database, upgrading the former principal server, and resuming mirroring.</span></span> <span data-ttu-id="e20cb-105">En pratique, le processus exact dépend du mode d'opération, du nombre et de la disposition de sessions de mise en miroir qui s'exécutent sur les instances de serveur que vous mettez à niveau.</span><span class="sxs-lookup"><span data-stu-id="e20cb-105">In practice, the exact process will depend on the operating mode and the number and layout of mirroring session running on the server instances that you are upgrading.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e20cb-106">Pour plus d’informations sur l’exécution d’une mise à niveau propagée pour installer un Service Pack ou un correctif, consultez [installer un Service Pack sur un système avec un temps d’arrêt minimal pour les bases de données mises en miroir](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-106">For information about performing a rolling upgrade to install a service pack or hotfix, see [Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md).</span></span>  
  
 <span data-ttu-id="e20cb-107">**Préparation recommandée (Meilleures pratiques)**</span><span class="sxs-lookup"><span data-stu-id="e20cb-107">**Recommended Preparation (Best Practices)**</span></span>  
  
 <span data-ttu-id="e20cb-108">Avant de commencer une mise à niveau propagée, nous recommandons d'effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="e20cb-108">Before starting a rolling upgrade, we recommend that you:</span></span>  
  
1.  <span data-ttu-id="e20cb-109">Procédez à un essai de basculement manuel sur au moins une de vos sessions de mise en miroir :</span><span class="sxs-lookup"><span data-stu-id="e20cb-109">Perform a practice manual failover on at least one of your mirroring sessions:</span></span>  
  
    -   [<span data-ttu-id="e20cb-110">Basculer manuellement une session de mise en miroir de bases de données &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="e20cb-110">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
    -   <span data-ttu-id="e20cb-111">[Basculer manuellement une session de mise en miroir de bases de données &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-111">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e20cb-112">Pour plus d’informations sur le fonctionnement du basculement manuel, consultez [Basculement de rôle durant une session de mise en miroir de bases de données &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-112">For information about how manual failover works, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="e20cb-113">Protégez vos données :</span><span class="sxs-lookup"><span data-stu-id="e20cb-113">Protect your data:</span></span>  
  
    1.  <span data-ttu-id="e20cb-114">Effectuez une sauvegarde complète de chaque base de données principale :</span><span class="sxs-lookup"><span data-stu-id="e20cb-114">Perform a full database backup on every principal database:</span></span>  
  
         <span data-ttu-id="e20cb-115">[Créer une sauvegarde complète de base de données &#40;SQL Server&#41;](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-115">[Create a Full Database Backup &#40;SQL Server&#41;](../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md).</span></span>  
  
    2.  <span data-ttu-id="e20cb-116">Exécutez la commande [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) sur chaque base de données principale.</span><span class="sxs-lookup"><span data-stu-id="e20cb-116">Run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on every principal database.</span></span>  
  
 <span data-ttu-id="e20cb-117">**Étapes d'une mise à niveau propagée**</span><span class="sxs-lookup"><span data-stu-id="e20cb-117">**Stages of a Rolling Upgrade**</span></span>  
  
 <span data-ttu-id="e20cb-118">Les étapes spécifiques d'une mise à niveau propagée dépendent du mode d'opération de la configuration de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-118">The specific steps of a rolling upgrade depend on the operating mode of the mirroring configuration.</span></span> <span data-ttu-id="e20cb-119">Toutefois, les étapes de base sont les mêmes.</span><span class="sxs-lookup"><span data-stu-id="e20cb-119">However, the basic stages are the same.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e20cb-120">Pour plus d’informations sur les modes d’opération, consultez [Modes de fonctionnement de la mise en miroir de bases de données](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-120">For information about the operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="e20cb-121">L'organigramme suivant illustre les étapes de base d'une mise à niveau propagée pour chaque mode d'opération.</span><span class="sxs-lookup"><span data-stu-id="e20cb-121">The following illustration is a flowchart that shows the basic stages of a rolling upgrade for each operating mode.</span></span> <span data-ttu-id="e20cb-122">Les procédures correspondantes sont décrites après l'illustration.</span><span class="sxs-lookup"><span data-stu-id="e20cb-122">The corresponding procedures are described after the illustration.</span></span>  
  
 <span data-ttu-id="e20cb-123">![Organigramme illustrant les étapes d’une mise à niveau propagée](../media/dbm-rolling-upgrade.gif "Organigramme illustrant les étapes d’une mise à niveau propagée")</span><span class="sxs-lookup"><span data-stu-id="e20cb-123">![Flowchart showing steps of a rolling upgrade](../media/dbm-rolling-upgrade.gif "Flowchart showing steps of a rolling upgrade")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e20cb-124">Une instance de serveur peut remplir différents rôles de mise en miroir (serveur principal, serveur miroir ou témoin) dans des sessions de mise en miroir simultanées.</span><span class="sxs-lookup"><span data-stu-id="e20cb-124">A server instance might be performing different mirroring roles (principal server, mirror server, or witness) in concurrent mirroring sessions.</span></span> <span data-ttu-id="e20cb-125">Dans ce cas, vous devez adapter le processus de mise à niveau propagée de base en conséquence.</span><span class="sxs-lookup"><span data-stu-id="e20cb-125">In this case, you will have to adapt the basic rolling upgrade process accordingly.</span></span> <span data-ttu-id="e20cb-126">Pour plus d’informations, consultez [Basculement de rôle durant une session de mise en miroir de bases de données &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-126">For more information, see [Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md).</span></span>  
  
### <a name="to-change-a-session-from-high-performance-mode-to-high-safety-mode"></a><span data-ttu-id="e20cb-127">Pour faire passer une session du mode hautes performances en mode haute sécurité</span><span class="sxs-lookup"><span data-stu-id="e20cb-127">To change a session from high-performance mode to high-safety mode</span></span>  
  
1.  <span data-ttu-id="e20cb-128">Si une session de mise en miroir s'exécute en mode hautes performances, avant d'effectuer une mise à niveau propagée, convertissez le mode d'opération en mode haute sécurité sans basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="e20cb-128">If a mirroring session is running in high-performance mode, before you perform a rolling upgrade, change the operating mode to high safety without automatic failover.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e20cb-129">Si le serveur miroir est géographiquement distant du serveur principal, une mise à niveau propagée peut être inappropriée.</span><span class="sxs-lookup"><span data-stu-id="e20cb-129">If the mirror server is geographically distant from the principal server, a rolling upgrade might be inappropriate.</span></span>  
  
    -   <span data-ttu-id="e20cb-130">Dans [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] : affectez la valeur **Haute sécurité sans basculement automatique (synchrone)** à l’option **Mode d’opération** dans la [page Mise en miroir](../../relational-databases/databases/database-properties-mirroring-page.md) de la boîte de dialogue **Propriétés de la base de données**.</span><span class="sxs-lookup"><span data-stu-id="e20cb-130">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High safety without automatic failover (synchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span> <span data-ttu-id="e20cb-131">Pour plus d’informations sur la façon d’accéder à cette page, consultez [Démarrer l’Assistant Configuration de la sécurité de mise en miroir de bases de données &#40;SQL Server Management Studio&#41;](start-the-configuring-database-mirroring-security-wizard.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-131">For information about how to access this page, see [Start the Configuring Database Mirroring Security Wizard &#40;SQL Server Management Studio&#41;](start-the-configuring-database-mirroring-security-wizard.md).</span></span>  
  
    -   <span data-ttu-id="e20cb-132">Dans [!INCLUDE[tsql](../../includes/tsql-md.md)] : attribuez à la sécurité des transactions la valeur FULL.</span><span class="sxs-lookup"><span data-stu-id="e20cb-132">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Set transaction safety to FULL.</span></span> <span data-ttu-id="e20cb-133">Pour plus d’informations, consultez [Modifier la sécurité des transactions dans une session de mise en miroir de bases de données &#40;Transact-SQL&#41;](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-133">For more information, see [Change Transaction Safety in a Database Mirroring Session &#40;Transact-SQL&#41;](change-transaction-safety-in-a-database-mirroring-session-transact-sql.md)</span></span>  
  
### <a name="to-remove-a-witness-from-a-session"></a><span data-ttu-id="e20cb-134">Pour supprimer un témoin d'une session</span><span class="sxs-lookup"><span data-stu-id="e20cb-134">To remove a witness from a session</span></span>  
  
1.  <span data-ttu-id="e20cb-135">Si une session de mise en miroir fait intervenir un témoin, nous vous recommandons de le supprimer avant d'effectuer une mise à niveau propagée.</span><span class="sxs-lookup"><span data-stu-id="e20cb-135">If a mirroring session involves a witness, we recommend that you remove the witness before you perform a rolling upgrade.</span></span> <span data-ttu-id="e20cb-136">Sinon, lorsque l'instance de serveur miroir est mise à niveau, la disponibilité de la base de données dépend du témoin qui reste connecté à l'instance de serveur principal.</span><span class="sxs-lookup"><span data-stu-id="e20cb-136">Otherwise, when the mirror server instance is being upgraded, database availability depends on the witness that remains connected to the principal server instance.</span></span> <span data-ttu-id="e20cb-137">Après avoir supprimé un témoin, vous pouvez le mettre à niveau à tout moment pendant le processus de mise à niveau propagée sans risquer un temps mort de la base de données.</span><span class="sxs-lookup"><span data-stu-id="e20cb-137">After you remove a witness, you can upgrade it at any time during the rolling upgrade process without risking database downtime.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e20cb-138">Pour plus d’informations, consultez [Quorum : effets d’un témoin sur la disponibilité de la base de données &#40;Mise en miroir de bases de données&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="e20cb-138">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
    -   [<span data-ttu-id="e20cb-139">Supprimer le témoin d’une session de mise en miroir de bases de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e20cb-139">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
### <a name="to-perform-the-rolling-upgrade"></a><span data-ttu-id="e20cb-140">Pour effectuer la mise à niveau propagée</span><span class="sxs-lookup"><span data-stu-id="e20cb-140">To perform the rolling upgrade</span></span>  
  
1.  <span data-ttu-id="e20cb-141">Pour réduire le temps mort, nous vous recommandons d’appliquer la procédure suivante : démarrez la mise à niveau propagée en mettant à jour tout serveur partenaire de mise en miroir qui fait actuellement office de serveur miroir dans toutes ses sessions de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-141">To minimize downtime, we recommend the following: Start the rolling upgrade by updating any mirroring partner that is currently the mirror server in all its mirroring sessions.</span></span> <span data-ttu-id="e20cb-142">Vous pourriez devoir mettre à jour plusieurs instances de serveur à ce stade.</span><span class="sxs-lookup"><span data-stu-id="e20cb-142">You might have to update multiple server instances at this point.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e20cb-143">Un témoin peut être mis à niveau à tout moment au cours du processus de mise à niveau propagée.</span><span class="sxs-lookup"><span data-stu-id="e20cb-143">A witness can be upgraded at any point in the rolling upgrade process.</span></span> <span data-ttu-id="e20cb-144">Par exemple, si une instance de serveur est un serveur miroir dans la session 1 et un témoin dans la session 2, vous pouvez la mettre à niveau dès maintenant.</span><span class="sxs-lookup"><span data-stu-id="e20cb-144">For example, if a server instance is a mirror server in Session 1 and is a witness in Session 2, you can upgrade the server instance now.</span></span>  
  
     <span data-ttu-id="e20cb-145">L'instance de serveur à mettre à niveau en premier dépend de la configuration actuelle de vos sessions de mise en miroir, à savoir :</span><span class="sxs-lookup"><span data-stu-id="e20cb-145">The server instance to upgrade first depends on the current configuration of your mirroring sessions, as follows:</span></span>  
  
    -   <span data-ttu-id="e20cb-146">Si une instance de serveur est déjà le serveur miroir dans toutes ses sessions de mise en miroir, mettez-la à niveau vers la nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="e20cb-146">If any server instance is already the mirror server in all its mirroring sessions, upgrade the server instance to the new version.</span></span>  
  
    -   <span data-ttu-id="e20cb-147">Si toutes vos instances de serveur correspondent actuellement au serveur principal dans toutes les sessions de mise en miroir, sélectionnez une instance de serveur à mettre niveau en premier.</span><span class="sxs-lookup"><span data-stu-id="e20cb-147">If all your server instances are currently the principal server in any mirroring sessions, select one server instance to upgrade first.</span></span> <span data-ttu-id="e20cb-148">Ensuite, basculez manuellement chacune de ses bases de données principales et mettez à niveau cette instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="e20cb-148">Then, manually fail over each of its principal databases and upgrade that server instance.</span></span>  
  
     <span data-ttu-id="e20cb-149">Après sa mise à niveau, une instance de serveur réintègre automatiquement chacune de ses sessions de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-149">After being upgraded, a server instance automatically rejoins each of its mirroring sessions.</span></span>  
  
2.  <span data-ttu-id="e20cb-150">Attendez la synchronisation de chaque session de mise en miroir dont l'instance de serveur miroir vient d'être mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="e20cb-150">For each mirroring session whose mirror server instance has just been upgraded, wait for the session to synchronize.</span></span> <span data-ttu-id="e20cb-151">Puis, connectez-vous à l'instance de serveur principal, et basculez manuellement la session.</span><span class="sxs-lookup"><span data-stu-id="e20cb-151">Then, connect to the principal server instance, and manually fail over the session.</span></span> <span data-ttu-id="e20cb-152">Lors du basculement, l'instance de serveur mise à niveau devient le serveur principal pour cette session, et l'ancien serveur principal devient le serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-152">On failover, the upgraded server instance becomes the principal server for that session, and the former principal server becomes the mirror server.</span></span>  
  
     <span data-ttu-id="e20cb-153">Le but de cette étape est de permettre à une autre instance de serveur de devenir le serveur miroir dans chaque session de mise en miroir dans laquelle elle est un serveur partenaire.</span><span class="sxs-lookup"><span data-stu-id="e20cb-153">The goal of this step is for another server instance to become the mirror server in every mirroring session in which it is a partner.</span></span>  
  
     <span data-ttu-id="e20cb-154">**Restrictions après le basculement sur une instance de serveur mise à niveau.**</span><span class="sxs-lookup"><span data-stu-id="e20cb-154">**Restrictions after you failover to an upgraded server instance.**</span></span>  
  
     <span data-ttu-id="e20cb-155">Après un basculement à partir d'une instance de serveur antérieure vers une instance de serveur [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , la session de base de données est interrompue.</span><span class="sxs-lookup"><span data-stu-id="e20cb-155">After failing over from an earlier server instance to a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] server instance, the database session is suspended.</span></span> <span data-ttu-id="e20cb-156">Elle ne peut pas reprendre tant que l'autre serveur partenaire n'a pas été mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="e20cb-156">It cannot be resumed until the other partner has been upgraded.</span></span> <span data-ttu-id="e20cb-157">Toutefois, le serveur principal accepte encore des connexions et autorise l'accès aux données et des modifications sur la base de données principale.</span><span class="sxs-lookup"><span data-stu-id="e20cb-157">However, the principal server is still accepting connections and allowing data access and modifications on the principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e20cb-158">L'établissement d'une nouvelle session de mise en miroir requiert que toutes les instances de serveur exécutent la même version de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e20cb-158">Establishing a new mirroring session requires that the server instances all be running the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
3.  <span data-ttu-id="e20cb-159">Une fois le basculement effectué, nous vous recommandons d’exécuter la commande [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) sur la base de données theprincipal.</span><span class="sxs-lookup"><span data-stu-id="e20cb-159">After you fail over, we recommend that you run the [DBCC CHECKDB](/sql/t-sql/database-console-commands/dbcc-checkdb-transact-sql) command on theprincipal database.</span></span>  
  
4.  <span data-ttu-id="e20cb-160">Mettez à niveau chaque instance de serveur qui est désormais le serveur miroir dans toutes les sessions de mise en miroir dans lesquelles elle est un serveur partenaire.</span><span class="sxs-lookup"><span data-stu-id="e20cb-160">Upgrade each server instance that is now the mirror server in all mirroring sessions in which it is a partner.</span></span> <span data-ttu-id="e20cb-161">Vous pourriez devoir mettre à jour plusieurs serveurs à ce stade.</span><span class="sxs-lookup"><span data-stu-id="e20cb-161">You might have to update multiple servers at this point.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="e20cb-162">Dans une configuration de mise en miroir complexe, certaines instances de serveur pourraient encore être le serveur principal d'origine dans une ou plusieurs sessions de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-162">In a complex mirroring configuration, some server instance might still be the original principal server in one or more mirroring sessions.</span></span> <span data-ttu-id="e20cb-163">Répétez les étapes 2 à 4 pour ces instances de serveur jusqu’à ce que toutes les instances concernées soient mises à niveau.</span><span class="sxs-lookup"><span data-stu-id="e20cb-163">Repeat steps 2-4 for those server instances until all instances involved are upgraded.</span></span>  
  
5.  <span data-ttu-id="e20cb-164">Reprenez la session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-164">Resume the mirroring session.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e20cb-165">Le basculement automatique ne fonctionne pas tant que le témoin n'a pas été mis à niveau et de nouveau ajouté à la session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-165">Automatic failover will not work until the witness has been upgraded and added back into the mirroring session.</span></span>  
  
6.  <span data-ttu-id="e20cb-166">Mettez à niveau toute instance de serveur restante qui est le témoin dans toutes ses sessions de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-166">Upgrade any remaining server instance that is the witness in all its mirroring sessions.</span></span> <span data-ttu-id="e20cb-167">Une fois qu'un témoin mis à niveau a réintégré une session de mise en miroir, il est de nouveau possible d'effectuer un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="e20cb-167">After an upgraded witness rejoins a mirroring session, automatic failover becomes possible again.</span></span> <span data-ttu-id="e20cb-168">Vous pourriez devoir mettre à jour plusieurs serveurs à ce stade.</span><span class="sxs-lookup"><span data-stu-id="e20cb-168">You might have to update multiple servers at this point.</span></span>  
  
### <a name="to-return-a-session-to-high-performance-mode"></a><span data-ttu-id="e20cb-169">Pour rétablir le mode hautes performances d'une session</span><span class="sxs-lookup"><span data-stu-id="e20cb-169">To return a session to high-performance mode</span></span>  
  
1.  <span data-ttu-id="e20cb-170">Rétablissez éventuellement le mode hautes performances en appliquant l'une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="e20cb-170">Optionally, return to high-performance mode by using one of the following methods:</span></span>  
  
    -   <span data-ttu-id="e20cb-171">Dans [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] : affectez la valeur **Haute performance (asynchrone)** à l’option **Mode d’opération** dans la [page Mise en miroir](../../relational-databases/databases/database-properties-mirroring-page.md) de la boîte de dialogue **Propriétés de la base de données**.</span><span class="sxs-lookup"><span data-stu-id="e20cb-171">In [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]: Change the **Operating mode** option to **High performance (asynchronous)** by using the [Mirroring Page](../../relational-databases/databases/database-properties-mirroring-page.md) of the **Database Properties** dialog box.</span></span>  
  
    -   <span data-ttu-id="e20cb-172">Dans [!INCLUDE[tsql](../../includes/tsql-md.md)] : utilisez l’instruction [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) pour désactiver (OFF) la sécurité des transactions.</span><span class="sxs-lookup"><span data-stu-id="e20cb-172">In [!INCLUDE[tsql](../../includes/tsql-md.md)]: Use [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring)to set transaction safety to OFF.</span></span>  
  
### <a name="to-add-a-witness-back-into-a-mirroring-session"></a><span data-ttu-id="e20cb-173">Pour ajouter de nouveau un témoin dans une session de mise en miroir</span><span class="sxs-lookup"><span data-stu-id="e20cb-173">To add a witness back into a mirroring session</span></span>  
  
1.  <span data-ttu-id="e20cb-174">En mode haute sécurité, rétablissez éventuellement le témoin sur chaque session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="e20cb-174">Optionally, in high-safety mode, reestablish the witness to each mirroring session.</span></span>  
  
     <span data-ttu-id="e20cb-175">**Pour réintégrer un témoin**</span><span class="sxs-lookup"><span data-stu-id="e20cb-175">**To return a witness**</span></span>  
  
    -   [<span data-ttu-id="e20cb-176">Ajouter ou remplacer un témoin de mise en miroir de bases de données &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="e20cb-176">Add or Replace a Database Mirroring Witness &#40;SQL Server Management Studio&#41;</span></span>](add-or-replace-a-database-mirroring-witness-sql-server-management-studio.md)  
  
    -   [<span data-ttu-id="e20cb-177">Ajouter un témoin de mise en miroir de bases de données à l’aide de l’authentification Windows &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e20cb-177">Add a Database Mirroring Witness Using Windows Authentication &#40;Transact-SQL&#41;</span></span>](add-a-database-mirroring-witness-using-windows-authentication-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="e20cb-178">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e20cb-178">See Also</span></span>  
 <span data-ttu-id="e20cb-179">[Mise en miroir de bases de données ALTER DATABASE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span><span class="sxs-lookup"><span data-stu-id="e20cb-179">[ALTER DATABASE Database Mirroring &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-database-transact-sql-database-mirroring) </span></span>  
 <span data-ttu-id="e20cb-180">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e20cb-180">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="e20cb-181">[Afficher l’état d’une base de données mise en miroir &#40;SQL Server Management Studio&#41;](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-181">[View the State of a Mirrored Database &#40;SQL Server Management Studio&#41;](view-the-state-of-a-mirrored-database-sql-server-management-studio.md) </span></span>  
 <span data-ttu-id="e20cb-182">[Mise en miroir de bases de données &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-182">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 <span data-ttu-id="e20cb-183">[Installer un Service Pack sur un système avec un temps d’arrêt minimal pour les bases de données mises en miroir](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-183">[Install a Service Pack on a System with Minimal Downtime for Mirrored Databases](../install-a-service-pack-on-a-system-with-minimal-downtime-for-mirrored-databases.md) </span></span>  
 <span data-ttu-id="e20cb-184">[Basculement de rôle durant une session de mise en miroir de bases de données &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-184">[Role Switching During a Database Mirroring Session &#40;SQL Server&#41;](role-switching-during-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="e20cb-185">[Forcer le service dans une session de mise en miroir de bases de données &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-185">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md) </span></span>  
 <span data-ttu-id="e20cb-186">[Démarrer le moniteur de mise en miroir de bases de données &#40;SQL Server Management Studio&#41;](start-database-mirroring-monitor-sql-server-management-studio.md) </span><span class="sxs-lookup"><span data-stu-id="e20cb-186">[Start Database Mirroring Monitor &#40;SQL Server Management Studio&#41;](start-database-mirroring-monitor-sql-server-management-studio.md) </span></span>  
 [<span data-ttu-id="e20cb-187">Modes de fonctionnement de la mise en miroir de bases de données</span><span class="sxs-lookup"><span data-stu-id="e20cb-187">Database Mirroring Operating Modes</span></span>](database-mirroring-operating-modes.md)  
  
  
