---
title: Basculement de rôle durant une session de mise en miroir de bases de données (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
- mirroring partners [SQL Server]
- failover [SQL Server]
- failover partners [SQL Server]
- database mirroring [SQL Server], partners
- partners in database mirroring sessions [SQL Server]
- failover [SQL Server], database mirroring
- database mirroring [SQL Server], failover
ms.assetid: a782d60d-0373-4386-bd77-9ec192553700
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 5e16adbad2106d623279edf9d443eae3755c7be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87701790"
---
# <a name="role-switching-during-a-database-mirroring-session-sql-server"></a><span data-ttu-id="4d79a-102">Basculement de rôle durant une session de mise en miroir de bases de données (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="4d79a-102">Role Switching During a Database Mirroring Session (SQL Server)</span></span>
  <span data-ttu-id="4d79a-103">Dans le contexte d'une session de mise en miroir de bases de données, le rôle principal et le rôle miroir sont généralement interchangeables lors d'un processus appelé *basculement de rôle*.</span><span class="sxs-lookup"><span data-stu-id="4d79a-103">Within the context of a database mirroring session, the principal and mirror roles are typically interchangeable in a process known as *role switching*.</span></span> <span data-ttu-id="4d79a-104">Dans une situation de basculement de rôle, le serveur miroir est le *partenaire de basculement* du serveur principal ; il adopte le rôle principal, en récupérant sa copie de la base de données et en la mettant en ligne en tant que nouvelle base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-104">In role switching, the mirror server acts as the *failover partner* for the principal server, taking over the principal role, recovering its copy of the database and bringing it online as the new principal database.</span></span> <span data-ttu-id="4d79a-105">L'ancien serveur principal (s'il est disponible) joue le rôle de serveur miroir, et sa base de données devient la nouvelle base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-105">The former principal server, when available, assumes the mirror role, and its database becomes the new mirror database.</span></span> <span data-ttu-id="4d79a-106">Les rôles peuvent éventuellement basculer plusieurs fois, soit en réponse à plusieurs défaillances, soit pour des raisons administratives.</span><span class="sxs-lookup"><span data-stu-id="4d79a-106">Potentially, the roles can switch back and forth either in response to multiple failures or for administrative purposes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4d79a-107">Cette rubrique suppose que vous connaissez bien les modes de fonctionnement de la mise en miroir de base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-107">This topic assumes that you are familiar with the database mirroring operating modes.</span></span> <span data-ttu-id="4d79a-108">Pour plus d'informations, voir [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-108">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
 <span data-ttu-id="4d79a-109">L’illustration suivante représente des serveurs partenaires de mise en miroir, **Partner_A** et **Partner_B**, qui s’échangent les rôles de serveur principal et serveur miroir lors d’une série de basculements automatiques ou manuels.</span><span class="sxs-lookup"><span data-stu-id="4d79a-109">The following illustration shows mirroring partners, **Partner_A** and **Partner_B**, switching the principal and mirror roles over a series of automatic or manual failovers.</span></span>  
  
 <span data-ttu-id="4d79a-110">![Serveurs partenaires basculant à deux reprises entre des rôles](../media/dbm-roleswitching.gif "Serveurs partenaires basculant à deux reprises entre des rôles")</span><span class="sxs-lookup"><span data-stu-id="4d79a-110">![Partners switching twice between roles](../media/dbm-roleswitching.gif "Partners switching twice between roles")</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="4d79a-111">Après un basculement de rôle, les travaux qui s'exécutaient sur l'ancienne base de données principale doivent être recréés sur le nouveau serveur principal pour y être exécutés.</span><span class="sxs-lookup"><span data-stu-id="4d79a-111">After a role switch, jobs that ran on the former principal database must be recreated on the new principal server to run there.</span></span> <span data-ttu-id="4d79a-112">Pour plus d’informations, consultez [Gestion des connexions et des travaux après un basculement de rôle &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-112">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="4d79a-113">Il existe trois types de basculement de rôle : le basculement automatique, le basculement manuel et le service forcé (avec perte de données possible).</span><span class="sxs-lookup"><span data-stu-id="4d79a-113">Three types of role switching exist: automatic failover, manual failover, and forced service (with possible data loss).</span></span> <span data-ttu-id="4d79a-114">La prise en charge de chaque type de basculement dépend du mode de fonctionnement d'une session.</span><span class="sxs-lookup"><span data-stu-id="4d79a-114">Support for each form depends on the operating mode of the session.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4d79a-115">Si vous ne connaissez pas bien ces modes de fonctionnement, consultez [Modes de fonctionnement de la mise en miroir de bases de données](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-115">If you are unfamiliar with these operating modes, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="4d79a-116">**Basculement manuel**</span><span class="sxs-lookup"><span data-stu-id="4d79a-116">**Manual failover**</span></span>  
  
     <span data-ttu-id="4d79a-117">Le mode haute sécurité prend en charge le basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="4d79a-117">High-safety mode supports manual failover.</span></span> <span data-ttu-id="4d79a-118">Chaque fois que la base de données est synchronisée, le propriétaire de la base de données peut entreprendre un basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="4d79a-118">Whenever the database is synchronized, the database owner can initiate a manual failover.</span></span>  
  
     <span data-ttu-id="4d79a-119">Le basculement manuel est adopté pour des raisons administratives.</span><span class="sxs-lookup"><span data-stu-id="4d79a-119">Manual failover is provided for administrative purposes.</span></span> <span data-ttu-id="4d79a-120">Pour plus d’informations, consultez [Basculement manuel](#ManualFailover), plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-120">For more information, see [Manual Failover](#ManualFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="4d79a-121">**Basculement automatique**</span><span class="sxs-lookup"><span data-stu-id="4d79a-121">**Automatic failover**</span></span>  
  
     <span data-ttu-id="4d79a-122">En présence d'un témoin, le mode haute sécurité prend en charge le basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-122">In the presence of a witness, high-safety mode supports automatic failover.</span></span> <span data-ttu-id="4d79a-123">Celui-ci intervient suite à la perte du serveur principal, si les serveurs témoin et miroir sont toujours connectés entre eux et que la base de données est déjà synchronisée.</span><span class="sxs-lookup"><span data-stu-id="4d79a-123">Automatic failover occurs only on the loss of the principal server when the witness and mirror server are still connected to each other and the database is already synchronized.</span></span> <span data-ttu-id="4d79a-124">Pour plus d’informations, consultez [Basculement automatique](#AutomaticFailover), plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-124">For more information, see [Automatic Failover](#AutomaticFailover), later in this topic.</span></span>  
  
-   <span data-ttu-id="4d79a-125">**Service forcé (avec perte de données possible)**</span><span class="sxs-lookup"><span data-stu-id="4d79a-125">**Forced service (with possible data loss)**</span></span>  
  
     <span data-ttu-id="4d79a-126">Un service forcé est pris en charge en mode haute sécurité lorsqu'aucun témoin n'est défini en mode haute performance.</span><span class="sxs-lookup"><span data-stu-id="4d79a-126">Forcing service is supported in high-safety mode when no witness is set and in high-performance mode.</span></span> <span data-ttu-id="4d79a-127">Suite à la perte du serveur principal, le propriétaire de la base de données peut rendre la base de données disponible en forçant le service sur le serveur miroir (avec possibilité de perte de données).</span><span class="sxs-lookup"><span data-stu-id="4d79a-127">On the loss of the principal server, the database owner can make the database available by forcing service to the mirror server (with possible data loss).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-128">Nous vous recommandons de définir la propriété WITNESS sur OFF en mode haute performance.</span><span class="sxs-lookup"><span data-stu-id="4d79a-128">We recommend that the WITNESS property be set to OFF in high-performance mode.</span></span> <span data-ttu-id="4d79a-129">Sinon, pour mettre la base de données en ligne, le serveur miroir doit être connecté au témoin.</span><span class="sxs-lookup"><span data-stu-id="4d79a-129">Otherwise, to bring the database online, the mirror server must connected to the witness.</span></span>  
  
     <span data-ttu-id="4d79a-130">Pour plus d’informations, consultez [Service forcé (avec possible perte de données)](#ForcedService), plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-130">For more information, see [Forced Service (with Possible Data Loss)](#ForcedService), later in this topic.</span></span>  
  
 <span data-ttu-id="4d79a-131">Le tableau ci-dessous résume les types de basculement pris en charge dans chaque mode de fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="4d79a-131">The following table summarizes which forms of failover are supported under each of the operating modes.</span></span>  
  
||<span data-ttu-id="4d79a-132">Hautes performances</span><span class="sxs-lookup"><span data-stu-id="4d79a-132">High performance</span></span>|<span data-ttu-id="4d79a-133">Mode haute performance sans témoin</span><span class="sxs-lookup"><span data-stu-id="4d79a-133">High-safety mode without a witness</span></span>|<span data-ttu-id="4d79a-134">Mode haute performance avec témoin</span><span class="sxs-lookup"><span data-stu-id="4d79a-134">High-safety mode with a witness</span></span>|  
|-|----------------------|-----------------------------------------|--------------------------------------|  
|<span data-ttu-id="4d79a-135">Basculement automatique</span><span class="sxs-lookup"><span data-stu-id="4d79a-135">Automatic failover</span></span>|<span data-ttu-id="4d79a-136">Non</span><span class="sxs-lookup"><span data-stu-id="4d79a-136">No</span></span>|<span data-ttu-id="4d79a-137">Non</span><span class="sxs-lookup"><span data-stu-id="4d79a-137">No</span></span>|<span data-ttu-id="4d79a-138">Oui</span><span class="sxs-lookup"><span data-stu-id="4d79a-138">Yes</span></span>|  
|<span data-ttu-id="4d79a-139">Basculement manuel</span><span class="sxs-lookup"><span data-stu-id="4d79a-139">Manual failover</span></span>|<span data-ttu-id="4d79a-140">Non</span><span class="sxs-lookup"><span data-stu-id="4d79a-140">No</span></span>|<span data-ttu-id="4d79a-141">Oui</span><span class="sxs-lookup"><span data-stu-id="4d79a-141">Yes</span></span>|<span data-ttu-id="4d79a-142">Oui</span><span class="sxs-lookup"><span data-stu-id="4d79a-142">Yes</span></span>|  
|<span data-ttu-id="4d79a-143">Service forcé</span><span class="sxs-lookup"><span data-stu-id="4d79a-143">Forced service</span></span>|<span data-ttu-id="4d79a-144">Oui</span><span class="sxs-lookup"><span data-stu-id="4d79a-144">Yes</span></span>|<span data-ttu-id="4d79a-145">Oui</span><span class="sxs-lookup"><span data-stu-id="4d79a-145">Yes</span></span>|<span data-ttu-id="4d79a-146">Non</span><span class="sxs-lookup"><span data-stu-id="4d79a-146">No</span></span>|  
  
 <span data-ttu-id="4d79a-147">Après un basculement de rôle, certaines métadonnées doivent exister sur les deux partenaires pour garantir que tous les utilisateurs de base de données peuvent accéder à la nouvelle base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-147">After a role switch, certain metadata must exist on both partners to ensure that all of the database users can access the new principal database.</span></span> <span data-ttu-id="4d79a-148">De plus, des travaux de sauvegarde doivent être créés sur le nouveau serveur principal pour garantir que la base de données continue d'être sauvegardée régulièrement.</span><span class="sxs-lookup"><span data-stu-id="4d79a-148">In addition, backup jobs must be created on the new principal server, to ensure that the database continues to be backed up on its regular schedule.</span></span> <span data-ttu-id="4d79a-149">Pour plus d’informations, consultez [Gestion des connexions et des travaux après un basculement de rôle &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-149">For more information, see [Management of Logins and Jobs After Role Switching &#40;SQL Server&#41;](../../sql-server/failover-clusters/management-of-logins-and-jobs-after-role-switching-sql-server.md).</span></span>  
  
 <span data-ttu-id="4d79a-150">Au cours d'un basculement de rôle, la durée pendant laquelle la mise en miroir de base de données sera hors service dépend du type de basculement de rôle et de sa raison.</span><span class="sxs-lookup"><span data-stu-id="4d79a-150">During a role switch, the amount of time that database mirroring will be out of service depends on the type of role switching and on the cause.</span></span> <span data-ttu-id="4d79a-151">Pour en savoir plus, voir [Estimer l’interruption de service au cours d’un basculement de rôle &#40;mise en miroir de bases de données&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-151">For more information, see [Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md).</span></span>  
  
##  <a name="manual-failover"></a><a name="ManualFailover"></a> <span data-ttu-id="4d79a-152">Manual Failover</span><span class="sxs-lookup"><span data-stu-id="4d79a-152">Manual Failover</span></span>  
 <span data-ttu-id="4d79a-153">Le basculement manuel déconnecte les clients de la base de données et inverse les rôles des partenaires.</span><span class="sxs-lookup"><span data-stu-id="4d79a-153">Manual failover disconnects the clients from the database and reverses the roles of the partners.</span></span> <span data-ttu-id="4d79a-154">Seul le mode haute sécurité prend en charge le basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="4d79a-154">Only high-safety mode supports manual failover.</span></span>  
  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="AvailabilityDuringUpgrades"></a> <span data-ttu-id="4d79a-155">Maintien de la disponibilité lors des mises à niveau</span><span class="sxs-lookup"><span data-stu-id="4d79a-155">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="4d79a-156">L'administrateur de base de données peut recourir au basculement manuel pour mettre du matériel ou des logiciels à niveau sans sacrifier la disponibilité.</span><span class="sxs-lookup"><span data-stu-id="4d79a-156">The database administrator can use manual failover for upgrading hardware or software without sacrificing availability.</span></span> <span data-ttu-id="4d79a-157">Pour utiliser la mise en miroir de base de données dans le cadre de mises à niveau logicielles, le serveur miroir et/ou le système doivent déjà avoir été mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="4d79a-157">To use database mirroring for software upgrades, the mirror server and/or system must have already received the upgrades.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4d79a-158">La fonction de mise en miroir de bases de données doit être en mesure d'effectuer une mise à niveau propagée mais sans le garantir puisque les modifications à apporter ultérieurement ne sont pas connues.</span><span class="sxs-lookup"><span data-stu-id="4d79a-158">Database mirroring should be able to do a rolling upgrade, but this is not guaranteed, because future changes are unknown.</span></span> <span data-ttu-id="4d79a-159">Pour plus d'informations, voir [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-159">For more information, see [Minimize Downtime for Mirrored Databases When Upgrading Server Instances](upgrading-mirrored-instances.md).</span></span>  
  
 <span data-ttu-id="4d79a-160">L'illustration suivante montre une instance qui utilise le basculement manuel pour maintenir la disponibilité d'une base de données pendant la mise à niveau d'une instance serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-160">The following figure illustrates an instance of using manual failover to maintain database availability while you upgrade a database server instance.</span></span> <span data-ttu-id="4d79a-161">Lorsque la mise à niveau est terminée, un administrateur peut éventuellement basculer à nouveau vers l'instance serveur d'origine.</span><span class="sxs-lookup"><span data-stu-id="4d79a-161">When the upgrade is completed, an administrator may optionally fail over back to the original server instance.</span></span> <span data-ttu-id="4d79a-162">Ceci est utile lorsque l'administrateur veut arrêter la session de mise en miroir et utiliser le serveur de miroir ailleurs.</span><span class="sxs-lookup"><span data-stu-id="4d79a-162">This is useful when the administrator wants to stop the mirroring session and use the mirror server elsewhere.</span></span> <span data-ttu-id="4d79a-163">De cette façon, une instance serveur donnée peut être utilisée à plusieurs reprises lors de la mise à jour d'une série d'instances serveur de base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-163">In this way, a single server instance can be used repeatedly when updating a series of database server instances.</span></span>  
  
 <span data-ttu-id="4d79a-164">![Basculement manuel planifié](../media/dbm-failovmanuplanned.gif "Basculement manuel planifié")</span><span class="sxs-lookup"><span data-stu-id="4d79a-164">![Planned manual failover](../media/dbm-failovmanuplanned.gif "Planned manual failover")</span></span>  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ConditionsForManualFo"></a> <span data-ttu-id="4d79a-165">Conditions requises pour un basculement manuel</span><span class="sxs-lookup"><span data-stu-id="4d79a-165">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="4d79a-166">Le basculement manuel nécessite que la sécurité de transaction soit définie sur FULL (c'est-à-dire, mode haute sécurité).</span><span class="sxs-lookup"><span data-stu-id="4d79a-166">Manual failover requires transaction safety to be set to FULL (that is, high-safety mode).</span></span> <span data-ttu-id="4d79a-167">Lorsque les partenaires sont connectés et que la base de données est déjà synchronisée, un basculement manuel est possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-167">When the partners are connected and the database is already synchronized, manual failover is supported.</span></span>  
  
###  <a name="how-manual-failover-works"></a><a name="HowManualFoWorks"></a> <span data-ttu-id="4d79a-168">Fonctionnement du basculement manuel</span><span class="sxs-lookup"><span data-stu-id="4d79a-168">How Manual Failover Works</span></span>  
 <span data-ttu-id="4d79a-169">Le basculement manuel initialise la série d'actions suivante :</span><span class="sxs-lookup"><span data-stu-id="4d79a-169">Manual failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="4d79a-170">Le serveur principal déconnecte les clients de la base de données principale, envoie la fin du journal au serveur miroir, puis définit l'état de la mise en miroir à SYNCHRONIZING pour se préparer à prendre le rôle miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-170">The principal server disconnects clients from the principal database, sends the tail of the log to the mirror server, and, in preparation for switching to the mirror role, sets the mirroring state to SYNCHRONIZING.</span></span>  
  
2.  <span data-ttu-id="4d79a-171">Le serveur miroir enregistre le numéro séquentiel dans le journal du dernier enregistrement journal reçu du principal en tant que numéro séquentiel de basculement.</span><span class="sxs-lookup"><span data-stu-id="4d79a-171">The mirror server records the log sequence number (LSN) of the last log record received from the principal as the failover LSN.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-172">Pour afficher ce numéro séquentiel dans le journal, sélectionnez la colonne **mirroring_failover_lsn** de [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="4d79a-172">To view this LSN, select the **mirroring_failover_lsn** column from [sys.database_mirroring &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql).</span></span>  
  
3.  <span data-ttu-id="4d79a-173">Si un journal est en attente dans la file d'attente de restauration par progression, le serveur miroir termine la restauration par progression de la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-173">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span> <span data-ttu-id="4d79a-174">Le temps requis pour cette opération dépend de la vitesse du système, de la charge de travail récente et de la quantité de journal au sein de la file d'attente de restauration par progression.</span><span class="sxs-lookup"><span data-stu-id="4d79a-174">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the redo queue.</span></span> <span data-ttu-id="4d79a-175">Dans le cadre d'un mode de fonctionnement synchrone, le temps de basculement peut être régulé en limitant la taille de la file d'attente de restauration par progression.</span><span class="sxs-lookup"><span data-stu-id="4d79a-175">For a synchronous operating mode, the failover time can be regulated by limiting the size of the redo queue.</span></span> <span data-ttu-id="4d79a-176">Cependant, cela peut entraîner le serveur principal à ralentir pour permettre au serveur miroir de suivre.</span><span class="sxs-lookup"><span data-stu-id="4d79a-176">However, this can cause the principal server to slow down to allow the mirror server to keep up.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-177">Pour connaître la taille actuelle de la file d’attente de restauration par progression, utilisez le compteur de performance **File d’attente de restauration par progression** de l’objet de performance de mise en miroir de bases de données (pour plus d’informations, consultez [Surveillance de la mise en miroir de bases de données &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span><span class="sxs-lookup"><span data-stu-id="4d79a-177">To learn the current size of the redo queue, use the **Redo Queue** performance counter in the database mirroring performance object (for more information, see [Monitoring Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md)).</span></span>  
  
4.  <span data-ttu-id="4d79a-178">Le serveur miroir devient le nouveau serveur principal, et l'ancien serveur principal devient le nouveau serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-178">The mirror server becomes the new principal server, and the former principal server becomes the new mirror server.</span></span>  
  
5.  <span data-ttu-id="4d79a-179">Le nouveau serveur principal restaure toute transaction non validée et met la copie de sa base de données en ligne, en tant que base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-179">The new principal server rolls back any uncommitted transactions and brings its copy of the database online as the principal database.</span></span>  
  
6.  <span data-ttu-id="4d79a-180">L'ancien principal prend le rôle de miroir et l'ancienne base de données principale devient la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-180">The former principal takes on the mirror role, and the former principal database becomes the mirror database.</span></span> <span data-ttu-id="4d79a-181">Le nouveau serveur miroir resynchronise rapidement la nouvelle base de données miroir avec la nouvelle base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-181">The new mirror server quickly resynchronizes the new mirror database with the new principal database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-182">Dès que le nouveau serveur miroir a resynchronisé les bases de données, le basculement est de nouveau possible, mais dans le sens inverse.</span><span class="sxs-lookup"><span data-stu-id="4d79a-182">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="4d79a-183">Après le basculement, les clients doivent se reconnecter à la base de données principale actuelle.</span><span class="sxs-lookup"><span data-stu-id="4d79a-183">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="4d79a-184">Pour en savoir plus, voir [Connecter des clients à une session de mise en miroir de bases de données &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-184">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
 <span data-ttu-id="4d79a-185">**Pour initialiser un basculement manuel**</span><span class="sxs-lookup"><span data-stu-id="4d79a-185">**To initiate manual failover**</span></span>  
  
-   [<span data-ttu-id="4d79a-186">Basculer manuellement une session de mise en miroir de bases de données &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-186">Manually Fail Over a Database Mirroring Session &#40;SQL Server Management Studio&#41;</span></span>](manually-fail-over-a-database-mirroring-session-sql-server-management-studio.md)  
  
-   <span data-ttu-id="4d79a-187">[Basculer manuellement une session de mise en miroir de bases de données &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-187">[Manually Fail Over a Database Mirroring Session &#40;Transact-SQL&#41;](manually-fail-over-a-database-mirroring-session-transact-sql.md).</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="4d79a-188">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="4d79a-188">Automatic Failover</span></span>  
 <span data-ttu-id="4d79a-189">Le basculement automatique est pris en charge uniquement dans les sessions de mise en miroir de bases de données s’exécutant avec un témoin et en mode haute sécurité (*mode haute sécurité avec basculement automatique*).</span><span class="sxs-lookup"><span data-stu-id="4d79a-189">Automatic failover is supported only in database mirroring sessions running with a witness in high-safety mode (*high-safety mode with automatic failover*).</span></span> <span data-ttu-id="4d79a-190">En mode haute sécurité avec basculement automatique, une fois la base de données synchronisée, si la base de données principale devient non disponible, le basculement automatique se produit.</span><span class="sxs-lookup"><span data-stu-id="4d79a-190">In high-safety mode with automatic failover, once the database is synchronized, if the principal database becomes unavailable, an automatic failover occurs.</span></span> <span data-ttu-id="4d79a-191">Lors d'un basculement automatique, le serveur miroir assume le rôle de serveur principal et met en ligne sa copie de la base de données en tant que base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-191">An automatic failover causes the mirror server to take over the role of principal server and bring its copy of the database online as the principal database.</span></span> <span data-ttu-id="4d79a-192">Exiger la synchronisation de la base de données empêche toute perte de données lors du basculement, car chaque transaction validée sur la base de données principale est également validée sur la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-192">Requiring that the database be synchronized prevents data loss during failover, because every transaction committed on the principal database is also committed on the mirror database.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="4d79a-193">Pour que le basculement automatique améliore la fiabilité, les bases de données miroir et principale doivent résider sur des ordinateurs distincts.</span><span class="sxs-lookup"><span data-stu-id="4d79a-193">For automatic failover to improve reliability, the mirror and principal databases must reside on different computers.</span></span>  
  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="ConditionsForAutoFo"></a> <span data-ttu-id="4d79a-194">Conditions requises pour un basculement automatique</span><span class="sxs-lookup"><span data-stu-id="4d79a-194">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="4d79a-195">Le basculement automatique nécessite les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="4d79a-195">Automatic failover requires the following conditions:</span></span>  
  
-   <span data-ttu-id="4d79a-196">La session de mise en miroir de bases de données doit s'exécuter en mode haute sécurité et doit posséder un témoin.</span><span class="sxs-lookup"><span data-stu-id="4d79a-196">The database mirroring session must be running in high-safety mode and must possess a witness.</span></span> <span data-ttu-id="4d79a-197">Pour plus d'informations, voir [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-197">For more information, see [Database Mirroring Operating Modes](database-mirroring-operating-modes.md).</span></span>  
  
-   <span data-ttu-id="4d79a-198">La base de données miroir doit déjà être synchronisée.</span><span class="sxs-lookup"><span data-stu-id="4d79a-198">The mirror database must already be synchronized.</span></span> <span data-ttu-id="4d79a-199">Ceci garantit que la totalité du journal envoyé au serveur miroir a été écrit sur le disque.</span><span class="sxs-lookup"><span data-stu-id="4d79a-199">This guarantees that all of the log sent to the mirror server has been written to disk.</span></span>  
  
-   <span data-ttu-id="4d79a-200">Le serveur principal a perdu la communication avec le reste de la configuration de mise en miroir de base de données, tandis que le serveur miroir et le serveur témoin conservent le quorum.</span><span class="sxs-lookup"><span data-stu-id="4d79a-200">The principal server has lost communication with the rest of the database mirroring configuration, while the mirror and witness retain quorum.</span></span> <span data-ttu-id="4d79a-201">Toutefois, si toutes les instances de serveur perdent la communication et si le serveur témoin et le serveur miroir rétablissent ultérieurement la communication, le basculement automatique n'a pas lieu.</span><span class="sxs-lookup"><span data-stu-id="4d79a-201">If all server instances lose communication, however, and the witness and the mirror server later regain communication, automatic failover does not occur.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-202">Pour plus d’informations, consultez [Quorum : effets d’un témoin sur la disponibilité de la base de données &#40;Mise en miroir de bases de données&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-202">For more information, see [Quorum: How a Witness Affects Database Availability &#40;Database Mirroring&#41;](quorum-how-a-witness-affects-database-availability-database-mirroring.md).</span></span>  
  
-   <span data-ttu-id="4d79a-203">Le serveur miroir a détecté la perte du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="4d79a-203">The mirror server has detected the loss of the principal server.</span></span>  
  
     <span data-ttu-id="4d79a-204">La manière dont le serveur miroir détecte une défaillance du serveur principal est variable, selon qu'il s'agisse d'une défaillance matérielle ou logicielle.</span><span class="sxs-lookup"><span data-stu-id="4d79a-204">How the mirror server detects a failure of the principal server depends on whether it is a hard or soft failure.</span></span> <span data-ttu-id="4d79a-205">Pour plus d’informations, consultez [Défaillances possibles pendant la mise en miroir d’une base de données](possible-failures-during-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-205">For more information, see [Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="4d79a-206">Fonctionnement du basculement automatique</span><span class="sxs-lookup"><span data-stu-id="4d79a-206">How Automatic Failover Works</span></span>  
 <span data-ttu-id="4d79a-207">Sous les conditions précédentes, le basculement automatique initialise la séquence d'actions suivante :</span><span class="sxs-lookup"><span data-stu-id="4d79a-207">Under the preceding conditions, automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="4d79a-208">Si le serveur principal fonctionne toujours, il change l'état de la base de données principale en DISCONNECTED et déconnecte tous les clients de la base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-208">If the principal server is still running, it changes the state of the principal database to DISCONNECTED and disconnects all clients from the principal database.</span></span>  
  
2.  <span data-ttu-id="4d79a-209">Les serveurs témoin et miroir détectent que le serveur principal n'est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-209">The witness and mirror servers register that the principal server is unavailable.</span></span>  
  
3.  <span data-ttu-id="4d79a-210">Si un journal est en attente dans la file d'attente de restauration par progression, le serveur miroir termine la restauration par progression de la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-210">If any log is waiting in the redo queue, the mirror server finishes rolling forward the mirror database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-211">Le temps nécessaire pour appliquer le journal dépend de la vitesse du système, de la charge de travail récente et de la quantité de journal au sein de la file d'attente de restauration par progression.</span><span class="sxs-lookup"><span data-stu-id="4d79a-211">The amount of time required to apply the log depends on the speed of the system, the recent work load, and the amount of log in the redo queue.</span></span>  
  
4.  <span data-ttu-id="4d79a-212">L'ancienne base de données miroir passe en ligne en tant que nouvelle base de données principale, et la récupération nettoie toutes les transactions non validées en les restaurant le plus rapidement possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-212">The former mirror database moves online as the new principal database, and recovery cleans up all uncommitted transactions by rolling them back as quickly as possible.</span></span> <span data-ttu-id="4d79a-213">Des verrous isolent ces transactions.</span><span class="sxs-lookup"><span data-stu-id="4d79a-213">Locks isolate those transactions.</span></span>  
  
5.  <span data-ttu-id="4d79a-214">Lorsque l'ancien serveur principal rejoint la session, il détecte que son partenaire de basculement possède maintenant le rôle principal.</span><span class="sxs-lookup"><span data-stu-id="4d79a-214">When the former principal server rejoins the session, it recognizes that its failover partner now owns the principal role.</span></span> <span data-ttu-id="4d79a-215">L'ancien serveur principal prend le rôle de miroir, faisant de sa base de données la base de données en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-215">The former principal server takes on the role of mirror, making its database the mirror database.</span></span> <span data-ttu-id="4d79a-216">Le nouveau serveur miroir synchronise la nouvelle base de données miroir avec la base de données principale le plus rapidement possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-216">The new mirror server synchronizes the new mirror database with the principal database as quickly as possible.</span></span> <span data-ttu-id="4d79a-217">Dès que le nouveau serveur miroir a resynchronisé les bases de données, le basculement est de nouveau possible, mais dans le sens inverse.</span><span class="sxs-lookup"><span data-stu-id="4d79a-217">As soon as the new mirror server has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="4d79a-218">La figure suivante illustre une instance unique de basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-218">The following illustration shows a single instance of automatic failover.</span></span>  
  
 <span data-ttu-id="4d79a-219">![Basculement automatique](../media/dbm-failovauto1round.gif "Basculement automatique")</span><span class="sxs-lookup"><span data-stu-id="4d79a-219">![Automatic failover](../media/dbm-failovauto1round.gif "Automatic failover")</span></span>  
  
 <span data-ttu-id="4d79a-220">Au départ, les trois serveurs sont connectés (la session bénéficie d'un quorum complet).</span><span class="sxs-lookup"><span data-stu-id="4d79a-220">Initially, all three servers are connected (the session has full quorum).</span></span> <span data-ttu-id="4d79a-221">**Partner_A** est le serveur principal, **Partner_B** le serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-221">**Partner_A** is the principal server and **Partner_B** is the mirror server.</span></span> <span data-ttu-id="4d79a-222">**Partner_A** (ou la base de données principale sur **Partner_A**) devient non disponible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-222">**Partner_A** (or the principal database on **Partner_A**) becomes unavailable.</span></span> <span data-ttu-id="4d79a-223">Le témoin et **Partner_B** détectent tous les deux que le principal n’est plus disponible et la session conserve le quorum.</span><span class="sxs-lookup"><span data-stu-id="4d79a-223">The witness and **Partner_B** both recognize that the principal is no longer available the session retains quorum.</span></span> <span data-ttu-id="4d79a-224">**Partner_B** devient le serveur principal et rend sa copie de la base de données disponible en tant que nouvelle base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-224">**Partner_B** becomes the principal server and makes its copy of the database available as the new principal database.</span></span> <span data-ttu-id="4d79a-225">Finalement, **Partner_A** se reconnecte à la session et découvre que **Partner_B** possède maintenant le rôle principal.</span><span class="sxs-lookup"><span data-stu-id="4d79a-225">Eventually, **Partner_A** reconnects to the session and discovers that **Partner_B** now owns the principal role.</span></span> <span data-ttu-id="4d79a-226">**Partner_A** prend alors le rôle miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-226">**Partner_A** then takes on the mirror role.</span></span>  
  
 <span data-ttu-id="4d79a-227">Après le basculement, les clients doivent se reconnecter à la base de données principale actuelle.</span><span class="sxs-lookup"><span data-stu-id="4d79a-227">After failover, clients must reconnect to the current principal database.</span></span> <span data-ttu-id="4d79a-228">Pour en savoir plus, voir [Connecter des clients à une session de mise en miroir de bases de données &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-228">For more information, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4d79a-229">Les transactions qui ont été préparées à l'aide du service MSDTC ( [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator) mais qui ne sont toujours pas validées au moment du basculement, sont considérées comme abandonnées après le basculement de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-229">Transactions that have been prepared using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Distributed Transaction Coordinator but are still not committed when a failover occurs, are considered aborted after the database has failed over.</span></span>  
  
###  <a name="to-disable-automatic-failover-sql-server-management-studio"></a><a name="DisableAutoSSMS"></a> <span data-ttu-id="4d79a-230">Pour désactiver le basculement automatique (SQL Server Management Studio)</span><span class="sxs-lookup"><span data-stu-id="4d79a-230">To Disable Automatic Failover (SQL Server Management Studio)</span></span>  
 <span data-ttu-id="4d79a-231">Ouvrez la page **Mise en miroir** de la boîte de dialogue Propriétés de la base de données, puis changez de mode de fonctionnement en sélectionnant l’une des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="4d79a-231">Open the **Database PropertiesMirroring** page, and change the operating mode by selecting one of the following options:</span></span>  
  
-   <span data-ttu-id="4d79a-232">**Haute sécurité sans basculement automatique (synchrone)**</span><span class="sxs-lookup"><span data-stu-id="4d79a-232">**High safety without automatic failover (synchronous)**</span></span>  
  
     <span data-ttu-id="4d79a-233">Dans ce mode, la base de données continue d'être synchronisée et le basculement manuel reste possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-233">In this mode, the database continues to be synchronized, and manual failover remains possible.</span></span>  
  
-   <span data-ttu-id="4d79a-234">**Haute performance (asynchrone)**</span><span class="sxs-lookup"><span data-stu-id="4d79a-234">**High performance (asynchronous)**</span></span>  
  
     <span data-ttu-id="4d79a-235">Dans ce mode, la base de données miroir peut rester quelque peu en arrière de la base de données principale, de sorte que le basculement manuel ne sera plus possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-235">In this mode, the mirror database might lag somewhat behind the principal database, and manual failover is no longer possible.</span></span>  
  
### <a name="to-disable-automatic-failover-using-transact-sql"></a><span data-ttu-id="4d79a-236">Pour désactiver le basculement automatique (à l'aide de Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="4d79a-236">To Disable Automatic Failover (Using Transact-SQL)</span></span>  
 <span data-ttu-id="4d79a-237">À n'importe quel moment d'une session de mise en miroir de bases de données, le propriétaire de la base de données peut désactiver le basculement automatique en désactivant le témoin.</span><span class="sxs-lookup"><span data-stu-id="4d79a-237">At any point in a database mirroring session, the database owner can disable automatic failover by turning off the witness.</span></span>  
  
 <span data-ttu-id="4d79a-238">**Pour désactiver le témoin**</span><span class="sxs-lookup"><span data-stu-id="4d79a-238">**To turn off the witness**</span></span>  
  
-   [<span data-ttu-id="4d79a-239">Supprimer le témoin d’une session de mise en miroir de bases de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-239">Remove the Witness from a Database Mirroring Session &#40;SQL Server&#41;</span></span>](remove-the-witness-from-a-database-mirroring-session-sql-server.md)  
  
    > [!NOTE]  
    >  <span data-ttu-id="4d79a-240">La désactivation du témoin avec maintien de la sécurité complète des transactions place la session en mode haute sécurité sans basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-240">Turning off the witness while retaining full transaction safety puts the session into high-safety mode without automatic failover.</span></span>  
  
##  <a name="forced-service-with-possible-data-loss"></a><a name="ForcedService"></a> <span data-ttu-id="4d79a-241">Forced Service (with Possible Data Loss)</span><span class="sxs-lookup"><span data-stu-id="4d79a-241">Forced Service (with Possible Data Loss)</span></span>  
 <span data-ttu-id="4d79a-242">La mise en miroir de bases de données fournit un service forcé (avec possibilité de perte de données) en guise de méthode de récupération d'urgence afin de vous permettre d'utiliser un serveur miroir en tant que serveur de secours actif.</span><span class="sxs-lookup"><span data-stu-id="4d79a-242">Database mirroring provides forcing service (with possible data loss) as a disaster recovery method to allow you to use a mirror server as a warm standby server.</span></span> <span data-ttu-id="4d79a-243">Le service forcé est possible uniquement si le serveur principal est déconnecté du serveur miroir lors d'une session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-243">Forcing service is possible only if the principal server is disconnected from the mirror server in a mirroring session.</span></span> <span data-ttu-id="4d79a-244">Le service forcé entraînant un risque de perte de données, il convient de l'utiliser avec prudence et parcimonie.</span><span class="sxs-lookup"><span data-stu-id="4d79a-244">Because forcing service risks possible data loss, it should be used cautiously and sparingly.</span></span>  
  
 <span data-ttu-id="4d79a-245">La prise en charge du service forcé dépend du mode de fonctionnement et de l'état de la session, comme suit :</span><span class="sxs-lookup"><span data-stu-id="4d79a-245">Support for forced service depends on the operating mode and the state of the session, as follows:</span></span>  
  
-   <span data-ttu-id="4d79a-246">En général, le mode hautes performances prend en charge le service forcé lorsque le serveur principal est déconnecté.</span><span class="sxs-lookup"><span data-stu-id="4d79a-246">Typically, high-performance mode supports forcing service whenever the principal server is disconnected.</span></span> <span data-ttu-id="4d79a-247">Cependant, et bien que cela ne soit pas obligatoire, un témoin peut exister pour une session en mode hautes performances.</span><span class="sxs-lookup"><span data-stu-id="4d79a-247">However, though unnecessary, a witness can exist for a high-performance mode session.</span></span> <span data-ttu-id="4d79a-248">Dans ce cas, le service forcé exige que le serveur miroir et le témoin soient interconnectés.</span><span class="sxs-lookup"><span data-stu-id="4d79a-248">In this case, forcing service requires that the mirror server and witness are connected to each other.</span></span>  
  
-   <span data-ttu-id="4d79a-249">Le mode haute sécurité avec basculement automatique prend en charge le service forcé lorsque le serveur principal est déconnecté.</span><span class="sxs-lookup"><span data-stu-id="4d79a-249">High-safety mode without automatic failover supports forcing service whenever the principal server is disconnected.</span></span>  
  
-   <span data-ttu-id="4d79a-250">Le mode haute sécurité avec basculement automatique prend en charge le service forcé lorsque le serveur miroir et le témoin sont interconnectés et que ni l'un ni l'autre n'est connecté au serveur principal (tant que le serveur miroir n'était pas en train de restaurer la base de données miroir lorsqu'il était encore connecté au principal).</span><span class="sxs-lookup"><span data-stu-id="4d79a-250">High-safety mode with automatic failover supports forcing service whenever the mirror server and witness are connected to each other and neither is connected to the principal server (as long as the mirror server was not in the process of rolling back the mirror database when it was last connected to the principal).</span></span>  
  
 <span data-ttu-id="4d79a-251">Nous recommandons de forcer le service uniquement si vous devez restaurer immédiatement le service sur la base de données et que vous êtes prêt à courir le risque de perdre des données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-251">We recommend forcing service only if you must restore service to the database immediately and are willing to risk losing data.</span></span> <span data-ttu-id="4d79a-252">Le service forcé a un effet semblable à la suppression de la mise en miroir, hormis le fait qu'il facilite la resynchronisation des bases de données lors du rétablissement de la mise en miroir, au risque de perdre des données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-252">The effect of forcing service is similar to removing mirroring, except that forcing service facilitates resynchronizing the databases when mirroring is resumed, at the risk of possible data loss.</span></span> <span data-ttu-id="4d79a-253">Le service forcé effectue une transition régulière du rôle principal vers la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-253">Forcing service initiates a smooth transition of the principal role to the mirror database.</span></span> <span data-ttu-id="4d79a-254">Le serveur miroir joue le rôle de serveur principal et met immédiatement à la disposition des clients sa copie de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-254">The mirror server assumes the role of principal server and immediately serves its copy of the database to clients.</span></span> <span data-ttu-id="4d79a-255">La nouvelle base de données principale s'exécute sans miroir (autrement dit, elle est exposée).</span><span class="sxs-lookup"><span data-stu-id="4d79a-255">The new principal database runs without a mirror (that is, it runs exposed).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="4d79a-256">Si le serveur principal a simplement été déconnecté de la session de mise en miroir de bases de données et qu'il est encore en cours d'exécution, certains clients peuvent continuer d'accéder à la base de données principale d'origine.</span><span class="sxs-lookup"><span data-stu-id="4d79a-256">If the principal server was merely disconnected from the database mirroring session and is still running, some clients might continue to access the original principal database.</span></span> <span data-ttu-id="4d79a-257">Avant de forcer le service, il est important d'empêcher les clients d'accéder au serveur principal d'origine.</span><span class="sxs-lookup"><span data-stu-id="4d79a-257">Before you force service, it is important to prevent clients from accessing the original principal server.</span></span> <span data-ttu-id="4d79a-258">Autrement, une fois le service forcé, la base de données principale d'origine et la base de données principale actuelle risquent d'être mises à jour indépendamment l'une de l'autre.</span><span class="sxs-lookup"><span data-stu-id="4d79a-258">Otherwise, after service is forced, the original principal database and the current principal database could be updated independently of the other.</span></span>  
  
  
  
###  <a name="typical-case-of-forced-service"></a><a name="TypicalCaseFS"></a> <span data-ttu-id="4d79a-259">Cas ordinaire de service forcé</span><span class="sxs-lookup"><span data-stu-id="4d79a-259">Typical Case of Forced Service</span></span>  
 <span data-ttu-id="4d79a-260">L'illustration suivante présente un cas ordinaire de service forcé (avec possibilité de perte de données).</span><span class="sxs-lookup"><span data-stu-id="4d79a-260">The following figure illustrates a typical case of forced service (with possible data loss).</span></span>  
  
 <span data-ttu-id="4d79a-261">![Service forcé avec possibilité de perte de données](../media/dbm-forced-service.gif "Service forcé avec possibilité de perte de données")</span><span class="sxs-lookup"><span data-stu-id="4d79a-261">![Forcing service with possible data loss](../media/dbm-forced-service.gif "Forcing service with possible data loss")</span></span>  
  
 <span data-ttu-id="4d79a-262">Comme l’indique l’illustration, le serveur principal d’origine, **Partner_A**, devient indisponible pour le serveur miroir, **Partner_B**, ce qui entraîne la déconnexion de la base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-262">In the figure, the original principal server, **Partner_A**, becomes unavailable to the mirror server, **Partner_B**, causing the mirror database to be disconnected.</span></span> <span data-ttu-id="4d79a-263">Après avoir vérifié que **Partner_A** était inaccessible aux clients, l’administrateur de la base de données force le service, avec possibilité de perte de données, sur **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="4d79a-263">After ensuring that **Partner_A** is not available to clients, the database administrator forces service, with possible data loss, on **Partner_B**.</span></span> <span data-ttu-id="4d79a-264">**Partner_B** devient le serveur principal et s’exécute avec la base de données *exposée* (c’est-à-dire, non mise en miroir).</span><span class="sxs-lookup"><span data-stu-id="4d79a-264">**Partner_B** becomes the principal server and runs with the database *exposed* (that is, unmirrored).</span></span> <span data-ttu-id="4d79a-265">À ce stade, les clients peuvent se reconnecter à **Partner_B**.</span><span class="sxs-lookup"><span data-stu-id="4d79a-265">At this point, clients can reconnect to **Partner_B**.</span></span>  
  
 <span data-ttu-id="4d79a-266">Quand **Partner_A** devient disponible, il se reconnecte au nouveau serveur principal, rejoint la session et assume le rôle de miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-266">When **Partner_A** becomes available, it reconnects to the new principal server, rejoining the session and assuming the mirror role.</span></span> <span data-ttu-id="4d79a-267">La session de mise en miroir est suspendue immédiatement, sans que la nouvelle base de données miroir ait été synchronisée.</span><span class="sxs-lookup"><span data-stu-id="4d79a-267">The mirroring session is suspended immediately, without having synchronized the new mirror database.</span></span> <span data-ttu-id="4d79a-268">La suspension de la session permet à l'administrateur de base de données de décider s'il faut reprendre la session ou, dans des cas extrêmes, supprimer la mise en miroir et tenter de récupérer des données de l'ancienne base de données principale.</span><span class="sxs-lookup"><span data-stu-id="4d79a-268">Suspending the session allows the database administrator to decide whether to resume the session or, in extreme cases, remove mirroring and attempt to salvage data from the former principal database.</span></span> <span data-ttu-id="4d79a-269">Dans ce cas, l'administrateur de base de données choisit de reprendre la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-269">In this case, the database administrator chooses to resume mirroring.</span></span> <span data-ttu-id="4d79a-270">À ce stade, **Partner_A** assume le rôle de serveur miroir et restaure l’ancienne base de données principale au point dans le temps correspondant à la dernière transaction synchronisée avec succès ; si des transactions validées n’ont pas été écrites sur disque sur le serveur miroir avant que le service ne soit forcé, elles sont perdues.</span><span class="sxs-lookup"><span data-stu-id="4d79a-270">At that point, **Partner_A** takes over the role of mirror server and rolls back the former principal database to the point in time of the last successfully synchronized transaction; if any committed transactions were not written to disk on the mirror server before service was forced, they are lost.</span></span> <span data-ttu-id="4d79a-271">**Partner_A** restaure ensuite par progression la nouvelle base de données miroir en appliquant les modifications apportées à la nouvelle base de données principale depuis que l’ancien serveur miroir est devenu le nouveau serveur principal.</span><span class="sxs-lookup"><span data-stu-id="4d79a-271">**Partner_A** then rolls forward the new mirror database by applying any changes made on the new principal database since the former mirror server became the new principal server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4d79a-272">Bien que le mode hautes performances n'ait pas besoin de témoin, si un témoin est configuré, il est possible de forcer le service seulement si le témoin est connecté au serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-272">Although high-performance mode does not require a witness, if one is configured, forcing service is possible only if the witness is currently connected to the mirror server.</span></span>  
  
###  <a name="risks-of-forcing-service"></a><a name="FSrisks"></a> <span data-ttu-id="4d79a-273">Risques posés par le service forcé</span><span class="sxs-lookup"><span data-stu-id="4d79a-273">Risks of Forcing Service</span></span>  
 <span data-ttu-id="4d79a-274">Il est essentiel de comprendre que le service forcé peut entraîner une perte de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-274">It is essential to understand that forcing service can cause data loss.</span></span> <span data-ttu-id="4d79a-275">La perte de données est possible car le serveur miroir ne peut pas communiquer avec le serveur principal et, par conséquent, ne peut pas garantir la synchronisation des deux bases de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-275">Data loss is possible because the mirror server cannot communicate with the principal server and, therefore, cannot guarantee that the two databases are synchronized.</span></span> <span data-ttu-id="4d79a-276">Le service forcé démarre un nouveau point de branchement de récupération.</span><span class="sxs-lookup"><span data-stu-id="4d79a-276">Forcing service starts a new recovery fork.</span></span> <span data-ttu-id="4d79a-277">Étant donné que la base de données principale et la base de données miroir d'origine sont situées sur différents branchements de récupération, chaque base de données contient maintenant des données qui ne figurent pas dans l'autre base de données : la base de données principale d'origine contient toutes les modifications qui n'avaient pas encore été envoyées de sa file d'attente d'envoi à l'ancienne base de données miroir (le journal non envoyé) ; l'ancienne base de données miroir contient toutes les modifications qui surviennent une fois le service forcé.</span><span class="sxs-lookup"><span data-stu-id="4d79a-277">Because the original principal database and mirror database are on different recovery forks, each database now contains data that the other database does not: the original principal database contains whatever changes were not yet sent from its send queue to the former mirror database (the unsent log); the former mirror database contains whatever changes occur after service was forced.</span></span>  
  
 <span data-ttu-id="4d79a-278">Si le service est forcé suite à une défaillance du serveur principal, le risque de perte de données dépend du fait que les journaux de transactions ont été envoyés ou non au serveur miroir avant la défaillance.</span><span class="sxs-lookup"><span data-stu-id="4d79a-278">If service is forced because the principal server has failed, potential data loss is depends on whether any transaction logs were not sent to the mirror server before the failure.</span></span> <span data-ttu-id="4d79a-279">En mode haute sécurité, cela est possible uniquement jusqu'à ce que la base de données miroir soit synchronisée.</span><span class="sxs-lookup"><span data-stu-id="4d79a-279">Under high-safety mode, this is possible only until the mirror database becomes synchronized.</span></span> <span data-ttu-id="4d79a-280">En mode hautes performances, une accumulation du journal non envoyé est toujours une possibilité.</span><span class="sxs-lookup"><span data-stu-id="4d79a-280">Under the high-performance mode, accumulated unsent log is always a possibility.</span></span>  
  
 <span data-ttu-id="4d79a-281">Les implications du service forcé dépendent en partie de la présence d'un témoin dans la session :</span><span class="sxs-lookup"><span data-stu-id="4d79a-281">The implications of forcing service depend partly on whether the session has a witness:</span></span>  
  
-   <span data-ttu-id="4d79a-282">En l'absence de témoin, le service peut être forcé si les partenaires sont déconnectés, par exemple en raison d'une rupture de leur connexion réseau.</span><span class="sxs-lookup"><span data-stu-id="4d79a-282">In the absence of a witness, service can be forced if the partners become disconnected, for example, because their network connection is broken.</span></span> <span data-ttu-id="4d79a-283">Si le serveur principal d'origine est encore en cours d'exécution, les deux partenaires détiennent le rôle principal.</span><span class="sxs-lookup"><span data-stu-id="4d79a-283">If the original principal server is still running, both partners own the principal role.</span></span> <span data-ttu-id="4d79a-284">Les clients qui se connectent au nouveau serveur principal accèderont à la version actuelle de la base de données, alors que les clients qui se connectent au serveur principal d'origine accèderont à la base de données principale d'origine.</span><span class="sxs-lookup"><span data-stu-id="4d79a-284">Clients connecting to the new principal server will access the current version of the database, while clients connecting to the original principal server will access the original principal database.</span></span> <span data-ttu-id="4d79a-285">Cette situation accroît le risque de perte de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-285">This situation increases the potential for data loss.</span></span> <span data-ttu-id="4d79a-286">Si les partenaires sont autorisés à se reconnecter, le serveur principal d'origine assume le rôle de miroir et modifie l'état de sa base de données en « récupération » avant que la mise en miroir soit suspendue.</span><span class="sxs-lookup"><span data-stu-id="4d79a-286">If the partners are allowed to reconnect, the original principal server assumes the mirror role and changes the status of its database to "recovering," before mirroring is suspended.</span></span> <span data-ttu-id="4d79a-287">Si la session reprend, les transactions de la base de données principale d'origine dont le journal se trouvait dans la file d'attente d'envoi lors de la déconnexion la plus récente sont perdues.</span><span class="sxs-lookup"><span data-stu-id="4d79a-287">If the session is resumed, transactions on the original principal database whose log was in the send queue as of the most recent disconnection are lost.</span></span> <span data-ttu-id="4d79a-288">En outre, toutes les transactions qui ont eu lieu après le forçage du service sont également perdues.</span><span class="sxs-lookup"><span data-stu-id="4d79a-288">In addition, any the transactions that occurred after service was forced are also lost.</span></span>  
  
-   <span data-ttu-id="4d79a-289">En présence d'un témoin, si le serveur miroir est déconnecté du serveur principal et du témoin, le principal demeure exposé tant qu'il est connecté au témoin.</span><span class="sxs-lookup"><span data-stu-id="4d79a-289">In the presence of a witness, if the mirror server is disconnected from both the principal server and the witness, as long as the latter two remain connected to each other, the principal runs exposed.</span></span> <span data-ttu-id="4d79a-290">Si le serveur principal est ensuite déconnecté du témoin, il ne sert plus la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-290">If the principal server then becomes disconnected from the witness, it stops serving the database.</span></span> <span data-ttu-id="4d79a-291">Par la suite, si le serveur miroir se reconnecte au témoin, le service forcé devient possible.</span><span class="sxs-lookup"><span data-stu-id="4d79a-291">Thereafter, if the mirror server reconnects to the witness, forcing service becomes possible.</span></span> <span data-ttu-id="4d79a-292">Si le service est forcé, toutes les modifications apportées pendant que le serveur principal d'origine s'exécutait en situation exposée seront perdues si le serveur principal d'origine se reconnecte.</span><span class="sxs-lookup"><span data-stu-id="4d79a-292">If service is forced, all the changes made while the original principal server was running exposed will be lost if the original principal server reconnects.</span></span>  
  
 <span data-ttu-id="4d79a-293">Pour plus d’informations, consultez [Gestion de la perte de données potentielle](#ManageDataLoss), plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4d79a-293">For more information, see [Managing the Potential Data Loss](#ManageDataLoss), later in this topic.</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ManageDataLoss"></a> <span data-ttu-id="4d79a-294">Gestion de la perte de données potentielle</span><span class="sxs-lookup"><span data-stu-id="4d79a-294">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="4d79a-295">Après le forçage du service, une fois l'ancien serveur principal disponible, en supposant que sa base de données ne soit pas endommagée, vous pouvez tenter de gérer la perte de données potentielle.</span><span class="sxs-lookup"><span data-stu-id="4d79a-295">After service is forced, once the former principal server is available, assuming that its database is undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="4d79a-296">La méthode disponible pour gérer la perte de données potentielle dépend selon que le serveur principal d'origine s'est reconnecté à son partenaire et a rejoint la session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-296">The available approach for managing potential data loss depends on whether the original principal server has reconnected to its partner and rejoined the mirroring session.</span></span> <span data-ttu-id="4d79a-297">En supposant que le serveur principal d'origine puisse accéder à la nouvelle instance principale, la reconnexion se produit automatiquement et de manière transparente.</span><span class="sxs-lookup"><span data-stu-id="4d79a-297">Assuming that the original principal server can access the new principal instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-principal-server-has-reconnected"></a><span data-ttu-id="4d79a-298">Le serveur principal d'origine s'est reconnecté</span><span class="sxs-lookup"><span data-stu-id="4d79a-298">The Original Principal Server Has Reconnected</span></span>  
 <span data-ttu-id="4d79a-299">En général, après une défaillance, lorsque le serveur principal d'origine redémarre, il se reconnecte rapidement à son partenaire.</span><span class="sxs-lookup"><span data-stu-id="4d79a-299">Typically, after a failure, when the original principal server restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="4d79a-300">Lors de la reconnexion, le serveur principal d'origine devient le serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-300">On reconnecting, the original principal server becomes the mirror server.</span></span> <span data-ttu-id="4d79a-301">Sa base de données devient la base de données miroir et passe à l'état de récupération avant que la session soit suspendue.</span><span class="sxs-lookup"><span data-stu-id="4d79a-301">Its database becomes the mirror database and enters the recovering state before the session is suspended.</span></span> <span data-ttu-id="4d79a-302">La base de données miroir ne sera restaurée que si vous rétablissez la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-302">The mirror database will not be not rolled back unless you resume mirroring.</span></span>  
  
 <span data-ttu-id="4d79a-303">Toutefois, la base de données de récupération est inaccessible ; par conséquent, vous ne pouvez pas l'inspecter afin d'évaluer les données qui seraient perdues si vous rétablissiez la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-303">However, the recovering database is inaccessible; therefore, you cannot inspect it to evaluate what data would be lost if you were to resume mirroring.</span></span> <span data-ttu-id="4d79a-304">La décision relative à la reprise ou à la suppression de la mise en miroir dépend donc selon que vous souhaitez accepter ou non le risque de perte de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-304">Therefore, the decision on whether to resume or remove mirroring depends on whether you are willing to accept any data loss at all.</span></span>  
  
-   <span data-ttu-id="4d79a-305">Si la perte de données est inacceptable, vous devez supprimer la mise en miroir afin de récupérer les données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-305">If losing any data would be unacceptable, you should remove mirroring to salvage them.</span></span>  
  
     <span data-ttu-id="4d79a-306">La suppression de la mise en miroir permettrait à l'administrateur de base de données de récupérer la base de données principale d'origine et de tenter de récupérer les données qui auraient été perdues.</span><span class="sxs-lookup"><span data-stu-id="4d79a-306">Removing mirroring would allow the database administrator to recover the original principal database and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="4d79a-307">Toutefois, lorsque l'ancienne base de données miroir passera en ligne, les anciens partenaires serviront des bases de données divergentes portant le même nom.</span><span class="sxs-lookup"><span data-stu-id="4d79a-307">However, when the former mirror database comes online, the former partners will be serving divergent databases with the same name.</span></span> <span data-ttu-id="4d79a-308">L'administrateur de base de données doit rendre l'une des bases de données inaccessible aux clients afin d'éviter toute divergence supplémentaire de la base de données et tout problème de basculement de client.</span><span class="sxs-lookup"><span data-stu-id="4d79a-308">The database administrator needs to make one of the databases inaccessible to clients to avoid further divergence of the database and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="4d79a-309">Si la perte de données est acceptable, vous pouvez reprendre la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-309">If losing any data would be acceptable, you can resume mirroring.</span></span>  
  
     <span data-ttu-id="4d79a-310">La reprise de la mise en miroir entraîne la restauration de la nouvelle base de données miroir en guise de première étape vers la synchronisation de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4d79a-310">Resuming mirroring causes the new mirror database to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="4d79a-311">Si des enregistrements de journal se trouvaient dans la file d'attente d'envoi au moment de la défaillance, les transactions correspondantes sont perdues, même si elles ont été validées.</span><span class="sxs-lookup"><span data-stu-id="4d79a-311">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-principal-server-has-not-reconnected"></a><span data-ttu-id="4d79a-312">Le serveur principal d'origine ne s'est pas reconnecté</span><span class="sxs-lookup"><span data-stu-id="4d79a-312">The Original Principal Server Has Not Reconnected</span></span>  
 <span data-ttu-id="4d79a-313">Si vous pouvez empêcher momentanément le serveur principal d'origine de se reconnecter par le biais du réseau au nouveau serveur principal, vous pouvez inspecter la base de données principale d'origine afin d'évaluer les données qui seraient perdues si vous rétablissiez la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-313">If you can temporarily prevent the original principal server from reconnecting over the network to the new principal server, you can inspect the original principal database to evaluate what data would be lost if mirroring were resumed.</span></span>  
  
-   <span data-ttu-id="4d79a-314">Si la perte de données potentielle est acceptable</span><span class="sxs-lookup"><span data-stu-id="4d79a-314">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="4d79a-315">Laissez le serveur principal d'origine se reconnecter à son partenaire.</span><span class="sxs-lookup"><span data-stu-id="4d79a-315">Allow the original principal server to reconnect to its partner.</span></span> <span data-ttu-id="4d79a-316">La reconnexion provoque la suspension de la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-316">Reconnecting causes mirroring to be suspended.</span></span> <span data-ttu-id="4d79a-317">Pour rétablir la mise en miroir, il vous suffit de reprendre la session.</span><span class="sxs-lookup"><span data-stu-id="4d79a-317">To proceed with mirroring, simply resume the session.</span></span> <span data-ttu-id="4d79a-318">L'ancien serveur principal assume le rôle de miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-318">The former principal server assumes the mirror role.</span></span> <span data-ttu-id="4d79a-319">Le nouveau serveur miroir supprime le branchement de récupération d'origine, ce qui entraîne la perte des transactions qui n'ont été ni reçues ni envoyées par l'ancien serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-319">The new mirror server drops the original recovery fork, losing any transactions that were never sent to or received by the former mirror server.</span></span>  
  
-   <span data-ttu-id="4d79a-320">Si la perte de données est inacceptable</span><span class="sxs-lookup"><span data-stu-id="4d79a-320">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="4d79a-321">Si la base de données principale d'origine contient des données essentielles qui seront perdues si vous reprenez la session, vous pouvez préserver les données sur le serveur principal d'origine en supprimant la mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-321">If the original principal database contains critical data that would be lost if you resumed the session, you can preserve the data on the original principal server by removing mirroring.</span></span> <span data-ttu-id="4d79a-322">Nous vous recommandons d'essayer de sauvegarder la fin du journal du principal à ce stade.</span><span class="sxs-lookup"><span data-stu-id="4d79a-322">We recommend that you attempt to back up the tail of the principal's log at this point.</span></span> <span data-ttu-id="4d79a-323">Ensuite, vous pouvez mettre à jour la base de données principale actuelle (l'ancienne base de données miroir) en exportant les données que vous souhaitez sauvegarder à partir de la base de données principale d'origine et en les important dans la base de données principale actuelle.</span><span class="sxs-lookup"><span data-stu-id="4d79a-323">Then, you can update the current principal (the former mirror database) by exporting the data you want to salvage from the original principal database and importing it into the current principal database.</span></span> <span data-ttu-id="4d79a-324">Nous vous recommandons d'effectuer aussi rapidement que possible une sauvegarde complète de base de données de la base de données mise à jour.</span><span class="sxs-lookup"><span data-stu-id="4d79a-324">We recommend taking a full database backup of the updated database as quickly as possible.</span></span>  
  
     <span data-ttu-id="4d79a-325">Pour rétablir la mise en miroir avec la base de données mise à jour en tant que base de données principale initiale, utilisez cette sauvegarde (et au moins une sauvegarde du journal ultérieure) pour créer une nouvelle base de données miroir.</span><span class="sxs-lookup"><span data-stu-id="4d79a-325">To re-establish mirroring with the updated database as the initial principal database, use this backup (and least one subsequent log backup) to create a new mirror database.</span></span> <span data-ttu-id="4d79a-326">Chaque sauvegarde de journal effectuée après la suppression de la mise en miroir doit être appliquée.</span><span class="sxs-lookup"><span data-stu-id="4d79a-326">Every log backup taken after mirroring was removed must be applied.</span></span> <span data-ttu-id="4d79a-327">Par conséquent, nous recommandons de différer les sauvegardes de fichier journal supplémentaires de la base de données principale jusqu'à ce que la nouvelle session de mise en miroir démarre.</span><span class="sxs-lookup"><span data-stu-id="4d79a-327">Therefore, we recommend delaying additional log backups of the principal database until the new mirroring session starts.</span></span>  
  
###  <a name="related-tasks-for-managing-a-forced-failover"></a><a name="RelatedTasksForFS"></a> <span data-ttu-id="4d79a-328">Tâches associées à la gestion d'un basculement forcé</span><span class="sxs-lookup"><span data-stu-id="4d79a-328">Related Tasks For Managing a Forced Failover</span></span>  
 <span data-ttu-id="4d79a-329">**Pour forcer le service**</span><span class="sxs-lookup"><span data-stu-id="4d79a-329">**To force service**</span></span>  
  
-   <span data-ttu-id="4d79a-330">[Forcer le service dans une session de mise en miroir de bases de données &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="4d79a-330">[Force Service in a Database Mirroring Session &#40;Transact-SQL&#41;](force-service-in-a-database-mirroring-session-transact-sql.md).</span></span>  
  
 <span data-ttu-id="4d79a-331">**Pour reprendre la mise en miroir de bases de données**</span><span class="sxs-lookup"><span data-stu-id="4d79a-331">**To resume database mirroring**</span></span>  
  
-   [<span data-ttu-id="4d79a-332">Suspendre ou reprendre une session de mise en miroir de bases de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-332">Pause or Resume a Database Mirroring Session &#40;SQL Server&#41;</span></span>](pause-or-resume-a-database-mirroring-session-sql-server.md)  
  
 <span data-ttu-id="4d79a-333">**Pour créer une nouvelle base de données miroir**</span><span class="sxs-lookup"><span data-stu-id="4d79a-333">**To create a new mirror database**</span></span>  
  
 [<span data-ttu-id="4d79a-334">Préparer une base de données miroir pour la mise en miroir &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-334">Prepare a Mirror Database for Mirroring &#40;SQL Server&#41;</span></span>](prepare-a-mirror-database-for-mirroring-sql-server.md)  
  
 <span data-ttu-id="4d79a-335">**Pour démarrer la mise en miroir de bases de données**</span><span class="sxs-lookup"><span data-stu-id="4d79a-335">**To start up database mirroring**</span></span>  
  
-   [<span data-ttu-id="4d79a-336">Configuration de la mise en miroir d’une base de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-336">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="4d79a-337">Établir une session de mise en miroir de bases de données au moyen de l’authentification Windows &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-337">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="4d79a-338">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4d79a-338">See Also</span></span>  
 <span data-ttu-id="4d79a-339">[Estimer l’interruption de service au cours d’un basculement de rôle &#40;mise en miroir de bases de données&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-339">[Estimate the Interruption of Service During Role Switching &#40;Database Mirroring&#41;](estimate-the-interruption-of-service-during-role-switching-database-mirroring.md) </span></span>  
 <span data-ttu-id="4d79a-340">[Défaillances possibles pendant la mise en miroir de bases de données](possible-failures-during-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-340">[Possible Failures During Database Mirroring](possible-failures-during-database-mirroring.md) </span></span>  
 <span data-ttu-id="4d79a-341">[Connecter des clients à une session de mise en miroir de bases de données &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-341">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 <span data-ttu-id="4d79a-342">[Témoin de mise en miroir de base de données](database-mirroring-witness.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-342">[Database Mirroring Witness](database-mirroring-witness.md) </span></span>  
 <span data-ttu-id="4d79a-343">[Restaurations complètes de bases de données &#40;mode de récupération complète&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-343">[Complete Database Restores &#40;Full Recovery Model&#41;](../../relational-databases/backup-restore/complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="4d79a-344">[Modes de fonctionnement de la mise en miroir de bases de données](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="4d79a-344">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="4d79a-345">États de la mise en miroir &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4d79a-345">Mirroring States &#40;SQL Server&#41;</span></span>](mirroring-states-sql-server.md)  
  
  
