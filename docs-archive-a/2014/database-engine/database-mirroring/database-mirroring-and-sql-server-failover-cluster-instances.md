---
title: Mise en miroir de base de données et instances de cluster de basculement SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- failover clustering [SQL Server], database mirroring
- database mirroring [SQL Server], failover
- high-availability mode [SQL Server]
ms.assetid: f1dd6a79-698b-4e31-b923-6bfc3ea0b617
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 378f834b4482f44f6a84abf419f027b353c7771a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705415"
---
# <a name="database-mirroring-and-sql-server-failover-cluster-instances"></a><span data-ttu-id="ebfe2-102">Mise en miroir de base de données et instances de cluster de basculement SQL Server</span><span class="sxs-lookup"><span data-stu-id="ebfe2-102">Database Mirroring and SQL Server Failover Cluster Instances</span></span>
  <span data-ttu-id="ebfe2-103">Un cluster de basculement est composé d'un ou de plusieurs disques physiques placés dans un groupe de clusters géré par le service de cluster [!INCLUDE[msCoName](../../includes/msconame-md.md)] (MSCS), appelé groupe de ressources, et constituant ainsi des nœuds membres du cluster.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-103">A failover cluster is a combination of one or more physical disks in a [!INCLUDE[msCoName](../../includes/msconame-md.md)] Cluster Service (MSCS) cluster group, known as a resource group, that are participating nodes of the cluster.</span></span> <span data-ttu-id="ebfe2-104">Le groupe de ressources est configuré comme une instance cluster de basculement qui héberge une instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ebfe2-104">The resource group is configured as a failover clustered instance that hosts an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ebfe2-105">Une instance cluster de basculement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] apparaît sur le réseau comme s’il s’agissait d’un ordinateur unique, mais elle est dotée d’une fonctionnalité qui assure le basculement d’un nœud vers un autre si le premier devient indisponible.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-105">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover clustered instance appears on the network as if it were a single computer, but has functionality that provides failover from one node to another if one node becomes unavailable.</span></span> <span data-ttu-id="ebfe2-106">Pour plus d’informations, consultez [Instances de cluster de basculement AlwaysOn (SQL Server)](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ebfe2-106">For more information, see [AlwaysOn Failover Cluster Instances (SQL Server)](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span></span>  
  
 <span data-ttu-id="ebfe2-107">Les clusters de basculement garantissent une prise en charge de la haute disponibilité pour l’intégralité d’une instance de [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]. En cela, ils se distinguent de la fonctionnalité de mise en miroir de bases de données qui offre cette même prise en charge pour une seule base de données.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-107">Failover clusters provide high-availability support for an entire [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance, in contrast to database mirroring, which provides high-availability support for a single database.</span></span> <span data-ttu-id="ebfe2-108">La mise en miroir de base de données est mise en œuvre entre des clusters de basculement et également entre un cluster de basculement et un hôte non-cluster.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-108">Database mirroring works between failover clusters and, also, between a failover cluster and a nonclustered host.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebfe2-109">Pour une présentation de la mise en miroir de bases de données, consultez [Mise en miroir de bases de données &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="ebfe2-109">For an introduction to database mirroring, see [Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md).</span></span>  
  
## <a name="mirroring-and-clustering"></a><span data-ttu-id="ebfe2-110">Mise en miroir et clustering</span><span class="sxs-lookup"><span data-stu-id="ebfe2-110">Mirroring and Clustering</span></span>  
 <span data-ttu-id="ebfe2-111">En règle générale, lorsque la mise en miroir est associée au clustering, le serveur principal et le serveur miroir résident tous les deux sur des clusters ; le serveur principal est hébergé sur l'instance cluster de basculement d'un cluster et le serveur miroir opère sur le serveur virtuel d'un autre cluster.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-111">Typically, when mirroring is used with clustering, the principal server and mirror server both reside on clusters, with the principal server running on the failover clustered instance of one cluster and the mirror server running on the failover clustered instance of a different cluster.</span></span> <span data-ttu-id="ebfe2-112">Néanmoins, vous pouvez établir une session de mise en miroir dans laquelle un partenaire réside sur l'instance cluster de basculement d'un cluster et l'autre partenaire sur un ordinateur distinct non-cluster.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-112">You can establish a mirroring session in which one partner resides on the failover clustered instance of a cluster and the other partner resides on a separate, unclustered computer, however.</span></span>  
  
 <span data-ttu-id="ebfe2-113">Si le basculement d'un cluster rend un serveur principal provisoirement indisponible, les connexions client à la base de données sont fermées.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-113">If a cluster failover makes a principal server temporarily unavailable, client connections are disconnected from the database.</span></span> <span data-ttu-id="ebfe2-114">À l’issue du basculement d’un cluster, les clients peuvent se reconnecter au serveur principal du même cluster ou d’un autre cluster (ou un ordinateur non-cluster) selon le [mode d’opération](database-mirroring-operating-modes.md).</span><span class="sxs-lookup"><span data-stu-id="ebfe2-114">After the cluster failover completes, clients can reconnect to the principal server on the same cluster, or on a different cluster or an unclustered computer, depending on the [operating mode](database-mirroring-operating-modes.md).</span></span> <span data-ttu-id="ebfe2-115">Par conséquent, pour déterminer la façon dont vous allez configurer la mise en miroir de bases de données dans un environnement en clusters, le mode d'opération adopté pour la mise en miroir est primordial.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-115">Therefore, when deciding how to configure database mirroring in a clustered environment, the operating mode you use for mirroring is significant.</span></span>  
  
### <a name="high-safety-mode-session-with-automatic-failover"></a><span data-ttu-id="ebfe2-116">Session en mode haute sécurité de basculement automatique</span><span class="sxs-lookup"><span data-stu-id="ebfe2-116">High-Safety mode Session with Automatic Failover</span></span>  
 <span data-ttu-id="ebfe2-117">Si vous envisagez de mettre en miroir une base de données en mode haute sécurité de basculement automatique, une configuration à deux clusters est recommandée pour les partenaires.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-117">If you intend to mirror a database in high-safety mode with automatic failover, a two-cluster configuration is recommended for the partners.</span></span> <span data-ttu-id="ebfe2-118">Cette configuration assure une disponibilité optimale.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-118">This configuration provides maximum availability.</span></span> <span data-ttu-id="ebfe2-119">Le témoin peut résider soit sur un troisième cluster, soit sur un ordinateur non-cluster.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-119">The witness can reside either on a third cluster or on an unclustered computer.</span></span>  
  
 <span data-ttu-id="ebfe2-120">Si le nœud hébergeant le serveur principal actif connaît une défaillance, le basculement automatique de la base de données débute après quelques secondes seulement, alors que le basculement vers un autre nœud de cluster est toujours en cours.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-120">If the node running the current principal server fails, automatic failover of the database begins within a few seconds, while the cluster is still failing over to another node.</span></span> <span data-ttu-id="ebfe2-121">La session de mise en miroir de bases de données bascule vers le serveur miroir de l'autre cluster (ou de l'ordinateur non-cluster) et le serveur miroir initial devient le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-121">The database mirroring session fails over to the mirror server on the other cluster or unclustered computer, and the former mirror server becomes the principal server.</span></span> <span data-ttu-id="ebfe2-122">Le nouveau serveur principal restaure par progression sa copie de la base de données aussi rapidement que possible et la remet en ligne en tant que base de données principale.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-122">The new principal server rolls forward its copy of the database as quickly as possible and brings it online as the principal database.</span></span> <span data-ttu-id="ebfe2-123">Au terme du basculement de cluster, qui dure généralement plusieurs minutes, l'instance cluster de basculement qui était le serveur principal devient le serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-123">After the cluster failover completes, which typically takes several minutes, the failover clustered instance that was formerly the principal server becomes the mirror server.</span></span>  
  
 <span data-ttu-id="ebfe2-124">La figure suivante illustre les effets d'un basculement automatique entre des clusters dans une session de mise en miroir en mode haute sécurité avec un témoin (prise en charge du basculement automatique).</span><span class="sxs-lookup"><span data-stu-id="ebfe2-124">The following illustration shows an automatic failover between clusters in a mirroring session running in high-safety mode with a witness (which supports automatic failover).</span></span>  
  
 <span data-ttu-id="ebfe2-125">![Basculement sur un cluster](../media/dbm-and-failover-clustering.gif "Basculement sur un cluster")</span><span class="sxs-lookup"><span data-stu-id="ebfe2-125">![A failover on a cluster](../media/dbm-and-failover-clustering.gif "A failover on a cluster")</span></span>  
  
 <span data-ttu-id="ebfe2-126">Les trois instances de serveur dans la session de mise en miroir résident sur trois clusters distincts : **Cluster_A**, **Cluster_B** et **Cluster_C**.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-126">The three server instances in the mirroring session reside on three distinct clusters: **Cluster_A**, **Cluster_B**, and **Cluster_C**.</span></span> <span data-ttu-id="ebfe2-127">Sur chaque cluster, une instance par défaut de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] s’exécute comme instance cluster de basculement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ebfe2-127">On each cluster, a default instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running as a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] failover clustered instance.</span></span> <span data-ttu-id="ebfe2-128">Au début de la session de mise en miroir, l’instance cluster de basculement **Cluster_A** est le serveur principal, celle de **Cluster_B** est le serveur miroir et celle de **Cluster_C** est le témoin de la session.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-128">When the mirroring session starts, the failover clustered instance on **Cluster_A** is the principal server, the failover clustered instance on **Cluster_B** is the mirror server, and the failover clustered instance on **Cluster_C** is the witness in the mirroring session.</span></span> <span data-ttu-id="ebfe2-129">À un moment donné, le nœud actif de **Cluster_A** subit une défaillance, à la suite de quoi le serveur principal devient indisponible.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-129">Eventually, the active node on **Cluster_A** fails, which causes the principal server to become unavailable.</span></span>  
  
 <span data-ttu-id="ebfe2-130">Avant que le basculement du cluster ne puisse avoir lieu, la perte du serveur principal est détectée par le serveur miroir avec l'aide du témoin.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-130">Before the cluster has time to fail over, the loss of the principal server is detected by the mirror server, with the help of the witness.</span></span> <span data-ttu-id="ebfe2-131">Le serveur miroir restaure par progression sa base de données et la remet en ligne en tant que nouvelle base de données principale aussi rapidement que possible.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-131">The mirror server rolls forward its database and brings it online as the new principal database as quickly as possible.</span></span> <span data-ttu-id="ebfe2-132">Une fois le basculement du **Cluster_A** terminé, le serveur principal initial devient le serveur miroir et synchronise sa base de données avec la base de données principale actuelle sur le **Cluster_B**.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-132">When **Cluster_A** finishes failing over, the former principal server is now the mirror server, and it synchronizes its database with the current principal database on **Cluster_B**.</span></span>  
  
### <a name="high-safety-mode-session-without-automatic-failover"></a><span data-ttu-id="ebfe2-133">Session en mode haute sécurité sans basculement automatique</span><span class="sxs-lookup"><span data-stu-id="ebfe2-133">High-Safety Mode Session Without Automatic Failover</span></span>  
 <span data-ttu-id="ebfe2-134">Si vous procédez à la mise en miroir d'une base de données en mode haute sécurité sans basculement automatique, un autre nœud du cluster intervient en tant que serveur principal en cas d'échec du nœud chargé de l'exécution du serveur principal actuel.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-134">If you are mirroring a database in high-safety mode without automatic failover, another node in the cluster will act as the principal server if the node running the current principal server fails.</span></span> <span data-ttu-id="ebfe2-135">Notez que lorsque le cluster est indisponible, la base de données l'est également.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-135">Note that while the cluster is unavailable, the database is unavailable.</span></span>  
  
### <a name="high-performance-mode-session"></a><span data-ttu-id="ebfe2-136">Session en mode hautes performances</span><span class="sxs-lookup"><span data-stu-id="ebfe2-136">High-Performance Mode Session</span></span>  
 <span data-ttu-id="ebfe2-137">Si vous envisagez de mettre en miroir une base de données en mode hautes performances, placez le serveur principal sur l'instance cluster de basculement d'un cluster et le serveur miroir sur un serveur non-cluster situé sur un site distant.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-137">If you intend to mirror a database in high-performance mode, consider placing the principal server on the failover clustered instance of a cluster and placing the mirror server on an unclustered server in a remote location.</span></span> <span data-ttu-id="ebfe2-138">En cas de basculement du cluster vers un autre nœud, l'instance cluster de basculement continue de fonctionner en tant que serveur principal au cours de la session de mise en miroir.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-138">If the cluster fails over to a different node, the failover clustered instance will continue as the principal server in the mirroring session.</span></span> <span data-ttu-id="ebfe2-139">Si le cluster tout entier est confronté à des problèmes, vous pouvez forcer le service sur le serveur miroir.</span><span class="sxs-lookup"><span data-stu-id="ebfe2-139">If the entire cluster has problems, you can force service onto the mirror server.</span></span>  
  
 <span data-ttu-id="ebfe2-140">**Pour configurer un nouveau cluster de basculement SQL Server**</span><span class="sxs-lookup"><span data-stu-id="ebfe2-140">**To set up a new SQL Server failover cluster**</span></span>  
  
-   [<span data-ttu-id="ebfe2-141">Créer un cluster de basculement SQL Server &#40;programme d’installation&#41;</span><span class="sxs-lookup"><span data-stu-id="ebfe2-141">Create a New SQL Server Failover Cluster &#40;Setup&#41;</span></span>](../../sql-server/failover-clusters/install/create-a-new-sql-server-failover-cluster-setup.md)  
  
 <span data-ttu-id="ebfe2-142">**Pour configurer la mise en miroir des bases de données**</span><span class="sxs-lookup"><span data-stu-id="ebfe2-142">**To set up database mirroring**</span></span>  
  
-   [<span data-ttu-id="ebfe2-143">Configuration de la mise en miroir d’une base de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="ebfe2-143">Setting Up Database Mirroring &#40;SQL Server&#41;</span></span>](setting-up-database-mirroring-sql-server.md)  
  
-   [<span data-ttu-id="ebfe2-144">Établir une session de mise en miroir de bases de données au moyen de l’authentification Windows &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="ebfe2-144">Establish a Database Mirroring Session Using Windows Authentication &#40;SQL Server Management Studio&#41;</span></span>](establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="see-also"></a><span data-ttu-id="ebfe2-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ebfe2-145">See Also</span></span>  
 <span data-ttu-id="ebfe2-146">[Mise en miroir de bases de données &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="ebfe2-146">[Database Mirroring &#40;SQL Server&#41;](database-mirroring-sql-server.md) </span></span>  
 <span data-ttu-id="ebfe2-147">[Modes de fonctionnement de la mise en miroir de bases de données](database-mirroring-operating-modes.md) </span><span class="sxs-lookup"><span data-stu-id="ebfe2-147">[Database Mirroring Operating Modes](database-mirroring-operating-modes.md) </span></span>  
 [<span data-ttu-id="ebfe2-148">Instances de cluster de basculement AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ebfe2-148">AlwaysOn Failover Cluster Instances (SQL Server)</span></span>](../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md) 
  
  
