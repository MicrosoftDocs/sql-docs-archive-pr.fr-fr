---
title: Mettre à niveau PowerPivot pour SharePoint | Microsoft Docs
ms.custom: ''
ms.date: 03/25/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
ms.assetid: 80ba9e43-f3f0-4730-9fb1-2afd2dd3e6fc
author: Minewiskan
ms.author: owend
ms.openlocfilehash: bebcfed02aa30ffc686b2a74807b6a4cc3955c90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603604"
---
# <a name="upgrade-powerpivot-for-sharepoint"></a><span data-ttu-id="cf1b8-102">Mettre à niveau PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="cf1b8-102">Upgrade PowerPivot for SharePoint</span></span>
  <span data-ttu-id="cf1b8-103">Cette rubrique résume les étapes nécessaires pour mettre à niveau un déploiement de [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] vers [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cf1b8-103">This topic summarizes the steps required to upgrade a deployment of [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] to [!INCLUDE[ssGeminiLong](../../includes/ssgeminilong-md.md)].</span></span> <span data-ttu-id="cf1b8-104">Les étapes spécifiques dépendent de la version de SharePoint exécutée par votre environnement et incluent le complément PowerPivot pour SharePoint (**spPowerPivot.msi**).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-104">The specific steps depend on the version of SharePoint your environment is currently running and include the PowerPivot for SharePoint Add-in (**spPowerPivot.msi**).</span></span>  
  
 <span data-ttu-id="cf1b8-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="cf1b8-105">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2010 | SharePoint 2013</span></span>  
  
 <span data-ttu-id="cf1b8-106">Pour obtenir les notes de mise à jour, consultez [Notes de mise à jour pour SQL Server 2014](https://go.microsoft.com/fwlink/?LinkID=296445).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-106">For release notes, see [SQL Server 2014 Release Notes](https://go.microsoft.com/fwlink/?LinkID=296445).</span></span>  
  

  
## <a name="background"></a><span data-ttu-id="cf1b8-107">Arrière-plan</span><span class="sxs-lookup"><span data-stu-id="cf1b8-107">Background</span></span>  
  
-   <span data-ttu-id="cf1b8-108">Si vous mettez à niveau une batterie à plusieurs serveurs SharePoint 2010 qui a deux instances [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ou plus, vous devez procéder à la mise à niveau complète de chaque serveur **avant** de passer au serveur suivant.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-108">If you are upgrading a multi-server SharePoint 2010 farm that has two or more [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] instances, you must fully upgrade each server **before** continuing to the next server.</span></span> <span data-ttu-id="cf1b8-109">Une mise à niveau complète implique l'exécution du programme d'installation de SQL Server pour mettre à niveau les fichiers programme [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , puis d'effectuer les actions de mise à niveau de SharePoint qui permettent de configurer les services mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-109">A full upgrade includes running SQL Server Setup to upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] program files, followed by SharePoint upgrade actions that configure the upgraded services.</span></span> <span data-ttu-id="cf1b8-110">La disponibilité du serveur est limitée jusqu'à l'exécution des actions de mise à niveau dans l'outil de configuration de PowerPivot approprié ou dans Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-110">Server availability will be limited until you run upgrade actions in the appropriate PowerPivot Configuration Tool or Windows PowerShell.</span></span>  
  
-   <span data-ttu-id="cf1b8-111">Les instances du service système PowerPivot et du service Analysis Services d'une batterie de serveurs SharePoint 2010 doivent avoir la même version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-111">All instances of PowerPivot System Service and Analysis Services in a SharePoint 2010 farm must be the same version.</span></span> <span data-ttu-id="cf1b8-112">Pour plus d'informations sur la vérification de la version, consultez la section [Vérifier les versions des composants et services PowerPivot](#bkmk_verify_versions) dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-112">For information on how to verify the version, see the section [Verify the Versions of PowerPivot Components and Services](#bkmk_verify_versions) in this topic.</span></span>  
  
-   <span data-ttu-id="cf1b8-113">Les outils de configuration PowerPivot constituent l'une des fonctionnalités partagées de SQL Server et toutes les fonctionnalités partagées sont mises à niveau en même temps.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-113">The PowerPivot configuration tools are one of the SQL Server shared features and all shared features upgrade at the same time.</span></span> <span data-ttu-id="cf1b8-114">Si, au cours d'un processus de mise à niveau, vous sélectionnez d'autres fonctionnalités ou instances SQL Server qui nécessitent une mise à niveau de fonctionnalité partagée, l'outil de configuration de PowerPivot est également mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-114">If during an upgrade process you select other SQL Server instances or features that require a shared feature upgrade, then the PowerPivot configuration tool will also be upgraded.</span></span> <span data-ttu-id="cf1b8-115">Des problèmes peuvent survenir si l'outil de configuration PowerPivot est mis à niveau, alors que votre instance de PowerPivot ne l'est pas.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-115">You may have issues if the PowerPivot configuration tool is upgraded but your PowerPivot instance is not.</span></span> <span data-ttu-id="cf1b8-116">Pour plus d’informations sur les fonctionnalités partagées de SQL Server, consultez [mise à niveau vers SQL Server 2014 à l’aide de l’Assistant installation &#40;&#41;d’installation ](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-116">For more information about SQL Server shared features, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
-   <span data-ttu-id="cf1b8-117">Le complément PowerPivot pour SharePoint (**spPowerPivot.msi**) s'installe côte à côte avec les versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-117">The PowerPivot for SharePoint Add-in (**spPowerPivot.msi**) installs side by side with previous versions.</span></span> <span data-ttu-id="cf1b8-118">Par exemple le complément [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] est installé dans le dossier `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-118">For example the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] add-in installs to the folder `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools`.</span></span>  
  

  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="cf1b8-119">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="cf1b8-119">Prerequisites</span></span>  
 <span data-ttu-id="cf1b8-120">**autorisations**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-120">**Permissions**</span></span>  
  
-   <span data-ttu-id="cf1b8-121">Vous devez être administrateur de la batterie de serveurs pour mettre à niveau une installation PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-121">You must be a farm administrator to upgrade a PowerPivot for SharePoint installation.</span></span> <span data-ttu-id="cf1b8-122">Vous devez être administrateur local pour exécuter le programme d'installation de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-122">You must be a local administrator to run SQL Server Setup.</span></span>  
  
-   <span data-ttu-id="cf1b8-123">Vous devez disposer des autorisations **db_owner** pour la base de données de configuration de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-123">You must have **db_owner** permissions on the farm configuration database.</span></span>  
  
 <span data-ttu-id="cf1b8-124">**SQL Server :**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-124">**SQL Server:**</span></span>  
  
-   <span data-ttu-id="cf1b8-125">Si l’installation existante de PowerPivot est [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] , le [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) est requis pour une mise à niveau vers [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-125">If the existing PowerPivot installation is [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)], the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] Service Pack 2 (SP2) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="cf1b8-126">Si l’installation existante de PowerPivot est [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , le [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) est requis pour une mise à niveau vers [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-126">If the existing PowerPivot installation is [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] Service Pack 1 (SP1) is required for an upgrade to [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)] [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="cf1b8-127">**SharePoint 2010 :**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-127">**SharePoint 2010:**</span></span>  
  
-   <span data-ttu-id="cf1b8-128">Si l'installation existante exécute SharePoint 2010, installez SharePoint 2010 Service Pack 2 avant la mise à niveau vers [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cf1b8-128">If the existing installation is running SharePoint 2010, install the SharePoint 2010 Service Pack 2 before upgrading to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span> <span data-ttu-id="cf1b8-129">Pour plus d'informations, consultez [Service Pack 2 pour Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-129">For more information, see [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672).</span></span> <span data-ttu-id="cf1b8-130">Utilisez la commande PowerShell `(Get-SPfarm).BuildVersion.ToString()` pour vérifier la version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-130">Use the PowerShell command `(Get-SPfarm).BuildVersion.ToString()` to verify the version.</span></span> <span data-ttu-id="cf1b8-131">Pour référencer la version de la build à la date de version finale, consultez [Numéros de build SharePoint 2010](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-131">To reference the build version to release date, see [SharePoint 2010 Build Numbers](http://www.toddklindt.com/blog/Lists/Posts/Post.aspx?ID=224).</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2013-farm"></a><a name="bkmk_uprgade_sharepoint2013"></a> <span data-ttu-id="cf1b8-132">Mettre à niveau une batterie de serveurs SharePoint 2013 existante</span><span class="sxs-lookup"><span data-stu-id="cf1b8-132">Upgrade an Existing SharePoint 2013 Farm</span></span>  
 <span data-ttu-id="cf1b8-133">Pour mettre à niveau [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] déployé dans SharePoint 2013, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-133">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2013, do the following:</span></span>  
  
 <span data-ttu-id="cf1b8-134">![Mettre à niveau PowerPivot pour SharePoint 2013](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "Mettre à niveau PowerPivot pour SharePoint 2013")</span><span class="sxs-lookup"><span data-stu-id="cf1b8-134">![powerpivot for sharepoint 2013 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2013.png "powerpivot for sharepoint 2013 upgrade")</span></span>  
  
1.  <span data-ttu-id="cf1b8-135">Exécutez le programme d'installation de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] sur un ou plusieurs serveurs principaux [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-135">Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup on backend server(s) that run [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode.</span></span> <span data-ttu-id="cf1b8-136">Si le serveur héberge plusieurs instances d' [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], mettez au moins à niveau l'instance **POWERPIVOT** .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-136">If the server hosts multiple instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], upgrade at least the **POWERPIVOT** instance.</span></span> <span data-ttu-id="cf1b8-137">Voici un récapitulatif des étapes de l'Assistant Installation relatives à la mise à niveau de [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-137">The following list is a summary of setup wizard steps related to a [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] upgrade:</span></span>  
  
    1.  <span data-ttu-id="cf1b8-138">Dans l'Assistant Installation [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , cliquez sur **Installation**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-138">In the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Setup Wizard, click **Installation**.</span></span>  
  
    2.  <span data-ttu-id="cf1b8-139">Cliquez sur **Mettre à niveau à partir de SQL Server…** .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-139">Click **Upgrade from SQL Server.....**.</span></span>  
  
    3.  <span data-ttu-id="cf1b8-140">Dans la page **Sélectionner une instance** , sélectionnez l'instance **POWERPIVOT** , puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-140">On the **Select Instance** page, select the **POWERPIVOT** instance name and then click **Next**.</span></span>  
  
    4.  <span data-ttu-id="cf1b8-141">Pour plus d’informations, consultez [mettre à niveau vers SQL Server 2014 à l’aide de l’Assistant installation &#40;le programme d’installation&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span><span class="sxs-lookup"><span data-stu-id="cf1b8-141">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md)</span></span>  
  
2.  <span data-ttu-id="cf1b8-142">Redémarrez le serveur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-142">Restart the server.</span></span>  
  
3.  <span data-ttu-id="cf1b8-143">Exécutez le complément [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] pour SharePoint (**spPowerPivot.msi**) sur chaque serveur de la batterie SharePoint 2013 pour installer les fournisseurs de données.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-143">Run the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] for SharePoint add-in (**spPowerPivot.msi**) on each server in the SharePoint 2013 farm to install the data providers.</span></span> <span data-ttu-id="cf1b8-144">Les serveurs sur lesquels vous avez exécuté l'Assistant Installation de SQL Server, qui permet également la mise à niveau des fournisseurs de données, font exception.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-144">The exception is servers where you ran the SQL Server setup wizard, which also upgrades data providers.</span></span> <span data-ttu-id="cf1b8-145">Pour plus d’informations, consultez [installer ou désinstaller le complément PowerPivot pour SharePoint &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-145">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](https://docs.microsoft.com/analysis-services/instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013).</span></span>  
  
4.  <span data-ttu-id="cf1b8-146">**Exécutez l'outil de configuration de PowerPivot pour SharePoint 2013** sur un des serveurs d'applications SharePoint pour configurer la batterie de serveurs SharePoint avec les fichiers de solution mis à jour installés par le complément.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-146">**Run the PowerPivot for SharePoint 2013 Configuration** tool on one of the SharePoint application servers to configure the SharePoint farm with the updated solution files that the add-in installed.</span></span> <span data-ttu-id="cf1b8-147">Vous ne pouvez pas utiliser l'Administration centrale SharePoint pour cette étape.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-147">You cannot use Central SharePoint Administration for this step.</span></span> <span data-ttu-id="cf1b8-148">Pour plus d’informations, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-148">For more information, see the following:</span></span>  
  
    1.  <span data-ttu-id="cf1b8-149">Dans la page de démarrage de Windows, tapez **PowerPivot** , puis dans les résultats de recherche, cliquez sur **Configuration de PowerPivot pour SharePoint 2013**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-149">From the Windows Start page, type **PowerPivot** and in the search results, click **PowerPivot for SharePoint 2013 Configuration**.</span></span> <span data-ttu-id="cf1b8-150">Notez que la recherche peut retourner les deux versions de l'outil de configuration.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-150">Note the search may return both versions of the configuration tool.</span></span>  
  
         <span data-ttu-id="cf1b8-151">![deux outils de configuration PowerPivot](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "deux outils de configuration PowerPivot")</span><span class="sxs-lookup"><span data-stu-id="cf1b8-151">![two powerpivot configuratoin tools](../../analysis-services/media/as-powerpivot-configtools-bothicons.gif "two powerpivot configuratoin tools")</span></span>  
  
         <span data-ttu-id="cf1b8-152">ou</span><span class="sxs-lookup"><span data-stu-id="cf1b8-152">Or</span></span>  
  
         <span data-ttu-id="cf1b8-153">Dans le menu **Démarrer** , pointez sur **Tous les programmes**, puis sur [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], sur **Outils de configuration**, puis cliquez sur **Outil de configuration de PowerPivot pour SharePoint 2013**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-153">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot for SharePoint 2013 Configuration Too**.</span></span> <span data-ttu-id="cf1b8-154">Notez que cet outil est répertorié uniquement lorsque [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] est installé sur le serveur local.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-154">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="cf1b8-155">Au démarrage, l'outil de configuration vérifie l'état de mise à niveau des solutions de solution de la batterie de serveurs PowerPivot et de l'application Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-155">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="cf1b8-156">Si des versions antérieures de ces solutions sont détectées, vous verrez le message «**des versions plus récentes des fichiers de solution PowerPivot ont été détectées. Sélectionnez l’option de mise à niveau pour mettre à niveau votre batterie de serveurs**.»</span><span class="sxs-lookup"><span data-stu-id="cf1b8-156">If older versions of these solutions are detected, you will see the message "**Newer versions of the PowerPivot solution files have been detected. Please select the upgrade option to upgrade your farm**."</span></span> <span data-ttu-id="cf1b8-157">Cliquez sur **OK** pour fermer le message de validation système.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-157">Click **OK** to close the system validation message.</span></span>  
  
    3.  <span data-ttu-id="cf1b8-158">Cliquez sur **Mettre à niveau des fonctionnalités, des services, des applications et des solutions**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-158">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="cf1b8-159">Passez en revue les actions dans la liste des tâches du volet gauche et excluez celles que l'outil ne doit pas réaliser.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-159">Review the actions in the left pane task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="cf1b8-160">Toutes les actions sont incluses par défaut.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-160">All actions are included by default.</span></span> <span data-ttu-id="cf1b8-161">Pour supprimer une action, sélectionnez-la dans la liste des tâches à gauche, puis désactivez la case à cocher **Inclure cette action dans la liste des tâches** sur la page **Paramètres** .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-161">To remove an action, select it in the left task list, and then on the **Parameters** page, clear the **Include this action in the task list** checkbox.</span></span>  
  
    5.  <span data-ttu-id="cf1b8-162">Consultez éventuellement les informations détaillées figurant sous l'onglet **Script** ou l'onglet **Sortie** .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-162">Optionally, review detailed information in the **Script** or **Output** tab.</span></span>  
  
         <span data-ttu-id="cf1b8-163">L'onglet Sortie est un résumé des actions qui seront effectuées par l'outil.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-163">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="cf1b8-164">Ces informations sont enregistrées dans les fichiers journaux à l’emplacement `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-164">This information is saved in log files at `C:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\SPAddinConfiguration\Log`.</span></span>  
  
         <span data-ttu-id="cf1b8-165">L'onglet Script affiche les applets de commande PowerShell ou référence les fichiers de script PowerShell qui seront exécutés par l'outil.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-165">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    6.  <span data-ttu-id="cf1b8-166">Cliquez sur **Valider** pour vérifier si chaque action est valide.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-166">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="cf1b8-167">Si **Valider** n'est pas disponible, cela signifie que toutes les actions sont valides pour votre système.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-167">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="cf1b8-168">Si **Valider** est disponible, vous pouvez avoir modifié une valeur d’entrée (par exemple, le nom d’application de service Excel), ou l’outil peut avoir déterminé qu’une action particulière ne peut pas être exécutée.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-168">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="cf1b8-169">Si une action ne peut pas être effectuée, vous devez l'exclure ou résoudre les conditions sous-jacentes qui entraînent le marquage de l'action comme non valide.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-169">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="cf1b8-170">La première action, **Mettre à niveau une solution de batterie de serveurs**, doit toujours être traitée en premier.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-170">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="cf1b8-171">Elle inscrit les applets de commande PowerShell qui sont utilisées pour configurer le serveur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-171">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="cf1b8-172">Si vous obtenez une erreur sur cette action, ne continuez pas.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-172">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="cf1b8-173">À la place, utilisez les informations fournies par l'erreur pour diagnostiquer et résoudre le problème avant de traiter des actions supplémentaires dans la liste des tâches.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-173">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    7.  <span data-ttu-id="cf1b8-174">Cliquez sur **Exécuter** pour exécuter toutes les actions qui sont valides pour cette tâche.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-174">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="cf1b8-175">**Exécuter** est disponible uniquement lorsque le contrôle de validation a réussi.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-175">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="cf1b8-176">Quand vous cliquez sur **Exécuter**, l’avertissement suivant s’affiche, vous rappelant que les actions sont traitées en mode batch : « **Tous les paramètres de configuration marqués comme étant valides dans l’outil seront appliqués à la batterie de serveurs SharePoint. Voulez-vous continuer ?**  ».</span><span class="sxs-lookup"><span data-stu-id="cf1b8-176">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "**All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm. Do you want to continue?**".</span></span>  
  
    8.  <span data-ttu-id="cf1b8-177">Cliquez sur **OK** pour continuer.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-177">Click **Yes** to continue.</span></span>  
  
    9. <span data-ttu-id="cf1b8-178">La mise à niveau des solutions et des fonctionnalités de la batterie de serveurs peut prendre plusieurs minutes.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-178">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="cf1b8-179">Pendant ce temps, les demandes de connexion pour les données PowerPivot **échouent** avec des erreurs similaires à «**Impossible d’actualiser les données**» ou «**une erreur s’est produite lors de l’exécution de l’action demandée. Veuillez réessayer**.»</span><span class="sxs-lookup"><span data-stu-id="cf1b8-179">During this time, connection requests for PowerPivot data **will fail** with errors similar to "**Unable to refresh data**" or "**An error has occurred trying to perform the requested action. Please try again**."</span></span> <span data-ttu-id="cf1b8-180">Une fois la mise à niveau terminée, le serveur devient disponible et ces erreurs ne se produiront plus.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-180">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
     <span data-ttu-id="cf1b8-181">Pour plus d’informations, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-181">For more information, see the following:</span></span>  
  
    -   [<span data-ttu-id="cf1b8-182">Outils de configuration de PowerPivot</span><span class="sxs-lookup"><span data-stu-id="cf1b8-182">PowerPivot Configuration Tools</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-tools)  
  
    -   [<span data-ttu-id="cf1b8-183">Configurez ou réparez PowerPivot pour SharePoint 2013 &#40;outil de configuration de PowerPivot&#41;</span><span class="sxs-lookup"><span data-stu-id="cf1b8-183">Configure or Repair PowerPivot for SharePoint 2013 &#40;PowerPivot Configuration Tool&#41;</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-or-repair-power-pivot-for-sharepoint-2013)  
  
    -   [<span data-ttu-id="cf1b8-184">Configuration de PowerPivot à l’aide de Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="cf1b8-184">PowerPivot Configuration using Windows PowerShell</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-configuration-using-windows-powershell)  
  
    -   [<span data-ttu-id="cf1b8-185">Référence PowerShell pour PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="cf1b8-185">PowerShell Reference for PowerPivot for SharePoint</span></span>](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint)  
  
5.  <span data-ttu-id="cf1b8-186">Vérifiez que la mise à niveau a réussi en effectuant les étapes postérieures à la mise à niveau et en vérifiant la version des serveurs PowerPivot de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-186">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="cf1b8-187">Pour plus d'informations, consultez [Post-upgrade verification tasks](#verify) dans cette rubrique et la section suivante :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-187">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
 
  
##  <a name="upgrade-an-existing-sharepoint-2010-farm"></a><a name="bkmk_uprgade_sharepoint2010"></a> <span data-ttu-id="cf1b8-188">Mettre à niveau une batterie de serveurs SharePoint 2010 existante</span><span class="sxs-lookup"><span data-stu-id="cf1b8-188">Upgrade an Existing SharePoint 2010 Farm</span></span>  
 <span data-ttu-id="cf1b8-189">Pour mettre à niveau [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] déployé dans SharePoint 2010, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-189">To upgrade [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] deployed in SharePoint 2010, do the following:</span></span>  
  
 <span data-ttu-id="cf1b8-190">![Mettre à niveau PowerPivot pour SharePoint 2010](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "Mettre à niveau PowerPivot pour SharePoint 2010")</span><span class="sxs-lookup"><span data-stu-id="cf1b8-190">![powerpivot for sharepoint 2010 upgrade](../../../2014/sql-server/install/media/as-powepivot-upgrade-flow-sharepoint2010.png "powerpivot for sharepoint 2010 upgrade")</span></span>  
  
1.  <span data-ttu-id="cf1b8-191">Téléchargez le [Service Pack 2 pour Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) et appliquez-le sur tous les serveurs de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-191">Download [Service Pack 2 for Microsoft SharePoint 2010](https://www.microsoft.com/download/details.aspx?id=39672) and apply it on all servers in the farm.</span></span> <span data-ttu-id="cf1b8-192">Vérifiez que l'installation de SharePoint SP2 a réussi.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-192">Verify that SharePoint SP2 installation succeeded.</span></span> <span data-ttu-id="cf1b8-193">Dans Administration centrale, dans la page Mise à niveau et migration, ouvrez la page Vérifier l'état d’installation du correctif et du produit pour afficher les messages d'état liés au SP2.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-193">In Central Administration, on the Upgrade and Migration page, open the Check product and patch installation status page to view status messages related to SP2.</span></span>  
  
2.  <span data-ttu-id="cf1b8-194">Vérifiez que le service Windows Administration SharePoint 2010 est en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-194">Verify that the SharePoint 2010 Administration Windows service is running.</span></span>  
  
    ```powershell
    Get-Service | Where {$_.displayname -like "*SharePoint*"}  
    ```  
  
3.  <span data-ttu-id="cf1b8-195">Vérifiez que les services **SQL Server Analysis Services** et **Service système SQL Server PowerPivot** de **SharePoint** sont démarrés dans l'Administration centrale de SharePoint ou utilisez la commande PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-195">Verify the **SharePoint** services **SQL Server Analysis Services** and **SQL Server PowerPivot System Service** are started in SharePoint Central Administration or use the following PowerShell command:.</span></span>  
  
    ```powershell
    Get-SPServiceInstance | where {$_.typename -like "*sql*"}  
    ```  
  
4.  <span data-ttu-id="cf1b8-196">Vérifiez que le service **SQL Server Analysis Services (PowerPivot)\*\*\*\*Windows** est en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-196">Verify the **Windows** service **SQL Server Analysis Services (PowerPivot)** is running.</span></span>  
  
    ```powershell
    Get-Service | where {$_.displayname -like "*powerpivot*"}  
    ```  
  
5.  <span data-ttu-id="cf1b8-197">**Exécuter [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Le programme d’installation** sur le premier serveur d’applications SharePoint qui exécute le service Windows **SQL Server Analysis Services (PowerPivot)** pour mettre à niveau l’instance PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-197">**Run [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup** on the first SharePoint application server that runs the **SQL Server Analysis Services (PowerPivot)** Windows service to upgrade the POWERPIVOT instance.</span></span> <span data-ttu-id="cf1b8-198">Dans la page Installation de l'Assistant Installation de SQL Server, choisissez l'option de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-198">On the Installation page of the SQL Server Setup Wizard, choose the upgrade option.</span></span> <span data-ttu-id="cf1b8-199">Pour plus d’informations, consultez [mettre à niveau vers SQL Server 2014 à l’aide de l’Assistant installation &#40;&#41;d’installation ](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-199">For more information, see [Upgrade to SQL Server 2014 Using the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/upgrade-sql-server-using-the-installation-wizard-setup.md).</span></span>  
  
6.  <span data-ttu-id="cf1b8-200">**Redémarrez le serveur** avant d'exécuter l'outil de configuration.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-200">**Restart the server** before running the configuration tool.</span></span> <span data-ttu-id="cf1b8-201">Cette étape vérifie que tous les éléments requis ou mises à jour installés par le programme d'installation de SQL Server sont entièrement configurés sur le système.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-201">This step ensures that any updates or prerequisites installed by SQL Server Setup are fully configured on the system.</span></span>  
  
7.  <span data-ttu-id="cf1b8-202">**Exécutez l’outil de configuration PowerPivot** sur le premier serveur d’applications SharePoint qui exécute le service SQL Server Analysis Services (PowerPivot) pour mettre à niveau les solutions et les services Web dans SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-202">**Run the PowerPivot Configuration Tool** on the first SharePoint application server that runs SQL Server Analysis Services (PowerPivot) service to upgrade the solutions and Web services in SharePoint.</span></span> <span data-ttu-id="cf1b8-203">Vous ne pouvez pas utiliser l'Administration centrale pour cette étape.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-203">You cannot use Central Administration for this step.</span></span>  
  
    1.  <span data-ttu-id="cf1b8-204">Dans le menu **Démarrer** , pointez sur **Tous les programmes**, cliquez sur [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)]et sur **Outils de configuration**, puis cliquez sur **Outil de configuration PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-204">On the **Start** menu, point to **All Programs**, click [!INCLUDE[ssCurrentUI](../../includes/sscurrentui-md.md)], click **Configuration Tools**, and then click **PowerPivot Configuration Tool**.</span></span> <span data-ttu-id="cf1b8-205">Notez que cet outil est répertorié uniquement lorsque [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] est installé sur le serveur local.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-205">Note that this tool is listed only when [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is installed on the local server.</span></span>  
  
    2.  <span data-ttu-id="cf1b8-206">Au démarrage, l'outil de configuration vérifie l'état de mise à niveau des solutions de solution de la batterie de serveurs PowerPivot et de l'application Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-206">At startup, the configuration tool checks the upgrade status of the PowerPivot farm solution and PowerPivot web application solutions.</span></span> <span data-ttu-id="cf1b8-207">Si des versions antérieures de ces solutions sont détectées, vous verrez le message «des versions plus récentes des fichiers de solution PowerPivot ont été détectées.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-207">If older versions of these solutions are detected, you will see the message "Newer versions of the PowerPivot solution files have been detected.</span></span> <span data-ttu-id="cf1b8-208">Sélectionnez l’option de mise à niveau appropriée pour mettre à niveau votre batterie de serveurs ».</span><span class="sxs-lookup"><span data-stu-id="cf1b8-208">Please select the upgrade option to upgrade your farm."</span></span> <span data-ttu-id="cf1b8-209">Cliquez sur **OK** pour fermer le message.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-209">Click **OK** to close the message.</span></span>  
  
    3.  <span data-ttu-id="cf1b8-210">Cliquez sur **Mettre à niveau des fonctionnalités, des services, des applications et des solutions**, puis sur **OK** pour continuer.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-210">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK** to continue.</span></span>  
  
    4.  <span data-ttu-id="cf1b8-211">L’avertissement suivant s’affiche : «les classeurs dans le tableau de bord de gestion PowerPivot sont sur le point d’être mis à niveau vers la dernière version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-211">The following warning appears: "Workbooks in the PowerPivot Management Dashboard are about to be upgraded to the latest version.</span></span> <span data-ttu-id="cf1b8-212">Les personnalisations apportées aux classeurs existants seront perdues.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-212">Any customizations you made to the existing workbooks will be lost.</span></span> <span data-ttu-id="cf1b8-213">Voulez-vous continuer ? ».</span><span class="sxs-lookup"><span data-stu-id="cf1b8-213">Do you want to continue?"</span></span>  
  
         <span data-ttu-id="cf1b8-214">Cet avertissement fait référence aux classeurs du tableau de bord de gestion PowerPivot qui rendent compte de l'activité d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-214">This warning refers to workbooks in the PowerPivot Management Dashboard that report on data refresh activity.</span></span> <span data-ttu-id="cf1b8-215">Si vous avez personnalisé ces classeurs, toutes les modifications que vous avez apportées à ces classeurs seront perdues lorsque des fichiers existants seront remplacés par des versions plus récentes.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-215">If you customized these workbooks, any changes you made to those workbooks will be lost when existing files are replaced with newer versions.</span></span>  
  
         <span data-ttu-id="cf1b8-216">Cliquez sur **Oui** pour remplacer les classeurs par les versions plus récentes.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-216">Click **Yes** to overwrite the workbooks with newer versions.</span></span> <span data-ttu-id="cf1b8-217">Sinon, cliquez sur **Non** pour revenir à la page d'accueil.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-217">Otherwise, click **No** to return to the home page.</span></span> <span data-ttu-id="cf1b8-218">Enregistrez les classeurs à un emplacement différent de sorte de disposer d'une copie, puis revenez à cette étape lorsque vous êtes prêt à continuer.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-218">Save the workbooks to a different location so that you have a copy, and then return to this step when you are ready to continue.</span></span>  
  
         <span data-ttu-id="cf1b8-219">Pour plus d'informations sur la personnalisation des classeurs utilisés dans le tableau de bord, consultez [Personnalisation du tableau de bord de gestion PowerPivot](https://go.microsoft.com/fwlink/?linkID=229639).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-219">For more information about customizing workbooks used in the dashboard, see [Customizing the PowerPivot Management Dashboard](https://go.microsoft.com/fwlink/?linkID=229639).</span></span>  
  
    5.  <span data-ttu-id="cf1b8-220">Passez en revue les actions dans la liste des tâches et excluez celles que l'outil ne doit pas réaliser.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-220">Review the actions in the task list and exclude any that you do not want the tool to perform.</span></span> <span data-ttu-id="cf1b8-221">Toutes les actions sont incluses par défaut.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-221">All actions are included by default.</span></span> <span data-ttu-id="cf1b8-222">Pour supprimer une action, sélectionnez-la dans la liste des tâches, puis désactivez la case à cocher **Incluez cette action dans la liste des tâches** sur la page Paramètres.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-222">To remove an action, select it in the task list, and then clear the **Include this action in the task list** checkbox on the Parameters page.</span></span>  
  
    6.  <span data-ttu-id="cf1b8-223">Consultez éventuellement les informations détaillées figurant sous l'onglet **Sortie** ou l'onglet **Script** .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-223">Optionally, review detailed information in the **Output** tab or **Script** tab.</span></span>  
  
         <span data-ttu-id="cf1b8-224">L'onglet Sortie est un résumé des actions qui seront effectuées par l'outil.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-224">The Output tab is a summary of the actions that will be performed by the tool.</span></span> <span data-ttu-id="cf1b8-225">Ces informations sont enregistrées dans les fichiers journaux à l’emplacement `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-225">This information is saved in log files at `c:\Program Files\Microsoft SQL Server\120\Tools\PowerPivotTools\ConfigurationTool\Log`.</span></span>  
  
         <span data-ttu-id="cf1b8-226">L'onglet Script affiche les applets de commande PowerShell ou référence les fichiers de script PowerShell qui seront exécutés par l'outil.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-226">The Script tab shows the PowerShell cmdlets or references the PowerShell script files that the tool will run.</span></span>  
  
    7.  <span data-ttu-id="cf1b8-227">Cliquez sur **Valider** pour vérifier si chaque action est valide.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-227">Click **Validate** to check whether each action is valid.</span></span> <span data-ttu-id="cf1b8-228">Si **Valider** n'est pas disponible, cela signifie que toutes les actions sont valides pour votre système.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-228">If **Validate** is not available, it means that all of the actions are valid for your system.</span></span> <span data-ttu-id="cf1b8-229">Si **Valider** est disponible, vous pouvez avoir modifié une valeur d’entrée (par exemple, le nom d’application de service Excel), ou l’outil peut avoir déterminé qu’une action particulière ne peut pas être exécutée.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-229">If **Validate** is available, you might have modified an input value (for example, the Excel service application name), or the tool might have determined that a particular action cannot be performed.</span></span> <span data-ttu-id="cf1b8-230">Si une action ne peut pas être effectuée, vous devez l'exclure ou résoudre les conditions sous-jacentes qui entraînent le marquage de l'action comme non valide.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-230">If an action cannot be performed, you must exclude it or fix the underlying conditions that cause the action to be flagged as invalid.</span></span>  
  
        > [!IMPORTANT]  
        >  <span data-ttu-id="cf1b8-231">La première action, **Mettre à niveau une solution de batterie de serveurs**, doit toujours être traitée en premier.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-231">The first action, **Upgrade Farm Solution**, must always be processed first.</span></span> <span data-ttu-id="cf1b8-232">Elle inscrit les applets de commande PowerShell qui sont utilisées pour configurer le serveur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-232">It registers the PowerShell cmdlets that are used to configure the server.</span></span> <span data-ttu-id="cf1b8-233">Si vous obtenez une erreur sur cette action, ne continuez pas.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-233">If you get an error on this action, do not continue.</span></span> <span data-ttu-id="cf1b8-234">À la place, utilisez les informations fournies par l'erreur pour diagnostiquer et résoudre le problème avant de traiter des actions supplémentaires dans la liste des tâches.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-234">Instead, use the information provided by the error to diagnose and resolve the problem before processing additional actions in the task list.</span></span>  
  
    8.  <span data-ttu-id="cf1b8-235">Cliquez sur **Exécuter** pour exécuter toutes les actions qui sont valides pour cette tâche.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-235">Click **Run** to perform all of the actions that are valid for this task.</span></span> <span data-ttu-id="cf1b8-236">**Exécuter** est disponible uniquement lorsque le contrôle de validation a réussi.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-236">**Run** is available only after the validation check is passed.</span></span> <span data-ttu-id="cf1b8-237">Quand vous cliquez sur **Exécuter**, l’avertissement suivant s’affiche, vous rappelant que les actions sont traitées en mode batch : « Tous les paramètres de configuration marqués comme étant valides dans l’outil seront appliqués à la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-237">When you click **Run**, the following warning appears, reminding you that actions are processed in batch mode: "All of the configuration settings that are flagged as valid in the tool will be applied to the SharePoint farm.</span></span> <span data-ttu-id="cf1b8-238">Voulez-vous continuer ? ».</span><span class="sxs-lookup"><span data-stu-id="cf1b8-238">Do you want to continue?"</span></span>  
  
    9. <span data-ttu-id="cf1b8-239">Cliquez sur **OK** pour continuer.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-239">Click **Yes** to continue.</span></span>  
  
    10. <span data-ttu-id="cf1b8-240">La mise à niveau des solutions et des fonctionnalités de la batterie de serveurs peut prendre plusieurs minutes.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-240">Upgrading solutions and features in the farm can take several minutes to complete.</span></span> <span data-ttu-id="cf1b8-241">Pendant ce temps, les demandes de connexion pour les données PowerPivot échouent avec des erreurs telles que « impossible d’actualiser les données » ou «une erreur s’est produite lors de l’exécution de l’action demandée.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-241">During this time, connection requests for PowerPivot data will fail with errors like "Unable to refresh data" or "An error has occurred trying to perform the requested action.</span></span> <span data-ttu-id="cf1b8-242">Réessayez. »</span><span class="sxs-lookup"><span data-stu-id="cf1b8-242">Please try again."</span></span> <span data-ttu-id="cf1b8-243">Une fois la mise à niveau terminée, le serveur devient disponible et ces erreurs ne se produiront plus.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-243">After upgrade is finished, the server will become available and these errors will no longer occur.</span></span>  
  
8.  <span data-ttu-id="cf1b8-244">**Répétez le processus** pour chaque service d’SQL Server Analysis Services (PowerPivot) dans la batterie de serveurs : 1) exécutez SQL Server Setup 2) exécutez l’outil de configuration de PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-244">**Repeat the process** for each SQL Server Analysis Services (PowerPivot) service in the farm: 1) Run SQL Server setup 2) Run the PowerPivot Configuration tool.</span></span>  
  
9. <span data-ttu-id="cf1b8-245">Vérifiez que la mise à niveau a réussi en effectuant les étapes postérieures à la mise à niveau et en vérifiant la version des serveurs PowerPivot de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-245">Verify that upgrade succeeded by performing the post-upgrade steps and by checking the version of PowerPivot servers in the farm.</span></span> <span data-ttu-id="cf1b8-246">Pour plus d'informations, consultez [Post-upgrade verification tasks](#verify) dans cette rubrique et la section suivante :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-246">For more information, see [Post-upgrade verification tasks](#verify) in this topic and the following section.</span></span>  
  
10. <span data-ttu-id="cf1b8-247">**Résolution des erreurs**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-247">**Troubleshooting errors**</span></span>  
  
     <span data-ttu-id="cf1b8-248">Vous pouvez afficher les informations d'erreur dans le volet Paramètres pour chaque action.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-248">You can view error information in the Parameters pane for each action.</span></span>  
  
     <span data-ttu-id="cf1b8-249">Pour les problèmes liés au déploiement ou la rétraction de solution, vérifiez que le service Administrateur SharePoint 2010 a démarré.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-249">For problems related to solution deployment or retraction, verify the SharePoint 2010 Administrator service is started.</span></span> <span data-ttu-id="cf1b8-250">Ce service exécute les travaux du minuteur qui déclenchent des modifications de configuration dans une batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-250">This service runs the timer jobs that trigger configuration changes in a farm.</span></span> <span data-ttu-id="cf1b8-251">Si le service ne s'exécute pas, le déploiement ou la rétraction de solution échoue.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-251">If the service is not running, solution deployment or retraction will fail.</span></span> <span data-ttu-id="cf1b8-252">Des erreurs persistantes indiquent qu'un travail existant de déploiement ou de rétraction figure déjà dans la file d'attente et bloque toute action supplémentaire depuis l'outil de configuration.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-252">Persistent errors indicate that an existing deployment or retraction job is already in the queue and blocking further action from the configuration tool.</span></span>  
  
    1.  <span data-ttu-id="cf1b8-253">Démarrez SharePoint 2010 Management Shell en tant qu'administrateur, puis exécutez la commande suivante pour afficher les travaux dans la file d'attente :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-253">Start the SharePoint 2010 Management Shell as an administrator and then run the following command to view jobs in the queue:</span></span>  
  
        ```cmd
        stsadm -o enumdeployments  
        ```  
  
    2.  <span data-ttu-id="cf1b8-254">Passez en revue les déploiements existants pour obtenir les informations suivantes : **Type** indique une rétraction ou un déploiement, **Fichier** correspond à powerpivotwebapp.wsp ou powerpivotfarm.wsp.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-254">Review existing deployments for the following information: **Type** is Retraction or Deployment, **File** is powerpivotwebapp.wsp or powerpivotfarm.wsp.</span></span>  
  
    3.  <span data-ttu-id="cf1b8-255">Pour les déploiements ou les rétractions liés aux solutions PowerPivot, copiez la valeur GUID de **JobID** , puis collez-la dans la commande suivante (utilisez les commandes marquer, copier et coller dans le menu Edition de l’interpréteur de commandes pour copier le GUID) :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-255">For deployments or retractions related to PowerPivot solutions, copy the GUID value for **JobId** and then paste it into the following command (use the Mark, Copy, and Paste commands on the Shell's Edit menu to copy the GUID):</span></span>  
  
        ```cmd
        stsadm -o canceldeployment -id "<GUID>"  
        ```  
  
    4.  <span data-ttu-id="cf1b8-256">Réexécutez la tâche dans l'outil de configuration en cliquant sur **Valider** suivi d' **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-256">Retry the task in the configuration tool by clicking **Validate** followed by **Run**.</span></span>  
  
     <span data-ttu-id="cf1b8-257">Pour toutes les autres erreurs, vérifiez les journaux ULS.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-257">For all other errors, check the ULS logs.</span></span> <span data-ttu-id="cf1b8-258">Pour plus d’informations, consultez [configurer et afficher les fichiers journaux SharePoint et la journalisation des diagnostics &#40;PowerPivot pour SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-258">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/configure-and-view-sharepoint-and-diagnostic-logging).</span></span>  
  

  
##  <a name="workbooks"></a><a name="bkmk_workbooks"></a> <span data-ttu-id="cf1b8-259">Classeurs</span><span class="sxs-lookup"><span data-stu-id="cf1b8-259">Workbooks</span></span>  
 <span data-ttu-id="cf1b8-260">La mise à niveau d'un serveur ne met pas nécessairement à niveau les classeurs PowerPivot qui s'y exécutent, mais les classeurs plus anciens créés dans la version précédente de PowerPivot pour Excel continuent de fonctionner comme avant, avec les fonctionnalités disponibles dans cette version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-260">Upgrading a server does not necessarily upgrade the PowerPivot workbooks that run on it, but older workbooks created in the previous version of PowerPivot for Excel will continue to work as before, using the features available in that release.</span></span> <span data-ttu-id="cf1b8-261">Les classeurs restent fonctionnels, car un serveur mis à niveau dispose de la version du fournisseur OLE DB Analysis Services qui faisait partie de l'installation antérieure.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-261">Workbooks remain functional because an upgraded server has the version of the Analysis Services OLE DB provider that was part of the previous installation.</span></span>  
  
  
  
##  <a name="data-refresh"></a><a name="bkmk_datarefresh"></a> <span data-ttu-id="cf1b8-262">Actualisation des données</span><span class="sxs-lookup"><span data-stu-id="cf1b8-262">Data Refresh</span></span>  
 <span data-ttu-id="cf1b8-263">La mise à niveau a un impact sur les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-263">Upgrade will impact data refresh operations.</span></span> <span data-ttu-id="cf1b8-264">L'actualisation des données planifiée sur le serveur est disponible uniquement pour les classeurs qui correspondent à la version du serveur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-264">Scheduled data refresh on the server is available only for workbooks that match the server version.</span></span> <span data-ttu-id="cf1b8-265">Si vous hébergez des classeurs de la version antérieure, il est possible que l'actualisation des données ne fonctionne plus pour ces classeurs.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-265">If you are hosting workbooks from the previous version, data refresh might no longer work for those workbooks.</span></span> <span data-ttu-id="cf1b8-266">Pour réactiver l'actualisation des données, vous devez mettre à niveau les classeurs.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-266">To re-enable data refresh, you must upgrade the workbooks.</span></span> <span data-ttu-id="cf1b8-267">Vous pouvez mettre à niveau chaque classeur manuellement dans PowerPivot pour Excel ou activer la mise à niveau automatique pour la fonctionnalité d'actualisation des données dans SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-267">You can upgrade each workbook manually in PowerPivot for Excel, or enable the auto-upgrade for data refresh feature in SharePoint 2010.</span></span> <span data-ttu-id="cf1b8-268">La mise à niveau automatique effectue la mise à niveau d'un classeur vers la version actuelle avant l'actualisation des données, ce qui permet aux opérations d'actualisation des données de respecter la planification établie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-268">Auto-upgrade will upgrade a workbook to the current version prior to running data refresh, allowing data refresh operations to remain on schedule.</span></span>  
  

  
##  <a name="verify-the-versions-of-powerpivot-components-and-services"></a><a name="bkmk_verify_versions"></a><span data-ttu-id="cf1b8-269">Vérifier les versions des composants et services PowerPivot</span><span class="sxs-lookup"><span data-stu-id="cf1b8-269">Verify the Versions of PowerPivot Components and Services</span></span>  
 <span data-ttu-id="cf1b8-270">Toutes les instances du service système [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] et d'Analysis Services doivent avoir la même version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-270">All instances of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] System Service and Analysis Services must be the same version.</span></span> <span data-ttu-id="cf1b8-271">Pour vérifier que tous les composants serveur utilisent la même version, contrôlez les informations de version des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-271">To verify that all server components are at the same version, check version information for the following:</span></span>  
  
### <a name="verify-the-version-of-powerpivot-solutions-and-the-powerpivot-system-service"></a><span data-ttu-id="cf1b8-272">Vérifier la version de solutions PowerPivot et du service système PowerPivot</span><span class="sxs-lookup"><span data-stu-id="cf1b8-272">Verify the version of PowerPivot Solutions and the PowerPivot System Service</span></span>  
 <span data-ttu-id="cf1b8-273">Exécutez la commande PowerShell suivante :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-273">Run the following PowerShell command:</span></span>  
  
```powershell
Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="cf1b8-274">Vérifiez **CurrentSolutionVersion**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-274">Verify the **CurrentSolutionVersion**.</span></span> [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="cf1b8-275">est la version 12,0. \<major build> .\<minor build></span><span class="sxs-lookup"><span data-stu-id="cf1b8-275">is version 12.0.\<major build>.\<minor build></span></span>  
  
### <a name="verify-the-version-of-the-analysis-services-windows-service"></a><span data-ttu-id="cf1b8-276">Vérifier la version du service Windows Analysis Services</span><span class="sxs-lookup"><span data-stu-id="cf1b8-276">Verify the version of the Analysis Services Windows Service</span></span>  
 <span data-ttu-id="cf1b8-277">Si vous n'avez mis à niveau que certains de vos serveurs [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] dans une batterie SharePoint 2010, l'instance d' [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] sur les serveurs qui n'ont pas été mis à niveau est plus ancienne que la version attendue dans la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-277">If you upgraded only some of your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] servers in a SharePoint 2010 farm, the instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] on un-upgraded servers will be older than the version expected in the farm.</span></span> <span data-ttu-id="cf1b8-278">Vous devrez effectuer une mise à niveau de tous vos serveurs vers la même version pour permettre leur utilisation.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-278">You will need to upgrade all of your servers to the same version in order for them to be usable.</span></span> <span data-ttu-id="cf1b8-279">Utilisez l’une des méthodes suivantes pour vérifier la version du service Windows SQL Server Analysis Services (PowerPivot) sur chaque ordinateur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-279">Use one of the following methods to verify the version of the SQL Server Analysis Services (PowerPivot) Windows service on each computer.</span></span>  
  
 <span data-ttu-id="cf1b8-280">**Explorateur de fichiers Windows**:</span><span class="sxs-lookup"><span data-stu-id="cf1b8-280">**Windows File Explorer**:</span></span>  
  
1.  <span data-ttu-id="cf1b8-281">Accédez au dossier **Bin** pour l'instance de [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-281">Navigate to the **Bin** folder for the [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] instance.</span></span> <span data-ttu-id="cf1b8-282">Par exemple, `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-282">For example `C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\bin`.</span></span>  
  
2.  <span data-ttu-id="cf1b8-283">Cliquez avec le bouton droit sur `msmdsrv.exe`, puis sélectionnez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-283">Right-click `msmdsrv.exe`, and select **Properties**.</span></span>  
  
3.  <span data-ttu-id="cf1b8-284">Cliquez sur **Details**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-284">Click **Details**.</span></span>  
  
4.  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]<span data-ttu-id="cf1b8-285">la version du fichier doit être 12,00.. \<major build> \<minor build> .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-285">file version should be 12.00.\<major build>.\<minor build>.</span></span>  
  
5.  <span data-ttu-id="cf1b8-286">Vérifiez que ce numéro est identique à la version de solution PowerPivot et du service système.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-286">Verify that this number is identical to the PowerPivot solution and system service version.</span></span>  
  
 <span data-ttu-id="cf1b8-287">**Informations sur le démarrage du service :**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-287">**Service start information:**</span></span>  
  
 <span data-ttu-id="cf1b8-288">Lorsque le service PowerPivot démarre, il écrit des informations de version dans le journal des événements Windows.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-288">When the PowerPivot service starts, it writes version information into the Windows event log.</span></span>  
  
1.  <span data-ttu-id="cf1b8-289">Exécuter Windows `eventvwr`</span><span class="sxs-lookup"><span data-stu-id="cf1b8-289">Run Windows `eventvwr`</span></span>  
  
2.  <span data-ttu-id="cf1b8-290">Créez un filtre pour la source `MSOLAP$POWERPIVOT`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-290">Create a filter for source `MSOLAP$POWERPIVOT`.</span></span>  
  
3.  <span data-ttu-id="cf1b8-291">Rechercher un événement de niveau d'informations similaire au suivant</span><span class="sxs-lookup"><span data-stu-id="cf1b8-291">Look for an information level event similar to the following</span></span>  
  
     <span data-ttu-id="cf1b8-292">Service   démarré.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-292">Service started.</span></span> <span data-ttu-id="cf1b8-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-293">Microsoft SQL Server Analysis Services 64 Bit Evaluation (x64) RTM **12.0.2000.8**.</span></span>  
  
 <span data-ttu-id="cf1b8-294">**Utilisez PowerShell pour vérifier la version du fichier.**</span><span class="sxs-lookup"><span data-stu-id="cf1b8-294">**Use PowerShell to verify file version.**</span></span>  
  
 <span data-ttu-id="cf1b8-295">Vous pouvez utiliser PowerShell pour vérifier la version du produit.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-295">You can use PowerShell to verify the product version.</span></span> <span data-ttu-id="cf1b8-296">PowerShell est un bon choix si vous souhaitez créer un script ou automatiser la vérification de la version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-296">PowerShell is a good option if you want to script or automate version verification.</span></span>  
  
```powershell
(Get-ChildItem "C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe").VersionInfo  
```  
  
 <span data-ttu-id="cf1b8-297">La commande PowerShell ci-dessus retourne des informations semblables aux suivantes :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-297">The above PowerShell command returns information similar to the following:</span></span>  
  
 <span data-ttu-id="cf1b8-298">ProductVersion   FileVersion           FileName</span><span class="sxs-lookup"><span data-stu-id="cf1b8-298">ProductVersion   FileVersion           FileName</span></span>  
  
 <span data-ttu-id="cf1b8-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span><span class="sxs-lookup"><span data-stu-id="cf1b8-299">**12.0.2000.8** 2014.0120.200    C:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT2000\OLAP\bin\msmdsrv.exe</span></span>  
  
### <a name="verify-the-msolap-data-provider-version-on-sharepoint"></a><span data-ttu-id="cf1b8-300">Vérifier la version du fournisseur de données MSOLAP sur SharePoint</span><span class="sxs-lookup"><span data-stu-id="cf1b8-300">Verify the MSOLAP Data Provider Version on SharePoint</span></span>  
 <span data-ttu-id="cf1b8-301">Suivez les instructions suivantes pour vérifier quelles versions des fournisseurs OLE DB Analysis Services sont approuvées par Excel Services.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-301">Use the following instructions to check which versions of the Analysis Services OLE DB providers are trusted by Excel Services.</span></span> <span data-ttu-id="cf1b8-302">Vous devez être l'administrateur de la batterie ou de l'application de service pour vérifier les paramètres du fournisseur de données approuvé d'Excel Services.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-302">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="cf1b8-303">Dans l'Administration centrale, sous Gestion des applications, cliquez sur **Gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-303">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="cf1b8-304">Cliquez sur le nom de l'application de service Excel Services, par exemple **ExcelServiceApp1**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-304">Click the name of the Excel Services service application, for example **ExcelServiceApp1**.</span></span>  
  
3.  <span data-ttu-id="cf1b8-305">Cliquez sur **Fournisseurs de données approuvés**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-305">Click **Trusted Data Providers**.</span></span> <span data-ttu-id="cf1b8-306">Vous devez voir MSOLAP.5 (Fournisseur Microsoft OLE DB pour OLAP Services 11.0).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-306">You should see MSOLAP.5 (Microsoft OLE DB Provider for OLAP Services 11.0).</span></span> <span data-ttu-id="cf1b8-307">Si vous avez effectué la mise à niveau de votre installation [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , vous verrez également MSOLAP.4 de la version antérieure.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-307">If you upgraded your [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installation, you will also see MSOLAP.4 from the previous version.</span></span>  
  
4.  <span data-ttu-id="cf1b8-308">Pour plus d'informations, consultez [Ajouter MSOLAP.5 en tant que fournisseur de données approuvé dans Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-308">For more information, see [Add MSOLAP.5 as a Trusted Data Provider in Excel Services](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/add-msolap-5-as-a-trusted-data-provider-in-excel-services).</span></span>  
  
 <span data-ttu-id="cf1b8-309">MSOLAP.4 est décrit comme Fournisseur Microsoft OLE DB pour OLAP Services 10.0.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-309">MSOLAP.4 is described as the Microsoft OLE DB Provider for OLAP Services 10.0.</span></span> <span data-ttu-id="cf1b8-310">Cette version peut être la version par défaut de [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] installée avec Excel Services, ou ce peut être la version [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-310">This version might be the default version from [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] that is installed with Excel Services, or it might be the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version.</span></span> <span data-ttu-id="cf1b8-311">La version par défaut que SharePoint installe ne prend pas en charge l'accès aux données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-311">The default version that SharePoint installs does not support PowerPivot data access.</span></span> <span data-ttu-id="cf1b8-312">La version [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] ou ultérieure doit se connecter aux classeurs PowerPivot sur SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-312">You must have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version or later to connect to PowerPivot workbooks on SharePoint.</span></span> <span data-ttu-id="cf1b8-313">Pour vérifier que vous disposez de la version [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] , suivez les instructions de la section précédente qui expliquent comment vérifier la version en consultant les propriétés du fichier.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-313">To verify you have the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] version, use the instructions in the previous section that explain how to verify the version by viewing file properties.</span></span>  
  
### <a name="verify-the-adomdnet-data-provider-version"></a><span data-ttu-id="cf1b8-314">Vérifier la version du fournisseur de données ADOMD.NET</span><span class="sxs-lookup"><span data-stu-id="cf1b8-314">Verify the ADOMD.NET Data Provider Version</span></span>  
 <span data-ttu-id="cf1b8-315">Utilisez les instructions suivantes pour vérifier quelle version d'ADOMD.NET est installée.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-315">Use the following instructions to check which version of ADOMD.NET is installed.</span></span> <span data-ttu-id="cf1b8-316">Vous devez être l'administrateur de la batterie ou de l'application de service pour vérifier les paramètres du fournisseur de données approuvé d'Excel Services.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-316">You must be a farm or service application administrator to check the trusted data provider settings of Excel Services.</span></span>  
  
1.  <span data-ttu-id="cf1b8-317">Sur votre serveur d'applications SharePoint, accédez à `c:\Windows\Assembly`.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-317">On your SharePoint application server, browse to `c:\Windows\Assembly`.</span></span>  
  
2.  <span data-ttu-id="cf1b8-318">Triez par nom d'assembly et recherchez **Microsoft.Analysis Services.Adomd.Client**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-318">Sort by assembly name and find the **Microsoft.Analysis Services.Adomd.Client**.</span></span>  
  
3.  <span data-ttu-id="cf1b8-319">Vérifiez que vous disposez de la version 12,0. \<build number> .</span><span class="sxs-lookup"><span data-stu-id="cf1b8-319">Verify you have version 12.0.\<build number>.</span></span>  
  

##  <a name="upgrading-multiple-powerpivot-for-sharepoint-servers-in-a-sharepoint-farm"></a><a name="geminifarm"></a><span data-ttu-id="cf1b8-320">Mise à niveau de plusieurs serveurs PowerPivot pour SharePoint dans une batterie de serveurs SharePoint</span><span class="sxs-lookup"><span data-stu-id="cf1b8-320">Upgrading Multiple PowerPivot for SharePoint Servers in a SharePoint Farm</span></span>  
 <span data-ttu-id="cf1b8-321">Dans une topologie à plusieurs serveurs qui inclut plusieurs serveurs [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] , toutes les instances de serveur et tous les composants doivent avoir la même version.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-321">In a multi-server topology that includes more than one [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] server, all server instances and components must be the same version.</span></span> <span data-ttu-id="cf1b8-322">Le serveur qui exécute la version la plus récente du logiciel définit le niveau pour tous les serveurs de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-322">The server that runs the highest version of the software sets the level for all servers in the farm.</span></span> <span data-ttu-id="cf1b8-323">Si vous ne mettez à niveau que quelques serveurs, ceux qui exécutent des versions antérieures du logiciel deviendront indisponibles jusqu'à ce qu'ils soient également mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-323">If you upgrade just some of the servers, the ones that are running older versions of the software will become unavailable until they are also upgraded.</span></span>  
  
 <span data-ttu-id="cf1b8-324">Une fois le premier serveur à niveau, les serveurs supplémentaires qui n'ont pas encore été mis à niveau **deviennent indisponibles**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-324">After you upgrade the first server, additional servers that are not yet upgraded **will become unavailable**.</span></span> <span data-ttu-id="cf1b8-325">Leur disponibilité est restaurée une fois que tous les serveurs sont au même niveau.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-325">Availability is restored after all servers run at the same level.</span></span>  
  
 <span data-ttu-id="cf1b8-326">L'installation de SQL Server met à niveau les fichiers de solution PowerPivot en place sur l'ordinateur physique, mais la mise à niveau des solutions utilisées par la batterie exige d'utiliser l'outil de configuration de PowerPivot décrit dans une section précédente de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-326">SQL Server Setup upgrades the PowerPivot solution files in place on the physical computer, but to upgrade the solutions in use by the farm, you must use the PowerPivot Configuration Tool described in a previous section of this topic..</span></span>  

##  <a name="applying-a-qfe-to-a-powerpivot-instance-in-the-farm"></a><a name="qfe"></a><span data-ttu-id="cf1b8-327">Application d’un correctif QFE à une instance PowerPivot dans la batterie de serveurs</span><span class="sxs-lookup"><span data-stu-id="cf1b8-327">Applying a QFE to a PowerPivot instance in the farm</span></span>  
 <span data-ttu-id="cf1b8-328">L'application d'un correctif à un serveur PowerPivot pour SharePoint met à jour les fichiers programme existants vers une version plus récente qui inclut le correctif d'un problème spécifique.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-328">Patching a PowerPivot for SharePoint server updates existing program files with a newer version that includes a fix for a specific problem.</span></span> <span data-ttu-id="cf1b8-329">Lors de l'application d'un correctif QFE à une topologie à plusieurs serveurs, il n'y a aucun serveur principal par lequel commencer obligatoirement.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-329">When applying a QFE to a multi-server topology, there is no primary server that you must begin with.</span></span> <span data-ttu-id="cf1b8-330">Vous pouvez commencer par n'importe quel serveur tant que vous appliquez le même correctif QFE aux autres serveurs PowerPivot de la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-330">You can start with any server as long as you apply the same QFE to the other PowerPivot servers in the farm.</span></span>  
  
 <span data-ttu-id="cf1b8-331">Lorsque vous appliquez le correctif QFE, vous devez également effectuer une étape de configuration qui met à jour les informations de version du serveur dans la base de données de configuration de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-331">When you apply the QFE, you must also perform a configuration step that updates the server version information in the farm configuration database.</span></span> <span data-ttu-id="cf1b8-332">La version du serveur corrigé devient la nouvelle version attendue pour la batterie.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-332">The version of the patched server becomes the new expected version for the farm.</span></span> <span data-ttu-id="cf1b8-333">Tant que le correctif QFE n'est pas appliqué et configuré sur tous les ordinateurs, les instances de PowerPivot pour SharePoint pour lesquelles le correctif QFE n'est pas disponible ne peuvent pas traiter les demandes de données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-333">Until the QFE is applied and configured across all machines, the PowerPivot for SharePoint instances that do not have the QFE will be unavailable to handle requests for PowerPivot data.</span></span>  
  
 <span data-ttu-id="cf1b8-334">Pour vous assurer que le correctif QFE est appliqué et configuré correctement, suivez les instructions suivantes :</span><span class="sxs-lookup"><span data-stu-id="cf1b8-334">To ensure the QFE is applied and configured correctly, follow these instructions:</span></span>  
  
1.  <span data-ttu-id="cf1b8-335">Installez le correctif logiciel à l'aide des instructions fournies avec le correctif QFE.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-335">Install the patch using the instructions that are provided with the QFE.</span></span>  
  
2.  <span data-ttu-id="cf1b8-336">Démarrez l'outil de configuration PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-336">Start the PowerPivot Configuration Tool.</span></span>  
  
3.  <span data-ttu-id="cf1b8-337">Cliquez sur **Mettre à niveau des fonctionnalités, des services, des applications et des solutions**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-337">Click **Upgrade Features, Services, Applications and Solutions**, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="cf1b8-338">Passez en revue les actions incluses dans la tâche de mise à niveau, puis cliquez **Valider**.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-338">Review the actions that are included in the upgrade task, and then click **Validate**.</span></span>  
  
5.  <span data-ttu-id="cf1b8-339">Cliquez sur **Exécuter** pour appliquer les actions.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-339">Click **Run** to apply the actions.</span></span>  
  
6.  <span data-ttu-id="cf1b8-340">Répétez cette procédure pour des instances PowerPivot pour SharePoint supplémentaires dans la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-340">Repeat for additional PowerPivot for SharePoint instances in the farm.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="cf1b8-341">Dans un déploiement à plusieurs serveurs, assurez-vous de corriger et de configurer chaque instance avant de continuer à l'ordinateur suivant.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-341">In a multi-server deployment, be sure to both patch and configure each instance before continuing to the next machine.</span></span> <span data-ttu-id="cf1b8-342">L'outil de configuration de PowerPivot doit exécuter la tâche de mise à niveau pour l'instance actuelle avant de passer à l'instance suivante.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-342">The PowerPivot Configuration Tool must complete the upgrade task for the current instance before you move on to the next instance.</span></span>  
  
 <span data-ttu-id="cf1b8-343">Pour vérifier les informations de version des services de la batterie de serveurs, utilisez la page **Vérifier l'état d’installation du correctif et du produit** dans la section Gestion des mises à niveau et des correctifs de l'Administration centrale.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-343">To check version information for services in the farm, use the **Check product and patch installation status** page in the Upgrade and Patch Management section in Central Administration.</span></span>  
  
##  <a name="post-upgrade-verification-tasks"></a><a name="verify"></a> <span data-ttu-id="cf1b8-344">Tâches de vérification consécutives à la mise à niveau</span><span class="sxs-lookup"><span data-stu-id="cf1b8-344">Post-upgrade verification tasks</span></span>  
 <span data-ttu-id="cf1b8-345">Une fois la mise à niveau terminée, utilisez les étapes suivantes pour vérifier que le serveur est opérationnel.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-345">After upgrade is complete, use the following steps to verify the server is operational.</span></span>  
  
|<span data-ttu-id="cf1b8-346">Tâche</span><span class="sxs-lookup"><span data-stu-id="cf1b8-346">Task</span></span>|<span data-ttu-id="cf1b8-347">Lien</span><span class="sxs-lookup"><span data-stu-id="cf1b8-347">Link</span></span>|  
|----------|----------|  
|<span data-ttu-id="cf1b8-348">Vérifiez que le service fonctionne sur tous les ordinateurs qui exécutent PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-348">Verify the service is running on all computers that run PowerPivot for SharePoint.</span></span>|[<span data-ttu-id="cf1b8-349">Démarrer ou arrêter un service PowerPivot pour un serveur SharePoint</span><span class="sxs-lookup"><span data-stu-id="cf1b8-349">Start or Stop a PowerPivot for SharePoint Server</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/start-or-stop-a-power-pivot-for-sharepoint-server)|  
|<span data-ttu-id="cf1b8-350">Vérifiez l'activation des fonctionnalités au niveau de la collection de sites.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-350">Verify feature activation at the site collection level.</span></span>|[<span data-ttu-id="cf1b8-351">Activer la fonctionnalité d'intégration PowerPivot pour des collections de sites dans l'Administration centrale</span><span class="sxs-lookup"><span data-stu-id="cf1b8-351">Activate PowerPivot Feature Integration for Site Collections in Central Administration</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/activate-power-pivot-integration-for-site-collections-in-ca)|  
|<span data-ttu-id="cf1b8-352">Vérifiez que les classeurs PowerPivot se chargent correctement en ouvrant un classeur et cliquant sur les filtres et les segments pour initialiser une requête.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-352">Verify individual PowerPivot workbooks are loading properly by opening a workbook and clicking on filters and slicers to initiate a query.</span></span>|<span data-ttu-id="cf1b8-353">Recherchez la présence de fichiers mis en cache sur le disque dur.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-353">Check for the presence of cached files on the hard drive.</span></span> <span data-ttu-id="cf1b8-354">La présence de fichiers mis en cache confirme que les fichiers de données ont été chargés sur ce serveur physique.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-354">A cached file confirms that the data file was loaded on that physical server.</span></span> <span data-ttu-id="cf1b8-355">Recherchez les fichiers mis en cache dans le dossier c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-355">Look for cached files in the c:\Program Files\Microsoft SQL Server\MSAS12.POWERPIVOT\OLAP\Backup folder.</span></span>|  
|<span data-ttu-id="cf1b8-356">Testez l'actualisation des données sur les classeurs sélectionnés configurés pour l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-356">Test data refresh on selected workbooks that are configured for data refresh.</span></span>|<span data-ttu-id="cf1b8-357">La méthode la plus simple pour tester l'actualisation des données consiste à modifier une planification d'actualisation des données, en activant la case à cocher **Aussi actualiser dès que possible** afin que l'actualisation des données s'exécute immédiatement.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-357">The easiest way to test data refresh is to modify a data refresh schedule, choosing the **Also refresh as soon as possible** checkbox so that data refresh runs immediately.</span></span> <span data-ttu-id="cf1b8-358">Cette étape détermine si l'actualisation des données aboutit pour le classeur actuel.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-358">This step will determine whether data refresh is successful for the current workbook.</span></span> <span data-ttu-id="cf1b8-359">Répétez ces étapes pour les autres classeurs fréquemment utilisés pour vous assurer que l'actualisation des données est fonctionnelle.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-359">Repeat these steps for other frequently used workbooks to ensure that data refresh is functional.</span></span> <span data-ttu-id="cf1b8-360">Pour plus d’informations sur la planification de l’actualisation des données, consultez [planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-360">For more information about scheduling data refresh, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](../../../2014/analysis-services/schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>|  
|<span data-ttu-id="cf1b8-361">Au fil du temps, vérifiez les rapports d'actualisation des données dans le tableau de bord de gestion PowerPivot pour vous assurer qu'il n'y a pas d'erreurs d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="cf1b8-361">Over time, monitor the data refresh reports in PowerPivot Management Dashboard to confirm there are no data refresh errors.</span></span>|[<span data-ttu-id="cf1b8-362">Tableau de bord de gestion PowerPivot et données d’utilisation</span><span class="sxs-lookup"><span data-stu-id="cf1b8-362">PowerPivot Management Dashboard and Usage Data</span></span>](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data)|  
  
 <span data-ttu-id="cf1b8-363">Pour plus d’informations sur la configuration des paramètres et des fonctionnalités PowerPivot, consultez [administration et configuration du serveur PowerPivot dans l’administration centrale](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-363">For more information about how to configure PowerPivot settings and features, see [PowerPivot Server Administration and Configuration in Central Administration](https://docs.microsoft.com/analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration).</span></span>  
  
 <span data-ttu-id="cf1b8-364">Pour obtenir des instructions pas à pas qui vous guident dans toutes les tâches de configuration consécutives à l’installation, consultez [configuration initiale &#40;PowerPivot pour SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="cf1b8-364">For step-by-step instructions that guide you through all of the post-installation configuration tasks, see [Initial Configuration &#40;PowerPivot for SharePoint&#41;](../../../2014/sql-server/install/initial-configuration-powerpivot-for-sharepoint.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="cf1b8-365">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cf1b8-365">See Also</span></span>  
 <span data-ttu-id="cf1b8-366">[Fonctionnalités prises en charge par les éditions de SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span><span class="sxs-lookup"><span data-stu-id="cf1b8-366">[Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md) </span></span>  
 [<span data-ttu-id="cf1b8-367">PowerPivot for SharePoint 2010 Installation</span><span class="sxs-lookup"><span data-stu-id="cf1b8-367">PowerPivot for SharePoint 2010 Installation</span></span>](../../../2014/sql-server/install/powerpivot-for-sharepoint-2010-installation.md)  
