---
title: Mettre à niveau des bases de données répliquées | Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: install
ms.topic: conceptual
helpviewer_keywords:
- merge replication database upgrades [SQL Server replication]
- replication [SQL Server], upgrading
- transactional replication, upgrading databases
- snapshot replication [SQL Server], upgrading databases
- upgrading replicated databases
ms.assetid: 9926a4f7-bcd8-4b9b-9dcf-5426a5857116
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 326a94820876b40128428aac58e47c650ce122b8
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603595"
---
# <a name="upgrade-replicated-databases"></a><span data-ttu-id="078b8-102">Mettre à niveau des bases de données répliquées</span><span class="sxs-lookup"><span data-stu-id="078b8-102">Upgrade Replicated Databases</span></span>
  [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] <span data-ttu-id="078b8-103">prend en charge la mise à niveau des bases de données répliquées à partir des versions précédentes de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ; il n'est pas nécessaire d'interrompre l'activité des autres nœuds lorsqu'un nœud est en cours de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="078b8-103">supports upgrading replicated databases from previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]; it is not required to stop activity at other nodes while a node is being upgraded.</span></span> <span data-ttu-id="078b8-104">Prenez soin de respecter les règles relatives aux versions qui sont prises en charge dans une topologie :</span><span class="sxs-lookup"><span data-stu-id="078b8-104">Ensure that you adhere to the rules regarding which versions are supported in a topology:</span></span>  
  
-   <span data-ttu-id="078b8-105">Toute version convient pour le serveur de distribution dès lors qu'elle est égale ou supérieure à celle du serveur de publication (en général, l'instance du serveur de distribution est la même que celle du serveur de publication).</span><span class="sxs-lookup"><span data-stu-id="078b8-105">A Distributor can be any version as long as it is greater than or equal to the Publisher version (in many cases the Distributor is the same instance as the Publisher).</span></span>  
  
-   <span data-ttu-id="078b8-106">Toute version convient pour le serveur de publication dès lors qu'elle est inférieure ou égale à celle du serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="078b8-106">A Publisher can be any version as long as it less than or equal to the Distributor version.</span></span>  
  
-   <span data-ttu-id="078b8-107">La version de l'Abonné dépend du type de publication :</span><span class="sxs-lookup"><span data-stu-id="078b8-107">Subscriber version depends on the type of publication:</span></span>  
  
    -   <span data-ttu-id="078b8-108">La version d'un Abonné à une publication transactionnelle peut être n'importe laquelle des deux versions du serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="078b8-108">A Subscriber to a transactional publication can be any version within two versions of the Publisher version.</span></span> <span data-ttu-id="078b8-109">Par exemple : un serveur de publication [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] en cours d'exécution peut avoir des Abonnés [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] et un serveur de publication [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] peut avoir des Abonnés [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="078b8-109">For example: a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] Publisher running can have [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Subscribers; and a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Publisher can have [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] Subscribers.</span></span>  
  
    -   <span data-ttu-id="078b8-110">La version d'un Abonné à une publication de fusion peut être toute version inférieure ou égale à celle du serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="078b8-110">A Subscriber to a merge publication can be any version less than or equal to the Publisher version.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="078b8-111">Cette rubrique est disponible dans la documentation d'aide du programme d'installation et dans la documentation en ligne de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="078b8-111">This topic is available in the Setup Help documentation and in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Books Online.</span></span> <span data-ttu-id="078b8-112">Les liens vers des rubriques qui s'affichent en gras dans la documentation d'aide du programme d'installation font référence à des rubriques qui sont exclusivement disponibles dans la documentation en ligne.</span><span class="sxs-lookup"><span data-stu-id="078b8-112">Topic links that appear as bold text in the Setup Help documentation refer to topics that are only available in Books Online.</span></span>  
  
## <a name="run-the-log-reader-agent-for-transactional-replication-before-upgrade"></a><span data-ttu-id="078b8-113">Exécuter l'Agent de lecture du journal pour la réplication transactionnelle avant la mise à niveau</span><span class="sxs-lookup"><span data-stu-id="078b8-113">Run the Log Reader Agent for Transactional Replication Before Upgrade</span></span>  
 <span data-ttu-id="078b8-114">Avant d'effectuer la mise à niveau vers [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], vous devez vous assurer que toutes les transactions validées de tables publiées ont été traitées par l'Agent de lecture du journal.</span><span class="sxs-lookup"><span data-stu-id="078b8-114">Before you upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], you must make sure that all committed transactions from published tables have been processed by the Log Reader Agent.</span></span> <span data-ttu-id="078b8-115">Pour vous assurer que toutes les transactions ont été traitées, effectuez les étapes suivantes pour chaque base de données qui contient des publications transactionnelles :</span><span class="sxs-lookup"><span data-stu-id="078b8-115">To make sure that all transactions have been processed, perform the following steps for each database that contains transactional publications:</span></span>  
  
1.  <span data-ttu-id="078b8-116">Assurez-vous que l'Agent de lecture du journal s'exécute pour la base de données.</span><span class="sxs-lookup"><span data-stu-id="078b8-116">Make sure that the Log Reader Agent is running for the database.</span></span> <span data-ttu-id="078b8-117">Par défaut, cet agent s'exécute en permanence.</span><span class="sxs-lookup"><span data-stu-id="078b8-117">By default, the agent runs continuously.</span></span>  
  
2.  <span data-ttu-id="078b8-118">Arrêtez l'activité des utilisateurs sur les tables publiées.</span><span class="sxs-lookup"><span data-stu-id="078b8-118">Stop user activity on published tables.</span></span>  
  
3.  <span data-ttu-id="078b8-119">Laissez à l'Agent de lecture du journal le temps de copier des transactions vers la base de données de distribution, puis arrêtez-le.</span><span class="sxs-lookup"><span data-stu-id="078b8-119">Allow time for the Log Reader Agent to copy transactions to the distribution database, and then stop the agent.</span></span>  
  
4.  <span data-ttu-id="078b8-120">Exécutez [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql) pour vérifier que toutes les transactions ont été traitées.</span><span class="sxs-lookup"><span data-stu-id="078b8-120">Execute [sp_replcmds](/sql/relational-databases/system-stored-procedures/sp-replcmds-transact-sql) to verify that all transactions have been processed.</span></span> <span data-ttu-id="078b8-121">Le jeu de résultats de cette procédure doit être vide.</span><span class="sxs-lookup"><span data-stu-id="078b8-121">The result set from this procedure should be empty.</span></span>  
  
5.  <span data-ttu-id="078b8-122">Exécutez [sp_replflush](/sql/relational-databases/system-stored-procedures/sp-replflush-transact-sql) pour fermer la connexion à partir de sp_replcmds.</span><span class="sxs-lookup"><span data-stu-id="078b8-122">Execute [sp_replflush](/sql/relational-databases/system-stored-procedures/sp-replflush-transact-sql) to close the connection from sp_replcmds.</span></span>  
  
6.  <span data-ttu-id="078b8-123">Effectuez la mise à niveau de serveur vers [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="078b8-123">Perform the server upgrade to [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
7.  <span data-ttu-id="078b8-124">Redémarrez l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et l'Agent de lecture du journal s'ils ne démarrent pas automatiquement après la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="078b8-124">Restart [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent and the Log Reader Agent if they do not start automatically after the upgrade.</span></span>  
  
## <a name="run-agents-for-merge-replication-after-upgrade"></a><span data-ttu-id="078b8-125">Exécution des agents de réplication de fusion après la mise à niveau</span><span class="sxs-lookup"><span data-stu-id="078b8-125">Run Agents for Merge Replication After Upgrade</span></span>  
 <span data-ttu-id="078b8-126">Après la mise à niveau, exécutez l'Agent d'instantané pour chaque publication de fusion et l'Agent de fusion pour chaque abonnement afin de mettre à jour les métadonnées de réplication.</span><span class="sxs-lookup"><span data-stu-id="078b8-126">After upgrade, run the Snapshot Agent for each merge publication and the Merge Agent for each subscription to update replication metadata.</span></span> <span data-ttu-id="078b8-127">Vous n'avez pas à appliquer le nouvel instantané, car il n'est pas nécessaire pour réinitialiser les abonnements.</span><span class="sxs-lookup"><span data-stu-id="078b8-127">You do not have to apply the new snapshot, because it is not necessary to reinitialize subscriptions.</span></span> <span data-ttu-id="078b8-128">Les métadonnées d'abonnement sont mises à jour lors de la première exécution de l'Agent de fusion après la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="078b8-128">Subscription metadata is updated the first time the Merge Agent is run after upgrade.</span></span> <span data-ttu-id="078b8-129">Ceci signifie que la base de données d'abonnement peut rester en ligne et active durant la mise à niveau du serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="078b8-129">This means that the subscription database can remain online and active during the Publisher upgrade.</span></span>  
  
 <span data-ttu-id="078b8-130">La réplication de fusion stocke les métadonnées de publication et d'abonnement dans un certain nombre de tables système des bases de données de publication et d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="078b8-130">Merge replication stores publication and subscription metadata in a number of system tables in the publication and subscription databases.</span></span> <span data-ttu-id="078b8-131">L'Agent d'instantané met à jour les métadonnées de publication et l'Agent de fusion met à jour les métadonnées d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="078b8-131">Running the Snapshot Agent updates publication metadata and running the Merge Agent updates subscription metadata.</span></span> <span data-ttu-id="078b8-132">Il faut uniquement générer un instantané de publication.</span><span class="sxs-lookup"><span data-stu-id="078b8-132">It is only required to generate a publication snapshot.</span></span> <span data-ttu-id="078b8-133">Si une publication de fusion utilise des filtres paramétrés, chaque partition a également un instantané.</span><span class="sxs-lookup"><span data-stu-id="078b8-133">If a merge publication uses parameterized filters, each partition also has a snapshot.</span></span> <span data-ttu-id="078b8-134">Il n'est pas nécessaire de mettre à jour ces instantanés partitionnés.</span><span class="sxs-lookup"><span data-stu-id="078b8-134">It is not necessary to update these partitioned snapshots.</span></span>  
  
 <span data-ttu-id="078b8-135">Exécutez les agents à partir de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], du moniteur de réplication ou de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="078b8-135">Run the agents from [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], Replication Monitor, or from the command line.</span></span> <span data-ttu-id="078b8-136">Pour plus d'informations sur l'exécution de l'Agent d'instantané, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="078b8-136">For more information about running the Snapshot Agent, see the following topics:</span></span>  
  
-   [<span data-ttu-id="078b8-137">Créer et appliquer l'instantané initial</span><span class="sxs-lookup"><span data-stu-id="078b8-137">Create and Apply the Initial Snapshot</span></span>](../../../2014/relational-databases/replication/create-and-apply-the-initial-snapshot.md)  
  
-   [<span data-ttu-id="078b8-138">Démarrer et arrêter un Agent de réplication &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="078b8-138">Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;</span></span>](../../relational-databases/replication/agents/start-and-stop-a-replication-agent-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="078b8-139">Créer et appliquer l'instantané initial</span><span class="sxs-lookup"><span data-stu-id="078b8-139">Create and Apply the Initial Snapshot</span></span>](../../../2014/relational-databases/replication/create-and-apply-the-initial-snapshot.md)  
  
-   [<span data-ttu-id="078b8-140">Concepts des exécutables de l'agent de réplication</span><span class="sxs-lookup"><span data-stu-id="078b8-140">Replication Agent Executables Concepts</span></span>](../../../2014/relational-databases/replication/concepts/replication-agent-executables-concepts.md)  
  
 <span data-ttu-id="078b8-141">Pour plus d'informations sur l'exécution de l'Agent de fusion, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="078b8-141">For more information about running the Merge Agent, see the following topics:</span></span>  
  
-   [<span data-ttu-id="078b8-142">Synchroniser un abonnement par extraction (pull)</span><span class="sxs-lookup"><span data-stu-id="078b8-142">Synchronize a Pull Subscription</span></span>](../../../2014/relational-databases/replication/synchronize-a-pull-subscription.md)  
  
-   [<span data-ttu-id="078b8-143">Synchroniser un abonnement par émission (push)</span><span class="sxs-lookup"><span data-stu-id="078b8-143">Synchronize a Push Subscription</span></span>](../../../2014/relational-databases/replication/synchronize-a-push-subscription.md)  
  
 <span data-ttu-id="078b8-144">Après avoir mis à niveau [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dans une topologie qui utilise la réplication de fusion, modifiez le niveau de compatibilité de toutes les publications si vous voulez utiliser les nouvelles fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="078b8-144">After upgrading [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] in a topology that uses merge replication, change the publication compatibility level of any publications if you want to use new features.</span></span>  
  
## <a name="upgrading-to-standard-workgroup-or-express-editions"></a><span data-ttu-id="078b8-145">Mise à niveau vers les éditions Standard, Workgroup ou Express</span><span class="sxs-lookup"><span data-stu-id="078b8-145">Upgrading to Standard, Workgroup, or Express Editions</span></span>  
 <span data-ttu-id="078b8-146">Avant la mise à niveau d’une édition de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] vers une autre, vérifiez que les fonctionnalités que vous utilisez actuellement sont prises en charge dans l’édition vers laquelle vous mettez à niveau.</span><span class="sxs-lookup"><span data-stu-id="078b8-146">Before upgrading from one edition of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] to another, verify that the functionality you are currently using is supported in the edition to which you are upgrading.</span></span> <span data-ttu-id="078b8-147">Pour plus d’informations, consultez la section sur la réplication dans [fonctionnalités prises en charge par les éditions de SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="078b8-147">For more information, see the section on Replication in [Features Supported by the Editions of SQL Server 2014](../../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
## <a name="web-synchronization-for-merge-replication"></a><span data-ttu-id="078b8-148">Synchronisation Web pour la réplication de fusion</span><span class="sxs-lookup"><span data-stu-id="078b8-148">Web Synchronization for Merge Replication</span></span>  
 <span data-ttu-id="078b8-149">L'option de synchronisation Web pour la réplication de fusion requiert la copie de l'Écouteur de réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (replisapi.dll) dans le répertoire virtuel sur le serveur IIS (Internet Information Services) utilisé pour la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="078b8-149">The Web synchronization option for merge replication requires that the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener (replisapi.dll) be copied to the virtual directory on the Internet Information Services (IIS) server used for synchronization.</span></span> <span data-ttu-id="078b8-150">Lorsque vous configurez la synchronisation Web, le fichier est copié dans le répertoire virtuel par l'Assistant Configuration de la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="078b8-150">When you configure Web synchronization, the file is copied to the virtual directory by the Configure Web Synchronization Wizard.</span></span> <span data-ttu-id="078b8-151">Si vous mettez à niveau les composants [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installés sur le serveur IIS, vous devez manuellement copier replisapi.dll depuis le répertoire COM vers le répertoire virtuel sur le serveur IIS.</span><span class="sxs-lookup"><span data-stu-id="078b8-151">If you upgrade the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] components installed on the IIS server, you must manually copy replisapi.dll from the COM directory to the virtual directory on the IIS server.</span></span> <span data-ttu-id="078b8-152">Pour plus d’informations sur la synchronisation web, consultez [Configuration de la synchronisation web](../../../2014/relational-databases/replication/configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="078b8-152">For more information about configuring Web synchronization, see [Configure Web Synchronization](../../../2014/relational-databases/replication/configure-web-synchronization.md).</span></span>  
  
## <a name="restoring-a-replicated-database-from-an-earlier-version"></a><span data-ttu-id="078b8-153">Restauration d'une base de données répliquée à partir d'une version antérieure</span><span class="sxs-lookup"><span data-stu-id="078b8-153">Restoring a Replicated Database from an Earlier Version</span></span>  
 <span data-ttu-id="078b8-154">Pour vous assurer que les paramètres de réplication sont conservés lorsque vous restaurez la sauvegarde d'une base de données répliquée à partir d'une version précédente : effectuez la restauration vers un serveur et une base de données du même nom que le serveur et la base de données à l'origine de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="078b8-154">To ensure replication settings are retained when restoring a backup of a replicated database from a previous version: restore to a server and database with the same names as the server and database at which the backup was taken.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="078b8-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="078b8-155">See Also</span></span>  
 <span data-ttu-id="078b8-156">[FAQ sur l’administration de la réplication](../../relational-databases/replication/administration/frequently-asked-questions-for-replication-administrators.md) </span><span class="sxs-lookup"><span data-stu-id="078b8-156">[Replication Administration FAQ](../../relational-databases/replication/administration/frequently-asked-questions-for-replication-administrators.md) </span></span>  
 <span data-ttu-id="078b8-157">[Compatibilité descendante de la réplication](../../../2014/relational-databases/replication/replication-backward-compatibility.md) </span><span class="sxs-lookup"><span data-stu-id="078b8-157">[Replication Backward Compatibility](../../../2014/relational-databases/replication/replication-backward-compatibility.md) </span></span>  
 <span data-ttu-id="078b8-158">[Mises à niveau de la version et de l'édition prises en charge](../../database-engine/install-windows/supported-version-and-edition-upgrades.md) </span><span class="sxs-lookup"><span data-stu-id="078b8-158">[Supported Version and Edition Upgrades](../../database-engine/install-windows/supported-version-and-edition-upgrades.md) </span></span>  
 [<span data-ttu-id="078b8-159">Mettre à niveau vers SQL Server 2014</span><span class="sxs-lookup"><span data-stu-id="078b8-159">Upgrade to SQL Server 2014</span></span>](upgrade-sql-server.md)  
  
  
