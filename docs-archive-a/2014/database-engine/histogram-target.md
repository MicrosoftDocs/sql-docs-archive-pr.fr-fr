---
title: Cible d’histogramme | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- bucketing target [SQL Server extended events]
- event bucketing target
- targets [SQL Server extended events], bucketing
ms.assetid: 2ea39141-7eb0-4c74-abf8-114c2c106a19
author: mashamsft
ms.author: mathoma
ms.openlocfilehash: acb124ef949849561a6bca0ba4016b40c1343384
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87700205"
---
# <a name="histogram-target"></a><span data-ttu-id="1a0d1-102">Cible d'histogramme</span><span class="sxs-lookup"><span data-stu-id="1a0d1-102">Histogram Target</span></span>
  <span data-ttu-id="1a0d1-103">Une cible d'histogramme regroupe les occurrences d'un type d'événement spécifique en fonction de données d'événement.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-103">The histogram target groups occurrences of a specific event type based on event data.</span></span> <span data-ttu-id="1a0d1-104">Les regroupements d'événements sont comptabilisés en fonction d'une colonne d'événement ou d'une action spécifiée.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-104">The groupings of events are counted based on a specified event column or action.</span></span> <span data-ttu-id="1a0d1-105">Vous pouvez utiliser la cible d'histogramme pour résoudre les problèmes de performance.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-105">You can use the histogram target to troubleshoot performance issues.</span></span> <span data-ttu-id="1a0d1-106">En identifiant les événements qui se produisent le plus souvent, vous pouvez trouver des « zones réactives » qui indiquent la cause probable d'un problème de performance.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-106">By identifying which events are occurring most frequently, you can find "hotspots" that indicate a potential cause of a performance problem.</span></span>  
  
 <span data-ttu-id="1a0d1-107">Le tableau suivant décrit les options pouvant être utilisées pour configurer la cible d'histogramme.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-107">The following table describes the options that can be used to configure the histogram target.</span></span>  
  
|<span data-ttu-id="1a0d1-108">Option</span><span class="sxs-lookup"><span data-stu-id="1a0d1-108">Option</span></span>|<span data-ttu-id="1a0d1-109">Valeurs autorisées</span><span class="sxs-lookup"><span data-stu-id="1a0d1-109">Allowed values</span></span>|<span data-ttu-id="1a0d1-110">Description</span><span class="sxs-lookup"><span data-stu-id="1a0d1-110">Description</span></span>|  
|------------|--------------------|-----------------|  
|<span data-ttu-id="1a0d1-111">slots</span><span class="sxs-lookup"><span data-stu-id="1a0d1-111">slots</span></span>|<span data-ttu-id="1a0d1-112">Toute valeur entière.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-112">Any integer value.</span></span> <span data-ttu-id="1a0d1-113">Cette valeur est facultative.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-113">This value is optional.</span></span>|<span data-ttu-id="1a0d1-114">Valeur spécifiée par l'utilisateur qui indique le nombre maximal de regroupements à conserver.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-114">A user-specified value indicating the maximum number of groupings to retain.</span></span> <span data-ttu-id="1a0d1-115">Lorsque cette valeur est atteinte, les nouveaux événements qui n'appartiennent pas aux groupes existants sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-115">When this value is reached, new events that do not belong to the existing groups are ignored.</span></span><br /><br /> <span data-ttu-id="1a0d1-116">Notez que pour améliorer les performances, le numéro d'emplacement est arrondi à la puissance suivante de 2.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-116">Note that to improve performance, the slot number is rounded up to the next power of 2.</span></span>|  
|<span data-ttu-id="1a0d1-117">filtering_event_name</span><span class="sxs-lookup"><span data-stu-id="1a0d1-117">filtering_event_name</span></span>|<span data-ttu-id="1a0d1-118">Tout événement présent dans la session Événements étendus.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-118">Any event present in the Extended Events session.</span></span> <span data-ttu-id="1a0d1-119">Cette valeur est facultative.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-119">This value is optional.</span></span>|<span data-ttu-id="1a0d1-120">Une valeur spécifiée par l'utilisateur qui permet d'identifier une classe d'événements.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-120">A user-specified value that is used to identify a class of events.</span></span> <span data-ttu-id="1a0d1-121">Seules les instances de l'événement spécifié sont placées dans un compartiment.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-121">Only instances of the specified event are bucketed.</span></span> <span data-ttu-id="1a0d1-122">Tous les autres événements sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-122">All other events are ignored.</span></span><br /><br /> <span data-ttu-id="1a0d1-123">Si vous spécifiez cette valeur, vous devez utiliser le format *nom_package*.*nom_événement*, par exemple `'sqlserver.checkpoint_end'`.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-123">If you specify this value, you must use the format: *package_name*.*event_name*, for example `'sqlserver.checkpoint_end'`.</span></span> <span data-ttu-id="1a0d1-124">Vous pouvez identifier le nom du package à l'aide de la requête suivante :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-124">You can identify the package name by using the following query:</span></span><br /><br /> <span data-ttu-id="1a0d1-125">Sélectionnez p.name, se. event_name</span><span class="sxs-lookup"><span data-stu-id="1a0d1-125">SELECT p.name, se.event_name</span></span><br /><span data-ttu-id="1a0d1-126">À partir de sys. dm_xe_session_events se</span><span class="sxs-lookup"><span data-stu-id="1a0d1-126">FROM sys.dm_xe_session_events se</span></span><br /><span data-ttu-id="1a0d1-127">JOINDRE sys. dm_xe_packages p</span><span class="sxs-lookup"><span data-stu-id="1a0d1-127">JOIN sys.dm_xe_packages p</span></span><br /><span data-ttu-id="1a0d1-128">SUR se_event_package_guid = p. Guid</span><span class="sxs-lookup"><span data-stu-id="1a0d1-128">ON se_event_package_guid = p.guid</span></span><br /><span data-ttu-id="1a0d1-129">CLASSEMENT par p.name, se. event_name</span><span class="sxs-lookup"><span data-stu-id="1a0d1-129">ORDER BY p.name, se.event_name</span></span><br /><br /> <br /><br /> <span data-ttu-id="1a0d1-130">Si vous ne spécifiez pas la valeur filtering_event_name, source_type doit avoir la valeur 1 (valeur par défaut).</span><span class="sxs-lookup"><span data-stu-id="1a0d1-130">If you do not specify the filtering_event_name value, source_type must be set to 1 (the default).</span></span>|  
|<span data-ttu-id="1a0d1-131">source_type</span><span class="sxs-lookup"><span data-stu-id="1a0d1-131">source_type</span></span>|<span data-ttu-id="1a0d1-132">Type d'objet sur lequel le compartiment est basé.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-132">The type of object that the bucket is based on.</span></span> <span data-ttu-id="1a0d1-133">Cette valeur est facultative et a la valeur par défaut 1 si elle n'est pas spécifiée.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-133">This value is optional and if not specified has a default value of 1.</span></span>|<span data-ttu-id="1a0d1-134">Peut avoir l'une des valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-134">Can have one of the following values:</span></span><br /><br /> <span data-ttu-id="1a0d1-135">0 pour un événement</span><span class="sxs-lookup"><span data-stu-id="1a0d1-135">0 for an event</span></span><br /><br /> <span data-ttu-id="1a0d1-136">1 pour une action</span><span class="sxs-lookup"><span data-stu-id="1a0d1-136">1 for an action</span></span>|  
|<span data-ttu-id="1a0d1-137">source</span><span class="sxs-lookup"><span data-stu-id="1a0d1-137">source</span></span>|<span data-ttu-id="1a0d1-138">Colonne d'événement ou nom d'action.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-138">Event column or action name.</span></span>|<span data-ttu-id="1a0d1-139">La colonne d'événement ou le nom d'action utilisé(e) comme source de données.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-139">The event column or action name that is used as the data source.</span></span><br /><br /> <span data-ttu-id="1a0d1-140">Lorsque vous spécifiez une colonne d'événement pour la source, vous devez spécifier une colonne à partir de l'événement qui est utilisé pour la valeur filtering_event_name.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-140">When you specify an event column for source, you must specify a column from the event that is used for the filtering_event_name value.</span></span> <span data-ttu-id="1a0d1-141">Vous pouvez identifier les colonnes possibles à l'aide de la requête suivante :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-141">You can identify the potential columns by using the following query:</span></span><br /><br /> <span data-ttu-id="1a0d1-142">Sélectionnez nom dans sys. dm_xe_object_columns</span><span class="sxs-lookup"><span data-stu-id="1a0d1-142">SELECT name FROM sys.dm_xe_object_columns</span></span><br /><span data-ttu-id="1a0d1-143">OÙ object_name = ' \<eventname> '</span><span class="sxs-lookup"><span data-stu-id="1a0d1-143">WHERE object_name = '\<eventname>'</span></span><br /><span data-ttu-id="1a0d1-144">ET column_type ! = 'ReadOnly'</span><span class="sxs-lookup"><span data-stu-id="1a0d1-144">AND column_type != 'readonly'</span></span><br /><br /> <span data-ttu-id="1a0d1-145">Lorsque vous spécifiez une colonne d'événement pour la source, il n'est pas nécessaire d'inclure le nom du package dans la valeur de la source.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-145">When you specify an event column for source, you do not have to include the package name in the source value.</span></span><br /><br /> <span data-ttu-id="1a0d1-146">Lorsque vous spécifiez un nom d'action pour la source, vous devez utiliser l'une des actions configurées pour la collection dans la session d'événements pour laquelle cette cible est utilisée.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-146">When you specify an action name for source, you must use one of the actions that is configured for collection in the event session for which this target is being used.</span></span> <span data-ttu-id="1a0d1-147">Pour trouver les valeurs possibles pour le nom d'action, vous pouvez interroger la colonne action_name de la vue sys.dm_xe_sesssion_event_actions.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-147">To find potential values for the action name, you can query the action_name column of the sys.dm_xe_sesssion_event_actions view.</span></span><br /><br /> <span data-ttu-id="1a0d1-148">Si vous utilisez un nom d’action comme source de données, vous devez spécifier la valeur de la source en utilisant le format *nom_package*.*nom_action*.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-148">If you are using an action name as the data source, you must specify the source value by using the format: *package_name*.*action_name*.</span></span>|  
  
 <span data-ttu-id="1a0d1-149">L'exemple suivant montre globalement comment la cible d'histogramme collecte les données.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-149">The following example illustrates at a high level how the histogram target collects data.</span></span> <span data-ttu-id="1a0d1-150">Dans cet exemple, vous utilisez la cible d'histogramme pour comptabiliser le nombre d'attentes de chaque type d'attente.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-150">In this example, you want to use the histogram target to count how many waits of each wait type occurred.</span></span> <span data-ttu-id="1a0d1-151">Pour ce faire, spécifiez les options suivantes lorsque vous définissez la cible d'histogramme :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-151">To do this, you would specify the following options when you define the histogram target:</span></span>  
  
-   <span data-ttu-id="1a0d1-152">filtering_event_name = 'wait_info'</span><span class="sxs-lookup"><span data-stu-id="1a0d1-152">filtering_event_name = 'wait_info'</span></span>  
  
-   <span data-ttu-id="1a0d1-153">source = 'wait_type'</span><span class="sxs-lookup"><span data-stu-id="1a0d1-153">source = 'wait_type'</span></span>  
  
-   <span data-ttu-id="1a0d1-154">source_type = 0 (car wait_type est une colonne d'événement)</span><span class="sxs-lookup"><span data-stu-id="1a0d1-154">source_type = 0 (because wait_type is an event column)</span></span>  
  
 <span data-ttu-id="1a0d1-155">Dans ce scénario d'exemple, les données suivantes sont enregistrées pour la source wait_type.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-155">In the example scenario, the following data is recorded for the wait_type source.</span></span>  
  
|<span data-ttu-id="1a0d1-156">Nom de l'événement de filtrage</span><span class="sxs-lookup"><span data-stu-id="1a0d1-156">Filtering event name</span></span>|<span data-ttu-id="1a0d1-157">Valeur de la colonne source</span><span class="sxs-lookup"><span data-stu-id="1a0d1-157">Source column value</span></span>|  
|--------------------------|-------------------------|  
|<span data-ttu-id="1a0d1-158">wait_info</span><span class="sxs-lookup"><span data-stu-id="1a0d1-158">wait_info</span></span>|<span data-ttu-id="1a0d1-159">file_io</span><span class="sxs-lookup"><span data-stu-id="1a0d1-159">file_io</span></span>|  
|<span data-ttu-id="1a0d1-160">wait_info</span><span class="sxs-lookup"><span data-stu-id="1a0d1-160">wait_info</span></span>|<span data-ttu-id="1a0d1-161">file_io</span><span class="sxs-lookup"><span data-stu-id="1a0d1-161">file_io</span></span>|  
|<span data-ttu-id="1a0d1-162">wait_info</span><span class="sxs-lookup"><span data-stu-id="1a0d1-162">wait_info</span></span>|<span data-ttu-id="1a0d1-163">réseau</span><span class="sxs-lookup"><span data-stu-id="1a0d1-163">network</span></span>|  
|<span data-ttu-id="1a0d1-164">wait_info</span><span class="sxs-lookup"><span data-stu-id="1a0d1-164">wait_info</span></span>|<span data-ttu-id="1a0d1-165">réseau</span><span class="sxs-lookup"><span data-stu-id="1a0d1-165">network</span></span>|  
|<span data-ttu-id="1a0d1-166">wait_info</span><span class="sxs-lookup"><span data-stu-id="1a0d1-166">wait_info</span></span>|<span data-ttu-id="1a0d1-167">sleep</span><span class="sxs-lookup"><span data-stu-id="1a0d1-167">sleep</span></span>|  
  
 <span data-ttu-id="1a0d1-168">Les valeurs de type d'attente doivent être catégorisées dans trois emplacements, avec les valeurs et nombres d'emplacements suivants :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-168">The wait type values would be categorized into three slots, with the following values and slot counts:</span></span>  
  
|<span data-ttu-id="1a0d1-169">Valeur</span><span class="sxs-lookup"><span data-stu-id="1a0d1-169">Value</span></span>|<span data-ttu-id="1a0d1-170">Nombre d'emplacements</span><span class="sxs-lookup"><span data-stu-id="1a0d1-170">Slot count</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="1a0d1-171">file_io</span><span class="sxs-lookup"><span data-stu-id="1a0d1-171">file_io</span></span>|<span data-ttu-id="1a0d1-172">2</span><span class="sxs-lookup"><span data-stu-id="1a0d1-172">2</span></span>|  
|<span data-ttu-id="1a0d1-173">réseau</span><span class="sxs-lookup"><span data-stu-id="1a0d1-173">network</span></span>|<span data-ttu-id="1a0d1-174">2</span><span class="sxs-lookup"><span data-stu-id="1a0d1-174">2</span></span>|  
|<span data-ttu-id="1a0d1-175">sleep</span><span class="sxs-lookup"><span data-stu-id="1a0d1-175">sleep</span></span>|<span data-ttu-id="1a0d1-176">1</span><span class="sxs-lookup"><span data-stu-id="1a0d1-176">1</span></span>|  
  
 <span data-ttu-id="1a0d1-177">La cible d'histogramme conserve seulement les données d'événement pour la source spécifiée.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-177">The histogram target only retains event data for the specified source.</span></span> <span data-ttu-id="1a0d1-178">Dans certains cas, les données d'événement peuvent être trop volumineuses pour être conservées complètement, auxquels cas les données sont tronquées.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-178">In some cases the event data may be too large to retain completely, in which case the data is truncated.</span></span> <span data-ttu-id="1a0d1-179">Lorsque des données d'événement sont tronquées, le nombre d'octets est enregistré et affiché comme sortie XML.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-179">When event data is truncated, the number of bytes is recorded and displayed as XML output.</span></span>  
  
## <a name="adding-the-target-to-a-session"></a><span data-ttu-id="1a0d1-180">Ajout de la cible à une session</span><span class="sxs-lookup"><span data-stu-id="1a0d1-180">Adding the Target to a Session</span></span>  
 <span data-ttu-id="1a0d1-181">Pour ajouter la cible d'histogramme à une session Événements étendus lorsque vous créez ou modifiez une session d'événements, vous devez inclure l'une des instructions suivantes, selon le type de cible désiré :</span><span class="sxs-lookup"><span data-stu-id="1a0d1-181">To add the histogram target to an Extended Events session, you must include either of the following statements when you create or alter an event session, depending on the desired target type:</span></span>  
  
```  
ADD TARGET package0.histogram  
```  
  
 <span data-ttu-id="1a0d1-182">Vous pouvez utiliser l'instruction SET pour définir les différentes options.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-182">You can use the SET statement to set the various options.</span></span> <span data-ttu-id="1a0d1-183">L’exemple suivant montre l’ajout de la cible d’histogramme, dans laquelle les données de l’événement sqlserver.checkpoint_end sont recueillies.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-183">The following example shows the addition of the histogram target, where data for the sqlserver.checkpoint_end event is collected.</span></span>  
  
```  
ADD TARGET package0.histogram  
(SET slots = 32, filtering_event_name = 'sqlserver.checkpoint_end', source_type = 0, source = 'database_id')  
```  
  
 <span data-ttu-id="1a0d1-184">Pour plus d’informations, consultez [Trouver les objets comportant le plus de verrous](../relational-databases/extended-events/find-the-objects-that-have-the-most-locks-taken-on-them.md)et [Surveiller l’activité système à l’aide d’événements étendus](../relational-databases/extended-events/monitor-system-activity-using-extended-events.md).</span><span class="sxs-lookup"><span data-stu-id="1a0d1-184">For more information, see [Find the Objects That Have the Most Locks Taken on Them](../relational-databases/extended-events/find-the-objects-that-have-the-most-locks-taken-on-them.md), and [Monitor System Activity Using Extended Events](../relational-databases/extended-events/monitor-system-activity-using-extended-events.md).</span></span>  
  
## <a name="reviewing-the-target-output"></a><span data-ttu-id="1a0d1-185">Vérification de la sortie cible</span><span class="sxs-lookup"><span data-stu-id="1a0d1-185">Reviewing the Target Output</span></span>  
 <span data-ttu-id="1a0d1-186">La cible d'histogramme applique en série les données à une procédure ou un programme appelant au format XML.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-186">The histogram target serializes data to a calling program or procedure in XML format.</span></span> <span data-ttu-id="1a0d1-187">La sortie cible n'est conforme à aucun schéma.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-187">The target output does not conform to any schema.</span></span>  
  
 <span data-ttu-id="1a0d1-188">Pour vérifier la sortie de la cible d’histogramme, vous pouvez utiliser la requête suivante, en remplaçant *nom_session* par le nom de la session d’événements.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-188">To review the output from the histogram target, you can use the following query, replacing *session_name* with the name of the event session.</span></span>  
  
```  
SELECT name, target_name, CAST(xet.target_data AS xml)  
FROM sys.dm_xe_session_targets AS xet  
JOIN sys.dm_xe_sessions AS xe  
   ON (xe.address = xet.event_session_address)  
WHERE xe.name = 'session_name'  
```  
  
 <span data-ttu-id="1a0d1-189">L'exemple suivant illustre le format de sortie de la cible d'histogramme.</span><span class="sxs-lookup"><span data-stu-id="1a0d1-189">The following example illustrates histogram target output format.</span></span>  
  
```  
<Slots truncated = "0" buckets=[count]>  
    <Slot count=[count] trunc=[truncated bytes]>  
        <value>  
        </value>  
    </Slot>  
</Slots>  
```  
  
## <a name="see-also"></a><span data-ttu-id="1a0d1-190">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1a0d1-190">See Also</span></span>  
 <span data-ttu-id="1a0d1-191">[Cibles des Événements étendus SQL Server](../../2014/database-engine/sql-server-extended-events-targets.md) </span><span class="sxs-lookup"><span data-stu-id="1a0d1-191">[SQL Server Extended Events Targets](../../2014/database-engine/sql-server-extended-events-targets.md) </span></span>  
 <span data-ttu-id="1a0d1-192">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="1a0d1-192">[sys.dm_xe_session_targets &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-xe-session-targets-transact-sql) </span></span>  
 <span data-ttu-id="1a0d1-193">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="1a0d1-193">[CREATE EVENT SESSION &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-event-session-transact-sql) </span></span>  
 [<span data-ttu-id="1a0d1-194">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="1a0d1-194">ALTER EVENT SESSION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-event-session-transact-sql)  
  
  
