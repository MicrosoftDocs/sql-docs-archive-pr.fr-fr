---
title: Analysis Services avec les groupes de disponibilité Always On | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: 14d16bfd-228c-4870-b463-a283facda965
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 9ea0c7f30fd8f431f70284122df7e2a036658f4e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87601126"
---
# <a name="analysis-services-with-always-on-availability-groups"></a><span data-ttu-id="a01b8-102">Analysis Services avec les groupes de disponibilité Always On</span><span class="sxs-lookup"><span data-stu-id="a01b8-102">Analysis Services with Always On Availability Groups</span></span>
  <span data-ttu-id="a01b8-103">Un groupe de disponibilité AlwaysOn est une collection prédéfinie de bases de données relationnelles SQL Server qui basculent ensemble lorsque les conditions déclenchent un basculement dans l'une des bases de données, redirigeant les requêtes vers une base de données mise en miroir sur une autre instance dans le même groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-103">An AlwaysOn availability group is a predefined collection of SQL Server relational databases that failover together when conditions trigger a failover in any one database, redirecting requests to a mirrored database on another instance in the same availability group.</span></span> <span data-ttu-id="a01b8-104">Si vous utilisez des groupes de disponibilité pour votre solution haute disponibilité, vous pouvez utiliser une base de données de ce groupe comme source de données dans une solution Analysis Services tabulaire ou multidimensionnelle.</span><span class="sxs-lookup"><span data-stu-id="a01b8-104">If you are using availability groups as your high availability solution, you can use a database in that group as a data source in an Analysis Services tabular or multidimensional solution.</span></span> <span data-ttu-id="a01b8-105">Toutes les opérations d'Analysis Services s'exécutent comme prévu lorsque vous utilisez une base de données de disponibilité : le traitement ou l'importation des données, l'interrogation directe des données relationnelles (à l'aide du stockage ROLAP ou du mode DirectQuery) et l'écriture différée.</span><span class="sxs-lookup"><span data-stu-id="a01b8-105">All of the following Analysis Services operations work as expected when using an availability database: processing or importing data, querying relational data directly (using ROLAP storage or DirectQuery mode), and writeback.</span></span>  
  
 <span data-ttu-id="a01b8-106">Le traitement et l'exécution des requêtes sont des charges de travail en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="a01b8-106">Processing and querying are read-only workloads.</span></span> <span data-ttu-id="a01b8-107">Vous pouvez améliorer les performances en déchargeant ces charges de travail vers un réplica secondaire lisible.</span><span class="sxs-lookup"><span data-stu-id="a01b8-107">You can improve performance by offloading these workloads to a readable secondary replica.</span></span> <span data-ttu-id="a01b8-108">Une configuration supplémentaire est requise pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="a01b8-108">Additional configuration is required for this scenario.</span></span> <span data-ttu-id="a01b8-109">Utilisez la liste de contrôle de cette rubrique pour vous assurer que vous suivez toutes les étapes.</span><span class="sxs-lookup"><span data-stu-id="a01b8-109">Use the checklist in this topic to ensure you follow all the steps.</span></span>  
  
  
##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="a01b8-110">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="a01b8-110">Prerequisites</span></span>  
 <span data-ttu-id="a01b8-111">Vous devez avoir compte de connexion SQL Server sur tous les réplicas.</span><span class="sxs-lookup"><span data-stu-id="a01b8-111">You must have a SQL Server login on all replicas.</span></span> <span data-ttu-id="a01b8-112">Vous devez être un **sysadmin** pour configurer des groupes de disponibilité, des écouteurs et des bases de données, mais les utilisateurs n’ont besoin que d’autorisations **db_datareader** pour accéder à la base de données d’un client Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="a01b8-112">You must be a **sysadmin** to configure availability groups, listeners, and databases, but users only need **db_datareader** permissions to access the database from an Analysis Services client.</span></span>  
  
 <span data-ttu-id="a01b8-113">Utilisez un fournisseur de données qui prend en charge la version 7.4 du protocole TDS (Tabular Data Stream) ou une version plus récente, telle que SQL Server Native Client 11.0 ou le Fournisseur de données pour SQL Server dans .NET Framework 4.02.</span><span class="sxs-lookup"><span data-stu-id="a01b8-113">Use a data provider that supports the tabular data stream (TDS) protocol version 7.4 or newer, such as the SQL Server Native Client 11.0 or the Data Provider for SQL Server in .NET Framework 4.02.</span></span>  
  
 <span data-ttu-id="a01b8-114">**(Pour les charges de travail en lecture seule)**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-114">**(For read-only workloads)**.</span></span> <span data-ttu-id="a01b8-115">Le rôle de réplica secondaire doit être configuré pour les connexions en lecture seule, le groupe de disponibilité doit avoir une liste de routage et la connexion dans la source de données Analysis Services doit spécifier l'écouteur du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-115">The secondary replica role must be configured for read-only connections, the availability group must have a routing list, and the connection in the Analysis Services data source must specify the availability group listener.</span></span> <span data-ttu-id="a01b8-116">Les instructions sont fournies dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="a01b8-116">Instructions are provided in this topic.</span></span>  
  
##  <a name="checklist-use-a-secondary-replica-for-read-only-operations"></a><a name="bkmk_UseSecondary"></a> <span data-ttu-id="a01b8-117">Liste de contrôle : Utiliser un réplica secondaire pour les opérations en lecture seule</span><span class="sxs-lookup"><span data-stu-id="a01b8-117">Checklist: Use a secondary replica for read-only operations</span></span>  
 <span data-ttu-id="a01b8-118">À moins que votre solution Analysis Services inclue l'écriture différée, vous pouvez configurer une connexion de source de données pour utiliser un réplica secondaire lisible.</span><span class="sxs-lookup"><span data-stu-id="a01b8-118">Unless your Analysis Services solution includes writeback, you can configure a data source connection to use a readable secondary replica.</span></span> <span data-ttu-id="a01b8-119">Si votre connexion réseau est rapide, le réplica secondaire a une latence de données très faible et fournit des données pratiquement identiques au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-119">If you have a fast network connection, the secondary replica has very low data latency, providing nearly identical data as the primary replica.</span></span> <span data-ttu-id="a01b8-120">En utilisant le réplica secondaire pour les opérations Analysis Services, vous pouvez réduire les conflits de lecture-écriture sur le réplica principal et optimiser l'utilisation des réplicas secondaires dans votre groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-120">By using the secondary replica for Analysis Services operations, you can reduce read-write contention on the primary replica and get better utilization of secondary replicas in your availability group.</span></span>  
  
 <span data-ttu-id="a01b8-121">Par défaut, l'accès en lecture/écriture et d'intention de lecture sont autorisés sur le réplica principal et aucune connexion n'est autorisée sur les réplicas secondaires.</span><span class="sxs-lookup"><span data-stu-id="a01b8-121">By default, both read-write and read-intent access are allowed to the primary replica and no connections are allowed to secondary replicas.</span></span> <span data-ttu-id="a01b8-122">Une configuration supplémentaire est requise pour configurer une connexion cliente en lecture seule sur un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-122">Additional configuration is required to set up a read-only client connection to a secondary replica.</span></span> <span data-ttu-id="a01b8-123">La configuration requiert la configuration de propriétés sur le réplica et l'exécution d'un script T-SQL qui définit une liste de routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="a01b8-123">Configuration requires setting properties on the secondary replica and running a T-SQL script that defines a read-only routing list.</span></span> <span data-ttu-id="a01b8-124">Utilisez les procédures suivantes pour vous assurer que vous avez effectué les deux étapes.</span><span class="sxs-lookup"><span data-stu-id="a01b8-124">Use the following procedures to ensure you have performed both steps.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a01b8-125">Les étapes suivantes présument l'existance d'un groupe de disponibilité et de bases de données AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="a01b8-125">The following steps assume an existing AlwaysOn availability group and databases.</span></span> <span data-ttu-id="a01b8-126">Si vous configurez un nouveau groupe, utilisez l'Assistant Nouveau groupe de disponibilité pour créer le groupe et pour joindre les bases de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-126">If you are configuring a new group, use the New Availability Group Wizard to create the group and join the databases.</span></span> <span data-ttu-id="a01b8-127">L'Assistant vérifie les composants requis, fournit de l'aide pour chaque étape et exécute la synchronisation initiale.</span><span class="sxs-lookup"><span data-stu-id="a01b8-127">The wizard checks for prerequisites, provides guidance for each step, and performs the initial synchronization.</span></span> <span data-ttu-id="a01b8-128">Pour plus d’informations, consultez [Utiliser l’Assistant Groupe de disponibilité &#40;SQL Server Management Studio&#41;](use-the-availability-group-wizard-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="a01b8-128">For more information, see [Use the Availability Group Wizard &#40;SQL Server Management Studio&#41;](use-the-availability-group-wizard-sql-server-management-studio.md).</span></span>  
  
#### <a name="step-1-configure-access-on-an-availability-replica"></a><span data-ttu-id="a01b8-129">Étape 1 : Configurer l'accès sur un réplica de disponibilité</span><span class="sxs-lookup"><span data-stu-id="a01b8-129">Step 1: Configure access on an availability replica</span></span>  
  
1.  <span data-ttu-id="a01b8-130">Dans l'Explorateur d'objets, connectez-vous à l'instance de serveur qui héberge le réplica principal et développez l'arborescence du serveur.</span><span class="sxs-lookup"><span data-stu-id="a01b8-130">In Object Explorer, connect to the server instance that hosts the primary replica, and expand the server tree.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a01b8-131">Ces étapes sont tirées de la rubrique [Configurer l’accès en lecture seule sur un réplica de disponibilité &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md), qui fournit des informations supplémentaires et d’autres instructions pour effectuer cette tâche.</span><span class="sxs-lookup"><span data-stu-id="a01b8-131">These steps are taken from [Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;](configure-read-only-access-on-an-availability-replica-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="a01b8-132">Développez le nœud **Haute disponibilité AlwaysOn** et le nœud **Groupes de disponibilité** .</span><span class="sxs-lookup"><span data-stu-id="a01b8-132">Expand the **AlwaysOn High Availability** node and the **Availability Groups** node.</span></span>  
  
3.  <span data-ttu-id="a01b8-133">Cliquez sur le groupe de disponibilité dont vous souhaitez modifier le réplica.</span><span class="sxs-lookup"><span data-stu-id="a01b8-133">Click the availability group whose replica you want to change.</span></span> <span data-ttu-id="a01b8-134">Développez **Réplicas de disponibilité**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-134">Expand **Availability Replicas**.</span></span>  
  
4.  <span data-ttu-id="a01b8-135">Cliquez avec le bouton droit sur le réplica secondaire, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-135">Right-click the secondary replica, and click **Properties**.</span></span>  
  
5.  <span data-ttu-id="a01b8-136">Dans la boîte de dialogue **Propriétés du réplica de disponibilité** , modifiez l'accès à la connexion pour le rôle secondaire, comme suit :</span><span class="sxs-lookup"><span data-stu-id="a01b8-136">In the **Availability Replica Properties** dialog box, change the connection access for the secondary role, as follows:</span></span>  
  
    -   <span data-ttu-id="a01b8-137">Dans la liste déroulante **Secondaire accessible en lecture** , sélectionnez **Intention de lecture uniquement**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-137">In the **Readable secondary** drop list, select **Read-intent only**.</span></span>  
  
    -   <span data-ttu-id="a01b8-138">Dans la liste déroulante **Connexions en rôle principal** , sélectionnez **Autoriser toutes les connexions**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-138">In the **Connections in primary role** drop list, select **Allow all connections**.</span></span> <span data-ttu-id="a01b8-139">Il s'agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="a01b8-139">This is the default.</span></span>  
  
    -   <span data-ttu-id="a01b8-140">Éventuellement, dans la liste déroulante **Mode de disponibilité** , sélectionnez **Validation synchrone**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-140">Optionally, in **Availability mode** drop list, select **Synchronous commit**.</span></span> <span data-ttu-id="a01b8-141">Cette étape n'est pas obligatoire, mais elle permet de garantir qu'il existe une parité des données entre le réplica primaire et le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-141">This step is not required, but setting it ensures that there is data parity between the primary and secondary replica.</span></span>  
  
         <span data-ttu-id="a01b8-142">Cette propriété est également exigée pour le basculement planifié.</span><span class="sxs-lookup"><span data-stu-id="a01b8-142">This property is also a requirement for planned failover.</span></span> <span data-ttu-id="a01b8-143">Si vous souhaitez effectuer un basculement planifié manuel à des fins de test, définissez le **Mode de disponibilité** sur **Validation synchrone** à la fois pour le réplica primaire et le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-143">If you want to perform a planned manual failover for testing purposes, set **Availability mode** to **Synchronous commit** for both the primary and secondary replica.</span></span>  
  
#### <a name="step-2-configure-read-only-routing"></a><span data-ttu-id="a01b8-144">Étape 2 : Configurer le routage en lecture seule</span><span class="sxs-lookup"><span data-stu-id="a01b8-144">Step 2: Configure read-only routing</span></span>  
  
1.  <span data-ttu-id="a01b8-145">Connectez-vous au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-145">Connect to the primary replica.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a01b8-146">Ces étapes sont tirées de la rubrique [Configurer le routage en lecture seule pour un groupe de disponibilité &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md), qui fournit des informations supplémentaires et d’autres instructions pour effectuer cette tâche.</span><span class="sxs-lookup"><span data-stu-id="a01b8-146">These steps are taken from [Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="a01b8-147">Ouvrez une fenêtre de requête et collez le script suivant.</span><span class="sxs-lookup"><span data-stu-id="a01b8-147">Open a query window and paste in the following script.</span></span> <span data-ttu-id="a01b8-148">Ce script effectue trois opérations : il active les connexions lisibles sur un réplica secondaire (option désactivée par défaut), il définit l'URL de routage en lecture seule et il crée la liste de routage qui définit la priorité de direction des demandes de connexion.</span><span class="sxs-lookup"><span data-stu-id="a01b8-148">This script does three things: enables readable connections to a secondary replica (which is off by default), sets the read-only routing URL, and creates the routing list that prioritizes how connection requests are directed.</span></span>  <span data-ttu-id="a01b8-149">La première instruction, autorisant les connexions lisibles, est redondante si vous avez déjà défini les propriétés dans [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], mais elle est incluse par souci d'exhaustivité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-149">The first statement, allowing readable connections, is redundant if you already set the properties in [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], but are included for completeness.</span></span>  
  
    ```  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://COMPUTER01.contoso.com:1433'));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));  
  
    ALTER AVAILABILITY GROUP [AG1]  
     MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://COMPUTER02.contoso.com:1433'));  
  
    ALTER AVAILABILITY GROUP [AG1]   
    MODIFY REPLICA ON  
    N'COMPUTER01' WITH   
    (PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('COMPUTER02','COMPUTER01')));  
  
    ALTER AVAILABILITY GROUP [AG1]   
    MODIFY REPLICA ON  
    N'COMPUTER02' WITH   
    (PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('COMPUTER01','COMPUTER02')));  
    GO  
    ```  
  
3.  <span data-ttu-id="a01b8-150">Modifiez le script en remplaçant les espaces réservés par des valeurs valides pour votre déploiement :</span><span class="sxs-lookup"><span data-stu-id="a01b8-150">Modify the script, replacing placeholders with values that are valid for your deployment:</span></span>  
  
    -   <span data-ttu-id="a01b8-151">Remplacez « Computer01 » par le nom de l’instance de serveur qui héberge le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-151">Replace 'Computer01' with the name of the server instance that hosts the primary replica.</span></span>  
  
    -   <span data-ttu-id="a01b8-152">Remplacez « Computer02 » par le nom de l’instance de serveur qui héberge le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-152">Replace 'Computer02' with the name of the server instance that hosts the secondary replica.</span></span>  
  
    -   <span data-ttu-id="a01b8-153">Remplacez « contoso.com » par le nom de votre domaine, ou omettez-le du script si tous les ordinateurs se trouvent dans le même domaine.</span><span class="sxs-lookup"><span data-stu-id="a01b8-153">Replace 'contoso.com' with the name of your domain, or omit it from the script if all computers are in the same domain.</span></span> <span data-ttu-id="a01b8-154">Conservez le numéro de port si l'écouteur utilise le port par défaut.</span><span class="sxs-lookup"><span data-stu-id="a01b8-154">Keep the port number if the listener is using the default port.</span></span> <span data-ttu-id="a01b8-155">Le port réellement utilisé par l'écouteur est répertorié dans la page des propriétés dans [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a01b8-155">The port that is actually used by the listener is listed in the properties page in [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)].</span></span>  
  
4.  <span data-ttu-id="a01b8-156">Exécutez le script.</span><span class="sxs-lookup"><span data-stu-id="a01b8-156">Execute the script.</span></span>  
  
     <span data-ttu-id="a01b8-157">Créez ensuite une source de données dans un modèle Analysis Services qui utilise une base de données à partir du groupe que vous venez de configurer.</span><span class="sxs-lookup"><span data-stu-id="a01b8-157">Next, create a data source in an Analysis Services model that uses a database from the group you just configured.</span></span>  
  
##  <a name="create-an-analysis-services-data-source-using-an-alwayson-availability-database"></a><a name="bkmk_ssasAODB"></a><span data-ttu-id="a01b8-158">Créer une source de données Analysis Services à l’aide d’une base de données de disponibilité AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="a01b8-158">Create an Analysis Services data source using an AlwaysOn availability database</span></span>  
 <span data-ttu-id="a01b8-159">Cette section explique comment créer une source de données Analysis Services qui se connecte à une base de données dans un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-159">This section explains how to create an Analysis Services data source that connects to a database in an availability group.</span></span> <span data-ttu-id="a01b8-160">Vous pouvez utiliser cette instruction pour configurer une connexion à un réplica principal (valeur par défaut) ou un réplica secondaire lisible, configurés en suivant les étapes de l'une des sections précédentes.</span><span class="sxs-lookup"><span data-stu-id="a01b8-160">You can use these instructions to configure a connection to either a primary replica (default) or a readable secondary replica that you configured based on steps in a previous section.</span></span> <span data-ttu-id="a01b8-161">Les paramètres de configuration AlwaysOn, plus les propriétés de connexion définies dans le client, déterminent si un réplica primaire ou secondaire est utilisé.</span><span class="sxs-lookup"><span data-stu-id="a01b8-161">AlwaysOn configuration settings, plus the connection properties set in the client, will determine whether a primary or secondary replica is used.</span></span>  
  
1.  <span data-ttu-id="a01b8-162">Dans [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], dans un projet de modèle d’exploration de données et multidimensionnel Analysis Services, cliquez avec le bouton droit sur **Sources de données** et sélectionnez **Nouvelle source de données**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-162">In [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], in an Analysis Services Multidimensional and Data Mining Model project, right-click **Data Sources** and select **New Data Source**.</span></span> <span data-ttu-id="a01b8-163">Cliquez sur **Nouvelle** pour créer une nouvelle source de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-163">Click **New** to create a new data source.</span></span>  
  
     <span data-ttu-id="a01b8-164">Sinon, pour un projet de modèle tabulaire, cliquez sur le menu Modèle, puis cliquez sur **Importer à partir de la source de données**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-164">Alternatively, for a tabular model project, click the Model menu, and then click **Import from Data Source**.</span></span>  
  
2.  <span data-ttu-id="a01b8-165">Dans le Gestionnaire de connexions, dans le Fournisseur, choisissez un fournisseur qui prend en charge le protocole TDS (Tabular Data Stream).</span><span class="sxs-lookup"><span data-stu-id="a01b8-165">In Connection Manager, in Provider, choose a provider that supports the Tabular Data Stream (TDS) protocol.</span></span> <span data-ttu-id="a01b8-166">SQL Server Native Client 11.0 prend en charge ce protocole.</span><span class="sxs-lookup"><span data-stu-id="a01b8-166">The SQL Server Native Client 11.0 supports this protocol.</span></span>  
  
3.  <span data-ttu-id="a01b8-167">Dans le Gestionnaire de connexions, dans Nom du serveur, entrez le nom de l' *écouteur du groupe de disponibilité*, puis choisissez une base de données qui est disponible dans le groupe.</span><span class="sxs-lookup"><span data-stu-id="a01b8-167">In Connection Manager, in Server Name, enter the name of the *availability group listener*, and then choose a database that is available in the group.</span></span>  
  
     <span data-ttu-id="a01b8-168">L'écouteur du groupe de disponibilité redirige une connexion cliente sur un réplica principal pour les demandes en lecture-écriture ou sur un réplica secondaire si vous spécifiez l'intention de lecture dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="a01b8-168">The availability group listener redirects a client connection to a primary replica for read-write requests or to a secondary replica if you specify read-intent in the connection string.</span></span> <span data-ttu-id="a01b8-169">Étant donné que les rôles de réplica changent lors d'un basculement (lorsque le principal devient le secondaire et un secondaire devient un principal), vous devez toujours spécifier l'écouteur afin que la connexion cliente soit redirigée en conséquence.</span><span class="sxs-lookup"><span data-stu-id="a01b8-169">Because replica roles will change during a failover (where the primary becomes the secondary and a secondary becomes a primary), you should always specify the listener so that the client connection is redirected accordingly.</span></span>  
  
     <span data-ttu-id="a01b8-170">Pour déterminer le nom de l'écouteur du groupe de disponibilité, vous pouvez demander à un administrateur de base de données ou bien vous connecter à une instance du groupe de disponibilité et afficher sa configuration de disponibilité AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="a01b8-170">To determine the name of the availability group listener, you can either ask a database administrator or connect to an instance in the availability group and view its AlwaysOn availability configuration.</span></span> <span data-ttu-id="a01b8-171">Dans la capture d’écran ci-dessous, l’écouteur de groupe de disponibilité est **AdventureWorks2**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-171">In the screenshot below, the availability group listener is **AdventureWorks2**.</span></span>  
  
     <span data-ttu-id="a01b8-172">![Dossier de disponibilité AlwaysOn dans Management Studio](../../media/ssas-alwaysoninfoinssms.png "Dossier de disponibilité AlwaysOn dans Management Studio")</span><span class="sxs-lookup"><span data-stu-id="a01b8-172">![AlwaysOn Availability folder in Management Studio](../../media/ssas-alwaysoninfoinssms.png "AlwaysOn Availability folder in Management Studio")</span></span>  
  
4.  <span data-ttu-id="a01b8-173">Toujours dans le Gestionnaire de connexions, cliquez sur **Tout** dans le volet de navigation gauche pour afficher la grille des propriétés du fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-173">Still in Connection Manager, click **All** in the left navigation pane to view the property grid of data provider.</span></span>  
  
     <span data-ttu-id="a01b8-174">Affectez la valeur **READONLY** à **Intention de l’application** si vous configurez une connexion cliente en lecture seule sur un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-174">Set **Application Intent** to **READONLY** if you are configuring a read-only client connection to a secondary replica.</span></span> <span data-ttu-id="a01b8-175">Sinon, conservez la valeur par défaut **READWRITE** pour rediriger la connexion au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-175">Otherwise, keep the **READWRITE** default to redirect the connection to the primary replica.</span></span>  
  
5.  <span data-ttu-id="a01b8-176">Dans les Informations d’emprunt d’identité, sélectionnez **Utiliser un nom d’utilisateur et un mot de passe Windows spécifiques**, puis entrez un compte d’utilisateur de domaine Windows qui a au minimum des autorisations **db_datareader** sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-176">In Impersonation Information, select **Use a specific Windows user name and password**, and then enter a Windows domain user account that has a minimum of **db_datareader** permissions on the database.</span></span>  
  
     <span data-ttu-id="a01b8-177">Ne sélectionnez pas **Utiliser les infos d'identification de l'utilisateur actuel** ou **Hériter**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-177">Do not choose **Use the credentials of the current user** or **Inherit**.</span></span> <span data-ttu-id="a01b8-178">Vous pouvez choisir **Utiliser le compte de service**, mais uniquement si ce compte a des autorisations de lecture sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-178">You can choose **Use the service account**, but only if that account has read permissions on the database.</span></span>  
  
     <span data-ttu-id="a01b8-179">Terminez la source de données et fermez l'Assistant Source de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-179">Finish the data source and close the Data Source Wizard.</span></span>  
  
6.  <span data-ttu-id="a01b8-180">Ajoutez **MultiSubnetFailover=Yes** à la chaîne de connexion pour fournir une détection et une connexion plus rapides au serveur actif.</span><span class="sxs-lookup"><span data-stu-id="a01b8-180">Add **MultiSubnetFailover=Yes** to the connection string to provide faster detection and connection to the active server.</span></span> <span data-ttu-id="a01b8-181">Pour plus d'informations sur cette propriété, consultez [Prise en charge des fonctionnalités de récupération d'urgence, haute disponibilité par SQL Server Native Client](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="a01b8-181">For more information about this property, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../../../relational-databases/native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
     <span data-ttu-id="a01b8-182">Cette propriété n'est pas visible dans la grille des propriétés.</span><span class="sxs-lookup"><span data-stu-id="a01b8-182">This property is not visible in the property grid.</span></span> <span data-ttu-id="a01b8-183">Pour ajouter la propriété, cliquez avec le bouton droit sur la source de données et choisissez **Afficher le code**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-183">To add the property, right-click the data source and choose **View Code**.</span></span> <span data-ttu-id="a01b8-184">Ajoutez `MultiSubnetFailover=Yes` à la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="a01b8-184">Add `MultiSubnetFailover=Yes` to the connection string.</span></span>  
  
 <span data-ttu-id="a01b8-185">La source de données est maintenant définie.</span><span class="sxs-lookup"><span data-stu-id="a01b8-185">The data source is now defined.</span></span> <span data-ttu-id="a01b8-186">Vous pouvez maintenant créer un modèle, en commençant par la vue de source de données ou, dans le cas de modèles tabulaires, en créant des relations.</span><span class="sxs-lookup"><span data-stu-id="a01b8-186">You can now proceed to build a model, starting with the data source view, or in the case of tabular models, creating relationships.</span></span> <span data-ttu-id="a01b8-187">Lorsque vous arrivez au stade où les données doivent être récupérées de la base de données de disponibilité (par exemple lorsque vous êtes prêt à traiter ou déployer la solution), vous pouvez tester la configuration pour vérifier que les données sont accessibles à partir du réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-187">When you are at a point where data must be retrieved from the availability database (for example when you are ready to process or deploy the solution), you can test the configuration to verify data is accessed from the secondary replica.</span></span>  
  
##  <a name="test-the-configuration"></a><a name="bkmk_test"></a><span data-ttu-id="a01b8-188">Tester la configuration</span><span class="sxs-lookup"><span data-stu-id="a01b8-188">Test the configuration</span></span>  
 <span data-ttu-id="a01b8-189">Après avoir configuré le réplica secondaire et créez une connexion à la source de données dans Analysis Services, vous pouvez vérifier que le traitement et les commandes de requête sont redirigées vers le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-189">After you configure the secondary replica and create a data source connection in Analysis Services, you can confirm that processing and query commands are redirected to the secondary replica.</span></span> <span data-ttu-id="a01b8-190">Vous pouvez également effectuer un basculement manuel planifié afin de vérifier votre plan de récupération pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="a01b8-190">You can also perform a planned manual failover to verify your recovery plan for this scenario.</span></span>  
  
#### <a name="step-1-confirm-the-data-source-connection-is-redirected-to-the-secondary-replica"></a><span data-ttu-id="a01b8-191">Étape 1 : Vérifier que la connexion à la source de données est redirigé vers le réplica secondaire</span><span class="sxs-lookup"><span data-stu-id="a01b8-191">Step 1: Confirm the data source connection is redirected to the secondary replica</span></span>  
  
1.  <span data-ttu-id="a01b8-192">Démarrez le Générateur de profils SQL Server et connectez-vous à l'instance SQL Server qui héberge le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-192">Start SQL Server Profiler and connect to the SQL Server instance hosting the secondary replica.</span></span>  
  
     <span data-ttu-id="a01b8-193">À mesure que la trace s'exécute, les événements `SQL:BatchStarting` et `SQL:BatchCompleting` affichent les requêtes émises à partir d'Analysis Services qui s'exécutent sur l'instance du moteur de base de données.</span><span class="sxs-lookup"><span data-stu-id="a01b8-193">As the trace runs, the `SQL:BatchStarting` and `SQL:BatchCompleting` events will show the queries issued from Analysis Services that are executing on the database engine instance.</span></span> <span data-ttu-id="a01b8-194">Ces événements sont sélectionnés par défaut, par conséquent il vous suffit de démarrer la trace.</span><span class="sxs-lookup"><span data-stu-id="a01b8-194">These events are selected by default so all you need to do is start the trace.</span></span>  
  
2.  <span data-ttu-id="a01b8-195">Dans [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], ouvrez le projet ou la solution Analysis Services contenant la connexion à la source de données que vous souhaitez tester.</span><span class="sxs-lookup"><span data-stu-id="a01b8-195">In [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)], open the Analysis Services project or solution containing a data source connection you want to test.</span></span> <span data-ttu-id="a01b8-196">Assurez-vous que la source de données spécifie l'écouteur du groupe de disponibilité et non une instance du groupe.</span><span class="sxs-lookup"><span data-stu-id="a01b8-196">Be sure that the data source specifies the availability group listener and not an instance in the group.</span></span>  
  
     <span data-ttu-id="a01b8-197">Cette étape est importante.</span><span class="sxs-lookup"><span data-stu-id="a01b8-197">This step is important.</span></span> <span data-ttu-id="a01b8-198">Le routage au réplica secondaire ne se produit pas si vous spécifiez un nom d'instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="a01b8-198">Routing to the secondary replica will not occur if you specify a server instance name.</span></span>  
  
3.  <span data-ttu-id="a01b8-199">Réorganisez les fenêtres d'application afin que vous puissiez afficher le Générateur de profils SQL Server et [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)] côte à côte.</span><span class="sxs-lookup"><span data-stu-id="a01b8-199">Arrange the application windows so that you can view SQL Server Profiler and [!INCLUDE[ssBIDevStudio](../../../includes/ssbidevstudio-md.md)] side by side.</span></span>  
  
4.  <span data-ttu-id="a01b8-200">Déployez la solution puis, lorsque cela est terminé, arrêtez la trace.</span><span class="sxs-lookup"><span data-stu-id="a01b8-200">Deploy the solution, and when it completes, stop the trace.</span></span>  
  
     <span data-ttu-id="a01b8-201">Dans la fenêtre de trace, vous devez voir les événements de l'application **Microsoft SQL Server Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-201">In the trace window, you should see events from the application **Microsoft SQL Server Analysis Services**.</span></span> <span data-ttu-id="a01b8-202">Vous devez voir les instructions `SELECT` qui extraient les données d'une base de données sur l'instance de serveur qui héberge le réplica secondaire, ce qui prouve que la connexion a été établie via l'écouteur du réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-202">You should see `SELECT` statements that retrieve data from a database on the server instance that hosts the secondary replica, proving that the connection was made via the listener to the secondary replica.</span></span>  
  
#### <a name="step-2-perform-a-planned-failover-to-test-the-configuration"></a><span data-ttu-id="a01b8-203">Étape 2 : Effectuer un basculement planifié pour tester la configuration</span><span class="sxs-lookup"><span data-stu-id="a01b8-203">Step 2: Perform a planned failover to test the configuration</span></span>  
  
1.  <span data-ttu-id="a01b8-204">Dans [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] , vérifiez les réplicas primaire et secondaire pour vous assurer qu'ils sont tous deux configurés pour le mode de validation synchrone et qu'ils sont actuellement synchronisés.</span><span class="sxs-lookup"><span data-stu-id="a01b8-204">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] check the primary and secondary replicas to ensure that both are configured for synchronous-commit mode and are currently synchronized.</span></span>  
  
     <span data-ttu-id="a01b8-205">Les étapes suivantes impliquent qu'un réplica secondaire est configuré pour la validation synchrone.</span><span class="sxs-lookup"><span data-stu-id="a01b8-205">The following steps assume a secondary replica is configured for synchronous commit.</span></span>  
  
     <span data-ttu-id="a01b8-206">Pour vérifier la synchronisation, ouvrez une connexion à chaque instance qui héberge les réplicas primaire et secondaire, développez le dossier Bases de données et vérifiez que **(Synchronisé)** et **(Synchronisation)** sont ajoutés au nom de la base de données dans chaque réplica.</span><span class="sxs-lookup"><span data-stu-id="a01b8-206">To verify synchronization, open a connection to each instance that hosts the primary and secondary replicas, expand the Databases folder, and ensure that the database has **(Synchronized)** and **(Synchronizing)** appended to its name in each replica.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="a01b8-207">Ces étapes sont tirées de la rubrique [Effectuer un basculement manuel planifié d’un groupe de disponibilité &#40;SQL Server&#41;](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md), qui fournit des informations supplémentaires et d’autres instructions pour effectuer cette tâche.</span><span class="sxs-lookup"><span data-stu-id="a01b8-207">These steps are taken from [Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md), which provides additional information and alternative instructions for performing this task.</span></span>  
  
2.  <span data-ttu-id="a01b8-208">Dans le Générateur de profils SQL Server, démarrez les traces pour chaque réplica et affichez les traces côte à côte.</span><span class="sxs-lookup"><span data-stu-id="a01b8-208">In SQL Server Profiler, start traces for each replica and view the traces side-by-side.</span></span> <span data-ttu-id="a01b8-209">Dans les étapes suivantes, vous allez comparer des traces, pour vérifier que les requêtes SQL utilisées pour le traitement ou l'interrogation depuis Analysis Services basculent d'un réplica à l'autre.</span><span class="sxs-lookup"><span data-stu-id="a01b8-209">In the following steps, you will compare traces, confirming that the SQL queries used for processing or querying from Analysis Services switch from one replica to the other.</span></span>  
  
3.  <span data-ttu-id="a01b8-210">Exécutez un traitement ou une commande de requête depuis Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="a01b8-210">Execute a processing or query command from within Analysis Services.</span></span> <span data-ttu-id="a01b8-211">Étant donné que vous avez configuré la source de données pour une connexion en lecture seule, vous devez voir la commande s'exécuter sur le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-211">Because you configured the data source for a read-only connection, you should see the command execute on the secondary replica.</span></span>  
  
4.  <span data-ttu-id="a01b8-212">Dans [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], connectez-vous au réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-212">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], connect to the secondary replica.</span></span>  
  
5.  <span data-ttu-id="a01b8-213">Développez le nœud **Haute disponibilité AlwaysOn** et le nœud **Groupes de disponibilité** .</span><span class="sxs-lookup"><span data-stu-id="a01b8-213">Expand the **AlwaysOn High Availability** node and the **Availability Groups** node.</span></span>  
  
6.  <span data-ttu-id="a01b8-214">Cliquez avec le bouton droit sur le groupe de disponibilité à basculer et sélectionnez la commande **Basculement** .</span><span class="sxs-lookup"><span data-stu-id="a01b8-214">Right-click the availability group to be failed over, and select the **Failover** command.</span></span> <span data-ttu-id="a01b8-215">Cette commande démarre l'Assistant Basculer le groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="a01b8-215">This starts the Fail Over Availability Group Wizard.</span></span> <span data-ttu-id="a01b8-216">Utilisez l'Assistant pour choisir le réplica qui sera le nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-216">Use the wizard to choose which replica to make the new primary replica.</span></span>  
  
7.  <span data-ttu-id="a01b8-217">Vérifiez que le basculement a réussi :</span><span class="sxs-lookup"><span data-stu-id="a01b8-217">Confirm that failover succeeded:</span></span>  
  
    -   <span data-ttu-id="a01b8-218">Dans [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], développez les groupes de disponibilité pour afficher les désignations (principales) et (secondaires).</span><span class="sxs-lookup"><span data-stu-id="a01b8-218">In [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)], expand the availability groups to view the (primary) and (secondary) designations.</span></span> <span data-ttu-id="a01b8-219">L'instance qui était précédemment un réplica principal doit maintenant être un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-219">The instance that was previously a primary replica should now be a secondary replica.</span></span>  
  
    -   <span data-ttu-id="a01b8-220">Affichez le tableau de bord pour déterminer si des problèmes d'intégrité ont été détectés.</span><span class="sxs-lookup"><span data-stu-id="a01b8-220">View the dashboard to determine if any health issues were detected.</span></span> <span data-ttu-id="a01b8-221">Cliquez avec le bouton droit sur le groupe de disponibilité, puis sélectionnez **afficher le tableau de bord**.</span><span class="sxs-lookup"><span data-stu-id="a01b8-221">Right-click the availability group and select **Show Dashboard**.</span></span>  
  
8.  <span data-ttu-id="a01b8-222">Attendez une ou deux minutes que le basculement se termine sur le service principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-222">Wait one or two minutes for the failover to complete on the backend.</span></span>  
  
9. <span data-ttu-id="a01b8-223">Répétez le traitement ou la commande de requête dans la solution Analysis Services, puis affichez les traces côte à côte dans le Générateur de profils SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a01b8-223">Repeat the processing or query command in the Analysis Services solution, and then watch the traces side by side in SQL Server Profiler.</span></span> <span data-ttu-id="a01b8-224">Vous devez voir le traitement sur l'autre instance, qui est désormais le nouveau réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-224">You should see evidence of processing on the other instance, which is now the new secondary replica.</span></span>  
  
##  <a name="what-happens-after-a-failover-occurs"></a><a name="bkmk_whathappens"></a><span data-ttu-id="a01b8-225">Que se passe-t-il après un basculement ?</span><span class="sxs-lookup"><span data-stu-id="a01b8-225">What happens after a failover occurs</span></span>  
 <span data-ttu-id="a01b8-226">Lors d'un basculement, un réplica secondaire adopte le rôle principal et l'ancien réplica principal joue le rôle secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-226">During a failover, a secondary replica transitions to the primary role and the former primary replica transitions to the secondary role.</span></span> <span data-ttu-id="a01b8-227">Toutes les connexions clientes sont terminées, la propriété de l’écouteur du groupe de disponibilité passe avec le rôle de réplica principal à une nouvelle instance de SQL Server, et le point de terminaison de l’écouteur est lié aux adresses IP virtuelles et aux ports TCP de la nouvelle instance.</span><span class="sxs-lookup"><span data-stu-id="a01b8-227">All client connections are terminated, ownership of the availability group listener moves with the primary replica role to a new SQL Server instance, and the listener endpoint is bound to the new instance's virtual IP addresses and TCP ports.</span></span> <span data-ttu-id="a01b8-228">Pour plus d’informations, consultez [À propos de l’accès de la connexion client aux réplicas de disponibilité &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="a01b8-228">For more information, see [About Client Connection Access to Availability Replicas &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md).</span></span>  
  
 <span data-ttu-id="a01b8-229">Si le basculement se produit lors du traitement, l’erreur suivante apparaît dans Analysis Services dans le fichier journal ou la fenêtre de sortie : « Erreur OLE DB : Erreur OLE DB ou ODBC : Échec de la liaison de communication ; 08S01 ; Fournisseur de TPC : Une connexion existante a dû être fermée par l’hôte distant.</span><span class="sxs-lookup"><span data-stu-id="a01b8-229">If failover occurs during processing, the following error occurs in Analysis Services in the log file or output window: "OLE DB error: OLE DB or ODBC error: Communication link failure; 08S01; TPC Provider: An existing connection was forcibly closed by the remote host.</span></span> <span data-ttu-id="a01b8-230">; 08S01. »</span><span class="sxs-lookup"><span data-stu-id="a01b8-230">; 08S01."</span></span>  
  
 <span data-ttu-id="a01b8-231">Cette erreur devrait être résolue si vous attendez une minute avant de recommencer.</span><span class="sxs-lookup"><span data-stu-id="a01b8-231">This error should resolve if you wait a minute and try again.</span></span> <span data-ttu-id="a01b8-232">Si le groupe de disponibilité est configuré correctement pour le réplica secondaire lisible, le traitement continue sur le nouveau réplica secondaire lorsque vous réexécutez le traitement.</span><span class="sxs-lookup"><span data-stu-id="a01b8-232">If the availability group is configured correctly for readable secondary replica, processing will resume on the new secondary replica when you retry processing.</span></span>  
  
 <span data-ttu-id="a01b8-233">Les erreurs persistantes sont généralement dues à un problème de configuration.</span><span class="sxs-lookup"><span data-stu-id="a01b8-233">Persistent errors are most likely due to a configuration problem.</span></span> <span data-ttu-id="a01b8-234">Vous pouvez essayer de réexécuter le script T-SQL pour résoudre les problèmes liés à la liste de routage, aux URL de routage en lecture seule et à l'intention de lecture sur le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="a01b8-234">You can try re-running the T-SQL script to resolve problems with the routing list, read-only routing URLs, and read-intent on the secondary replica.</span></span> <span data-ttu-id="a01b8-235">Vous devez également vérifier que le réplica principal autorise toutes les connexions.</span><span class="sxs-lookup"><span data-stu-id="a01b8-235">You should also verify that the primary replica allows all connections.</span></span>  
  
##  <a name="writeback-when-using-an-alwayson-availability-database"></a><a name="bkmk_writeback"></a><span data-ttu-id="a01b8-236">Écriture différée avec une base de données de disponibilité AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="a01b8-236">Writeback when using an AlwaysOn availability database</span></span>  
 <span data-ttu-id="a01b8-237">L'écriture différée est une fonctionnalité Analysis Services qui prend en charge l'analyse Scénario dans Excel.</span><span class="sxs-lookup"><span data-stu-id="a01b8-237">Writeback is an Analysis Services feature that supports What If analysis in Excel.</span></span> <span data-ttu-id="a01b8-238">Elle est généralement utilisée pour budgéter et prévoir des tâches dans des applications personnalisées.</span><span class="sxs-lookup"><span data-stu-id="a01b8-238">It is also commonly used for budgeting and forecasting tasks in custom applications.</span></span>  
  
 <span data-ttu-id="a01b8-239">La prise en charge de l'écriture différée nécessite une connexion cliente READWRITE.</span><span class="sxs-lookup"><span data-stu-id="a01b8-239">Support for writeback requires a READWRITE client connection.</span></span> <span data-ttu-id="a01b8-240">Dans Excel, si vous tentez d’écrire en différé sur une connexion en lecture seule, l’erreur suivante se produit : « Impossible de récupérer les données de la source de données externe. ».</span><span class="sxs-lookup"><span data-stu-id="a01b8-240">In Excel, if you attempt to write back on a read-only connection, the following error will occur: "Data could not be retrieved from the external data source."</span></span> <span data-ttu-id="a01b8-241">« Impossible de récupérer les données de la source de données externe. »</span><span class="sxs-lookup"><span data-stu-id="a01b8-241">"Data could not be retrieved from the external data source."</span></span>  
  
 <span data-ttu-id="a01b8-242">Si vous avez configuré une connexion pour accéder toujours à un réplica secondaire lisible, vous devez maintenant configurer une connexion qui utilise une connexion READWRITE au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="a01b8-242">If you configured a connection to always access a readable secondary replica, you must now configure a new connection that uses a READWRITE connection to the primary replica.</span></span>  
  
 <span data-ttu-id="a01b8-243">Pour cela, créez une source de données supplémentaire dans un modèle Analysis Services pour prendre en charge la connexion en lecture-écriture.</span><span class="sxs-lookup"><span data-stu-id="a01b8-243">To do this, create an additional data source in an Analysis Services model to support the read-write connection.</span></span> <span data-ttu-id="a01b8-244">Lors de la création de la source de données supplémentaire, utilisez le nom d’écouteur et la base de données que vous avez spécifiés dans la connexion en lecture seule, mais au lieu de modifier **Intention de l’application**, conservez la valeur par défaut qui prend en charge les connexions READWRITE.</span><span class="sxs-lookup"><span data-stu-id="a01b8-244">When creating the additional data source, use the same listener name and database that you specified in the read-only connection, but instead of modifying **Application Intent**, keep the default that supports READWRITE connections.</span></span> <span data-ttu-id="a01b8-245">Vous pouvez à présent ajouter de nouvelles tables de faits ou de dimension à votre vue de source de données, basées sur la source de données en lecture-écriture, puis activer l'écriture différée sur les nouvelles tables.</span><span class="sxs-lookup"><span data-stu-id="a01b8-245">You can now add new fact or dimension tables to your data source view that are based on the read-write data source, and then enable writeback on the new tables.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a01b8-246">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a01b8-246">See Also</span></span>  
 <span data-ttu-id="a01b8-247">[Écouteurs de groupe de disponibilité, connectivité client et basculement d’application &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="a01b8-247">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 <span data-ttu-id="a01b8-248">[Secondaires actifs : réplicas secondaires accessibles en lecture &#40;groupes de disponibilité AlwaysOn&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="a01b8-248">[Active Secondaries: Readable Secondary Replicas &#40;AlwaysOn Availability Groups&#41;](active-secondaries-readable-secondary-replicas-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="a01b8-249">[Stratégies AlwaysOn pour les problèmes opérationnels avec groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](always-on-policies-for-operational-issues-always-on-availability.md) </span><span class="sxs-lookup"><span data-stu-id="a01b8-249">[AlwaysOn Policies for Operational Issues with AlwaysOn Availability Groups &#40;SQL Server&#41;](always-on-policies-for-operational-issues-always-on-availability.md) </span></span>  
 <span data-ttu-id="a01b8-250">[Créer une source de données &#40;SSAS multidimensionnel&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/create-a-data-source-ssas-multidimensional) </span><span class="sxs-lookup"><span data-stu-id="a01b8-250">[Create a Data Source &#40;SSAS Multidimensional&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/create-a-data-source-ssas-multidimensional) </span></span>  
 [<span data-ttu-id="a01b8-251">Activer l’écriture différée de la dimension</span><span class="sxs-lookup"><span data-stu-id="a01b8-251">Enable Dimension Writeback</span></span>](https://docs.microsoft.com/analysis-services/multidimensional-models/bi-wizard-enable-dimension-writeback)  
  
  
