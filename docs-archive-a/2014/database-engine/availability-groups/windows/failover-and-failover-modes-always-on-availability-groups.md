---
title: Basculement et modes de basculement (groupes de disponibilité AlwaysOn) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], failover
- Availability Groups [SQL Server], failover modes
- failover [SQL Server], AlwaysOn Availability Groups
ms.assetid: 378d2d63-50b9-420b-bafb-d375543fda17
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: eb904cd0f0649c43553b5d6c8b031c5f284901f4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604735"
---
# <a name="failover-and-failover-modes-alwayson-availability-groups"></a><span data-ttu-id="e6932-102">Basculement et modes de basculement (groupes de disponibilité AlwaysOn)</span><span class="sxs-lookup"><span data-stu-id="e6932-102">Failover and Failover Modes (AlwaysOn Availability Groups)</span></span>
  <span data-ttu-id="e6932-103">Dans le contexte d'un groupe de disponibilité, le rôle principal et le rôle secondaire des réplicas de disponibilité sont généralement interchangeables au moyen d'un processus appelé *basculement*.</span><span class="sxs-lookup"><span data-stu-id="e6932-103">Within the context of an availability group, the primary role and secondary role of availability replicas are typically interchangeable in a process known as *failover*.</span></span> <span data-ttu-id="e6932-104">Trois formes de basculement existent : basculement automatique (sans perte de données), basculement manuel planifié (sans perte de données) et basculement manuel forcé (avec perte de données possible), ce dernier étant généralement appelé *basculement forcé*.</span><span class="sxs-lookup"><span data-stu-id="e6932-104">Three forms of failover exist: automatic failover (without data loss), planned manual failover (without data loss), and forced manual failover (with possible data loss), typically called *forced failover*.</span></span> <span data-ttu-id="e6932-105">Les basculements automatiques et planifiés manuels préservent vos données.</span><span class="sxs-lookup"><span data-stu-id="e6932-105">Automatic and planned manual failover preserve all your data.</span></span> <span data-ttu-id="e6932-106">Un groupe de disponibilité bascule au niveau d'un réplica de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="e6932-106">An availability group fails over at the availability-replica level.</span></span> <span data-ttu-id="e6932-107">Autrement dit, un groupe de disponibilité bascule vers l’un de ses réplicas secondaires ( *cible de basculement*actuelle).</span><span class="sxs-lookup"><span data-stu-id="e6932-107">That is, an availability group fails over to one of its secondary replicas (the current *failover target*).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e6932-108">Les problèmes qui surviennent au niveau de la base de données, tels qu'une base de données devenant suspecte en raison de la perte d'un fichier de données, la suppression d'une base de données ou l'altération d'un journal des transactions, ne provoquent pas le basculement d'un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="e6932-108">Issues at the database level, such as a database becoming suspect due to the loss of a data file, deletion of a database, or corruption of a transaction log, do not cause an availability group to failover.</span></span>  
  
 <span data-ttu-id="e6932-109">Pendant le basculement, la cible de basculement adopte le rôle principal, récupère ses bases de données et les met en ligne en tant que nouvelles bases de données primaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-109">During the failover, the failover target takes over the primary role, recovers its databases, and brings them online as the new primary databases.</span></span> <span data-ttu-id="e6932-110">Le réplica principal précédent, lorsqu'il est disponible, bascule vers le rôle secondaire, et ses bases de données deviennent des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-110">The former primary replica, when available, switches to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="e6932-111">Ces rôles peuvent éventuellement basculer plusieurs fois (ou vers une cible de basculement différente), soit en réponse à plusieurs défaillances, soit pour des raisons administratives.</span><span class="sxs-lookup"><span data-stu-id="e6932-111">Potentially, these roles can switch back and forth (or to a different failover target) in response to multiple failures or for administrative purposes.</span></span>  
  
 <span data-ttu-id="e6932-112">Les formes de basculement qu’un réplica de disponibilité donné prend en charge sont spécifiées par la propriété *mode de basculement* .</span><span class="sxs-lookup"><span data-stu-id="e6932-112">The form(s) of failover that a given availability replica supports is specified by the *failover mode* property.</span></span> <span data-ttu-id="e6932-113">Pour un réplica de disponibilité spécifique, les modes de basculement possibles dépendent du [mode de disponibilité](availability-modes-always-on-availability-groups.md) du réplica, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e6932-113">For a given availability replica, the possible failover modes depends on the [availability mode](availability-modes-always-on-availability-groups.md) of the replica, as follows:</span></span>  
  
-   <span data-ttu-id="e6932-114">Les **réplicas avec validation synchrone** prennent en charge deux paramètres : automatique ou manuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-114">**Synchronous-commit replicas** support two settings-automatic or manual.</span></span> <span data-ttu-id="e6932-115">Le paramètre « automatic » prend en charge le basculement automatique et le basculement de manuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-115">The "automatic" setting supports both automatic failover and manual failover.</span></span> <span data-ttu-id="e6932-116">Pour empêcher la perte de données, le basculement automatique et le basculement planifié requièrent que la cible de basculement soit un réplica secondaire avec validation synchrone et présente un état de synchronisation intègre (cela indique que chaque base de données secondaire sur la cible de basculement est synchronisée avec sa base de données primaire correspondante).</span><span class="sxs-lookup"><span data-stu-id="e6932-116">To prevent data loss, automatic failover and planned failover require that the failover target be a synchronous-commit secondary replica with a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span> <span data-ttu-id="e6932-117">Si un réplica secondaire ne remplit pas ces deux conditions, il prend en charge seulement le basculement forcé.</span><span class="sxs-lookup"><span data-stu-id="e6932-117">Whenever a secondary replica does not meet both of these conditions, it supports only forced failover.</span></span> <span data-ttu-id="e6932-118">Notez que le basculement forcé est également pris en charge sur les réplicas dont le rôle est dans l'état RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="e6932-118">Note that forced failover is also supported a replicas whose role is in the RESOLVING state.</span></span>  
  
-   <span data-ttu-id="e6932-119">Les**réplicas avec validation asynchrone** prennent en charge uniquement le mode de basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-119">**Asynchronous-commit replicas** support only the manual failover mode.</span></span> <span data-ttu-id="e6932-120">De plus, étant donné qu'ils ne sont jamais synchronisés, ils prennent en charge uniquement le basculement forcé.</span><span class="sxs-lookup"><span data-stu-id="e6932-120">Moreover, because they are never synchronized, they support only forced failover.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="e6932-121">Suite à un basculement, les applications clientes qui doivent accéder aux bases de données primaires doivent se connecter au nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-121">After a failover, client applications that need to access the primary databases must connect to the new primary replica.</span></span> <span data-ttu-id="e6932-122">En outre, si le nouveau réplica secondaire est configuré pour autoriser l'accès en lecture seule, les applications clientes en lecture seule peuvent s'y connecter.</span><span class="sxs-lookup"><span data-stu-id="e6932-122">Also, if the new secondary replica is configured to allow read-only access, read-only client applications can connect to it.</span></span> <span data-ttu-id="e6932-123">Pour plus d’informations sur la connexion de clients à un groupe de disponibilité, consultez [Écouteurs de groupe de disponibilité, connectivité client et basculement d’application &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-123">For information about how clients connect to an availability group, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="e6932-124">Termes et définitions</span><span class="sxs-lookup"><span data-stu-id="e6932-124">Terms and Definitions</span></span>  
 <span data-ttu-id="e6932-125">Basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-125">Automatic failover</span></span>  
 <span data-ttu-id="e6932-126">Basculement qui se produit automatiquement à la perte du réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-126">A failover that occurs automatically on the loss of the primary replica.</span></span> <span data-ttu-id="e6932-127">Le basculement automatique est pris en charge uniquement lorsque le réplica principal actuel et un réplica secondaire sont tous les deux configurés en mode de basculement AUTOMATIQUE et que le réplica secondaire est actuellement synchronisé.</span><span class="sxs-lookup"><span data-stu-id="e6932-127">Automatic failover is supported only when the current primary and one secondary replica are both configured with failover mode set to AUTOMATIC and the secondary replica currently synchronized.</span></span>  <span data-ttu-id="e6932-128">Si basculement du réplica principal ou secondaire est en mode MANUEL, un basculement automatique ne peut pas avoir lieu.</span><span class="sxs-lookup"><span data-stu-id="e6932-128">If the failover mode of either the primary or secondary replica is MANUAL, automatic failover cannot occur.</span></span>  
  
 <span data-ttu-id="e6932-129">Basculement manuel planifié (sans perte de données)</span><span class="sxs-lookup"><span data-stu-id="e6932-129">Planned manual failover (without data loss)</span></span>  
 <span data-ttu-id="e6932-130">Le basculement manuel planifié, ou *basculement manuel*, est un basculement qui est initié par un administrateur de base de données, en général pour des raisons administratives.</span><span class="sxs-lookup"><span data-stu-id="e6932-130">Planned manual failover, or *manual failover*, is a failover that is initiated by a database administrator, typically, for administrative purposes.</span></span> <span data-ttu-id="e6932-131">Un basculement manuel planifié est pris en charge uniquement si le réplica principal et le réplica secondaire sont configurés en mode de validation synchrone et que le réplica secondaire est actuellement synchronisé (dans l'état SYNCHRONIZED).</span><span class="sxs-lookup"><span data-stu-id="e6932-131">A planned manual failover is supported only if both the primary replica and secondary replica are configured for synchronous-commit mode and the secondary replica is currently synchronized (in the SYNCHRONIZED state).</span></span> <span data-ttu-id="e6932-132">Lorsque le réplica secondaire cible est synchronisé, un basculement manuel (sans perte de données) est possible même si le réplica principal est hors service car les bases de données secondaires sont prêtes pour le basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-132">When the target secondary replica is synchronized, manual failover (without data loss) is possible even if the primary replica has crashed because the secondary databases are ready for failover.</span></span> <span data-ttu-id="e6932-133">C'est l'administrateur de base de données qui initie manuellement un basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-133">A database administrator manually initiates a manual failover.</span></span>  
  
 <span data-ttu-id="e6932-134">Basculement forcé (avec possible perte de données)</span><span class="sxs-lookup"><span data-stu-id="e6932-134">Forced failover (with possible data loss)</span></span>  
 <span data-ttu-id="e6932-135">Basculement qui peut être initié par un administrateur de base de données lorsqu'aucun réplica secondaire n'est synchronisé (SYNCHRONIZED) avec le réplica principal, ou lorsque le réplica principal n'est pas en cours d'exécution et aucun réplica secondaire n'est prêt pour le basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-135">A failover that can be initiated by a database administrator when no secondary replica is SYNCHRONIZED with the primary replica or the primary replica is not running and no secondary replica is failover ready.</span></span> <span data-ttu-id="e6932-136">Le basculement forcé présente un risque de perte des données et est exclusivement recommandé dans le cas d'une récupération d'urgence.</span><span class="sxs-lookup"><span data-stu-id="e6932-136">Forced failover risks possible data loss and is recommended strictly for disaster recovery.</span></span> <span data-ttu-id="e6932-137">Le basculement forcé est également appelé « basculement manuel forcé » car il ne peut être initié que manuellement.</span><span class="sxs-lookup"><span data-stu-id="e6932-137">Forced failover is also known as forced manual failover because it can only be initiated manually.</span></span> <span data-ttu-id="e6932-138">Il s'agit de la seule forme de basculement prise en charge en mode de disponibilité avec validation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="e6932-138">This is the only form of failover supported by in asynchronous-commit availability mode.</span></span>  
  
 [!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)]  
 <span data-ttu-id="e6932-139">Dans un groupe de disponibilité donné, paire de réplicas de disponibilité (réplica principal actuel compris) qui est configurée pour le mode de validation synchrone avec basculement automatique, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="e6932-139">Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="e6932-140">Un[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]entre en vigueur uniquement si le réplica secondaire se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-140">An[!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)]takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)]  
 <span data-ttu-id="e6932-141">Dans un groupe de disponibilité donné, un groupe de deux ou trois réplicas de disponibilité (réplica principal actuel compris) qui est configuré pour le mode de validation synchrone, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="e6932-141">Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="e6932-142">Un [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]entre en vigueur uniquement si les réplicas secondaires sont configurés pour le mode de basculement manuel et qu’au moins un réplica secondaire se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-142">A [!INCLUDE[ssFosSync](../../../includes/ssfossync-md.md)]takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 [!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)]  
 <span data-ttu-id="e6932-143">Dans un groupe de disponibilité donné, l'ensemble de tous les réplicas de disponibilité dont l'état opérationnel est actuellement ONLINE, quel que soit le mode de disponibilité et le mode de basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-143">Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="e6932-144">Le [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]est approprié quand aucun réplica secondaire ne se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-144">The [!INCLUDE[ssFosEntire](../../../includes/ssfosentire-md.md)]becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
##  <a name="overview-of-failover"></a><a name="Overview"></a> <span data-ttu-id="e6932-145">Présentation du basculement</span><span class="sxs-lookup"><span data-stu-id="e6932-145">Overview of Failover</span></span>  
 <span data-ttu-id="e6932-146">Le tableau ci-dessous résume les formes de basculement prises en charge dans différents modes de disponibilité et de basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-146">The following table summarizes which forms of failover are supported under different availability and failover modes.</span></span> <span data-ttu-id="e6932-147">Pour chaque couplage, le mode de disponibilité et le mode de basculement les plus efficaces sont déterminés par l'intersection des modes du réplica principal et des modes d'un ou plusieurs réplicas secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-147">For each pairing, the effective availability mode and failover mode is determined by the intersection of the modes of the primary replica plus the modes of one or more secondary replicas.</span></span>  
  
||<span data-ttu-id="e6932-148">Mode de validation asynchrone</span><span class="sxs-lookup"><span data-stu-id="e6932-148">Asynchronous-commit mode</span></span>|<span data-ttu-id="e6932-149">Mode de validation synchrone avec mode de basculement manuel</span><span class="sxs-lookup"><span data-stu-id="e6932-149">Synchronous-commit mode with manual-failover mode</span></span>|<span data-ttu-id="e6932-150">Mode de validation synchrone avec mode de basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-150">Synchronous-commit mode with automatic-failover mode</span></span>|  
|-|-------------------------------|---------------------------------------------------------|------------------------------------------------------------|  
|<span data-ttu-id="e6932-151">Basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-151">Automatic failover</span></span>|<span data-ttu-id="e6932-152">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-152">No</span></span>|<span data-ttu-id="e6932-153">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-153">No</span></span>|<span data-ttu-id="e6932-154">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-154">Yes</span></span>|  
|<span data-ttu-id="e6932-155">Basculement manuel planifié</span><span class="sxs-lookup"><span data-stu-id="e6932-155">Planned manual failover</span></span>|<span data-ttu-id="e6932-156">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-156">No</span></span>|<span data-ttu-id="e6932-157">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-157">Yes</span></span>|<span data-ttu-id="e6932-158">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-158">Yes</span></span>|  
|<span data-ttu-id="e6932-159">basculement forcé</span><span class="sxs-lookup"><span data-stu-id="e6932-159">Forced failover</span></span>|<span data-ttu-id="e6932-160">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-160">Yes</span></span>|<span data-ttu-id="e6932-161">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-161">Yes</span></span>|<span data-ttu-id="e6932-162">Oui**<sup>\*</sup>**</span><span class="sxs-lookup"><span data-stu-id="e6932-162">Yes**<sup>\*</sup>**</span></span>|  
  
 <span data-ttu-id="e6932-163">**<sup>\*</sup>** Si vous exécutez une commande de basculement forcé sur un réplica secondaire synchronisé, le réplica secondaire se comporte de la même façon que pour un basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-163">**<sup>\*</sup>**  If you issue a forced failover command on a synchronized secondary replica, the secondary replica behaves the same as for a manual failover.</span></span>  
  
 <span data-ttu-id="e6932-164">La durée pendant laquelle la base de données n'est pas disponible lors d'un basculement dépend du type de basculement et de la raison de ce dernier.</span><span class="sxs-lookup"><span data-stu-id="e6932-164">The amount of time that the database is unavailable during a failover depends on the type of failover and its cause.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e6932-165">Pour pouvoir prendre en charge les connexions clientes après le basculement, à l'exception des bases de données autonomes, les connexions et les travaux définis sur les bases de données primaires précédentes doivent être recréés manuellement sur la nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-165">To support client connections after failover, except for contained databases, logins and jobs defined on any of the former primary databases must be manually recreated on the new primary database.</span></span> <span data-ttu-id="e6932-166">Pour plus d’informations, consultez [Gestion des connexions et des travaux pour les bases de données d’un groupe de disponibilité &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-166">For more information, see [Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;](../../logins-and-jobs-for-availability-group-databases.md).</span></span>  
  
### <a name="failover-sets"></a><span data-ttu-id="e6932-167">Ensembles de basculement</span><span class="sxs-lookup"><span data-stu-id="e6932-167">Failover Sets</span></span>  
 <span data-ttu-id="e6932-168">Les formes de basculement possibles pour un groupe de disponibilité donné peuvent être présentées en termes de groupes de basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-168">The forms of failover that are possible for a given availability group can be understood in terms of failover sets.</span></span> <span data-ttu-id="e6932-169">Un groupe de basculement comprend le réplica principal et les réplicas secondaires qui prennent en charge un type donné de basculement, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e6932-169">A failover set consists of the primary replica and secondary replicas that support a given form of failover, as follows:</span></span>  
  
-   <span data-ttu-id="e6932-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (facultatif) :**  Dans un groupe de disponibilité donné, paire de réplicas de disponibilité (réplica principal actuel compris) qui est configurée pour le mode de validation synchrone avec basculement automatique, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="e6932-170">**[!INCLUDE[ssFosAutoC](../../../includes/ssfosautoc-md.md)] (optional):**  Within a given availability group, a pair of availability replicas (including the current primary replica) that are configured for synchronous-commit mode with automatic failover, if any.</span></span> <span data-ttu-id="e6932-171">Un groupe des basculements automatiques est appliqué uniquement si le réplica secondaire se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-171">An automatic failover set takes effect only if the secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="e6932-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (facultatif) :**  Dans un groupe de disponibilité donné, un groupe de deux ou trois réplicas de disponibilité (réplica principal actuel compris) qui est configuré pour le mode de validation synchrone, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="e6932-172">**[!INCLUDE[ssFosSyncC](../../../includes/ssfossyncc-md.md)] (optional):**  Within a given availability group, a set of two or three availability replicas (including the current primary replica) that are configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="e6932-173">Un groupe de basculements avec validation synchrone est appliqué uniquement si les réplicas secondaires sont configurés pour le mode de basculement manuel et qu'au moins un réplica secondaire se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-173">A synchronous-commit failover set takes effect only if the secondary replicas are configured for manual failover mode and at least one secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
-   <span data-ttu-id="e6932-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  Dans un groupe de disponibilité donné, l'ensemble de tous les réplicas de disponibilité dont l'état opérationnel est actuellement ONLINE, quel que soit le mode de disponibilité et le mode de basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-174">**[!INCLUDE[ssFosEntireC](../../../includes/ssfosentirec-md.md)] :**  Within a given availability group, the set of all availability replicas whose operational state is currently ONLINE, regardless of availability mode and of failover mode.</span></span> <span data-ttu-id="e6932-175">Le groupe de basculements devient approprié lorsqu'aucun réplica secondaire ne se trouve actuellement en mode SYNCHRONIZED avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-175">The entire failover set becomes relevant when no secondary replica is currently SYNCHRONIZED with the primary replica.</span></span>  
  
 <span data-ttu-id="e6932-176">Lorsque vous configurez un réplica de disponibilité en tant que validation synchrone avec basculement automatique, le réplica de disponibilité devient partie intégrante du [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e6932-176">When you configure an availability replica as synchronous commit with automatic failover, the availability replica becomes part of the [!INCLUDE[ssFosAuto](../../../includes/ssfosauto-md.md)].</span></span> <span data-ttu-id="e6932-177">Toutefois, l'entrée en vigueur de l'ensemble dépend du réplica principal actuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-177">However whether the set takes effect depends the current primary.</span></span> <span data-ttu-id="e6932-178">Les formes de basculement qui sont en fait possibles à un moment donné dépendent des ensembles de basculement actuellement en vigueur.</span><span class="sxs-lookup"><span data-stu-id="e6932-178">The forms of failover that are actually possible at a given time depends on what failover sets are currently in effect.</span></span>  
  
 <span data-ttu-id="e6932-179">Prenons par exemple un groupe de disponibilité qui dispose de quatre réplicas de disponibilité, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e6932-179">For example, consider an availability group that has four availability replicas, as follows:</span></span>  
  
|<span data-ttu-id="e6932-180">Réplica</span><span class="sxs-lookup"><span data-stu-id="e6932-180">Replica</span></span>|<span data-ttu-id="e6932-181">Paramètres de mode de disponibilité et de basculement</span><span class="sxs-lookup"><span data-stu-id="e6932-181">Availability Mode and Failover Mode Settings</span></span>|  
|-------------|--------------------------------------------------|  
|<span data-ttu-id="e6932-182">Un</span><span class="sxs-lookup"><span data-stu-id="e6932-182">A</span></span>|<span data-ttu-id="e6932-183">Validation synchrone avec basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-183">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="e6932-184">B</span><span class="sxs-lookup"><span data-stu-id="e6932-184">B</span></span>|<span data-ttu-id="e6932-185">Validation synchrone avec basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-185">Synchronous commit with automatic failover</span></span>|  
|<span data-ttu-id="e6932-186">C</span><span class="sxs-lookup"><span data-stu-id="e6932-186">C</span></span>|<span data-ttu-id="e6932-187">Validation synchrone avec basculement manuel planifié uniquement</span><span class="sxs-lookup"><span data-stu-id="e6932-187">Synchronous commit with planned manual failover only</span></span>|  
|<span data-ttu-id="e6932-188">D</span><span class="sxs-lookup"><span data-stu-id="e6932-188">D</span></span>|<span data-ttu-id="e6932-189">Validation asynchrone (avec basculement forcé uniquement)</span><span class="sxs-lookup"><span data-stu-id="e6932-189">Asynchronous commit (with only forced failover)</span></span>|  
  
 <span data-ttu-id="e6932-190">Le comportement du basculement pour chaque réplica secondaire dépend du réplica de disponibilité qui correspond actuellement au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-190">The failover behavior for each secondary replica depends on which availability replica is currently the primary replica.</span></span> <span data-ttu-id="e6932-191">En principe, pour un réplica secondaire donné, le comportement de basculement est le pire cas pour le réplica principal actuel.</span><span class="sxs-lookup"><span data-stu-id="e6932-191">Basically, for a given secondary replica, the failover behavior is the worst case given the current primary replica.</span></span> <span data-ttu-id="e6932-192">L'illustration suivante montre comment le comportement de basculement des réplicas secondaires varie selon le réplica principal actuel, et indique s'il est configuré pour le mode de validation asynchrone (avec basculement forcé uniquement) ou le mode de validation synchrone (avec ou sans basculement automatique).</span><span class="sxs-lookup"><span data-stu-id="e6932-192">The following figure illustrates how the failover behavior of secondary replicas varies depending on the current primary replica, and whether it is configured for asynchronous-commit mode (with only forced failover) or synchronous-commit mode (with or without automatic failover).</span></span>  
  
 <span data-ttu-id="e6932-193">![Effet de la configuration du réplica principal sur le basculement](../../media/aoag-failoversetexample.gif "Effet de la configuration du réplica principal sur le basculement")</span><span class="sxs-lookup"><span data-stu-id="e6932-193">![How primary replica configuration affects failover](../../media/aoag-failoversetexample.gif "How primary replica configuration affects failover")</span></span>  
  
##  <a name="automatic-failover"></a><a name="AutomaticFailover"></a> <span data-ttu-id="e6932-194">Automatic Failover</span><span class="sxs-lookup"><span data-stu-id="e6932-194">Automatic Failover</span></span>  
 <span data-ttu-id="e6932-195">Un basculement automatique entraîne la transition automatique d'un réplica secondaire qualifié vers le rôle principal une fois que le réplica principal n'est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="e6932-195">An automatic failover causes a qualified secondary replica to automatically transition to the primary role after the primary replica becomes unavailable.</span></span> <span data-ttu-id="e6932-196">Le basculement automatique convient idéalement lorsque le nœud WSFC qui héberge le réplica principal est local au nœud qui héberge le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-196">Automatic failover is best suited when the WSFC node that hosts the primary replica is local to the node that hosts the secondary replica.</span></span> <span data-ttu-id="e6932-197">Cela est dû au fait que la synchronisation des données fonctionne mieux avec une faible latence de message entre les ordinateurs et parce que les connexions clientes peuvent rester locales.</span><span class="sxs-lookup"><span data-stu-id="e6932-197">This is because data synchronization works best with low message latency between computers and because client connections can remain local.</span></span>  
  
  
###  <a name="conditions-required-for-an-automatic-failover"></a><a name="RequiredConditions"></a> <span data-ttu-id="e6932-198">Conditions requises pour un basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-198">Conditions Required for an Automatic Failover</span></span>  
 <span data-ttu-id="e6932-199">Le basculement automatique intervient uniquement dans les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="e6932-199">Automatic failover occurs only under the following conditions:</span></span>  
  
-   <span data-ttu-id="e6932-200">Il existe un groupe de basculements automatiques.</span><span class="sxs-lookup"><span data-stu-id="e6932-200">An automatic failover set exists.</span></span> <span data-ttu-id="e6932-201">Ce groupe se compose d’un réplica principal et d’un réplica secondaire (la *cible du basculement automatique*) qui sont tous les deux configurés pour le mode de validation synchrone et sont définis en mode de basculement automatique (AUTOMATIC).</span><span class="sxs-lookup"><span data-stu-id="e6932-201">This set consists of a primary replica and a secondary replica (the *automatic failover target*) that are both configured for synchronous-commit mode and set to AUTOMATIC failover.</span></span> <span data-ttu-id="e6932-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  Si le réplica principal est défini en vue d’un basculement manuel (MANUAL), le basculement automatique ne peut pas se produire, même si un réplica secondaire est défini sur le basculement automatique (AUTOMATIC).</span><span class="sxs-lookup"><span data-stu-id="e6932-202">HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6fe88e12-4df1-4025-ba24-7579635ccecf\\\HTM\\\html\\\29e0ac5d-eb58-4801-82b9-e278f08db920"  If the primary replica is set MANUAL failover, automatic failover cannot occur, even if a secondary replica is set to AUTOMATIC failover.</span></span>  
  
     <span data-ttu-id="e6932-203">Pour plus d’informations, consultez [Modes de disponibilité &#40;groupes de disponibilité AlwaysOn&#41;](availability-modes-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-203">For more information, see [Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md).</span></span>  
  
-   <span data-ttu-id="e6932-204">L'état de synchronisation de la cible de basculement automatique est sain (cela indique que chaque base de données secondaire sur la cible de basculement est synchronisée avec sa base de données primaire correspondante).</span><span class="sxs-lookup"><span data-stu-id="e6932-204">The automatic failover target has a healthy synchronization state (this indicates that every secondary database on the failover target is synchronized with its corresponding primary database).</span></span>  
  
    > [!TIP]  
    >  <span data-ttu-id="e6932-205">Les groupes de disponibilité AlwaysOn surveillent l'intégrité des deux réplicas dans un groupe de basculements automatiques.</span><span class="sxs-lookup"><span data-stu-id="e6932-205">AlwaysOn Availability Groups monitors the health of both replicas in an automatic failover set.</span></span> <span data-ttu-id="e6932-206">Si l'un ou l'autre réplica échoue, l'état d'intégrité du groupe de disponibilité est défini comme critique (CRITICAL).</span><span class="sxs-lookup"><span data-stu-id="e6932-206">If either replica fails, the availability group's health state is set to CRITICAL.</span></span> <span data-ttu-id="e6932-207">Si le réplica secondaire échoue, le basculement automatique n'est pas possible car la cible de basculement automatique n'est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="e6932-207">If the secondary replica fails, automatic failover is not possible because the automatic failover target is unavailable.</span></span> <span data-ttu-id="e6932-208">Si le réplica principal échoue, le groupe de disponibilité bascule vers le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-208">If the primary replica fails, the availability group will fail over to the secondary replica.</span></span> <span data-ttu-id="e6932-209">Tant que le réplica principal précédent n'est pas à nouveau en ligne, il n'existe aucune cible de basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="e6932-209">Until the former primary replica comes online, no automatic failover target exists.</span></span> <span data-ttu-id="e6932-210">Dans l'un et l'autre cas, pour garantir la disponibilité, dans le cas improbable d'une erreur de séquence, il est recommandé de configurer un réplica secondaire différent comme cible de basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="e6932-210">In either case, to ensure availability in the unlikely case of a sequential failure, we recommend that you configure a different secondary replica as the automatic failover target.</span></span>  
    >   
    >  <span data-ttu-id="e6932-211">Pour plus d’informations, consultez [Utiliser les stratégies AlwaysOn pour afficher l’intégrité d’un groupe de disponibilité &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) et [Modifier le mode de basculement d’un réplica de disponibilité &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-211">For more information, see [Use AlwaysOn Policies to View the Health of an Availability Group &#40;SQL Server&#41;](use-always-on-policies-to-view-the-health-of-an-availability-group-sql-server.md) and [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
-   <span data-ttu-id="e6932-212">Le cluster de basculement Windows Server (WSFC) a le quorum.</span><span class="sxs-lookup"><span data-stu-id="e6932-212">The Windows Server Failover Clustering (WSFC) cluster has quorum.</span></span> <span data-ttu-id="e6932-213">Pour plus d’informations, consultez [Modes de quorum WSFC et configuration de vote &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-213">For more information, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
-   <span data-ttu-id="e6932-214">Le réplica principal n'est plus disponible, et les niveaux de condition de basculement définis par votre stratégie de basculement souple ont été atteints.</span><span class="sxs-lookup"><span data-stu-id="e6932-214">The primary replica has become unavailable, and the failover-condition levels defined by your the flexible failover policy have been met.</span></span> <span data-ttu-id="e6932-215">Pour plus d’informations sur les niveaux de condition de basculement, consultez [Stratégie flexible pour le basculement automatique d’un groupe de disponibilité &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-215">For information about failover-condition levels, see [Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;](flexible-automatic-failover-policy-availability-group.md).</span></span>  
  
###  <a name="how-automatic-failover-works"></a><a name="HowAutoFoWorks"></a> <span data-ttu-id="e6932-216">Fonctionnement du basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-216">How Automatic Failover Works</span></span>  
 <span data-ttu-id="e6932-217">Un basculement automatique initie la série d'actions suivante :</span><span class="sxs-lookup"><span data-stu-id="e6932-217">An automatic failover initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="e6932-218">Si l'instance de serveur qui héberge le réplica principal actuel est encore en cours d'exécution, elle modifie l'état des bases de données primaires en DISCONNECTED et déconnecte tous les clients.</span><span class="sxs-lookup"><span data-stu-id="e6932-218">If the server instance that is hosting the current primary replica is still running, it changes the state of the primary databases to DISCONNECTED and disconnects all clients.</span></span>  
  
2.  <span data-ttu-id="e6932-219">Si des enregistrements de journal sont en attente dans les files de récupération sur le réplica secondaire cible, le réplica secondaire applique les enregistrements de journal restants afin de terminer la restauration par progression des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-219">If any log records are waiting in recovery queues on the target secondary replica, the secondary replica applies the remaining log records to finish rolling forward the secondary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e6932-220">Le temps nécessaire pour appliquer le journal à une base de données particulière dépend de la vitesse du système, de la charge de travail récente et de la quantité de journal dans la file de récupération</span><span class="sxs-lookup"><span data-stu-id="e6932-220">The amount of time required to apply the log to a given database depends on the speed of the system, the recent work load, and the amount of log in the recovery queue.</span></span>  
  
3.  <span data-ttu-id="e6932-221">Le réplica secondaire précédent joue alors le rôle principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-221">The former secondary replica transitions to the primary role.</span></span> <span data-ttu-id="e6932-222">Ses bases de données deviennent les bases de données primaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-222">Its databases become the primary databases.</span></span> <span data-ttu-id="e6932-223">Le nouveau réplica principal restaure toutes les transactions non validées (phase de restauration de récupération) le plus rapidement possible.</span><span class="sxs-lookup"><span data-stu-id="e6932-223">The new primary replica rolls back any uncommitted transactions (the undo phase of recovery) as quickly as possible.</span></span> <span data-ttu-id="e6932-224">Les verrous isolent ces transactions non validées, ce qui permet une restauration en arrière-plan pendant que les clients utilisent la base de données.</span><span class="sxs-lookup"><span data-stu-id="e6932-224">Locks isolate these uncommitted transactions, allowing roll back to occur in the background while clients use the database.</span></span> <span data-ttu-id="e6932-225">Ce processus ne restaure pas les transactions validées.</span><span class="sxs-lookup"><span data-stu-id="e6932-225">This process does not roll back any committed transactions.</span></span>  
  
     <span data-ttu-id="e6932-226">Avant qu'une base de données secondaire donnée soit connectée, elle est brièvement marquée comme NOT_SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-226">Until a given secondary database is connected, it is briefly marked as NOT_SYNCHRONIZED.</span></span> <span data-ttu-id="e6932-227">Avant le démarrage de la récupération de restauration, les bases de données secondaires peuvent se connecter aux nouvelles bases de données primaires et passer rapidement à l'état SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-227">Before the rollback recovery starts, secondary databases can connect to the new primary databases and quickly transition to the SYNCHRONIZED state.</span></span> <span data-ttu-id="e6932-228">Le meilleur cas est généralement celui où un troisième réplica avec validation synchrone reste dans le rôle secondaire après le basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-228">The best case is usually for a third synchronous-commit replica that remains in the secondary role after the failover.</span></span>  
  
4.  <span data-ttu-id="e6932-229">Par la suite, lorsque l'instance de serveur qui héberge le réplica principal précédent redémarre, il identifie qu'un autre réplica de disponibilité joue maintenant le rôle principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-229">Later, when the server instance that is hosting the former primary replica restarts, it recognizes that another availability replica now owns the primary role.</span></span> <span data-ttu-id="e6932-230">Le réplica principal précédent joue à présent le rôle secondaire, et ses bases de données deviennent des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-230">The former primary replica transitions to the secondary role, and its databases become secondary databases.</span></span> <span data-ttu-id="e6932-231">Le nouveau réplica secondaire se connecte au réplica principal actuel et rattrape sa base de données pour qu'elle soit au niveau des bases de données primaires actuelles le plus rapidement possible.</span><span class="sxs-lookup"><span data-stu-id="e6932-231">The new secondary replica connects to the current primary replica and catches its database up to the current primary databases as quickly as possible.</span></span> <span data-ttu-id="e6932-232">Dès que le nouveau réplica secondaire a resynchronisé ses bases de données, le basculement est à nouveau possible, mais en sens inverse.</span><span class="sxs-lookup"><span data-stu-id="e6932-232">As soon as the new secondary replica has resynchronized its databases, failover is again possible, in the reverse direction.</span></span>  
  
###  <a name="to-configure-automatic-failover"></a><a name="EnableAutoFo"></a> <span data-ttu-id="e6932-233">Pour configurer un basculement automatique</span><span class="sxs-lookup"><span data-stu-id="e6932-233">To Configure Automatic Failover</span></span>  
 <span data-ttu-id="e6932-234">Un réplica de disponibilité peut être configuré pour prendre en charge le basculement automatique à tout moment.</span><span class="sxs-lookup"><span data-stu-id="e6932-234">An availability replica can be configured to support automatic failover at any point.</span></span>  
  
 <span data-ttu-id="e6932-235">**Pour configurer un basculement automatique**</span><span class="sxs-lookup"><span data-stu-id="e6932-235">**To configure automatic failover**</span></span>  
  
1.  <span data-ttu-id="e6932-236">Vérifiez que le réplica secondaire est configuré pour utiliser le mode de disponibilité avec validation synchrone.</span><span class="sxs-lookup"><span data-stu-id="e6932-236">Ensure that the secondary replica is configured to use the synchronous-commit availability mode.</span></span> <span data-ttu-id="e6932-237">Pour plus d’informations, consultez [Modifier le mode de disponibilité d’un réplica de disponibilité &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-237">For more information, see [Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;](change-the-availability-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="e6932-238">Définissez le basculement en mode automatique.</span><span class="sxs-lookup"><span data-stu-id="e6932-238">Set the failover mode to automatic.</span></span> <span data-ttu-id="e6932-239">Pour plus d’informations, consultez [Modifier le mode de basculement d’un réplica de disponibilité &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-239">For more information, see [Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;](change-the-failover-mode-of-an-availability-replica-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="e6932-240">Si vous le souhaitez, modifiez la stratégie de basculement flexible du groupe de disponibilité pour spécifier les types d'échecs qui peuvent déclencher un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="e6932-240">Optionally, change the flexible failover policy of the availability group to specify the sorts of failures that can cause an automatic failover to occur.</span></span> <span data-ttu-id="e6932-241">Pour plus d’informations, consultez [Configurer la stratégie de basculement flexible pour contrôler les conditions du basculement automatique &#40;groupes de disponibilité AlwaysOn&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Stratégie de basculement pour les instances de cluster de basculement](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-241">For more information, see [Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;](configure-flexible-automatic-failover-policy.md) HYPERLINK "file:///C:\\\Users\\\marshow\\\AppData\\\Local\\\Temp\\\DxEditor\\\DduePreview\\\Default\\\6a8d98a9-6e6a-40d1-9809-efa9013d7452\\\HTM\\\html\\\1ed564b4-9835-4245-ae35-9ba67419a4ce"  and [Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md).</span></span>  
  
##  <a name="planned-manual-failover-without-data-loss"></a><a name="ManualFailover"></a> <span data-ttu-id="e6932-242">Basculement manuel planifié (sans perte de données)</span><span class="sxs-lookup"><span data-stu-id="e6932-242">Planned Manual Failover (Without Data Loss)</span></span>  
 <span data-ttu-id="e6932-243">Un basculement manuel provoque la transition d'un réplica secondaire synchronisé vers le rôle principal après qu'un administrateur de base de données a émis une commande de basculement manuel sur l'instance de serveur qui héberge le réplica secondaire cible.</span><span class="sxs-lookup"><span data-stu-id="e6932-243">A manual failover causes a synchronized secondary replica to transition to the primary role after a database administrator issues a manual-failover command on the server instance that hosts the target secondary replica.</span></span> <span data-ttu-id="e6932-244">Pour prendre en charge le basculement manuel, le réplica secondaire et le réplica principal actuel doivent tous deux être configurés pour le mode de validation synchrone, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="e6932-244">To support manual failover, the secondary replica and the current primary replica must both be configured for synchronous-commit mode, if any.</span></span> <span data-ttu-id="e6932-245">Chaque base de données secondaire sur le réplica de disponibilité doit être jointe au groupe de disponibilité et être synchronisée avec sa base de données primaire correspondante (autrement dit, le réplica secondaire doit être synchronisé).</span><span class="sxs-lookup"><span data-stu-id="e6932-245">Every secondary database on the availability replica must be joined to the availability group and synchronized with its corresponding primary database (that is, the secondary replica must be synchronized).</span></span> <span data-ttu-id="e6932-246">Cela garantit que chaque transaction validée sur une base de données primaire précédente a également été validée sur la nouvelle base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-246">This guarantees that every transaction that was committed on a former primary database has also been committed on the new primary database.</span></span> <span data-ttu-id="e6932-247">Par conséquent, les nouvelles bases de données primaires sont identiques aux anciennes bases de données primaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-247">Therefore, the new primary databases are identical to the old primary databases.</span></span>  
  
 <span data-ttu-id="e6932-248">L'illustration suivante montre les étapes d'un basculement planifié :</span><span class="sxs-lookup"><span data-stu-id="e6932-248">The following figure illustrates the stages of a planned failover:</span></span>  
  
1.  <span data-ttu-id="e6932-249">Avant le basculement, le réplica principal est hébergé par l'instance de serveur sur `Node01`.</span><span class="sxs-lookup"><span data-stu-id="e6932-249">Before the failover, the primary replica is hosted by the server instance on `Node01`.</span></span>  
  
2.  <span data-ttu-id="e6932-250">C'est l'administrateur de base de données qui initie un basculement planifié.</span><span class="sxs-lookup"><span data-stu-id="e6932-250">A database administrator initiates a planned failover.</span></span> <span data-ttu-id="e6932-251">La cible de basculement est le réplica de disponibilité hébergé par l'instance de serveur sur `Node02`.</span><span class="sxs-lookup"><span data-stu-id="e6932-251">The failover target is the availability replica hosted by the server instance on `Node02`.</span></span>  
  
3.  <span data-ttu-id="e6932-252">La cible de basculement (sur `Node02`) devient le nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-252">The failover target (on `Node02`) becomes the new primary replica.</span></span> <span data-ttu-id="e6932-253">Comme il s'agit d'un basculement planifié, le réplica principal précédent passe sur le rôle secondaire pendant le basculement et met immédiatement ses bases de données en ligne comme bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-253">Because this is a planned failover, the former primary replica switches to the secondary role during the failover and brings its databases online as secondary databases immediately.</span></span>  
  
 <span data-ttu-id="e6932-254">![Illustration d’un basculement manuel planifié](../../media/aoag-plannedmanualfailover.gif "Illustration d’un basculement manuel planifié")</span><span class="sxs-lookup"><span data-stu-id="e6932-254">![Illustation of a planned manual failover](../../media/aoag-plannedmanualfailover.gif "Illustation of a planned manual failover")</span></span>  
  
  
###  <a name="conditions-required-for-a-manual-failover"></a><a name="ManualFailoverConditions"></a> <span data-ttu-id="e6932-255">Conditions requises pour un basculement manuel</span><span class="sxs-lookup"><span data-stu-id="e6932-255">Conditions Required for a Manual Failover</span></span>  
 <span data-ttu-id="e6932-256">Pour prendre en charge un basculement manuel, le réplica principal actuel doit être défini en mode de validation synchrone et un réplica secondaire doit être :</span><span class="sxs-lookup"><span data-stu-id="e6932-256">To support a manual failover, the current primary replica must be set to synchronous-commit mode and a secondary replica must be:</span></span>  
  
-   <span data-ttu-id="e6932-257">configuré pour le mode de validation synchrone ;</span><span class="sxs-lookup"><span data-stu-id="e6932-257">Configured for synchronous-commit mode.</span></span>  
  
-   <span data-ttu-id="e6932-258">actuellement synchronisé avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-258">Currently synchronized with the primary replica.</span></span>  
  
 <span data-ttu-id="e6932-259">Pour basculer manuellement un groupe de disponibilité, vous devez être connecté au réplica secondaire qui va devenir le nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-259">To manually fail over an availability group, you must be connected to the secondary replica that is to become the new primary replica.</span></span>  
  
###  <a name="how-a-planned-manual-failover-works"></a><a name="ManualFailoverHowWorks"></a> <span data-ttu-id="e6932-260">Fonctionnement d'un basculement manuel planifié</span><span class="sxs-lookup"><span data-stu-id="e6932-260">How a Planned Manual Failover Works</span></span>  
 <span data-ttu-id="e6932-261">Un basculement manuel planifié, qui doit être initié sur le réplica secondaire cible, démarre la séquence d'actions suivante :</span><span class="sxs-lookup"><span data-stu-id="e6932-261">A planned manual failover, which must be initiated on the target secondary replica, initiates the following sequence of actions:</span></span>  
  
1.  <span data-ttu-id="e6932-262">Pour vous assurer qu'aucune nouvelle transaction utilisateur ne se produira sur les bases de données primaires d'origine, le cluster WSFC envoie une demande de mise hors connexion au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-262">To ensure that no new user transactions occur on the original primary databases, the WSFC cluster sends a request to the primary replica to go offline.</span></span>  
  
2.  <span data-ttu-id="e6932-263">Si un journal est en attente dans la file de récupération d'une base de données secondaire, le réplica secondaire termine la restauration par progression de cette base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-263">If any log is waiting in the recovery queue of any secondary database, the secondary replica finishes rolling forward that secondary database.</span></span> <span data-ttu-id="e6932-264">Le temps requis pour cette opération dépend de la vitesse du système, de la charge de travail récente et de la quantité de journal dans la file de récupération.</span><span class="sxs-lookup"><span data-stu-id="e6932-264">The amount of time required depends on the speed of the system, the recent workload, and the amount of log in the recovery queue.</span></span> <span data-ttu-id="e6932-265">Pour connaître la taille actuelle de la file de récupération, utilisez le compteur de performance **File de récupération** .</span><span class="sxs-lookup"><span data-stu-id="e6932-265">To learn the current size of the recovery queue, use the **Recovery Queue** performance counter.</span></span> <span data-ttu-id="e6932-266">Pour plus d’informations, consultez [SQL Server, réplica de base de données](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-266">For more information, see [SQL Server, Database Replica](../../../relational-databases/performance-monitor/sql-server-database-replica.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e6932-267">La durée de basculement peut être régulée en limitant la taille de la file de récupération.</span><span class="sxs-lookup"><span data-stu-id="e6932-267">The failover time can be regulated by limiting the size of the recovery queue.</span></span> <span data-ttu-id="e6932-268">Cependant, cela peut entraîner un ralentissement du réplica principal afin de permettre au réplica secondaire de suivre.</span><span class="sxs-lookup"><span data-stu-id="e6932-268">However, this can cause the primary replica to slow down to allow the secondary replica to keep up.</span></span>  
  
3.  <span data-ttu-id="e6932-269">Le réplica secondaire devient le nouveau réplica principal, tandis que le réplica principal précédent devient le nouveau réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-269">The secondary replica becomes the new primary replica, and the former primary replica becomes the new secondary replica.</span></span>  
  
4.  <span data-ttu-id="e6932-270">Le nouveau réplica principal restaure toutes les transactions non validées et met ses bases de données en ligne comme bases de données primaires. Toutes les bases de données secondaires sont brièvement marquées avec l’état NOT_SYNCHRONIZED jusqu’à ce qu’elles se connectent et se resynchronisent aux nouvelles bases de données primaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-270">The new primary replica rolls back any uncommitted transactions and brings its databases online as the primary databases.All secondary databases are briefly marked as NOT SYNCHRONIZED until they connect and resynchronize to the new primary databases.</span></span> <span data-ttu-id="e6932-271">Ce processus ne restaure pas les transactions validées.</span><span class="sxs-lookup"><span data-stu-id="e6932-271">This process does not roll back any committed transactions.</span></span>  
  
5.  <span data-ttu-id="e6932-272">Lorsque le réplica principal précédent revient en ligne, il prend le rôle secondaire, et la base de données primaire précédente devient la base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-272">When the former primary replica comes back online, it takes on the secondary role, and the former primary database becomes the secondary database.</span></span> <span data-ttu-id="e6932-273">Le nouveau réplica secondaire resynchronise rapidement les nouvelles bases de données secondaires avec les bases de données primaires correspondantes.</span><span class="sxs-lookup"><span data-stu-id="e6932-273">The new secondary replica quickly resynchronizes the new secondary databases with the corresponding primary databases.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="e6932-274">Dès que le nouveau réplica secondaire a resynchronisé les bases de données, le basculement est à nouveau possible, mais en sens inverse.</span><span class="sxs-lookup"><span data-stu-id="e6932-274">As soon as the new secondary replica has resynchronized the databases, failover is again possible, but in the reverse direction.</span></span>  
  
 <span data-ttu-id="e6932-275">Après le basculement, les clients doivent se reconnecter à la base de données primaire actuelle.</span><span class="sxs-lookup"><span data-stu-id="e6932-275">After failover, clients must reconnect to the current primary database.</span></span> <span data-ttu-id="e6932-276">Pour plus d’informations, consultez [Écouteurs de groupe de disponibilité, connectivité client et basculement d’application &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-276">For more information, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
###  <a name="maintaining-availability-during-upgrades"></a><a name="ManualFailoverDuringUpgrades"></a> <span data-ttu-id="e6932-277">Maintien de la disponibilité lors des mises à niveau</span><span class="sxs-lookup"><span data-stu-id="e6932-277">Maintaining Availability During Upgrades</span></span>  
 <span data-ttu-id="e6932-278">L'administrateur de base de données de vos groupes de disponibilité peut faire appel à des basculements manuels pour maintenir la disponibilité de la base de données lorsque vous mettez à niveau le matériel ou le logiciel.</span><span class="sxs-lookup"><span data-stu-id="e6932-278">The database administrator for your availability groups can use manual failovers to maintain database availability when you upgrade hardware or software.</span></span> <span data-ttu-id="e6932-279">Pour utiliser un groupe de disponibilité pour les mises à niveau logicielles, l'instance de serveur et/ou le nœud ordinateur qui héberge le réplica secondaire cible doivent avoir déjà reçu les mises à niveau.</span><span class="sxs-lookup"><span data-stu-id="e6932-279">To use an availability group for software upgrades, the server instance and/or computer node that hosts the target secondary replica must have already received the upgrades.</span></span> <span data-ttu-id="e6932-280">Pour plus d’informations, consultez [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-280">For more information, see [Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss](upgrading-always-on-availability-group-replica-instances.md).</span></span>  
  
##  <a name="forced-failover-with-possible-data-loss"></a><a name="ForcedFailover"></a> <span data-ttu-id="e6932-281">Basculement forcé (avec possible perte de données)</span><span class="sxs-lookup"><span data-stu-id="e6932-281">Forced Failover (with Possible Data Loss)</span></span>  
 <span data-ttu-id="e6932-282">Le basculement forcé d’un groupe de disponibilité (avec perte de données possible) est une méthode de récupération d’urgence qui vous permet d’utiliser un réplica secondaire en tant que serveur de secours actif. Le basculement forcé entraînant un risque de perte de données, il convient de l’utiliser avec prudence et parcimonie.</span><span class="sxs-lookup"><span data-stu-id="e6932-282">Forcing failover of an availability group (with possible data loss) is a disaster recovery method that allows you to use a secondary replica as a warm standby server.Because forcing failover risks possible data loss, it should be used cautiously and sparingly.</span></span> <span data-ttu-id="e6932-283">Nous recommandons de forcer le basculement uniquement si vous devez restaurer immédiatement le service sur vos base de données de disponibilité et que vous êtes prêt à courir le risque de perdre des données.</span><span class="sxs-lookup"><span data-stu-id="e6932-283">We recommend forcing failover only if you must restore service to your availability databases immediately and are willing to risk losing data.</span></span> <span data-ttu-id="e6932-284">Pour plus d’informations sur les conditions préalables requises et les recommandations pour forcer un basculement et pour obtenir un exemple de scénario qui utilise un basculement forcé pour effectuer une récupération suite à une défaillance irrémédiable, consultez [Effectuer un basculement manuel forcé d’un groupe de disponibilité &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-284">For more information about the prerequisites and recommendations for forcing failover and for an example scenario that uses a forced failover to recover from a catastrophic failure, see [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e6932-285">Le basculement forcé exige que le cluster WSFC dispose d'un quorum.</span><span class="sxs-lookup"><span data-stu-id="e6932-285">Forcing failover requires that the WSFC cluster have quorum.</span></span> <span data-ttu-id="e6932-286">Pour plus d’informations sur la configuration du quorum et le quorum forcé, consultez [Clustering de basculement Windows Server &#40;WSFC&#41; avec SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-286">For information about configuring quorum and forcing quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
  
###  <a name="how-forced-failover-works"></a><a name="ForcedFailoverHowWorks"></a> <span data-ttu-id="e6932-287">Fonctionnement du basculement forcé</span><span class="sxs-lookup"><span data-stu-id="e6932-287">How Forced Failover Works</span></span>  
 <span data-ttu-id="e6932-288">Le fait de forcer le basculement initie la transition du rôle principal sur un réplica cible dont le rôle est dans l'état SECONDARY ou RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="e6932-288">Forcing failover initiates a transition of the primary role to a target replica whose role is in the SECONDARY or RESOLVING state.</span></span> <span data-ttu-id="e6932-289">La cible de basculement devient le nouveau réplica principal et sert immédiatement ses copies de base de données aux clients.</span><span class="sxs-lookup"><span data-stu-id="e6932-289">The failover target becomes the new primary replica and immediately serves its copies of the databases to clients.</span></span> <span data-ttu-id="e6932-290">Lorsque le réplica principal précédent est disponible, il adopte le rôle secondaire, et ses bases de données deviennent des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-290">When the former primary replica becomes available, it will transition to the secondary role and its databases will become secondary databases.</span></span>  
  
 <span data-ttu-id="e6932-291">Toutes les bases de données secondaires (y compris les anciennes bases de données primaires, lorsqu'elles deviennent disponibles) sont interrompues (SUSPENDED).</span><span class="sxs-lookup"><span data-stu-id="e6932-291">All secondary databases (including the former primary databases, when they become available) are SUSPENDED.</span></span> <span data-ttu-id="e6932-292">En fonction de l'état précédent de synchronisation des données d'une base de données secondaire interrompue, il peut convenir pour récupérer des données validées manquantes pour cette base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-292">Depending on the previous data synchronization state of a suspended secondary database, it might be suitable for salvaging missing committed data for that primary database.</span></span> <span data-ttu-id="e6932-293">Sur un réplica secondaire configuré pour autoriser l'accès en lecture seule, vous pouvez interroger les bases de données secondaires afin de découvrir manuellement des données manquantes.</span><span class="sxs-lookup"><span data-stu-id="e6932-293">On a secondary replica that is configured for read-only access, you can query the secondary databases to manually discover missing data.</span></span> <span data-ttu-id="e6932-294">Vous pouvez alors émettre des instructions [!INCLUDE[tsql](../../../includes/tsql-md.md)] sur les nouvelles bases de données primaires afin d'apporter les modifications nécessaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-294">Then you can issue [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements on the new primary databases to make any necessary changes.</span></span>  
  
###  <a name="risks-of-forcing-failover"></a><a name="ForcedFailoverRisks"></a> <span data-ttu-id="e6932-295">Risques posés par le basculement forcé</span><span class="sxs-lookup"><span data-stu-id="e6932-295">Risks of Forcing Failover</span></span>  
 <span data-ttu-id="e6932-296">Il est essentiel de comprendre que le basculement forcé peut entraîner la perte de données.</span><span class="sxs-lookup"><span data-stu-id="e6932-296">It is essential to understand that forcing failover can cause data loss.</span></span> <span data-ttu-id="e6932-297">La perte de données est possible car le réplica cible ne peut pas communiquer avec le réplica principal et, par conséquent, ne peut pas garantir la synchronisation des bases de données.</span><span class="sxs-lookup"><span data-stu-id="e6932-297">Data loss is possible because the target replica cannot communicate with the primary replica and, therefore, cannot guarantee that the databases are synchronized.</span></span> <span data-ttu-id="e6932-298">Le basculement forcé démarre un nouveau point de branchement de récupération.</span><span class="sxs-lookup"><span data-stu-id="e6932-298">Forcing failover starts a new recovery fork.</span></span> <span data-ttu-id="e6932-299">Étant donné que les base de données primaires d'origine et les bases de données secondaires sont situées sur différents branchements de récupération, chacune d'elles contient maintenant des données qui ne figurent pas dans l'autre base de données : chaque base de données primaire d'origine contient toutes les modifications qui n'avaient pas encore été envoyées de sa file d'attente d'envoi à l'ancienne base de données secondaire (le journal non envoyé) ; les anciennes bases de données secondaires contiennent toutes les modifications qui surviennent une fois le basculement forcé effectué.</span><span class="sxs-lookup"><span data-stu-id="e6932-299">Because the original primary databases and secondary databases are on different recovery forks, each of them now contains data that the other database does not contain: each original primary database contains whatever changes were not yet sent from its send queue to the former secondary database (the unsent log); the former secondary databases contain whatever changes occur after failover was forced.</span></span>  
  
 <span data-ttu-id="e6932-300">Si le basculement est forcé suite à une défaillance du réplica principal, le risque de perte de données varie selon que les journaux de transactions ont été envoyés ou non au réplica secondaire avant la défaillance.</span><span class="sxs-lookup"><span data-stu-id="e6932-300">If failover is forced because the primary replica has failed, potential data loss is depends on whether any transaction logs had not been sent to the secondary replica before the failure.</span></span> <span data-ttu-id="e6932-301">En mode de validation asynchrone, une accumulation du journal non envoyé est toujours possible.</span><span class="sxs-lookup"><span data-stu-id="e6932-301">Under the asynchronous-commit mode, accumulated unsent log is always a possibility.</span></span> <span data-ttu-id="e6932-302">En mode de validation synchrone, cela est possible uniquement tant que les bases de données secondaires ne sont pas synchronisées.</span><span class="sxs-lookup"><span data-stu-id="e6932-302">Under synchronous-commit mode, this is possible only until the secondary databases becomes synchronized.</span></span>  
  
 <span data-ttu-id="e6932-303">Le tableau suivant résume la possibilité de perte de données pour une base de données particulière sur le réplica vers lequel vous forcez le basculement.</span><span class="sxs-lookup"><span data-stu-id="e6932-303">The following table summarizes the possibility of data loss for a particular database on the replica to which you force failover.</span></span>  
  
|<span data-ttu-id="e6932-304">Mode de disponibilité d'un réplica secondaire</span><span class="sxs-lookup"><span data-stu-id="e6932-304">Availability mode of Secondary Replica</span></span>|<span data-ttu-id="e6932-305">Las base de données est-elle synchronisée ?</span><span class="sxs-lookup"><span data-stu-id="e6932-305">Is database synchronized?</span></span>|<span data-ttu-id="e6932-306">Une perte de données est-elle possible ?</span><span class="sxs-lookup"><span data-stu-id="e6932-306">Is data loss possible?</span></span>|  
|--------------------------------------------|-------------------------------|----------------------------|  
|<span data-ttu-id="e6932-307">Validation synchrone</span><span class="sxs-lookup"><span data-stu-id="e6932-307">Synchronous-commit</span></span>|<span data-ttu-id="e6932-308">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-308">Yes</span></span>|<span data-ttu-id="e6932-309">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-309">No</span></span>|  
|<span data-ttu-id="e6932-310">Validation synchrone</span><span class="sxs-lookup"><span data-stu-id="e6932-310">Synchronous-commit</span></span>|<span data-ttu-id="e6932-311">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-311">No</span></span>|<span data-ttu-id="e6932-312">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-312">Yes</span></span>|  
|<span data-ttu-id="e6932-313">Validation asynchrone</span><span class="sxs-lookup"><span data-stu-id="e6932-313">Asynchronous-commit</span></span>|<span data-ttu-id="e6932-314">Non</span><span class="sxs-lookup"><span data-stu-id="e6932-314">No</span></span>|<span data-ttu-id="e6932-315">Oui</span><span class="sxs-lookup"><span data-stu-id="e6932-315">Yes</span></span>|  
||||  
  
 <span data-ttu-id="e6932-316">Les bases de données secondaires suivent uniquement deux branchements de récupération. Par conséquent, si vous exécutez plusieurs basculements forcés, il est possible que certaines bases de données secondaires qui ont démarré la synchronisation des données avec le basculement forcé précédent, ne puissent pas être reprises.</span><span class="sxs-lookup"><span data-stu-id="e6932-316">Secondary databases track only two recovery forks, so if you perform multiple forced failovers, any secondary database that did start data synchronization with the previous force failover might not be able to resume.</span></span> <span data-ttu-id="e6932-317">Si cela se produit, les bases de données secondaires qui ne peuvent pas être reprises devront être supprimées du groupe de disponibilité, restaurées au moment approprié et rejoindre le groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="e6932-317">If this occurs, any secondary databases that cannot be resumed will need to be removed from the availability group, restored to the correct point in time, and rejoined to the availability group.</span></span> <span data-ttu-id="e6932-318">Une restauration ne fonctionnera pas entre plusieurs branchements de récupération, par conséquent, vous devez veiller à sauvegarder le journal après l'exécution de plus d'un basculement forcé.</span><span class="sxs-lookup"><span data-stu-id="e6932-318">A restore will not work across multiple recovery forks, therefore, be sure to perform a log backup after performing more than one forced failover.</span></span>  
  
###  <a name="why-forced-failover-is-required-after-forcing-quorum"></a><a name="WhyFFoPostForcedQuorum"></a> <span data-ttu-id="e6932-319">Raisons pour lesquelles le basculement forcé est requis après avoir forcé le quorum</span><span class="sxs-lookup"><span data-stu-id="e6932-319">Why Forced Failover is Required After Forcing Quorum</span></span>  
 <span data-ttu-id="e6932-320">Après avoir forcé le quorum sur le cluster WSFC (*quorum forcé*), vous devez forcer le basculement de chaque groupe de disponibilité (avec perte possible de données).</span><span class="sxs-lookup"><span data-stu-id="e6932-320">After quorum is forced on the WSFC cluster (*forced quorum*) you need to perform a forced failover (with possible data loss) on each availability group.</span></span> <span data-ttu-id="e6932-321">Le basculement forcé est requis, car l'état réel des valeurs de cluster WSFC peut avoir été perdu.</span><span class="sxs-lookup"><span data-stu-id="e6932-321">The forced failover is required because the real state of the WSFC cluster values might have been lost.</span></span> <span data-ttu-id="e6932-322">Il est nécessaire d'empêcher les basculements normaux après un quorum forcé, car un réplica secondaire non synchronisé pourrait apparaître comme synchronisé sur le cluster WSFC reconfiguré.</span><span class="sxs-lookup"><span data-stu-id="e6932-322">Preventing normal failovers after a forced quorum is required because of the possibility than an unsynchronized secondary replica would appear to be synchronized on the reconfigured WSFC cluster.</span></span>  
  
 <span data-ttu-id="e6932-323">Par exemple, considérez un cluster WSFC qui héberge un groupe de disponibilité sur trois nœuds :  le nœud A héberge le réplica principal et les nœuds B et C hébergent un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-323">For example, consider a WSFC cluster that hosts an availability group on three nodes:  Node A hosts the primary replica and Node B and Node C each hosts a secondary replica.</span></span> <span data-ttu-id="e6932-324">Le nœud C est déconnecté du cluster WSFC tandis que le réplica secondaire local est SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-324">Node C gets disconnected from the WSFC cluster while the local secondary replica is SYNCHRONIZED.</span></span>  <span data-ttu-id="e6932-325">Mais le nœud A et le nœud B conservent un quorum sain et le groupe de disponibilité reste en ligne.</span><span class="sxs-lookup"><span data-stu-id="e6932-325">But Node A and Node B retain a healthy quorum and the availability group remains online.</span></span> <span data-ttu-id="e6932-326">Sur le nœud A, le réplica principal continue d'accepter les mises à jour, et sur le nœud B, le réplica secondaire continue d'être synchonisé avec le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-326">On Node A, the primary replica continues to accept updates, and on Node B, the secondary replica continues to synchronize with the primary replica.</span></span> <span data-ttu-id="e6932-327">Le réplica secondaire sur le nœud C n'est plus synchronisé et passe de plus en plus derrière le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-327">The secondary replica on Node C becomes unsynchronized and falls increasingly behind the primary replica.</span></span> <span data-ttu-id="e6932-328">Toutefois, étant donné que le nœud C est déconnecté, le réplica reste incorrectement dans l'état SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-328">However, because Node C is disconnected, the replica remains, incorrectly, in the SYNCHRONIZED state.</span></span>  
  
 <span data-ttu-id="e6932-329">Si le quorum est perdu et s’il est ensuite forcé sur le nœud A, l’état de synchronisation du groupe de disponibilité sur le cluster WSFC devrait être correct, et le réplica secondaire sur le nœud C apparaît comme UNSYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-329">If quorum is lost and is then forced on Node A, the synchronization state of the availability group on the WSFC cluster should be correct-with the secondary replica on Node C shown as UNSYNCHRONIZED.</span></span> <span data-ttu-id="e6932-330">Toutefois, si le quorum est forcé sur le nœud C, la synchronisation du groupe de disponibilité sera incorrecte.</span><span class="sxs-lookup"><span data-stu-id="e6932-330">However, if quorum is forced on Node C, the synchronization of the availability group will be incorrect.</span></span> <span data-ttu-id="e6932-331">L’état de synchronisation sur le cluster retrouve le même niveau que lorsque le nœud C a été déconnecté, et le réplica secondaire sur le nœud C apparaît *incorrectement* comme SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="e6932-331">The synchronization state on the cluster will have reverted back to when Node C was disconnected-with the secondary replica on Node C *incorrectly* shown as SYNCHRONIZED.</span></span> <span data-ttu-id="e6932-332">Puisque les basculements manuels planifiés garantissent la sécurité des données, ils ne sont pas autorisés pour ramener un groupe de disponibilité en ligne après qu'un quorum a été forcé.</span><span class="sxs-lookup"><span data-stu-id="e6932-332">Since planned manual failovers guarantee the safety of the data, they are disallowed for bring an availability group back online after quorum is forced.</span></span>  
  
###  <a name="tracking-potential-data-loss"></a><a name="TrackPotentialDataLoss"></a> <span data-ttu-id="e6932-333">Suivi de la perte de données potentielle</span><span class="sxs-lookup"><span data-stu-id="e6932-333">Tracking Potential Data Loss</span></span>  
 <span data-ttu-id="e6932-334">Lorsque le cluster WSFC a un quorum sain, vous pouvez estimer le risque potentiel actuel de perte de données sur les bases de données.</span><span class="sxs-lookup"><span data-stu-id="e6932-334">When the WSFC cluster has a healthy quorum, you can estimate the current potential for data loss on databases.</span></span> <span data-ttu-id="e6932-335">Pour un réplica secondaire donné, le risque potentiel actuel de perte de données dépend du décalage des bases de données secondaires par rapport aux bases de données primaires correspondantes.</span><span class="sxs-lookup"><span data-stu-id="e6932-335">For a given secondary replica, the current potential for data loss depends on how far the local secondary databases are lagging behind the corresponding primary databases.</span></span> <span data-ttu-id="e6932-336">Étant donné que le décalage varie dans le temps, nous vous recommandons de suivre régulièrement la perte de données potentielle de vos bases de données secondaires non synchronisées.</span><span class="sxs-lookup"><span data-stu-id="e6932-336">Because the amount of lag varies over time, we recommend that you periodically track potential data loss for your unsynchronized secondary databases.</span></span> <span data-ttu-id="e6932-337">Le suivi du décalage implique de comparer le LSN de dernière validation et l'Heure de dernière validation de chaque base de données primaire avec ses bases de données secondaires, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e6932-337">Tracking lag involves comparing the Last Commit LSN and Last Commit Time for each primary database and its secondary databases, as follows:</span></span>  
  
1.  <span data-ttu-id="e6932-338">Connectez-vous au réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-338">Connect to the primary replica.</span></span>  
  
2.  <span data-ttu-id="e6932-339">Interrogez les `last_commit_lsn` colonnes (LSN de la dernière transaction validée) et `last_commit_time` (heure des dernières validations) de la vue de gestion dynamique [sys. dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="e6932-339">Query the `last_commit_lsn` (LSN of the last committed transaction) and `last_commit_time` (time of the last commit) columns of the [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) dynamic management view.</span></span>  
  
3.  <span data-ttu-id="e6932-340">Comparez les valeurs retournées pour chaque base de données primaire et pour chacune de ses bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-340">Compare the values returned for each primary database and each of its secondary databases.</span></span> <span data-ttu-id="e6932-341">La différence entre leurs LSN de dernière validation indique le niveau du décalage.</span><span class="sxs-lookup"><span data-stu-id="e6932-341">The difference between their Last Commit LSNs indicate the amount of lag.</span></span>  
  
4.  <span data-ttu-id="e6932-342">Vous pouvez déclencher une alerte lorsque le niveau de décalage de la base de données, ou d'un ensemble de bases de données, dépasse le décalage maximal autorisé pour une période donnée.</span><span class="sxs-lookup"><span data-stu-id="e6932-342">You can trigger an alert when the amount of lag on a database or set of databases exceeds your desired maximum lag for a given period of time.</span></span> <span data-ttu-id="e6932-343">Par exemple, la requête peut être exécutée par une tâche qui s'exécute toutes les minutes sur chaque base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-343">For example, the query can be run by a job that executes every minute on each primary database.</span></span> <span data-ttu-id="e6932-344">Si la différence entre le `last_commit_time` de la base de données primaire et de chacune de ses bases de données secondaires dépasse l'objectif de point de récupération (RPO) (par exemple, 5 minutes) depuis la dernière exécution de la tâche, celle-ci peut déclencher une alerte.</span><span class="sxs-lookup"><span data-stu-id="e6932-344">If the difference between the `last_commit_time` of a primary database and any of its secondary databases has exceeded the recovery point objective (RPO) (for example, 5 minutes) since the last time the job executed, the job can raise an alert.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e6932-345">Lorsque le cluster WSFC n'a pas un quorum suffisant ou lorsque le quorum a été forcé, `last_commit_lsn` et `last_commit_time` ont la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="e6932-345">When the WSFC cluster lacks quorum or quorum has been forced, `last_commit_lsn` and `last_commit_time` are NULL.</span></span> <span data-ttu-id="e6932-346">Pour plus d’informations sur la façon d’éviter la perte de données après avoir forcé un quorum, consultez « Méthodes possibles pour éviter la perte de données après un quorum forcé » dans [Effectuer un basculement manuel forcé d’un groupe de disponibilité &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="e6932-346">For information about how you might be able to avoid data loss after you forced quorum, see "Potential Ways to Avoid Data Loss After Quorum is Forced" in [Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md).</span></span>  
  
###  <a name="managing-the-potential-data-loss"></a><a name="ForcedFailoverManagingDataLoss"></a> <span data-ttu-id="e6932-347">Gestion de la perte de données potentielle</span><span class="sxs-lookup"><span data-stu-id="e6932-347">Managing the Potential Data Loss</span></span>  
 <span data-ttu-id="e6932-348">Après un basculement forcé, toutes les bases de données secondaires sont interrompues.</span><span class="sxs-lookup"><span data-stu-id="e6932-348">After failover is forced, all secondary databases are suspended.</span></span> <span data-ttu-id="e6932-349">Cela inclut les anciennes bases de données principales, une fois que l'ancien réplica principal est repassé en ligne et découvre qu'il s'agit maintenant d'un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-349">This includes the former primary databases, after the former primary replica comes back online and discovers that it is now a secondary replica.</span></span> <span data-ttu-id="e6932-350">Vous devez reprendre manuellement chaque base de données interrompue individuellement sur chaque réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-350">You must manually resume each suspended database individually on each secondary replica.</span></span>  
  
 <span data-ttu-id="e6932-351">Une fois l'ancien réplica principal disponible, en supposant que ses bases de données ne soient pas endommagées, vous pouvez tenter de gérer la perte de données potentielle.</span><span class="sxs-lookup"><span data-stu-id="e6932-351">Once the former primary replica is available, assuming that its databases are undamaged, you can attempt to manage the potential data loss.</span></span> <span data-ttu-id="e6932-352">L'approche disponible pour gérer la perte de données potentielle varie selon que le réplica principal d'origine s'est connecté au nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-352">The available approach for managing potential data loss depends on whether the original primary replica has connected to the new primary replica.</span></span> <span data-ttu-id="e6932-353">En supposant que le réplica principal d'origine puisse accéder à la nouvelle instance principale, la reconnexion se produit automatiquement et de manière transparente.</span><span class="sxs-lookup"><span data-stu-id="e6932-353">Assuming that the original primary replica can access the new primary instance, reconnecting occurs automatically and transparently.</span></span>  
  
#### <a name="the-original-primary-replica-has-reconnected"></a><span data-ttu-id="e6932-354">Le réplica principal d'origine s'est reconnecté</span><span class="sxs-lookup"><span data-stu-id="e6932-354">The Original Primary Replica Has Reconnected</span></span>  
 <span data-ttu-id="e6932-355">En général, après une défaillance, lorsque le réplica principal d'origine redémarre, il se reconnecte rapidement à son partenaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-355">Typically, after a failure, when the original primary replica restarts it quickly reconnects to its partner.</span></span> <span data-ttu-id="e6932-356">Lors de la reconnexion, le réplica principal d'origine devient le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-356">On reconnecting, the original primary replica becomes the secondary replica.</span></span> <span data-ttu-id="e6932-357">Ses bases de données deviennent les bases de données secondaires et passent à l'état SUSPENDED.</span><span class="sxs-lookup"><span data-stu-id="e6932-357">Its databases becomes the secondary databases and enter the SUSPENDED state.</span></span> <span data-ttu-id="e6932-358">Les nouvelles bases de données secondaires ne seront pas restaurées sauf si vous les rétablissez.</span><span class="sxs-lookup"><span data-stu-id="e6932-358">The new secondary databases will not be not rolled back unless you resume them.</span></span>  
  
 <span data-ttu-id="e6932-359">Toutefois, les bases de données interrompues sont inaccessibles ; par conséquent, vous ne pouvez pas les inspecter afin d'évaluer les données qui seraient perdues si vous deviez reprendre une base de données en particulier.</span><span class="sxs-lookup"><span data-stu-id="e6932-359">However, the suspended databases are inaccessible, so you cannot inspect them to evaluate what data would be lost if you were to resume a given database.</span></span> <span data-ttu-id="e6932-360">La décision relative à la reprise ou à la suppression d'une base de données secondaire dépend donc de votre souhait d'accepter ou non le risque de perte de données, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e6932-360">Therefore, the decision on whether to resume or remove a secondary database depends on whether you are willing to accept any data loss, as follows:</span></span>  
  
-   <span data-ttu-id="e6932-361">Si la perte de données est inacceptable, vous devez supprimer les bases de données du groupe de disponibilité afin de les sauver.</span><span class="sxs-lookup"><span data-stu-id="e6932-361">If losing any data would be unacceptable, you should remove the databases from the availability group to salvage them.</span></span>  
  
     <span data-ttu-id="e6932-362">L'administrateur de base de données peut maintenant récupérer les bases de données primaires précédentes et tenter de récupérer les données qui auraient sinon été perdues.</span><span class="sxs-lookup"><span data-stu-id="e6932-362">The database administrator can now recover the former primary databases and attempt to recover the data that would have been lost.</span></span> <span data-ttu-id="e6932-363">Toutefois, lorsqu'une base de données primaire précédente est en ligne, elle diverge de la base de données primaire actuelle. Par conséquent, l'administrateur de base de données doit rendre la base de données supprimée ou la base de données primaire actuelle inaccessible aux clients afin d'éviter toute autre divergence des bases de données et empêcher les problèmes de basculement du client.</span><span class="sxs-lookup"><span data-stu-id="e6932-363">However, when a former primary database comes online, it is divergent from the current primary database, so the database administrator needs to make either the removed database or the current primary database inaccessible to clients to avoid further divergence of the databases and to prevent client-failover issues.</span></span>  
  
-   <span data-ttu-id="e6932-364">Si la perte de données est acceptable dans le cadre de vos objectifs professionnels, vous pouvez rétablir les bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-364">If losing data would be acceptable to your business goals, you can resume the secondary databases.</span></span>  
  
     <span data-ttu-id="e6932-365">La reprise d'une nouvelle base de données secondaire entraîne sa restauration en guise de première étape vers la synchronisation de la base de données.</span><span class="sxs-lookup"><span data-stu-id="e6932-365">Resuming a new secondary database causes it to be rolled back as the first step in synchronizing the database.</span></span> <span data-ttu-id="e6932-366">Si des enregistrements de journal se trouvaient dans la file d'attente d'envoi au moment de la défaillance, les transactions correspondantes sont perdues, même si elles ont été validées.</span><span class="sxs-lookup"><span data-stu-id="e6932-366">If any log records were waiting in the send queue at the time of failure, the corresponding transactions are lost, even if they were committed.</span></span>  
  
#### <a name="the-original-primary-replica-has-not-reconnected"></a><span data-ttu-id="e6932-367">Le réplica principal d'origine ne s'est pas reconnecté</span><span class="sxs-lookup"><span data-stu-id="e6932-367">The Original Primary Replica Has Not Reconnected</span></span>  
 <span data-ttu-id="e6932-368">Si vous pouvez empêcher momentanément le réplica principal d'origine de se reconnecter par le biais du réseau au nouveau réplica principal, vous pouvez inspecter les bases de données primaires d'origine afin d'évaluer les données qui seraient perdues en cas de reprise.</span><span class="sxs-lookup"><span data-stu-id="e6932-368">If you can temporarily prevent the original primary replica from reconnecting over the network to the new primary replica, you can inspect the original primary databases to evaluate what data would be lost if they were resumed.</span></span>  
  
-   <span data-ttu-id="e6932-369">Si la perte de données potentielle est acceptable</span><span class="sxs-lookup"><span data-stu-id="e6932-369">If the potential data loss is acceptable</span></span>  
  
     <span data-ttu-id="e6932-370">Permettez au réplica principal d'origine se reconnecter au nouveau réplica principal.</span><span class="sxs-lookup"><span data-stu-id="e6932-370">Allow the original primary replica to reconnect to the new primary replica.</span></span> <span data-ttu-id="e6932-371">La reconnexion provoque l'interruption des nouvelles bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="e6932-371">Reconnecting causes the new secondary databases to be suspended.</span></span> <span data-ttu-id="e6932-372">Pour démarrer la synchronisation des données sur une base de données, il suffit de reprendre cette dernière.</span><span class="sxs-lookup"><span data-stu-id="e6932-372">To start data synchronization on a database, simply resume it.</span></span> <span data-ttu-id="e6932-373">Le nouveau réplica secondaire supprime le branchement de récupération d'origine de cette base de données, ce qui entraîne la perte des transactions qui n'ont jamais été ni reçues ni envoyées par l'ancien réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="e6932-373">The new secondary replica drops the original recovery fork for that database, losing any transactions that were never sent to or received by the former secondary replica.</span></span>  
  
-   <span data-ttu-id="e6932-374">Si la perte de données est inacceptable</span><span class="sxs-lookup"><span data-stu-id="e6932-374">If the data loss is unacceptable</span></span>  
  
     <span data-ttu-id="e6932-375">Si la base de données primaire d'origine contient des données stratégiques qui seront perdues si vous rétablissez la base de données interrompue, vous pouvez préserver les données sur la base de données primaire d'origine en la supprimant du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="e6932-375">If the original primary database contains critical data that would be lost if you resumed the suspended database, you can preserve the data on the original primary database by removing it from the availability group.</span></span> <span data-ttu-id="e6932-376">Cela fait passer la base de données à l'état RESTORING.</span><span class="sxs-lookup"><span data-stu-id="e6932-376">This causes the database to enter the RESTORING state.</span></span> <span data-ttu-id="e6932-377">À ce stade, nous vous recommandons d'essayer de sauvegarder la fin du journal de la base de données supprimée.</span><span class="sxs-lookup"><span data-stu-id="e6932-377">At this point, we recommend that you attempt to back up the tail of the removed database's log.</span></span> <span data-ttu-id="e6932-378">Ensuite, vous pouvez mettre à jour le réplica principal actuel (l'ancienne base de données secondaire) en exportant les données que vous souhaitez sauver à partir de la base de données primaire d'origine et en les important dans la base de données primaire actuelle.</span><span class="sxs-lookup"><span data-stu-id="e6932-378">Then, you can update the current primary (the former secondary database) by exporting the data you want to salvage from the original primary database and importing it into the current primary database.</span></span> <span data-ttu-id="e6932-379">Nous vous recommandons d'effectuer aussi rapidement que possible une sauvegarde complète de la base de données primaire mise à jour.</span><span class="sxs-lookup"><span data-stu-id="e6932-379">We recommend taking a full database backup of the updated primary database as quickly as possible.</span></span>  
  
     <span data-ttu-id="e6932-380">Puis, sur l'instance de serveur qui héberge le nouveau réplica secondaire, vous pouvez supprimer la base de données secondaire interrompue et créer une nouvelle base de données secondaire en restaurant cette sauvegarde (et au moins une sauvegarde de fichier journal suivante) à l'aide de RESTORE WITH NORECOVERY.</span><span class="sxs-lookup"><span data-stu-id="e6932-380">Then, on the server instance that hosts the new secondary replica, you can delete the suspended secondary database and create a new secondary database by restoring this backup (and least one subsequent log backup) using RESTORE WITH NORECOVERY.</span></span> <span data-ttu-id="e6932-381">Nous vous recommandons de retarder les sauvegardes de fichiers journaux supplémentaires des bases de données primaires actuelles jusqu'à ce que les bases de données secondaires correspondantes soient rétablies.</span><span class="sxs-lookup"><span data-stu-id="e6932-381">We recommend delaying additional log backups of the current primary databases until the corresponding secondary databases are resumed.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="e6932-382">La troncation du journal des transactions est différée sur une base de données principale tant que l'une de ses bases de données secondaires est interrompue.</span><span class="sxs-lookup"><span data-stu-id="e6932-382">Transaction log truncation is delayed on a primary database while any of its secondary databases is suspended.</span></span> <span data-ttu-id="e6932-383">De même, l'état de synchronisation d'un réplica secondaire avec validation synchrone ne peut pas effectuer la transition vers l'état HEALTHY tant qu'une base de données locale reste interrompue.</span><span class="sxs-lookup"><span data-stu-id="e6932-383">Also the synchronization health of a synchronous-commit secondary replica cannot transition to HEALTHY as long as any local database remains suspended.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="e6932-384">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="e6932-384">Related Tasks</span></span>  
 <span data-ttu-id="e6932-385">**Pour configurer le comportement d'un basculement**</span><span class="sxs-lookup"><span data-stu-id="e6932-385">**To configure failover behavior**</span></span>  
  
-   [<span data-ttu-id="e6932-386">Modifier le mode de disponibilité d’un réplica de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-386">Change the Availability Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-availability-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="e6932-387">Modifier le mode de basculement d’un réplica de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-387">Change the Failover Mode of an Availability Replica &#40;SQL Server&#41;</span></span>](change-the-failover-mode-of-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="e6932-388">Configurez la stratégie de basculement flexible pour contrôler les conditions du basculement automatique &#40;groupes de disponibilité AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-388">Configure the Flexible Failover Policy to Control Conditions for Automatic Failover &#40;AlwaysOn Availability Groups&#41;</span></span>](configure-flexible-automatic-failover-policy.md)  
  
 <span data-ttu-id="e6932-389">**Pour effectuer un basculement manuel**</span><span class="sxs-lookup"><span data-stu-id="e6932-389">**To perform a manual fail over**</span></span>  
  
-   [<span data-ttu-id="e6932-390">Effectuer un basculement manuel planifié d’un groupe de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-390">Perform a Planned Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-planned-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="e6932-391">Effectuer un basculement manuel forcé d’un groupe de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-391">Perform a Forced Manual Failover of an Availability Group &#40;SQL Server&#41;</span></span>](perform-a-forced-manual-failover-of-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="e6932-392">Utiliser l’Assistant Basculer le groupe de disponibilité &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-392">Use the Fail Over Availability Group Wizard &#40;SQL Server Management Studio&#41;</span></span>](use-the-fail-over-availability-group-wizard-sql-server-management-studio.md)  
  
-   [<span data-ttu-id="e6932-393">Gestion des connexions et des travaux pour les bases de données d’un groupe de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-393">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)  
  
 <span data-ttu-id="e6932-394">**Pour configurer le quorum WSFC**</span><span class="sxs-lookup"><span data-stu-id="e6932-394">**To configure WSFC Quorum Configuration**</span></span>  
  
-   [<span data-ttu-id="e6932-395">Configurer les paramètres NodeWeight pour un quorum de cluster</span><span class="sxs-lookup"><span data-stu-id="e6932-395">Configure Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/configure-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="e6932-396">Afficher les paramètres NodeWeight pour le quorum de cluster</span><span class="sxs-lookup"><span data-stu-id="e6932-396">View Cluster Quorum NodeWeight Settings</span></span>](../../../sql-server/failover-clusters/windows/view-cluster-quorum-nodeweight-settings.md)  
  
-   [<span data-ttu-id="e6932-397">Forcer un cluster WSFC à démarrer sans quorum</span><span class="sxs-lookup"><span data-stu-id="e6932-397">Force a WSFC Cluster to Start Without a Quorum</span></span>](../../../sql-server/failover-clusters/windows/force-a-wsfc-cluster-to-start-without-a-quorum.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="e6932-398">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="e6932-398">Related Content</span></span>  
  
-   [<span data-ttu-id="e6932-399">Guide de solutions Microsoft SQL Server AlwaysOn pour la haute disponibilité et la récupération d'urgence</span><span class="sxs-lookup"><span data-stu-id="e6932-399">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [<span data-ttu-id="e6932-400">Blog de l'équipe de SQL Server AlwaysOn : Blog officiel de l'équipe de SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="e6932-400">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="e6932-401">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e6932-401">See Also</span></span>  
 <span data-ttu-id="e6932-402">[Vue d’ensemble de groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e6932-402">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="e6932-403">[Modes de disponibilité &#40;groupes de disponibilité AlwaysOn&#41;](availability-modes-always-on-availability-groups.md) </span><span class="sxs-lookup"><span data-stu-id="e6932-403">[Availability Modes &#40;AlwaysOn Availability Groups&#41;](availability-modes-always-on-availability-groups.md) </span></span>  
 <span data-ttu-id="e6932-404">[Clustering de basculement Windows Server &#40;WSFC&#41; avec SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="e6932-404">[Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md) </span></span>  
 <span data-ttu-id="e6932-405">[Transactions entre bases de données non prises en charge pour la mise en miroir de bases de données ou groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span><span class="sxs-lookup"><span data-stu-id="e6932-405">[Cross-Database Transactions Not Supported For Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](transactions-always-on-availability-and-database-mirroring.md) </span></span>  
 <span data-ttu-id="e6932-406">[Stratégie de basculement pour les instances de cluster de basculement](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span><span class="sxs-lookup"><span data-stu-id="e6932-406">[Failover Policy for Failover Cluster Instances](../../../sql-server/failover-clusters/windows/failover-policy-for-failover-cluster-instances.md) </span></span>  
 [<span data-ttu-id="e6932-407">Stratégie flexible pour le basculement automatique d’un groupe de disponibilité &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e6932-407">Flexible Failover Policy for Automatic Failover of an Availability Group &#40;SQL Server&#41;</span></span>](flexible-automatic-failover-policy-availability-group.md)  
  
  
