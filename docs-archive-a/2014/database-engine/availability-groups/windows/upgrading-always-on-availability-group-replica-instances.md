---
title: Mise à niveau et mise à jour des serveurs de groupe de disponibilité avec un temps d’arrêt et une perte de données minimes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
ms.assetid: f670af56-dbcc-4309-9119-f919dcad8a65
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 6bac882b93016a430fbcace2d590e6cc087123d2
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708632"
---
# <a name="upgrade-and-update-of-availability-group-servers-with-minimal-downtime-and-data-loss"></a><span data-ttu-id="0b079-102">Mise à niveau et mise à jour des serveurs de groupes de disponibilité avec un temps mort minimal et perte de données</span><span class="sxs-lookup"><span data-stu-id="0b079-102">Upgrade and Update of Availability Group Servers with Minimal Downtime and Data Loss</span></span>
  <span data-ttu-id="0b079-103">Lorsque de la mise à jour ou de la mise à niveau d'instances de serveur de SQL Server 2012 vers un Service Pack ou une version plus récente, réduisez le temps mort d'un groupe de disponibilité à un seul basculement manuel en effectuant une mise à jour ou une mise à niveau séquentielle.</span><span class="sxs-lookup"><span data-stu-id="0b079-103">When updating or upgrading server instances from SQL Server 2012 to a service pack or a newer version, you can reduce downtime for an availability group to only a single manual failover by performing a sequential update or upgrade.</span></span> <span data-ttu-id="0b079-104">En ce qui concerne la mise à niveau des versions de SQL Server, cette mise à niveau s'appelle une mise à niveau propagée. En ce qui concerne la mise à jour de la version actuelle de SQL Server avec les correctifs ou les Service Pack, cette mise à jour s'appelle une mise à jour propagée.</span><span class="sxs-lookup"><span data-stu-id="0b079-104">For upgrading SQL Server versions, it is known as rolling upgrade; for updating the current SQL Server version with hotfixes or service packs, it is known as rolling update.</span></span>  
  
 <span data-ttu-id="0b079-105">Cette rubrique limite la discussion aux mises à niveau/mises à jour de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="0b079-105">This topic limits the discussion to SQL Server upgrades/updates only.</span></span> <span data-ttu-id="0b079-106">Pour les mises à niveau/mises à jour liées au système d’exploitation sur lesquelles s’exécutent les instances de SQL Server hautement disponibles, consultez [migration entre clusters de groupes de disponibilité AlwaysOn pour les mises à niveau du système d’exploitation](https://msdn.microsoft.com/library/jj873730.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0b079-106">For operating system-related upgrades/updates that the highly-available SQL Server instances are running on, see [Cross-cluster Migration of AlwaysOn Availability Groups for Operating System Upgrades](https://msdn.microsoft.com/library/jj873730.aspx)</span></span>  
  
## <a name="rolling-upgradeupdate-best-practices-for-alwayson-availability-groups"></a><span data-ttu-id="0b079-107">Meilleures pratiques pour la mise à niveau/mise à jour propagée de groupes de disponibilité AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="0b079-107">Rolling Upgrade/Update Best Practices for AlwaysOn Availability Groups</span></span>  
 <span data-ttu-id="0b079-108">Appliquez les meilleures pratiques suivantes lorsque vous effectuez la mise à niveau/mise à jour du serveur afin de réduire le temps mort et la perte de données de vos groupes de disponibilité :</span><span class="sxs-lookup"><span data-stu-id="0b079-108">The following best practices should be observed when performing server upgrades/updates in order to minimize downtime and data loss for your availability groups:</span></span>  
  
-   <span data-ttu-id="0b079-109">Avant de procéder à la mise à niveau/mise à jour propagée :</span><span class="sxs-lookup"><span data-stu-id="0b079-109">Before starting the rolling upgrade/update,</span></span>  
  
    -   <span data-ttu-id="0b079-110">Procédez à un essai de basculement manuel sur au moins un de vos réplicas avec validation synchrone.</span><span class="sxs-lookup"><span data-stu-id="0b079-110">Perform a practice manual failover on at least one of your synchronous-commit replicas</span></span>  
  
    -   <span data-ttu-id="0b079-111">Protégez vos données en effectuant une sauvegarde complète de chaque base de données de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="0b079-111">Protect your data by performing a full database backup on every availability database</span></span>  
  
    -   <span data-ttu-id="0b079-112">Exécutez la commande DBCC CHECKDB sur chaque base de données de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="0b079-112">Run DBCC CHECKDB on every availability database</span></span>  
  
-   <span data-ttu-id="0b079-113">Procédez toujours à la mise à niveau/mise à jour des nœuds du réplica secondaire distant, puis des nœuds du réplica secondaire local et enfin du nœud du réplica principal.</span><span class="sxs-lookup"><span data-stu-id="0b079-113">Always upgrade/update the remote secondary replica nodes first, then local secondary replica nodes next, and the primary replica node last.</span></span>  
  
-   <span data-ttu-id="0b079-114">Les sauvegardes ne peuvent pas être exécutées dans une base de données qui est en cours de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="0b079-114">Backups cannot occur on a database that is in the process of being upgraded.</span></span>  <span data-ttu-id="0b079-115">Avant de mettre les réplicas secondaires à niveau, configurez la préférence de sauvegarde automatisée pour exécuter les sauvegardes uniquement sur le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="0b079-115">Prior to upgrading the secondary replicas, configure the automated backup preference to run backups only on the primary replica.</span></span>  <span data-ttu-id="0b079-116">Avant de mettre le réplica principal à niveau, modifiez ce paramètre pour exécuter les sauvegardes uniquement sur les réplicas secondaires.</span><span class="sxs-lookup"><span data-stu-id="0b079-116">Prior to upgrading the primary replica, modify this setting to run backups only on the secondary replicas.</span></span>  
  
-   <span data-ttu-id="0b079-117">Pour éviter les basculements involontaires des groupes de disponibilité lors du processus de mise à niveau/mise à jour, supprimez le basculement des groupes de disponibilité dans tous les réplicas avec validation synchrone avant de commencer.</span><span class="sxs-lookup"><span data-stu-id="0b079-117">To prevent the availability group from unintended failovers during the upgrade/update process, remove availability failover from all synchronous-commit replicas before you begin.</span></span>  
  
-   <span data-ttu-id="0b079-118">Ne procédez pas à la mise à niveau du nœud de réplica principal avant le basculement du groupe de disponibilité sur un nœud mis à niveau avec un réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="0b079-118">Do not upgrade the primary replica node before failing over the availability group to an upgraded node with a secondary replica first.</span></span> <span data-ttu-id="0b079-119">Sinon, les applications clientes risquent de pâtir de temps morts prolongés lors de la mise à niveau/mise à jour sur le réplica principal.</span><span class="sxs-lookup"><span data-stu-id="0b079-119">Otherwise, client applications may suffer extended downtime during the upgrade/update on the primary replica.</span></span>  
  
-   <span data-ttu-id="0b079-120">Procédez toujours au basculement du groupe de disponibilité sur un nœud de réplica secondaire avec validation synchrone.</span><span class="sxs-lookup"><span data-stu-id="0b079-120">Always fail over the availability group to a synchronous-commit secondary replica node.</span></span> <span data-ttu-id="0b079-121">Si vous procédez au basculement vers un réplica secondaire avec validation asynchrone, les bases de données subiront une perte de données et le déplacement des données sera automatiquement suspendu tant que vous ne le reprendrez pas manuellement.</span><span class="sxs-lookup"><span data-stu-id="0b079-121">If you fail over to an asynchronous-commit secondary replica, the databases will suffer data loss, and data movement is automatically suspended until you manually resume data movement.</span></span>  
  
-   <span data-ttu-id="0b079-122">Ne procédez pas à la mise à niveau/mise à jour du nœud de réplica principal avant la mise à niveau/mise à jour des autres nœuds de réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="0b079-122">Do not upgrade/update the primary replica node before upgrading/updating any other secondary replica nodes.</span></span> <span data-ttu-id="0b079-123">Un réplica principal mis à niveau n'envoie plus les journaux à un réplica secondaire qui n'a pas encore été mis à niveau avec la même version.</span><span class="sxs-lookup"><span data-stu-id="0b079-123">An upgraded primary replica can no longer ship logs to any secondary replica that has not yet been upgraded to the same version.</span></span> <span data-ttu-id="0b079-124">Lorsque le déplacement des données vers un réplica secondaire est suspendu, aucun basculement automatique ne se produit pour ce réplica, et vos bases de données de disponibilité sont vulnérables à une perte de données.</span><span class="sxs-lookup"><span data-stu-id="0b079-124">When data movement to a secondary replica is suspended, no automatic failover can occur for that replica, and your availability databases are vulnerable to data loss.</span></span>  
  
-   <span data-ttu-id="0b079-125">Avant de procéder au basculement d'un groupe de disponibilité, vérifiez que l'état de synchronisation de la cible de basculement est SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="0b079-125">Before failing over an availability group, verify that the synchronization state of the failover target is SYNCHRONIZED.</span></span>  
  
## <a name="rolling-upgradeupdate-process"></a><span data-ttu-id="0b079-126">Processus de mise à niveau/mise à jour propagée</span><span class="sxs-lookup"><span data-stu-id="0b079-126">Rolling Upgrade/Update Process</span></span>  
 <span data-ttu-id="0b079-127">Dans la pratique, le processus exact dépend de facteurs tels que la topologie de déploiement de vos groupes de disponibilité et du mode de validation de chaque réplica.</span><span class="sxs-lookup"><span data-stu-id="0b079-127">In practice, the exact process will depend on factors such as the deployment topology of your availability groups and the commit mode of each replica.</span></span> <span data-ttu-id="0b079-128">Cependant, dans le scénario le plus simple, une mise à niveau/mise à jour propagée est un processus en plusieurs étapes impliquant les différentes étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="0b079-128">But in the simplest scenario, a rolling upgrade/update is a multi-stage process that in its simplest form involves the following steps:</span></span>  
  
 <span data-ttu-id="0b079-129">![Mise à niveau du groupe de disponibilité dans le scénario HADR](../../media/alwaysonupgrade-ag-hadr.gif "Mise à niveau du groupe de disponibilité dans le scénario HADR")</span><span class="sxs-lookup"><span data-stu-id="0b079-129">![Availability Group Upgrade in HADR Scenario](../../media/alwaysonupgrade-ag-hadr.gif "Availability Group Upgrade in HADR Scenario")</span></span>  
  
1.  <span data-ttu-id="0b079-130">Supprimer le basculement automatique sur tous les réplicas avec validation synchrone</span><span class="sxs-lookup"><span data-stu-id="0b079-130">Remove automatic failover on all synchronous-commit replicas</span></span>  
  
2.  <span data-ttu-id="0b079-131">Mettre à niveau/mettre à jour toutes les instances de serveur distant exécutant les réplicas secondaires avec validation asynchrone</span><span class="sxs-lookup"><span data-stu-id="0b079-131">Upgrade/update all remote server instances running asynchronous-commit secondary replicas</span></span>  
  
3.  <span data-ttu-id="0b079-132">Mettre à niveau/mettre à jour les instances de serveur local qui n'exécutent pas le réplica principal</span><span class="sxs-lookup"><span data-stu-id="0b079-132">Upgrade/update the all local server instances that are not currently running the primary replica</span></span>  
  
4.  <span data-ttu-id="0b079-133">Procéder manuellement au basculement du groupe de disponibilité sur un réplica secondaire avec validation synchrone</span><span class="sxs-lookup"><span data-stu-id="0b079-133">Manually fail over the availability group to a synchronous-commit secondary replica</span></span>  
  
5.  <span data-ttu-id="0b079-134">Mettre à niveau/mettre à jour l'instance du serveur qui hébergeait précédemment le réplica principal</span><span class="sxs-lookup"><span data-stu-id="0b079-134">Upgrade/update the server instance that formerly hosted the primary replica</span></span>  
  
6.  <span data-ttu-id="0b079-135">Configurer le basculement automatique des partenaires de basculement selon les besoins</span><span class="sxs-lookup"><span data-stu-id="0b079-135">Configure automatic failover partners as desired</span></span>  
  
 <span data-ttu-id="0b079-136">Si nécessaire, effectuez un basculement manuel supplémentaire pour rétablir la configuration d'origine du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="0b079-136">If necessary, you can perform an extra manual failover to return the availability group to its original configuration.</span></span>  
  
## <a name="availability-group-with-one-remote-secondary-replica"></a><span data-ttu-id="0b079-137">Groupe de disponibilité avec un réplica secondaire distant</span><span class="sxs-lookup"><span data-stu-id="0b079-137">Availability Group with One Remote Secondary Replica</span></span>  
 <span data-ttu-id="0b079-138">Si vous avez déployé un groupe de disponibilité uniquement à des fins de récupération d'urgence, vous devrez peut-être le basculer sur un réplica secondaire avec validation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="0b079-138">If you have deployed an availability group only for disaster recovery, you may need to fail over the availability group to an asynchronous-commit secondary replica.</span></span> <span data-ttu-id="0b079-139">Cette configuration est illustrée dans la figure ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="0b079-139">Such configuration is illustrated by the following figure:</span></span>  
  
 <span data-ttu-id="0b079-140">![Mise à niveau du groupe de disponibilité dans le scénario DR](../../media/agupgrade-ag-dr.gif "Mise à niveau du groupe de disponibilité dans le scénario DR")</span><span class="sxs-lookup"><span data-stu-id="0b079-140">![Availability Group Upgrade in DR Scenario](../../media/agupgrade-ag-dr.gif "Availability Group Upgrade in DR Scenario")</span></span>  
  
 <span data-ttu-id="0b079-141">Dans ce cas, vous devez basculer le groupe de disponibilité sur le réplica secondaire avec validation asynchrone lors de la mise à niveau/mise à jour.</span><span class="sxs-lookup"><span data-stu-id="0b079-141">In this situation, you must fail over the availability group to the asynchronous-commit secondary replica during the rolling upgrade/update.</span></span> <span data-ttu-id="0b079-142">Pour éviter la perte de données, changez le mode de validation en validation synchrone et attendez que le réplica secondaire soit synchronisé avant de basculer le groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="0b079-142">To prevent data loss, change the commit mode to synchronous commit and wait for the secondary replica to be synchronized before you fail over the availability group.</span></span> <span data-ttu-id="0b079-143">Par conséquent, le processus de mise à niveau/mise à jour peut ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="0b079-143">Therefore, the rolling upgrade/update process may look as follows:</span></span>  
  
1.  <span data-ttu-id="0b079-144">Mettre à niveau/mettre à jour le serveur distant</span><span class="sxs-lookup"><span data-stu-id="0b079-144">Upgrade/update the remote server</span></span>  
  
2.  <span data-ttu-id="0b079-145">Changer le mode de validation en validation synchrone</span><span class="sxs-lookup"><span data-stu-id="0b079-145">Change the commit mode to synchronous commit</span></span>  
  
3.  <span data-ttu-id="0b079-146">Patienter jusqu'à ce que l'état de synchronisation soit SYNCHRONIZED</span><span class="sxs-lookup"><span data-stu-id="0b079-146">Wait until synchronization state is SYNCHRONIZED</span></span>  
  
4.  <span data-ttu-id="0b079-147">Basculer le groupe de disponibilité sur le site distant</span><span class="sxs-lookup"><span data-stu-id="0b079-147">Fail over the availability group to the remote site</span></span>  
  
5.  <span data-ttu-id="0b079-148">Mettre à niveau/mettre à jour le serveur (site principal) local</span><span class="sxs-lookup"><span data-stu-id="0b079-148">Upgrade/update the local (primary site) server</span></span>  
  
6.  <span data-ttu-id="0b079-149">Basculer le groupe de disponibilité sur le site principal</span><span class="sxs-lookup"><span data-stu-id="0b079-149">Fail over the availability group to the primary site</span></span>  
  
7.  <span data-ttu-id="0b079-150">Changer le mode de validation en validation asynchrone</span><span class="sxs-lookup"><span data-stu-id="0b079-150">Change the commit mode to asynchronous commit</span></span>  
  
 <span data-ttu-id="0b079-151">Le mode de validation synchrone n'étant pas recommandé pour la synchronisation des données sur un site distant, les applications clientes peuvent remarquer une augmentation immédiate de la latence de la base de données après modification du paramètre.</span><span class="sxs-lookup"><span data-stu-id="0b079-151">Since the synchronous-commit mode is not a recommended setting for data synchronization to a remote site, client applications may notice an immediate increase in database latency after the setting change.</span></span> <span data-ttu-id="0b079-152">De plus, avec le basculement les messages du journal en attente d'accusé de réception sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="0b079-152">Moreover, performing a failover will cause all unacknowledged log messages to be discarded.</span></span> <span data-ttu-id="0b079-153">Le nombre de messages du journal ignorés peut être élevé en raison de la latence réseau élevée entre les deux sites, à l'origine d'un nombre élevé d'échecs de transactions des clients.</span><span class="sxs-lookup"><span data-stu-id="0b079-153">The amount of discarded log messages can be quite large due to the high network latency between the two sites, causing clients to experience a high volume of transactional failure.</span></span> <span data-ttu-id="0b079-154">Pour réduire l'impact sur les applications clientes, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="0b079-154">You can minimize impact to client applications by doing the following:</span></span>  
  
-   <span data-ttu-id="0b079-155">Sélectionnez avec précaution une fenêtre de maintenance lorsque le trafic est faible sur le client</span><span class="sxs-lookup"><span data-stu-id="0b079-155">Carefully select a maintenance window during low client traffic</span></span>  
  
-   <span data-ttu-id="0b079-156">Lors de la mise à niveau/mise à jour de SQL Server sur le site principal, revenez au mode de disponibilité validation asynchrone, puis rétablissez la validation synchrone lorsque vous êtes prêt à effectuer le basculement sur le site principal</span><span class="sxs-lookup"><span data-stu-id="0b079-156">While upgrading/updating SQL Server on the primary site, change the availability mode back to asynchronous commit, then revert to synchronous commit when you are ready to fail over to the primary site again</span></span>  
  
## <a name="availability-group-with-failover-cluster-instance-nodes"></a><span data-ttu-id="0b079-157">Groupe de disponibilité avec nœuds d'instance de cluster de basculement</span><span class="sxs-lookup"><span data-stu-id="0b079-157">Availability Group with Failover Cluster Instance Nodes</span></span>  
 <span data-ttu-id="0b079-158">Si un groupe de disponibilité contient des nœuds d'instance de cluster de basculement, mettez à niveau/jour les nœuds inactifs avant de mettre à niveau/jour les nœuds actifs.</span><span class="sxs-lookup"><span data-stu-id="0b079-158">If an availability group contains failover cluster instance (FCI) nodes, you should upgrade/update the inactive nodes before you upgrade/update the active nodes.</span></span> <span data-ttu-id="0b079-159">La figure ci-dessous illustre un scénario de groupe de disponibilité courant avec instances de cluster de basculement pour la haute disponibilité et la validation asynchrone entre les instances de cluster de basculement à des fins de récupération d'urgence, et l'ordre de mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="0b079-159">The figure below illustrates a common availability group scenario with FCIs for local high availability and asynchronous commit between the FCIs for remote disaster recovery, and the upgrade sequence.</span></span>  
  
 <span data-ttu-id="0b079-160">![Mise à niveau du groupe de disponibilité avec instances de cluster de basculement](../../media/agupgrade-ag-fci-dr.gif "Mise à niveau du groupe de disponibilité avec instances de cluster de basculement")</span><span class="sxs-lookup"><span data-stu-id="0b079-160">![Availability Group Upgrade with FCIs](../../media/agupgrade-ag-fci-dr.gif "Availability Group Upgrade with FCIs")</span></span>  
  
1.  <span data-ttu-id="0b079-161">Mettre à niveau/jour REMOTE2</span><span class="sxs-lookup"><span data-stu-id="0b079-161">Upgrade/update REMOTE2</span></span>  
  
2.  <span data-ttu-id="0b079-162">Basculer FCI2 sur REMOTE2</span><span class="sxs-lookup"><span data-stu-id="0b079-162">Fail over FCI2 to REMOTE2</span></span>  
  
3.  <span data-ttu-id="0b079-163">Mettre à niveau/jour REMOTE1</span><span class="sxs-lookup"><span data-stu-id="0b079-163">Upgrade/update REMOTE1</span></span>  
  
4.  <span data-ttu-id="0b079-164">Mettre à niveau/jour PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="0b079-164">Upgrade/update PRIMARY2</span></span>  
  
5.  <span data-ttu-id="0b079-165">Basculer FCI1 sur PRIMARY2</span><span class="sxs-lookup"><span data-stu-id="0b079-165">Fail over FCI1 to PRIMARY2</span></span>  
  
6.  <span data-ttu-id="0b079-166">Mettre à niveau/jour PRIMARY1</span><span class="sxs-lookup"><span data-stu-id="0b079-166">Upgrade/update PRIMARY1</span></span>  
  
## <a name="upgradeupdate-sql-server-instances-with-multiple-availability-groups"></a><span data-ttu-id="0b079-167">Mettre à niveau/mettre à jour les instances de SQL Server avec plusieurs groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="0b079-167">Upgrade/Update SQL Server Instances with Multiple Availability Groups</span></span>  
 <span data-ttu-id="0b079-168">Si vous exécutez plusieurs groupes de disponibilité avec réplicas principaux sur des nœuds de serveur distincts (configuration active/active), le chemin d'accès de mise à niveau/mise à jour implique davantage d'étapes de basculement afin d'assurer la haute disponibilité du processus.</span><span class="sxs-lookup"><span data-stu-id="0b079-168">If you are running multiple availability groups with primary replicas on separate server nodes (an Active/Active configuration), the upgrade/update path involves more failover steps to preserve high availability in the process.</span></span> <span data-ttu-id="0b079-169">Supposons que vous exécutez trois groupes de disponibilité sur trois nœuds de serveur, tel que l'illustre le tableau suivant, et tous les réplicas secondaires s'exécutent en mode de validation synchrone.</span><span class="sxs-lookup"><span data-stu-id="0b079-169">Suppose you are running three availability groups on three server nodes as shown in the following table, and all secondary replicas are running in synchronous-commit mode.</span></span>  
  
|<span data-ttu-id="0b079-170">Groupe de disponibilité</span><span class="sxs-lookup"><span data-stu-id="0b079-170">Availability Group</span></span>|<span data-ttu-id="0b079-171">Nœud1</span><span class="sxs-lookup"><span data-stu-id="0b079-171">Node1</span></span>|<span data-ttu-id="0b079-172">Nœud2</span><span class="sxs-lookup"><span data-stu-id="0b079-172">Node2</span></span>|<span data-ttu-id="0b079-173">Node3</span><span class="sxs-lookup"><span data-stu-id="0b079-173">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="0b079-174">AG1</span><span class="sxs-lookup"><span data-stu-id="0b079-174">AG1</span></span>|<span data-ttu-id="0b079-175">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-175">Primary</span></span>|||  
|<span data-ttu-id="0b079-176">AG2</span><span class="sxs-lookup"><span data-stu-id="0b079-176">AG2</span></span>||<span data-ttu-id="0b079-177">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-177">Primary</span></span>||  
|<span data-ttu-id="0b079-178">AG3</span><span class="sxs-lookup"><span data-stu-id="0b079-178">AG3</span></span>|||<span data-ttu-id="0b079-179">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-179">Primary</span></span>|  
  
 <span data-ttu-id="0b079-180">Il peut s'avérer nécessaire d'effectuer une mise à niveau/mise à jour propagée à charge équilibrée dans l'ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="0b079-180">It may be appropriate in your situation to perform a load-balanced rolling upgrade/update in the following sequence:</span></span>  
  
1.  <span data-ttu-id="0b079-181">Basculer AG2 sur Nœud3 (pour libérer Nœud2)</span><span class="sxs-lookup"><span data-stu-id="0b079-181">Fail over AG2 to Node3 (to free up Node2)</span></span>  
  
2.  <span data-ttu-id="0b079-182">Mettre à niveau/mettre à jour Nœud2</span><span class="sxs-lookup"><span data-stu-id="0b079-182">Upgrade/update Node2</span></span>  
  
3.  <span data-ttu-id="0b079-183">Basculer AG1 sur Nœud2 (pour libérer Nœud1)</span><span class="sxs-lookup"><span data-stu-id="0b079-183">Fail over AG1 to Node2 (to free up Node1)</span></span>  
  
4.  <span data-ttu-id="0b079-184">Mettre à niveau/mettre à jour Nœud1</span><span class="sxs-lookup"><span data-stu-id="0b079-184">Upgrade/update Node1</span></span>  
  
5.  <span data-ttu-id="0b079-185">Basculer AG2 et AG3 sur Nœud1 (pour libérer Nœud3)</span><span class="sxs-lookup"><span data-stu-id="0b079-185">Fail over both AG2 and AG3 to Node1 (to free up Node3)</span></span>  
  
6.  <span data-ttu-id="0b079-186">Mettre à niveau/mettre à jour Nœud3</span><span class="sxs-lookup"><span data-stu-id="0b079-186">Upgrade/update Node3</span></span>  
  
7.  <span data-ttu-id="0b079-187">Basculer AG3 sur Nœud3</span><span class="sxs-lookup"><span data-stu-id="0b079-187">Fail over AG3 to Node3</span></span>  
  
 <span data-ttu-id="0b079-188">Cette séquence de mise à niveau/mise à jour présente un temps mort moyen inférieur à deux basculements par groupes de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="0b079-188">This upgrade/update sequence has an average downtime of less than two failovers per availability group.</span></span> <span data-ttu-id="0b079-189">La configuration obtenue est illustrée dans le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="0b079-189">The resulting configuration is shown in the table below.</span></span>  
  
|<span data-ttu-id="0b079-190">Groupe de disponibilité</span><span class="sxs-lookup"><span data-stu-id="0b079-190">Availability Group</span></span>|<span data-ttu-id="0b079-191">Nœud1</span><span class="sxs-lookup"><span data-stu-id="0b079-191">Node1</span></span>|<span data-ttu-id="0b079-192">Nœud2</span><span class="sxs-lookup"><span data-stu-id="0b079-192">Node2</span></span>|<span data-ttu-id="0b079-193">Node3</span><span class="sxs-lookup"><span data-stu-id="0b079-193">Node3</span></span>|  
|------------------------|-----------|-----------|-----------|  
|<span data-ttu-id="0b079-194">AG1</span><span class="sxs-lookup"><span data-stu-id="0b079-194">AG1</span></span>||<span data-ttu-id="0b079-195">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-195">Primary</span></span>||  
|<span data-ttu-id="0b079-196">AG2</span><span class="sxs-lookup"><span data-stu-id="0b079-196">AG2</span></span>|<span data-ttu-id="0b079-197">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-197">Primary</span></span>|||  
|<span data-ttu-id="0b079-198">AG3</span><span class="sxs-lookup"><span data-stu-id="0b079-198">AG3</span></span>|||<span data-ttu-id="0b079-199">Principal</span><span class="sxs-lookup"><span data-stu-id="0b079-199">Primary</span></span>|  
  
 <span data-ttu-id="0b079-200">Le chemin d'accès de la mise à niveau/mise à jour varie selon votre implémentation, ainsi que le temps mort pour=vant être rencontré par les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="0b079-200">Based on your specific implementation, your upgrade/update path may vary, and the downtime that client applications experience may vary as well.</span></span>  
  
  
