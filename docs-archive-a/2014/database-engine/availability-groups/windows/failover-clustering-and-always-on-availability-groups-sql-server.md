---
title: Clustering de basculement et groupes de disponibilité AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- clustering [SQL Server]
- Availability Groups [SQL Server], WSFC clusters
- Failover Cluster Instances [SQL Server], see failover clustering [SQL Server]
- quorum [SQL Server]
- failover clustering [SQL Server], AlwaysOn Availability Groups
- Availability Groups [SQL Server], Failover Cluster Instances
ms.assetid: 613bfbf1-9958-477b-a6be-c6d4f18785c3
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 64ee815c2b852849d9506ca6c3fc114d3d0e4935
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604727"
---
# <a name="failover-clustering-and-alwayson-availability-groups-sql-server"></a><span data-ttu-id="adecb-102">Clustering de basculement et groupes de disponibilité AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="adecb-102">Failover Clustering and AlwaysOn Availability Groups (SQL Server)</span></span>
  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]<span data-ttu-id="adecb-103">, la solution haute disponibilité et de récupération d'urgence introduite dans [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], requiert le Clustering de basculement Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="adecb-103">, the high availability and disaster recovery solution introduced in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], requires Windows Server Failover Clustering (WSFC).</span></span> <span data-ttu-id="adecb-104">En outre, bien que [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] ne dépende pas du Clustering de basculement [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , vous pouvez utiliser une instance de clustering de basculement pour héberger un réplica de disponibilité pour un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-104">Also, though [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is not dependent upon [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Clustering, you can use a failover clustering instance (FCI) to host an availability replica for an availability group.</span></span> <span data-ttu-id="adecb-105">Il est important de connaître le rôle de chaque technologie de clustering, ainsi que les observations nécessaires lorsque vous concevez votre environnement [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adecb-105">It is important to know the role of each clustering technology, and to know what considerations are necessary as you design your [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] environment.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="adecb-106">Pour plus d’informations sur les concepts [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], consultez [Vue d’ensemble des groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="adecb-106">For information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] concepts, see [Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md).</span></span>  
  

  
##  <a name="windows-server-failover-clustering-and-availability-groups"></a><a name="WSFC"></a><span data-ttu-id="adecb-107">Clustering de basculement Windows Server et groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-107">Windows Server Failover Clustering and Availability Groups</span></span>  
 <span data-ttu-id="adecb-108">Le déploiement de [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requiert un cluster WSFC (clustering de basculement Windows Server).</span><span class="sxs-lookup"><span data-stu-id="adecb-108">Deploying [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] requires a Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="adecb-109">Pour que [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]soit activén une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] doit résider sur un nœud WSFC, et le cluster et le nœud WSFC doivent être en ligne.</span><span class="sxs-lookup"><span data-stu-id="adecb-109">To be enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must reside on a WSFC node, and the WSFC cluster and node must be online.</span></span> <span data-ttu-id="adecb-110">De plus, chaque réplica de disponibilité d'un groupe de disponibilité donné doit résider sur un nœud différent du même cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="adecb-110">Furthermore, each availability replica of a given availability group must reside on a different node of the same WSFC cluster.</span></span> <span data-ttu-id="adecb-111">La seule exception survient lors de la migration vers un autre cluster WSFC : un groupe de disponibilité peut temporairement chevaucher deux clusters.</span><span class="sxs-lookup"><span data-stu-id="adecb-111">The only exception is that while being migrated to another WSFC cluster, an availability group can temporarily straddle two clusters.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="adecb-112">s’appuie sur le cluster WSFC (clustering de basculement Windows Server) pour surveiller et gérer les rôles actuels des réplicas de disponibilité qui appartiennent à un groupe de disponibilité donné et pour déterminer de quelle manière un événement de basculement affecte les réplicas de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-112">relies on the Windows Failover Clustering (WSFC) cluster to monitor and manage the current roles of the availability replicas that belong to a given availability group and to determine how a failover event affects the availability replicas.</span></span> <span data-ttu-id="adecb-113">Un groupe de ressources WSFC est créé pour chaque groupe de disponibilité que vous créez.</span><span class="sxs-lookup"><span data-stu-id="adecb-113">A WSFC resource group is created for every availability group that you create.</span></span> <span data-ttu-id="adecb-114">Le cluster WSFC surveille ce groupe de ressources pour évaluer l'intégrité du réplica principal.</span><span class="sxs-lookup"><span data-stu-id="adecb-114">The WSFC cluster monitors this resource group to evaluate the health of the primary replica.</span></span>  
  
 <span data-ttu-id="adecb-115">Le quorum pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] est basé sur tous les nœuds du cluster WSFC, indépendamment du fait qu'un nœud de cluster donné héberge des réplicas de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-115">The quorum for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is based on all nodes in the WSFC cluster regardless of whether a given cluster node hosts any availability replicas.</span></span> <span data-ttu-id="adecb-116">Contrairement à la mise en miroir de bases de données, il n'existe aucun rôle de témoin dans [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adecb-116">In contrast to database mirroring, there is no witness role in [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span>  
  
 <span data-ttu-id="adecb-117">L'intégrité globale d'un cluster WSFC est déterminée par les votes d'un quorum de nœuds du cluster.</span><span class="sxs-lookup"><span data-stu-id="adecb-117">The overall health of a WSFC cluster is determined by the votes of quorum of nodes in the cluster.</span></span> <span data-ttu-id="adecb-118">Si le cluster WSFC est mis hors connexion en raison d'un problème grave non planifié, ou en raison d'un problème de matériel ou de communication persistant, une intervention administrative manuelle est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="adecb-118">If the WSFC cluster goes offline because of an unplanned disaster, or due to a persistent hardware or communications failure, manual administrative intervention is required.</span></span> <span data-ttu-id="adecb-119">Un administrateur Windows Server ou de cluster WSFC doit forcer un quorum et remettre les nœuds de cluster survivants en ligne dans une configuration sans tolérance de panne.</span><span class="sxs-lookup"><span data-stu-id="adecb-119">A Windows Server or WSFC cluster administrator will need to force a quorum and then bring the surviving cluster nodes back online in a non-fault-tolerant configuration.</span></span>  
  
> [!IMPORTANT]  
>  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="adecb-120">sont des sous-clés du cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="adecb-120">registry keys are subkeys of the WSFC cluster.</span></span> <span data-ttu-id="adecb-121">Si vous supprimez et recréez un cluster WSFC, vous devez désactiver puis réactiver la fonctionnalité [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] sur chaque instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui hébergeait un réplica de disponibilité sur le cluster WSFC d'origine.</span><span class="sxs-lookup"><span data-stu-id="adecb-121">If you delete and re-create a WSFC cluster, you must disable and re-enable the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature on each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that hosted an availability replica on the original WSFC cluster.</span></span>  
  
 <span data-ttu-id="adecb-122">Pour plus d’informations sur l’exécution de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sur nœuds de clustering de basculement Windows Server (WSFC) et sur le quorum WSFC, consultez [Clustering de basculement Windows Server &#40;WSFC&#41; avec SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="adecb-122">For information about running [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] on Windows Server Failover Clustering (WSFC) nodes and about WSFC quorum, see [Windows Server Failover Clustering &#40;WSFC&#41; with SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md).</span></span>  
  
### <a name="cross-cluster-migration-of-alwayson-availability-groups-for-os-upgrade"></a><span data-ttu-id="adecb-123">Migration entre clusters de groupes de disponibilité AlwaysOn pour la mise à niveau du système d'exploitation</span><span class="sxs-lookup"><span data-stu-id="adecb-123">Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade</span></span>  
 <span data-ttu-id="adecb-124">Depuis [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] prend en charge la migration entre clusters de groupes de disponibilité pour les déploiements dans un nouveau cluster de clustering de basculement Windows Server (WSFC).</span><span class="sxs-lookup"><span data-stu-id="adecb-124">Beginning with [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)], [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] supports cross-cluster migration of availability groups for deployments to a new Windows Server Failover Clustering (WSFC) cluster.</span></span> <span data-ttu-id="adecb-125">Une migration entre clusters déplace un groupe de disponibilité ou un lot de groupes de disponibilité vers le nouveau cluster WSFC de destination avec un temps mort minimal.</span><span class="sxs-lookup"><span data-stu-id="adecb-125">A cross-cluster migration moves one availability group or a batch of availability groups to the new, destination WSFC cluster with minimal downtime.</span></span> <span data-ttu-id="adecb-126">Le processus de migration entre clusters permet de conserver les contrats de niveau de service (SLA) lors de la mise à niveau vers un cluster [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adecb-126">The cross-cluster migration process enables you to maintain your service level agreements (SLAs) when upgrading to a [!INCLUDE[win8srv](../../../includes/win8srv-md.md)] cluster.</span></span> [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] <span data-ttu-id="adecb-127">(ou une version ultérieure) doit être installé et activé pour AlwaysOn sur le cluster WSFC de destination.</span><span class="sxs-lookup"><span data-stu-id="adecb-127">(or a later version) must be installed and enabled for AlwaysOn on the destination WSFC cluster.</span></span> <span data-ttu-id="adecb-128">La réussite d'une migration entre clusters dépend de la planification et de la préparation du cluster WSFC de destination.</span><span class="sxs-lookup"><span data-stu-id="adecb-128">The success of a cross-cluster migration depends on thorough planning and preparation of the destination WSFC cluster.</span></span>  
  
 <span data-ttu-id="adecb-129">Pour plus d'informations, consultez [Migration entre clusters de groupes de disponibilité AlwaysOn pour la mise à niveau du système d'exploitation](https://msdn.microsoft.com/library/jj873730.aspx).</span><span class="sxs-lookup"><span data-stu-id="adecb-129">For more information, see [Cross-Cluster Migration of AlwaysOn Availability Groups for OS Upgrade](https://msdn.microsoft.com/library/jj873730.aspx).</span></span>  
  
##  <a name="ssnoversion-failover-cluster-instances-fcis-and-availability-groups"></a><a name="SQLServerFC"></a> <span data-ttu-id="adecb-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Instances de cluster de basculement et groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-130">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Failover Cluster Instances (FCIs) and Availability Groups</span></span>  
 <span data-ttu-id="adecb-131">Vous pouvez configurer une deuxième couche de basculement au niveau de l'instance serveur en implémentant le clustering de basculement [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] avec le cluster WSFC.</span><span class="sxs-lookup"><span data-stu-id="adecb-131">You can set up a second layer of failover at the server-instance level by implementing [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering together with the WSFC cluster.</span></span> <span data-ttu-id="adecb-132">Un réplica de disponibilité peut être hébergé par une instance autonome de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ou par une instance de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="adecb-132">An availability replica can be hosted by either a standalone instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or an FCI instance.</span></span> <span data-ttu-id="adecb-133">Un seul partenaire FCI peut héberger un réplica pour un groupe de disponibilité donné.</span><span class="sxs-lookup"><span data-stu-id="adecb-133">Only one FCI partner can host a replica for a given availability group.</span></span> <span data-ttu-id="adecb-134">Lorsqu'un réplica de disponibilité s'exécute sur une FCI, la liste des propriétaires possibles pour le groupe de disponibilité contiendra uniquement le nœud FCI actif.</span><span class="sxs-lookup"><span data-stu-id="adecb-134">When an availability replica is running on an FCI, the possible owners list for the availability group will contain only the active FCI node.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="adecb-135">ne dépend d'aucune forme de stockage partagé.</span><span class="sxs-lookup"><span data-stu-id="adecb-135">does not depend on any form of shared storage.</span></span> <span data-ttu-id="adecb-136">Toutefois, si vous utilisez une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour héberger un ou plusieurs réplicas de disponibilité, chacune de ces instances de cluster de basculement requiert un stockage partagé conformément à l'installation standard de l'instance de cluster de basculement SQL Server.</span><span class="sxs-lookup"><span data-stu-id="adecb-136">However, if you use a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI) to host one or more availability replicas, each of those FCIs will require shared storage as per standard SQL Server failover cluster instance installation.</span></span>  
  
 <span data-ttu-id="adecb-137">Pour plus d’informations sur les conditions préalables requises, consultez la section « Conditions préalables requises et restrictions pour l’utilisation d’une instance de cluster de basculement SQL Server afin d’héberger un réplica de disponibilité » de la rubrique [Conditions préalables requises, restrictions et recommandations pour les groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="adecb-137">For more information about additional prerequisites, see the "Prerequisites and Restrictions for Using a SQL Server Failover Cluster Instance (FCI) to Host an Availability Replica" section of [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
### <a name="comparison-of-failover-cluster-instances-and-availability-groups"></a><span data-ttu-id="adecb-138">Comparaison des instances de cluster de basculement et des groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-138">Comparison of Failover Cluster Instances and Availability Groups</span></span>  
 <span data-ttu-id="adecb-139">Quel que soit le nombre de nœuds de l'instance de cluster de basculement, celle-ci ne peut héberger qu'un seul réplica dans un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-139">Regardless of the number of nodes in the FCI, an entire FCI hosts a single replica within an availability group.</span></span> <span data-ttu-id="adecb-140">Le tableau suivant décrit les distinctions de concepts entre les nœuds d'une instance de cluster de basculement et les réplicas dans un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-140">The following table describes the distinctions in concepts between nodes in an FCI and replicas within an availability group.</span></span>  
  
||<span data-ttu-id="adecb-141">Nœuds dans une instance de cluster de basculement</span><span class="sxs-lookup"><span data-stu-id="adecb-141">Nodes within an FCI</span></span>|<span data-ttu-id="adecb-142">Réplicas dans un groupe de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-142">Replicas within an availability group</span></span>|  
|-|-------------------------|-------------------------------------------|  
|<span data-ttu-id="adecb-143">**Utilise le cluster WSFC**</span><span class="sxs-lookup"><span data-stu-id="adecb-143">**Uses WSFC cluster**</span></span>|<span data-ttu-id="adecb-144">Oui</span><span class="sxs-lookup"><span data-stu-id="adecb-144">Yes</span></span>|<span data-ttu-id="adecb-145">Oui</span><span class="sxs-lookup"><span data-stu-id="adecb-145">Yes</span></span>|  
|<span data-ttu-id="adecb-146">**Niveau de protection**</span><span class="sxs-lookup"><span data-stu-id="adecb-146">**Protection level**</span></span>|<span data-ttu-id="adecb-147">Instance</span><span class="sxs-lookup"><span data-stu-id="adecb-147">Instance</span></span>|<span data-ttu-id="adecb-148">Base de données</span><span class="sxs-lookup"><span data-stu-id="adecb-148">Database</span></span>|  
|<span data-ttu-id="adecb-149">**Type de stockage**</span><span class="sxs-lookup"><span data-stu-id="adecb-149">**Storage type**</span></span>|<span data-ttu-id="adecb-150">Partagé</span><span class="sxs-lookup"><span data-stu-id="adecb-150">Shared</span></span>|<span data-ttu-id="adecb-151">Non partagé</span><span class="sxs-lookup"><span data-stu-id="adecb-151">Non-shared</span></span><br /><br /> <span data-ttu-id="adecb-152">Notez que même si les réplicas dans un groupe de disponibilité ne partagent pas le stockage, un réplica hébergé par une instance de cluster de basculement utilise une solution de stockage partagé conforme aux exigences de cette instance de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="adecb-152">Note that while the replicas in an availability group do not share storage, a replica that is hosted by an FCI uses a shared storage solution as required by that FCI.</span></span> <span data-ttu-id="adecb-153">La solution de stockage est partagée uniquement par les nœuds de l'instance de cluster de basculement et pas entre les réplicas du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-153">The storage solution is shared only by nodes within the FCI and not between replicas of the availability group.</span></span>|  
|<span data-ttu-id="adecb-154">**Solutions de stockage**</span><span class="sxs-lookup"><span data-stu-id="adecb-154">**Storage solutions**</span></span>|<span data-ttu-id="adecb-155">attachement direct, SAN, points de montage, SMB</span><span class="sxs-lookup"><span data-stu-id="adecb-155">Direct attached, SAN, mount points, SMB</span></span>|<span data-ttu-id="adecb-156">Dépend du type de nœud</span><span class="sxs-lookup"><span data-stu-id="adecb-156">Depends on node type</span></span>|  
|<span data-ttu-id="adecb-157">**Secondaires accessibles en lecture**</span><span class="sxs-lookup"><span data-stu-id="adecb-157">**Readable secondaries**</span></span>|<span data-ttu-id="adecb-158">Non\*</span><span class="sxs-lookup"><span data-stu-id="adecb-158">No\*</span></span>|<span data-ttu-id="adecb-159">Oui</span><span class="sxs-lookup"><span data-stu-id="adecb-159">Yes</span></span>|  
|<span data-ttu-id="adecb-160">**Paramètres de stratégie de basculement applicables**</span><span class="sxs-lookup"><span data-stu-id="adecb-160">**Applicable failover policy settings**</span></span>|<span data-ttu-id="adecb-161">Quorum WSFC</span><span class="sxs-lookup"><span data-stu-id="adecb-161">WSFC quorum</span></span><br /><br /> <span data-ttu-id="adecb-162">Spécifique à l'instance de cluster de basculement</span><span class="sxs-lookup"><span data-stu-id="adecb-162">FCI-specific</span></span><br /><br /> <span data-ttu-id="adecb-163">Paramètres du groupe de disponibilité\*\*</span><span class="sxs-lookup"><span data-stu-id="adecb-163">Availability group settings\*\*</span></span>|<span data-ttu-id="adecb-164">Quorum WSFC</span><span class="sxs-lookup"><span data-stu-id="adecb-164">WSFC quorum</span></span><br /><br /> <span data-ttu-id="adecb-165">Paramètres de groupe de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-165">Availability group settings</span></span>|  
|<span data-ttu-id="adecb-166">**Ressources basculées**</span><span class="sxs-lookup"><span data-stu-id="adecb-166">**Failed-over resources**</span></span>|<span data-ttu-id="adecb-167">Serveur, instance et base de données</span><span class="sxs-lookup"><span data-stu-id="adecb-167">Server, instance, and database</span></span>|<span data-ttu-id="adecb-168">Base de données uniquement</span><span class="sxs-lookup"><span data-stu-id="adecb-168">Database only</span></span>|  
  
 <span data-ttu-id="adecb-169">\*Alors que les réplicas secondaires synchrones dans un groupe de disponibilité s’exécutent toujours sur leurs instances [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] respectives, les nœuds secondaires dans une instance de cluster de basculement n’ont pas démarré leurs instances [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] respectives et sont donc inaccessibles en lecture.</span><span class="sxs-lookup"><span data-stu-id="adecb-169">\*Whereas synchronous secondary replicas in an availability group are always running on their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances, secondary nodes in an FCI actually have not started their respective [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances and are therefore not readable.</span></span> <span data-ttu-id="adecb-170">Dans une instance de cluster de basculement, un nœud secondaire démarre son instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uniquement lorsque la propriété du groupe de ressources lui est transférée lors d'un basculement de l'instance de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="adecb-170">In an FCI, a secondary node starts its [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance only when the resource group ownership is transferred to it during an FCI failover.</span></span> <span data-ttu-id="adecb-171">Toutefois, sur le nœud actif de l'instance de cluster de basculement, lorsqu'une base de données hébergée par l'instance de cluster de basculement appartient à un groupe de disponibilité, si le réplica de disponibilité local s'exécute comme réplica secondaire accessible en lecture, la base de données est accessible en lecture.</span><span class="sxs-lookup"><span data-stu-id="adecb-171">However, on the active FCI node, when an FCI-hosted database belongs to an availability group, if the local availability replica is running as a readable secondary replica, the database is readable.</span></span>  
  
 <span data-ttu-id="adecb-172">\*\*Les paramètres de stratégie de basculement du groupe de disponibilité s’appliquent à tous les réplicas, qu’il soit hébergé dans une instance autonome ou une instance de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="adecb-172">\*\*Failover policy settings for the availability group apply to all replicas, whether it is hosted in a standalone instance or an FCI instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="adecb-173">Pour plus d’informations sur le **nombre de nœuds** dans le clustering de basculement et **groupes de disponibilité AlwaysOn** pour les différentes éditions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , consultez [fonctionnalités prises en charge par les éditions de SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) ( https://go.microsoft.com/fwlink/?linkid=232473) .</span><span class="sxs-lookup"><span data-stu-id="adecb-173">For more information about **Number of nodes** within Failover Clustering and **AlwaysOn Availability Groups** for different editions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Features Supported by the Editions of SQL Server 2012](https://go.microsoft.com/fwlink/?linkid=232473) (https://go.microsoft.com/fwlink/?linkid=232473).</span></span>  
  
### <a name="considerations-for-hosting-an-availability-replica-on-an-fci"></a><span data-ttu-id="adecb-174">Considérations relatives à l'hébergement d'un réplica de disponibilité sur une instance de cluster de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-174">Considerations for hosting an Availability Replica on an FCI</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="adecb-175">Si vous envisagez d'héberger un réplica de disponibilité sur une instance de cluster de basculement SQL Server, assurez-vous que les nœuds hôtes Windows Server 2008 respectent les conditions préalables requises et les restrictions AlwaysOn applicables aux instances de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="adecb-175">If you plan to host an availability replica on a SQL Server Failover Cluster Instance (FCI), ensure that the Windows Server 2008 host nodes meet the AlwaysOn prerequisites and restrictions for Failover Cluster Instances (FCIs).</span></span> <span data-ttu-id="adecb-176">Pour plus d’informations, consultez [Conditions préalables requises, restrictions et recommandations pour les groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="adecb-176">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="adecb-177">Les instances de cluster de basculement ne prennent pas en charge le basculement automatique par les groupes de disponibilité. Par conséquent, tout réplica de disponibilité hébergé par une instance de cluster de basculement ne peut être configuré que pour un basculement manuel.</span><span class="sxs-lookup"><span data-stu-id="adecb-177">Failover Cluster Instances (FCIs) do not support automatic failover by availability groups, so any availability replica that is hosted by an FCI can only be configured for manual failover.</span></span>  
  
 <span data-ttu-id="adecb-178">Vous devrez peut-être configurer un cluster WSFC (Clustering de basculement Windows Server) de manière à inclure les disques partagés qui ne sont pas disponibles sur tous les nœuds.</span><span class="sxs-lookup"><span data-stu-id="adecb-178">You might need to configure a Windows Server Failover Clustering (WSFC) cluster to include shared disks that are not available on all nodes.</span></span> <span data-ttu-id="adecb-179">Prenons par exemple un cluster WSFC réparti entre deux centres de données comportant trois nœuds.</span><span class="sxs-lookup"><span data-stu-id="adecb-179">For example, consider a WSFC cluster across two data centers with three nodes.</span></span> <span data-ttu-id="adecb-180">Deux des nœuds hébergent une instance de clustering de basculement SQL Server dans le centre de données principal et ont accès aux mêmes disques partagés.</span><span class="sxs-lookup"><span data-stu-id="adecb-180">Two of the nodes host a SQL Server failover clustering instance (FCI) in the primary data center and have access to the same shared disks.</span></span> <span data-ttu-id="adecb-181">Le troisième nœud héberge une instance autonome de SQL Server dans un centre de données différent et n'a pas accès aux disques partagés du centre de données principal.</span><span class="sxs-lookup"><span data-stu-id="adecb-181">The third node hosts a stand-alone instance of SQL Server in a different data center and does not have access to the shared disks from the primary data center.</span></span> <span data-ttu-id="adecb-182">Cette configuration de cluster WSFC prend en charge le déploiement d'un groupe de disponibilité si l'instance de cluster de basculement héberge le réplica principal et l'instance autonome héberge le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="adecb-182">This WSFC cluster configuration supports the deployment of an availability group if the FCI hosts the primary replica and the stand-alone instance hosts the secondary replica.</span></span>  
  
 <span data-ttu-id="adecb-183">Lorsque vous choisissez une instance de cluster de basculement pour l'hébergement d'un réplica de disponibilité pour un groupe de disponibilité donné, vérifiez qu'un basculement de l'instance de cluster de basculement ne peut pas provoquer de tentative d'hébergement, par un seul nœud WSFC, de deux réplicas de disponibilité pour le même groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-183">When choosing an FCI to host an availability replica for a given availability group, ensure that an FCI failover could not potentially cause a single WSFC node to attempt to host two availability replicas for the same availability group.</span></span>  
  
 <span data-ttu-id="adecb-184">L'exemple de scénario suivant montre en quoi cette configuration risque de provoquer des problèmes :</span><span class="sxs-lookup"><span data-stu-id="adecb-184">The following example scenario illustrates how this configuration could lead to problems:</span></span>  
  
 <span data-ttu-id="adecb-185">Marcel configure un cluster WSFC avec deux nœuds, `NODE01` et `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="adecb-185">Marcel configures two a WSFC cluster with two nodes, `NODE01` and `NODE02`.</span></span> <span data-ttu-id="adecb-186">Il installe une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , `fciInstance1`, sur `NODE01` et `NODE02` , où `NODE01` est le propriétaire actuel de `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="adecb-186">He installs a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance, `fciInstance1`, on both `NODE01` and `NODE02` where `NODE01` is the current owner for `fciInstance1`.</span></span>  
 <span data-ttu-id="adecb-187">Sur `NODE02`, Marcel installe une autre instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, qui est une instance autonome.</span><span class="sxs-lookup"><span data-stu-id="adecb-187">On `NODE02`, Marcel installs another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], `Instance3`, which is a stand-alone instance.</span></span>  
 <span data-ttu-id="adecb-188">Sur `NODE01`, Marcel active fciInstance1 pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adecb-188">On `NODE01`, Marcel enables fciInstance1 for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="adecb-189">Sur `NODE02`, il active `Instance3` pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adecb-189">On `NODE02`, he enables `Instance3` for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="adecb-190">Il configure ensuite un groupe de disponibilité pour lequel `fciInstance1` héberge le réplica principal et `Instance3` héberge le réplica secondaire.</span><span class="sxs-lookup"><span data-stu-id="adecb-190">Then he sets up an availability group for which `fciInstance1` hosts the primary replica, and `Instance3` hosts the secondary replica.</span></span>  
 <span data-ttu-id="adecb-191">À un certain stade, `fciInstance1` devient indisponible sur `NODE01`, et le cluster WSFC provoque un basculement de `fciInstance1` vers `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="adecb-191">At some point `fciInstance1` becomes unavailable on `NODE01`, and the WSFC cluster causes a failover of `fciInstance1` to `NODE02`.</span></span> <span data-ttu-id="adecb-192">Après le basculement, `fciInstance1` est une instance activée pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]qui s'exécute sous le rôle principal sur `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="adecb-192">After the failover, `fciInstance1` is a [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]-enabled instance running under the primary role on `NODE02`.</span></span> <span data-ttu-id="adecb-193">Toutefois, `Instance3` réside maintenant sur le même nœud WSFC que `fciInstance1`.</span><span class="sxs-lookup"><span data-stu-id="adecb-193">However, `Instance3` now resides on the same WSFC node as `fciInstance1`.</span></span> <span data-ttu-id="adecb-194">Cela viole la contrainte [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="adecb-194">This violates the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] constraint.</span></span>  
 <span data-ttu-id="adecb-195">Pour résoudre le problème présenté par ce scénario, l'instance autonome, `Instance3`, doit résider sur un autre nœud dans le même cluster WSFC que `NODE01` et `NODE02`.</span><span class="sxs-lookup"><span data-stu-id="adecb-195">To correct the problem that this scenario presents, the stand-alone instance, `Instance3`, must reside on another node in the same WSFC cluster as `NODE01` and `NODE02`.</span></span>  
  
 <span data-ttu-id="adecb-196">Pour plus d’informations sur le clustering de basculement [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], consultez [Instances de cluster de basculement AlwaysOn &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="adecb-196">For more information about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover clustering, see [AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md).</span></span>  
  
##  <a name="restrictions-on-using-the-wsfc-failover-cluster-manager-with-availability-groups"></a><a name="FCMrestrictions"></a><span data-ttu-id="adecb-197">Restrictions sur l’utilisation de l’Gestionnaire du cluster de basculement WSFC avec les groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-197">Restrictions on Using The WSFC Failover Cluster Manager with Availability Groups</span></span>  
 <span data-ttu-id="adecb-198">N'utilisez pas le Gestionnaire du cluster de basculement pour manipuler des groupes de disponibilité, par exemple :</span><span class="sxs-lookup"><span data-stu-id="adecb-198">Do not use the Failover Cluster Manager to manipulate availability groups, for example:</span></span>  
  
-   <span data-ttu-id="adecb-199">N'ajoutez pas ou ne supprimez pas de ressources dans le service cluster (groupe de ressources) du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-199">Do not add or remove resources in the clustered service (resource group) for the availability group.</span></span>  
  
-   <span data-ttu-id="adecb-200">Ne modifiez pas les propriétés du groupe de disponibilité, telles que les propriétaires possibles et par défaut.</span><span class="sxs-lookup"><span data-stu-id="adecb-200">Do not change any availability group properties, such as the possible owners and preferred owners.</span></span> <span data-ttu-id="adecb-201">Ces propriétés sont définies automatiquement par le groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-201">These properties are set automatically by the availability group.</span></span>  
  
-   <span data-ttu-id="adecb-202">N'utilisez pas le Gestionnaire du cluster de basculement pour déplacer des groupes de disponibilité vers différents nœuds ou faire basculer des groupes de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="adecb-202">Do not use the Failover Cluster Manager to move availability groups to different nodes or to fail over availability groups.</span></span> <span data-ttu-id="adecb-203">Le Gestionnaire du cluster de basculement n'a pas connaissance de l'état de synchronisation des réplicas de disponibilité, et cela peut provoquer temps morts étendus.</span><span class="sxs-lookup"><span data-stu-id="adecb-203">The Failover Cluster Manager is not aware of the synchronization status of the availability replicas, and doing so can lead to extended downtime.</span></span> <span data-ttu-id="adecb-204">Vous devez utiliser [!INCLUDE[tsql](../../../includes/tsql-md.md)] ou [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="adecb-204">You must use [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span>  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="adecb-205">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="adecb-205">Related Content</span></span>  
  
-   <span data-ttu-id="adecb-206">**Blogs :**</span><span class="sxs-lookup"><span data-stu-id="adecb-206">**Blogs:**</span></span>  
  
     [<span data-ttu-id="adecb-207">Configurer le clustering de basculement Windows pour SQL Server (groupe de disponibilité ou instance de cluster de basculement) avec une sécurité limitée</span><span class="sxs-lookup"><span data-stu-id="adecb-207">Configure Windows Failover Clustering for SQL Server (Availability Group or FCI) with Limited Security</span></span>](https://blogs.msdn.com/b/sqlalwayson/archive/2012/06/05/configure-windows-failover-clustering-for-sql-server-availability-group-or-fci-with-limited-security.aspx)  
  
     [<span data-ttu-id="adecb-208">Blogs de l'équipe de SQL Server AlwaysOn : Blog officiel de l'équipe de SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="adecb-208">SQL Server AlwaysOn Team Blogs: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
     [<span data-ttu-id="adecb-209">Blogs des ingénieurs du Service clientèle et du Support technique de SQL Server</span><span class="sxs-lookup"><span data-stu-id="adecb-209">CSS SQL Server Engineers Blogs</span></span>](https://blogs.msdn.com/b/psssql/)  
  
-   <span data-ttu-id="adecb-210">**Livres blancs :**</span><span class="sxs-lookup"><span data-stu-id="adecb-210">**Whitepapers:**</span></span>  
  
     [<span data-ttu-id="adecb-211">Guide de l'architecture AlwaysOn : Création d'une solution haute disponibilité et de récupération d'urgence en utilisant des instances de cluster de basculement et des groupes de disponibilité</span><span class="sxs-lookup"><span data-stu-id="adecb-211">AlwaysOn Architecture Guide: Building a High Availability and Disaster Recovery Solution by Using Failover Cluster Instances and Availability Groups</span></span>](https://msdn.microsoft.com/library/jj215886.aspx)  
  
     [<span data-ttu-id="adecb-212">Guide de solutions Microsoft SQL Server AlwaysOn pour la haute disponibilité et la récupération d'urgence</span><span class="sxs-lookup"><span data-stu-id="adecb-212">Microsoft SQL Server AlwaysOn Solutions Guide for High Availability and Disaster Recovery</span></span>](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
     [<span data-ttu-id="adecb-213">Livres blancs de Microsoft pour SQL Server 2012</span><span class="sxs-lookup"><span data-stu-id="adecb-213">Microsoft White Papers for SQL Server 2012</span></span>](https://msdn.microsoft.com/library/hh403491.aspx)  
  
     [<span data-ttu-id="adecb-214">Livres blancs de l'équipe de consultants clients de SQL Server</span><span class="sxs-lookup"><span data-stu-id="adecb-214">SQL Server Customer Advisory Team Whitepapers</span></span>](http://sqlcat.com/)  
  
## <a name="see-also"></a><span data-ttu-id="adecb-215">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="adecb-215">See Also</span></span>  
 <span data-ttu-id="adecb-216">[Vue d’ensemble de groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [activer et désactiver](enable-and-disable-always-on-availability-groups-sql-server.md) groupes de disponibilité AlwaysOn &#40;SQL Server&#41;[surveiller des groupes de disponibilité &#40;Transact-SQL&#41;](monitor-availability-groups-transact-sql.md)</span><span class="sxs-lookup"><span data-stu-id="adecb-216">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md) [Monitor Availability Groups &#40;Transact-SQL&#41;](monitor-availability-groups-transact-sql.md)</span></span>  
 [<span data-ttu-id="adecb-217">Instances de cluster de basculement AlwaysOn &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="adecb-217">AlwaysOn Failover Cluster Instances &#40;SQL Server&#41;</span></span>](../../../sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server.md) 
  
  
