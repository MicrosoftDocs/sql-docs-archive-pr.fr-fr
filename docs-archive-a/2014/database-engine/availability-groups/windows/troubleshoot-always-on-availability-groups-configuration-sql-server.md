---
title: Résoudre les problèmes de configuration de groupes de disponibilité AlwaysOn (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 01/31/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- troubleshooting [SQL Server], deploying
- Availability Groups [SQL Server], troubleshooting
- Availability Groups [SQL Server], configuring
ms.assetid: 8c222f98-7392-4faf-b7ad-5fb60ffa237e
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 165036ba539c3392b1944282bd9d6126eb471a97
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708640"
---
# <a name="troubleshoot-alwayson-availability-groups-configuration-sql-server"></a><span data-ttu-id="39146-102">Résoudre des problèmes de configuration des groupes de disponibilité AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="39146-102">Troubleshoot AlwaysOn Availability Groups Configuration (SQL Server)</span></span>
  <span data-ttu-id="39146-103">Cette rubrique fournit des informations pour vous aider à résoudre les problèmes courants de configuration des instances de serveur pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39146-103">This topic provides information to help you troubleshoot typical problems with configuring server instances for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="39146-104">Problèmes courants de configuration : [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] est désactivé, les comptes sont incorrectement configurés, le point de terminaison de mise en miroir de bases de données n'existe pas, le point de terminaison est inaccessible (erreur SQL Server 1418), l'accès réseau n'existe pas et échec d'une commande de jointure de base de données (erreur SQL Server 35250).</span><span class="sxs-lookup"><span data-stu-id="39146-104">Typical configuration problems include [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] is disabled, accounts are incorrectly configured, the database mirroring endpoint does not exist, the endpoint is inaccessible (SQL Server Error 1418), network access does not exist, and a join database command fails (SQL Server Error 35250).</span></span>

> [!NOTE]
>  <span data-ttu-id="39146-105">Assurez-vous que les conditions préalables requises pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] sont réunies.</span><span class="sxs-lookup"><span data-stu-id="39146-105">Ensure that you are meeting the [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] prerequisites.</span></span> <span data-ttu-id="39146-106">Pour plus d’informations, consultez [Conditions préalables requises, restrictions et recommandations pour les groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="39146-106">For more information, see [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md).</span></span>

 <span data-ttu-id="39146-107">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="39146-107">**In This Topic:**</span></span>

|<span data-ttu-id="39146-108">Section</span><span class="sxs-lookup"><span data-stu-id="39146-108">Section</span></span>|<span data-ttu-id="39146-109">Description</span><span class="sxs-lookup"><span data-stu-id="39146-109">Description</span></span>|
|-------------|-----------------|
|[<span data-ttu-id="39146-110">Les groupes de disponibilité AlwaysOn ne sont pas activés</span><span class="sxs-lookup"><span data-stu-id="39146-110">AlwaysOn Availability Groups Is Not Enabled</span></span>](#IsHadrEnabled)|<span data-ttu-id="39146-111">Si une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] n'est pas activée pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], elle ne prend pas en charge la création de groupe de disponibilité et ne peut héberger aucun réplica de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="39146-111">If an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is not enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], the instance does not support availability group creation and cannot host any availability replicas.</span></span>|
|[<span data-ttu-id="39146-112">Comptes (Accounts)</span><span class="sxs-lookup"><span data-stu-id="39146-112">Accounts</span></span>](#Accounts)|<span data-ttu-id="39146-113">Traite des conditions nécessaires à la configuration correcte des comptes sous lesquels [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] s'exécute.</span><span class="sxs-lookup"><span data-stu-id="39146-113">Discusses requirements for correctly configuring the accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running.</span></span>|
|[<span data-ttu-id="39146-114">Points de terminaison</span><span class="sxs-lookup"><span data-stu-id="39146-114">Endpoints</span></span>](#Endpoints)|<span data-ttu-id="39146-115">Explique comment diagnostiquer les problèmes liés au point de terminaison de mise en miroir de bases de données d'une instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="39146-115">Discusses how to diagnose issues with the database mirroring endpoint of a server instance.</span></span>|
|[<span data-ttu-id="39146-116">Nom système</span><span class="sxs-lookup"><span data-stu-id="39146-116">System name</span></span>](#SystemName)|<span data-ttu-id="39146-117">Résume les solutions possibles pour spécifier le nom système d'une instance de serveur dans une URL de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="39146-117">Summarizes the alternatives for specifying the system name of a server instance in an endpoint URL.</span></span>|
|[<span data-ttu-id="39146-118">Accès réseau</span><span class="sxs-lookup"><span data-stu-id="39146-118">Network access</span></span>](#NetworkAccess)|<span data-ttu-id="39146-119">Traite de l'exigence selon laquelle chaque instance de serveur qui héberge un réplica de disponibilité doit être autorisée à accéder au port de chacune des autres instances de serveur par le biais du protocole TCP.</span><span class="sxs-lookup"><span data-stu-id="39146-119">Documents the requirement that each server instance that is hosting an availability replica must be able to access the port of each of the other server instances over TCP.</span></span>|
|[<span data-ttu-id="39146-120">Accès au point de terminaison (erreur SQL Server 1418)</span><span class="sxs-lookup"><span data-stu-id="39146-120">Endpoint Access (SQL Server Error 1418)</span></span>](#Msg1418)|<span data-ttu-id="39146-121">Contient des informations sur ce message d'erreur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="39146-121">Contains information about this [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] error message.</span></span>|
|[<span data-ttu-id="39146-122">Échec de jointure de base de données (erreur SQL Server 35250)</span><span class="sxs-lookup"><span data-stu-id="39146-122">Join Database Fails (SQL Server Error 35250)</span></span>](#JoinDbFails)|<span data-ttu-id="39146-123">Décrit les causes possibles et la résolution d'une impossibilité de joindre des bases de données secondaires à un groupe de disponibilité du fait que la connexion au réplica principal n'est pas active.</span><span class="sxs-lookup"><span data-stu-id="39146-123">Discusses the possible causes and resolution of a failure to join secondary databases to an availability group because the connection to the primary replica is not active.</span></span>|
|[<span data-ttu-id="39146-124">Le routage en lecture seule ne fonctionne pas correctement</span><span class="sxs-lookup"><span data-stu-id="39146-124">Read-Only Routing is Not Working Correctly</span></span>](#ROR)||
|[<span data-ttu-id="39146-125">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="39146-125">Related Tasks</span></span>](#RelatedTasks)|<span data-ttu-id="39146-126">Contient une liste de rubriques orientées tâche dans la documentation en ligne de [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] qui sont particulièrement appropriée au dépannage d'une configuration de groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="39146-126">Contains a list of task-oriented topics in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] Books Online that are particularly relevant to troubleshooting an availability group configuration.</span></span>|
|[<span data-ttu-id="39146-127">Contenu connexe</span><span class="sxs-lookup"><span data-stu-id="39146-127">Related Content</span></span>](#RelatedContent)|<span data-ttu-id="39146-128">Contient une liste de ressources pertinentes externes à la documentation en ligne de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="39146-128">Contains a list of relevant resources that are external to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Books Online.</span></span>|

##  <a name="alwayson-availability-groups-is-not-enabled"></a><a name="IsHadrEnabled"></a><span data-ttu-id="39146-129">groupes de disponibilité AlwaysOn n’est pas activé</span><span class="sxs-lookup"><span data-stu-id="39146-129">AlwaysOn Availability Groups Is Not Enabled</span></span>
 <span data-ttu-id="39146-130">La fonctionnalité [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] doit être activée sur chacune des instances de [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="39146-130">The [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] feature must be enabled on each of the instances of [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)].</span></span> <span data-ttu-id="39146-131">Pour plus d’informations, consultez [Activer et désactiver les groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="39146-131">For more information, see [Enable and Disable AlwaysOn Availability Groups &#40;SQL Server&#41;](enable-and-disable-always-on-availability-groups-sql-server.md).</span></span>

##  <a name="accounts"></a><a name="Accounts"></a> <span data-ttu-id="39146-132">Comptes (Accounts)</span><span class="sxs-lookup"><span data-stu-id="39146-132">Accounts</span></span>
 <span data-ttu-id="39146-133">Les comptes sous lesquels [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] est en cours d'exécution doivent être configurés correctement.</span><span class="sxs-lookup"><span data-stu-id="39146-133">The accounts under which [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running must be correctly configured.</span></span>

1.  <span data-ttu-id="39146-134">Les comptes possèdent-ils les autorisations appropriées ?</span><span class="sxs-lookup"><span data-stu-id="39146-134">Do the accounts have the correct permissions?</span></span>

    1.  <span data-ttu-id="39146-135">Si les partenaires s'exécutent sous le même compte d'utilisateur de domaine, les noms d'accès d'utilisateur corrects existent automatiquement dans les deux bases de données **master** .</span><span class="sxs-lookup"><span data-stu-id="39146-135">If the partners run as the same domain user account, the correct user logins exist automatically in both **master** databases.</span></span> <span data-ttu-id="39146-136">Cela simplifie la configuration de sécurité de la base de données et est recommandé.</span><span class="sxs-lookup"><span data-stu-id="39146-136">This simplifies the security configuration the database and is recommended.</span></span>

    2.  <span data-ttu-id="39146-137">Si deux instances de serveur s'exécutent sous des comptes différents, la connexion de chaque compte doit être créée dans la base de données **master** sur l'instance de serveur distante, et cette connexion doit disposer des autorisations CONNECT pour se connecter au point de terminaison de mise en miroir de bases de données de cette instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="39146-137">If two server instances run as different accounts, the login each account must be created in **master** on the remote server instance, and that login must be granted CONNECT permissions to connect to the database mirroring endpoint of that server instance.</span></span> <span data-ttu-id="39146-138">Pour plus d’informations, consultez[configurer des comptes de connexion pour la mise en miroir de bases de données ou groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span><span class="sxs-lookup"><span data-stu-id="39146-138">For more information, see[Set Up Login Accounts for Database Mirroring or AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/set-up-login-accounts-database-mirroring-always-on-availability.md).</span></span>

2.  <span data-ttu-id="39146-139">Si [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] s'exécute en tant que compte intégré, tel que Système local, Service local ou Service réseau, ou comme compte qui n'appartient pas au domaine, vous devez utiliser des certificats pour l'authentification de point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="39146-139">If [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is running as a built-in account, such as Local System, Local Service, or Network Service, or a nondomain account, you must use certificates for endpoint authentication.</span></span> <span data-ttu-id="39146-140">Si vos comptes de service utilisent des comptes de domaine au sein du même domaine, vous pouvez choisir d'accorder l'accès CONNECT pour chaque compte de service sur tous les emplacements de réplica ou vous pouvez utiliser des certificats.</span><span class="sxs-lookup"><span data-stu-id="39146-140">If your service accounts are using domain accounts in the same domain, you can choose to grant CONNECT access for each service account on all the replica locations or you can use certificates.</span></span> <span data-ttu-id="39146-141">Pour plus d’informations, consultez [Utiliser des certificats pour un point de terminaison de mise en miroir de bases de données &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span><span class="sxs-lookup"><span data-stu-id="39146-141">For more information, see[Use Certificates for a Database Mirroring Endpoint &#40;Transact-SQL&#41;](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md).</span></span>

##  <a name="endpoints"></a><a name="Endpoints"></a> <span data-ttu-id="39146-142">Endpoints</span><span class="sxs-lookup"><span data-stu-id="39146-142">Endpoints</span></span>
 <span data-ttu-id="39146-143">Les points de terminaison doivent être correctement configurés.</span><span class="sxs-lookup"><span data-stu-id="39146-143">Endpoints must be correctly configured.</span></span>

1.  <span data-ttu-id="39146-144">Vérifiez que chaque instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] devant héberger un réplica de disponibilité (chaque *emplacement de réplica*) dispose d’un point de terminaison de mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="39146-144">Make sure that each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that is going to host an availability replica (each *replica location*) has a database mirroring endpoint.</span></span> <span data-ttu-id="39146-145">Pour déterminer si un point de terminaison de mise en miroir de bases de données existe sur une instance de serveur donnée, utilisez l’affichage catalogue [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="39146-145">To determine whether a database mirroring endpoint exists on a given server instance, use the [sys.database_mirroring_endpoints](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql) catalog view.</span></span> <span data-ttu-id="39146-146">Pour plus d’informations, consultez [Créer un point de terminaison de mise en miroir de bases de données pour l’authentification Windows &#40;Transact-SQL&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) ou [Autoriser un point de terminaison de mise en miroir de bases de données à utiliser des certificats pour les connexions sortantes &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span><span class="sxs-lookup"><span data-stu-id="39146-146">For more information, see either [Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md) or [Allow a Database Mirroring Endpoint to Use Certificates for Outbound Connections &#40;Transact-SQL&#41;](../../database-mirroring/database-mirroring-use-certificates-for-outbound-connections.md).</span></span>

2.  <span data-ttu-id="39146-147">Vérifiez les numéros de ports.</span><span class="sxs-lookup"><span data-stu-id="39146-147">Check that the port numbers are correct.</span></span>

     <span data-ttu-id="39146-148">Pour identifier le port actuellement associé au point de terminaison de mise en miroir de bases de données d'une instance de serveur, utilisez l'instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] suivante :</span><span class="sxs-lookup"><span data-stu-id="39146-148">To identify the port currently associated with database mirroring endpoint of a server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT type_desc, port FROM sys.tcp_endpoints;
    GO
    ```

3.  <span data-ttu-id="39146-149">Pour les problèmes de configuration [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] qu'il est difficile d'expliquer, nous vous conseillons d'examiner chaque instance de serveur pour déterminer si elle est à l'écoute sur les ports appropriés.</span><span class="sxs-lookup"><span data-stu-id="39146-149">For [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] setup issues that are difficult to explain, we recommend that you inspect each server instance to determine whether it is listening on the correct ports.</span></span> <span data-ttu-id="39146-150">Pour plus d’informations sur la vérification de la disponibilité des ports, consultez [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="39146-150">For information about verifying port availability, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

4.  <span data-ttu-id="39146-151">Vérifiez que les points de terminaison sont démarrés (STATE=STARTED).</span><span class="sxs-lookup"><span data-stu-id="39146-151">Make sure that the endpoints are started (STATE=STARTED).</span></span> <span data-ttu-id="39146-152">Sur chaque instance de serveur, utilisez l'instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] suivante :</span><span class="sxs-lookup"><span data-stu-id="39146-152">On each server instance, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT state_desc FROM sys.database_mirroring_endpoints
    ```

     <span data-ttu-id="39146-153">Pour plus d’informations sur la colonne **state_desc**, consultez [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="39146-153">For more information about the **state_desc** column, see [sys.database_mirroring_endpoints &#40;Transact-SQL&#41;](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql).</span></span>

     <span data-ttu-id="39146-154">Pour démarrer un point de terminaison, utilisez l'instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] suivante :</span><span class="sxs-lookup"><span data-stu-id="39146-154">To start an endpoint, use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    ALTER ENDPOINT Endpoint_Mirroring 
    STATE = STARTED 
    AS TCP (LISTENER_PORT = <port_number>)
    FOR database_mirroring (ROLE = ALL);
    GO
    ```

     <span data-ttu-id="39146-155">Pour plus d’informations, consultez [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="39146-155">For more information, see [ALTER ENDPOINT &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-endpoint-transact-sql).</span></span>

5.  <span data-ttu-id="39146-156">Assurez-vous que la connexion de l'autre serveur possède l'autorisation CONNECT.</span><span class="sxs-lookup"><span data-stu-id="39146-156">Make sure that the login from the other server has CONNECT permission.</span></span> <span data-ttu-id="39146-157">Pour déterminer qui possède une autorisation CONNECT pour un point de terminaison, sur chaque instance de serveur, utilisez l'instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] suivante :</span><span class="sxs-lookup"><span data-stu-id="39146-157">To determine who has CONNECT permission for an endpoint, on each server instance use the following [!INCLUDE[tsql](../../../includes/tsql-md.md)] statement:</span></span>

    ```
    SELECT 'Metadata Check';
    SELECT EP.name, SP.STATE, 
       CONVERT(nvarchar(38), suser_name(SP.grantor_principal_id)) 
          AS GRANTOR, 
       SP.TYPE AS PERMISSION,
       CONVERT(nvarchar(46),suser_name(SP.grantee_principal_id)) 
          AS GRANTEE 
       FROM sys.server_permissions SP , sys.endpoints EP
       WHERE SP.major_id = EP.endpoint_id
       ORDER BY Permission,grantor, grantee; 
    GO

    ```

##  <a name="system-name"></a><a name="SystemName"></a> <span data-ttu-id="39146-158">System Name</span><span class="sxs-lookup"><span data-stu-id="39146-158">System Name</span></span>
 <span data-ttu-id="39146-159">Comme nom système d'une instance de serveur dans une URL de point de terminaison, vous pouvez utiliser tout nom qui identifie sans ambiguïté le système.</span><span class="sxs-lookup"><span data-stu-id="39146-159">For the system name of a server instance in an endpoint URL, you can use any name that unambiguously identifies the system.</span></span> <span data-ttu-id="39146-160">L'adresse de serveur peut être un nom système (si les systèmes sont dans le même domaine), un nom de domaine complet ou une adresse IP (de préférence statique).</span><span class="sxs-lookup"><span data-stu-id="39146-160">The server address can be a system name (if the systems are in the same domain), a fully qualified domain name, or an IP address (preferably, a static IP address).</span></span> <span data-ttu-id="39146-161">L'utilisation du nom de domaine complet garantit un fonctionnement correct.</span><span class="sxs-lookup"><span data-stu-id="39146-161">Using the fully qualified domain name is guaranteed to work.</span></span> <span data-ttu-id="39146-162">Pour plus d’informations, consultez [Spécifier l’URL de point de terminaison lors de l’ajout ou lors de la modification d’un réplica de disponibilité &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span><span class="sxs-lookup"><span data-stu-id="39146-162">For more information, see [Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;](specify-endpoint-url-adding-or-modifying-availability-replica.md).</span></span>

##  <a name="network-access"></a><a name="NetworkAccess"></a> <span data-ttu-id="39146-163">Network Access</span><span class="sxs-lookup"><span data-stu-id="39146-163">Network Access</span></span>
 <span data-ttu-id="39146-164">Chaque instance de serveur qui héberge un réplica de disponibilité doit être autorisée à accéder au port de chacune de l'autre instance de serveur par le biais du protocole TCP.</span><span class="sxs-lookup"><span data-stu-id="39146-164">Each server instance that is hosting an availability replica must be able to access the port of each of the other server instance over TCP.</span></span> <span data-ttu-id="39146-165">Ceci est d'autant plus important que les instances de serveur peuvent se trouver dans différents domaines, entre lesquels aucune relation d'approbation n'a été établie (domaines non approuvés).</span><span class="sxs-lookup"><span data-stu-id="39146-165">This is especially important if the server instances are in different domains that do not trust each other (untrusted domains).</span></span>

##  <a name="endpoint-access-sql-server-error-1418"></a><a name="Msg1418"></a> <span data-ttu-id="39146-166">Accès au point de terminaison (erreur SQL Server 1418)</span><span class="sxs-lookup"><span data-stu-id="39146-166">Endpoint Access (SQL Server Error 1418)</span></span>
 <span data-ttu-id="39146-167">Ce message [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] indique que l'adresse réseau du serveur spécifiée dans l'URL de point de terminaison ne peut pas être atteinte ou n'existe pas, et il suggère de vérifier le nom de l'adresse réseau puis de réexécuter la commande.</span><span class="sxs-lookup"><span data-stu-id="39146-167">This [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] message indicates that the server network address specified in the endpoint URL cannot be reached or does not exist, and it suggests that you verify the network address name and reissue the command.</span></span> <span data-ttu-id="39146-168">Pour plus d’informations, consultez [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span><span class="sxs-lookup"><span data-stu-id="39146-168">For more information, see [MSSQLSERVER_1418](../../../relational-databases/errors-events/mssqlserver-1418-database-engine-error.md).</span></span>

##  <a name="join-database-fails-sql-server-error-35250"></a><a name="JoinDbFails"></a> <span data-ttu-id="39146-169">Échec de jointure de base de données (erreur SQL Server 35250)</span><span class="sxs-lookup"><span data-stu-id="39146-169">Join Database Fails (SQL Server Error 35250)</span></span>
 <span data-ttu-id="39146-170">Cette section décrit les causes possibles et la résolution d'un problème de jointure de bases de données secondaires au groupe de disponibilité du fait que la connexion au réplica principal n'est pas active.</span><span class="sxs-lookup"><span data-stu-id="39146-170">This section discusses the possible causes and resolution of a failure to join secondary databases to the availability group because the connection to the primary replica is not active.</span></span>

 <span data-ttu-id="39146-171">**Résolution :**</span><span class="sxs-lookup"><span data-stu-id="39146-171">**Resolution:**</span></span>

1.  <span data-ttu-id="39146-172">Vérifiez le paramètre du pare-feu pour voir s'il permet la communication de port du point de terminaison entre les instances de serveur qui hébergent le réplica principal et le réplica secondaire (port 5022 par défaut).</span><span class="sxs-lookup"><span data-stu-id="39146-172">Check the firewall setting to see if whether allows the endpoint port communication between the server instances that host primary replica and the secondary replica (port 5022 by default).</span></span>

2.  <span data-ttu-id="39146-173">Vérifiez si le compte de service réseau dispose de l'autorisation de connexion au point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="39146-173">Check whether the network service account has connect permission to the endpoint.</span></span>

##  <a name="read-only-routing-is-not-working-correctly"></a><a name="ROR"></a> <span data-ttu-id="39146-174">Le routage en lecture seule ne fonctionne pas correctement</span><span class="sxs-lookup"><span data-stu-id="39146-174">Read-Only Routing is Not Working Correctly</span></span>
 <span data-ttu-id="39146-175">Vérifiez les paramètres suivants des valeurs de configuration et corrigez-les si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="39146-175">Verify the following configuration values settings and correct them if necessary.</span></span>

||<span data-ttu-id="39146-176">Sur...</span><span class="sxs-lookup"><span data-stu-id="39146-176">On...</span></span>|<span data-ttu-id="39146-177">Action</span><span class="sxs-lookup"><span data-stu-id="39146-177">Action</span></span>|<span data-ttu-id="39146-178">Commentaires</span><span class="sxs-lookup"><span data-stu-id="39146-178">Comments</span></span>|<span data-ttu-id="39146-179">Lien</span><span class="sxs-lookup"><span data-stu-id="39146-179">Link</span></span>|
|------|---------|------------|--------------|----------|
|<span data-ttu-id="39146-180">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-180">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-181">Réplica principal actuel</span><span class="sxs-lookup"><span data-stu-id="39146-181">Current primary replica</span></span>|<span data-ttu-id="39146-182">Assurez-vous que l'écouteur du groupe de disponibilité est en ligne.</span><span class="sxs-lookup"><span data-stu-id="39146-182">Ensure that the availability group listener is online.</span></span>|<span data-ttu-id="39146-183">**Pour vérifier si l'écouteur en ligne :**</span><span class="sxs-lookup"><span data-stu-id="39146-183">**To verify whether the listener is online:**</span></span><br /><br /> `SELECT * FROM sys.dm_tcp_listener_states;`<br /><br /> <span data-ttu-id="39146-184">**Pour redémarrer un écouteur hors connexion :**</span><span class="sxs-lookup"><span data-stu-id="39146-184">**To restart an offline listener:**</span></span><br /><br /> `ALTER AVAILABILITY GROUP myAG RESTART LISTENER 'myAG_Listener';`|[<span data-ttu-id="39146-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-185">sys.dm_tcp_listener_states &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-tcp-listener-states-transact-sql)<br /><br /> [<span data-ttu-id="39146-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-186">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="39146-187">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-187">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-188">Réplica principal actuel</span><span class="sxs-lookup"><span data-stu-id="39146-188">Current primary replica</span></span>|<span data-ttu-id="39146-189">Vérifiez que l'option READ_ONLY_ROUTING_LIST contient uniquement les instances de serveur qui hébergent un réplica secondaire accessible en lecture.</span><span class="sxs-lookup"><span data-stu-id="39146-189">Ensure that the READ_ONLY_ROUTING_LIST contains only server instances that are hosting a readable secondary replica.</span></span>|<span data-ttu-id="39146-190">**Pour identifier des réplicas secondaires accessibles en lecture :** sys.availability_replicas (colonne**secondary_role_allow_connections_desc** )</span><span class="sxs-lookup"><span data-stu-id="39146-190">**To identify readable secondary replicas:** sys.availability_replicas  (**secondary_role_allow_connections_desc** column)</span></span><br /><br /> <span data-ttu-id="39146-191">**Pour consulter une liste de routage en lecture seule :** sys.availability_read_only_routing_lists</span><span class="sxs-lookup"><span data-stu-id="39146-191">**To view a read-only routing list:** sys.availability_read_only_routing_lists</span></span><br /><br /> <span data-ttu-id="39146-192">**Pour modifier une liste de routage en lecture seule :** ALTER AVAILABILITY GROUP</span><span class="sxs-lookup"><span data-stu-id="39146-192">**To change a read-only routing list:** ALTER AVAILABILITY GROUP</span></span>|[<span data-ttu-id="39146-193">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-193">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="39146-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-194">sys.availability_read_only_routing_lists &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-read-only-routing-lists-transact-sql)<br /><br /> [<span data-ttu-id="39146-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-195">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="39146-196">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-196">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-197">Chaque réplica de read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="39146-197">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="39146-198">Assurez-vous que le Pare-feu Windows ne bloque pas le port READ_ONLY_ROUTING_URL.</span><span class="sxs-lookup"><span data-stu-id="39146-198">Ensure that the Windows firewall is not blocking the READ_ONLY_ROUTING_URL port.</span></span>|-|[<span data-ttu-id="39146-199">Configurer un pare-feu Windows pour accéder au moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="39146-199">Configure a Windows Firewall for Database Engine Access</span></span>](../../configure-windows/configure-a-windows-firewall-for-database-engine-access.md)|
|<span data-ttu-id="39146-200">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-200">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-201">Chaque réplica de read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="39146-201">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="39146-202">Dans le gestionnaire de configuration de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , vérifiez que :</span><span class="sxs-lookup"><span data-stu-id="39146-202">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager, verify that:</span></span><br /><br /> <span data-ttu-id="39146-203">La connectivité à distance SQL Server est activée.</span><span class="sxs-lookup"><span data-stu-id="39146-203">SQL Server remote connectivity is enabled.</span></span><br /><br /> <span data-ttu-id="39146-204">TCP/IP est activé</span><span class="sxs-lookup"><span data-stu-id="39146-204">TCP/IP is enabled.</span></span><br /><br /> <span data-ttu-id="39146-205">Les adresses IP sont configurées correctement.</span><span class="sxs-lookup"><span data-stu-id="39146-205">The IP addresses are configured correctly.</span></span>|-|[<span data-ttu-id="39146-206">Afficher ou modifier des propriétés de serveur &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-206">View or Change Server Properties &#40;SQL Server&#41;</span></span>](../../configure-windows/view-or-change-server-properties-sql-server.md)<br /><br /> [<span data-ttu-id="39146-207">Configurer un serveur pour écouter un port TCP spécifique &#40;SQL Server Configuration Manager&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-207">Configure a Server to Listen on a Specific TCP Port &#40;SQL Server Configuration Manager&#41;</span></span>](../../configure-windows/configure-a-server-to-listen-on-a-specific-tcp-port.md)|
|<span data-ttu-id="39146-208">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-208">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-209">Chaque réplica de read_only_routing_list</span><span class="sxs-lookup"><span data-stu-id="39146-209">Every replica in the read_only_routing_list</span></span>|<span data-ttu-id="39146-210">Assurez-vous que le READ_ONLY_ROUTING_URL (TCP<strong>:// *`system-address`* :</strong>*port*) contient le nom de domaine complet (FQDN) et le numéro de port corrects.</span><span class="sxs-lookup"><span data-stu-id="39146-210">Ensure that the READ_ONLY_ROUTING_URL (TCP<strong>://*`system-address`*:</strong>*port*) contains the correct fully-qualified domain name (FQDN) and port number.</span></span>|-|[<span data-ttu-id="39146-211">Calcul de l'URL de routage en lecture seule pour AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="39146-211">Calculating read_only_routing_url for AlwaysOn</span></span>](https://docs.microsoft.com/archive/blogs/mattn/calculating-read_only_routing_url-for-alwayson)<br /><br /> [<span data-ttu-id="39146-212">sys.availability_replicas &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-212">sys.availability_replicas &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-availability-replicas-transact-sql)<br /><br /> [<span data-ttu-id="39146-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-213">ALTER AVAILABILITY GROUP &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-availability-group-transact-sql)|
|<span data-ttu-id="39146-214">![Case à cocher](../../media/checkboxemptycenterxtraspacetopandright.gif "Case à cocher")</span><span class="sxs-lookup"><span data-stu-id="39146-214">![Checkbox](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")</span></span>|<span data-ttu-id="39146-215">Système client</span><span class="sxs-lookup"><span data-stu-id="39146-215">Client system</span></span>|<span data-ttu-id="39146-216">Vérifiez que le pilote client prend en charge le routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="39146-216">Verify that the client driver supports read-only routing.</span></span>|-|[<span data-ttu-id="39146-217">Connectivité client AlwaysOn (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="39146-217">AlwaysOn Client Connectivity (SQL Server)</span></span>](always-on-client-connectivity-sql-server.md)|

##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="39146-218">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="39146-218">Related Tasks</span></span>

-   [<span data-ttu-id="39146-219">Création et configuration des groupes de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-219">Creation and Configuration of Availability Groups &#40;SQL Server&#41;</span></span>](creation-and-configuration-of-availability-groups-sql-server.md)

-   [<span data-ttu-id="39146-220">Créer un point de terminaison de mise en miroir de bases de données pour l’authentification Windows &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-220">Create a Database Mirroring Endpoint for Windows Authentication &#40;Transact-SQL&#41;</span></span>](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)

-   [<span data-ttu-id="39146-221">Spécifier l’URL de point de terminaison lors de l’ajout ou lors de la modification d’un réplica de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-221">Specify the Endpoint URL When Adding or Modifying an Availability Replica &#40;SQL Server&#41;</span></span>](specify-endpoint-url-adding-or-modifying-availability-replica.md)

-   [<span data-ttu-id="39146-222">Préparer manuellement une base de données secondaire pour un groupe de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-222">Manually Prepare a Secondary Database for an Availability Group &#40;SQL Server&#41;</span></span>](manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md)

-   [<span data-ttu-id="39146-223">Résoudre les problèmes liés à l’échec d’une opération d’ajout de fichier &#40;groupes de disponibilité AlwaysOn&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-223">Troubleshoot a Failed Add-File Operation &#40;AlwaysOn Availability Groups&#41;</span></span>](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md)

-   [<span data-ttu-id="39146-224">Gestion des connexions et des travaux pour les bases de données d’un groupe de disponibilité &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-224">Management of Logins and Jobs for the Databases of an Availability Group &#40;SQL Server&#41;</span></span>](../../logins-and-jobs-for-availability-group-databases.md)

-   [<span data-ttu-id="39146-225">Gérer les métadonnées durant la mise à disposition d’une base de données sur une autre instance de serveur &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="39146-225">Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;</span></span>](../../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md)

##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="39146-226">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="39146-226">Related Content</span></span>

-   <span data-ttu-id="39146-227">[Afficher les événements et journaux pour un cluster de basculement](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span><span class="sxs-lookup"><span data-stu-id="39146-227">[View Events and Logs for a Failover Cluster](https://technet.microsoft.com/library/cc772342\(WS.10\).aspx)</span></span>

-   [<span data-ttu-id="39146-228">Applets de commande de cluster de basculement Get-ClusterLog</span><span class="sxs-lookup"><span data-stu-id="39146-228">Get-ClusterLog Failover Cluster Cmdlet</span></span>](https://technet.microsoft.com/library/ee461045.aspx)

-   [<span data-ttu-id="39146-229">Blog de l'équipe de SQL Server AlwaysOn : Blog officiel de l'équipe de SQL Server AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="39146-229">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)

## <a name="see-also"></a><span data-ttu-id="39146-230">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="39146-230">See Also</span></span>
 <span data-ttu-id="39146-231">[Sécurité de transport pour la mise en miroir de bases de données et les groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) [conditions préalables, restrictions et recommandations relatives à](prereqs-restrictions-recommendations-always-on-availability.md) la [configuration du réseau client](../../configure-windows/client-network-configuration.md) groupes de disponibilité AlwaysOn &#40;SQL Server</span><span class="sxs-lookup"><span data-stu-id="39146-231">[Transport Security for Database Mirroring and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md) [Client Network Configuration](../../configure-windows/client-network-configuration.md) [Prerequisites, Restrictions, and Recommendations for AlwaysOn Availability Groups &#40;SQL Server&#41;](prereqs-restrictions-recommendations-always-on-availability.md)</span></span>


