---
title: Afficher et analyser des traces avec SQL Server Profiler | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: profiler
ms.topic: conceptual
helpviewer_keywords:
- Profiler [SQL Server Profiler], viewing traces
- SQL Server Profiler, viewing traces
- traces [SQL Server], viewing
- SQL Server Profiler, troubleshooting
- troubleshooting [SQL Server], traces
- events [SQL Server], finding inside trace
- Profiler [SQL Server Profiler], troubleshooting
- traces [SQL Server], events
ms.assetid: 17e821ca-a12e-4192-acc1-96765d9ae266
author: stevestein
ms.author: sstein
ms.openlocfilehash: b3e848fe9a07d838631eef1737c2a7679b67e649
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603175"
---
# <a name="view-and-analyze-traces-with-sql-server-profiler"></a><span data-ttu-id="66f27-102">Afficher et analyser des traces avec SQL Server Profiler</span><span class="sxs-lookup"><span data-stu-id="66f27-102">View and Analyze Traces with SQL Server Profiler</span></span>
  <span data-ttu-id="66f27-103">Utilisez [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] pour afficher les données d'événement capturées dans une trace.</span><span class="sxs-lookup"><span data-stu-id="66f27-103">Use [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to view captured event data in a trace.</span></span> [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="66f27-104">affiche les données selon les propriétés de trace définies.</span><span class="sxs-lookup"><span data-stu-id="66f27-104">displays data based on defined trace properties.</span></span> <span data-ttu-id="66f27-105">L’une des façons d'analyser les données de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] consiste à les copier dans un autre programme, par exemple [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ou l'Assistant Paramétrage du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="66f27-105">One way to analyze [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data is to copy the data to another program, such as [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] or [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor.</span></span> [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="66f27-106">L’Assistant Paramétrage peut utiliser un fichier de trace qui contient des événements de traitement SQL et d’appels de procédures distantes si la colonne de données **Text** est présente dans la trace.</span><span class="sxs-lookup"><span data-stu-id="66f27-106">Tuning Advisor can use a trace file that contains SQL batch and remote procedure call (RPC) events if the **Text** data column is included in the trace.</span></span> <span data-ttu-id="66f27-107">Pour vous assurer que les colonnes et les événements nécessaires sont bien présents pour être utilisés avec l'Assistant Paramétrage du [!INCLUDE[ssDE](../../includes/ssde-md.md)] , utilisez le modèle de paramétrage prédéfini fourni avec [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)].</span><span class="sxs-lookup"><span data-stu-id="66f27-107">To make sure that the correct events and columns are captured for use with [!INCLUDE[ssDE](../../includes/ssde-md.md)] Tuning Advisor, use the predefined Tuning template that is supplied with [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)].</span></span>  
  
 <span data-ttu-id="66f27-108">Si vous ouvrez une trace en utilisant le [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)], il n'est pas nécessaire que le fichier de trace porte l'extension .trc si le fichier a été créé par le [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] ou des procédures stockées du système de trace SQL.</span><span class="sxs-lookup"><span data-stu-id="66f27-108">When you open a trace by using [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)], the trace file does not need to have the .trc file extension if the file was created by either [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] or SQL Trace system stored procedures.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="66f27-109">peut également lire les fichiers .log de trace SQL et les fichiers de script SQL génériques.</span><span class="sxs-lookup"><span data-stu-id="66f27-109">can also read SQL Trace .log files and generic SQL script files.</span></span> <span data-ttu-id="66f27-110">Si vous ouvrez un fichier de trace SQL qui ne porte pas l’extension .log, par exemple le fichier trace.txt, spécifiez **SQLTrace_Log** comme format de fichier.</span><span class="sxs-lookup"><span data-stu-id="66f27-110">When opening a SQL Trace .log file that does not have a .log file extension, such as trace.txt, specify **SQLTrace_Log** as the file format.</span></span>  
  
 <span data-ttu-id="66f27-111">Vous pouvez configurer le format d'horodatage du [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] pour vous aider dans l'analyse des traces.</span><span class="sxs-lookup"><span data-stu-id="66f27-111">You can configure the [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] date and time display format to assist in trace analysis.</span></span>  
  
## <a name="troubleshooting-data"></a><span data-ttu-id="66f27-112">Dépannage de problèmes liés aux données</span><span class="sxs-lookup"><span data-stu-id="66f27-112">Troubleshooting Data</span></span>  
 <span data-ttu-id="66f27-113">Le [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)]vous permet de résoudre des problèmes de données en regroupant les traces ou les fichiers de traces dans quatre colonnes : **Duration**, **CPU**, **Reads**et **Writes** .</span><span class="sxs-lookup"><span data-stu-id="66f27-113">Using [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)], you can troubleshoot data by grouping traces or trace files by the **Duration**, **CPU**, **Reads**, or **Writes** data columns.</span></span> <span data-ttu-id="66f27-114">Le genre de données que vous pourriez être amené à réparer pourrait être une requête qui fonctionne mal ou qui a un nombre exceptionnellement élevé de lectures logiques.</span><span class="sxs-lookup"><span data-stu-id="66f27-114">Examples of data you might troubleshoot are queries that perform poorly or that have exceptionally high numbers of logical read operations.</span></span>  
  
 <span data-ttu-id="66f27-115">Vous pouvez trouver des informations complémentaires en enregistrant les traces dans des tables et en utilisant [!INCLUDE[tsql](../../includes/tsql-md.md)] pour interroger les données d'événement.</span><span class="sxs-lookup"><span data-stu-id="66f27-115">Additional information can be found by saving traces to tables and using [!INCLUDE[tsql](../../includes/tsql-md.md)] to query the event data.</span></span> <span data-ttu-id="66f27-116">Par exemple, pour déterminer quels événements **SQL:BatchCompleted** ont présenté des délais d'attente excessifs, exécutez :</span><span class="sxs-lookup"><span data-stu-id="66f27-116">For example, to determine which **SQL:BatchCompleted** events had excessive wait time, execute the following:</span></span>  
  
```  
SELECT  TextData, Duration, CPU  
FROM    trace_table_name  
WHERE   EventClass = 12 -- SQL:BatchCompleted events  
AND     CPU < (Duration * 1000)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="66f27-117">Le serveur signale la durée d’un événement en microsecondes (un millionième, ou 10<sup>-6</sup>, de seconde) et le temps UC utilisé par l’événement en millisecondes (un millième, ou 10<sup>-3</sup>, de seconde).</span><span class="sxs-lookup"><span data-stu-id="66f27-117">The server reports the duration of an event in microseconds (one millionth, or 10<sup>-6</sup>, of a second) and the amount of CPU time used by the event in milliseconds (one thousandth, or 10<sup>-3</sup>, of a second).</span></span> <span data-ttu-id="66f27-118">L'interface utilisateur graphique de [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] affiche par défaut la colonne **Durée** en millisecondes. Cependant, quand la trace est enregistrée dans un fichier ou une table de base de données, la valeur de la colonne **Durée** est mentionnée en microsecondes.</span><span class="sxs-lookup"><span data-stu-id="66f27-118">The [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] graphical user interface displays the **Duration** column in milliseconds by default, but when a trace is saved to either a file or a database table, the **Duration** column value is written in microseconds.</span></span>  
  
## <a name="displaying-object-names-when-viewing-traces"></a><span data-ttu-id="66f27-119">Affichage de noms d'objets durant l'affichage des traces</span><span class="sxs-lookup"><span data-stu-id="66f27-119">Displaying Object Names When Viewing Traces</span></span>  
 <span data-ttu-id="66f27-120">Pour afficher le nom d’un objet au lieu de son identificateur (**Object ID**), vous devez capturer les colonnes **Server Name** et **Database ID** en plus de la colonne **Object Name** .</span><span class="sxs-lookup"><span data-stu-id="66f27-120">If you wish to display the name of an object rather than the object identifier (**Object ID**), you must capture the **Server Name** and **Database ID** data columns along with the **Object Name** data column.</span></span>  
  
 <span data-ttu-id="66f27-121">Si vous choisissez de regrouper les traces par **Object ID** , assurez-vous de les regrouper d’abord par **Server Name** et par **Database ID** , puis par **Object ID** .</span><span class="sxs-lookup"><span data-stu-id="66f27-121">If you choose to group by the **Object ID** data column, make sure you group by the **Server Name** and **Database ID** data columns first, and then by the **Object ID** data column.</span></span> <span data-ttu-id="66f27-122">De même, si vous choisissez de regrouper les traces par **Index ID** , assurez-vous de les regrouper d’abord par **Server Name**, **Database ID**et **Object ID** , puis par **Index ID** .</span><span class="sxs-lookup"><span data-stu-id="66f27-122">Similarly, if you choose to group by the **Index ID** data column, make sure you group by the **Server Name**, **Database ID**, and **Object ID** data columns first, and then by the **Index ID** data columns.</span></span> <span data-ttu-id="66f27-123">Cet ordre doit être respecté parce que les ID d'objet et d'index ne sont pas les mêmes sur tous les serveurs et dans toutes les bases de données (et un objet n'a pas toujours le même ID d'index).</span><span class="sxs-lookup"><span data-stu-id="66f27-123">You must group in this order because object and index IDs are not unique among servers and databases (and among objects for index IDs).</span></span>  
  
## <a name="finding-specific-events-within-a-trace"></a><span data-ttu-id="66f27-124">Détection d'événements spécifiques dans une trace</span><span class="sxs-lookup"><span data-stu-id="66f27-124">Finding Specific Events Within a Trace</span></span>  
 <span data-ttu-id="66f27-125">Pour rechercher des événements dans une trace et les regrouper, exécutez les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="66f27-125">To find and group events in a trace, follow these steps:</span></span>  
  
1.  <span data-ttu-id="66f27-126">Créez votre trace.</span><span class="sxs-lookup"><span data-stu-id="66f27-126">Create your trace.</span></span>  
  
    -   <span data-ttu-id="66f27-127">Lorsque vous définissez la trace, capturez les colonnes de données **Event Class**, **ClientProcessID**et **Start Time** en plus des autres colonnes de données que vous souhaitez capturer.</span><span class="sxs-lookup"><span data-stu-id="66f27-127">When defining the trace, capture the **Event Class**, **ClientProcessID**, and **Start Time** data columns in addition to any other data columns you want to capture.</span></span> <span data-ttu-id="66f27-128">Pour plus d’informations, consultez [Créer une trace &#40;SQL Server Profiler&#41;](create-a-trace-sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="66f27-128">For more information, see [Create a Trace &#40;SQL Server Profiler&#41;](create-a-trace-sql-server-profiler.md).</span></span>  
  
    -   <span data-ttu-id="66f27-129">Regroupez les données capturées sur la colonne **Event Class**, puis capturez la trace dans un fichier ou une table.</span><span class="sxs-lookup"><span data-stu-id="66f27-129">Group the captured data by the **Event Class**data column, and capture the trace to a file or table.</span></span> <span data-ttu-id="66f27-130">Pour regrouper les données capturées, cliquez sur **Organiser les colonnes** dans l'onglet **Sélection des événements** de la boîte de dialogue Propriétés de la trace.</span><span class="sxs-lookup"><span data-stu-id="66f27-130">To group the captured data, click **Organize Columns** on the **Events Selection** tab of the Trace Properties dialog box.</span></span> <span data-ttu-id="66f27-131">Pour plus d’informations, consultez [Organiser les colonnes affichées dans une trace &#40;SQL Server Profiler&#41;](organize-columns-displayed-in-a-trace-sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="66f27-131">For more information, see [Organize Columns Displayed in a Trace &#40;SQL Server Profiler&#41;](organize-columns-displayed-in-a-trace-sql-server-profiler.md).</span></span>  
  
    -   <span data-ttu-id="66f27-132">Démarrez la trace et arrêtez-la une fois que la durée spécifiée est écoulée ou que les événements nécessaires ont été capturés.</span><span class="sxs-lookup"><span data-stu-id="66f27-132">Start the trace and stop it after the appropriate time has passed or number of events have been captured.</span></span>  
  
2.  <span data-ttu-id="66f27-133">Trouvez les événements cibles.</span><span class="sxs-lookup"><span data-stu-id="66f27-133">Find the target events.</span></span>  
  
    -   <span data-ttu-id="66f27-134">Ouvrez le fichier ou la table de trace et développez le nœud de la classe d'événements de votre choix, par exemple **Deadlock Chain**.</span><span class="sxs-lookup"><span data-stu-id="66f27-134">Open the trace file or table, and expand the node of the desired event class; for example, **Deadlock Chain**.</span></span> <span data-ttu-id="66f27-135">Pour plus d’informations, consultez [Ouvrir un fichier de trace &#40;SQL Server Profiler&#41;](open-a-trace-file-sql-server-profiler.md) ou l'Assistant Paramétrage du [Ouvrir une table de trace &#40;SQL Server Profiler&#41;](open-a-trace-table-sql-server-profiler.md).</span><span class="sxs-lookup"><span data-stu-id="66f27-135">For more information, see [Open a Trace File &#40;SQL Server Profiler&#41;](open-a-trace-file-sql-server-profiler.md) or [Open a Trace Table &#40;SQL Server Profiler&#41;](open-a-trace-table-sql-server-profiler.md).</span></span>  
  
    -   <span data-ttu-id="66f27-136">Parcourez la trace jusqu’à ce que vous trouviez les événements que vous recherchez (pour vous aider, utilisez l’option **Rechercher** du menu **Modifier** de [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] ).</span><span class="sxs-lookup"><span data-stu-id="66f27-136">Search through the trace data until you find the events for which you are looking (use the **Find** command on the **Edit** menu of [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to help you find values in the trace).</span></span> <span data-ttu-id="66f27-137">Notez les valeurs contenues dans les colonnes de données **ClientProcessID** et **Start Time** des événements de votre choix.</span><span class="sxs-lookup"><span data-stu-id="66f27-137">Note the values in the **ClientProcessID** and **Start Time** data columns of the events you trace.</span></span>  
  
3.  <span data-ttu-id="66f27-138">Affichez les événements en contexte.</span><span class="sxs-lookup"><span data-stu-id="66f27-138">Display the events in context.</span></span>  
  
    -   <span data-ttu-id="66f27-139">Affichez les propriétés de la trace, et regroupez-les par **ClientProcessID**plutôt que par **Event Class** .</span><span class="sxs-lookup"><span data-stu-id="66f27-139">Display the trace properties, and group by the **ClientProcessID**data column rather than by the **Event Class** data column.</span></span>  
  
    -   <span data-ttu-id="66f27-140">Développez les nœuds de chaque ID de processus client que vous souhaitez afficher.</span><span class="sxs-lookup"><span data-stu-id="66f27-140">Expand the nodes of each client process ID you want to view.</span></span> <span data-ttu-id="66f27-141">Parcourez la trace manuellement ou utilisez l’option **Rechercher** jusqu’à ce que vous trouviez les valeurs **Start Time**précédemment notées pour les événements cibles.</span><span class="sxs-lookup"><span data-stu-id="66f27-141">Search through the trace manually, or use **Find** until you find the previously noted **Start Time**values of the target events.</span></span> <span data-ttu-id="66f27-142">Les événements sont affichés dans l'ordre chronologique avec les autres événements relatifs à chaque ID de processus client sélectionné.</span><span class="sxs-lookup"><span data-stu-id="66f27-142">The events are displayed in chronological order with the other events that belong to each selected client process ID.</span></span> <span data-ttu-id="66f27-143">Par exemple, les événements **Interblocage** et **Interblocage Chain**, capturés dans la trace, se trouveront immédiatement après les événements **SQL:BatchStarting**events within the expeted client process ID.</span><span class="sxs-lookup"><span data-stu-id="66f27-143">For example, the **Deadlock** and **Deadlock Chain**events, captured within the trace, appear immediately after the **SQL:BatchStarting**events within the expanded client process ID.</span></span>  
  
 <span data-ttu-id="66f27-144">La même technique peut être utilisée pour retrouver des événements regroupés.</span><span class="sxs-lookup"><span data-stu-id="66f27-144">The same technique can be used to find any grouped events.</span></span> <span data-ttu-id="66f27-145">Une fois que vous avez trouvé les événements recherchés, regroupez-les par **ClientProcessID**, **ApplicationName**, ou autre classe d’événements pour afficher les activités qui y sont liées dans l’ordre chronologique.</span><span class="sxs-lookup"><span data-stu-id="66f27-145">Once you have found the events you seek, group them by **ClientProcessID**, **ApplicationName**, or another event class to view related activity in chronological order.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="66f27-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="66f27-146">See Also</span></span>  
 <span data-ttu-id="66f27-147">[Afficher une trace enregistrée &#40;Transact-SQL&#41;](../../relational-databases/sql-trace/view-a-saved-trace-transact-sql.md) </span><span class="sxs-lookup"><span data-stu-id="66f27-147">[View a Saved Trace &#40;Transact-SQL&#41;](../../relational-databases/sql-trace/view-a-saved-trace-transact-sql.md) </span></span>  
 <span data-ttu-id="66f27-148">[sys.fn_trace_getinfo &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-trace-getinfo-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="66f27-148">[sys.fn_trace_getinfo &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/sys-fn-trace-getinfo-transact-sql) </span></span>  
 <span data-ttu-id="66f27-149">[Afficher des informations de filtre &#40;SQL Server Profiler&#41;](view-filter-information-sql-server-profiler.md) </span><span class="sxs-lookup"><span data-stu-id="66f27-149">[View Filter Information &#40;SQL Server Profiler&#41;](view-filter-information-sql-server-profiler.md) </span></span>  
 <span data-ttu-id="66f27-150">[Afficher des informations de filtre &#40;Transact-SQL&#41;](../../relational-databases/sql-trace/view-filter-information-transact-sql.md) </span><span class="sxs-lookup"><span data-stu-id="66f27-150">[View Filter Information &#40;Transact-SQL&#41;](../../relational-databases/sql-trace/view-filter-information-transact-sql.md) </span></span>  
 <span data-ttu-id="66f27-151">[Ouvrir un fichier de trace &#40;SQL Server Profiler&#41;](open-a-trace-file-sql-server-profiler.md) </span><span class="sxs-lookup"><span data-stu-id="66f27-151">[Open a Trace File &#40;SQL Server Profiler&#41;](open-a-trace-file-sql-server-profiler.md) </span></span>  
 [<span data-ttu-id="66f27-152">Ouvrir une table de trace &#40;SQL Server Profiler&#41;</span><span class="sxs-lookup"><span data-stu-id="66f27-152">Open a Trace Table &#40;SQL Server Profiler&#41;</span></span>](open-a-trace-table-sql-server-profiler.md)  
  
  
