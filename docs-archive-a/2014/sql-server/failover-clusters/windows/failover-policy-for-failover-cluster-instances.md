---
title: Stratégie de basculement pour les instances de cluster de basculement | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- flexible failover policy
ms.assetid: 39ceaac5-42fa-4b5d-bfb6-54403d7f0dc9
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8d441e5627280cb46168d9ff187d7f43da8b26a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605014"
---
# <a name="failover-policy-for-failover-cluster-instances"></a><span data-ttu-id="40c64-102">Stratégie de basculement pour les instances de cluster de basculement</span><span class="sxs-lookup"><span data-stu-id="40c64-102">Failover Policy for Failover Cluster Instances</span></span>
  <span data-ttu-id="40c64-103">Dans une instance de cluster de basculement (FCI) [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , un seul nœud peut posséder le groupe de ressources de cluster de basculement Windows Server (WSFC) à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="40c64-103">In a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] failover cluster instance (FCI), only one node can own the Windows Server Failover Cluster (WSFC) cluster resource group at a given time.</span></span> <span data-ttu-id="40c64-104">Les demandes des clients sont servies par ce nœud dans la FCI.</span><span class="sxs-lookup"><span data-stu-id="40c64-104">The client requests are served through this node in the FCI.</span></span> <span data-ttu-id="40c64-105">En cas d'échec et d'un redémarrage infructueux, la propriété du groupe est déplacée vers un autre nœud WSFC dans la FCI.</span><span class="sxs-lookup"><span data-stu-id="40c64-105">In the case of a failure and an unsuccessful restart, the group ownership is moved to another WSFC node in the FCI.</span></span> <span data-ttu-id="40c64-106">Ce processus s'appelle le basculement.</span><span class="sxs-lookup"><span data-stu-id="40c64-106">This process is called failover.</span></span> [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] <span data-ttu-id="40c64-107">augmente la fiabilité de la détection de pannes et fournit une stratégie de basculement flexible.</span><span class="sxs-lookup"><span data-stu-id="40c64-107">increases the reliability of failure detection and provides a flexible failover policy.</span></span>  
  
 <span data-ttu-id="40c64-108">Une FCI [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] dépend du service WSFC sous-jacent pour la détection de basculement.</span><span class="sxs-lookup"><span data-stu-id="40c64-108">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] FCI depends on the underlying WSFC service for failover detection.</span></span> <span data-ttu-id="40c64-109">Par conséquent, deux mécanismes déterminent le comportement du basculement pour la FCI : l'ancien mécanisme est une fonctionnalité WSFC native et le dernier est une fonctionnalité ajoutée par la configuration [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="40c64-109">Therefore, two mechanisms determine the failover behavior for FCI: the former is native WSFC functionality, and the latter is functionality added by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] setup.</span></span>  
  
-   <span data-ttu-id="40c64-110">Le cluster WSFC conserve la configuration du quorum, ce qui garantit une seule cible de basculement dans un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="40c64-110">The WSFC cluster maintains the quorum configuration, which ensures a unique failover target in an automatic failover.</span></span> <span data-ttu-id="40c64-111">Le service WSFC détermine si le cluster est dans une intégrité de quorum optimale à tout moment et met le groupe de ressources en ligne et hors connexion en conséquence.</span><span class="sxs-lookup"><span data-stu-id="40c64-111">The WSFC service determines whether the cluster is in optimal quorum health at all times and brings the resource group online and offline accordingly.</span></span>  
  
-   <span data-ttu-id="40c64-112">L'instance active de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] communique périodiquement un ensemble de diagnostics de composant au groupe de ressources WSFC sur une connexion dédiée.</span><span class="sxs-lookup"><span data-stu-id="40c64-112">The active [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance periodically reports a set of component diagnostics to the WSFC resource group over a dedicated connection.</span></span> <span data-ttu-id="40c64-113">Le groupe de ressources WSFC conserve la stratégie de basculement, qui définit les conditions d'échec qui déclenchent les redémarrages et les basculements.</span><span class="sxs-lookup"><span data-stu-id="40c64-113">The WSFC resource group maintains the failover policy, which defines the failure conditions that trigger restarts and failovers.</span></span>  
  
 <span data-ttu-id="40c64-114">Cette rubrique décrit le deuxième mécanisme précédemment cité.</span><span class="sxs-lookup"><span data-stu-id="40c64-114">This topic discusses the second mechanism above.</span></span> <span data-ttu-id="40c64-115">Pour plus d’informations sur le comportement de WSFC en ce qui concerne la configuration du quorum et la détection d’intégrité, consultez [Modes de quorum WSFC et configuration de vote &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="40c64-115">For more information on the WSFC behavior for quorum configuration and health detection, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="40c64-116">Les basculements automatiques vers et depuis une FCI ne sont pas autorisés dans un groupe de disponibilité AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="40c64-116">Automatic failovers to and from an FCI are not allowed in an AlwaysOn availability group.</span></span> <span data-ttu-id="40c64-117">Toutefois, les basculements manuels vers et depuis une FCI dans un groupe de disponibilité AlwaysOn sont possibles.</span><span class="sxs-lookup"><span data-stu-id="40c64-117">However, manual failovers to and from and FCI are allowed in an AlwaysOn availability group.</span></span>  
  
##  <a name="failover-policy-overview"></a><a name="Concepts"></a> <span data-ttu-id="40c64-118">Présentation de la stratégie de basculement</span><span class="sxs-lookup"><span data-stu-id="40c64-118">Failover Policy Overview</span></span>  
 <span data-ttu-id="40c64-119">Le processus de basculement comporte les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="40c64-119">The failover process can be broken down into the following steps:</span></span>  
  
1.  [<span data-ttu-id="40c64-120">Surveillance de l'état d'intégrité</span><span class="sxs-lookup"><span data-stu-id="40c64-120">Monitor the Health Status</span></span>](failover-policy-for-failover-cluster-instances.md#monitor)  
  
2.  [<span data-ttu-id="40c64-121">Détermination des échecs</span><span class="sxs-lookup"><span data-stu-id="40c64-121">Determining Failures</span></span>](failover-policy-for-failover-cluster-instances.md#determine)  
  
3.  [<span data-ttu-id="40c64-122">Réponse aux échecs</span><span class="sxs-lookup"><span data-stu-id="40c64-122">Responding to Failures</span></span>](failover-policy-for-failover-cluster-instances.md#respond)  
  
###  <a name="monitor-the-health-status"></a><a name="monitor"></a><span data-ttu-id="40c64-123">Surveiller l’état d’intégrité</span><span class="sxs-lookup"><span data-stu-id="40c64-123">Monitor the Health Status</span></span>  
 <span data-ttu-id="40c64-124">Il existe trois types d'états qui sont surveillés pour la FCI :</span><span class="sxs-lookup"><span data-stu-id="40c64-124">There are three types of health statuses that are monitored for the FCI:</span></span>  
  
-   [<span data-ttu-id="40c64-125">État du service de SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-125">State of the SQL Server service</span></span>](failover-policy-for-failover-cluster-instances.md#service)  
  
-   [<span data-ttu-id="40c64-126">Réactivité de l'instance SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-126">Responsiveness of the SQL Server instance</span></span>](failover-policy-for-failover-cluster-instances.md#instance)  
  
-   [<span data-ttu-id="40c64-127">Diagnostics de composant SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-127">SQL Server component diagnostics</span></span>](failover-policy-for-failover-cluster-instances.md#component)  
  
####  <a name="state-of-the-sql-server-service"></a><a name="service"></a> <span data-ttu-id="40c64-128">État de l'instance du service SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-128">State of the SQL Server service</span></span>  
 <span data-ttu-id="40c64-129">Le service WSFC surveille l'état de démarrage du service SQL Server sur le nœud FCI actif pour détecter l'arrêt du service SQL Server.</span><span class="sxs-lookup"><span data-stu-id="40c64-129">The WSFC service monitors the start state of the SQL Server service on the active FCI node to detect when the SQL Server service is stopped.</span></span>  
  
####  <a name="responsiveness-of-the-sql-server-instance"></a><a name="instance"></a><span data-ttu-id="40c64-130">Réactivité de l’instance de SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-130">Responsiveness of the SQL Server instance</span></span>  
 <span data-ttu-id="40c64-131">Pendant le démarrage de SQL Server, le service WSFC utilise la DLL de ressource du moteur de base de données SQL Server pour créer une nouvelle connexion sur un thread séparé utilisé exclusivement pour surveiller l'état d'intégrité.</span><span class="sxs-lookup"><span data-stu-id="40c64-131">During SQL Server startup, the WSFC service uses the SQL Server Database Engine resource DLL to create a new connection to on a separate thread that is used exclusively for monitoring the health status.</span></span> <span data-ttu-id="40c64-132">Cela garantit que l'instance SQL dispose des ressources requises pour signaler son état d'intégrité lorsqu'elle est sous charge.</span><span class="sxs-lookup"><span data-stu-id="40c64-132">This ensures that there the SQL instance has the required resources to report its health status while under load.</span></span> <span data-ttu-id="40c64-133">En utilisant cette connexion dédiée, SQL Server exécute la procédure stockée système [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) en mode de répétition pour signaler périodiquement l’état d’intégrité des composants SQL Server à la DLL de ressource.</span><span class="sxs-lookup"><span data-stu-id="40c64-133">Using this dedicated connection, SQL Server runs the [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) system stored procedure in repeat mode to periodically report the health status of the SQL Server components to the resource DLL.</span></span>  
  
 <span data-ttu-id="40c64-134">La DLL de ressource détermine la réactivité de l'instance SQL en utilisant un délai d'attente de contrôle d'intégrité.</span><span class="sxs-lookup"><span data-stu-id="40c64-134">The resource DLL determines the responsiveness of the SQL instance using a health check timeout.</span></span> <span data-ttu-id="40c64-135">La propriété HealthCheckTimeout définit la durée pendant laquelle la DLL de ressource doit attendre la procédure stockée sp_server_diagnostics avant de signaler que l'instance SQL ne répond pas au service WSFC.</span><span class="sxs-lookup"><span data-stu-id="40c64-135">The HealthCheckTimeout property defines how long the resource DLL should wait for the sp_server_diagnostics stored procedure before it reports the SQL instance as unresponsive to the WSFC service.</span></span> <span data-ttu-id="40c64-136">Cette propriété est configurable à l'aide de T-SQL ainsi que dans le composant logiciel enfichable Gestionnaire du cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="40c64-136">This property is configurable using T-SQL as well as in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="40c64-137">Pour plus d’informations, consultez [Configurer les paramètres de propriété HealthCheckTimeout](configure-healthchecktimeout-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="40c64-137">For more information, see [Configure HealthCheckTimeout Property Settings](configure-healthchecktimeout-property-settings.md).</span></span> <span data-ttu-id="40c64-138">Les éléments suivants décrivent comment cette propriété affecte le délai d'attente et les paramètres d'intervalle de répétition :</span><span class="sxs-lookup"><span data-stu-id="40c64-138">The following items describe how this property affects timeout and repeat interval settings:</span></span>  
  
-   <span data-ttu-id="40c64-139">La DLL de ressource appelle la procédure stockée sp_server_diagnostics et définit l'intervalle de répétition à un tiers du paramètre HealthCheckTimeout.</span><span class="sxs-lookup"><span data-stu-id="40c64-139">The resource DLL calls the sp_server_diagnostics stored procedure and sets the repeat interval to one-third of the HealthCheckTimeout setting.</span></span>  
  
-   <span data-ttu-id="40c64-140">Si la procédure stockée sp_server_diagnostics est lente ou si elle ne retourne pas d'informations, la DLL de ressource attendra l'intervalle spécifié par HealthCheckTimeout avant de signaler au service WSFC que l'instance SQL est sans réponse.</span><span class="sxs-lookup"><span data-stu-id="40c64-140">If the sp_server_diagnostics stored procedure is slow or is not returning information, the resource DLL will wait for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
-   <span data-ttu-id="40c64-141">Si la connexion dédiée est perdue, la DLL de ressource retentera la connexion à l'instance SQL à l'intervalle spécifié par HealthCheckTimeout avant de signaler au service WSFC que l'instance SQL ne répond pas.</span><span class="sxs-lookup"><span data-stu-id="40c64-141">If the dedicated connection is lost, the resource DLL will retry the connection to the SQL instance for the interval specified by HealthCheckTimeout before it reports to the WSFC service that the SQL instance is unresponsive.</span></span>  
  
####  <a name="sql-server-component-diagnostics"></a><a name="component"></a><span data-ttu-id="40c64-142">Diagnostics du composant SQL Server</span><span class="sxs-lookup"><span data-stu-id="40c64-142">SQL Server component diagnostics</span></span>  
 <span data-ttu-id="40c64-143">La procédure stockée système sp_server_diagnostics collecte périodiquement les diagnostics de composant sur l'instance SQL.</span><span class="sxs-lookup"><span data-stu-id="40c64-143">The system stored procedure sp_server_diagnostics periodically collects component diagnostics on the SQL instance.</span></span> <span data-ttu-id="40c64-144">Les informations de diagnostic collectées sont exposées en surface sous forme de ligne pour chacun des composants suivants et passées au thread appelant.</span><span class="sxs-lookup"><span data-stu-id="40c64-144">The diagnostic information that is collected is surfaced as a row for each of the following components and passed to the calling thread.</span></span>  
  
1.  <span data-ttu-id="40c64-145">système</span><span class="sxs-lookup"><span data-stu-id="40c64-145">system</span></span>  
  
2.  <span data-ttu-id="40c64-146">resource</span><span class="sxs-lookup"><span data-stu-id="40c64-146">resource</span></span>  
  
3.  <span data-ttu-id="40c64-147">query process</span><span class="sxs-lookup"><span data-stu-id="40c64-147">query process</span></span>  
  
4.  <span data-ttu-id="40c64-148">io_subsystem</span><span class="sxs-lookup"><span data-stu-id="40c64-148">io_subsystem</span></span>  
  
5.  <span data-ttu-id="40c64-149">événements</span><span class="sxs-lookup"><span data-stu-id="40c64-149">events</span></span>  
  
 <span data-ttu-id="40c64-150">Les composants system, resource et query process sont utilisés pour la détection de défaillance.</span><span class="sxs-lookup"><span data-stu-id="40c64-150">The system, resource, and query process components are used for failure detection.</span></span> <span data-ttu-id="40c64-151">Les composants io_subsytem et events sont utilisés uniquement à des fins de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="40c64-151">The io_subsytem and events components are used for diagnostic purposes only.</span></span>  
  
 <span data-ttu-id="40c64-152">Chaque ensemble de lignes d'informations est également écrit dans le journal de diagnostic du cluster SQL Server.</span><span class="sxs-lookup"><span data-stu-id="40c64-152">Each rowset of information is also written to the SQL Server cluster diagnostics log.</span></span> <span data-ttu-id="40c64-153">Pour plus d’informations, consultez [Afficher et lire le journal de diagnostic de l’instance de cluster de basculement](view-and-read-failover-cluster-instance-diagnostics-log.md).</span><span class="sxs-lookup"><span data-stu-id="40c64-153">For more information, see [View and Read Failover Cluster Instance Diagnostics Log](view-and-read-failover-cluster-instance-diagnostics-log.md).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="40c64-154">Lorsque la procédure stockée sp_server_diagnostic est utilisée par la technologie SQL Server AlwaysOn, elle peut être utilisée dans n'importe quelle instance de SQL Server pour aider à détecter et résoudre les problèmes.</span><span class="sxs-lookup"><span data-stu-id="40c64-154">While the sp_server_diagnostic stored procedure is used by SQL Server AlwaysOn technology, it is available for use in any SQL Server instance to help detect and troubleshoot problems.</span></span>  
  
####  <a name="determining-failures"></a><a name="determine"></a> <span data-ttu-id="40c64-155">Détermination des échecs</span><span class="sxs-lookup"><span data-stu-id="40c64-155">Determining Failures</span></span>  
 <span data-ttu-id="40c64-156">La DLL de ressource du moteur de base de données SQL Server détermine si l'état d'intégrité détecté est une condition d'échec à l'aide de la propriété FailureConditionLevel.</span><span class="sxs-lookup"><span data-stu-id="40c64-156">The SQL Server Database Engine resource DLL determines whether the detected health status is a condition for failure using the FailureConditionLevel property.</span></span> <span data-ttu-id="40c64-157">La propriété FailureConditionLevel définit les états d'intégrité détectés qui causent les redémarrages ou les basculements.</span><span class="sxs-lookup"><span data-stu-id="40c64-157">The FailureConditionLevel property defines which detected health statuses cause restarts or failovers.</span></span> <span data-ttu-id="40c64-158">Plusieurs niveaux d'options sont disponibles : il est possible de définir qu'aucun redémarrage ou du basculement automatique ne sera effectué ou bien de configurer les conditions d'échec possibles aboutissant à un redémarrage ou un basculement automatique.</span><span class="sxs-lookup"><span data-stu-id="40c64-158">Multiple levels of options are available, ranging from no automatic restart or failover to all possible failure conditions resulting in an automatic restart or failover.</span></span> <span data-ttu-id="40c64-159">Pour plus d’informations sur la configuration de cette propriété, consultez [Configurer les paramètres de propriété FailureConditionLevel](configure-failureconditionlevel-property-settings.md).</span><span class="sxs-lookup"><span data-stu-id="40c64-159">For more information about how to configure this property, see [Configure FailureConditionLevel Property Settings](configure-failureconditionlevel-property-settings.md).</span></span>  
  
 <span data-ttu-id="40c64-160">Les conditions d'échec sont définies sur une échelle croissante.</span><span class="sxs-lookup"><span data-stu-id="40c64-160">The failure conditions are set on an increasing scale.</span></span> <span data-ttu-id="40c64-161">Pour les niveaux 1-5, chaque niveau inclut toutes les conditions des niveaux précédents en plus de ses propres conditions.</span><span class="sxs-lookup"><span data-stu-id="40c64-161">For levels 1-5, each level includes all the conditions from the previous levels in addition to its own conditions.</span></span> <span data-ttu-id="40c64-162">Cela signifie qu'à chaque niveau, la probabilité de basculement ou de redémarrage est plus importante.</span><span class="sxs-lookup"><span data-stu-id="40c64-162">This means that with each level, there is an increased probability of a failover or restart.</span></span> <span data-ttu-id="40c64-163">Les niveaux de la condition d'échec sont décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="40c64-163">The failure condition levels are described in the following table.</span></span>  
  
 <span data-ttu-id="40c64-164">Examinez la procédure stockée système [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql), car elle joue un rôle important pour les niveaux de condition d’échec.</span><span class="sxs-lookup"><span data-stu-id="40c64-164">Review [sp_server_diagnostics &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-server-diagnostics-transact-sql) as this system stored procedure plays in important role in the failure condition levels.</span></span>  
  
|<span data-ttu-id="40c64-165">Level</span><span class="sxs-lookup"><span data-stu-id="40c64-165">Level</span></span>|<span data-ttu-id="40c64-166">Condition</span><span class="sxs-lookup"><span data-stu-id="40c64-166">Condition</span></span>|<span data-ttu-id="40c64-167">Description</span><span class="sxs-lookup"><span data-stu-id="40c64-167">Description</span></span>|  
|-----------|---------------|-----------------|  
|<span data-ttu-id="40c64-168">0</span><span class="sxs-lookup"><span data-stu-id="40c64-168">0</span></span>|<span data-ttu-id="40c64-169">Aucun basculement ou redémarrage automatique</span><span class="sxs-lookup"><span data-stu-id="40c64-169">No automatic failover or restart</span></span>|<span data-ttu-id="40c64-170">Indique qu'aucun basculement ou redémarrage ne sera déclenché automatiquement sur n'importe quelle condition d'échec.</span><span class="sxs-lookup"><span data-stu-id="40c64-170">Indicates that no failover or restart will be triggered automatically on any failure conditions.</span></span> <span data-ttu-id="40c64-171">Ce niveau existe uniquement à des fins de maintenance système.</span><span class="sxs-lookup"><span data-stu-id="40c64-171">This level is for system maintenance purposes only.</span></span>|  
|<span data-ttu-id="40c64-172">1</span><span class="sxs-lookup"><span data-stu-id="40c64-172">1</span></span>|<span data-ttu-id="40c64-173">Basculement ou redémarrage sur arrêt du serveur</span><span class="sxs-lookup"><span data-stu-id="40c64-173">Failover or restart on server down</span></span>|<span data-ttu-id="40c64-174">Indique qu'un redémarrage ou basculement de serveur sera déclenché en fonction de la condition suivante :</span><span class="sxs-lookup"><span data-stu-id="40c64-174">Indicates that a server restart or failover will be triggered if the following condition is raised:</span></span><br /><br /> <span data-ttu-id="40c64-175">Le service SQL Server est fermé.</span><span class="sxs-lookup"><span data-stu-id="40c64-175">SQL Server service is down.</span></span>|  
|<span data-ttu-id="40c64-176">2</span><span class="sxs-lookup"><span data-stu-id="40c64-176">2</span></span>|<span data-ttu-id="40c64-177">Basculement ou redémarrage sur non-réponse du serveur</span><span class="sxs-lookup"><span data-stu-id="40c64-177">Failover or restart on server unresponsive</span></span>|<span data-ttu-id="40c64-178">Indique qu'un redémarrage ou basculement de serveur sera déclenché si l'une des conditions suivantes est rencontrée :</span><span class="sxs-lookup"><span data-stu-id="40c64-178">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="40c64-179">Le service SQL Server est fermé.</span><span class="sxs-lookup"><span data-stu-id="40c64-179">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="40c64-180">L'instance SQL Server ne répond pas (la DLL de ressource ne reçoit pas des données de sp_server_diagnostics dans les paramètres HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="40c64-180">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span>|  
|<span data-ttu-id="40c64-181">3\*</span><span class="sxs-lookup"><span data-stu-id="40c64-181">3\*</span></span>|<span data-ttu-id="40c64-182">Basculement ou redémarrage sur des erreurs de serveur critiques</span><span class="sxs-lookup"><span data-stu-id="40c64-182">Failover or restart on critical server errors</span></span>|<span data-ttu-id="40c64-183">Indique qu'un redémarrage ou basculement de serveur sera déclenché si l'une des conditions suivantes est rencontrée :</span><span class="sxs-lookup"><span data-stu-id="40c64-183">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="40c64-184">Le service SQL Server est fermé.</span><span class="sxs-lookup"><span data-stu-id="40c64-184">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="40c64-185">L'instance SQL Server ne répond pas (la DLL de ressource ne reçoit pas des données de sp_server_diagnostics dans les paramètres HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="40c64-185">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="40c64-186">La procédure stockée système sp_server_diagnostics retourne « erreur système ».</span><span class="sxs-lookup"><span data-stu-id="40c64-186">System stored procedure sp_server_diagnostics returns 'system error'.</span></span>|  
|<span data-ttu-id="40c64-187">4</span><span class="sxs-lookup"><span data-stu-id="40c64-187">4</span></span>|<span data-ttu-id="40c64-188">Basculement ou redémarrage sur des erreurs de serveur modérées</span><span class="sxs-lookup"><span data-stu-id="40c64-188">Failover or restart on moderate server errors</span></span>|<span data-ttu-id="40c64-189">Indique qu'un redémarrage ou basculement de serveur sera déclenché si l'une des conditions suivantes est rencontrée :</span><span class="sxs-lookup"><span data-stu-id="40c64-189">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="40c64-190">Le service SQL Server est fermé.</span><span class="sxs-lookup"><span data-stu-id="40c64-190">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="40c64-191">L'instance SQL Server ne répond pas (la DLL de ressource ne reçoit pas des données de sp_server_diagnostics dans les paramètres HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="40c64-191">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="40c64-192">La procédure stockée système sp_server_diagnostics retourne « erreur système ».</span><span class="sxs-lookup"><span data-stu-id="40c64-192">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="40c64-193">La procédure stockée système sp_server_diagnostics retourne « erreur de ressource ».</span><span class="sxs-lookup"><span data-stu-id="40c64-193">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span>|  
|<span data-ttu-id="40c64-194">5</span><span class="sxs-lookup"><span data-stu-id="40c64-194">5</span></span>|<span data-ttu-id="40c64-195">Basculement ou redémarrage sur toutes les conditions d'échec qualifiées</span><span class="sxs-lookup"><span data-stu-id="40c64-195">Failover or restart on any qualified failure conditions</span></span>|<span data-ttu-id="40c64-196">Indique qu'un redémarrage ou basculement de serveur sera déclenché si l'une des conditions suivantes est rencontrée :</span><span class="sxs-lookup"><span data-stu-id="40c64-196">Indicates that a server restart or failover will be triggered if any of the following conditions are raised:</span></span><br /><br /> <span data-ttu-id="40c64-197">Le service SQL Server est fermé.</span><span class="sxs-lookup"><span data-stu-id="40c64-197">SQL Server service is down.</span></span><br /><br /> <span data-ttu-id="40c64-198">L'instance SQL Server ne répond pas (la DLL de ressource ne reçoit pas des données de sp_server_diagnostics dans les paramètres HealthCheckTimeout).</span><span class="sxs-lookup"><span data-stu-id="40c64-198">SQL Server instance is not responsive (Resource DLL cannot receive data from sp_server_diagnostics within the HealthCheckTimeout settings).</span></span><br /><br /> <span data-ttu-id="40c64-199">La procédure stockée système sp_server_diagnostics retourne « erreur système ».</span><span class="sxs-lookup"><span data-stu-id="40c64-199">System stored procedure sp_server_diagnostics returns 'system error'.</span></span><br /><br /> <span data-ttu-id="40c64-200">La procédure stockée système sp_server_diagnostics retourne « erreur de ressource ».</span><span class="sxs-lookup"><span data-stu-id="40c64-200">System  stored procedure sp_server_diagnostics returns 'resource error'.</span></span><br /><br /> <span data-ttu-id="40c64-201">La procédure stockée système sp_server_diagnostics retourne une « erreur query_processing ».</span><span class="sxs-lookup"><span data-stu-id="40c64-201">System stored procedure sp_server_diagnostics returns 'query_processing error'.</span></span>|  
  
 <span data-ttu-id="40c64-202">\*Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="40c64-202">\*Default Value</span></span>  
  
####  <a name="responding-to-failures"></a><a name="respond"></a> <span data-ttu-id="40c64-203">Réponse aux échecs</span><span class="sxs-lookup"><span data-stu-id="40c64-203">Responding to Failures</span></span>  
 <span data-ttu-id="40c64-204">Lorsqu'une ou plusieurs conditions d'échec sont détectées, la manière dont le service WSFC y répond dépend de l'état du quorum WSFC et des paramètres de redémarrage et de basculement du groupe de ressources de la FCI.</span><span class="sxs-lookup"><span data-stu-id="40c64-204">After one or more failure conditions are detected, how the WSFC service responds to the failures depends on the WSFC quorum state and the restart and failover settings of the FCI resource group.</span></span> <span data-ttu-id="40c64-205">Si la FCI a perdu le quorum WSFC, alors elle est entièrement mise hors connexion et perd sa haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="40c64-205">If the FCI has lost its WSFC quorum, then the entire FCI is brought offline and the FCI has lost its high availability.</span></span> <span data-ttu-id="40c64-206">Si la FCI conserve son quorum WSFC, le service WSFC peut répondre en tentant d'abord de redémarrer le nœud en échec, puis tente un basculement si les tentatives de redémarrage ont échoué.</span><span class="sxs-lookup"><span data-stu-id="40c64-206">If the FCI still retains its WSFC quorum, then the WSFC service may respond by first attempting to restart the failed node and then failover if the restart attempts are unsuccessful.</span></span> <span data-ttu-id="40c64-207">Les paramètres de redémarrage et de basculement sont configurés dans le composant logiciel enfichable Gestionnaire du cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="40c64-207">The restart and failover settings are configured in the Failover Cluster Manager snap-in.</span></span> <span data-ttu-id="40c64-208">Pour plus d’informations sur ces paramètres, consultez [ \<Resource> Propriétés : onglet stratégies](https://technet.microsoft.com/library/cc725685.aspx).</span><span class="sxs-lookup"><span data-stu-id="40c64-208">For more information these settings, see [\<Resource> Properties: Policies Tab](https://technet.microsoft.com/library/cc725685.aspx).</span></span>  
  
 <span data-ttu-id="40c64-209">Pour plus d’informations sur la conservation de l’intégrité du quorum, consultez [Modes de quorum WSFC et configuration de vote &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="40c64-209">For more information on maintaining quorum health, see [WSFC Quorum Modes and Voting Configuration &#40;SQL Server&#41;](wsfc-quorum-modes-and-voting-configuration-sql-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="40c64-210">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="40c64-210">See Also</span></span>  
 [<span data-ttu-id="40c64-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="40c64-211">ALTER SERVER CONFIGURATION &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-server-configuration-transact-sql)  
  
  
