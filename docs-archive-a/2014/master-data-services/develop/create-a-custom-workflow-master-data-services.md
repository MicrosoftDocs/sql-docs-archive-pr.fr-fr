---
title: Créer un flux de travail personnalisé (Master Data Services) | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
ms.assetid: 8e4403e9-595c-4b6b-9d0c-f6ae1b2bc99d
author: lrtoyou1223
ms.author: lle
ms.openlocfilehash: cac53946d83eda178328b153875a86440517a560
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615182"
---
# <a name="create-a-custom-workflow-master-data-services"></a><span data-ttu-id="15ac7-102">Créer un flux de travail personnalisé (Master Data Services)</span><span class="sxs-lookup"><span data-stu-id="15ac7-102">Create a Custom Workflow (Master Data Services)</span></span>
  [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] <span data-ttu-id="15ac7-103">utilise des règles d'entreprise pour créer des solutions de flux de travail de base, comme la mise à jour et la validation automatique des données et l'envoi de notifications par courrier électronique, en fonction des conditions que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="15ac7-103">uses business rules to create basic workflow solutions, such as to automatically update and validate data and have e-mail notifications sent, based on conditions you specify.</span></span> <span data-ttu-id="15ac7-104">Lorsque vous avez besoin de traitements plus complexes que ceux fournis par ces actions de flux de travail intégrées, utilisez un flux de travail personnalisé.</span><span class="sxs-lookup"><span data-stu-id="15ac7-104">When you require processing that is more complex than what the built-in workflow actions provide, use a custom workflow.</span></span> <span data-ttu-id="15ac7-105">Un flux de travail personnalisé est un assembly .NET. que vous créez.</span><span class="sxs-lookup"><span data-stu-id="15ac7-105">A custom workflow is a .NET assembly that you create.</span></span> <span data-ttu-id="15ac7-106">Lorsque votre assembly de flux de travail est appelé, votre code peut exécuter n'importe quelle action requise par votre situation.</span><span class="sxs-lookup"><span data-stu-id="15ac7-106">When your workflow assembly is called, your code can take whatever action your situation requires.</span></span> <span data-ttu-id="15ac7-107">Par exemple, si votre flux de travail nécessite le traitement d'événements complexes, tels que des approbations multicouches ou des arbres de décision compliqués, vous pouvez configurer [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] pour démarrer un flux de travail personnalisé qui analyse les données et détermine où les transmettre pour l'approbation.</span><span class="sxs-lookup"><span data-stu-id="15ac7-107">For example, if your workflow requires complex event processing, such as multi-tiered approvals or complicated decision trees, you can configure [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] to start a custom workflow that analyzes the data and determines where to send it for approval.</span></span>  
  
## <a name="how-custom-workflows-are-processed"></a><span data-ttu-id="15ac7-108">Comment s'effectue le traitement des flux de travail personnalisés</span><span class="sxs-lookup"><span data-stu-id="15ac7-108">How Custom Workflows Are Processed</span></span>  
 <span data-ttu-id="15ac7-109">Il existe trois composants principaux impliqués dans le traitement des flux de travail personnalisés : l'application Web de [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)], le service d'intégration de flux de travail MDS SQL Server et l'assembly de gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-109">There are three main components involved to process custom workflows: the [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] web application, SQL Server MDS Workflow Integration Service, and the workflow handler assembly.</span></span> <span data-ttu-id="15ac7-110">Ces composants fonctionnent sur un flux de travail personnalisé comme suit :</span><span class="sxs-lookup"><span data-stu-id="15ac7-110">These components process a custom workflow as follows:</span></span>  
  
1.  <span data-ttu-id="15ac7-111">Vous utilisez [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] pour valider une entité qui démarre un flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-111">You use [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] to validate an entity that starts a workflow.</span></span>  
  
2.  [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] <span data-ttu-id="15ac7-112">envoie les membres qui répondent aux conditions de la règle d'entreprise à une file d'attente de Service Broker dans la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15ac7-112">sends members that meet the business rule conditions to a Service Broker queue in the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database.</span></span>  
  
3.  <span data-ttu-id="15ac7-113">À intervalles réguliers, le service d'intégration de flux de travail MDS SQL Server appelle une procédure stockée dans la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15ac7-113">At regular intervals, SQL Server MDS Workflow Integration Service calls a stored procedure in the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database.</span></span>  
  
4.  <span data-ttu-id="15ac7-114">Lorsque cette procédure stockée trouve des enregistrements dans la file d'attente de Service Broker, elle les retourne au service d'intégration de flux de travail MDS de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="15ac7-114">When this stored procedure finds records in the Service Broker queue, it returns them to SQL Server MDS Workflow Integration Service.</span></span>  
  
5.  <span data-ttu-id="15ac7-115">Les services d'intégration de flux de travail MDS de SQL Server acheminent les données vers votre assembly de gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-115">SQL Server MDS Workflow Integration Services routes the data to your workflow handler assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15ac7-116">Remarque : le service d'intégration de flux de travail MDS de SQL Server est destiné à déclencher des processus simples.</span><span class="sxs-lookup"><span data-stu-id="15ac7-116">Note: SQL Server MDS Workflow Integration Service is meant to trigger simple processes.</span></span> <span data-ttu-id="15ac7-117">Si votre code personnalisé requiert un traitement complexe, effectuez votre traitement dans un thread distinct ou à l'extérieur du processus de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-117">If your custom code requires complex processing, complete your processing either in a separate thread or outside of the workflow process.</span></span>  
  
## <a name="configure-master-data-services-for-custom-workflows"></a><span data-ttu-id="15ac7-118">Configurer des services Master Data pour les flux de travail personnalisés</span><span class="sxs-lookup"><span data-stu-id="15ac7-118">Configure Master Data Services for Custom Workflows</span></span>  
 <span data-ttu-id="15ac7-119">La création d'un flux de travail personnalisé requiert l'écriture d'un code personnalisé et la configuration de [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] pour passer les données de flux de travail à votre gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-119">Creating a custom workflow requires writing some custom code and configuring [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] to pass workflow data to your workflow handler.</span></span> <span data-ttu-id="15ac7-120">Procédez comme suit pour activer un traitement de flux de travail personnalisé :</span><span class="sxs-lookup"><span data-stu-id="15ac7-120">Follow these steps to enable custom workflow processing:</span></span>  
  
1.  <span data-ttu-id="15ac7-121">Créez un assembly .NET qui implémente [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)).</span><span class="sxs-lookup"><span data-stu-id="15ac7-121">Create a .NET assembly that implements [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)).</span></span>  
  
2.  <span data-ttu-id="15ac7-122">Configurez le service d'intégration de flux de travail MDS de SQL Server pour qu'il se connecte à votre base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] et pour associer une balise à votre gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-122">Configure SQL Server MDS Workflow Integration Service to connect to your [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database and to associate a tag with your workflow handler.</span></span>  
  
3.  <span data-ttu-id="15ac7-123">Démarrez le service d'intégration de flux de travail MDS de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="15ac7-123">Start SQL Server MDS Workflow Integration Service.</span></span>  
  
4.  <span data-ttu-id="15ac7-124">Créez une règle d'entreprise dans [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] qui démarre un flux de travail référencé avec le nom de votre gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-124">Create a business rule in [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] that starts a workflow that is tagged with the name of your workflow handler.</span></span>  
  
5.  <span data-ttu-id="15ac7-125">Appliquez la règle d'entreprise à un membre qui déclenche votre flux de travail personnalisé.</span><span class="sxs-lookup"><span data-stu-id="15ac7-125">Apply the business rule to a member that triggers your custom workflow.</span></span>  
  
### <a name="create-the-workflow-handler-assembly"></a><span data-ttu-id="15ac7-126">Créer l'assembly de gestionnaire de flux de travail</span><span class="sxs-lookup"><span data-stu-id="15ac7-126">Create the Workflow Handler Assembly</span></span>  
 <span data-ttu-id="15ac7-127">Un flux de travail personnalisé est un assembly de bibliothèque de classes .NET qui implémente l’interface [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) .</span><span class="sxs-lookup"><span data-stu-id="15ac7-127">A custom workflow is a .NET class library assembly that implements the [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) interface.</span></span> <span data-ttu-id="15ac7-128">SQL Server Service d’intégration de flux de travail MDS appelle la méthode [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender. StartWorkflow \*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)) pour exécuter votre code.</span><span class="sxs-lookup"><span data-stu-id="15ac7-128">SQL Server MDS Workflow Integration Service calls the [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender.StartWorkflow\*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)) method to run your code.</span></span> <span data-ttu-id="15ac7-129">Pour obtenir un exemple de code qui implémente [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender. StartWorkflow \*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)), consultez [exemple de flux de travail personnalisé &#40;Master Data Services&#41;](create-a-custom-workflow-example.md).</span><span class="sxs-lookup"><span data-stu-id="15ac7-129">For example code that implements [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender.StartWorkflow\*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)), see [Custom Workflow Example &#40;Master Data Services&#41;](create-a-custom-workflow-example.md).</span></span>  
  
 <span data-ttu-id="15ac7-130">Suivez ces étapes afin d'utiliser Visual Studio 2010 pour créer un assembly que le service d'intégration de flux de travail MDS de SQL Server peut appeler pour gérer un flux de travail personnalisé :</span><span class="sxs-lookup"><span data-stu-id="15ac7-130">Follow these steps to use Visual Studio 2010 to create an assembly that SQL Server MDS Workflow Integration Service can call to handle a custom workflow:</span></span>  
  
1.  <span data-ttu-id="15ac7-131">Dans Visual Studio 2010, créez un projet de **Bibliothèque de classes** qui utilise le langage de votre choix.</span><span class="sxs-lookup"><span data-stu-id="15ac7-131">In Visual Studio 2010, create a new **Class Library** project that uses the language of your choice.</span></span> <span data-ttu-id="15ac7-132">Pour créer une bibliothèque de classes C#, sélectionnez les types de projet **Visual C#\Windows**, puis sélectionnez le modèle de **Bibliothèque de classes**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-132">To create a C# Class Library, select the **Visual C#\Windows** project types and select the **Class Library** template.</span></span> <span data-ttu-id="15ac7-133">Entrez un nom pour votre projet, tel que **MDSWorkflowTest**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-133">Enter a name for your project, such as **MDSWorkflowTest**, and click **OK**.</span></span>  
  
2.  <span data-ttu-id="15ac7-134">Ajoutez une référence à Microsoft.MasterDataServices.WorkflowTypeExtender.dll.</span><span class="sxs-lookup"><span data-stu-id="15ac7-134">Add a reference to Microsoft.MasterDataServices.WorkflowTypeExtender.dll.</span></span> <span data-ttu-id="15ac7-135">Cet assembly se trouve dans \<Your installation folder> \Master Data Services\WebApplication\bin.</span><span class="sxs-lookup"><span data-stu-id="15ac7-135">This assembly can be found in \<Your installation folder>\Master Data Services\WebApplication\bin.</span></span>  
  
3.  <span data-ttu-id="15ac7-136">Ajoutez « using Microsoft.MasterDataServices.Core.Workflow; » à votre fichier de code C#.</span><span class="sxs-lookup"><span data-stu-id="15ac7-136">Add 'using Microsoft.MasterDataServices.Core.Workflow;' to your C# code file.</span></span>  
  
4.  <span data-ttu-id="15ac7-137">Héritez de [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) dans votre déclaration de classe.</span><span class="sxs-lookup"><span data-stu-id="15ac7-137">Inherit from [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) in your class declaration.</span></span> <span data-ttu-id="15ac7-138">La déclaration de classe doit ressembler à : « public class WorkflowTester : IWorkflowTypeExtender ».</span><span class="sxs-lookup"><span data-stu-id="15ac7-138">The class declaration should be similar to: 'public class WorkflowTester : IWorkflowTypeExtender'.</span></span>  
  
5.  <span data-ttu-id="15ac7-139">Implémentez l’interface [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) .</span><span class="sxs-lookup"><span data-stu-id="15ac7-139">Implement the [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender](/previous-versions/sql/sql-server-2016/hh758785(v=sql.130)) interface.</span></span> <span data-ttu-id="15ac7-140">La méthode [Microsoft. MasterDataServices. WorkflowTypeExtender. IWorkflowTypeExtender. StartWorkflow \*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)) est appelée par SQL Server Service d’intégration de flux de travail MDS pour démarrer votre flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-140">The [Microsoft.MasterDataServices.WorkflowTypeExtender.IWorkflowTypeExtender.StartWorkflow\*](/previous-versions/sql/sql-server-2016/hh759009(v=sql.130)) method is called by SQL Server MDS Workflow Integration Service to start your workflow.</span></span>  
  
6.  <span data-ttu-id="15ac7-141">Copiez votre assembly à l’emplacement de l’SQL Server fichier exécutable du service d’intégration de flux de travail MDS, nommé Microsoft.MasterDataServices.Workflow.exe, dans \<Your installation folder> \Master Data Services\WebApplication\bin.</span><span class="sxs-lookup"><span data-stu-id="15ac7-141">Copy your assembly to the location of the SQL Server MDS Workflow Integration Service executable, named Microsoft.MasterDataServices.Workflow.exe, in \<Your installation folder>\Master Data Services\WebApplication\bin.</span></span>  
  
### <a name="configure-sql-server-mds-workflow-integration-service"></a><span data-ttu-id="15ac7-142">Configurer le service d'intégration de flux de travail MDS de SQL Server</span><span class="sxs-lookup"><span data-stu-id="15ac7-142">Configure SQL Server MDS Workflow Integration Service</span></span>  
 <span data-ttu-id="15ac7-143">Modifiez le fichier de configuration de [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] pour inclure les informations de connexion de votre base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] et pour associer un indicateur à votre assembly de gestionnaire de flux de travail, en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="15ac7-143">Edit the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] configuration file to include connection information for your [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database and to associate a tag with your workflow handler assembly by following these steps:</span></span>  
  
1.  <span data-ttu-id="15ac7-144">Rechercher des Microsoft.MasterDataServices.Workflow.exe.config dans \<Your installation folder> \Master Data Services\WebApplication\bin.</span><span class="sxs-lookup"><span data-stu-id="15ac7-144">Find Microsoft.MasterDataServices.Workflow.exe.config in \<Your installation folder>\Master Data Services\WebApplication\bin.</span></span>  
  
2.  <span data-ttu-id="15ac7-145">Ajoutez les informations de connexion de la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] au paramètre « ConnectionString ».</span><span class="sxs-lookup"><span data-stu-id="15ac7-145">Add the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database connection information to the "ConnectionString" setting.</span></span> <span data-ttu-id="15ac7-146">Si votre installation [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilise un classement respectant la casse, le nom de la base de données doit être écrit selon la même casse que dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="15ac7-146">If your [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation uses case-sensitive collation, the name of the database must be entered in the same case as in the database.</span></span> <span data-ttu-id="15ac7-147">Par exemple, la balise complète du paramètre peut se présenter comme suit :</span><span class="sxs-lookup"><span data-stu-id="15ac7-147">For example, the complete setting tag might look like this:</span></span>  
  
    ```xml  
    <setting name="ConnectionString" serializeAs="String">  
        <value>Server=myServer;Database=myDatabase;Integrated Security=True</value>  
    </setting>  
    ```  
  
3.  <span data-ttu-id="15ac7-148">Sous le paramètre « ConnectionString » ajoutez un paramètre « WorkflowTypeExtenders » pour associer un nom de balise à votre assembly de gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-148">Below the "ConnectionString" setting add a "WorkflowTypeExtenders" setting to associate a tag name with your workflow handler assembly.</span></span> <span data-ttu-id="15ac7-149">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="15ac7-149">For example:</span></span>  
  
    ```xml  
    <setting name="WorkflowTypeExtenders" serializeAs="String">  
        <value>TEST=MDSWorkflowTestLib.WorkflowTester, MDSWorkflowTestLib</value>  
    </setting>  
    ```  
  
     <span data-ttu-id="15ac7-150">Le texte interne de la \<value> balise se présente sous la forme \<Workflow tag> = \<assembly-qualified workflow type name> .</span><span class="sxs-lookup"><span data-stu-id="15ac7-150">The inner text of the \<value> tag is in the form of \<Workflow tag>=\<assembly-qualified workflow type name>.</span></span> <span data-ttu-id="15ac7-151">\<Workflow tag>est un nom que vous utilisez pour identifier l’assembly du gestionnaire de flux de travail lorsque vous créez une règle d’entreprise dans [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15ac7-151">\<Workflow tag> is a name you use to identify the workflow handler assembly when you create a business rule in [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)].</span></span> <span data-ttu-id="15ac7-152">\<assembly-qualified workflow type name>est le nom qualifié par un espace de noms de votre classe de flux de travail, suivi d’une virgule, suivi du nom d’affichage de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="15ac7-152">\<assembly-qualified workflow type name> is the namespace-qualified name of your workflow class, followed by a comma, followed by the display name of the assembly.</span></span> <span data-ttu-id="15ac7-153">Si votre assembly est un nom fort, vous devez également inclure les informations de version et son PublicKeyToken.</span><span class="sxs-lookup"><span data-stu-id="15ac7-153">If your assembly is strongly named, you also have to include version information and its PublicKeyToken.</span></span> <span data-ttu-id="15ac7-154">Vous pouvez inclure plusieurs \<setting> balises si vous avez créé plusieurs gestionnaires de flux de travail pour différents genres de workflows.</span><span class="sxs-lookup"><span data-stu-id="15ac7-154">You can include multiple \<setting> tags if you have created multiple workflow handlers for different kinds of workflows.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15ac7-155">Selon la configuration de votre serveur, vous pouvez obtenir une erreur « Accès refusé » quand vous essayez d’enregistrer le fichier Microsoft.MasterDataServices.Workflow.exe.config.</span><span class="sxs-lookup"><span data-stu-id="15ac7-155">Depending on the configuration of your server, you may see an "Access is denied" error when you try to save the Microsoft.MasterDataServices.Workflow.exe.config file.</span></span> <span data-ttu-id="15ac7-156">Si cela se produit, désactivez temporairement le contrôle de compte d'utilisateur (UAC) sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="15ac7-156">If this occurs, temporarily disable User Account Control (UAC) on the server.</span></span> <span data-ttu-id="15ac7-157">Pour cela, ouvrez le panneau de configuration et cliquez sur **Système et sécurité**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-157">To do this, open Control Panel, click **System and Security**.</span></span> <span data-ttu-id="15ac7-158">Sous **Centre de maintenance**, cliquez sur **Modifier les paramètres du contrôle de compte d’utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-158">Under **Action Center**, click **Change User Account Control Settings**.</span></span> <span data-ttu-id="15ac7-159">Dans la boîte de dialogue **Paramètres de contrôle de compte d’utilisateur**, faites glisser la barre vers le bas afin de ne pas recevoir de notification.</span><span class="sxs-lookup"><span data-stu-id="15ac7-159">In the **User Account Control Settings** dialog, slide the bar to the bottom so that you are never notified.</span></span> <span data-ttu-id="15ac7-160">Redémarrez votre ordinateur et répétez les étapes précédentes pour modifier votre fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="15ac7-160">Restart your computer and repeat the preceding steps to edit your configuration file.</span></span> <span data-ttu-id="15ac7-161">Après l'enregistrement du fichier, réinitialisez les paramètres de contrôle de compte d'utilisateur au niveau par défaut.</span><span class="sxs-lookup"><span data-stu-id="15ac7-161">After saving the file, reset your UAC settings to the default level.</span></span>  
  
### <a name="start-sql-server-mds-workflow-integration-service"></a><span data-ttu-id="15ac7-162">Démarrer le service d'intégration de flux de travail MDS de SQL Server</span><span class="sxs-lookup"><span data-stu-id="15ac7-162">Start SQL Server MDS Workflow Integration Service</span></span>  
 <span data-ttu-id="15ac7-163">Par défaut, le service d'intégration de flux de travail MDS de SQL Server n'est pas installé.</span><span class="sxs-lookup"><span data-stu-id="15ac7-163">By default, SQL Server MDS Workflow Integration Service is not installed.</span></span> <span data-ttu-id="15ac7-164">Vous devez installer le service avant de pouvoir l'utiliser.</span><span class="sxs-lookup"><span data-stu-id="15ac7-164">You must install the service before it can be used.</span></span> <span data-ttu-id="15ac7-165">Pour plus de sécurité, créez un utilisateur local pour le service et accordez à cet utilisateur uniquement les autorisations nécessaires pour effectuer les opérations de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-165">For the greatest security, create a local user for the service and grant this user only the permissions needed to perform workflow operations.</span></span> <span data-ttu-id="15ac7-166">Pour créer un utilisateur, installer le service et le démarrer, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="15ac7-166">To create a user, install the service, and start the service, follow these steps:</span></span>  
  
1.  <span data-ttu-id="15ac7-167">Utilisez les utilisateurs locaux et le gestionnaire de groupes pour créer un utilisateur local nommé, par exemple, mds_workflow_service.</span><span class="sxs-lookup"><span data-stu-id="15ac7-167">Use the Local Users and Groups manager to create a local user named, for example, mds_workflow_service.</span></span>  
  
2.  <span data-ttu-id="15ac7-168">Utilisez SQL Server Management Studio pour accorder l'autorisation utilisateur mds_workflow_service permettant d'exécuter la procédure stockée [mdm].[udpExternalActionsGet].</span><span class="sxs-lookup"><span data-stu-id="15ac7-168">Use SQL Server Management Studio to grant the mds_workflow_service user permission to execute the [mdm].[udpExternalActionsGet] stored procedure.</span></span> <span data-ttu-id="15ac7-169">Pour cela, créez une connexion pour le compte mds_workflow_service, créez un nouvel utilisateur dans la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)], mappez cet utilisateur à la connexion mds_workflow_service et accordez l'autorisation utilisateur EXECUTE à la procédure stockée [mdm].[udpExternalActionsGet].</span><span class="sxs-lookup"><span data-stu-id="15ac7-169">To do this, create a new login for the mds_workflow_service account, create a new user in the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database, map this user to the mds_workflow_service login, and grant the user EXECUTE permission to the [mdm].[udpExternalActionsGet] stored procedure.</span></span>  
  
3.  <span data-ttu-id="15ac7-170">Octroyez l'autorisation utilisateur mds_workflow_service pour exécuter l'assembly de gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-170">Grant the mds_workflow_service user permission to execute the workflow handler assembly.</span></span> <span data-ttu-id="15ac7-171">Pour cela, ajoutez l’utilisateur mds_workflow_service à l’onglet **Sécurité** de la boîte de dialogue **Propriétés** de l’assembly du gestionnaire de flux de travail et accordez à l’utilisateur mds_workflow_service les autorisations READ et EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="15ac7-171">To do this, add the mds_workflow_service user to the **Security** tab of the **Properties** of the workflow handler assembly and grant the mds_workflow_service user READ and EXECUTE permission.</span></span>  
  
4.  <span data-ttu-id="15ac7-172">Accordez l'autorisation utilisateur mds_workflow_service pour exécuter l'exécutable du service d'intégration de flux de travail MDS de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="15ac7-172">Grant the mds_workflow_service user permission to execute the SQL Server MDS Workflow Integration Service executable.</span></span> <span data-ttu-id="15ac7-173">Pour ce faire, ajoutez l’utilisateur mds_workflow_service à l’onglet **sécurité** des **Propriétés** de Microsoft.MasterDataServices.Workflow.exe, dans \<Your installation folder> \Master Data Services\WebApplication\bin et accordez à l’utilisateur MDS_WORKFLOW_SERVICE l’autorisation lecture et exécution.</span><span class="sxs-lookup"><span data-stu-id="15ac7-173">To do this, add the mds_workflow_service user to the **Security** tab of the **Properties** of Microsoft.MasterDataServices.Workflow.exe, in \<Your installation folder>\Master Data Services\WebApplication\bin and grant the mds_workflow_service user READ and EXECUTE permission.</span></span>  
  
5.  <span data-ttu-id="15ac7-174">Installez le service d'intégration de flux de travail MDS de SQL Server à l'aide de l'utilitaire d'installation .NET, nommé InstallUtil.exe.</span><span class="sxs-lookup"><span data-stu-id="15ac7-174">Install SQL Server MDS Workflow Integration Service by using the .NET installation utility, named InstallUtil.exe.</span></span> <span data-ttu-id="15ac7-175">InstallUtil.exe se trouve dans le dossier d’installation de .NET, par exemple C:\Windows\Microsoft.NET\Framework\v4.0.30319\\.</span><span class="sxs-lookup"><span data-stu-id="15ac7-175">InstallUtil.exe can be found in the .NET installation folder, such as C:\Windows\Microsoft.NET\Framework\v4.0.30319\\.</span></span> <span data-ttu-id="15ac7-176">Installez le service d'intégration de flux de travail MDS de SQL Server en entrant la commande suivante à l'invite de commandes avec élévation de privilèges :</span><span class="sxs-lookup"><span data-stu-id="15ac7-176">Install SQL Server MDS Workflow Integration Service by entering the following in an elevated command prompt:</span></span>  
  
    ```  
    C:\Windows\Microsoft.NET\Framework\v4.0.30319\InstallUtil Microsoft.MasterDataServices.Workflow.exe  
    ```  
  
     <span data-ttu-id="15ac7-177">Spécifiez l'utilisateur mds_workflow_service lorsque vous y êtes invité pendant l'installation.</span><span class="sxs-lookup"><span data-stu-id="15ac7-177">Specify the mds_workflow_service user when prompted during installation.</span></span>  
  
6.  <span data-ttu-id="15ac7-178">Démarrez le service d'intégration de flux de travail MDS de SQL Server à l'aide du composant logiciel enfichable Services.</span><span class="sxs-lookup"><span data-stu-id="15ac7-178">Start SQL Server MDS Workflow Integration Service by using the Services snap-in.</span></span> <span data-ttu-id="15ac7-179">Pour cela, recherchez le service d’intégration de flux de travail MDS de SQL Server dans le composant logiciel enfichable Services, sélectionnez-le, puis cliquez sur le lien **Démarrer**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-179">To do this, find SQL Server MDS Workflow Integration Service in the Services snap-in, select it, and click the  **Start** link.</span></span>  
  
### <a name="create-a-workflow-business-rule"></a><span data-ttu-id="15ac7-180">Créer une règle d'entreprise de flux de travail</span><span class="sxs-lookup"><span data-stu-id="15ac7-180">Create a Workflow Business Rule</span></span>  
 <span data-ttu-id="15ac7-181">Utilisez [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] pour créer et publier une règle d'entreprise qui démarre le flux de travail lorsqu'elle est appliquée.</span><span class="sxs-lookup"><span data-stu-id="15ac7-181">Use [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] to create and publish a business rule that will start the workflow when applied.</span></span> <span data-ttu-id="15ac7-182">Vous devez vous assurer que votre règle d'entreprise contient des actions qui modifient des valeurs d'attribut, afin que la logique prenne la valeur « false » après avoir été appliquée une fois.</span><span class="sxs-lookup"><span data-stu-id="15ac7-182">You should ensure that your business rule contains actions that change attribute values, so that the rule evaluates to false after it has been applied once.</span></span> <span data-ttu-id="15ac7-183">Par exemple, votre règle d'entreprise peut avoir la valeur « true » si une valeur d'attribut de prix est supérieure à 500 et la valeur d'attribut approuvée est vide.</span><span class="sxs-lookup"><span data-stu-id="15ac7-183">For example, your business rule might evaluate to true when a Price attribute value is greater than 500 and the Approved attribute value is blank.</span></span> <span data-ttu-id="15ac7-184">La règle peut ensuite inclure deux actions : une pour définir la valeur d'attribut approuvée en attente et une pour démarrer le flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-184">The rule can then include two actions: one to set the Approved attribute value to Pending and one to start the workflow.</span></span> <span data-ttu-id="15ac7-185">Ou bien, vous pouvez créer une règle qui utilise la condition « has changed » et ajouter vos attributs pour changer les groupes de suivi.</span><span class="sxs-lookup"><span data-stu-id="15ac7-185">Alternatively, you may want to create a rule that uses the "has changed" condition and add your attributes to change tracking groups.</span></span> <span data-ttu-id="15ac7-186">Pour plus d’informations sur les règles d’entreprise, consultez [Règles d’entreprise &#40;Master Data Services&#41;](../business-rules-master-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="15ac7-186">For more information about business rules, see [Business Rules &#40;Master Data Services&#41;](../business-rules-master-data-services.md).</span></span>  
  
 <span data-ttu-id="15ac7-187">Créez une règle d'entreprise qui démarre un flux de travail personnalisé dans [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] en suivant ces étapes :</span><span class="sxs-lookup"><span data-stu-id="15ac7-187">Create a business rule that starts a custom workflow in [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] by following these steps:</span></span>  
  
1.  <span data-ttu-id="15ac7-188">Dans l’éditeur des règles d’entreprise de [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] , après avoir spécifié les conditions de votre règle d’entreprise, faites glisser l’action **Démarrer le flux de travail** de la liste **actions externes** vers l’étiquette **action** du volet **Then** .</span><span class="sxs-lookup"><span data-stu-id="15ac7-188">In the business rule editor of [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)], after you have specified the conditions of your business rule, drag the **Start Workflow** action from the **External actions** list to the **THEN** pane's **Action** label.</span></span>  
  
2.  <span data-ttu-id="15ac7-189">Dans le volet **Modifier l’action**, dans la zone **Type de flux de travail**, tapez la balise qui identifie l’assembly de gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-189">In the **Edit Action** pane, in the **Workflow type** box, type the tag that identifies your workflow handler assembly.</span></span> <span data-ttu-id="15ac7-190">Il s'agit de la balise que vous avez spécifiée dans le fichier de configuration pour votre assembly, par exemple, TEST.</span><span class="sxs-lookup"><span data-stu-id="15ac7-190">This is the tag you specified in the configuration file for your assembly, for example, TEST.</span></span>  
  
3.  <span data-ttu-id="15ac7-191">Éventuellement, cochez la case **Inclure les données de membre**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-191">Optionally, select the **Include member data** check box.</span></span> <span data-ttu-id="15ac7-192">Choisissez cette option pour inclure les noms et les valeurs d'attribut dans le code XML passé au gestionnaire de flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-192">Choose this to include attribute names and values in the XML that is passed to the workflow handler.</span></span>  
  
4.  <span data-ttu-id="15ac7-193">Dans la zone **Site du flux de travail**, tapez le nom d’un site web.</span><span class="sxs-lookup"><span data-stu-id="15ac7-193">In the **Workflow site** box, type the name of a website.</span></span> <span data-ttu-id="15ac7-194">Pour votre flux de travail personnalisé, cette information peut ne pas s'appliquer, mais elle peut être utilisée pour ajouter du contexte.</span><span class="sxs-lookup"><span data-stu-id="15ac7-194">For your custom workflow this may not apply, but can be used for added context.</span></span>  
  
5.  <span data-ttu-id="15ac7-195">Dans la zone **Nom du flux de travail**, tapez le nom de votre flux de travail dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="15ac7-195">In the **Workflow name** box, type the name of your workflow from Visual Studio.</span></span> <span data-ttu-id="15ac7-196">Pour votre flux de travail personnalisé, cette information peut ne pas s'appliquer, mais elle peut être utilisée pour ajouter du contexte.</span><span class="sxs-lookup"><span data-stu-id="15ac7-196">For your custom workflow this may not apply, but can be used for added context.</span></span>  
  
6.  <span data-ttu-id="15ac7-197">Enregistrez et publiez la règle d'entreprise.</span><span class="sxs-lookup"><span data-stu-id="15ac7-197">Save and publish the business rule.</span></span>  
  
### <a name="apply-business-rules-to-start-a-workflow"></a><span data-ttu-id="15ac7-198">Appliquer des règles d'entreprise pour démarrer un flux de travail</span><span class="sxs-lookup"><span data-stu-id="15ac7-198">Apply Business Rules to Start a Workflow</span></span>  
 <span data-ttu-id="15ac7-199">Appliquez la règle d'entreprise à vos données pour démarrer le flux de travail.</span><span class="sxs-lookup"><span data-stu-id="15ac7-199">Apply the business rule to your data to start the workflow.</span></span> <span data-ttu-id="15ac7-200">Pour cela, utilisez [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] pour modifier l'entité qui contient les membres que vous souhaitez valider.</span><span class="sxs-lookup"><span data-stu-id="15ac7-200">To do this, use [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] to edit the entity that contains the members you want to validate.</span></span> <span data-ttu-id="15ac7-201">Cliquez sur **Appliquer les règles d’entreprise**.</span><span class="sxs-lookup"><span data-stu-id="15ac7-201">Click **Apply business rules**.</span></span> <span data-ttu-id="15ac7-202">En réponse à la règle d'entreprise, [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] remplit la file d'attente Service Broker de la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15ac7-202">In response to the business rule, [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)] populates the Service Broker queue of the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database.</span></span> <span data-ttu-id="15ac7-203">Lorsque le service d'intégration de flux de travail MDS de SQL Server vérifie la file d'attente, il envoie les données à l'assembly du gestionnaire de flux de travail spécifié et efface la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="15ac7-203">When SQL Server MDS Workflow Integration Service checks the queue, it sends the data to the specified workflow handler assembly and clears the queue.</span></span> <span data-ttu-id="15ac7-204">L'assembly du gestionnaire de flux de travail s'exécute quelles que soient les actions codées qu'il contient.</span><span class="sxs-lookup"><span data-stu-id="15ac7-204">The workflow handler assembly performs whatever actions you have coded into it.</span></span>  
  
## <a name="troubleshoot-custom-workflows"></a><span data-ttu-id="15ac7-205">Dépanner des flux de travail personnalisés</span><span class="sxs-lookup"><span data-stu-id="15ac7-205">Troubleshoot Custom Workflows</span></span>  
 <span data-ttu-id="15ac7-206">Si votre assembly de gestionnaire de flux de travail ne reçoit pas de données, vous pouvez essayer de déboguer le service d’intégration de flux de travail MDS de SQL Server ou bien afficher la file d’attente Service Broker.</span><span class="sxs-lookup"><span data-stu-id="15ac7-206">If your workflow handler assembly doesn't receive data, you can try debugging SQL Server MDS Workflow Integration Service or viewing the Service Broker queue.</span></span>  
  
### <a name="debug-sql-server-mds-workflow-integration-service"></a><span data-ttu-id="15ac7-207">Déboguer le service d'intégration de flux de travail MDS de SQL Server</span><span class="sxs-lookup"><span data-stu-id="15ac7-207">Debug SQL Server MDS Workflow Integration Service</span></span>  
 <span data-ttu-id="15ac7-208">Pour déboguer le service d'intégration de flux de travail de SQL Server, effectuez les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="15ac7-208">To debug SQL Server Workflow Integration Service, take the following steps:</span></span>  
  
1.  <span data-ttu-id="15ac7-209">Utilisez le composant logiciel enfichable Services pour arrêter le service.</span><span class="sxs-lookup"><span data-stu-id="15ac7-209">Use the Services snap-in to stop the service.</span></span>  
  
2.  <span data-ttu-id="15ac7-210">Ouvrez une invite de commandes, naviguez jusqu'à l'emplacement du service, puis exécutez le service en mode console en entrant : Microsoft.MasterDataServices.Workflow.exe - console.</span><span class="sxs-lookup"><span data-stu-id="15ac7-210">Open a command prompt, navigate to the location of the service, and run the service in console mode by entering: Microsoft.MasterDataServices.Workflow.exe -console.</span></span>  
  
3.  <span data-ttu-id="15ac7-211">Dans [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)], mettez à jour votre membre et appliquez à nouveau les règles d'entreprise.</span><span class="sxs-lookup"><span data-stu-id="15ac7-211">In [!INCLUDE[ssMDSmdm](../../includes/ssmdsmdm-md.md)], update your member and apply business rules again.</span></span> <span data-ttu-id="15ac7-212">Les journaux détaillés sont affichés dans la fenêtre de la console.</span><span class="sxs-lookup"><span data-stu-id="15ac7-212">Detailed logs are displayed in the console window.</span></span>  
  
### <a name="view-the-service-broker-queue"></a><span data-ttu-id="15ac7-213">Afficher la file d'attente de Service Broker</span><span class="sxs-lookup"><span data-stu-id="15ac7-213">View the Service Broker Queue</span></span>  
 <span data-ttu-id="15ac7-214">La file d'attente Service Broker qui contient les données de référence passées dans le cadre du flux de travail est : mdm.microsoft/mdm/queue/externalaction.</span><span class="sxs-lookup"><span data-stu-id="15ac7-214">The Service Broker queue that contains the master data passed as part of the workflow is: mdm.microsoft/mdm/queue/externalaction.</span></span> <span data-ttu-id="15ac7-215">Les files d’attente se trouvent dans l’**Explorateur d’objets** de SQL Management Studio sous le nœud Service Broker de la base de données [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15ac7-215">Queues can be found in the **Object Explorer** of SQL Management Studio under the Service Broker node of the [!INCLUDE[ssMDSshort](../../includes/ssmdsshort-md.md)] database.</span></span> <span data-ttu-id="15ac7-216">Notez que, si le service a effacé la file d'attente correctement, cette file d'attente est vide.</span><span class="sxs-lookup"><span data-stu-id="15ac7-216">Be aware that, if the service cleared the queue properly, this queue will be empty.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15ac7-217">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="15ac7-217">See Also</span></span>  
 <span data-ttu-id="15ac7-218">[Exemple de flux de travail personnalisé &#40;Master Data Services&#41;](create-a-custom-workflow-example.md) </span><span class="sxs-lookup"><span data-stu-id="15ac7-218">[Custom Workflow Example &#40;Master Data Services&#41;](create-a-custom-workflow-example.md) </span></span>  
 [<span data-ttu-id="15ac7-219">Description du code XML d’un flux de travail personnalisé &#40;Master Data Services&#41;</span><span class="sxs-lookup"><span data-stu-id="15ac7-219">Custom Workflow XML Description &#40;Master Data Services&#41;</span></span>](create-a-custom-workflow-xml-description.md)  
  
  
