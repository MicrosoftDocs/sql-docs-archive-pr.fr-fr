---
title: Opérations de journalisation dans Analysis Services | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: aa1db060-95dc-4198-8aeb-cffdda44b140
author: minewiskan
ms.author: owend
ms.openlocfilehash: 95d0e41576e449ab10b243ef49cbe283940afe0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611996"
---
# <a name="log-operations-in-analysis-services"></a><span data-ttu-id="cab27-102">Enregistrer les opérations dans Analysis Services</span><span class="sxs-lookup"><span data-stu-id="cab27-102">Log operations in Analysis Services</span></span>
  <span data-ttu-id="cab27-103">Une instance de Analysis Services enregistre les notifications de serveur, les erreurs et les avertissements dans le fichier msmdsrv. log (un pour chaque instance que vous installez).</span><span class="sxs-lookup"><span data-stu-id="cab27-103">An Analysis Services instance will log server notifications, errors, and warnings to the msmdsrv.log file - one for each instance you install.</span></span> <span data-ttu-id="cab27-104">Les administrateurs se réfèrent à ce fichier journal pour en savoir plus sur les événements ordinaires et extraordinaires.</span><span class="sxs-lookup"><span data-stu-id="cab27-104">Administrators refer to this log for insights into routine and extraordinary events alike.</span></span> <span data-ttu-id="cab27-105">Dans les versions récentes, la journalisation a été améliorée pour inclure davantage d'informations.</span><span class="sxs-lookup"><span data-stu-id="cab27-105">In recent releases, logging has been enhanced to include more information.</span></span> <span data-ttu-id="cab27-106">Désormais, les enregistrements de journaux incluent des informations sur la version et l'édition du produit, ainsi que sur des événements du processeur, de la mémoire, de la connectivité et de blocage.</span><span class="sxs-lookup"><span data-stu-id="cab27-106">Log records now include product version and edition information, as well as processor, memory, connectivity, and blocking events.</span></span> <span data-ttu-id="cab27-107">L'article [Améliorations apportées à la journalisation](https://support.microsoft.com/kb/2965035)fournit une liste de tous les changements.</span><span class="sxs-lookup"><span data-stu-id="cab27-107">You can review the entire change list at [Logging improvements](https://support.microsoft.com/kb/2965035).</span></span>  
  
 <span data-ttu-id="cab27-108">En plus de la fonctionnalité de journalisation intégrée, de nombreux administrateurs et développeurs utilisent des outils fournis par la communauté Analysis Services pour recueillir des données sur les opérations du serveur, comme **ASTrace**.</span><span class="sxs-lookup"><span data-stu-id="cab27-108">Besides the built-in logging feature, many administrators and developers also use tools provided by the Analysis Services community to collect data about server operations, such as **ASTrace**.</span></span> <span data-ttu-id="cab27-109">Pour obtenir des liens de téléchargement, consultez [Exemples de la communauté Microsoft SQL Server : Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/) .</span><span class="sxs-lookup"><span data-stu-id="cab27-109">See [Microsoft SQL Server Community Samples: Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/) for the download links.</span></span>  
  
 <span data-ttu-id="cab27-110">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="cab27-110">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="cab27-111">Emplacement et types de journaux</span><span class="sxs-lookup"><span data-stu-id="cab27-111">Location and types of logs</span></span>](#bkmk_location)  
  
-   [<span data-ttu-id="cab27-112">Informations générales sur les paramètres de configuration des fichiers journaux</span><span class="sxs-lookup"><span data-stu-id="cab27-112">General information on log file configuration settings</span></span>](#bkmk_general)  
  
-   [<span data-ttu-id="cab27-113">Fichier journal du service MSMDSRV</span><span class="sxs-lookup"><span data-stu-id="cab27-113">MSMDSRV service log file</span></span>](#bkmk_msmdsrv)  
  
-   [<span data-ttu-id="cab27-114">Journaux des requêtes</span><span class="sxs-lookup"><span data-stu-id="cab27-114">Query logs</span></span>](#bkmk_querylog)  
  
-   [<span data-ttu-id="cab27-115">Fichiers de vidage minimal (. mdmp)</span><span class="sxs-lookup"><span data-stu-id="cab27-115">Mini dump (.mdmp) files</span></span>](#bkmk_mdmp)  
  
-   [<span data-ttu-id="cab27-116">Conseils et meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="cab27-116">Tips and best practices</span></span>](#bkmk_tips)  
  
> [!NOTE]  
>  <span data-ttu-id="cab27-117">Si vous recherchez des informations sur la journalisation, vous serez peut-être intéressé par les opérations de suivi qui montrent les détails de traitement et d'exécution de requêtes.</span><span class="sxs-lookup"><span data-stu-id="cab27-117">If you're looking for information about logging, you might also be interested in tracing operations that show processing and query execution paths.</span></span> <span data-ttu-id="cab27-118">Pour obtenir des informations sur les objets de trace pour le suivi ad hoc et maintenu (par exemple, l’audit de l’accès aux cubes), ainsi que des recommandations sur l’utilisation optimale de Flight Recorder, SQL Server Profiler et xEvents, consultez les liens accessibles dans cette page : [Analyser une instance Analysis Services](monitor-an-analysis-services-instance.md).</span><span class="sxs-lookup"><span data-stu-id="cab27-118">Trace objects for ad hoc and sustained tracing (such as auditing cube access) ─ as well as recommendations on how to best use Flight Recorder, SQL Server Profiler, and xEvents ─ can be found through the links on this page: [Monitor an Analysis Services Instance](monitor-an-analysis-services-instance.md).</span></span>  
  
##  <a name="location-and-types-of-logs"></a><a name="bkmk_location"></a><span data-ttu-id="cab27-119">Emplacement et types de journaux</span><span class="sxs-lookup"><span data-stu-id="cab27-119">Location and types of logs</span></span>  
 <span data-ttu-id="cab27-120">Analysis Services fournit les journaux décrits ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="cab27-120">Analysis Services provides the logs described below.</span></span>  
  
|<span data-ttu-id="cab27-121">Nom de fichier ou emplacement</span><span class="sxs-lookup"><span data-stu-id="cab27-121">File name or Location</span></span>|<span data-ttu-id="cab27-122">Type</span><span class="sxs-lookup"><span data-stu-id="cab27-122">Type</span></span>|<span data-ttu-id="cab27-123">Utilisé pour</span><span class="sxs-lookup"><span data-stu-id="cab27-123">Used for</span></span>|<span data-ttu-id="cab27-124">Activé par défaut</span><span class="sxs-lookup"><span data-stu-id="cab27-124">On by default</span></span>|  
|---------------------------|----------|--------------|-------------------|  
|<span data-ttu-id="cab27-125">Msmdsrv.log</span><span class="sxs-lookup"><span data-stu-id="cab27-125">Msmdsrv.log</span></span>|<span data-ttu-id="cab27-126">Journal des erreurs</span><span class="sxs-lookup"><span data-stu-id="cab27-126">Error log</span></span>|<span data-ttu-id="cab27-127">Surveillance de routine et dépannage de base</span><span class="sxs-lookup"><span data-stu-id="cab27-127">Routine monitoring and basic troubleshooting</span></span>|<span data-ttu-id="cab27-128">Oui</span><span class="sxs-lookup"><span data-stu-id="cab27-128">Yes</span></span>|  
|<span data-ttu-id="cab27-129">Table OlapQueryLog dans une base de données relationnelle</span><span class="sxs-lookup"><span data-stu-id="cab27-129">OlapQueryLog table in a relational database</span></span>|<span data-ttu-id="cab27-130">Journal des requêtes</span><span class="sxs-lookup"><span data-stu-id="cab27-130">Query log</span></span>|<span data-ttu-id="cab27-131">Recueillir les entrées de l'Assistant Optimisation de l'utilisation</span><span class="sxs-lookup"><span data-stu-id="cab27-131">Collect inputs for the Usage Optimization Wizard</span></span>|<span data-ttu-id="cab27-132">Non</span><span class="sxs-lookup"><span data-stu-id="cab27-132">No</span></span>|  
|<span data-ttu-id="cab27-133">\<guid>Fichiers fichiers sqldmp. mdmp</span><span class="sxs-lookup"><span data-stu-id="cab27-133">SQLDmp\<guid>.mdmp files</span></span>|<span data-ttu-id="cab27-134">Blocages et exceptions</span><span class="sxs-lookup"><span data-stu-id="cab27-134">Crashes and exceptions</span></span>|<span data-ttu-id="cab27-135">Dépannage approfondi</span><span class="sxs-lookup"><span data-stu-id="cab27-135">Deep troubleshooting</span></span>|<span data-ttu-id="cab27-136">Non</span><span class="sxs-lookup"><span data-stu-id="cab27-136">No</span></span>|  
  
 <span data-ttu-id="cab27-137">Nous vous recommandons vivement de consulter le lien suivant pour accéder à des ressources supplémentaires non traitées dans la rubrique suivante, qui fournit des [conseils sur la collecte de données initiale depuis le support Microsoft](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx).</span><span class="sxs-lookup"><span data-stu-id="cab27-137">We highly recommend the following link for additional information resources not covered in this topic: [Initial data collection tips from Microsoft Support](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx).</span></span>  
  
##  <a name="general-information-on-log-file-configuration-settings"></a><a name="bkmk_general"></a><span data-ttu-id="cab27-138">Informations générales sur les paramètres de configuration du fichier journal</span><span class="sxs-lookup"><span data-stu-id="cab27-138">General information on log file configuration settings</span></span>  
 <span data-ttu-id="cab27-139">Vous trouverez des sections pour chaque journal dans le fichier de configuration de serveur msmdsrv.ini, qui se trouve dans le dossier Program Files\Microsoft SQL Server\MSAS12.MSSQLSERVER\OLAP\Config.</span><span class="sxs-lookup"><span data-stu-id="cab27-139">You can find sections for each log in the msmdsrv.ini server configuration file, located in the \Program Files\Microsoft SQL Server\MSAS12.MSSQLSERVER\OLAP\Config folder.</span></span> <span data-ttu-id="cab27-140">Pour obtenir des instructions sur la modification du fichier, consultez [Configure Server Properties in Analysis Services](../server-properties/server-properties-in-analysis-services.md) .</span><span class="sxs-lookup"><span data-stu-id="cab27-140">See [Configure Server Properties in Analysis Services](../server-properties/server-properties-in-analysis-services.md) for instructions on editing the file.</span></span>  
  
 <span data-ttu-id="cab27-141">Dans la mesure du possible, nous vous suggérons de définir des propriétés de journalisation dans la page de propriétés du serveur de Management Studio.</span><span class="sxs-lookup"><span data-stu-id="cab27-141">Where possible, we suggest that you set logging properties in the server properties page of Management Studio.</span></span> <span data-ttu-id="cab27-142">Toutefois, dans certains cas, vous devez modifier le fichier msmdsrv.ini directement pour configurer les paramètres qui ne sont pas visibles dans les outils d'administration.</span><span class="sxs-lookup"><span data-stu-id="cab27-142">Although in some cases, you must edit the msmdsrv.ini file directly to configure settings that are not visible in the administrative tools.</span></span>  
  
 <span data-ttu-id="cab27-143">![Section du fichier de configuration présentant les paramètres du journal](../media/ssas-logfilesettings.png "Section du fichier de configuration présentant les paramètres du journal")</span><span class="sxs-lookup"><span data-stu-id="cab27-143">![Section of the config file showing log settings](../media/ssas-logfilesettings.png "Section of the config file showing log settings")</span></span>  
  
##  <a name="msmdsrv-service-log-file"></a><a name="bkmk_msmdsrv"></a><span data-ttu-id="cab27-144">Fichier journal du service MSMDSRV</span><span class="sxs-lookup"><span data-stu-id="cab27-144">MSMDSRV service log file</span></span>  
 <span data-ttu-id="cab27-145">Analysis Services enregistre les opérations du serveur dans le fichier msmdsrv.log, un par instance, qui se trouve dans \program files\Microsoft SQL Server\\<instance\>\Olap\Log.</span><span class="sxs-lookup"><span data-stu-id="cab27-145">Analysis Services logs server operations to the msmdsrv.log file, one per instance, located at \program files\Microsoft SQL Server\\<instance\>\Olap\Log.</span></span>  
  
 <span data-ttu-id="cab27-146">Ce fichier journal est vidé à chaque redémarrage du service.</span><span class="sxs-lookup"><span data-stu-id="cab27-146">This log file is emptied at each service restart.</span></span> <span data-ttu-id="cab27-147">Dans les versions précédentes, les administrateurs redémarraient parfois le service dans le seul but de vider le fichier journal avant que sa taille ne devienne ingérable.</span><span class="sxs-lookup"><span data-stu-id="cab27-147">In previous releases, administrators would sometimes restart the service for the sole purpose of flushing the log file before it could grow so large as to become unusable.</span></span> <span data-ttu-id="cab27-148">Cela n'est plus nécessaire.</span><span class="sxs-lookup"><span data-stu-id="cab27-148">This is no longer necessary.</span></span> <span data-ttu-id="cab27-149">Les paramètres de configuration, introduits dans SQL Server 2012 SP2 et versions ultérieures, vous permettent de contrôler la taille du fichier journal et son historique :</span><span class="sxs-lookup"><span data-stu-id="cab27-149">Configuration settings, introduced in SQL Server 2012 SP2 and later, give you control over the size of the log file and its history:</span></span>  
  
-   <span data-ttu-id="cab27-150">`MaxFileSizeMB` spécifie la taille maximale (en mégaoctets) du fichier journal.</span><span class="sxs-lookup"><span data-stu-id="cab27-150">`MaxFileSizeMB` specifies a maximum log file size in megabytes.</span></span> <span data-ttu-id="cab27-151">La valeur par défaut est 256.</span><span class="sxs-lookup"><span data-stu-id="cab27-151">The default is 256.</span></span> <span data-ttu-id="cab27-152">Une valeur de remplacement valide doit être un entier positif.</span><span class="sxs-lookup"><span data-stu-id="cab27-152">A valid replacement value must be a positive integer.</span></span> <span data-ttu-id="cab27-153">Quand la valeur `MaxFileSizeMB` est atteinte, Analysis Services renomme le fichier actuel msmdsrv{horodateur_actuel}.log et crée un nouveau fichier msmdsrv.log.</span><span class="sxs-lookup"><span data-stu-id="cab27-153">When `MaxFileSizeMB` is reached, Analysis Services renames the current file as msmdsrv{current timestamp}.log file, and starts a new msmdsrv.log file.</span></span>  
  
-   <span data-ttu-id="cab27-154">`MaxNumberFiles`spécifie la rétention des anciens fichiers journaux.</span><span class="sxs-lookup"><span data-stu-id="cab27-154">`MaxNumberFiles` specifies retention of older log files.</span></span> <span data-ttu-id="cab27-155">La valeur par défaut est 0 (option désactivée).</span><span class="sxs-lookup"><span data-stu-id="cab27-155">The default is 0 (disabled).</span></span> <span data-ttu-id="cab27-156">Vous pouvez la modifier et affecter un entier positif pour conserver les versions du fichier journal.</span><span class="sxs-lookup"><span data-stu-id="cab27-156">You can change it to a positive integer to keep versions of the log file.</span></span> <span data-ttu-id="cab27-157">Quand la valeur `MaxNumberFiles` est atteinte, Analysis Services supprime le fichier ayant l'horodateur le plus ancien.</span><span class="sxs-lookup"><span data-stu-id="cab27-157">When `MaxNumberFiles` is reached, Analysis Services deletes the file with the oldest timestamp in its name.</span></span>  
  
 <span data-ttu-id="cab27-158">Pour utiliser ces paramètres, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="cab27-158">To use these settings, do the following:</span></span>  
  
1.  <span data-ttu-id="cab27-159">Dans le Bloc-notes, ouvrez msmdsrv.ini.</span><span class="sxs-lookup"><span data-stu-id="cab27-159">Open msmdsrv.ini in NotePad.</span></span>  
  
2.  <span data-ttu-id="cab27-160">Copiez les deux lignes suivantes :</span><span class="sxs-lookup"><span data-stu-id="cab27-160">Copy the following two lines:</span></span>  
  
    ```  
    <MaxFileSizeMB>256</MaxFileSizeMB>  
    <MaxNumberOfLogFiles>5</MaxNumberOfLogFiles>  
    ```  
  
3.  <span data-ttu-id="cab27-161">Collez les deux lignes dans la section Log de msmdsrv.ini, sous le nom de fichier de msmdsrv.log.</span><span class="sxs-lookup"><span data-stu-id="cab27-161">Paste the two lines into the Log section of msmdsrv.ini, below the filename for msmdsrv.log.</span></span> <span data-ttu-id="cab27-162">Les deux paramètres doivent être ajoutés manuellement.</span><span class="sxs-lookup"><span data-stu-id="cab27-162">Both settings must be added manually.</span></span> <span data-ttu-id="cab27-163">Il n'existe aucun emplacement réservé pour eux dans le fichier msmdsrv.ini.</span><span class="sxs-lookup"><span data-stu-id="cab27-163">There are no placeholders for them in the msmdsrv.ini file.</span></span>  
  
     <span data-ttu-id="cab27-164">Le fichier de configuration modifié doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="cab27-164">The changed configuration file should look like the following:</span></span>  
  
    ```  
    <Log>  
    <File>msmdsrv.log</File>  
    <MaxFileSizeMB>256</MaxFileSizeMB>  
    <MaxNumberOfLogFiles>5</MaxNumberOfLogFiles>  
    <FileBufferSize>0</FileBufferSize>  
  
    ```  
  
4.  <span data-ttu-id="cab27-165">Modifiez les valeurs si celles qui sont fournies ne vous conviennent pas.</span><span class="sxs-lookup"><span data-stu-id="cab27-165">Edit the values if those provided differ from what you want.</span></span>  
  
5.  <span data-ttu-id="cab27-166">Enregistrez le fichier .</span><span class="sxs-lookup"><span data-stu-id="cab27-166">Save the file.</span></span>  
  
6.  <span data-ttu-id="cab27-167">Redémarrez le service.</span><span class="sxs-lookup"><span data-stu-id="cab27-167">Restart the service.</span></span>  
  
##  <a name="query-logs"></a><a name="bkmk_querylog"></a> <span data-ttu-id="cab27-168">Journaux des requêtes</span><span class="sxs-lookup"><span data-stu-id="cab27-168">Query logs</span></span>  
 <span data-ttu-id="cab27-169">Le journal des requêtes porte mal son nom, car il n'enregistre pas l'activité des requêtes MDX ou DAX de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="cab27-169">The query log is a bit of a misnomer in that it does not log the MDX or DAX query activity of your users.</span></span> <span data-ttu-id="cab27-170">Au lieu de cela, il recueille des données sur les requêtes générées par Analysis Services, qui sont ensuite utilisées comme entrées de données dans l'Assistant Optimisation de l'utilisation.</span><span class="sxs-lookup"><span data-stu-id="cab27-170">Instead, it collects data about queries generated by Analysis Services, which is subsequently used as data input in the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="cab27-171">Les données recueillies dans le journal des requêtes ne sont pas destinées à être analysées directement.</span><span class="sxs-lookup"><span data-stu-id="cab27-171">The data collected in the query log is not intended for direct analysis.</span></span> <span data-ttu-id="cab27-172">Plus précisément, les datasets sont décrits dans des tableaux de bits, avec un chiffre zéro ou un indiquant que les parties du dataset sont comprises dans la requête.</span><span class="sxs-lookup"><span data-stu-id="cab27-172">Specifically, the datasets are described in bit arrays, with a zero or a one indicating the parts of dataset is included in the query.</span></span> <span data-ttu-id="cab27-173">Là encore, ces données sont destinées à l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="cab27-173">Again, this data is meant for the wizard.</span></span>  
  
 <span data-ttu-id="cab27-174">Pour l'analyse et le dépannage des requêtes, de nombreux développeurs et administrateurs utilisent un outil communautaire, **ASTrace**, pour analyser les requêtes.</span><span class="sxs-lookup"><span data-stu-id="cab27-174">For query monitoring and troubleshooting, many developers and administrators use a community tool, **ASTrace**, to monitor queries.</span></span> <span data-ttu-id="cab27-175">Vous pouvez également utiliser SQL Server Profiler, xEvents ou une trace Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="cab27-175">You can also use SQL Server Profiler, xEvents, or an Analysis Services trace.</span></span> <span data-ttu-id="cab27-176">Pour obtenir des liens relatifs au suivi, consultez [Analyser une instance Analysis Services](monitor-an-analysis-services-instance.md) .</span><span class="sxs-lookup"><span data-stu-id="cab27-176">See [Monitor an Analysis Services Instance](monitor-an-analysis-services-instance.md) for tracing-related links.</span></span>  
  
 <span data-ttu-id="cab27-177">Quand faut-il utiliser le journal des requêtes ?</span><span class="sxs-lookup"><span data-stu-id="cab27-177">When should you use the query log?</span></span> <span data-ttu-id="cab27-178">Nous vous recommandons d'activer le journal des requêtes dans le cadre d'un exercice de réglage des performances de requête qui inclut l'Assistant Optimisation de l'utilisation.</span><span class="sxs-lookup"><span data-stu-id="cab27-178">We recommend enabling the query log as part of a query performance tuning exercise that includes the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="cab27-179">Le journal des requêtes n'existe qu'une fois que vous avez activé la fonctionnalité, créé les structures de données pour la prendre en charge et défini les propriétés utilisées par Analysis Services pour localiser et renseigner le journal.</span><span class="sxs-lookup"><span data-stu-id="cab27-179">The query log does not exist until you enable the feature, create the data structures to support it, and set properties used by Analysis Services to locate and populate the log.</span></span>  
  
 <span data-ttu-id="cab27-180">Pour activer le journal des requêtes, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="cab27-180">To enable the query log, follow these steps:</span></span>  
  
1.  <span data-ttu-id="cab27-181">Créez une base de données relationnelle SQL Server pour stocker le journal des requêtes.</span><span class="sxs-lookup"><span data-stu-id="cab27-181">Create a SQL Server relational database to store the query log.</span></span>  
  
2.  <span data-ttu-id="cab27-182">Accordez des autorisations suffisantes sur la base de données au compte de service Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="cab27-182">Grant the Analysis Services service account sufficient permissions on the database.</span></span> <span data-ttu-id="cab27-183">Le compte nécessite une autorisation pour créer une table, écrire dans la table et lire à partir de la table.</span><span class="sxs-lookup"><span data-stu-id="cab27-183">The account needs permission to create a table, write to the table, and read from the table.</span></span>  
  
3.  <span data-ttu-id="cab27-184">Dans SQL Server Management Studio, cliquez avec le bouton droit sur **Analysis Services**  |  **Propriétés**  |  **général**, affectez à **affectez createquerylogtable** la valeur true.</span><span class="sxs-lookup"><span data-stu-id="cab27-184">In SQL Server Management Studio, right-click **Analysis Services** | **Properties** | **General**, set **CreateQueryLogTable** to true.</span></span>  
  
4.  <span data-ttu-id="cab27-185">Éventuellement, modifiez **QueryLogSampling** ou **QueryLogTableName** si vous souhaitez échantillonner les requêtes à une fréquence différente ou utiliser un autre nom pour la table.</span><span class="sxs-lookup"><span data-stu-id="cab27-185">Optionally, change **QueryLogSampling** or **QueryLogTableName** if you want to sample queries at a different rate, or use a different name for the table.</span></span>  
  
 <span data-ttu-id="cab27-186">La table du journal des requêtes ne sera créée qu'une fois que vous aurez exécuté suffisamment de requêtes MDX pour répondre aux critères d'échantillonnage.</span><span class="sxs-lookup"><span data-stu-id="cab27-186">The query log table will not be created until you have run enough MDX queries to meet the sampling requirements.</span></span> <span data-ttu-id="cab27-187">Par exemple, si vous conservez la valeur par défaut (10), vous devez exécuter au moins 10 requêtes pour que la table soit créée.</span><span class="sxs-lookup"><span data-stu-id="cab27-187">For example, if you keep the default value of 10, you must run at least 10 queries before the table will be created.</span></span>  
  
 <span data-ttu-id="cab27-188">Les paramètres du journal des requêtes sont applicables à l'échelle du serveur.</span><span class="sxs-lookup"><span data-stu-id="cab27-188">Query log settings are server wide.</span></span> <span data-ttu-id="cab27-189">Les paramètres que vous spécifiez sont utilisés par toutes les bases de données en cours d'exécution sur ce serveur.</span><span class="sxs-lookup"><span data-stu-id="cab27-189">The settings you specify will be used by all databases running on this server.</span></span>  
  
 <span data-ttu-id="cab27-190">![Paramètres du journal des requêtes dans Management Studio](../media/ssas-querylogsettings.png "Paramètres du journal des requêtes dans Management Studio")</span><span class="sxs-lookup"><span data-stu-id="cab27-190">![Query log settings in Management Studio](../media/ssas-querylogsettings.png "Query log settings in Management Studio")</span></span>  
  
 <span data-ttu-id="cab27-191">Une fois les paramètres de configuration spécifiés, exécutez une requête MDX à plusieurs reprises.</span><span class="sxs-lookup"><span data-stu-id="cab27-191">After the configuration settings are specified, run an MDX query multiple times.</span></span> <span data-ttu-id="cab27-192">Si l'échantillonnage est défini sur 10, exécutez la requête 11 fois. Vérifiez que la table est créée.</span><span class="sxs-lookup"><span data-stu-id="cab27-192">If sampling is set to 10, run the query 11 times.Verify the table is created.</span></span> <span data-ttu-id="cab27-193">Dans Management Studio, connectez-vous au moteur de base de données relationnelle, ouvrez le dossier de base de données, ouvrez le dossier **Tables** et vérifiez que **OlapQueryLog** existe.</span><span class="sxs-lookup"><span data-stu-id="cab27-193">In Management Studio, connect to the relational database engine, open the database folder, open the **Tables** folder, and verify that **OlapQueryLog** exists.</span></span> <span data-ttu-id="cab27-194">Si la table n'est pas visible immédiatement, actualisez le dossier pour faire apparaître les modifications apportées à son contenu.</span><span class="sxs-lookup"><span data-stu-id="cab27-194">If you do not immediately see the table, refresh the folder to pick up any changes to its contents.</span></span>  
  
 <span data-ttu-id="cab27-195">Laissez le journal des requêtes accumuler suffisamment de données pour l'Assistant Optimisation de l'utilisation.</span><span class="sxs-lookup"><span data-stu-id="cab27-195">Allow the query log to accumulate sufficient data for the Usage Based Optimization Wizard.</span></span> <span data-ttu-id="cab27-196">Si les volumes de requêtes sont cycliques, capturez suffisamment de trafic pour avoir un jeu de données représentatif.</span><span class="sxs-lookup"><span data-stu-id="cab27-196">If query volumes are cyclical, capture enough traffic to have a representative set of data.</span></span> <span data-ttu-id="cab27-197">Pour obtenir des instructions sur la façon d'exécuter l'Assistant, consultez [Aide F1 sur l'Assistant Optimisation de l'utilisation](https://msdn.microsoft.com/library/ms189706.aspx) .</span><span class="sxs-lookup"><span data-stu-id="cab27-197">See [Usage Based Optimization Wizard](https://msdn.microsoft.com/library/ms189706.aspx) for instructions on how to run the wizard.</span></span>  
  
 <span data-ttu-id="cab27-198">Pour en savoir plus sur la configuration du journal des requêtes, consultez [Configuration du journal des requêtes Analysis Services](https://technet.microsoft.com/library/Cc917676) .</span><span class="sxs-lookup"><span data-stu-id="cab27-198">See [Configuring the Analysis Services Query Log](https://technet.microsoft.com/library/Cc917676) to learn more about query log configuration.</span></span> <span data-ttu-id="cab27-199">Bien que cet article soit assez ancien, la configuration du journal des requêtes n'a pas changé dans les dernières versions et les informations qu'il contient sont toujours valables.</span><span class="sxs-lookup"><span data-stu-id="cab27-199">Although the paper is quite old, query log configuration has not changed in recent releases and the information it contains still applies.</span></span>  
  
##  <a name="mini-dump-mdmp-files"></a><a name="bkmk_mdmp"></a> <span data-ttu-id="cab27-200">Fichiers de vidage minimal (.mdmp)</span><span class="sxs-lookup"><span data-stu-id="cab27-200">Mini dump (.mdmp) files</span></span>  
 <span data-ttu-id="cab27-201">Les fichiers de vidage capturent des données utilisées pour l'analyse des événements extraordinaires.</span><span class="sxs-lookup"><span data-stu-id="cab27-201">Dump files capture data used for analyzing extraordinary events.</span></span> <span data-ttu-id="cab27-202">Analysis Services génère automatiquement des vidages minimaux (.mdmp) en réponse à un blocage du serveur, à une exception et à certaines erreurs de configuration.</span><span class="sxs-lookup"><span data-stu-id="cab27-202">Analysis Services automatically generates mini dumps (.mdmp) in response to a server crash, exception, and some configuration errors.</span></span> <span data-ttu-id="cab27-203">Cette fonctionnalité est activée, mais n'envoie pas automatiquement de rapports d'incidents.</span><span class="sxs-lookup"><span data-stu-id="cab27-203">The feature is enabled, but does not send crash reports automatically.</span></span>  
  
 <span data-ttu-id="cab27-204">Vous pouvez configurer les rapports d'incidents via la section Exception du fichier Msmdsrv.ini.</span><span class="sxs-lookup"><span data-stu-id="cab27-204">Crash reports are configured through the Exception section in the Msmdsrv.ini file.</span></span> <span data-ttu-id="cab27-205">Ces paramètres contrôlent la génération des fichiers de vidage de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cab27-205">These settings control memory dump file generation.</span></span> <span data-ttu-id="cab27-206">L'extrait suivant montre les valeurs par défaut :</span><span class="sxs-lookup"><span data-stu-id="cab27-206">The following snippet shows the default values:</span></span>  
  
```  
<Exception>  
<CreateAndSendCrashReports>1</CreateAndSendCrashReports>  
<CrashReportsFolder/>  
<SQLDumperFlagsOn>0x0</SQLDumperFlagsOn>  
<SQLDumperFlagsOff>0x0</SQLDumperFlagsOff>  
<MiniDumpFlagsOn>0x0</MiniDumpFlagsOn>  
<MiniDumpFlagsOff>0x0</MiniDumpFlagsOff>  
<MinidumpErrorList>0xC1000000, 0xC1000001, 0xC102003F, 0xC1360054, 0xC1360055</MinidumpErrorList>  
<ExceptionHandlingMode>0</ExceptionHandlingMode>  
<CriticalErrorHandling>1</CriticalErrorHandling>  
<MaxExceptions>500</MaxExceptions>  
<MaxDuplicateDumps>1</MaxDuplicateDumps>  
</Exception>  
```  
  
 <span data-ttu-id="cab27-207">**Configurer les rapports d'incidents**</span><span class="sxs-lookup"><span data-stu-id="cab27-207">**Configure Crash Reports**</span></span>  
  
 <span data-ttu-id="cab27-208">Sauf instruction contraire fournie par le support Microsoft, la plupart des administrateurs utilisent les paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="cab27-208">Unless otherwise directed by Microsoft Support, most administrators use the default settings.</span></span> <span data-ttu-id="cab27-209">Cet article de base de connaissances est ancien, mais il fournit toujours des instructions sur la configuration des fichiers de vidage : [Comment faire pour configurer SQL Server 2005 Analysis Services pour générer des fichiers de vidage de mémoire](https://support.microsoft.com/kb/919711).</span><span class="sxs-lookup"><span data-stu-id="cab27-209">This older KB article is still used to provide instruction on how to configure dump files: [How to configure Analysis Services to generate memory dump files](https://support.microsoft.com/kb/919711).</span></span>  
  
 <span data-ttu-id="cab27-210">Le paramètre de configuration le plus susceptible d'être modifié est le paramètre `CreateAndSendCrashReports` qui sert à déterminer si un fichier de vidage de la mémoire sera généré.</span><span class="sxs-lookup"><span data-stu-id="cab27-210">The configuration setting most likely to be modified is the `CreateAndSendCrashReports` setting used to determine whether a memory dump file will be generated.</span></span>  
  
|<span data-ttu-id="cab27-211">Valeur</span><span class="sxs-lookup"><span data-stu-id="cab27-211">Value</span></span>|<span data-ttu-id="cab27-212">Description</span><span class="sxs-lookup"><span data-stu-id="cab27-212">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="cab27-213">0</span><span class="sxs-lookup"><span data-stu-id="cab27-213">0</span></span>|<span data-ttu-id="cab27-214">Désactive le fichier de vidage de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cab27-214">Turns off the memory dump file.</span></span> <span data-ttu-id="cab27-215">Tous les autres paramètres dans la section Exceptions sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="cab27-215">All other settings under the Exception section are ignored.</span></span>|  
|<span data-ttu-id="cab27-216">1</span><span class="sxs-lookup"><span data-stu-id="cab27-216">1</span></span>|<span data-ttu-id="cab27-217">(Par défaut) Active mais n'envoie pas le fichier de vidage de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cab27-217">(Default) Enables, but does not send, the memory dump file.</span></span>|  
|<span data-ttu-id="cab27-218">2</span><span class="sxs-lookup"><span data-stu-id="cab27-218">2</span></span>|<span data-ttu-id="cab27-219">Active et envoie automatiquement un rapport d'erreurs à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="cab27-219">Enables and automatically sends an error report to Microsoft.</span></span>|  
  
 <span data-ttu-id="cab27-220">`CrashReportsFolder` est l'emplacement des fichiers de vidage.</span><span class="sxs-lookup"><span data-stu-id="cab27-220">`CrashReportsFolder` is the location of the dump files.</span></span> <span data-ttu-id="cab27-221">Par défaut, un fichier .mdmp et les enregistrements de journaux associés se trouvent dans le dossier \Olap\Log.</span><span class="sxs-lookup"><span data-stu-id="cab27-221">By default, an .mdmp file and associated log records can be found in the \Olap\Log folder.</span></span>  
  
 <span data-ttu-id="cab27-222">`SQLDumperFlagsOn` sert à générer un vidage complet.</span><span class="sxs-lookup"><span data-stu-id="cab27-222">`SQLDumperFlagsOn` is used to generate a full dump.</span></span> <span data-ttu-id="cab27-223">Par défaut, les vidages complets ne sont pas activés.</span><span class="sxs-lookup"><span data-stu-id="cab27-223">By default, full dumps are not enabled.</span></span> <span data-ttu-id="cab27-224">Vous pouvez affecter la valeur `0x34` à cette propriété.</span><span class="sxs-lookup"><span data-stu-id="cab27-224">You can set this property to `0x34`.</span></span>  
  
 <span data-ttu-id="cab27-225">Les liens suivants fournissent des explications plus détaillées :</span><span class="sxs-lookup"><span data-stu-id="cab27-225">The following links provide more background:</span></span>  
  
-   [<span data-ttu-id="cab27-226">Exploration approfondie de SQL Server avec des minidumps</span><span class="sxs-lookup"><span data-stu-id="cab27-226">Looking Deeper into SQL Server using Minidumps</span></span>](https://blogs.msdn.com/b/sqlcat/archive/2009/09/11/looking-deeper-into-sql-server-using-minidumps.aspx)  
  
-   [<span data-ttu-id="cab27-227">Comment créer un fichier de vidage en mode utilisateur</span><span class="sxs-lookup"><span data-stu-id="cab27-227">How to create a user mode dump file</span></span>](https://support.microsoft.com/kb/931673)  
  
-   [<span data-ttu-id="cab27-228">Comment utiliser l'utilitaire Sqldumper.exe pour générer un fichier de vidage dans SQL Server</span><span class="sxs-lookup"><span data-stu-id="cab27-228">How to use the Sqldumper.exe utility to generate a dump file in SQL Server</span></span>](https://support.microsoft.com/kb/917825)  
  
##  <a name="tips-and-best-practices"></a><a name="bkmk_tips"></a><span data-ttu-id="cab27-229">Conseils et meilleures pratiques</span><span class="sxs-lookup"><span data-stu-id="cab27-229">Tips and best practices</span></span>  
 <span data-ttu-id="cab27-230">Cette section est un récapitulatif des conseils mentionnés dans cet article.</span><span class="sxs-lookup"><span data-stu-id="cab27-230">This section is a recap of the tips mentioned throughout this article.</span></span>  
  
-   <span data-ttu-id="cab27-231">Configurez le fichier msmdsrv.log pour contrôler la taille et le numéro du fichier journal msmdsrv.</span><span class="sxs-lookup"><span data-stu-id="cab27-231">Configure the msmdsrv.log file to control the size and number of msmdsrv log file.</span></span> <span data-ttu-id="cab27-232">Les paramètres ne sont pas activés par défaut. Veillez à les ajouter comme étapes de post-installation.</span><span class="sxs-lookup"><span data-stu-id="cab27-232">The settings are not enabled by default, so be sure to add them as post-installation step.</span></span> <span data-ttu-id="cab27-233">Consultez [Fichier journal du service MSMDSRV](#bkmk_msmdsrv) dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="cab27-233">See [MSMDSRV service log file](#bkmk_msmdsrv) in this topic.</span></span>  
  
-   <span data-ttu-id="cab27-234">Passez en revue ce billet de blog des membres du support technique Microsoft, qui porte sur la [collecte de données initiales](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx), pour découvrir les ressources qu’ils utilisent, et obtenir ainsi des informations sur les opérations du serveur.</span><span class="sxs-lookup"><span data-stu-id="cab27-234">Review this blog post from Microsoft Customer Support to learn what resources they use to get information about server operations: [Initial Data Collection](https://blogs.msdn.com/b/as_emea/archive/2012/01/02/initial-data-collection-for-troubleshooting-analysis-services-issues.aspx)</span></span>  
  
-   <span data-ttu-id="cab27-235">Utilisez ASTrace2012 plutôt qu'un journal des requêtes pour savoir qui interroge les cubes.</span><span class="sxs-lookup"><span data-stu-id="cab27-235">Use ASTrace2012, rather than a query log, to find out who is querying cubes.</span></span> <span data-ttu-id="cab27-236">Le journal des requêtes sert généralement à fournir une entrée pour l'Assistant Optimisation de l'utilisation. Les données qu'il capture ne sont pas faciles à lire ou à interpréter.</span><span class="sxs-lookup"><span data-stu-id="cab27-236">The query log is typically used to provide input into the Usage Based Optimization Wizard, and the data it captures is not easy to read or interpret.</span></span> <span data-ttu-id="cab27-237">ASTrace2012 est un outil de la communauté, largement utilisé, qui capture les opérations de requêtes.</span><span class="sxs-lookup"><span data-stu-id="cab27-237">ASTrace2012 is a community tool, widely used, that captures query operations.</span></span> <span data-ttu-id="cab27-238">Consultez [Exemples de la communauté Microsoft SQL Server : Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/).</span><span class="sxs-lookup"><span data-stu-id="cab27-238">See [Microsoft SQL Server Community Samples: Analysis Services](https://sqlsrvanalysissrvcs.codeplex.com/).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cab27-239">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cab27-239">See Also</span></span>  
 <span data-ttu-id="cab27-240">[Gestion des instances de Analysis Services](analysis-services-instance-management.md) </span><span class="sxs-lookup"><span data-stu-id="cab27-240">[Analysis Services Instance Management](analysis-services-instance-management.md) </span></span>  
 <span data-ttu-id="cab27-241">[Présentation de l’analyse des Analysis Services avec SQL Server Profiler](introduction-to-monitoring-analysis-services-with-sql-server-profiler.md) </span><span class="sxs-lookup"><span data-stu-id="cab27-241">[Introduction to Monitoring Analysis Services with SQL Server Profiler](introduction-to-monitoring-analysis-services-with-sql-server-profiler.md) </span></span>  
 [<span data-ttu-id="cab27-242">Configurer les propriétés du serveur dans Analysis Services</span><span class="sxs-lookup"><span data-stu-id="cab27-242">Configure Server Properties in Analysis Services</span></span>](../server-properties/server-properties-in-analysis-services.md)  
  
  
