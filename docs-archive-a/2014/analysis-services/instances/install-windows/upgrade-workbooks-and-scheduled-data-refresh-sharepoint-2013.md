---
title: Mettre à niveau les classeurs et l’actualisation planifiée des données (SharePoint 2013) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
ms.assetid: a49c4af4-e243-4926-be97-74da1f9d54eb
author: minewiskan
ms.author: owend
ms.openlocfilehash: 185fe0864bc4c1cdda9a63fa97a17319d65dc87d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87697275"
---
# <a name="upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013"></a><span data-ttu-id="2f776-102">Mettre à niveau les classeurs et l'actualisation planifiée des données (SharePoint 2013)</span><span class="sxs-lookup"><span data-stu-id="2f776-102">Upgrade Workbooks and Scheduled Data Refresh (SharePoint 2013)</span></span>
  <span data-ttu-id="2f776-103">Cette rubrique traite de l'utilisation des classeurs créés dans les environnements PowerPivot précédents et comment mettre à niveau les classeurs PowerPivot afin de pouvoir tirer parti des nouvelles fonctionnalités introduites dans cette version.</span><span class="sxs-lookup"><span data-stu-id="2f776-103">This topic explains the user experience of workbooks created in previous PowerPivot environments and how to upgrade PowerPivot workbooks so that you can take advantage of new features introduced in this release.</span></span> <span data-ttu-id="2f776-104">Pour en savoir plus sur les nouvelles fonctionnalités, consultez [Nouveautés de PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span><span class="sxs-lookup"><span data-stu-id="2f776-104">To learn more about new features, see [What's New in PowerPivot](https://go.microsoft.com/fwlink/?LinkID=203917).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="2f776-105">Vous ne pouvez pas restaurer la mise à niveau de classeurs qui sont mis à niveau automatiquement sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2f776-105">You cannot rollback upgrade for workbooks that are upgraded automatically on the server.</span></span> <span data-ttu-id="2f776-106">Une fois qu'un classeur est mis à niveau, il le reste.</span><span class="sxs-lookup"><span data-stu-id="2f776-106">Once a workbook is upgraded, it remains upgraded.</span></span> <span data-ttu-id="2f776-107">Pour utiliser une version antérieure, vous pouvez republier le classeur précédent dans SharePoint, restaurer une version antérieure ou recycler le classeur.</span><span class="sxs-lookup"><span data-stu-id="2f776-107">To use a previous version, you can republish the previous workbook to SharePoint, restore a previous version, or recycle the workbook.</span></span> <span data-ttu-id="2f776-108">Pour plus d'informations sur la restauration ou le recyclage d'un document dans SharePoint, consultez [Planifier la protection du contenu à l’aide de corbeilles et du contrôle de version](https://go.microsoft.com/fwlink/?LinkId=238669).</span><span class="sxs-lookup"><span data-stu-id="2f776-108">For more information about restoring or recycling a document in SharePoint, see [Plan to protect content by using recycle bins and versioning](https://go.microsoft.com/fwlink/?LinkId=238669).</span></span>  
  
 <span data-ttu-id="2f776-109">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="2f776-109">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="2f776-110">Vue d'ensemble de la mise à niveau des classeurs</span><span class="sxs-lookup"><span data-stu-id="2f776-110">Overview of Upgrading Workbooks</span></span>](#bkmk_overview)  
  
-   [<span data-ttu-id="2f776-111">Mettre à niveau des classeurs SQL Server 2008 R2 vers des classeurs SQL Server 2012 Service Pack 1 (SP1)</span><span class="sxs-lookup"><span data-stu-id="2f776-111">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>](#bkmk_to_2012sp1_from_2008r2)  
  
-   [<span data-ttu-id="2f776-112">Mise à niveau vers des classeurs Office 2013 à partir de versions créées à l'aide du complément PowerPivot 2012 pour Excel</span><span class="sxs-lookup"><span data-stu-id="2f776-112">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>](#bkmk_to_2012sp1_from_2012)  
  
-   [<span data-ttu-id="2f776-113">Mise à niveau vers des classeurs SQL Server 2012 à partir de versions créées à l'aide du complément PowerPivot 2008 R2 pour Excel 2010</span><span class="sxs-lookup"><span data-stu-id="2f776-113">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>](#bkmk_to_2012_from_2008R2)  
  
-   [<span data-ttu-id="2f776-114">Exécution de plusieurs versions de classeurs sur un serveur plus récent</span><span class="sxs-lookup"><span data-stu-id="2f776-114">Running Multiple Workbook Versions on a Newer Server</span></span>](#bkmk_runold)  
  
##  <a name="overview-of-upgrading-workbooks"></a><a name="bkmk_overview"></a><span data-ttu-id="2f776-115">Vue d’ensemble de la mise à niveau des classeurs</span><span class="sxs-lookup"><span data-stu-id="2f776-115">Overview of Upgrading Workbooks</span></span>  
 <span data-ttu-id="2f776-116">Un classeur PowerPivot est un classeur Excel qui contient des données PowerPivot incorporées.</span><span class="sxs-lookup"><span data-stu-id="2f776-116">A PowerPivot workbook is an Excel workbook that contains embedded PowerPivot data.</span></span> <span data-ttu-id="2f776-117">La mise à niveau d'un classeur présente deux avantages :</span><span class="sxs-lookup"><span data-stu-id="2f776-117">Upgrading a workbook has two benefits:</span></span>  
  
-   <span data-ttu-id="2f776-118">Utilisez les nouvelles fonctionnalités de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2f776-118">Use new features in [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)].</span></span>  
  
-   <span data-ttu-id="2f776-119">Permet l'actualisation planifiée des données pour les classeurs exécutés avec un serveur [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2f776-119">Enables scheduled data refresh for workbooks that run with a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] Analysis Services server in SharePoint mode.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2f776-120">Vous ne pouvez pas restaurer un classeur mis à niveau : assurez-vous de faire une copie du fichier si vous souhaitez l'utiliser dans la version antérieure de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], ou dans une version antérieure de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2f776-120">You cannot rollback an upgraded workbook, so be sure to make a copy of the file if you want to use it in the previous version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], or on a previous version of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="2f776-121">Le tableau suivant répertorie la prise en charge et le comportement des classeurs PowerPivot sur l'environnement dans lequel le classeur a été créé.</span><span class="sxs-lookup"><span data-stu-id="2f776-121">The following table lists the support and behavior of PowerPivot workbooks based on the environment  in which the workbook was created.</span></span> <span data-ttu-id="2f776-122">Le comportement décrit inclut l'expérience 'utilisateur générale, les options de mise à niveau prises en charge pour mettre à niveau le classeur vers un environnement spécifique, et le comportement de l'actualisation planifiée des données d'un classeur qui n'a pas encore été mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="2f776-122">The behavior described includes the general user experience, the supported upgrade options to upgrade the workbook to the particular environment, and the behavior of scheduled data refresh of a workbook that has not yet been upgraded.</span></span>  
  
### <a name="workbook-behavior-and-upgrade-options"></a><span data-ttu-id="2f776-123">Comportement et options de mise à niveau des classeurs</span><span class="sxs-lookup"><span data-stu-id="2f776-123">Workbook Behavior and Upgrade Options</span></span>  
  
|<span data-ttu-id="2f776-124">Environnement de création</span><span class="sxs-lookup"><span data-stu-id="2f776-124">Created In</span></span>|\<|<span data-ttu-id="2f776-125">Prise en charge et comportement</span><span class="sxs-lookup"><span data-stu-id="2f776-125">Support and Behavior</span></span>|>|  
|----------------|--------|--------------------------|--------|  
||<span data-ttu-id="2f776-126">**2008 R2 PowerPivot pour SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="2f776-126">**2008 R2 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="2f776-127">**2012 PowerPivot pour SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="2f776-127">**2012 PowerPivot for SharePoint 2010**</span></span>|<span data-ttu-id="2f776-128">**2012 SP1 PowerPivot pour SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="2f776-128">**2012 SP1 PowerPivot for SharePoint 2013**</span></span>|  
|<span data-ttu-id="2f776-129">**2008 R2 PowerPivot pour Excel 2010**</span><span class="sxs-lookup"><span data-stu-id="2f776-129">**2008 R2 PowerPivot for Excel 2010**</span></span>|<span data-ttu-id="2f776-130">Toutes les fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="2f776-130">All Features</span></span>|<span data-ttu-id="2f776-131">**Expérience :** les utilisateurs peuvent interagir avec le classeur dans le navigateur et l'utiliser comme source de données pour d'autres solutions.</span><span class="sxs-lookup"><span data-stu-id="2f776-131">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="2f776-132">**Mise à niveau :** les classeurs sont mis à niveau automatiquement dans la bibliothèque de documents si la mise à niveau automatique est activée pour le service système PowerPivot dans la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2f776-132">**Upgrade:** Workbooks will auto upgrade in the document library if Auto Upgrade is enabled for the PowerPivot system Service in the SharePoint farm,</span></span><br /><br /> <span data-ttu-id="2f776-133">**Planification de l'actualisation des données :** NON prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-133">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="2f776-134">Le classeur doit être mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="2f776-134">Workbook needs to be upgraded.</span></span>|<span data-ttu-id="2f776-135">**Expérience :** les utilisateurs peuvent interagir avec le classeur et l'utiliser comme source de données pour d'autres solutions.</span><span class="sxs-lookup"><span data-stu-id="2f776-135">**Experience:** Users can interact with the workbook and use it as a data source for other solutions.</span></span><br /><br /> <span data-ttu-id="2f776-136">**Mise à niveau :** la mise à niveau automatique n'est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="2f776-136">**Upgrade:** Auto upgrade is not available.</span></span> <span data-ttu-id="2f776-137">Les utilisateurs doivent mettre à niveau leurs classeurs 2008 R2 vers la version 2012 ou version Office 2013 manuellement.</span><span class="sxs-lookup"><span data-stu-id="2f776-137">Users must manually upgrade their 2008 R2 workbooks to the 2012 version or to the office 2013 version.</span></span><br /><br /> <span data-ttu-id="2f776-138">**Planification de l'actualisation des données :** NON prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-138">**Schedule data refresh:** NOT supported.</span></span> <span data-ttu-id="2f776-139">Le classeur doit être mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="2f776-139">Workbook needs to be upgraded.</span></span>|  
|<span data-ttu-id="2f776-140">**2012 PowerPivot pour Excel**</span><span class="sxs-lookup"><span data-stu-id="2f776-140">**2012 PowerPivot for Excel**</span></span>|<span data-ttu-id="2f776-141">Non pris en charge</span><span class="sxs-lookup"><span data-stu-id="2f776-141">Not supported</span></span>|<span data-ttu-id="2f776-142">Toutes les fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="2f776-142">All Features</span></span>|<span data-ttu-id="2f776-143">**Expérience :** les utilisateurs peuvent interagir avec le classeur dans le navigateur et l'utiliser comme source de données pour d'autres solutions.</span><span class="sxs-lookup"><span data-stu-id="2f776-143">**Experience:** Users can interact with the workbook in the browser and use it as a data source for other solutions.</span></span> <span data-ttu-id="2f776-144">La planification de l'actualisation des données est disponible.</span><span class="sxs-lookup"><span data-stu-id="2f776-144">Schedule data refresh is available.</span></span><br /><br /> <span data-ttu-id="2f776-145">**Mise à niveau :** la mise à niveau automatique n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-145">**Upgrade:** Auto upgrade is not supported.</span></span> <span data-ttu-id="2f776-146">Les utilisateurs peuvent mettre à niveau leurs classeurs vers la version Office 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-146">Users can manually upgrade their workbooks to the Office 2013 version.</span></span><br /><br /> <span data-ttu-id="2f776-147">**Planification de l'actualisation des données :** prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-147">**Schedule data refresh:** supported.</span></span>|  
|<span data-ttu-id="2f776-148">**Excel 2013**</span><span class="sxs-lookup"><span data-stu-id="2f776-148">**Excel 2013**</span></span>|<span data-ttu-id="2f776-149">Non pris en charge</span><span class="sxs-lookup"><span data-stu-id="2f776-149">Not supported</span></span>|<span data-ttu-id="2f776-150">Non pris en charge</span><span class="sxs-lookup"><span data-stu-id="2f776-150">Not supported</span></span>|<span data-ttu-id="2f776-151">Toutes les fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="2f776-151">All Features</span></span>|  
  
##  <a name="upgrade-to-sql-server-2012-service-pack-1-sp1-workbooks-from-2008-r2-workbooks"></a><a name="bkmk_to_2012sp1_from_2008r2"></a><span data-ttu-id="2f776-152">Mettre à niveau vers SQL Server classeurs 2012 Service Pack 1 (SP1) à partir de classeurs 2008 R2</span><span class="sxs-lookup"><span data-stu-id="2f776-152">Upgrade to SQL Server 2012 Service Pack 1 (SP1) workbooks from 2008 R2 Workbooks</span></span>  
 <span data-ttu-id="2f776-153">Cette section décrit la mise à niveau de classeurs SQL Server 2008 R2 PowerPivot pour Excel 2010 vers des classeurs SQL Server 2012 SP1 PowerPivot pour Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-153">This section describes upgrading to SQL Server 2012 SP1 PowerPivot for Excel 2013 workbooks from SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="2f776-154">**Modification du comportement :** les classeurs PowerPivot SQL Server 2008 R2 ne sont pas mis à niveau automatiquement lorsqu'ils sont utilisés dans SQL Server 2012 SP1 PowerPivot pour SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-154">**Behavior Change:** SQL Server 2008 R2 PowerPivot workbooks will not be automatically upgraded  when they are used in SQL Server 2012 SP1 PowerPivot for SharePoint 2013.</span></span> <span data-ttu-id="2f776-155">Par conséquent, les actualisations planifiées de données ne fonctionnent pas pour les classeurs PowerPivot SQL Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="2f776-155">Therefore, scheduled data refreshes will not work for SQL Server 2008 R2 PowerPivot workbooks</span></span>  
  
 <span data-ttu-id="2f776-156">Les classeurs SQL Server 2008 R2 s'ouvrent dans PowerPivot pour SharePoint 2013, cependant les actualisations planifiées de données ne fonctionnent pas.</span><span class="sxs-lookup"><span data-stu-id="2f776-156">2008 R2 workbooks will open in PowerPivot for SharePoint 2013, however scheduled data refreshes will not work.</span></span> <span data-ttu-id="2f776-157">Si vous observez l'historique d'actualisation, vous pouvez voir un message d'erreur semblable au message suivant :</span><span class="sxs-lookup"><span data-stu-id="2f776-157">If you review the refresh history you will see an error message similar to the following:</span></span>  
  
 <span data-ttu-id="2f776-158">«Le classeur contient un modèle PowerPivot non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-158">"The workbook contains an unsupported PowerPivot model.</span></span> <span data-ttu-id="2f776-159">Le modèle PowerPivot dans le classeur est au format SQL Server 2008 R2 PowerPivot pour Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="2f776-159">The PowerPivot model in the workbook is in the SQL Server 2008 R2 PowerPivot for Excel 2010 format.</span></span> <span data-ttu-id="2f776-160">Les modèles PowerPivot pris en charge sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="2f776-160">Supported PowerPivot models are the following:</span></span>  
  
-   <span data-ttu-id="2f776-161">SQL Server 2012 PowerPivot pour Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="2f776-161">SQL Server 2012 PowerPivot for Excel 2010.</span></span>  
  
-   <span data-ttu-id="2f776-162">SQL Server 2012 PowerPivot pour Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-162">SQL Server 2012 PowerPivot for Excel 2013.</span></span>  
  
 <span data-ttu-id="2f776-163">**Comment mettre à niveau un classeur :** l'actualisation planifiée de données ne fonctionne pas tant que vous n'avez pas mis à niveau le classeur vers un classeur 2012.</span><span class="sxs-lookup"><span data-stu-id="2f776-163">**How to upgrade a workbook:** The Scheduled data refresh will not work until you upgrade the workbook to a 2012 workbook.</span></span> <span data-ttu-id="2f776-164">Pour mettre à niveau le classeur et le modèle qu'il contient, procédez de l'une des façons suivantes :</span><span class="sxs-lookup"><span data-stu-id="2f776-164">To upgrade the workbook and model it contains, complete one of the following:</span></span>  
  
-   <span data-ttu-id="2f776-165">Téléchargez et ouvrez le classeur dans Microsoft Excel 2010 avec le complément SQL Server 2012 PowerPivot pour Excel installé.</span><span class="sxs-lookup"><span data-stu-id="2f776-165">Download and open the workbook in Microsoft Excel 2010 with the SQL Server 2012 PowerPivot for Excel add-in installed.</span></span>  
  
     <span data-ttu-id="2f776-166">Ouvrez la fenêtre PowerPivot et mettez à niveau le modèle PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-166">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="2f776-167">Ensuite, enregistrez le classeur et republiez-le sur SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2f776-167">Then save the workbook and republish it to SharePoint.</span></span>  
  
-   <span data-ttu-id="2f776-168">Téléchargez et ouvrez le classeur dans Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-168">Download and open the workbook in Microsoft Excel 2013.</span></span>  
  
     <span data-ttu-id="2f776-169">Ouvrez la fenêtre PowerPivot et mettez à niveau le modèle PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-169">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
     <span data-ttu-id="2f776-170">Ensuite, enregistrez le classeur et republiez-le sur le serveur SharePoint.</span><span class="sxs-lookup"><span data-stu-id="2f776-170">Then save the workbook and republish it to the SharePoint server.</span></span>  
  
 <span data-ttu-id="2f776-171">Pour plus d’informations sur les modifications apportées aux fonctionnalités de Analysis Services, consultez [changements de comportement apportés aux fonctionnalités de Analysis Services dans SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span><span class="sxs-lookup"><span data-stu-id="2f776-171">For more information on Changes to Analysis Services features, see [Behavior Changes to Analysis Services Features in SQL Server 2014](../../behavior-changes-to-analysis-services-features-in-sql-server-2014.md)</span></span>  
  
 <span data-ttu-id="2f776-172">Pour plus d’informations sur l’historique d’actualisation, consultez [afficher l’historique d’actualisation des données &#40;PowerPivot pour SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="2f776-172">For more information on refresh history, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>  
  
##  <a name="upgrade-to-office-2013-workbooks-from-versions-created-by-using-the-2012-powerpivot-add-in-for-excel"></a><a name="bkmk_to_2012sp1_from_2012"></a><span data-ttu-id="2f776-173">Effectuer une mise à niveau vers des classeurs Office 2013 à partir de versions créées à l’aide du complément PowerPivot 2012 pour Excel</span><span class="sxs-lookup"><span data-stu-id="2f776-173">Upgrade to Office 2013 workbooks from Versions created by using the 2012 PowerPivot Add-In for Excel</span></span>  
 <span data-ttu-id="2f776-174">Cette section décrit la mise à niveau **de** classeurs SQL Server 2012 PowerPivot pour Excel 2010 **vers** SQL Server 2012 SP1 PowerPivot pour Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-174">This section describes Upgrading **to** SQL Server 2012 SP1 PowerPivot in Excel 2013 **from** SQL Server 2012 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="2f776-175">La mise à niveau d'un classeur résout l'erreur suivante qui se produit lors de la tentative d'actualisation planifiée des données sur le classeur de version précédente :</span><span class="sxs-lookup"><span data-stu-id="2f776-175">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="2f776-176">« L’opération d’actualisation des classeurs créés avec une version antérieure de PowerPivot n’est pas disponible ».</span><span class="sxs-lookup"><span data-stu-id="2f776-176">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="2f776-177">**Procédure de mise à niveau d'un classeur**</span><span class="sxs-lookup"><span data-stu-id="2f776-177">**How to upgrade a workbook**</span></span>  
  
1.  <span data-ttu-id="2f776-178">Mettez à niveau chaque classeur manuellement en l'ouvrant dans Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-178">Upgrade each workbook manually by opening it in Microsoft Excel 2013.</span></span>  
  
2.  <span data-ttu-id="2f776-179">Pour mettre à niveau le classeur et le modèle qu'il contient, téléchargez et ouvrez le classeur dans Microsoft Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-179">To upgrade the workbook and model it contains, download and open the workbook in Microsoft Excel 2013.</span></span>  
  
3.  <span data-ttu-id="2f776-180">Ouvrez la fenêtre PowerPivot et mettez à niveau le modèle PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-180">Open the PowerPivot window and upgrade the PowerPivot model.</span></span>  
  
4.  <span data-ttu-id="2f776-181">Ensuite, enregistrez le classeur et republiez-le sur le serveur SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="2f776-181">Then save the workbook and republish it to the SharePoint 2013 server.</span></span>  
  
##  <a name="upgrade-to-sql-server-2012-workbooks-from-versions-created-by-using-the-2008-r2-powerpivot-add-in-for-excel-2010"></a><a name="bkmk_to_2012_from_2008R2"></a><span data-ttu-id="2f776-182">Effectuer une mise à niveau vers des classeurs SQL Server 2012 à partir de versions créées à l’aide du complément PowerPivot 2008 R2 pour Excel 2010</span><span class="sxs-lookup"><span data-stu-id="2f776-182">Upgrade to SQL Server 2012 workbooks from Versions created by using the 2008 R2 PowerPivot Add-In for Excel 2010</span></span>  
 <span data-ttu-id="2f776-183">Cette section décrit la mise à niveau de classeurs **de** SQL Server 2008 R2 PowerPivot pour Excel 2010 **vers** SQL Server 2012 PowerPivot pour Excel 2010.</span><span class="sxs-lookup"><span data-stu-id="2f776-183">This section describes Upgrading **to** SQL Server 2012 PowerPivot for Excel 2010 **from** SQL Server 2008 R2 PowerPivot for Excel 2010 workbooks.</span></span>  
  
 <span data-ttu-id="2f776-184">La mise à niveau d'un classeur résout l'erreur suivante qui se produit lors de la tentative d'actualisation planifiée des données sur le classeur de version précédente :</span><span class="sxs-lookup"><span data-stu-id="2f776-184">Upgrading a workbook resolves the following error that occurs when attempting scheduled data refresh on the previous workbook version workbook:</span></span>  
  
 <span data-ttu-id="2f776-185">« L’opération d’actualisation des classeurs créés avec une version antérieure de PowerPivot n’est pas disponible ».</span><span class="sxs-lookup"><span data-stu-id="2f776-185">"Refresh operation for workbooks created with earlier version of PowerPivot is not available."</span></span>  
  
 <span data-ttu-id="2f776-186">**Procédure de mise à niveau d'un classeur**</span><span class="sxs-lookup"><span data-stu-id="2f776-186">**How to upgrade a workbook**</span></span>  
  
 <span data-ttu-id="2f776-187">Vous pouvez effectuer la mise à niveau de deux façons :</span><span class="sxs-lookup"><span data-stu-id="2f776-187">There are two ways to upgrade:</span></span>  
  
1.  <span data-ttu-id="2f776-188">Mettez à niveau chaque classeur manuellement en l'ouvrant dans Excel sur un ordinateur doté de la version [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] de PowerPivot pour Excel, puis republiez-le sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2f776-188">Upgrade each workbook manually by opening it in Excel on a computer that has the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of PowerPivot for Excel, and then republish it to the server.</span></span> <span data-ttu-id="2f776-189">Lorsque vous ouvrez le classeur dans une version plus récente du complément, les opérations internes suivantes se produisent : le fournisseur de données dans la chaîne de connexion de données du classeur est mis à jour vers MSOLAP.5, les métadonnées sont mises à jour et les relations sont recréées pour assurer la conformité avec une implémentation plus récente.</span><span class="sxs-lookup"><span data-stu-id="2f776-189">When you open the workbook in the newer version of the add-in, the following internal operations occur: the data provider in the workbook data connection string is updated to MSOLAP.5, metadata is updated, and relationships are recreated to conform to a newer implementation.</span></span>  
  
2.  <span data-ttu-id="2f776-190">Sinon, un administrateur SharePoint peut activer la fonctionnalité de mise à niveau automatique pour le service système PowerPivot dans une batterie de serveur SharePoint pour mettre à niveau automatiquement un classeur [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot lorsque l'actualisation planifiée des données s'exécute (seuls les classeurs configurés pour une actualisation planifiée des données sont mis à niveau).</span><span class="sxs-lookup"><span data-stu-id="2f776-190">Alternatively, a SharePoint Administrator  can enable the auto-upgrade feature for the PowerPivot System Service in a SharePoint farm to  automatically upgrade a [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] PowerPivot workbook when schedule data refresh runs (only workbooks that are configured for scheduled data refresh are upgraded).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2f776-191">La mise à niveau automatique est une fonctionnalité de configuration de serveur ; vous ne pouvez pas l'activer ou la désactiver pour des classeurs, des bibliothèques ou les collections de sites spécifiques.</span><span class="sxs-lookup"><span data-stu-id="2f776-191">Automatic upgrade is a server configuration feature; you cannot enable or disable it for specific workbooks, libraries, or site collections.</span></span>  
  
 <span data-ttu-id="2f776-192">**Procédure de configuration de la mise à niveau automatique lors de l'actualisation des données**</span><span class="sxs-lookup"><span data-stu-id="2f776-192">**How to configure automatic upgrade during data refresh**</span></span>  
  
 <span data-ttu-id="2f776-193">Pour utiliser la mise à niveau automatique, vous devez activer la case à cocher **Mettre automatiquement à niveau les classeurs PowerPivot pour permettre l'actualisation des données à partir du serveur** dans l'outil de configuration PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-193">To use automatic upgrade, you must select the **Automatically upgrade PowerPivot workbooks to enable data refresh from the server** checkbox in the PowerPivot Configuration Tool.</span></span> <span data-ttu-id="2f776-194">Dans l'outil, la case à cocher se trouve dans la page **Mettre à niveau le service système PowerPivot** , et dans la page **Créer une application de service PowerPivot** si vous configurez une nouvelle installation.</span><span class="sxs-lookup"><span data-stu-id="2f776-194">Within the tool, the checkbox is on the **Upgrade PowerPivot System Service** page, and on the **Create PowerPivot Service Application** page if you are configuring a new installation.</span></span>  
  
 <span data-ttu-id="2f776-195">Vous pouvez exécuter l'applet de commande suivante pour vérifier si la mise à niveau automatique est activée :</span><span class="sxs-lookup"><span data-stu-id="2f776-195">You can run the following cmdlet to verify whether automatic upgrade is enabled:</span></span>  
  
```  
PS C:\Windows\system32> Get-PowerPivotSystemService  
```  
  
 <span data-ttu-id="2f776-196">La sortie de la commande Get-PowerPivotSystemService est une liste de propriétés et de valeurs correspondantes.</span><span class="sxs-lookup"><span data-stu-id="2f776-196">The output from Get-PowerPivotSystemService is a list of properties and corresponding values.</span></span> <span data-ttu-id="2f776-197">Vous devriez voir `WorkbookUpgradeOnDataRefresh` dans la liste des propriétés.</span><span class="sxs-lookup"><span data-stu-id="2f776-197">You should see `WorkbookUpgradeOnDataRefresh` in the property list.</span></span> <span data-ttu-id="2f776-198">Elle aura la valeur **true** si la mise à niveau automatique est activée.</span><span class="sxs-lookup"><span data-stu-id="2f776-198">It will be set to **true** if automatic upgrade is enabled.</span></span> <span data-ttu-id="2f776-199">Si elle a la valeur **false**, passez à l'étape suivante, pour activer la mise à niveau automatique des classeurs.</span><span class="sxs-lookup"><span data-stu-id="2f776-199">If it is **false**, continue to the next step, enabling automatic workbook upgrade.</span></span>  
  
 <span data-ttu-id="2f776-200">Pour activer la mise à niveau automatique des classeurs, exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="2f776-200">To enable automatic workbook upgrade, run the following command:</span></span>  
  
```  
PS C:\Windows\system32> Set-PowerPivotSystemService -WorkbookUpgradeOnDataRefresh:$true -Confirm:$false  
```  
  
 <span data-ttu-id="2f776-201">Après la mise à niveau du classeur, vous pouvez utiliser l'actualisation planifiée des données et les nouvelles fonctionnalités du complément PowerPivot pour Excel.</span><span class="sxs-lookup"><span data-stu-id="2f776-201">After you upgrade the workbook, you can use scheduled data refresh and new features in the PowerPivot for Excel add-in.</span></span>  
  
##  <a name="running-multiple-workbook-versions-on-a-newer-server"></a><a name="bkmk_runold"></a> <span data-ttu-id="2f776-202">Exécution de plusieurs versions de classeurs sur un serveur plus récent</span><span class="sxs-lookup"><span data-stu-id="2f776-202">Running Multiple Workbook Versions on a Newer Server</span></span>  
 <span data-ttu-id="2f776-203">Vous pouvez exécuter les versions antérieures et les versions plus récentes des classeurs PowerPivot côte à côte sur une instance [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2f776-203">You can run older and newer versions of PowerPivot workbooks side by side on a [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] instance of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)].</span></span>  
  
 <span data-ttu-id="2f776-204">Selon la façon dont vous avez installé le serveur, **vous devrez peut-être** installer une version antérieure du fournisseur OLE DB Analysis Services avant de pouvoir accéder aux classeurs plus anciens et plus récents sur le même serveur.</span><span class="sxs-lookup"><span data-stu-id="2f776-204">Depending on how you installed the server, **you might need** to install a previous version of the Analysis Services OLE DB provider before you can access older and newer workbooks on the same server.</span></span>  
  
 <span data-ttu-id="2f776-205">Notez que la publication de classeurs de version plus récente sur des instances SQL Server antérieures de [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="2f776-205">Note that Publishing newer version workbooks on previous SQL Server instances of [!INCLUDE[ssGeminiShort](../../../includes/ssgeminishort-md.md)] is not supported.</span></span> <span data-ttu-id="2f776-206">Une instance de [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] ne charge pas un classeur créé dans la version [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] de [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], et une instance de SQL Server 2012 ne charge pas les classeurs Office 2013 avec des modèles de données avancés que vous avez créés à l'aide de la version [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] de PowerPivot dans Excel.</span><span class="sxs-lookup"><span data-stu-id="2f776-206">A [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)] instance will not load a workbook that you created in the [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] version of [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)], and a SQL Server 2012 instance will not load Office 2013 workbooks with advanced data models that you created using the [!INCLUDE[ssSQL11SP1](../../../includes/sssql11sp1-md.md)] version of PowerPivot in Excel.</span></span>  
  
###  <a name="how-to-check-for-msolap-data-provider-information-in-a-powerpivot-workbook"></a><a name="bkmk_msolapxslx"></a><span data-ttu-id="2f776-207">Comment rechercher des informations de Fournisseur de données MSOLAP dans un classeur PowerPivot</span><span class="sxs-lookup"><span data-stu-id="2f776-207">How to Check for MSOLAP Data Provider Information in a PowerPivot Workbook</span></span>  
 <span data-ttu-id="2f776-208">Suivez les instructions suivantes pour vérifier le fournisseur OLE DB utilisé dans un classeur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-208">Use the following instructions to check which OLE DB provider is used in a PowerPivot workbook.</span></span> <span data-ttu-id="2f776-209">La vérification des informations de connexion de données ne nécessite pas l'installation du complément [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2f776-209">Checking the data connection information does not require the [!INCLUDE[ssGeminiClient](../../../includes/ssgeminiclient-md.md)] add-in to be installed.</span></span>  
  
1.  <span data-ttu-id="2f776-210">Dans Excel, dans l'onglet Données, cliquez sur **Connexions**.</span><span class="sxs-lookup"><span data-stu-id="2f776-210">In Excel, on the Data tab, click **Connections**.</span></span> <span data-ttu-id="2f776-211">Cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2f776-211">Click **Properties**.</span></span>  
  
2.  <span data-ttu-id="2f776-212">Dans l'onglet **Définition** , la version du fournisseur apparaît au début de la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="2f776-212">On the **Definition** tab, the provider version appears at the beginning of the connection string.</span></span>  
  
     <span data-ttu-id="2f776-213">**Provider=MSOLAP.5** indique qu’il s’agit d’un classeur [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2f776-213">**Provider=MSOLAP.5** indicates the workbook is [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
     <span data-ttu-id="2f776-214">**Provider=MSOLAP.4** indique [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2f776-214">**Provider=MSOLAP.4** indicates [!INCLUDE[ssKilimanjaro](../../../includes/sskilimanjaro-md.md)].</span></span>  
  
     <span data-ttu-id="2f776-215">**Data Source=$Embedded$** indique que le classeur est un classeur PowerPivot qui utilise une base de données incorporée.</span><span class="sxs-lookup"><span data-stu-id="2f776-215">**Data Source=$Embedded$** indicates that the workbook is a PowerPivot workbook, using an embedded database.</span></span>  
  
###  <a name="how-to-check-for-the-current-version-of-the-msolap-data-provider-on-a-local-computer"></a><a name="bkmk_msolappc"></a> <span data-ttu-id="2f776-216">Comment vérifier la version actuelle du fournisseur de données MSOLAP sur un ordinateur local</span><span class="sxs-lookup"><span data-stu-id="2f776-216">How to Check for the Current Version of the MSOLAP Data Provider on a Local Computer</span></span>  
 <span data-ttu-id="2f776-217">Suivez les instructions suivantes pour vérifier quelle est la version actuelle du fournisseur OLE DB sur le serveur ou la station de travail qui exécute des classeurs PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="2f776-217">Use the following instructions to check which OLE DB provider is the current version on the server or workstation that runs PowerPivot workbooks.</span></span> <span data-ttu-id="2f776-218">Connaître la version actuelle peut vous aider à dépanner des erreurs de connexion de données après la mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="2f776-218">Knowing the current version can help you troubleshoot data connection errors after upgrading.</span></span>  
  
1.  <span data-ttu-id="2f776-219">Dans l'Éditeur du Registre, allez à HKEY_CLASSES_ROOT</span><span class="sxs-lookup"><span data-stu-id="2f776-219">In the Registry Editor, go to HKEY_CLASSES_ROOT</span></span>  
  
2.  <span data-ttu-id="2f776-220">Faites défiler jusqu'à MSOLAP.</span><span class="sxs-lookup"><span data-stu-id="2f776-220">Scroll down to MSOLAP.</span></span> <span data-ttu-id="2f776-221">Vérifiez que MSOLAP.5 apparaît parmi les fournisseurs OLAP installés sur le système.</span><span class="sxs-lookup"><span data-stu-id="2f776-221">Verify that MSOLAP.5 is listed among the OLAP providers installed on the system.</span></span> <span data-ttu-id="2f776-222">Vérifiez que MSOLAP | CurVer est défini sur MSOLAP.5</span><span class="sxs-lookup"><span data-stu-id="2f776-222">Verify that MSOLAP | CurVer is set to MSOLAP.5</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2f776-223">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2f776-223">See Also</span></span>  
 <span data-ttu-id="2f776-224">[Migrer PowerPivot vers SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="2f776-224">[Migrate PowerPivot to SharePoint 2013](migrate-power-pivot-to-sharepoint-2013.md) </span></span>  
 <span data-ttu-id="2f776-225">[Mettre à niveau PowerPivot pour SharePoint](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="2f776-225">[Upgrade PowerPivot for SharePoint](../../../database-engine/install-windows/upgrade-power-pivot-for-sharepoint.md) </span></span>  
 <span data-ttu-id="2f776-226">[Nouveautés de Analysis Services et Business Intelligence](../../what-s-new-in-analysis-services.md) </span><span class="sxs-lookup"><span data-stu-id="2f776-226">[What's New in Analysis Services and Business Intelligence](../../what-s-new-in-analysis-services.md) </span></span>  
 [<span data-ttu-id="2f776-227">Afficher l’historique d’actualisation des données &#40;PowerPivot pour SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="2f776-227">View Data Refresh History &#40;PowerPivot for SharePoint&#41;</span></span>](../../power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)  
  
  
