---
title: Configurer le pare-feu Windows pour autoriser l’accès Analysis Services | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- ports [Analysis Services]
- Windows Firewall [Analysis Services]
- firewall systems [Analysis Services]
ms.assetid: 7673acc5-75f0-4703-9ce2-87425ea39d49
author: minewiskan
ms.author: owend
ms.openlocfilehash: f7d63b392148bf10a6b121dd4d201b7a7c61e0c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698855"
---
# <a name="configure-the-windows-firewall-to-allow-analysis-services-access"></a><span data-ttu-id="6f85c-102">Configurer le pare-feu Windows pour autoriser l'accès à Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-102">Configure the Windows Firewall to Allow Analysis Services Access</span></span>
  <span data-ttu-id="6f85c-103">Une première étape essentielle pour mettre [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] ou [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] à disposition sur le réseau consiste à déterminer si vous devez débloquer des ports dans un pare-feu.</span><span class="sxs-lookup"><span data-stu-id="6f85c-103">An essential first step in making [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] or [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] available on the network is to determine whether you need to unblock ports in a firewall.</span></span> <span data-ttu-id="6f85c-104">La plupart des installations nécessitent la création d'au moins une règle de trafic entrant dans le pare-feu qui autorise les connexions à [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f85c-104">Most installations will require that you create at least one in-bound firewall rule that allows connections to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="6f85c-105">Les conditions de configuration du pare-feu varient selon le mode d'installation de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="6f85c-105">Firewall configuration requirements vary depending on how you installed [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="6f85c-106">Ouvrez le port TCP 2383 lors de l'installation d'une instance par défaut ou de la création d'un cluster de basculement [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6f85c-106">Open TCP port 2383 when installing a default instance or creating an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster.</span></span>  
  
-   <span data-ttu-id="6f85c-107">Ouvrez le port TCP 2382 lors de l'installation d'une instance nommée.</span><span class="sxs-lookup"><span data-stu-id="6f85c-107">Open TCP port 2382 when installing a named instance.</span></span> <span data-ttu-id="6f85c-108">Les instances nommées utilisent les affectations de ports dynamiques.</span><span class="sxs-lookup"><span data-stu-id="6f85c-108">Named instances use dynamic port assignments.</span></span> <span data-ttu-id="6f85c-109">En tant que service de découverte pour Analysis Services, le service SQL Server Browser écoute le port TCP 2382 et redirige la demande de connexion vers le port utilisé par [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f85c-109">As the discovery service for Analysis Services, SQL Server Browser service listens on TCP port 2382 and redirects the connection request to the port currently used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="6f85c-110">Ouvrez le port TCP 2382 lors de l'installation de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en mode SharePoint pour prendre en charge [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span><span class="sxs-lookup"><span data-stu-id="6f85c-110">Open TCP port 2382 when installing [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in SharePoint mode to support [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013.</span></span> <span data-ttu-id="6f85c-111">Dans [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, l'instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] est externe à SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6f85c-111">In [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2013, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance is external to SharePoint.</span></span> <span data-ttu-id="6f85c-112">Les demandes entrantes à destination de l'instance nommée « PowerPivot » proviennent des applications Web SharePoint via une connexion réseau, qui nécessite un port ouvert.</span><span class="sxs-lookup"><span data-stu-id="6f85c-112">Inbound requests to the named 'PowerPivot' instance originate from SharePoint web applications over a network connection, requiring an open port.</span></span> <span data-ttu-id="6f85c-113">Comme avec d'autres instances nommées [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , créez une règle de trafic entrant pour le service SQL Server Browser sur le port TCP 2382 pour permettre l'accès à [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f85c-113">As with other [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, create an inbound rule for SQL Server Browser service on TCP 2382 to allow access to [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)].</span></span>  
  
-   <span data-ttu-id="6f85c-114">Pour [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, n'ouvrez pas les ports du Pare-feu Windows.</span><span class="sxs-lookup"><span data-stu-id="6f85c-114">For [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] 2010, do not open ports in Windows Firewall.</span></span> <span data-ttu-id="6f85c-115">En tant que complément de SharePoint, le service utilise les ports configurés pour SharePoint et établit uniquement des connexions locales à l'instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] qui charge et interroge les modèles de données [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6f85c-115">As an add-in to SharePoint, the service uses ports configured for SharePoint and makes only local connections to the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance that loads and queries [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models.</span></span>  
  
-   <span data-ttu-id="6f85c-116">Pour les [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances exécutées sur des machines virtuelles Azure, utilisez d’autres instructions pour la configuration de l’accès aux serveurs.</span><span class="sxs-lookup"><span data-stu-id="6f85c-116">For [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instances running on Azure Virtual Machines, use alternate instructions for configuring server access.</span></span> <span data-ttu-id="6f85c-117">Consultez [SQL Server Business Intelligence dans les machines virtuelles Azure](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span><span class="sxs-lookup"><span data-stu-id="6f85c-117">See [SQL Server Business Intelligence in Azure Virtual Machines](https://msdn.microsoft.com/library/windowsazure/jj992719.aspx).</span></span>  
  
 <span data-ttu-id="6f85c-118">Bien que l’instance par défaut de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] écoute le port TCP 2383, vous pouvez configurer le serveur pour qu’il écoute sur un port fixe différent, en vous connectant au serveur dans ce format : \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-118">Although the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383, you can configure the server to listen on a different fixed port, connecting to the server in this format: \<servername>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="6f85c-119">Seul un port TCP peut être utilisé par une instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="6f85c-119">Only one TCP port can be used by an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="6f85c-120">Sur des ordinateurs disposant de plusieurs cartes réseau ou de plusieurs adresses IP, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] écoute un port TCP à la recherche de toutes les adresses IP affectées ou affectées comme alias à l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6f85c-120">On computers having multiple network cards or multiple IP addresses, [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on one TCP port for all IP addresses assigned or aliased to the computer.</span></span> <span data-ttu-id="6f85c-121">Si vous avez des exigences particulières concernant plusieurs ports, pensez à configurer [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] pour l'accès HTTP.</span><span class="sxs-lookup"><span data-stu-id="6f85c-121">If you have specific multi-port requirements, consider configuring [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] for HTTP access.</span></span> <span data-ttu-id="6f85c-122">Vous pouvez ensuite configurer plusieurs points de terminaison HTTP sur les ports que vous choisissez.</span><span class="sxs-lookup"><span data-stu-id="6f85c-122">You can then set up multiple HTTP endpoints on whatever ports you choose.</span></span> <span data-ttu-id="6f85c-123">Consultez [Configurer l’accès HTTP à Analysis Services sur Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="6f85c-123">See [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
 <span data-ttu-id="6f85c-124">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="6f85c-124">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="6f85c-125">Vérifier les paramètres des ports et du pare-feu utilisés par Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-125">Check port and firewall settings for Analysis Services</span></span>](#bkmk_checkport)  
  
-   [<span data-ttu-id="6f85c-126">Configurer le pare-feu Windows pour une instance par défaut d'Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-126">Configure Windows Firewall for a default instance of Analysis Services</span></span>](#bkmk_default)  
  
-   [<span data-ttu-id="6f85c-127">Configurer l'accès au Pare-feu Windows pour une instance nommée Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-127">Configure Windows Firewall access for a named instance of Analysis Services</span></span>](#bkmk_named)  
  
-   [<span data-ttu-id="6f85c-128">Configuration de port pour un cluster Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-128">Port configuration for an Analysis Services cluster</span></span>](#bkmk_cluster)  
  
-   [<span data-ttu-id="6f85c-129">Configuration de port pour PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="6f85c-129">Port configuration for PowerPivot for SharePoint</span></span>](#bkmk_powerpivot)  
  
-   [<span data-ttu-id="6f85c-130">Utiliser un port fixe pour une instance par défaut ou nommée d'Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-130">Use a fixed port for a default or named instance of Analysis Services</span></span>](#bkmk_fixed)  
  
 <span data-ttu-id="6f85c-131">Pour plus d’informations sur les paramètres par défaut du Pare-feu Windows et pour obtenir une description des ports TCP qui affectent le moteur de base de données, Analysis Services, Reporting Services et Integration Services, consultez [Configurer le Pare-feu Windows pour autoriser l’accès à SQL Server](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span><span class="sxs-lookup"><span data-stu-id="6f85c-131">For more information about the default Windows firewall settings, and a description of the TCP ports that affect the Database Engine, Analysis Services, Reporting Services, and Integration Services, see [Configure the Windows Firewall to Allow SQL Server Access](../../sql-server/install/configure-the-windows-firewall-to-allow-sql-server-access.md).</span></span>  
  
##  <a name="check-port-and-firewall-settings-for-analysis-services"></a><a name="bkmk_checkport"></a><span data-ttu-id="6f85c-132">Vérifiez les paramètres de port et de pare-feu pour Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-132">Check port and firewall settings for Analysis Services</span></span>  
 <span data-ttu-id="6f85c-133">Sur les systèmes d'exploitation Microsoft Windows pris en charge par [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], le Pare-feu Windows est activé par défaut et bloque les connexions à distance.</span><span class="sxs-lookup"><span data-stu-id="6f85c-133">On the Microsoft Windows operating systems that are supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)], Windows Firewall is on by default and is blocking remote connections.</span></span> <span data-ttu-id="6f85c-134">Vous devez ouvrir manuellement un port dans le Pare-feu pour autoriser les demandes entrantes à destination d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-134">You must manually open a port in the firewall to allow inbound requests to Analysis Services.</span></span> <span data-ttu-id="6f85c-135">Le programme d'installation de SQL Server n'effectue pas cette étape pour vous.</span><span class="sxs-lookup"><span data-stu-id="6f85c-135">SQL Server Setup does not perform this step for you.</span></span>  
  
 <span data-ttu-id="6f85c-136">Le paramétrage des ports s'effectue dans le fichier msmdsrv.ini et dans SQL Server Management Studio, dans la page Propriétés générales d'une instance d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-136">Port settings are specified in the msmdsrv.ini file and in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span> <span data-ttu-id="6f85c-137">Si la valeur de `Port` est un entier positif, le service écoute un port fixe.</span><span class="sxs-lookup"><span data-stu-id="6f85c-137">If `Port` is set to a positive integer, the service is listening on a fixed port.</span></span> <span data-ttu-id="6f85c-138">Si la valeur de `Port` est 0, le service écoute le port 2383 s'il s'agit de l'instance par défaut ou un port affecté dynamiquement s'il s'agit d'une instance nommée.</span><span class="sxs-lookup"><span data-stu-id="6f85c-138">If `Port` is set to 0, the service is listening on port 2383 if it is the default instance or on a dynamically assigned port if it is a named instance.</span></span>  
  
 <span data-ttu-id="6f85c-139">Les affectations de ports dynamiques ne sont utilisées que par les instances nommées.</span><span class="sxs-lookup"><span data-stu-id="6f85c-139">Dynamic port assignments are only used by named instances.</span></span> <span data-ttu-id="6f85c-140">Le service `MSOLAP$InstanceName` détermine le port à utiliser lorsqu'il démarre.</span><span class="sxs-lookup"><span data-stu-id="6f85c-140">The `MSOLAP$InstanceName` service determines which port to use when it starts up.</span></span> <span data-ttu-id="6f85c-141">Pour connaître le port qu'utilise effectivement une instance nommée, vous pouvez procéder comme suit :</span><span class="sxs-lookup"><span data-stu-id="6f85c-141">You can determine the actual port number in use by a named instance by doing the following:</span></span>  
  
-   <span data-ttu-id="6f85c-142">Démarrez le gestionnaire des tâches, puis cliquez sur **services** pour afficher le PID de l' `MSOLAP$InstanceName` .</span><span class="sxs-lookup"><span data-stu-id="6f85c-142">Start Task Manager and then click **Services** to get the PID of the `MSOLAP$InstanceName`.</span></span>  
  
-   <span data-ttu-id="6f85c-143">Exécutez `netstat -ao -p TCP` à partir de la ligne de commande pour afficher les informations de port TCP relatives à ce PID.</span><span class="sxs-lookup"><span data-stu-id="6f85c-143">Run `netstat -ao -p TCP` from the command line to view the TCP port information for that PID.</span></span>  
  
-   <span data-ttu-id="6f85c-144">Vérifiez le port à l’aide de SQL Server Management Studio et connectez-vous à un serveur Analysis Services au format suivant : \<IPAddress> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-144">Verify the port by using SQL Server Management Studio and connect to an Analysis Services server in this format: \<IPAddress>:\<portnumber>.</span></span>  
  
 <span data-ttu-id="6f85c-145">Bien qu'une application puisse être à l'écoute d'un port spécifique, les connexions échouent si un pare-feu bloque l'accès.</span><span class="sxs-lookup"><span data-stu-id="6f85c-145">Although an application might be listening on a specific port, connections will not succeed if a firewall is blocking access.</span></span> <span data-ttu-id="6f85c-146">Pour que des connexions atteignent une instance nommée d'Analysis Services, vous devez débloquer l'accès à msmdsrv.exe ou au port fixe du pare-feu sur lequel s'effectue l'écoute.</span><span class="sxs-lookup"><span data-stu-id="6f85c-146">In order for connections to reach a named Analysis Services instance, you must unblock access to either msmdsrv.exe or the fixed port on which it is listening in the firewall.</span></span> <span data-ttu-id="6f85c-147">Les sections suivantes de cette rubrique fournissent des instructions à cet effet.</span><span class="sxs-lookup"><span data-stu-id="6f85c-147">The remaining sections in this topic provide instructions for doing so.</span></span>  
  
 <span data-ttu-id="6f85c-148">Pour vérifier si des paramètres de pare-feu sont déjà définis pour Analysis Services, utilisez Pare-feu Windows avec fonctions avancées de sécurité dans le Panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="6f85c-148">To check whether firewall settings are already defined for Analysis Services, use Windows Firewall with Advanced Security in Control Panel.</span></span> <span data-ttu-id="6f85c-149">La page Pare-feu du dossier Analyse affiche la liste complète des règles définies pour le serveur local.</span><span class="sxs-lookup"><span data-stu-id="6f85c-149">The Firewall page in the Monitoring folder shows a complete list of the rules defined for the local server.</span></span>  
  
 <span data-ttu-id="6f85c-150">Notez que pour [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], toutes les règles de pare-feu doivent être définies manuellement.</span><span class="sxs-lookup"><span data-stu-id="6f85c-150">Note that for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], all firewall rules must be manually defined.</span></span> <span data-ttu-id="6f85c-151">Bien que [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] et SQL Server Browser réservent les ports 2382 et 2383, ni le programme d'installation de SQL Server, ni les outils de configuration ne définissent de règles de pare-feu qui vous donnent accès à l'un ou l'autre des ports ou aux fichiers exécutables du programme.</span><span class="sxs-lookup"><span data-stu-id="6f85c-151">Although [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] and SQL Server Browser reserve ports 2382 and 2383, neither the SQL Server setup program nor any of the configuration tools define firewall rules that allow access to either the ports or the program executable files.</span></span>  
  
##  <a name="configure-windows-firewall-for-a-default-instance-of-analysis-services"></a><a name="bkmk_default"></a><span data-ttu-id="6f85c-152">Configurer le pare-feu Windows pour une instance par défaut de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-152">Configure Windows Firewall for a default instance of Analysis Services</span></span>  
 <span data-ttu-id="6f85c-153">L'instance par défaut de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] écoute le port TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="6f85c-153">The default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] listens on TCP port 2383.</span></span> <span data-ttu-id="6f85c-154">Si vous avez installé l'instance par défaut et souhaitez utiliser ce port, il vous suffit de débloquer l'accès entrant au port TCP 2383 dans le Pare-feu Windows pour permettre l'accès distant à l'instance par défaut de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f85c-154">If you installed the default instance and want to use this port, you only need to unblock inbound access to TCP port 2383 in Windows Firewall to enable remote access to the default instance of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="6f85c-155">Si vous avez installé l'instance par défaut mais souhaitez configurer le service de façon à écouter un port fixe, consultez [Utiliser un port fixe pour une instance par défaut ou nommée d'Analysis Services](#bkmk_fixed) , plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="6f85c-155">If you installed the default instance but want to configure the service to listen on a fixed port, see [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic.</span></span>  
  
 <span data-ttu-id="6f85c-156">Pour vérifier si le service s'exécute en tant qu'instance par défaut (MSSQLServerOLAPService), vérifiez le nom du service dans le Gestionnaire de configuration SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6f85c-156">To verify whether the service is running as the default instance (MSSQLServerOLAPService), check the service name in SQL Server Configuration Manager.</span></span> <span data-ttu-id="6f85c-157">Une instance par défaut d’Analysis Services est toujours répertoriée sous le nom **SQL Server Analysis Services (MSSQLSERVER)**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-157">A default instance of Analysis Services is always listed as **SQL Server Analysis Services (MSSQLSERVER)**.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6f85c-158">Les différents systèmes d'exploitation Windows fournissent d'autres outils pour configurer le Pare-feu Windows.</span><span class="sxs-lookup"><span data-stu-id="6f85c-158">Different Windows operating systems provide alternative tools for configuring Windows Firewall.</span></span> <span data-ttu-id="6f85c-159">Dans leur majorité, ces outils vous donnent le choix entre ouvrir un port spécifique ou un exécutable de programme.</span><span class="sxs-lookup"><span data-stu-id="6f85c-159">Most of these tools let you choose between opening a specific port or program executable.</span></span> <span data-ttu-id="6f85c-160">À moins d'avoir une raison particulière de spécifier l'exécutable du programme, nous vous recommandons de spécifier le port.</span><span class="sxs-lookup"><span data-stu-id="6f85c-160">Unless you have a reason for specifying the program executable, we recommend that you specify the port.</span></span>  
  
 <span data-ttu-id="6f85c-161">Quand vous spécifiez une règle de trafic entrant, veillez à adopter une convention d’affectation de noms qui vous permette par la suite de retrouver facilement ces règles (par exemple, **SQL Server Analysis Services (TCP-entrant) 2383**).</span><span class="sxs-lookup"><span data-stu-id="6f85c-161">When specifying an inbound rule, be sure to adopt a naming convention that allows you to easily find the rules later (for example, **SQL Server Analysis Services (TCP-in) 2383**).</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="6f85c-162">Pare-feu Windows avec fonctions avancées de sécurité</span><span class="sxs-lookup"><span data-stu-id="6f85c-162">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="6f85c-163">Sur Windows 7 ou Windows Vista, dans le Panneau de configuration, cliquez sur **Système et sécurité**, sélectionnez **Pare-feu Windows**, puis cliquez sur **Paramètres avancés**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-163">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="6f85c-164">Sous Windows Server 2008 ou 2008 R2, ouvrez Outils d'administration et cliquez sur **Pare-feu Windows avec fonctions avancées de sécurité**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-164">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="6f85c-165">Sous Windows Server 2012, ouvrez la page Applications et entrez **Pare-feu Windows**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-165">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="6f85c-166">Cliquez avec le bouton droit sur **Règles de trafic entrant** et sélectionnez **Nouvelle règle**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-166">Right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="6f85c-167">Dans type de règle, cliquez sur, `Port` puis sur **suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-167">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="6f85c-168">Dans protocole et ports, sélectionnez **TCP** , puis tapez `2383` des **ports locaux spécifiques**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-168">In Protocol and Ports, select **TCP** and then type `2383` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="6f85c-169">Dans Action, cliquez sur **Autoriser la connexion** , puis sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-169">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="6f85c-170">Dans Profil, désactivez les emplacements réseau qui ne s'appliquent pas, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-170">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="6f85c-171">Dans nom, tapez un nom descriptif pour cette règle (par exemple, `SQL Server Analysis Services (tcp-in) 2383` ), puis cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-171">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services (tcp-in) 2383`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="6f85c-172">Pour vérifier que les connexions distantes sont bien activées, ouvrez SQL Server Management Studio ou Excel sur un autre ordinateur et connectez-vous à [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , en spécifiant le nom de réseau du serveur dans **Nom du serveur**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-172">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] by specifying the network name of the server in **Server name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6f85c-173">Les autres utilisateurs n'auront pas accès à ce serveur, à moins que vous ne leur accordiez les autorisations nécessaires.</span><span class="sxs-lookup"><span data-stu-id="6f85c-173">Other users will not have access to this server until you grant permissions.</span></span> <span data-ttu-id="6f85c-174">Pour plus d’informations, consultez [Autorisation de l’accès à des objets et des opérations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="6f85c-174">For more information, see [Authorizing access to objects and operations &#40;Analysis Services&#41;](../multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services.md).</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="6f85c-175">Syntaxe Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="6f85c-175">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="6f85c-176">La commande suivante crée une règle de trafic entrant qui autorise les demandes entrantes sur le port TCP 2383.</span><span class="sxs-lookup"><span data-stu-id="6f85c-176">The following command creates an inbound rule that allows incoming requests on TCP port 2383.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services inbound on TCP 2383" dir=in action=allow protocol=TCP localport=2383 profile=domain  
    ```  
  
##  <a name="configure-windows-firewall-access-for-a-named-instance-of-analysis-services"></a><a name="bkmk_named"></a><span data-ttu-id="6f85c-177">Configurer l’accès du pare-feu Windows pour une instance nommée de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-177">Configure Windows Firewall access for a named instance of Analysis Services</span></span>  
 <span data-ttu-id="6f85c-178">Les instances nommées de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] peuvent écouter soit un port fixe, soit un port affecté dynamiquement, tandis que le service SQL Server Browser fournit les informations de connexion actuelles au sujet du service au moment de la connexion.</span><span class="sxs-lookup"><span data-stu-id="6f85c-178">Named instances of [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] can either listen on a fixed port or on a dynamically assigned port, where SQL Server Browser service provides the connection information that is current for the service at the time of the connection.</span></span>  
  
 <span data-ttu-id="6f85c-179">Le service SQL Server Browser écoute le port TCP 2382.</span><span class="sxs-lookup"><span data-stu-id="6f85c-179">SQL Server Browser service listens on TCP port 2382.</span></span> <span data-ttu-id="6f85c-180">UDP n'est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="6f85c-180">UDP is not used.</span></span> <span data-ttu-id="6f85c-181">Le protocole TCP est le seul protocole de communication utilisé par [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6f85c-181">TCP is the only transmission protocol used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="6f85c-182">Choisissez l'une des approches suivantes pour activer l'accès à distance à une instance nommée d'Analysis Services :</span><span class="sxs-lookup"><span data-stu-id="6f85c-182">Choose one of the following approaches to enable remote access to a named instance of Analysis Services:</span></span>  
  
-   <span data-ttu-id="6f85c-183">Utilisez les affectations de port dynamiques, ainsi que le service SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-183">Use dynamic port assignments and SQL Server Browser service.</span></span> <span data-ttu-id="6f85c-184">Débloquez le port utilisé par le service SQL Server Browser dans le Pare-feu Windows.</span><span class="sxs-lookup"><span data-stu-id="6f85c-184">Unblock the port used by SQL Server Browser service in Windows Firewall.</span></span> <span data-ttu-id="6f85c-185">Connectez-vous au serveur au format suivant : \<servername> \\<InstanceName \> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-185">Connect to the server in this format: \<servername>\\<instancename\>.</span></span>  
  
-   <span data-ttu-id="6f85c-186">Utilisez conjointement un port fixe et le service SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-186">Use a fixed port and SQL Server Browser service together.</span></span> <span data-ttu-id="6f85c-187">Cette approche vous permet de vous connecter à l’aide de ce format : \<servername> \\<InstanceName \> , identique à l’approche d’affectation de port dynamique, sauf que dans ce cas, le serveur écoute sur un port fixe.</span><span class="sxs-lookup"><span data-stu-id="6f85c-187">This approach lets you connect using this format: \<servername>\\<instancename\>, identical to the dynamic port assignment approach, except that in this case the server listens on a fixed port.</span></span> <span data-ttu-id="6f85c-188">Dans ce cas, le service SQL Server Browser fournit un nom de résolution à l'instance Analysis Services qui écoute le port fixe.</span><span class="sxs-lookup"><span data-stu-id="6f85c-188">In this scenario, SQL Server Browser Service provides name resolution to the Analysis Services instance listening on the fixed port.</span></span> <span data-ttu-id="6f85c-189">Pour utiliser cette approche, configurez le serveur de façon à ce qu'il écoute un port fixe, débloquez l'accès à ce port, puis débloquez l'accès au port utilisé par le service SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-189">To use this approach, configure the server to listen on a fixed port, unblock access to that port, and unblock access to the port used by SQL Server Browser service.</span></span>  
  
 <span data-ttu-id="6f85c-190">Le service SQL Server Browser est uniquement utilisé avec les instances nommées, et jamais avec l'instance par défaut.</span><span class="sxs-lookup"><span data-stu-id="6f85c-190">SQL Server Browser service is only used with named instances, never with the default instance.</span></span> <span data-ttu-id="6f85c-191">Le service est automatiquement installé et activé, dès que vous installez l'une des fonctionnalités SQL Server en tant qu'instance nommée.</span><span class="sxs-lookup"><span data-stu-id="6f85c-191">The service is automatically installed and enabled whenever you install any SQL Server feature as a named instance.</span></span> <span data-ttu-id="6f85c-192">Si vous choisissez une approche qui nécessite le service SQL Server Browser, assurez-vous qu'il est toujours activé et lancé sur votre serveur.</span><span class="sxs-lookup"><span data-stu-id="6f85c-192">If you choose an approach that requires SQL Server Browser service, be sure it remains enabled and started on your server.</span></span>  
  
 <span data-ttu-id="6f85c-193">Si vous ne pouvez pas utiliser le service SQL Server Browser, vous devez affecter un port fixe dans la chaîne de connexion, qui ignore la résolution des noms de domaine.</span><span class="sxs-lookup"><span data-stu-id="6f85c-193">If you cannot use SQL Server Browser service, you must assign a fixed port in the connection string, bypassing domain name resolution.</span></span> <span data-ttu-id="6f85c-194">En l'absence du service SQL Server Browser, toutes les connexions client doivent inclure le numéro de port dans la chaîne de connexion (par exemple, AW-SRV01:54321).</span><span class="sxs-lookup"><span data-stu-id="6f85c-194">Without SQL Server Browser service, all client connections must include the port number on the connection string (for example, AW-SRV01:54321).</span></span>  
  
 <span data-ttu-id="6f85c-195">**Option n°1 : utilisez les affectations de port dynamiques et débloquez l'accès au service SQL Server Browser**</span><span class="sxs-lookup"><span data-stu-id="6f85c-195">**Option 1: Use dynamic port assignments and unblock access to SQL Server Browser service**</span></span>  
  
 <span data-ttu-id="6f85c-196">Les affectations de ports dynamiques pour les instances nommées d'Analysis Services sont établies par le service `MSOLAP$InstanceName` lorsqu'il démarre.</span><span class="sxs-lookup"><span data-stu-id="6f85c-196">Dynamic port assignments for named instances of Analysis Services are established by the `MSOLAP$InstanceName` when the service starts.</span></span> <span data-ttu-id="6f85c-197">Par défaut, le service revendique le premier numéro de port disponible qu'il trouve, et utilise un numéro de port différent chaque fois qu'il est redémarré.</span><span class="sxs-lookup"><span data-stu-id="6f85c-197">By default, the service claims the first available port number that it finds, using a different port number each time the service is restarted.</span></span>  
  
 <span data-ttu-id="6f85c-198">Le service SQL Server Browser assure la résolution des noms d'instances.</span><span class="sxs-lookup"><span data-stu-id="6f85c-198">Instance name resolution is handled by the SQL Server browser service.</span></span> <span data-ttu-id="6f85c-199">Si vous utilisez des affectations de port dynamiques avec une instance nommée, il sera toujours nécessaire de débloquer le port TCP 2382 pour le service SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-199">Unblocking TCP port 2382 for SQL Server Browser service is always required if you are using dynamic port assignments with a named instance.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6f85c-200">Le service SQL Server Browser écoute le port UDP 1434 et le port TCP 2382, pour le moteur de base de données et Analysis Services, respectivement.</span><span class="sxs-lookup"><span data-stu-id="6f85c-200">SQL Server Browser service listens on both UDP port 1434 and TCP port 2382 for the Database Engine and Analysis Services, respectively.</span></span> <span data-ttu-id="6f85c-201">Si vous avez déjà débloqué le port UDP 1434 pour le service SQL Server Browser, il vous faut néanmoins toujours débloquer le port TCP 2382 pour Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-201">Even if you already unblocked UDP port 1434 for the SQL Server Browser service, you must still unblock TCP port 2382 for Analysis Services.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="6f85c-202">Pare-feu Windows avec fonctions avancées de sécurité</span><span class="sxs-lookup"><span data-stu-id="6f85c-202">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="6f85c-203">Sur Windows 7 ou Windows Vista, dans le Panneau de configuration, cliquez sur **Système et sécurité**, sélectionnez **Pare-feu Windows**, puis cliquez sur **Paramètres avancés**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-203">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="6f85c-204">Sous Windows Server 2008 ou 2008 R2, ouvrez Outils d'administration et cliquez sur **Pare-feu Windows avec fonctions avancées de sécurité**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-204">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="6f85c-205">Sous Windows Server 2012, ouvrez la page Applications et entrez **Pare-feu Windows**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-205">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="6f85c-206">Pour débloquer l’accès au service SQL Server Browser, cliquez avec le bouton droit sur **Règles de trafic entrant** , puis sélectionnez **Nouvelle règle**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-206">To unblock access to SQL Server Browser service, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="6f85c-207">Dans type de règle, cliquez sur, `Port` puis sur **suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-207">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="6f85c-208">Dans protocole et ports, sélectionnez **TCP** , puis tapez `2382` des **ports locaux spécifiques**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-208">In Protocol and Ports, select **TCP** and then type `2382` in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="6f85c-209">Dans Action, cliquez sur **Autoriser la connexion** , puis sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-209">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="6f85c-210">Dans Profil, désactivez les emplacements réseau qui ne s'appliquent pas, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-210">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="6f85c-211">Dans nom, tapez un nom descriptif pour cette règle (par exemple, `SQL Server Browser Service (tcp-in) 2382` ), puis cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-211">In Name, type a descriptive name for this rule (for example, `SQL Server Browser Service (tcp-in) 2382`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="6f85c-212">Pour vérifier que les connexions distantes sont activées, ouvrez SQL Server Management Studio ou Excel sur un autre ordinateur et connectez-vous au Analysis Services en spécifiant le nom réseau du serveur et le nom de l’instance au format suivant : \<servername> \\<nom_instance \> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-212">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the instance name in this format: \<servername>\\<instancename\>.</span></span> <span data-ttu-id="6f85c-213">Par exemple, sur un serveur nommé **AW-SRV01** avec une instance nommée **Finance**, le nom du serveur sera **AW-SRV01\Finance**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-213">For example, on a server named **AW-SRV01** with a named instance of **Finance**, the server name is **AW-SRV01\Finance**.</span></span>  
  
 <span data-ttu-id="6f85c-214">**Option n°2 : utilisez un port fixe pour une instance nommée**</span><span class="sxs-lookup"><span data-stu-id="6f85c-214">**Option 2: Use a fixed port for a named instance**</span></span>  
  
 <span data-ttu-id="6f85c-215">L'alternative consiste à désigner un port fixe et à débloquer l'accès à ce port.</span><span class="sxs-lookup"><span data-stu-id="6f85c-215">Alternatively, you can assign a fixed port, and then unblock access to that port.</span></span> <span data-ttu-id="6f85c-216">L'avantage de cette approche est qu'elle offre de plus grandes possibilités en termes d'audit si vous autorisez l'accès au fichier exécutable de programme.</span><span class="sxs-lookup"><span data-stu-id="6f85c-216">This approach offers better auditing capability than if you allowed access to the program executable.</span></span> <span data-ttu-id="6f85c-217">L'utilisation d'un port fixe est de ce fait l'approche recommandée pour accéder à toute instance Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-217">For this reason, using a fixed port is the recommended approach for accessing any Analysis Services instance.</span></span>  
  
 <span data-ttu-id="6f85c-218">Pour affecter un port fixe, suivez les instructions de la section [Utiliser un port fixe pour une instance par défaut ou nommée d'Analysis Services](#bkmk_fixed) de cette rubrique, puis revenez à la présente section pour débloquer le port.</span><span class="sxs-lookup"><span data-stu-id="6f85c-218">To assign a fixed port, follow the instructions in [Use a fixed port for a default or named instance of Analysis Services](#bkmk_fixed) in this topic, then return to this section to unblock the port.</span></span>  
  
#### <a name="windows-firewall-with-advanced-security"></a><span data-ttu-id="6f85c-219">Pare-feu Windows avec fonctions avancées de sécurité</span><span class="sxs-lookup"><span data-stu-id="6f85c-219">Windows Firewall with Advanced Security</span></span>  
  
1.  <span data-ttu-id="6f85c-220">Sur Windows 7 ou Windows Vista, dans le Panneau de configuration, cliquez sur **Système et sécurité**, sélectionnez **Pare-feu Windows**, puis cliquez sur **Paramètres avancés**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-220">On Windows 7 or Windows Vista, in Control Panel, click **System and Security**, select **Windows Firewall**, and then click **Advanced settings**.</span></span> <span data-ttu-id="6f85c-221">Sous Windows Server 2008 ou 2008 R2, ouvrez Outils d'administration et cliquez sur **Pare-feu Windows avec fonctions avancées de sécurité**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-221">On Windows Server 2008 or 2008 R2, open Administrator Tools and click **Windows Firewall with Advanced Security**.</span></span> <span data-ttu-id="6f85c-222">Sous Windows Server 2012, ouvrez la page Applications et entrez **Pare-feu Windows**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-222">On Windows Server 2012, open the Applications page and type **Windows Firewall**.</span></span>  
  
2.  <span data-ttu-id="6f85c-223">Pour débloquer l’accès à Analysis Services, cliquez avec le bouton droit sur **Règles de trafic entrant** , puis sélectionnez **Nouvelle règle**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-223">To unblock access to Analysis Services, right-click **Inbound Rules** and select **New Rule**.</span></span>  
  
3.  <span data-ttu-id="6f85c-224">Dans type de règle, cliquez sur, `Port` puis sur **suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-224">In Rule Type, click `Port` and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="6f85c-225">Dans Protocole et ports, sélectionnez **TCP** et indiquez le port fixe dans **Ports locaux spécifiques**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-225">In Protocol and Ports, select **TCP** and then type the fixed port in **Specific local ports**.</span></span>  
  
5.  <span data-ttu-id="6f85c-226">Dans Action, cliquez sur **Autoriser la connexion** , puis sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-226">In Action, click **Allow the connection** and then click **Next**.</span></span>  
  
6.  <span data-ttu-id="6f85c-227">Dans Profil, désactivez les emplacements réseau qui ne s'appliquent pas, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-227">In Profile, clear any network locations that do not apply and then click **Next**.</span></span>  
  
7.  <span data-ttu-id="6f85c-228">Dans nom, tapez un nom descriptif pour cette règle (par exemple, `SQL Server Analysis Services on port 54321` ), puis cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="6f85c-228">In Name, type a descriptive name for this rule (for example, `SQL Server Analysis Services on port 54321`), and then click **Finish**.</span></span>  
  
8.  <span data-ttu-id="6f85c-229">Pour vérifier que les connexions distantes sont activées, ouvrez SQL Server Management Studio ou Excel sur un autre ordinateur et connectez-vous au Analysis Services en spécifiant le nom réseau du serveur et le numéro de Port au format suivant : \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-229">To verify that remote connections are enabled, open SQL Server Management Studio or Excel on a different computer and connect to the Analysis Services by specifying the network name of the server and the port number in this format: \<servername>:\<portnumber>.</span></span>  
  
#### <a name="netsh-advfirewall-syntax"></a><span data-ttu-id="6f85c-230">Syntaxe Netsh AdvFirewall</span><span class="sxs-lookup"><span data-stu-id="6f85c-230">Netsh AdvFirewall Syntax</span></span>  
  
-   <span data-ttu-id="6f85c-231">Les commandes suivantes créent des règles de trafic entrant qui débloquent le port TCP 2382 pour le service SQL Server Browser et débloquent le port fixe que vous avez spécifié pour l'instance Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-231">The following commands create inbound rules that unblock TCP 2382 for SQL Server Browser service and unblock the fixed port that you specified for the Analysis Services instance.</span></span> <span data-ttu-id="6f85c-232">Vous pouvez exécuter l'une ou l'autre pour permettre l'accès à une instance nommée d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f85c-232">You can run either one to allow access to a named Analysis Services instance.</span></span>  
  
     <span data-ttu-id="6f85c-233">Dans cet exemple de commande, le port fixe est le 54321.</span><span class="sxs-lookup"><span data-stu-id="6f85c-233">In this sample command, port 54321 is the fixed port.</span></span> <span data-ttu-id="6f85c-234">Veillez à le remplacer par le port effectivement utilisé sur votre système.</span><span class="sxs-lookup"><span data-stu-id="6f85c-234">Be sure to replace it with the actual port in use on your system.</span></span>  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Analysis Services (tcp-in) on 54321" dir=in action=allow protocol=TCP localport=54321 profile=domain  
    ```  
  
    ```  
    netsh advfirewall firewall add rule name="SQL Server Browser Services inbound on TCP 2382" dir=in action=allow protocol=TCP localport=2382 profile=domain  
    ```  
  
##  <a name="use-a-fixed-port-for-a-default-or-named-instance-of-analysis-services"></a><a name="bkmk_fixed"></a><span data-ttu-id="6f85c-235">Utilisez un port fixe pour une instance par défaut ou nommée de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-235">Use a fixed port for a default or named instance of Analysis Services</span></span>  
 <span data-ttu-id="6f85c-236">Cette section explique comment configurer le service pour l'écoute d'un port fixe.</span><span class="sxs-lookup"><span data-stu-id="6f85c-236">This section explains how to configure Analysis Services to listen on a fixed port.</span></span> <span data-ttu-id="6f85c-237">L'utilisation d'un port fixe est la plus courante lorsqu'Analysis Services est installé en tant qu'instance nommée, cependant, vous pouvez également utiliser cette approche si les besoins de l'entreprise et les besoins en matière de sécurité nécessitent l'utilisation de ports non affectés par défaut.</span><span class="sxs-lookup"><span data-stu-id="6f85c-237">Using a fixed port is common if you installed Analysis Services as a named instance, but you can also use this approach if business or security requirements specify that you use non-default port assignments.</span></span>  
  
 <span data-ttu-id="6f85c-238">Notez que l'utilisation d'un port fixe modifie la syntaxe de connexion de l'instance par défaut, puisqu'il vous faudra ajouter le numéro de port après le nom du serveur.</span><span class="sxs-lookup"><span data-stu-id="6f85c-238">Note that using a fixed port will alter the connection syntax for the default instance by requiring you to append the port number to the server name.</span></span> <span data-ttu-id="6f85c-239">Par exemple, la connexion à une instance locale par défaut d'Analysis Services écoutant le port 54321 dans SQL Server Management Studio nécessite que vous tapiez localhost:54321 comme nom de serveur dans la boîte de dialogue Se connecter au serveur de Management Studio.</span><span class="sxs-lookup"><span data-stu-id="6f85c-239">For example, connecting to a local, default Analysis Services instance listening on port 54321 in SQL Server Management Studio would require that you type localhost:54321 as the server name in the Connect to Server dialog box in Management Studio.</span></span>  
  
 <span data-ttu-id="6f85c-240">Si vous utilisez une instance nommée, vous pouvez affecter un port fixe sans modifier la façon dont vous spécifiez le nom du serveur (en particulier, vous pouvez utiliser \<servername\instancename> pour vous connecter à une instance nommée à l’écoute sur un port fixe).</span><span class="sxs-lookup"><span data-stu-id="6f85c-240">If you are using a named instance, you can assign a fixed port with no changes to how you specify the server name (specifically, you can use \<servername\instancename> to connect to a named instance listening on a fixed port).</span></span> <span data-ttu-id="6f85c-241">Cela fonctionne uniquement si le service SQL Server Browser est en cours d'exécution et si vous avez débloqué le port que le service écoute.</span><span class="sxs-lookup"><span data-stu-id="6f85c-241">This works only if SQL Server Browser service is running and you unblocked the port on which it is listening.</span></span> <span data-ttu-id="6f85c-242">SQL Server Browser service fournira une redirection vers le port fixe basé sur \<servername\instancename> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-242">SQL Server Browser service will provide redirection to the fixed port based on \<servername\instancename>.</span></span> <span data-ttu-id="6f85c-243">Tant que vous ouvrez des ports à la fois pour le service SQL Server Browser et pour l'instance nommée d'Analysis Services à l'écoute du port fixe, le service SQL Server Browser assure la résolution de la connexion en instance nommée.</span><span class="sxs-lookup"><span data-stu-id="6f85c-243">As long as you open ports for both SQL Server Browser service and the named instance of Analysis Services listening on the fixed port, SQL Server Browser service will resolve the connection to a named instance.</span></span>  
  
1.  <span data-ttu-id="6f85c-244">Identifiez un port TCP/IP disponible à utiliser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-244">Determine an available TCP/IP port to use.</span></span>  
  
     <span data-ttu-id="6f85c-245">Pour afficher la liste des ports réservés et enregistrés que vous ne devez pas utiliser, consultez les [numéros de port (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469)(en anglais).</span><span class="sxs-lookup"><span data-stu-id="6f85c-245">To view a list of reserved and registered ports that you should avoid using, see [Port Numbers (IANA)](https://go.microsoft.com/fwlink/?LinkID=198469).</span></span> <span data-ttu-id="6f85c-246">Pour afficher la liste des ports déjà utilisés par votre système, ouvrez une fenêtre d'invite de commandes et tapez `netstat -a -p TCP` pour afficher la liste des ports TCP ouverts sur le système.</span><span class="sxs-lookup"><span data-stu-id="6f85c-246">To view a list of ports that are already in use on your system, open a command prompt window and type `netstat -a -p TCP` to display a list of the TCP ports that are open on the system.</span></span>  
  
2.  <span data-ttu-id="6f85c-247">Après avoir déterminé quel port utiliser, spécifiez-le en modifiant le paramètre de configuration `Port` dans le fichier msmdsrv.ini ou dans la page Propriétés générales d'une instance d'Analysis Services dans SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="6f85c-247">After you determine which port to use, specify the port by either editing the `Port` configuration setting in the msmdsrv.ini file or in the General properties page of an Analysis Services instance in SQL Server Management Studio.</span></span>  
  
3.  <span data-ttu-id="6f85c-248">Redémarrez le service.</span><span class="sxs-lookup"><span data-stu-id="6f85c-248">Restart the service.</span></span>  
  
4.  <span data-ttu-id="6f85c-249">Configurez le Pare-feu Windows pour débloquer le port TCP spécifié.</span><span class="sxs-lookup"><span data-stu-id="6f85c-249">Configure Windows Firewall to unblock the TCP port you specified.</span></span> <span data-ttu-id="6f85c-250">Si vous utilisez un port fixe pour une instance nommée, débloquez le port TCP spécifié pour cette instance et le port TCP 2382 pour le service SQL Server Browser.</span><span class="sxs-lookup"><span data-stu-id="6f85c-250">Or, if you are using a fixed port for a named instance, unblock both the TCP port you specified for that instance and TCP port 2382 for SQL Server Browser service.</span></span>  
  
5.  <span data-ttu-id="6f85c-251">Vérifiez en vous connectant localement (dans Management Studio), puis à distance à partir d'une application cliente sur un autre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6f85c-251">Verify by connecting locally (in Management Studio) and then remotely from a client application on another computer.</span></span> <span data-ttu-id="6f85c-252">Pour utiliser Management Studio, connectez-vous à une instance Analysis Services par défaut en spécifiant un nom de serveur au format suivant : \<servername> : \<portnumber> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-252">To use Management Studio, connect to an Analysis Services default instance by specifying a server name in this format: \<servername>:\<portnumber>.</span></span> <span data-ttu-id="6f85c-253">Pour une instance nommée, spécifiez le nom du serveur comme \<servername> \\<InstanceName \> .</span><span class="sxs-lookup"><span data-stu-id="6f85c-253">For a named instance, specify the server name as \<servername>\\<instancename\>.</span></span>  
  
##  <a name="port-configuration-for-an-analysis-services-cluster"></a><a name="bkmk_cluster"></a><span data-ttu-id="6f85c-254">Configuration de port pour un cluster Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f85c-254">Port configuration for an Analysis Services cluster</span></span>  
 <span data-ttu-id="6f85c-255">Un cluster de basculement [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] écoute toujours sur le port TCP 2383, que vous l'ayez installé comme instance par défaut ou comme instance nommée.</span><span class="sxs-lookup"><span data-stu-id="6f85c-255">An [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] failover cluster always listens on TCP port 2383, regardless of whether you installed it as a default instance or named instance.</span></span> <span data-ttu-id="6f85c-256">Les affectations de ports dynamiques ne sont pas utilisées par [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] lorsqu'il est installé sur un cluster de basculement Windows.</span><span class="sxs-lookup"><span data-stu-id="6f85c-256">Dynamic port assignments are not used by [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] when it is installed on a Windows failover cluster.</span></span> <span data-ttu-id="6f85c-257">Veillez à ouvrir le port TCP 2383 sur chaque nœud en exécutant [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] dans le cluster.</span><span class="sxs-lookup"><span data-stu-id="6f85c-257">Be sure to open TCP 2383 on every node running [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] in the cluster.</span></span> <span data-ttu-id="6f85c-258">Pour plus d'informations sur le clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], consultez [Procédure : mettre en cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span><span class="sxs-lookup"><span data-stu-id="6f85c-258">For more information about clustering [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], see [How to Cluster SQL Server Analysis Services](https://go.microsoft.com/fwlink/p/?LinkId=396548).</span></span>  
  
##  <a name="port-configuration-for-powerpivot-for-sharepoint"></a><a name="bkmk_powerpivot"></a><span data-ttu-id="6f85c-259">Configuration de port pour PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="6f85c-259">Port configuration for PowerPivot for SharePoint</span></span>  
 <span data-ttu-id="6f85c-260">L'architecture du serveur pour [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] est fondamentalement différente selon la version de SharePoint que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="6f85c-260">Server architecture for [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] is fundamentally different depending on which version of SharePoint you are using.</span></span>  
  
 <span data-ttu-id="6f85c-261">**SharePoint 2013**</span><span class="sxs-lookup"><span data-stu-id="6f85c-261">**SharePoint 2013**</span></span>  
  
 <span data-ttu-id="6f85c-262">Dans SharePoint 2013, Excel Services redirige les demandes de modèles de données Power Pivot, qui sont ensuite chargés sur une instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] hors de l'environnement SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6f85c-262">In SharePoint 2013, Excel Services redirects requests for Power Pivot data models, which are subsequently loaded on an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance outside of the SharePoint environment.</span></span> <span data-ttu-id="6f85c-263">Les connexions suivent le modèle par défaut, où une bibliothèque cliente Analysis Services sur un ordinateur local envoie une demande de connexion à une instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] distante dans le même réseau.</span><span class="sxs-lookup"><span data-stu-id="6f85c-263">Connections follow the typical pattern, where an Analysis Services client library on a local computer sends a connection request to a remote [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance in the same network.</span></span>  
  
 <span data-ttu-id="6f85c-264">Étant donné que [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installe toujours [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en tant qu'instance nommée, vous devez supposer le service SQL Server Browser et les affectations de ports dynamiques.</span><span class="sxs-lookup"><span data-stu-id="6f85c-264">Because [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] always installs [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] as a named instance, you should assume SQL Server Browser service and dynamic port assignments.</span></span> <span data-ttu-id="6f85c-265">Comme indiqué précédemment, le service SQL Server Browser écoute le port TCP 2382 à la recherche des demandes de connexion envoyées aux instances nommées [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , qui redirigent la demande au port actuel.</span><span class="sxs-lookup"><span data-stu-id="6f85c-265">As noted earlier, SQL Server Browser service listens on TCP port 2382 for connection requests sent to [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] named instances, redirecting the request to the current port.</span></span>  
  
 <span data-ttu-id="6f85c-266">Notez qu'Excel Services dans SharePoint 2013 ne prend pas en charge la syntaxe de connexion de port fixe ; par conséquent, veillez à ce que le service SQL Server Browser soit accessible.</span><span class="sxs-lookup"><span data-stu-id="6f85c-266">Note that Excel Services in SharePoint 2013 does not support the fixed port connection syntax, so make sure SQL Server Browser service is accessible.</span></span>  
  
 <span data-ttu-id="6f85c-267">**SharePoint 2010**</span><span class="sxs-lookup"><span data-stu-id="6f85c-267">**SharePoint 2010**</span></span>  
  
 <span data-ttu-id="6f85c-268">Si vous utilisez SharePoint 2010, il n'est pas nécessaire que vous ouvriez des ports dans le Pare-feu Windows.</span><span class="sxs-lookup"><span data-stu-id="6f85c-268">If you are using SharePoint 2010, you do not need to open ports in Windows Firewall.</span></span> <span data-ttu-id="6f85c-269">SharePoint ouvre les ports nécessaires, et les compléments, tels que PowerPivot pour SharePoint, fonctionnent dans l'environnement SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6f85c-269">SharePoint opens the ports that it requires, and add-ins such as PowerPivot for SharePoint operate within the SharePoint environment.</span></span> <span data-ttu-id="6f85c-270">Dans une installation PowerPivot pour SharePoint 2010, le service système PowerPivot a l'usage exclusif de l'instance du service SQL Server Analysis Services (PowerPivot) local, qui est installée avec elle sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6f85c-270">In a PowerPivot for SharePoint 2010 installation, the PowerPivot System Service has exclusive use of the local SQL Server Analysis Services (PowerPivot) service instance that is installed with it on the same computer.</span></span> <span data-ttu-id="6f85c-271">Il utilise des connexions locales, et non réseau, pour accéder au service du moteur Analysis Services qui charge, interroge et traite les données PowerPivot sur le serveur SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6f85c-271">It uses local connections, not network connections, to access the local Analysis Services engine service that loads, queries, and processes PowerPivot data on the SharePoint server.</span></span> <span data-ttu-id="6f85c-272">Pour demander des données PowerPivot à partir d’applications clientes, les demandes sont routées via les ports ouverts par le programme d’installation de SharePoint (en particulier, les règles de trafic entrant sont définies pour autoriser l’accès à SharePoint-80, à l’administration centrale de SharePoint V4, aux services Web SharePoint et à SPUserCodeV4).</span><span class="sxs-lookup"><span data-stu-id="6f85c-272">To request PowerPivot data from client applications, requests are routed through ports that are opened by SharePoint Setup (specifically, inbound rules are defined to allow access to SharePoint - 80, SharePoint Central Administration v4, SharePoint Web Services, and SPUserCodeV4).</span></span> <span data-ttu-id="6f85c-273">Étant donné que les services Web PowerPivot fonctionnent dans une batterie de serveurs SharePoint, les règles de pare-feu SharePoint suffisent pour l'accès à distance aux données PowerPivot d'une batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="6f85c-273">Because PowerPivot web services run within a SharePoint farm, the SharePoint firewall rules are sufficient for remote access to PowerPivot data in a SharePoint farm.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6f85c-274">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6f85c-274">See Also</span></span>  
 <span data-ttu-id="6f85c-275">[SQL Server Browser &#40;service Moteur de base de données et SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span><span class="sxs-lookup"><span data-stu-id="6f85c-275">[SQL Server Browser Service &#40;Database Engine and SSAS&#41;](../../database-engine/configure-windows/sql-server-browser-service-database-engine-and-ssas.md) </span></span>  
 <span data-ttu-id="6f85c-276">[Démarrer, arrêter, suspendre, reprendre, redémarrer le moteur de base de données, SQL Server Agent ou le service SQL Server Browser](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span><span class="sxs-lookup"><span data-stu-id="6f85c-276">[Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md) </span></span>  
 [<span data-ttu-id="6f85c-277">Configurer un pare-feu Windows pour accéder au moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="6f85c-277">Configure a Windows Firewall for Database Engine Access</span></span>](../../database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access.md)  
  
  
