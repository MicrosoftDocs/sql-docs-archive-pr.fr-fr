---
title: Configurer les informations d’identification stockées pour l’actualisation des données PowerPivot (PowerPivot pour SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a1350c5d776891397401e9d3127b7849281b106
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602487"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="ffc70-102">Configurer les informations d'identification stockées pour l'actualisation des données PowerPivot (PowerPivot pour SharePoint)</span><span class="sxs-lookup"><span data-stu-id="ffc70-102">Configure Stored Credentials for PowerPivot Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="ffc70-103">Les travaux d'actualisation des données PowerPivot peuvent s'exécuter sous n'importe quel compte d'utilisateur Windows, du moment que vous créez une application cible dans le service Banque d'informations sécurisé pour stocker les informations d'identification que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="ffc70-103">PowerPivot data refresh jobs can run under any Windows user account as long as you create a target application in Secure Store Service to store the credentials you want to use.</span></span> <span data-ttu-id="ffc70-104">De la même façon, si vous souhaitez fournir une connexion à une base de données qui varie de celle utilisée à l'origine pour importer les données dans PowerPivot pour Excel, vous pouvez mapper ces informations d'identification à une application cible de service Banque d'informations sécurisé, puis spécifier cette application cible dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-104">Similarly, if you want to provide a database login that varies from the one used to originally import the data in PowerPivot for Excel, you can map those credentials to a Secure Store Service target application, and then specify that target application in a data refresh schedule.</span></span>  
  
 <span data-ttu-id="ffc70-105">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="ffc70-105">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="ffc70-106">Après avoir suivi les instructions de cette rubrique, vous serez en mesure d'utiliser l'option d'informations d'identification suivante dans la page de planification de l'actualisation des données PowerPivot :</span><span class="sxs-lookup"><span data-stu-id="ffc70-106">After you follow the instructions in this topic, you will be able to use the following credentials option in the PowerPivot data refresh schedule page:</span></span>  
  
 <span data-ttu-id="ffc70-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span><span class="sxs-lookup"><span data-stu-id="ffc70-107">![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")</span></span>  
  
 <span data-ttu-id="ffc70-108">Cette rubrique explique comment configurer les noms d'utilisateur et les mots de passe servant à actualiser les données PowerPivot dans une batterie de serveurs SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="ffc70-108">This topic explains how to set up the user names and passwords that are used for PowerPivot data refresh in a SharePoint 2010 farm.</span></span> <span data-ttu-id="ffc70-109">Pour exécuter ces étapes, le service Banque d'informations sécurisé doit avoir été activé et une clé principale générée.</span><span class="sxs-lookup"><span data-stu-id="ffc70-109">Before you can use these steps, you must have enabled Secure Store Service and generated a master key.</span></span> <span data-ttu-id="ffc70-110">Pour plus d’informations, consultez [actualisation des données PowerPivot avec SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span><span class="sxs-lookup"><span data-stu-id="ffc70-110">For more information, see [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)</span></span>  
  
 <span data-ttu-id="ffc70-111">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="ffc70-111">This topic contains the following sections:</span></span>  
  
 [<span data-ttu-id="ffc70-112">Configurer un compte Windows pour l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="ffc70-112">Configure any Windows account for data refresh</span></span>](#configAny)  
  
 [<span data-ttu-id="ffc70-113">Configurer un compte prédéfini pour l'accès aux sources de données externes ou tierces</span><span class="sxs-lookup"><span data-stu-id="ffc70-113">Configure a predefined account for accessing external or third-party data sources</span></span>](#config3rd)  
  
 <span data-ttu-id="ffc70-114">Si vous rencontrez des problèmes lors de la configuration ou de l’utilisation de l’actualisation des données, consultez la page [résolution des problèmes d’actualisation des données PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) sur le wiki TechNet pour les solutions possibles.</span><span class="sxs-lookup"><span data-stu-id="ffc70-114">If you have problems configuring or using data refresh, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>  
  
##  <a name="configure-any-windows-account-for-data-refresh"></a><a name="configAny"></a><span data-ttu-id="ffc70-115">Configurer un compte Windows pour l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="ffc70-115">Configure any Windows account for data refresh</span></span>  
 <span data-ttu-id="ffc70-116">Lorsqu'un utilisateur SharePoint définit une planification d'actualisation des données, il doit spécifier l'identité de l'utilisateur sous laquelle l'actualisation des données est effectuée.</span><span class="sxs-lookup"><span data-stu-id="ffc70-116">When a SharePoint user defines a data refresh schedule, he or she must specify the user identity under which data refresh is performed.</span></span> <span data-ttu-id="ffc70-117">Les options incluent la sélection du compte d'actualisation des données PowerPivot sans assistance, l'entrée de son compte d'utilisateur de domaine Windows ou la saisie d'un autre compte d'utilisateur Windows valide pour l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-117">Options include selecting the PowerPivot unattended data refresh account, entering his or her Windows domain user account, or entering some other Windows user account that is valid for data refresh purposes.</span></span> <span data-ttu-id="ffc70-118">Les étapes de cette section concernent la dernière option : la spécification d'un autre compte Windows.</span><span class="sxs-lookup"><span data-stu-id="ffc70-118">The steps in this section are for the last option: specifying some other Windows account.</span></span>  
  
 <span data-ttu-id="ffc70-119">Vous pouvez choisir cette approche si vous souhaitez une alternative à l'utilisation du compte d'actualisation des données PowerPivot sans assistance (disponible pour tous les utilisateurs PowerPivot sur SharePoint) ou des informations d'identification du propriétaire du classeur.</span><span class="sxs-lookup"><span data-stu-id="ffc70-119">You might choose this approach if you want an alternative to using the PowerPivot unattended data refresh account (available to all PowerPivot users on SharePoint) or the credentials of the workbook owner.</span></span> <span data-ttu-id="ffc70-120">Par exemple, vous pouvez mettre une série de comptes d'actualisation des données à disposition de différents groupes de travail pour vous aider à suivre et à gérer l'activité d'actualisation des données au niveau de l'organisation.</span><span class="sxs-lookup"><span data-stu-id="ffc70-120">For example, you might want to make a series of data refresh accounts available to different workgroups to help you track and manage data refresh activity at the organizational level.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="ffc70-121">Les personnes et les applications qui utilisent cette application cible (et les informations d'identification qu'elle stocke) doivent être répertoriées comme membres de l'application.</span><span class="sxs-lookup"><span data-stu-id="ffc70-121">People and applications that use this target application (and the credentials that it stores) must be listed as members of the application.</span></span> <span data-ttu-id="ffc70-122">Vous devez ajouter l'identité de chaque application de service PowerPivot qui utilisera l'application cible, votre compte Windows et les comptes de groupes ou d'utilisateurs des personnes qui spécifieront cette application cible dans leurs planifications d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-122">You must add the identity of each PowerPivot service application that will use the target application, your Windows account, and the group or user accounts of people who will be specifying this target application in their data refresh schedules.</span></span> <span data-ttu-id="ffc70-123">Vous pouvez spécifier tous ces comptes lorsque vous créez l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-123">You can specify all of these accounts when you create the target application.</span></span> <span data-ttu-id="ffc70-124">Si vous ne connaissez pas tous les comptes de groupes et d'utilisateurs qui auront besoin de l'accès à cette application, vous pouvez les ajouter ultérieurement une fois l'application cible créée.</span><span class="sxs-lookup"><span data-stu-id="ffc70-124">If you do not know all of the user and group accounts that will require access to this application, you can add them later after the target application is created.</span></span>  
  
 <span data-ttu-id="ffc70-125">La configuration des informations d'identification stockées pour l'actualisation des données s'effectue en quatre étapes :</span><span class="sxs-lookup"><span data-stu-id="ffc70-125">There are 4 parts to configuring stored credentials for data refresh:</span></span>  
  
-   <span data-ttu-id="ffc70-126">Créez l'application cible qui stocke les informations d'identification.</span><span class="sxs-lookup"><span data-stu-id="ffc70-126">Create the target application that stores the credentials.</span></span>  
  
-   <span data-ttu-id="ffc70-127">Accordez des autorisations Collaboration au compte.</span><span class="sxs-lookup"><span data-stu-id="ffc70-127">Grant Contribute permissions to the account.</span></span>  
  
-   <span data-ttu-id="ffc70-128">Accordez des autorisations de lecture sur le compte pour accéder aux sources de données externes pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-128">Grant the account read permissions to access external data sources during data refresh.</span></span>  
  
-   <span data-ttu-id="ffc70-129">Vérifiez que l'actualisation des données fonctionne lorsque vous spécifiez cette application cible dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-129">Verify that data refresh works when you specify this target application in a data refresh schedule.</span></span>  
  
### <a name="step-1-create-a-target-application"></a><span data-ttu-id="ffc70-130">Étape 1 : créer une application cible</span><span class="sxs-lookup"><span data-stu-id="ffc70-130">Step 1: Create a target application</span></span>  
  
1.  <span data-ttu-id="ffc70-131">Dans l'Administration centrale, sous Gestion des applications, cliquez sur **Gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-131">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="ffc70-132">Cliquez sur **service Banque d’informations sécurisé**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-132">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="ffc70-133">Dans gérer les applications cibles, cliquez sur **nouveau**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-133">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="ffc70-134">Dans ID d'application cible, tapez une chaîne de texte.</span><span class="sxs-lookup"><span data-stu-id="ffc70-134">In Target application ID, type a text string.</span></span> <span data-ttu-id="ffc70-135">La chaîne doit être unique, mais également facile à mémoriser.</span><span class="sxs-lookup"><span data-stu-id="ffc70-135">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="ffc70-136">Les utilisateurs tapent cette chaîne dans les pages de planification de l'actualisation des données à chaque fois qu'ils veulent utiliser les informations d'identification stockées dans cette application.</span><span class="sxs-lookup"><span data-stu-id="ffc70-136">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="ffc70-137">Dans Nom complet, entrez un nom descriptif.</span><span class="sxs-lookup"><span data-stu-id="ffc70-137">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="ffc70-138">Ce nom est utilisé uniquement à des fins d'affichage.</span><span class="sxs-lookup"><span data-stu-id="ffc70-138">This name is used for display purposes only.</span></span> <span data-ttu-id="ffc70-139">Il n'est pas utilisé pour spécifier l'application cible dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-139">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="ffc70-140">Dans Adresse de messagerie du contact, tapez votre adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="ffc70-140">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="ffc70-141">Dans type d’application cible, sélectionnez **groupe**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-141">In Target Application Type, select **Group**.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="ffc70-142">Le choix d'un type de compte de groupe est nécessaire, car il vous permet de spécifier tous les comptes de service et d'utilisateur qui demandent l'accès aux informations d'identification.</span><span class="sxs-lookup"><span data-stu-id="ffc70-142">Choosing a Group account type is necessary because it allows you to specify all of the user and service accounts requesting access to the credentials.</span></span> <span data-ttu-id="ffc70-143">Pour chaque demande, le service système PowerPivot vérifie si le demandeur est membre de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-143">For each request, PowerPivot System Service verifies whether the requestor is a member of the target application.</span></span>  
  
8.  <span data-ttu-id="ffc70-144">Ignorez l'URL de la page de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-144">Skip Target Application Page URL.</span></span> <span data-ttu-id="ffc70-145">L'actualisation des données PowerPivot ne l'utilise pas.</span><span class="sxs-lookup"><span data-stu-id="ffc70-145">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="ffc70-146">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-146">Click **Next**.</span></span>  
  
10. <span data-ttu-id="ffc70-147">Dans la page **spécifier les champs d’informations d’identification pour votre application cible de banque d’informations sécurisée** , acceptez les valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="ffc70-147">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values.</span></span> <span data-ttu-id="ffc70-148">Les noms et les types de champ doivent être le nom d’utilisateur Windows et le mot de passe Windows.</span><span class="sxs-lookup"><span data-stu-id="ffc70-148">Field names and types should be Windows User Name and Windows Password.</span></span>  
  
11. <span data-ttu-id="ffc70-149">Cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="ffc70-149">Click Next.</span></span>  
  
12. <span data-ttu-id="ffc70-150">Dans Administrateurs d'applications cibles, spécifiez les comptes d'utilisateurs de domaine Windows des utilisateurs SharePoint qui bénéficient d'un accès administrateur aux paramètres des applications cibles (par exemple, la capacité d'ajouter ou de supprimer des comptes dans la liste Membres).</span><span class="sxs-lookup"><span data-stu-id="ffc70-150">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to target application settings (for example, the ability to add or remove accounts from the Members list).</span></span>  
  
13. <span data-ttu-id="ffc70-151">Dans Membres, ajoutez les comptes de groupes et d'utilisateurs suivants :</span><span class="sxs-lookup"><span data-stu-id="ffc70-151">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="ffc70-152">En tant que créateur de l'application, ajoutez votre compte d'utilisateur Windows à la liste Membres.</span><span class="sxs-lookup"><span data-stu-id="ffc70-152">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="ffc70-153">Ajoutez l'identité du pool d'applications de l'application de service PowerPivot afin qu'elle puisse récupérer les informations d'identification lors de la planification de l'exécution de l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-153">Add the application pool identity of the PowerPivot service application so that it can retrieve the credentials when data refresh is scheduled to run.</span></span> <span data-ttu-id="ffc70-154">Pour afficher l’identité du pool d’applications, accédez à **gérer les applications de service**, sélectionnez l’application de service PowerPivot en cliquant sur l’espace vide en regard du nom (cela sélectionne la ligne), puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-154">To view the application pool identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="ffc70-155">Le compte de sécurité qui apparaît dans cette page est le compte à ajouter comme membre de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-155">The security account that appears on this page is the account to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="ffc70-156">Ajoutez les comptes d'utilisateur et de groupe Windows qui seront inclus dans cette application cible dans les planifications d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-156">Add Windows user and group accounts that will be entering this target application in data refresh schedules.</span></span>  
  
14. <span data-ttu-id="ffc70-157">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-157">Click **OK**.</span></span>  
  
15. <span data-ttu-id="ffc70-158">Sélectionnez l’application cible que vous venez de créer, cliquez sur la flèche orientée vers le bas et sélectionnez **définir les informations d’identification.**</span><span class="sxs-lookup"><span data-stu-id="ffc70-158">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="ffc70-159">Dans Propriétaire des informations d'identification, notez que la liste de propriétaires d'informations d'identification est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="ffc70-159">In Credential Owner, notice that the list of credential owners is read-only.</span></span> <span data-ttu-id="ffc70-160">Les comptes propriétaires des informations d'identification sont membres de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-160">The accounts who have ownership over the credentials are the members of the target application.</span></span> <span data-ttu-id="ffc70-161">Pour ajouter ou supprimer un propriétaire d'informations d'identification, vous devez ajouter ou supprimer des comptes dans la liste de membres de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-161">To add or remove a credential owner, you must add or remove accounts from the target application members list.</span></span>  
  
     <span data-ttu-id="ffc70-162">Dans Nom d'utilisateur Windows et Mot de passe Windows, tapez les informations d'identification du compte d'utilisateur Windows qui sera utilisé pour exécuter l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-162">In Windows User Name and Windows Password, type credentials of Windows user account that will be used to run data refresh.</span></span>  
  
17. <span data-ttu-id="ffc70-163">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-163">Click **OK**.</span></span>  
  
###  <a name="step-2-grant-contribute-permissions-to-the-account"></a><a name="bkmk_grant"></a><span data-ttu-id="ffc70-164">Étape 2 : accorder des autorisations collaboration au compte</span><span class="sxs-lookup"><span data-stu-id="ffc70-164">Step 2: Grant Contribute permissions to the account</span></span>  
 <span data-ttu-id="ffc70-165">Avant de pouvoir utiliser les informations d'identification stockées, il faut attribuer au compte des autorisations Collaboration sur tous les classeurs PowerPivot pour lesquels il est utilisé.</span><span class="sxs-lookup"><span data-stu-id="ffc70-165">Before you can use the stored credentials, the account must be assigned Contribute permissions on any PowerPivot workbook for which it is used.</span></span> <span data-ttu-id="ffc70-166">Ce niveau d'autorisation est nécessaire pour ouvrir le classeur d'une bibliothèque, puis l'enregistrer à nouveau dans la bibliothèque une fois les données actualisées.</span><span class="sxs-lookup"><span data-stu-id="ffc70-166">This permission level is necessary to open the workbook from a library and then save it back to the library after the data is refreshed.</span></span>  
  
 <span data-ttu-id="ffc70-167">L'affectation d'autorisations est une procédure effectuée par l'administrateur de collection de sites.</span><span class="sxs-lookup"><span data-stu-id="ffc70-167">Assigning permissions is a step that is performed by the site collection administrator.</span></span> <span data-ttu-id="ffc70-168">Les autorisations SharePoint peuvent être affectées à la collection de sites racine ou à n'importe quel niveau inférieur, notamment aux documents individuels et aux éléments.</span><span class="sxs-lookup"><span data-stu-id="ffc70-168">SharePoint permissions can be assigned at the root site collection or at any level below that, including on individual documents and items.</span></span> <span data-ttu-id="ffc70-169">La manière dont vous définissez les autorisations dépendra du degré de granularité que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="ffc70-169">How you set permissions will vary depending on how granular you need them to be.</span></span> <span data-ttu-id="ffc70-170">Les étapes suivantes vous montrent une méthode d'affectation des autorisations.</span><span class="sxs-lookup"><span data-stu-id="ffc70-170">The following steps show you one approach for granting permissions.</span></span>  
  
1.  <span data-ttu-id="ffc70-171">Sur un site SharePoint, dans actions du site, cliquez sur **autorisations du site**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-171">On a SharePoint site, in Site Actions, click **Site Permissions**.</span></span>  
  
2.  <span data-ttu-id="ffc70-172">Cliquez sur **Accorder des autorisations**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-172">Click **Grant Permissions**.</span></span>  
  
3.  <span data-ttu-id="ffc70-173">Dans Sélectionnez les utilisateurs, tapez le nom du compte d'utilisateur de domaine Windows que vous avez spécifié dans l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-173">In Select users, type the name of the Windows domain user account that you specified in the target application.</span></span>  
  
4.  <span data-ttu-id="ffc70-174">Dans accorder des autorisations, sélectionnez **accorder directement les**autorisations des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ffc70-174">In Grant Permissions, select **Grant users permission directly**.</span></span>  
  
5.  <span data-ttu-id="ffc70-175">Sélectionnez **collaboration**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-175">Select **Contribute**, and then click **OK**.</span></span>  
  
###  <a name="step-3-grant-read-permissions-to-access-external-data-sources-used-in-data-refresh"></a><a name="bkmk_dbread"></a><span data-ttu-id="ffc70-176">Étape 3 : accorder des autorisations de lecture pour accéder aux sources de données externes utilisées dans l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="ffc70-176">Step 3: Grant read permissions to access external data sources used in data refresh</span></span>  
 <span data-ttu-id="ffc70-177">Lors de l'importation de données dans un classeur PowerPivot, les connexions aux données externes sont souvent basées sur des connexions approuvées ou des connexions avec emprunt d'identité qui utilisent l'identité de l'utilisateur actuel pour se connecter à la source de données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-177">When importing data into a PowerPivot workbook, connections to external data are often based on trusted connections or impersonated connections that use the identity of the current user to connect to the data source.</span></span> <span data-ttu-id="ffc70-178">Ces types de connexions fonctionnent uniquement lorsque l'utilisateur actuel a l'autorisation de lire les données importées.</span><span class="sxs-lookup"><span data-stu-id="ffc70-178">These types of connections work only when the current user has permission to read the data that he or she is importing.</span></span>  
  
 <span data-ttu-id="ffc70-179">Dans un scénario d'actualisation de données, la chaîne de connexion utilisée pour importer des données est réutilisée pour actualiser les données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-179">In a data refresh scenario, the same connection string that was used to import data is now reused to refresh the data.</span></span> <span data-ttu-id="ffc70-180">Si la chaîne de connexion suppose qu'il s'agit de l'utilisateur actuel (par exemple, une chaîne qui inclut Integrated_Security=SSPI), le service système PowerPivot passera alors l'identité de l'utilisateur spécifié dans l'application cible en tant qu'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="ffc70-180">If the connection string assumes the current user (for example, a string that includes Integrated_Security=SSPI), then the PowerPivot System Service will pass the user identity specified in the target application as the current user.</span></span> <span data-ttu-id="ffc70-181">Cette connexion réussira uniquement si le compte a des autorisations en lecture sur la source de données externe.</span><span class="sxs-lookup"><span data-stu-id="ffc70-181">This connection will only succeed if the account has read permissions on the external data source.</span></span>  
  
 <span data-ttu-id="ffc70-182">C'est pourquoi vous devez accorder des autorisations de lecture seule au compte sur toutes les sources de données externes utilisées pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-182">For this reason, you must grant the account read-only permissions on all of the external data sources that are used during data refresh.</span></span>  
  
 <span data-ttu-id="ffc70-183">Si vous êtes administrateur des sources de données utilisés dans votre organisation, vous pouvez créer une connexion et affecter les autorisations nécessaires.</span><span class="sxs-lookup"><span data-stu-id="ffc70-183">If you are an administrator of the data sources used in your organization, you can create a login and assign the necessary permissions.</span></span> <span data-ttu-id="ffc70-184">Dans le cas contraire, vous devez contacter les propriétaires des données et fournir les informations sur le compte.</span><span class="sxs-lookup"><span data-stu-id="ffc70-184">Otherwise, you must contact the data owners and provide the account information.</span></span> <span data-ttu-id="ffc70-185">Veillez à spécifier le compte d'utilisateur de domaine Windows mappé à l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-185">Be sure to specify the Windows domain user account that maps to the target application.</span></span> <span data-ttu-id="ffc70-186">Il s’agit du compte que vous avez spécifié dans « étape 1 : créer une application cible » dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="ffc70-186">This is the account you specified in "Step 1: Create a target application" in this topic.</span></span>  
  
###  <a name="step-4-verify-account-availability-in-data-refresh-configuration-pages"></a><a name="bkmk_verify"></a><span data-ttu-id="ffc70-187">Étape 4 : vérifier la disponibilité du compte dans les pages de configuration de l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="ffc70-187">Step 4: Verify account availability in data refresh configuration pages</span></span>  
  
1.  <span data-ttu-id="ffc70-188">Ouvrez une page de configuration de l'actualisation des données pour un classeur publié qui contient des données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ffc70-188">Open a data refresh configuration page for a published workbook that contains PowerPivot data.</span></span> <span data-ttu-id="ffc70-189">Pour obtenir des instructions sur l’ouverture de la page, consultez [planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="ffc70-189">For instructions on how to open the page, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>  
  
2.  <span data-ttu-id="ffc70-190">Vérifiez que l’option **se connecter à l’aide des informations d’identification enregistrées dans service Banque d’informations sécurisé (SSS) pour se connecter à la source de données** est activée dans la page Configuration de l’actualisation des données, puis entrez le nom de l’application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-190">Verify that the **Connect using the credentials saved in Secure Store Service (SSS) to log on to the data source** option is enabled in the data refresh configuration page, and then enter the name of the target application.</span></span>  
  
3.  <span data-ttu-id="ffc70-191">Activez la case à cocher **aussi actualiser dès que possible** , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-191">Select the **Also refresh as soon as possible** checkbox, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="ffc70-192">Dans la bibliothèque qui contient le classeur, sélectionnez le classeur, cliquez sur la flèche vers le bas qui s’affiche à droite, puis sélectionnez **gérer l’actualisation des données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-192">In the library that contains the workbook, select the workbook, click the down arrow that appears to right, and then select **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="ffc70-193">Vous devrez peut-être attendre plusieurs minutes si le travail d'actualisation des données retourne une grande quantité de données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-193">You might need to wait several minutes if the data refresh job is returning a large amount of data.</span></span>  
  
 <span data-ttu-id="ffc70-194">Si une erreur se produit, vous pouvez cliquer sur **configurer la planification** dans la page historique d’actualisation des données pour essayer d’autres informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="ffc70-194">If an error occurs, you can click **Configure schedule** in the data refresh history page to try different credentials.</span></span> <span data-ttu-id="ffc70-195">Vous devrez également peut-être inspecter les informations de connexion à la source de données dans le classeur d'origine pour afficher la chaîne de connexion utilisée pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-195">You might also need to inspect the data source connection information in the original workbook to view the connection string that is used during data refresh.</span></span> <span data-ttu-id="ffc70-196">La chaîne de connexion fournira des informations sur l'emplacement du serveur et la base de données que vous pouvez utiliser pour résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="ffc70-196">The connection string will provide information about the server location and database that you can use to troubleshoot the problem.</span></span>  
  
 <span data-ttu-id="ffc70-197">Pour plus d’informations sur la résolution des problèmes, consultez [résolution des problèmes d’actualisation des données PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) sur le wiki technet.</span><span class="sxs-lookup"><span data-stu-id="ffc70-197">For more information about troubleshooting, see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/p/?LinkID=223279) on the TechNet Wiki.</span></span>  
  
##  <a name="configure-a-predefined-account-for-accessing-external-or-third-party-data-sources"></a><a name="config3rd"></a><span data-ttu-id="ffc70-198">Configurer un compte prédéfini pour l’accès à des sources de données externes ou tierces</span><span class="sxs-lookup"><span data-stu-id="ffc70-198">Configure a predefined account for accessing external or third-party data sources</span></span>  
 <span data-ttu-id="ffc70-199">Les serveurs de base de données utilisent souvent leur propre méthode d'authentification.</span><span class="sxs-lookup"><span data-stu-id="ffc70-199">Database servers often come with their own authentication methods.</span></span> <span data-ttu-id="ffc70-200">Si vous disposez d'un classeur PowerPivot qui nécessite des informations d'identification de base de données pour accéder à une source de données externe au cours de l'actualisation des données, vous pouvez créer un ID d'application cible pour les informations d'identification, puis spécifier l'application cible dans la section Sources de données de la page d'actualisation des données planifiée.</span><span class="sxs-lookup"><span data-stu-id="ffc70-200">If you have a PowerPivot workbook that requires database credentials to access an external data source during data refresh, you can create a target application ID for the credentials, and then specify the target application in the Data Sources section of the schedule data refresh page.</span></span>  
  
 <span data-ttu-id="ffc70-201">Cette étape est nécessaire uniquement si vous souhaitez proposer aux utilisateurs une option de remplacement des informations d'identification de base de données qui sont déjà incorporées dans le classeur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="ffc70-201">This step is only necessary if you want to provide users with an option of overriding the database credentials that are already embedded in the PowerPivot workbook.</span></span>  
  
 <span data-ttu-id="ffc70-202">Cette étape fonctionne seulement si la chaîne de connexion inclut déjà un nom d'utilisateur et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="ffc70-202">This step only works if the connection string already includes a user name and password.</span></span> <span data-ttu-id="ffc70-203">Notez que le fait d'avoir des informations d'identification dans la chaîne de connexion est relativement rare ; votre capacité à utiliser cette option est donc quelque peu limitée.</span><span class="sxs-lookup"><span data-stu-id="ffc70-203">Note that having credentials in the connection string is relatively uncommon, so your ability to make use of this option is somewhat limited.</span></span> <span data-ttu-id="ffc70-204">Dans la plupart des cas, vous aurez seulement un ID d'utilisateur et un mot de passe dans la chaîne de connexion si vous utilisez l'authentification de base de données pour vous connecter à la source de données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-204">In most cases, you will only have a user ID and password in the connection string if you are using database authentication to connect to the data source.</span></span> <span data-ttu-id="ffc70-205">Pour plus d’informations sur la vérification de la chaîne de connexion pour savoir si elle comprend un ID d’utilisateur et un mot de passe, consultez la section « accorder des autorisations pour créer des planifications et accéder aux données externes » dans l' [actualisation des données PowerPivot avec SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span><span class="sxs-lookup"><span data-stu-id="ffc70-205">For more information about how to check the connection string to see if it includes a User ID and password, see the "Grant permissions to create schedules and access external data" section in [PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).</span></span>  
  
1.  <span data-ttu-id="ffc70-206">Dans l'Administration centrale, sous Gestion des applications, cliquez sur **Gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-206">In Central Administration, in Application Management, click **Manage service applications**.</span></span>  
  
2.  <span data-ttu-id="ffc70-207">Cliquez sur **service Banque d’informations sécurisé**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-207">Click **Secure Store Service**.</span></span>  
  
3.  <span data-ttu-id="ffc70-208">Dans gérer les applications cibles, cliquez sur **nouveau**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-208">In Manage Target Applications, click **New**.</span></span>  
  
4.  <span data-ttu-id="ffc70-209">Dans ID d'application cible, tapez une chaîne de texte.</span><span class="sxs-lookup"><span data-stu-id="ffc70-209">In Target application ID, type a text string.</span></span> <span data-ttu-id="ffc70-210">La chaîne doit être unique, mais également facile à mémoriser.</span><span class="sxs-lookup"><span data-stu-id="ffc70-210">The string must be unique, but it should also be easy to remember.</span></span> <span data-ttu-id="ffc70-211">Les utilisateurs tapent cette chaîne dans les pages de planification de l'actualisation des données à chaque fois qu'ils veulent utiliser les informations d'identification stockées dans cette application.</span><span class="sxs-lookup"><span data-stu-id="ffc70-211">Users will type this string in data refresh schedule pages whenever they want to use the credentials that are stored in this application.</span></span>  
  
5.  <span data-ttu-id="ffc70-212">Dans Nom complet, entrez un nom descriptif.</span><span class="sxs-lookup"><span data-stu-id="ffc70-212">In Display Name, enter a descriptive name.</span></span> <span data-ttu-id="ffc70-213">Ce nom est utilisé uniquement à des fins d'affichage.</span><span class="sxs-lookup"><span data-stu-id="ffc70-213">This name is used for display purposes only.</span></span> <span data-ttu-id="ffc70-214">Il n'est pas utilisé pour spécifier l'application cible dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-214">It is not used to specify the target application in a data refresh schedule.</span></span>  
  
6.  <span data-ttu-id="ffc70-215">Dans Adresse de messagerie du contact, tapez votre adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="ffc70-215">In Contact Email, type your e-mail address.</span></span>  
  
7.  <span data-ttu-id="ffc70-216">Dans type d’application cible, sélectionnez **groupe**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-216">In Target Application Type, select **Group**.</span></span>  
  
8.  <span data-ttu-id="ffc70-217">Ignorez l'URL de la page de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-217">Skip Target Application Page URL.</span></span> <span data-ttu-id="ffc70-218">L'actualisation des données PowerPivot ne l'utilise pas.</span><span class="sxs-lookup"><span data-stu-id="ffc70-218">PowerPivot data refresh does not use it.</span></span>  
  
9. <span data-ttu-id="ffc70-219">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-219">Click **Next**.</span></span>  
  
10. <span data-ttu-id="ffc70-220">Dans la page **spécifier les champs d’informations d’identification pour votre application cible de banque d’informations sécurisée** , acceptez les valeurs par défaut uniquement si la source de données utilise l’authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="ffc70-220">In the **Specify the credentials fields for your Secure Store Target application** page, accept the default values only if the data source uses Windows authentication.</span></span> <span data-ttu-id="ffc70-221">Sinon, choisissez les types de champ valides pour votre source de données, puis modifiez les noms de champ afin qu'ils correspondent au type.</span><span class="sxs-lookup"><span data-stu-id="ffc70-221">Otherwise, choose the field types that are valid for your data source, and then edit the field names to match the type.</span></span>  
  
     <span data-ttu-id="ffc70-222">Par exemple, vous pouvez spécifier Nom d'utilisateur SQL Server et Mot de passe de l'utilisateur SQL Server pour les noms de champs, puis choisir Nom d'utilisateur et Mot de passe pour les types de champs.</span><span class="sxs-lookup"><span data-stu-id="ffc70-222">For example, you might specify SQL Server User Name and SQL Server User Password for field names, and then choose User Name and Password for field types.</span></span>  
  
11. <span data-ttu-id="ffc70-223">Cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="ffc70-223">Click Next.</span></span>  
  
12. <span data-ttu-id="ffc70-224">Dans Administrateurs d'applications cibles, spécifiez les comptes d'utilisateurs de domaine Windows des utilisateurs SharePoint qui doivent bénéficier d'un accès administrateur aux paramètres d'application.</span><span class="sxs-lookup"><span data-stu-id="ffc70-224">In Target Application Administrators, specify the Windows domain user accounts of SharePoint users who should have administrative access to the application settings.</span></span>  
  
13. <span data-ttu-id="ffc70-225">Dans Membres, ajoutez les comptes de groupes et d'utilisateurs suivants :</span><span class="sxs-lookup"><span data-stu-id="ffc70-225">In Members, add the following user and group accounts:</span></span>  
  
    1.  <span data-ttu-id="ffc70-226">En tant que créateur de l'application, ajoutez votre compte d'utilisateur Windows à la liste Membres.</span><span class="sxs-lookup"><span data-stu-id="ffc70-226">As the person creating the application, add your Windows user account to the Members list.</span></span>  
  
    2.  <span data-ttu-id="ffc70-227">Ajoutez l'identité du pool d'applications de chaque application de service PowerPivot qui utilisera l'application cible pour accéder à ses informations d'identification stockées.</span><span class="sxs-lookup"><span data-stu-id="ffc70-227">Add the application pool identity of each PowerPivot service application that will be using the target application to access its stored credentials.</span></span> <span data-ttu-id="ffc70-228">Pour afficher l’identité, accédez à **gérer les applications de service**, sélectionnez l’application de service PowerPivot en cliquant sur l’espace vide en regard du nom (cela sélectionne la ligne), puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-228">To view the identity, go to **Manage service applications**, select the PowerPivot service application by clicking the empty space next to the name (this selects the row), and then click **Properties**.</span></span> <span data-ttu-id="ffc70-229">Le compte de sécurité qui apparaît dans cette page est le compte que vous souhaitez ajouter comme membre de l'application cible.</span><span class="sxs-lookup"><span data-stu-id="ffc70-229">The security account that appears on this page is the account that you want to add as a member of the target application.</span></span>  
  
    3.  <span data-ttu-id="ffc70-230">Ajoutez les comptes d'utilisateur et de groupe Windows qui seront inclus dans cette application cible dans la section de sources de données d'une page de planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="ffc70-230">Add Windows user and group accounts that will be entering this target application in the data sources section of a data refresh schedule page.</span></span>  
  
14. <span data-ttu-id="ffc70-231">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-231">Click **OK**.</span></span>  
  
15. <span data-ttu-id="ffc70-232">Sélectionnez l’application cible que vous venez de créer, cliquez sur la flèche orientée vers le bas et sélectionnez **définir les informations d’identification.**</span><span class="sxs-lookup"><span data-stu-id="ffc70-232">Select the target application you just created, click the down arrow and select **Set Credentials.**</span></span>  
  
16. <span data-ttu-id="ffc70-233">Entrez les informations d'identification qui seront utilisées pour se connecter à la source de données (par exemple, le nom d'utilisateur et le mot de passe d'un compte de connexion SQL Server).</span><span class="sxs-lookup"><span data-stu-id="ffc70-233">Enter the credentials that will be used to connect to the data source (for example, the user name and password of a SQL Server login).</span></span>  
  
17. <span data-ttu-id="ffc70-234">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="ffc70-234">Click **OK**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ffc70-235">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ffc70-235">See Also</span></span>  
 <span data-ttu-id="ffc70-236">[Planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="ffc70-236">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="ffc70-237">Actualisation des données PowerPivot avec SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="ffc70-237">PowerPivot Data Refresh with SharePoint 2010</span></span>](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
