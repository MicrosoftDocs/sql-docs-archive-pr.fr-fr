---
title: Actualisation des données PowerPivot avec SharePoint 2013 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 34f03407-2ec4-4554-b16b-bc9a6c161815
author: minewiskan
ms.author: owend
ms.openlocfilehash: c1d65a60c75d695e07edab763c6f879e502bf356
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605781"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2013"></a><span data-ttu-id="742bc-102">Actualisation des données PowerPivot avec SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-102">PowerPivot Data Refresh with SharePoint 2013</span></span>
  <span data-ttu-id="742bc-103">La conception de l’actualisation des [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] modèles de données dans SharePoint 2013 utilise Excel Services en tant que composant principal pour charger et actualiser les modèles de données sur une instance de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] qui s’exécute en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-103">The design for refresh of [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] data models in SharePoint 2013 utilizes Excel Services as the primary component to load and refresh data models on an instance of [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] running in SharePoint mode.</span></span> <span data-ttu-id="742bc-104">Le serveur [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] s'exécute en externe sur la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-104">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server runs external to the SharePoint farm.</span></span>  
  
 <span data-ttu-id="742bc-105">L'architecture d'actualisation des données précédente reposait exclusivement sur le service système PowerPivot pour charger et actualiser les modèles de données sur une instance de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-105">The previous data refresh architecture relied exclusively on the PowerPivot System Service to load and refresh data models on a SharePoint mode [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="742bc-106">L'instance de [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] s'exécutait localement sur le serveur d'applications PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-106">The [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance ran locally on the PowerPivot application server.</span></span> <span data-ttu-id="742bc-107">La nouvelle architecture intègre également une nouvelle méthode de gestion des informations de planification en tant que métadonnées de l'élément de classeur dans la bibliothèque de documents.</span><span class="sxs-lookup"><span data-stu-id="742bc-107">The new architecture also introduces a new method to maintain schedule information as meta data of the workbook item in the document library.</span></span> <span data-ttu-id="742bc-108">L'architecture d'Excel Services dans SharePoint 2013 prend en charge l' **actualisation interactive des données** et l' **actualisation planifiée des données**.</span><span class="sxs-lookup"><span data-stu-id="742bc-108">The architecture in SharePoint 2013 Excel Services supports both **interactive data refresh** and **scheduled data refresh**.</span></span>  
  
 <span data-ttu-id="742bc-109">**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-109">**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013</span></span>  
  
 <span data-ttu-id="742bc-110">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="742bc-110">**In this topic:**</span></span>  
  
-   [<span data-ttu-id="742bc-111">Actualisation interactive des données</span><span class="sxs-lookup"><span data-stu-id="742bc-111">Interactive Data Refresh</span></span>](#bkmk_interactive_refresh)  
  
-   [<span data-ttu-id="742bc-112">Authentification Windows avec les connexions de données de classeur et l’actualisation interactive des données</span><span class="sxs-lookup"><span data-stu-id="742bc-112">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>](#bkmk_windows_auth_interactive_data_refresh)  
  
-   [<span data-ttu-id="742bc-113">Actualisation des données planifiée</span><span class="sxs-lookup"><span data-stu-id="742bc-113">Scheduled Data Refresh</span></span>](#bkmk_scheduled_refresh)  
  
-   [<span data-ttu-id="742bc-114">Architecture de l'actualisation planifiée des données dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-114">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>](#bkmk_refresh_architecture)  
  
-   [<span data-ttu-id="742bc-115">Considérations supplémentaires relatives à l'authentification</span><span class="sxs-lookup"><span data-stu-id="742bc-115">Additional Authentication Considerations</span></span>](#datarefresh_additional_authentication)  
  
-   [<span data-ttu-id="742bc-116">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="742bc-116">More Information</span></span>](#bkmk_moreinformation)  
  
## <a name="background"></a><span data-ttu-id="742bc-117">Arrière-plan</span><span class="sxs-lookup"><span data-stu-id="742bc-117">Background</span></span>  
 <span data-ttu-id="742bc-118">SharePoint Server 2013 Excel Services gère l’actualisation des données pour les classeurs Excel 2013 et déclenche le traitement du modèle de données sur un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] serveur qui s’exécute en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-118">SharePoint Server 2013 Excel Services manages data refresh for Excel 2013 workbooks and triggers the data model processing on a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="742bc-119">Pour les classeurs Excel 2010, Excel Services gère également le chargement et l'enregistrement des classeurs et des modèles de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-119">For Excel 2010 workbooks, Excel Services also manages the loading and saving of workbooks and data models.</span></span> <span data-ttu-id="742bc-120">Toutefois, Excel Services repose sur le service système PowerPivot pour envoyer des commandes de traitement de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-120">However, Excel Services relies on the PowerPivot System Service to send the processing commands to the data model.</span></span> <span data-ttu-id="742bc-121">Le tableau suivant récapitule les composants qui envoient des commandes de traitement pour l'actualisation des données en fonction de la version du classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-121">The following table summarizes the components that send processing commands for data refresh depending on the version of the workbook.</span></span> <span data-ttu-id="742bc-122">L'environnement donné est une batterie de serveurs SharePoint 2013 configurée pour utiliser un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server qui s'exécute en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-122">The assumed environment is a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode.</span></span>  
  
||||  
|-|-|-|  
||<span data-ttu-id="742bc-123">Classeurs Excel 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-123">Excel 2013 Workbooks</span></span>|<span data-ttu-id="742bc-124">Classeurs Excel 2010</span><span class="sxs-lookup"><span data-stu-id="742bc-124">Excel 2010 Workbooks</span></span>|  
|<span data-ttu-id="742bc-125">Déclencher l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="742bc-125">Trigger Data Refresh</span></span>|<span data-ttu-id="742bc-126">**Interactive :** Utilisateur authentifié</span><span class="sxs-lookup"><span data-stu-id="742bc-126">**Interactive:** Authenticated User</span></span><br /><br /> <span data-ttu-id="742bc-127">**Planifiée :** Service système PowerPivot</span><span class="sxs-lookup"><span data-stu-id="742bc-127">**Scheduled:** PowerPivot System Service</span></span>|<span data-ttu-id="742bc-128">Service système PowerPivot</span><span class="sxs-lookup"><span data-stu-id="742bc-128">PowerPivot System Service</span></span>|  
|<span data-ttu-id="742bc-129">Charger le classeur depuis les bases de données de contenu</span><span class="sxs-lookup"><span data-stu-id="742bc-129">Load Workbook from Content Databases</span></span>|<span data-ttu-id="742bc-130">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-130">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="742bc-131">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-131">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="742bc-132">Charger le modèle de données sur l'instance Analysis Services</span><span class="sxs-lookup"><span data-stu-id="742bc-132">Load Data model on Analysis Services instance</span></span>|<span data-ttu-id="742bc-133">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-133">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="742bc-134">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-134">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="742bc-135">Envoyer les commandes de traitement à l'instance Analysis Services</span><span class="sxs-lookup"><span data-stu-id="742bc-135">Send Processing Commands to Analysis Services instance</span></span>|<span data-ttu-id="742bc-136">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-136">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="742bc-137">Service système PowerPivot</span><span class="sxs-lookup"><span data-stu-id="742bc-137">PowerPivot System Service</span></span>|  
|<span data-ttu-id="742bc-138">Mettre à jour les données du classeur</span><span class="sxs-lookup"><span data-stu-id="742bc-138">Update Workbook Data</span></span>|<span data-ttu-id="742bc-139">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-139">SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="742bc-140">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-140">SharePoint 2013 Excel Services</span></span>|  
|<span data-ttu-id="742bc-141">Enregistrer le classeur et le modèle de données dans la base de données de contenu</span><span class="sxs-lookup"><span data-stu-id="742bc-141">Save Workbook and Data model to Content Database</span></span>|<span data-ttu-id="742bc-142">**Interactive :** N/A</span><span class="sxs-lookup"><span data-stu-id="742bc-142">**Interactive:** N/A</span></span><br /><br /> <span data-ttu-id="742bc-143">**Planifiée :** Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-143">**Scheduled:** SharePoint 2013 Excel Services</span></span>|<span data-ttu-id="742bc-144">Excel Services dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-144">SharePoint 2013 Excel Services</span></span>|  
  
 <span data-ttu-id="742bc-145">Le tableau suivant récapitule les fonctionnalités d'actualisation prises en charge dans une batterie de serveurs SharePoint 2013 configurée pour utiliser un [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server s'exécutant en mode SharePoint :</span><span class="sxs-lookup"><span data-stu-id="742bc-145">The following table summarizes the supported refresh features in a SharePoint 2013 farm configured to use a [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Analysis Server running in SharePoint mode:</span></span>  
  
|<span data-ttu-id="742bc-146">Classeur créé dans</span><span class="sxs-lookup"><span data-stu-id="742bc-146">Workbook created in</span></span>|<span data-ttu-id="742bc-147">Actualisation planifiée des données</span><span class="sxs-lookup"><span data-stu-id="742bc-147">Scheduled data refresh</span></span>|<span data-ttu-id="742bc-148">Actualisation interactive</span><span class="sxs-lookup"><span data-stu-id="742bc-148">Interactive refresh</span></span>|  
|-------------------------|----------------------------|-------------------------|  
|<span data-ttu-id="742bc-149">2008 R2 PowerPivot pour Excel</span><span class="sxs-lookup"><span data-stu-id="742bc-149">2008 R2 PowerPivot for Excel</span></span>|<span data-ttu-id="742bc-150">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="742bc-150">Not supported.</span></span> <span data-ttu-id="742bc-151">Mettre à niveau le classeur **( \* )**</span><span class="sxs-lookup"><span data-stu-id="742bc-151">Upgrade the workbook **(\*)**</span></span>|<span data-ttu-id="742bc-152">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="742bc-152">Not supported.</span></span> <span data-ttu-id="742bc-153">Mettre à niveau le classeur **( \* )**</span><span class="sxs-lookup"><span data-stu-id="742bc-153">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="742bc-154">2012 PowerPivot pour Excel</span><span class="sxs-lookup"><span data-stu-id="742bc-154">2012 PowerPivot for Excel</span></span>|<span data-ttu-id="742bc-155">Prise en charge</span><span class="sxs-lookup"><span data-stu-id="742bc-155">Supported</span></span>|<span data-ttu-id="742bc-156">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="742bc-156">Not supported.</span></span> <span data-ttu-id="742bc-157">Mettre à niveau le classeur **( \* )**</span><span class="sxs-lookup"><span data-stu-id="742bc-157">Upgrade the workbook **(\*)**</span></span>|  
|<span data-ttu-id="742bc-158">Excel 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-158">Excel 2013</span></span>|<span data-ttu-id="742bc-159">Prise en charge</span><span class="sxs-lookup"><span data-stu-id="742bc-159">Supported</span></span>|<span data-ttu-id="742bc-160">Prise en charge</span><span class="sxs-lookup"><span data-stu-id="742bc-160">Supported</span></span>|  
  
 <span data-ttu-id="742bc-161">**( \* )** Pour plus d’informations sur les mises à niveau de classeurs, consultez [mettre à niveau les classeurs et l’actualisation planifiée des données &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-161">**(\*)** For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
##  <a name="interactive-data-refresh"></a><a name="bkmk_interactive_refresh"></a> <span data-ttu-id="742bc-162">Interactive Data Refresh</span><span class="sxs-lookup"><span data-stu-id="742bc-162">Interactive Data Refresh</span></span>  
 <span data-ttu-id="742bc-163">L'actualisation des données interactive ou manuelle dans SharePoint Server 2013 Excel Services permet d'actualiser les modèles de données avec les données de la source de données d'origine.</span><span class="sxs-lookup"><span data-stu-id="742bc-163">Interactive, or manual data refresh in SharePoint Server 2013 Excel Services can refresh data models with data from the original data source.</span></span> <span data-ttu-id="742bc-164">L'actualisation interactive des données est disponible après avoir configuré une application Excel Services lorsque vous inscrivez un serveur [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] exécuté en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-164">Interactive data refresh is available after you configure an Excel Services application by registering an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server, running in SharePoint mode.</span></span> <span data-ttu-id="742bc-165">Pour plus d’informations, consultez [Gérer les paramètres de modèle de données Excel Services (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span><span class="sxs-lookup"><span data-stu-id="742bc-165">For more information, see [Manage Excel Services data model settings (SharePoint Server 2013)](https://technet.microsoft.com/library/jj219780.aspx).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="742bc-166">L'actualisation interactive des données est disponible uniquement pour les classeurs créés dans Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="742bc-166">Interactive data refresh is only available for workbooks that created in Excel 2013.</span></span> <span data-ttu-id="742bc-167">Si vous essayez d’actualiser un classeur Excel 2010, Excel Services affiche un message d’erreur semblable à « échec de l’opération PowerPivot : le classeur a été créé dans une version antérieure d’Excel et PowerPivot ne peut pas être actualisé tant que le fichier n’est pas mis à niveau ».</span><span class="sxs-lookup"><span data-stu-id="742bc-167">If you try to refresh an Excel 2010 workbook, Excel Services displays an error message similar to "PowerPivot Operation Failed: The Workbook was created in an older version of Excel and PowerPivot cannot be refreshed until the file is upgraded".</span></span> <span data-ttu-id="742bc-168">Pour plus d’informations sur la mise à niveau des classeurs, consultez [Mettre à niveau les classeurs et l’actualisation planifiée des données &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-168">For more information on upgrading workbooks, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="742bc-169">**Point clé de l'actualisation interactive :**</span><span class="sxs-lookup"><span data-stu-id="742bc-169">**Interactive refresh key point of interest:**</span></span>  
  
-   <span data-ttu-id="742bc-170">L'actualisation interactive des données actualise uniquement les données dans la session de l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="742bc-170">Interactive data refresh only refreshes the data in the current user session.</span></span> <span data-ttu-id="742bc-171">Les données ne sont pas automatiquement enregistrées dans l'élément de classeur dans la base de données de contenu SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-171">The data is not automatically saved back to the workbook item in the SharePoint content database.</span></span>  
  
-   <span data-ttu-id="742bc-172">**Informations d’identification :** L’actualisation interactive des données peut utiliser l’identité de l’utilisateur actuellement connecté en tant qu’informations d’identification, ou informations d’identification stockées, pour la connexion à la source de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-172">**Credentials:** Interactive data refresh can use the identity of the currently logged-on user as credentials or stored credentials to connect to the data source.</span></span> <span data-ttu-id="742bc-173">Les informations d'identification utilisées dépendent des paramètres d'authentification d'Excel Services définis pour la connexion du classeur à la source de données externe.</span><span class="sxs-lookup"><span data-stu-id="742bc-173">The  credentials used depend on the Excel Services Authentication Settings defined for the workbook connection to the external data source.</span></span>  
  
-   <span data-ttu-id="742bc-174">**Classeurs pris en charge :**  classeurs créés dans Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="742bc-174">**Supported Workbooks:**  Workbooks created in Excel 2013.</span></span>  
  
 <span data-ttu-id="742bc-175">**Pour actualiser les données :**</span><span class="sxs-lookup"><span data-stu-id="742bc-175">**To refresh data:**</span></span>  
  
-   <span data-ttu-id="742bc-176">Consultez l'illustration qui suit les étapes.</span><span class="sxs-lookup"><span data-stu-id="742bc-176">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="742bc-177">Dans une bibliothèque de documents SharePoint, ouvrez un classeur PowerPivot dans le navigateur.</span><span class="sxs-lookup"><span data-stu-id="742bc-177">In a SharePoint document library, open a PowerPivot workbook in the browser.</span></span>  
  
2.  <span data-ttu-id="742bc-178">Dans la fenêtre du navigateur, cliquez sur le menu du **Données** puis cliquez sur **Actualiser la connexion sélectionnée** ou sur **Actualiser toutes les connexions**.</span><span class="sxs-lookup"><span data-stu-id="742bc-178">In the browser window, click the **Data** menu and then click **Refresh Selected Connection** or **Refresh All Connections**.</span></span>  
  
3.  <span data-ttu-id="742bc-179">Excel Services charge la base de données PowerPivot, la traite et lui demande d'actualiser le cache du classeur Excel.</span><span class="sxs-lookup"><span data-stu-id="742bc-179">Excel Services loads the PowerPivot database, processes it and then queries it to refresh the Excel workbook cache.</span></span>  
  
4.  <span data-ttu-id="742bc-180">**Remarque :** le classeur mis à jour n'est pas automatiquement enregistré dans la bibliothèque de documents.</span><span class="sxs-lookup"><span data-stu-id="742bc-180">**Note:** The updated workbook is not automatically saved back to the document library.</span></span>  
  
 <span data-ttu-id="742bc-181">![actualisation interactive des données](../media/as-interactive-datarefresh-sharepoint2013.gif "actualisation interactive des données")</span><span class="sxs-lookup"><span data-stu-id="742bc-181">![interactive data refresh](../media/as-interactive-datarefresh-sharepoint2013.gif "interactive data refresh")</span></span>  
  
###  <a name="windows-authentication-with-workbook-data-connections-and-interactive-data-refresh"></a><a name="bkmk_windows_auth_interactive_data_refresh"></a> <span data-ttu-id="742bc-182">Authentification Windows pour les connexions de données du classeur et l'actualisation interactive des données</span><span class="sxs-lookup"><span data-stu-id="742bc-182">Windows Authentication with Workbook Data Connections and Interactive Data Refresh</span></span>  
 <span data-ttu-id="742bc-183">Excel Services envoie au serveur Analysis Services une commande de traitement qui indique au serveur d'emprunter l'identité d'un compte d'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="742bc-183">Excel Services sends the Analysis Services server a process command that instructs the server to impersonate a user account.</span></span> <span data-ttu-id="742bc-184">Pour obtenir des droits d’administrateur système suffisants pour exécuter le processus de délégation-emprunt d’identité d’utilisateur, le compte de service Analysis Services doit disposer du privilège **Agir en tant que partie du système d’exploitation** sur le serveur local.</span><span class="sxs-lookup"><span data-stu-id="742bc-184">To obtain system rights sufficient to perform the user impersonation-delegation process, the Analysis Services service account, requires **Act as part of the operating system** privilege on the local server.</span></span> <span data-ttu-id="742bc-185">Le serveur Analysis Services doit également pouvoir déléguer les informations d'identification de l'utilisateur aux sources de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-185">The Analysis Services server also needs to be able to delegate the user's credentials to data sources.</span></span> <span data-ttu-id="742bc-186">Le résultat de la requête est envoyé à Excel Services.</span><span class="sxs-lookup"><span data-stu-id="742bc-186">The query result is sent to Excel Services.</span></span>  
  
 <span data-ttu-id="742bc-187">Expérience utilisateur typique : lorsqu’un client sélectionne « actualiser toutes les connexions » dans un classeur Excel 2013 qui contient un modèle PowerPivot, il voit un message d’erreur semblable à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="742bc-187">Typical user experience: When a customer selects "Refresh All Connections" in an Excel 2013 workbook that contains a PowerPivot model, they see an error message similar to the following:</span></span>  
  
-   <span data-ttu-id="742bc-188">**Échec de l’actualisation des données externes :** une erreur s’est produite lors de l’utilisation du modèle de données dans le classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-188">**External Data Refresh Failed:** An error occurred while working on the Data Model in the workbook.</span></span> <span data-ttu-id="742bc-189">Réessayez.</span><span class="sxs-lookup"><span data-stu-id="742bc-189">Please try again.</span></span> <span data-ttu-id="742bc-190">Nous n’avons pas pu actualiser une ou plusieurs connexions de données dans ce classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-190">We are unable to refresh one or more data connections in this workbook.</span></span>  
  
 <span data-ttu-id="742bc-191">Selon le fournisseur de données que vous utilisez, vous pouvez voir des messages semblables aux suivants dans le journal ULS.</span><span class="sxs-lookup"><span data-stu-id="742bc-191">Depending on the data provider you are using, you see messages similar to the following in the ULS log.</span></span>  
  
 <span data-ttu-id="742bc-192">**Avec SQL Native Client :**</span><span class="sxs-lookup"><span data-stu-id="742bc-192">**With the SQL Native Client:**</span></span>  
  
-   <span data-ttu-id="742bc-193">Nous n’avons pas pu créer de connexion externe ou exécuter la requête.</span><span class="sxs-lookup"><span data-stu-id="742bc-193">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="742bc-194">Message du fournisseur : L'objet hors ligne « DataSource », qui fait référence aux ID « 20102481-39c8-4d21-bf63-68f583ad22bb », a été spécifié mais n'a pas été utilisé.</span><span class="sxs-lookup"><span data-stu-id="742bc-194">Provider message: Out of line object 'DataSource', referring to ID(s) '20102481-39c8-4d21-bf63-68f583ad22bb', has been specified but has not been used.</span></span>  <span data-ttu-id="742bc-195">Erreur OLE DB ou ODBC : Une erreur liée au réseau ou spécifique à l'instance s'est produite lors de l'établissement d'une connexion à SQL Server.</span><span class="sxs-lookup"><span data-stu-id="742bc-195">OLE DB or ODBC error: A network-related or instance-specific error has occurred while establishing a connection to SQL Server.</span></span> <span data-ttu-id="742bc-196">Le serveur est introuvable ou n'est pas accessible.</span><span class="sxs-lookup"><span data-stu-id="742bc-196">Server is not found or not accessible.</span></span> <span data-ttu-id="742bc-197">Vérifiez si le nom de l'instance est correct et si SQL Server est configuré pour autoriser les connexions distantes.</span><span class="sxs-lookup"><span data-stu-id="742bc-197">Check if instance name is correct and if SQL Server is configured to allow remote connections.</span></span> <span data-ttu-id="742bc-198">Pour plus d'informations, consultez la documentation en ligne de SQL Server. 08001 ; Fournisseur SSL : Le package de sécurité requis n'existe pas ; 08001 ; Le client ne peut pas établir de connexion ; 08001 ; Chiffrement non pris en charge sur le client ; 08001 ;</span><span class="sxs-lookup"><span data-stu-id="742bc-198">For more information see SQL Server Books Online.; 08001; SSL Provider: The requested security package does not exist ; 08001; Client unable to establish connection; 08001; Encryption not supported on the client.; 08001.</span></span>  <span data-ttu-id="742bc-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span><span class="sxs-lookup"><span data-stu-id="742bc-199">, ConnectionName: ThisWorkbookDataModel, Workbook: book1.xlsx.</span></span>  
  
 <span data-ttu-id="742bc-200">**Avec le Fournisseur Microsoft OLE DB pour SQL Server :**</span><span class="sxs-lookup"><span data-stu-id="742bc-200">**With the Microsoft OLE DB Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="742bc-201">Nous n’avons pas pu créer de connexion externe ou exécuter la requête.</span><span class="sxs-lookup"><span data-stu-id="742bc-201">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="742bc-202">Message du fournisseur : L'objet hors ligne 'DataSource', qui fait référence aux ID '6e711bfa-b62f-4879-a177-c5dd61d9c242', a été spécifié mais n'a pas été utilisé.</span><span class="sxs-lookup"><span data-stu-id="742bc-202">Provider message: Out of line object 'DataSource', referring to ID(s) '6e711bfa-b62f-4879-a177-c5dd61d9c242', has been specified but has not been used.</span></span> <span data-ttu-id="742bc-203">Erreur OLE DB ou ODBC.</span><span class="sxs-lookup"><span data-stu-id="742bc-203">OLE DB or ODBC error.</span></span> <span data-ttu-id="742bc-204">, ConnectionName : ThisWorkbookDataModel, Classeur : OLEDB Provider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="742bc-204">, ConnectionName: ThisWorkbookDataModel, Workbook: OLEDB Provider.xlsx.</span></span>  
  
 <span data-ttu-id="742bc-205">**Avec le Fournisseur de données .NET Framework pour SQL Server :**</span><span class="sxs-lookup"><span data-stu-id="742bc-205">**With the .NET Framework Data Provider for SQL Server:**</span></span>  
  
-   <span data-ttu-id="742bc-206">Nous n’avons pas pu créer de connexion externe ou exécuter la requête.</span><span class="sxs-lookup"><span data-stu-id="742bc-206">Failed to create an external connection or execute a query.</span></span> <span data-ttu-id="742bc-207">Message du fournisseur : L'objet hors ligne 'DataSource', qui fait référence aux ID 'f5fb916c-3eac-4d07-a542-531524c0d44a', a été spécifié mais n'a pas été utilisé.</span><span class="sxs-lookup"><span data-stu-id="742bc-207">Provider message: Out of line object 'DataSource', referring to ID(s) 'f5fb916c-3eac-4d07-a542-531524c0d44a', has been specified but has not been used.</span></span>  <span data-ttu-id="742bc-208">Erreurs dans le moteur relationnel de haut niveau.</span><span class="sxs-lookup"><span data-stu-id="742bc-208">Errors in the high-level relational engine.</span></span> <span data-ttu-id="742bc-209">L'exception suivante s'est produite lors de l'utilisation de l'interface IDbConnection : Impossible de charger le fichier ou l'assembly « System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 » ou l'une de ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="742bc-209">The following exception occurred while the managed IDbConnection interface was being used: Could not load file or assembly 'System.Transactions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="742bc-210">Soit un niveau d'emprunt d'identité requis n'a pas été fourni, soit le niveau d'emprunt d'identité fourni n'est pas valide.</span><span class="sxs-lookup"><span data-stu-id="742bc-210">Either a required impersonation level was not provided, or the provided impersonation level is invalid.</span></span> <span data-ttu-id="742bc-211">(Exception de HRESULT : 0x80070542).</span><span class="sxs-lookup"><span data-stu-id="742bc-211">(Exception from HRESULT: 0x80070542).</span></span>  <span data-ttu-id="742bc-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span><span class="sxs-lookup"><span data-stu-id="742bc-212">, ConnectionName: ThisWorkbookDataModel, Workbook: NETProvider.xlsx.</span></span>  
  
 <span data-ttu-id="742bc-213">**Résumé des étapes de configuration** Pour configurer le privilège **Agir en tant que partie du système d’exploitation** sur le serveur local :</span><span class="sxs-lookup"><span data-stu-id="742bc-213">**Summary of Configuration Steps** To configure **Act as part of the operating system** privilege on the local server:</span></span>  
  
1.  <span data-ttu-id="742bc-214">Sur le serveur Analysis Services s’exécutant en mode SharePoint, ajoutez le compte de service Analysis Services au privilège «**agir en tant que partie du système d’exploitation**» :</span><span class="sxs-lookup"><span data-stu-id="742bc-214">On the Analysis Services Server running in SharePoint mode, Add the Analysis Services service account to the "**Act as part of the operating system**" privilege:</span></span>  
  
    1.  <span data-ttu-id="742bc-215">Exécuter « `secpol.msc` »</span><span class="sxs-lookup"><span data-stu-id="742bc-215">Run "`secpol.msc`"</span></span>  
  
    2.  <span data-ttu-id="742bc-216">Cliquez sur **Stratégie de sécurité locale**, puis sur **Stratégies locales**, et sur **Attribution des droits utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="742bc-216">Click **Local Security Policy**, then click **Local policies**, and then click **User rights assignment**.</span></span>  
  
    3.  <span data-ttu-id="742bc-217">Ajoutez le compte de service.</span><span class="sxs-lookup"><span data-stu-id="742bc-217">Add the service account.</span></span>  
  
2.  <span data-ttu-id="742bc-218">Redémarrez Excel Services et redémarrez le serveur Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="742bc-218">Restart Excel Services and reboot the Analysis Services server.</span></span>  
  
3.  <span data-ttu-id="742bc-219">La délégation du compte de service Excel Services ou du service d'émission de jetons Revendications vers Windows (C2WTS) à l'instance Analysis Services n'est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="742bc-219">Delegation from the Excel Services service account or from Claims to Windows token service (C2WTS) to the Analysis services instance is not required.</span></span> <span data-ttu-id="742bc-220">Par conséquent, aucune configuration pour KCD depuis Excel Services ou C2WTS vers le service Analysis Services PowerPivot n'est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="742bc-220">Therefore no configuration for KCD from Excel Services or C2WTS to PowerPivot AS service is necessary.</span></span> <span data-ttu-id="742bc-221">Si la source de données principale se trouve sur le même serveur que l'instance [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , la délégation contrainte Kerberos n'est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="742bc-221">If the backend data source is on the same server as the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] instance, Kerberos Constrained Delegation is not required.</span></span> <span data-ttu-id="742bc-222">Toutefois, le compte de service [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] doit posséder le droit Agir en tant que partie du système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="742bc-222">However, the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] service account requires the right to Act As Part Of The Operating System.</span></span>  
  
 <span data-ttu-id="742bc-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span><span class="sxs-lookup"><span data-stu-id="742bc-223">![as_interactive_data_refresh2012SP1_windowsauth](../media/as-interactive-data-refresh2012sp1-windowsauth.gif "as_interactive_data_refresh2012SP1_windowsauth")</span></span>  
  
 <span data-ttu-id="742bc-224">Pour plus d’informations, consultez [agir en tant que partie du système d’exploitation](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span><span class="sxs-lookup"><span data-stu-id="742bc-224">For more information, see [Act as part of the operating system](https://technet.microsoft.com/library/cc784323\(WS.10\).aspx).</span></span>  
  
##  <a name="scheduled-data-refresh"></a><a name="bkmk_scheduled_refresh"></a><span data-ttu-id="742bc-225">Actualisation des données planifiée</span><span class="sxs-lookup"><span data-stu-id="742bc-225">Scheduled Data Refresh</span></span>  
 <span data-ttu-id="742bc-226">**Points clés de l'actualisation planifiée des données :**</span><span class="sxs-lookup"><span data-stu-id="742bc-226">**Scheduled data refresh key points of interest:**</span></span>  
  
-   <span data-ttu-id="742bc-227">Nécessite le déploiement du complément PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-227">Requires the deployment of the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="742bc-228">Pour plus d’informations, consultez [installer ou désinstaller le complément PowerPivot pour SharePoint &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-228">For more information, see [Install or Uninstall the PowerPivot for SharePoint Add-in &#40;SharePoint 2013&#41;](../instances/install-windows/install-or-uninstall-the-power-pivot-for-sharepoint-add-in-sharepoint-2013.md).</span></span>  
  
-   <span data-ttu-id="742bc-229">Un utilisateur configure une planification d'actualisation pour un classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-229">A user configures a refresh schedule for a workbook.</span></span> <span data-ttu-id="742bc-230">À l'heure planifiée, le service système PowerPivot envoie une requête dans Excel Services pour :</span><span class="sxs-lookup"><span data-stu-id="742bc-230">At the scheduled time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="742bc-231">Charger et traiter la base de données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-231">Load and process the PowerPivot database.</span></span>  
  
    -   <span data-ttu-id="742bc-232">Actualiser le classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-232">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="742bc-233">Enregistrer le classeur dans la base de données de contenu.</span><span class="sxs-lookup"><span data-stu-id="742bc-233">Save the workbook back to the content database.</span></span>  
  
-   <span data-ttu-id="742bc-234">**Informations d'identification :** Utilise les informations d'identification stockées.</span><span class="sxs-lookup"><span data-stu-id="742bc-234">**Credentials:** Uses stored credentials.</span></span> <span data-ttu-id="742bc-235">N'utilise pas l'identité de l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="742bc-235">Does not use the identity of the current user.</span></span>  
  
-   <span data-ttu-id="742bc-236">**Classeurs pris en charge :** classeurs créés à l'aide du complément [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot pour Excel 2010 ou à l'aide d'Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="742bc-236">**Supported Workbooks:** Workbooks created using the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot add-in for Excel 2010 or using Excel 2013.</span></span> <span data-ttu-id="742bc-237">Les classeurs créés dans Excel 2010 avec le complément [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="742bc-237">Workbooks created in Excel 2010 with the [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)] PowerPivot add-in are not supported.</span></span> <span data-ttu-id="742bc-238">Mettre à niveau le classeur au moins au format [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-238">Upgrade the workbook to at least the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] PowerPivot format.</span></span> <span data-ttu-id="742bc-239">Pour plus d’informations, consultez [Mettre à niveau les classeurs et l’actualisation planifiée des données &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-239">For more information on workbook upgrades, see [Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md).</span></span>  
  
 <span data-ttu-id="742bc-240">Pour afficher la page de **Gérer l'actualisation des données** :</span><span class="sxs-lookup"><span data-stu-id="742bc-240">To display the **Manage Data Refresh** page:</span></span>  
  
-   <span data-ttu-id="742bc-241">Consultez l'illustration qui suit les étapes.</span><span class="sxs-lookup"><span data-stu-id="742bc-241">See the illustration that follows the steps.</span></span>  
  
1.  <span data-ttu-id="742bc-242">Dans une bibliothèque de documents SharePoint, cliquez sur le **menu Ouvrir** (**...**) pour un classeur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-242">In a SharePoint document library, click the **Open menu** (**...**) for a PowerPivot workbook.</span></span>  
  
2.  <span data-ttu-id="742bc-243">Cliquez sur le second **menu Ouvrir** , puis cliquez sur **Gérer l'actualisation des données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="742bc-243">Click the second **Open menu** and then click **Manage PowerPivot Data Refresh**.</span></span>  
  
3.  <span data-ttu-id="742bc-244">Dans la page **Gérer l'actualisation des données** , cliquez sur **Activer** puis configurez la planification de l'actualisation.</span><span class="sxs-lookup"><span data-stu-id="742bc-244">On the **Manage Data Refresh** page, click **Enable** and then configure the refresh schedule.</span></span>  
  
4.  <span data-ttu-id="742bc-245">À l'heure spécifiée, le service système PowerPivot envoie une requête dans Excel Services pour :</span><span class="sxs-lookup"><span data-stu-id="742bc-245">At the specified time, the PowerPivot System Service sends a request to Excel Services to:</span></span>  
  
    -   <span data-ttu-id="742bc-246">Charger et traiter le modèle de données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-246">Load and process the PowerPivot data model.</span></span>  
  
    -   <span data-ttu-id="742bc-247">Actualiser le classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-247">Refresh the workbook.</span></span>  
  
    -   <span data-ttu-id="742bc-248">Enregistrer le classeur dans la base de données de contenu.</span><span class="sxs-lookup"><span data-stu-id="742bc-248">Save the workbook back to the content database.</span></span>  
  
 <span data-ttu-id="742bc-249">![Menu contextuel Gérer l'actualisation des données](../media/as-manage-datarefresh-sharepoint2013.gif "Menu contextuel Gérer l'actualisation des données")</span><span class="sxs-lookup"><span data-stu-id="742bc-249">![manage data refresh context menu](../media/as-manage-datarefresh-sharepoint2013.gif "manage data refresh context menu")</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="742bc-250">Pour plus d’informations sur l’actualisation des classeurs à partir de SharePoint Online, consultez [actualisation des classeurs Excel avec les modèles PowerPivot incorporés à partir de SharePoint Online (livre blanc)](https://technet.microsoft.com/library/jj992650.aspx) ( https://technet.microsoft.com/library/jj992650.aspx) .</span><span class="sxs-lookup"><span data-stu-id="742bc-250">For information on refreshing workbooks from SharePoint online, see [Refreshing Excel workbooks with embedded PowerPivot models from SharePoint Online (white paper)](https://technet.microsoft.com/library/jj992650.aspx) (https://technet.microsoft.com/library/jj992650.aspx).</span></span>  
  
##  <a name="scheduled-data-refresh-architecture-in-sharepoint-2013"></a><a name="bkmk_refresh_architecture"></a><span data-ttu-id="742bc-251">Architecture d’actualisation des données planifiée dans SharePoint 2013</span><span class="sxs-lookup"><span data-stu-id="742bc-251">Scheduled Data Refresh Architecture in SharePoint 2013</span></span>  
 <span data-ttu-id="742bc-252">L'illustration suivante présente l'architecture d'actualisation des données dans SharePoint 2013 et SQL Server 2012 SP1.</span><span class="sxs-lookup"><span data-stu-id="742bc-252">The following illustration summarizes the data refresh architecture in SharePoint 2013 and SQL Server 2012 SP1.</span></span>  
  
 <span data-ttu-id="742bc-253">![Actualisation des données de l'architecture de SQL Server 2012 SP1](../media/as-scheduled-data-refresh2012sp1-architecture.gif "Actualisation des données de l'architecture de SQL Server 2012 SP1")</span><span class="sxs-lookup"><span data-stu-id="742bc-253">![architecture of SQL Server 2012 SP1 data refresh](../media/as-scheduled-data-refresh2012sp1-architecture.gif "architecture of SQL Server 2012 SP1 data refresh")</span></span>  
  
||<span data-ttu-id="742bc-254">Description</span><span class="sxs-lookup"><span data-stu-id="742bc-254">Description</span></span>||  
|-|-----------------|-|  
|<span data-ttu-id="742bc-255">**(1)**</span><span class="sxs-lookup"><span data-stu-id="742bc-255">**(1)**</span></span>|<span data-ttu-id="742bc-256">Moteur Analysis Services</span><span class="sxs-lookup"><span data-stu-id="742bc-256">Analysis Services Engine</span></span>|<span data-ttu-id="742bc-257">Un serveur [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] exécuté en mode SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-257">An [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server that is running in SharePoint mode.</span></span> <span data-ttu-id="742bc-258">Le serveur s'exécute à l'extérieur de la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-258">The server runs outside of the SharePoint farm.</span></span>|  
|<span data-ttu-id="742bc-259">**2**</span><span class="sxs-lookup"><span data-stu-id="742bc-259">**(2)**</span></span>|<span data-ttu-id="742bc-260">Interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="742bc-260">User Interface</span></span>|<span data-ttu-id="742bc-261">L'interface utilisateur est composée de deux pages.</span><span class="sxs-lookup"><span data-stu-id="742bc-261">The user interface is comprised of two pages.</span></span> <span data-ttu-id="742bc-262">Une pour définir la planification et la seconde pour afficher l'historique de l'actualisation.</span><span class="sxs-lookup"><span data-stu-id="742bc-262">One to define the schedule and the second to view the refresh history.</span></span> <span data-ttu-id="742bc-263">Les pages n'accèdent pas directement aux bases de données d'application du service PowerPivot mais utilisent le service système PowerPivot pour accéder aux bases de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-263">The pages do not directly access the PowerPivot Service application databases but use the PowerPivot system service to access the databases.</span></span>|  
|<span data-ttu-id="742bc-264">**1,3**</span><span class="sxs-lookup"><span data-stu-id="742bc-264">**(3)**</span></span>|<span data-ttu-id="742bc-265">Service système PowerPivot</span><span class="sxs-lookup"><span data-stu-id="742bc-265">PowerPivot System Service</span></span>|<span data-ttu-id="742bc-266">Le service est installé lorsque vous déployez le complément PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-266">The service is installed when you deploy the PowerPivot for SharePoint add-in.</span></span> <span data-ttu-id="742bc-267">Le service est utilisé pour les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="742bc-267">The service is used for the following:</span></span><br /><br /> <span data-ttu-id="742bc-268">Ce service héberge le moteur de planification de l'actualisation, qui appelle des API Excel Services pour actualiser les données des classeurs Excel 2013.</span><span class="sxs-lookup"><span data-stu-id="742bc-268">This service hosts the refresh scheduling engine, which calls Excel Services APIs for data refresh of Excel 2013 workbooks.</span></span> <span data-ttu-id="742bc-269">Pour les classeurs Excel 2010, le service traite directement le modèle de données mais continue à répondre dans Excel Services pour charger le modèle de données et mettre à jour le classeur.</span><span class="sxs-lookup"><span data-stu-id="742bc-269">For Excel 2010 workbooks, the service directly performs the data model processing but continues to reply on Excel Services for loading the data model and updating the workbook.</span></span><br /><br /> <span data-ttu-id="742bc-270">Ce service fournit des méthodes pour que les composants tels que les pages de l'interface utilisateur puissent communiquer avec le service système.</span><span class="sxs-lookup"><span data-stu-id="742bc-270">This service provides methods for components such as the user interface pages, to communicate with the system service.</span></span><br /><br /> <span data-ttu-id="742bc-271">Gère les demandes d'accès externe aux classeurs en tant que source de données, reçues via le service Web PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-271">Manages requests for external access to workbooks as a data source, received through the PowerPivot Web Service.</span></span><br /><br /> <span data-ttu-id="742bc-272">Administration des demandes d'actualisation planifiée des données pour les travaux du minuteur et les pages de configuration.</span><span class="sxs-lookup"><span data-stu-id="742bc-272">Scheduled data refresh request management for timer jobs and configuration pages.</span></span> <span data-ttu-id="742bc-273">Le service gère les demandes de lecture des données vers et depuis la base de données d'application du service et déclenche l'actualisation des données avec Excel Services.</span><span class="sxs-lookup"><span data-stu-id="742bc-273">The service manages requests to read data in and out of the service application database and trigger data refresh with Excel Services.</span></span><br /><br /> <span data-ttu-id="742bc-274">Traitement de l'utilisation et travail du minuteur associé.</span><span class="sxs-lookup"><span data-stu-id="742bc-274">Usage processing and related timer job.</span></span>|  
|<span data-ttu-id="742bc-275">**4**</span><span class="sxs-lookup"><span data-stu-id="742bc-275">**(4)**</span></span>|<span data-ttu-id="742bc-276">Services de calcul Excel</span><span class="sxs-lookup"><span data-stu-id="742bc-276">Excel Calculation Services</span></span>|<span data-ttu-id="742bc-277">Responsables du chargement des modèles de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-277">Responsible for loading the data models.</span></span>|  
|<span data-ttu-id="742bc-278">**5,5**</span><span class="sxs-lookup"><span data-stu-id="742bc-278">**(5)**</span></span>|<span data-ttu-id="742bc-279">Service Banque d'informations sécurisé</span><span class="sxs-lookup"><span data-stu-id="742bc-279">Secure Store Service</span></span>|<span data-ttu-id="742bc-280">Si les paramètres d’authentification du classeur sont configurés pour **utiliser le compte de l’utilisateur authentifié** ou **aucun**, les informations d’identification stockées dans l’ID de l’application cible du magasin sécurisé sont utilisées pour l’actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="742bc-280">If the authentication settings in the workbook are configured to **Use the authenticated user's account** or **None**, the credentials stored in the Secure Store target application ID are used for data refresh.</span></span> <span data-ttu-id="742bc-281">Pour plus d'informations, consultez la section [Considérations supplémentaires relatives à l'authentification](#datarefresh_additional_authentication) de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="742bc-281">For more information, see the [Additional Authentication Considerations](#datarefresh_additional_authentication) section in this topic.</span></span>|  
|<span data-ttu-id="742bc-282">**6,3**</span><span class="sxs-lookup"><span data-stu-id="742bc-282">**(6)**</span></span>|<span data-ttu-id="742bc-283">Travail du minuteur pour l'actualisation des données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="742bc-283">PowerPivot data refresh timer Job</span></span>|<span data-ttu-id="742bc-284">Indique au service système PowerPivot de se connecter à Excel Services pour actualiser les modèles de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-284">Instructs the PowerPivot system service to connect with Excel Services for refreshing data models.</span></span>|  
  
 [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="742bc-285">requiert des fournisseurs de données et des bibliothèques clientes appropriés afin que le serveur [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] en mode SharePoint puisse accéder aux sources de données.</span><span class="sxs-lookup"><span data-stu-id="742bc-285">requires appropriate data providers and client libraries so that the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] server in SharePoint mode can access data sources.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="742bc-286">Étant donné que le service système PowerPivot ne charge et n'enregistre plus les modèles PowerPivot, la plupart des paramètres de mise en cache des modèles sur un serveur d'applications ne s'appliquent pas à une batterie de serveurs SharePoint 2013.</span><span class="sxs-lookup"><span data-stu-id="742bc-286">Because the PowerPivot system service no longer loads or saves PowerPivot models, most of the settings for caching models on an application server do not apply to a SharePoint 2013 farm.</span></span>  
  
## <a name="data-refresh-log-data"></a><span data-ttu-id="742bc-287">Données du journal d'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="742bc-287">Data refresh log data</span></span>  
 <span data-ttu-id="742bc-288">**Données d'utilisation :** vous pouvez consulter les données d'utilisation de l'actualisation des données dans le tableau de bord de gestion PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="742bc-288">**Usage Data:** You can view data refresh usage data in the PowerPivot Management Dashboard.</span></span> <span data-ttu-id="742bc-289">Pour afficher les données d'utilisation :</span><span class="sxs-lookup"><span data-stu-id="742bc-289">To see the usage data:</span></span>  
  
1.  <span data-ttu-id="742bc-290">Dans l'Administration centrale SharePoint, dans le groupe **Paramètres généraux de l'application** , cliquez sur **Tableau de bord de gestion PowerPivot** .</span><span class="sxs-lookup"><span data-stu-id="742bc-290">In SharePoint Central Administration, click **PowerPivot Management Dashboard** in the **General application settings** group.</span></span>  
  
2.  <span data-ttu-id="742bc-291">En bas du tableau de bord, consultez **actualisation des données-activité récente** et **actualisation des données-échecs récents**.</span><span class="sxs-lookup"><span data-stu-id="742bc-291">At the bottom of the dashboard, see the **Data Refresh - Recent Activity** and **Data Refresh - Recent Failures**.</span></span>  
  
3.  <span data-ttu-id="742bc-292">Pour plus d'informations sur les données d'utilisation et la façon de les activer, consultez [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-292">For more information on usage data and how to enable it, see [PowerPivot Management Dashboard and Usage Data](power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
 <span data-ttu-id="742bc-293">**Données du journal de diagnostics :** vous pouvez afficher les données du journal de diagnostics SharePoint associées à l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="742bc-293">**Diagnostic log data:** You can view SharePoint diagnostic log data related to data refresh.</span></span> <span data-ttu-id="742bc-294">D'abord, vérifiez la configuration de la journalisation des diagnostics pour le **Service PowerPivot** dans la page de **Analyse** de l'Administration centrale de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="742bc-294">First, verify the configuration of diagnostic logging for the **PowerPivot Service** in SharePoint Central Administration **Monitoring** page.</span></span> <span data-ttu-id="742bc-295">Vous devrez peut-être augmenter le niveau de journalisation pour l' « événement le moins critique » dans le journal.</span><span class="sxs-lookup"><span data-stu-id="742bc-295">You may need to increase the level of logging for the "least critical event" to log.</span></span> <span data-ttu-id="742bc-296">Par exemple, définissez temporairement la valeur sur **Commentaires** et réexécutez les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="742bc-296">For example, temporarily set the value to **Verbose** and then rerun data refresh operations.</span></span>  
  
 <span data-ttu-id="742bc-297">Les entrées de journal contiennent :</span><span class="sxs-lookup"><span data-stu-id="742bc-297">The log entries contain:</span></span>  
  
-   <span data-ttu-id="742bc-298">La **Zone** du **Service PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="742bc-298">The **Area** of **PowerPivot Service**.</span></span>  
  
-   <span data-ttu-id="742bc-299">La catégorie de l' **Actualisation des données**.</span><span class="sxs-lookup"><span data-stu-id="742bc-299">The category of **Data Refresh**.</span></span>  
  
 <span data-ttu-id="742bc-300">Passez en revue la **configuration de la journalisation des diagnostics**.</span><span class="sxs-lookup"><span data-stu-id="742bc-300">Review the **configure diagnostic logging**.</span></span> <span data-ttu-id="742bc-301">Pour plus d’informations, consultez [configurer et afficher les fichiers journaux SharePoint et la journalisation des diagnostics &#40;PowerPivot pour SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span><span class="sxs-lookup"><span data-stu-id="742bc-301">For more information, see [Configure and View SharePoint Log Files  and Diagnostic Logging &#40;PowerPivot for SharePoint&#41;](configure-and-view-sharepoint-and-diagnostic-logging.md).</span></span>  
  
##  <a name="additional-authentication-considerations"></a><a name="datarefresh_additional_authentication"></a><span data-ttu-id="742bc-302">Considérations supplémentaires relatives à l’authentification</span><span class="sxs-lookup"><span data-stu-id="742bc-302">Additional Authentication Considerations</span></span>  
 <span data-ttu-id="742bc-303">Les paramètres de la boîte de dialogue **Paramètres d'authentification Excel Services** dans Excel 2013 déterminent l'identité Windows qu'Excel Services et [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] utilisent pour l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="742bc-303">The settings in the **Excel Services Authentication Settings** dialog in Excel 2013, determine the Windows identity that Excel Services and [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] use for data refresh.</span></span>  
  
-   <span data-ttu-id="742bc-304">**Utiliser le compte de l’utilisateur authentifié**: Excel Services effectue l’actualisation des données sous l’identité de l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="742bc-304">**Use the authenticated user's account**: Excel Services performs data refresh under the identity of the currently logged-in user.</span></span>  
  
-   <span data-ttu-id="742bc-305">**Utiliser un compte stocké**: suppose un ID d'application de service Banque d'informations sécurisé de SharePoint, qu'Excel Services utilise pour extraire le nom d'utilisateur et le mot de passe afin d'authentifier l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="742bc-305">**Use a stored account**: Assumes a SharePoint Secure Store Service application ID, which Excel Services uses to retrieve the user name and password to authenticate data refresh authentication.</span></span>  
  
-   <span data-ttu-id="742bc-306">**Aucun**: le **Compte de service autonome** d'Excel Services est utilisé.</span><span class="sxs-lookup"><span data-stu-id="742bc-306">**None**: The Excel Services **Unattended Service Account** is used.</span></span> <span data-ttu-id="742bc-307">Le compte de service est associé à un proxy de service Banque d'informations sécurisé.</span><span class="sxs-lookup"><span data-stu-id="742bc-307">The service account is associated with a Secure Store Proxy.</span></span> <span data-ttu-id="742bc-308">Configurez les paramètres dans la page **Paramètres d'application Excel Services** , dans la section **Données externes** .</span><span class="sxs-lookup"><span data-stu-id="742bc-308">Configure the settings on the **Excel Services Application Settings** page, in the **External Data** section.</span></span>  
  
 <span data-ttu-id="742bc-309">Pour ouvrir la boîte de dialogue des paramètres d'authentification :</span><span class="sxs-lookup"><span data-stu-id="742bc-309">To open the authentication settings dialog:</span></span>  
  
1.  <span data-ttu-id="742bc-310">Dans Excel 2013, cliquez sur l'onglet **Données** .</span><span class="sxs-lookup"><span data-stu-id="742bc-310">Click the **Data** tab in Excel 2013.</span></span>  
  
2.  <span data-ttu-id="742bc-311">Cliquez sur **Connexions** dans le ruban.</span><span class="sxs-lookup"><span data-stu-id="742bc-311">Click **Connections** in the ribbon.</span></span>  
  
3.  <span data-ttu-id="742bc-312">Dans **Boîte de dialogue des connexions du classeur**, sélectionnez la connexion et cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="742bc-312">In the **Workbook connections dialog**, select the connection and click **Properties**.</span></span>  
  
4.  <span data-ttu-id="742bc-313">Dans la boîte de dialogue **Propriétés de connexion** , cliquez sur **définition**, puis cliquez sur le bouton **paramètres d’authentification..** ..</span><span class="sxs-lookup"><span data-stu-id="742bc-313">In the **Connection properties** dialog, click **Definition**, and then click the **Authentication Settings...** button.</span></span>  
  
 <span data-ttu-id="742bc-314">![Paramètres d'authentification Excel Services](../media/as-authentication-settings-4-ecs-in-excel2013.gif "Paramètres d'authentification Excel Services")</span><span class="sxs-lookup"><span data-stu-id="742bc-314">![excel services authentication settings](../media/as-authentication-settings-4-ecs-in-excel2013.gif "excel services authentication settings")</span></span>  
  
 <span data-ttu-id="742bc-315">Pour plus d'informations sur l'authentification de l'actualisation des données et l'utilisation des informations d'identification, consultez la publication de blog [Actualisation des données PowerPivot dans SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="742bc-315">For more information on data refresh authentication and usage of credentials, see the blog post [Refreshing PowerPivot Data in SharePoint 2013](https://blogs.msdn.com/b/analysisservices/archive/2012/12/21/refreshing-powerpivot-data-in-sharepoint-2013.aspx).</span></span>  
  
##  <a name="more-information"></a><a name="bkmk_moreinformation"></a> <span data-ttu-id="742bc-316">Informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="742bc-316">More Information</span></span>  
 <span data-ttu-id="742bc-317">[Résolution des problèmes d'actualisation des données PowerPivot](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span><span class="sxs-lookup"><span data-stu-id="742bc-317">[Troubleshooting PowerPivot Data Refresh](https://social.technet.microsoft.com/wiki/contents/articles/3870.troubleshooting-powerpivot-data-refresh.aspx).</span></span>  
  
 <span data-ttu-id="742bc-318">[Excel Services dans SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span><span class="sxs-lookup"><span data-stu-id="742bc-318">[Excel Services in SharePoint 2013](https://www.enjoysharepoint.com/configure-excel-service-application-in-sharepoint-2013/).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="742bc-319">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="742bc-319">See Also</span></span>  
 <span data-ttu-id="742bc-320">[Mettre à niveau les classeurs et l’actualisation planifiée des données &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span><span class="sxs-lookup"><span data-stu-id="742bc-320">[Upgrade Workbooks and Scheduled Data Refresh &#40;SharePoint 2013&#41;](../instances/install-windows/upgrade-workbooks-and-scheduled-data-refresh-sharepoint-2013.md) </span></span>  
 [<span data-ttu-id="742bc-321">PowerPivot for SharePoint 2013 Installation</span><span class="sxs-lookup"><span data-stu-id="742bc-321">PowerPivot for SharePoint 2013 Installation</span></span>](../instances/install-windows/install-analysis-services-in-power-pivot-mode.md)  
  
  
