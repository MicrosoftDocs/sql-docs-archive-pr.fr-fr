---
title: "Impossible d'actualiser les données pour une connexion de données dans le classeur. Essayez encore ou contactez votre administrateur système. Échec de l’actualisation des connexions suivantes : données PowerPivot | Microsoft Docs"
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87705532"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="e5d33-104">Impossible d'actualiser les données pour une connexion de données dans le classeur.</span><span class="sxs-lookup"><span data-stu-id="e5d33-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="e5d33-105">Essayez encore ou contactez votre administrateur système.</span><span class="sxs-lookup"><span data-stu-id="e5d33-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="e5d33-106">Échec de l'actualisation des connexions suivantes : Données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="e5d33-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="e5d33-107">Pour les classeurs Excel qui contiennent des données PowerPivot, Excel Services retourne cette erreur en cas de demande de connexion à un serveur PowerPivot qui échoue.</span><span class="sxs-lookup"><span data-stu-id="e5d33-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="e5d33-108">Détails</span><span class="sxs-lookup"><span data-stu-id="e5d33-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="e5d33-109">S’applique à :</span><span class="sxs-lookup"><span data-stu-id="e5d33-109">Applies to:</span></span>|<span data-ttu-id="e5d33-110">Installation de PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="e5d33-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="e5d33-111">Version du produit</span><span class="sxs-lookup"><span data-stu-id="e5d33-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="e5d33-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="e5d33-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="e5d33-113">Cause</span><span class="sxs-lookup"><span data-stu-id="e5d33-113">Cause</span></span>|<span data-ttu-id="e5d33-114">Voir ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="e5d33-114">See below.</span></span>|  
|<span data-ttu-id="e5d33-115">Texte du message</span><span class="sxs-lookup"><span data-stu-id="e5d33-115">Message Text</span></span>|<span data-ttu-id="e5d33-116">Impossible d'actualiser les données pour une connexion de données dans le classeur.</span><span class="sxs-lookup"><span data-stu-id="e5d33-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="e5d33-117">Essayez encore ou contactez votre administrateur système.</span><span class="sxs-lookup"><span data-stu-id="e5d33-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="e5d33-118">Échec de l'actualisation des connexions suivantes : Données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="e5d33-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="e5d33-119">Explication et résolution</span><span class="sxs-lookup"><span data-stu-id="e5d33-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="e5d33-120">Excel Services ne peut pas se connecter aux données PowerPivot ou les charger.</span><span class="sxs-lookup"><span data-stu-id="e5d33-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="e5d33-121">Les conditions qui provoquent cette erreur sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="e5d33-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="e5d33-122">**Scénario 1 : le service n'est pas démarré**</span><span class="sxs-lookup"><span data-stu-id="e5d33-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="e5d33-123">L'instance de SQL Server Analysis Services (PowerPivot) n'est pas démarrée.</span><span class="sxs-lookup"><span data-stu-id="e5d33-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="e5d33-124">Un mot de passe périmé arrête l'exécution du service.</span><span class="sxs-lookup"><span data-stu-id="e5d33-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="e5d33-125">Pour plus d’informations sur la modification du mot de passe, consultez [configurer des comptes de service PowerPivot](configure-power-pivot-service-accounts.md) et [Démarrer ou arrêter un serveur PowerPivot pour SharePoint](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span><span class="sxs-lookup"><span data-stu-id="e5d33-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="e5d33-126">**Scénario 2a : Ouverture d'un classeur de version antérieure sur le serveur**</span><span class="sxs-lookup"><span data-stu-id="e5d33-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="e5d33-127">Le classeur que vous essayez d'ouvrir peut avoir été créé dans la version SQL Server 2008 R2 de PowerPivot pour Excel.</span><span class="sxs-lookup"><span data-stu-id="e5d33-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="e5d33-128">Très probablement, le fournisseur de données Analysis Services qui est spécifié dans la chaîne de connexion de données n'est pas présent sur l'ordinateur qui gère la demande.</span><span class="sxs-lookup"><span data-stu-id="e5d33-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="e5d33-129">Si c’est le cas, vous trouverez ce message dans le Journal ULS : « échec de l’actualisation des données PowerPivot dans le classeur' \<URL to workbook> ' », suivi de « impossible d’obtenir une connexion ».</span><span class="sxs-lookup"><span data-stu-id="e5d33-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="e5d33-130">Pour déterminer la version du classeur, ouvrez-le dans Excel et vérifiez quel fournisseur de données est spécifié dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="e5d33-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="e5d33-131">Un classeur SQL Server 2008 R2 utilise MSOLAP.4 comme fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="e5d33-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="e5d33-132">Pour contourner ce problème, vous pouvez mettre à niveau le classeur.</span><span class="sxs-lookup"><span data-stu-id="e5d33-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="e5d33-133">Ou bien, vous pouvez installer les bibliothèques clientes de la version SQL Server 2008 R2 d'Analysis Services sur des ordinateurs physiques exécutant PowerPivot pour SharePoint ou Excel Services :</span><span class="sxs-lookup"><span data-stu-id="e5d33-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="e5d33-134">Installer le fournisseur OLE DB Analysis Services sur les serveurs SharePoint</span><span class="sxs-lookup"><span data-stu-id="e5d33-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="e5d33-135">**Scénario 2b : Excel Services s'exécute sur un serveur d'applications qui a une version incorrecte des bibliothèques clientes**</span><span class="sxs-lookup"><span data-stu-id="e5d33-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="e5d33-136">Par défaut, SharePoint Server 2010 installe la version SQL Server 2008 du fournisseur OLE DB Analysis Services sur les serveurs d'applications qui exécutent Excel Services.</span><span class="sxs-lookup"><span data-stu-id="e5d33-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="e5d33-137">Dans une batterie de serveurs qui prend en charge l'accès aux données PowerPivot, tous les serveurs physiques exécutant des applications qui demandent des données PowerPivot, par exemple Excel Services et PowerPivot pour SharePoint, doivent utiliser une version ultérieure du fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="e5d33-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="e5d33-138">Les serveurs qui exécutent PowerPivot pour SharePoint obtiennent le fournisseur de données OLE DB mis à jour automatiquement.</span><span class="sxs-lookup"><span data-stu-id="e5d33-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="e5d33-139">D'autres serveurs, tels que ceux qui exécutent une instance autonome d'Excel Services sans PowerPivot pour SharePoint sur le même ordinateur, doivent être corrigés pour utiliser les bibliothèques clientes plus récentes.</span><span class="sxs-lookup"><span data-stu-id="e5d33-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="e5d33-140">Pour plus d’informations, voir [Installer le fournisseur OLE DB Analysis Services sur les serveurs SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span><span class="sxs-lookup"><span data-stu-id="e5d33-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="e5d33-141">**Scénario 3 : le contrôleur de domaine n'est pas disponible**</span><span class="sxs-lookup"><span data-stu-id="e5d33-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="e5d33-142">La cause de l'erreur peut être qu'un contrôleur de domaine n'est pas disponible pour valider l'identité de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e5d33-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="e5d33-143">Un contrôleur de domaine est requis par le service d'émission de jetons Revendications vers Windows pour authentifier l'utilisateur SharePoint à chaque connexion.</span><span class="sxs-lookup"><span data-stu-id="e5d33-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="e5d33-144">Le service d'émission de jetons Revendications vers Windows n'utilise pas des informations d'identification mises en cache.</span><span class="sxs-lookup"><span data-stu-id="e5d33-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="e5d33-145">Il valide l'identité de l'utilisateur pour chaque connexion.</span><span class="sxs-lookup"><span data-stu-id="e5d33-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="e5d33-146">Vous pouvez vérifier la cause de cette erreur en consultant le fichier journal SharePoint.</span><span class="sxs-lookup"><span data-stu-id="e5d33-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="e5d33-147">Si les journaux SharePoint incluent le message « Échec de l'obtention de WindowsIdentity à partir de IClaimsIdentity », l'identité de l'utilisateur n'a pas pu être authentifiée.</span><span class="sxs-lookup"><span data-stu-id="e5d33-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="e5d33-148">Pour contourner ce problème, joignez l'ordinateur au même domaine que le serveur PowerPivot ou installez un contrôleur de domaine sur votre ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="e5d33-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="e5d33-149">La deuxième solution, l'installation du contrôleur de domaine, oblige à créer des comptes de domaine locaux pour tous les services et utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="e5d33-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="e5d33-150">Vous devrez configurer des comptes de service et des autorisations SharePoint pour les comptes que vous définissez.</span><span class="sxs-lookup"><span data-stu-id="e5d33-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="e5d33-151">L'installation d'un contrôleur de domaine sur votre ordinateur est utile si votre objectif est d'utiliser PowerPivot pour SharePoint hors connexion.</span><span class="sxs-lookup"><span data-stu-id="e5d33-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="e5d33-152">Pour obtenir des instructions détaillées sur l’utilisation de PowerPivot en mode hors connexion, consultez le billet de blog « placement de votre serveur PowerPivot hors du réseau » sur [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) .</span><span class="sxs-lookup"><span data-stu-id="e5d33-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="e5d33-153">**Scénario 4 : serveur instable**</span><span class="sxs-lookup"><span data-stu-id="e5d33-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="e5d33-154">Un ou plusieurs services peuvent être dans un état incohérent.</span><span class="sxs-lookup"><span data-stu-id="e5d33-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="e5d33-155">Dans certains cas, l'exécution d'IISRESET résoudra le problème.</span><span class="sxs-lookup"><span data-stu-id="e5d33-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
