---
title: Informations de référence sur les règles d’intégrité (PowerPivot pour SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5e4c895cf55742b8db89bd86f7fe4c5277ef7a6c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87696236"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>Référence de règles d'intégrité (PowerPivot pour SharePoint)
  Cette rubrique de référence décrit les règles d'intégrité de SharePoint ajoutées par une installation de PowerPivot pour SharePoint. Ces règles sont utilisées pour signaler des problèmes avec l'intégrité du serveur, la disponibilité, ou la configuration d'une application de service [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] ou son instance d' [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] associée.  
  
 Le tableau suivant répertorie les règles dans l'ordre dans lequel elles apparaissent dans la page Définitions de règle de l'analyseur d'intégrité dans l'Administration centrale de SharePoint. Les règles configurables sont celles dont vous pouvez modifier les seuils qui la déclenchent. Pour plus d’informations, voir [PowerPivot Health Rules-configure](configure-power-pivot-health-rules.md). La réparation automatique indique qu'il existe une solution intégrée sur laquelle vous pouvez cliquer dans la page Rapports de problème pour résoudre le problème.  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]** SharePoint 2013 &#124; SharePoint 2010|  
  
 **Remarque :** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] installe différents jeux de règles d'intégrité pour différentes versions de SharePoint. Consultez la colonne « version » dans le tableau ci-dessous, ou exécutez la commande Windows PowerShell suivante pour voir les règles installées.  
  
```powershell
Get-SPHealthAnalysisRule | Select name, enabled, summary | Where {$_.summary -like "*power*"}  | Format-Table -Property * -AutoSize | Out-Default  
```  
  
|Règle|Configurable|Réparation automatique|Version|Description|  
|----------|------------------|-----------------|-------------|-----------------|  
|PowerPivot : le fournisseur OLE DB Analysis Services n'est pas installé sur cet ordinateur.|Non|Non|SharePoint 2010|Le fournisseur OLE DB Analysis Services n'est pas installé sur le serveur ou il s'agit d'une version incorrecte. Cette règle s'affiche lorsque votre batterie de serveurs SharePoint comprend des instances d'Excel Services sur des serveurs d'applications qui ne disposent pas de PowerPivot pour SharePoint. La règle vous avertit que le fournisseur OLE DB Analysis Services utilisé par Excel Services pour se connecter aux données PowerPivot n'est pas installé. Pour résoudre ce problème, installez le fournisseur OLE DB sur chaque serveur Excel Services qui ne dispose pas du fournisseur OLE DB Analysis Services. Vous pouvez télécharger et installer le fournisseur OLE DB Analysis Services à partir du Centre de téléchargement Microsoft. Pour plus d’informations, voir [Installer le fournisseur OLE DB Analysis Services sur les serveurs SharePoint](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).|  
|PowerPivot : les paramètres du Registre pour Microsoft.AnalysisServices.ChannelTransport.dll ne sont pas valides après l'installation de la version SQL Server 2008 R2 du fournisseur MSOLAP sur cet ordinateur.|Non|Oui|SharePoint 2010|C'est un problème de configuration du serveur. Vraisemblablement, ChannelTransport.dll n'est pas inscrit dans l'assembly global. Exécutez la réparation automatique pour que cette règle inscrive le .dll sur chaque serveur doté d'une installation de PowerPivot pour SharePoint. Ou bien, vous pouvez exécuter regasm.exe manuellement pour inscrire le fichier. Si le service du minuteur SharePoint ne s'exécute pas en tant qu'administrateur local, une inscription manuelle peut être nécessaire. L'échec de mise à jour des paramètres du Registre provoque un ralentissement de la communication de serveur entre Excel Services et le service système PowerPivot, et peut entraîner des échecs de connexion dans certaines configurations de sécurité.|  
|PowerPivot : l'application de service PowerPivot n'a pas l'autorisation de terminer l'opération.|Non|Non|SharePoint 2010|Cette règle vérifie si l'identité d'application de service PowerPivot est propriétaire de la base de données d'application de serveur PowerPivot et dispose des autorisations administratives sur l'instance locale de SQL Server Analysis Services. Ces autorisations sont accordées automatiquement pendant l'installation et le déploiement, mais si cette étape n'a pas pu s'achever, cette règle d'intégrité s'applique.|  
|PowerPivot : l'identité de l'application de service PowerPivot ne doit pas être membre du groupe Administrateurs local.|Non|Non|SharePoint 2010|Il s'agit d'une recommandation qui améliore la sécurité globale de votre déploiement. Si vous avez configuré l'application de service PowerPivot afin qu'elle s'exécute sous un compte appartenant au groupe Administrateurs local, vous devez remplacer le compte de service par un compte qui n'appartient pas à ce groupe. Il est recommandé d'utiliser un compte dédié, de moindres privilèges, pour chaque service. Ainsi les services sont isolés et il est plus facile d'auditer les connexions. Pour plus d’informations sur la modification du compte de service, consultez [configurer des comptes de service PowerPivot](configure-power-pivot-service-accounts.md).|  
|PowerPivot : l'instance d'Analysis Services s'exécute en mode tabulaire, mais le paramètre de configuration qui spécifie ce mode est désactivé.|Non|Non|SharePoint 2010|Cette règle vérifie si la propriété de serveur `DeploymentMode` de l'instance de SQL Server Analysis Services dans une installation de PowerPivot pour SharePoint a pour valeur 1. Si la propriété est définie sur une autre valeur, ou si le service du minuteur SharePoint qui exécute le vérificateur de règle n'a pas l'autorisation d'ouvrir le fichier, cette règle échoue. Pour plus d’informations sur la propriété de mode de déploiement, consultez [Déterminer le mode serveur d’une instance Analysis Services](../instances/determine-the-server-mode-of-an-analysis-services-instance.md).|  
|PowerPivot : le travail du minuteur d'actualisation des données PowerPivot est désactivé.|Non|Non|SharePoint 2013<br /><br /> SharePoint 2010|Vérifiez les paramètres de travail du minuteur pour vous assurer qu'il est activé. Si vous n'utilisez pas la fonctionnalité d'actualisation des données PowerPivot, vous pouvez ignorer cette règle. Pour plus d’informations, consultez [actualisation des données PowerPivot avec SharePoint 2010](../powerpivot-data-refresh-with-sharepoint-2010.md).|  
|PowerPivot : les informations de compte de service SQL Server Analysis Services (PowerPivot) gérées par le Gestionnaire de configuration SQL Server sont différentes des informations de compte gérées par l'Administration centrale.|Non|Non|SharePoint 2010|Cette règle vérifie si les informations du compte de service dans le gestionnaire de configuration SQL Server sont identiques aux informations de compte géré dans l'Administration centrale pour la même instance d'Analysis Services. Si les comptes sont différents, une entrée est ajoutée au Rapport de problème et de résolution afin que vous puissiez modifier les informations du compte de service dans le gestionnaire de configuration SQL Server vers le compte spécifié dans l'Administration centrale. Le Gestionnaire de configuration SQL Server n'est pas un outil pris en charge pour la modification du nom d'utilisateur ou du mot de passe des comptes de service dans une installation de PowerPivot pour SharePoint. L'utilisation de l'Administration centrale permet d'utiliser la fonctionnalité des comptes gérés dans SharePoint. Plus important encore, si votre batterie comprend plusieurs serveurs PowerPivot pour SharePoint, des paramètres incohérents de compte de service peuvent interrompre le traitement et les opérations de requête sur le serveur ayant les informations de service incorrectes.<br /><br /> Sur un serveur unique, les classeurs PowerPivot fonctionnent temporairement lorsque cette règle est déclenchée, mais il est recommandé de résoudre le problème dès que possible. Les autorisations de base de données et de système de fichiers sont mises à jour à l'aide des informations de compte spécifiées dans l'Administration centrale.|  
|PowerPivot : la solution de batterie de serveurs déployée n'est pas à jour.|Non|Oui|SharePoint 2010|Une installation de PowerPivot pour SharePoint utilise une solution au niveau de la batterie de serveurs et une solution au niveau de l'application Web pour installer ses fonctionnalités. Cette règle indique que la solution de batterie de serveurs n'est pas actuelle par rapport à la version ou au serveur ou éventuellement à la solution web. Vraisemblablement, il s'agit d'un problème de déploiement du serveur. Pour remédier à ce problème, envisagez d'exécuter le programme d'installation de SQL Server pour réparer l'une des installations de PowerPivot pour SharePoint dans votre batterie de serveurs. Pour plus d’informations sur les solutions dans une installation PowerPivot pour SharePoint, consultez [déployer des solutions PowerPivot sur SharePoint](deploy-power-pivot-solutions-to-sharepoint.md).|  
|PowerPivot : l'utilisation de l'UC totale est trop élevée.|Oui|Non|SharePoint 2010|Cette règle surveille la consommation du processeur au niveau du système. L’utilisation globale du processeur est analysée, car le service système PowerPivot l’utilise comme mesure de l’intégrité du serveur, pour l’équilibrage de la charge basé sur l’intégrité entre plusieurs serveurs PowerPivot pour SharePoint dans une batterie de serveurs. Envisagez d'ajouter un autre serveur d'applications à la batterie et de déplacer les applications utilisant l'UC de manière intensive sur ce serveur.|  
|PowerPivot : Analysis Services n'a pas de ressources processeur suffisantes pour effectuer les opérations demandées.|Oui|Non|SharePoint 2010|La quantité de ressources processeur disponibles pour le processus Analysis Services (msmdsrv.exe) n'est pas suffisant pour le niveau d'activité de ce serveur. Envisagez d'ajouter un autre serveur PowerPivot pour SharePoint à la batterie. Pour plus d’informations, consultez [liste de vérification du déploiement : montée en puissance parallèle en ajoutant des serveurs PowerPivot à une batterie de serveurs SharePoint 2010](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md).|  
|PowerPivot : Analysis Services n'a pas suffisamment de mémoire pour effectuer les opérations demandées.|Non|Non|SharePoint 2010|Cette règle est déclenchée lorsqu'Analysis Services ne dispose plus que de 5 % de mémoire disponible. Sur un serveur d'applications SharePoint, une instance de SQL Server Analysis Services doit toujours avoir une quantité minimale de mémoire en réserve, toujours inutilisée. Étant donné que le fonctionnement du serveur est lié à la mémoire pour la plupart de ses opérations, celui-ci s'exécute mieux s'il n'atteint pas complètement la limite supérieure.<br /><br /> Par défaut, les avertissements de mémoire insuffisante se produisent lorsque la mémoire disponible atteint 5 %. Vous pouvez augmenter ou diminuer cette valeur en ajustant des paramètres sur l'instance d'Analysis Services. Pour plus d’informations, voir [PowerPivot Health Rules-configure](configure-power-pivot-health-rules.md).<br /><br /> Les 5 % de mémoire inutilisée sont calculés sous forme de pourcentage de la mémoire allouée à Analysis Services. Par exemple, si vous avez 200 Go de mémoire totale et qu'Analysis Services en utilise 80 % (soit 160 Go), les 5 % de mémoire inutilisée correspondent à 5 % de 160 Go (soit 8 Go).|  
|PowerPivot : le nombre élevé de connexions indique que vous devez déployer davantage de serveurs pour gérer la charge actuelle.|Oui|Non|SharePoint 2010|Par défaut, cette règle d'intégrité est déclenchée lorsque le nombre de connexions utilisateur distinctes dépasse 100. Cette valeur par défaut est arbitraire (elle n'est pas basée sur les spécifications matérielles de votre serveur ou sur l'activité des utilisateurs), vous pouvez donc augmenter ou diminuer la valeur en fonction de la capacité du serveur et de l'activité des utilisateurs dans votre environnement. Pour plus d’informations, voir [PowerPivot Health Rules-configure](configure-power-pivot-health-rules.md).|  
|PowerPivot : le rapport entre les événements de charge et les connexions est trop élevé.|Oui|Non|SharePoint 2013<br /><br /> SharePoint 2010|Par défaut, cette règle d'intégrité est déclenchée lorsque le pourcentage d'événements de chargement par rapport aux événements de connexion dépasse 50 % pendant la période entière de collecte de données (par défaut, 4 heures). Un taux aussi élevé indique un très grand nombre de connexions à des classeurs uniques, ou des paramètres de réduction de cache trop agressifs (c.-à-d. lorsque les classeurs sont rapidement déchargés et supprimés du système alors que les demandes pour ces données sont toujours actives). Pour éviter les faux positifs, il doit exister au moins 20 connexions par période de 4 heures avant que le taux puisse être calculé. Vous pouvez baser cette règle d'intégrité sur un taux différent. Pour plus d’informations, voir [PowerPivot Health Rules-configure](configure-power-pivot-health-rules.md). Pour plus d’informations sur la configuration du cache, consultez Configurer l’utilisation de l' [espace disque &#40;PowerPivot pour SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot : un ou plusieurs fichiers minidump ont été trouvés dans le répertoire des journaux, indiquant un blocage fatal du programme.|Non|Non|SharePoint 2013<br /><br /> SharePoint 2010|Les fichiers minidump sont générés lors d'un incident de programme pour capturer des informations sur l'état de l'application de service PowerPivot juste avant l'incident. Ces informations peuvent être envoyées à Microsoft et utilisées pour résoudre le problème. Cette règle est déclenchée lorsque des fichiers .dmp sont détectés sur le serveur. La règle fournit un lien vers le fichier, qui se trouve dans le dossier \OLAP\Log d'une instance de PowerPivot pour SharePoint. Notez que vous ne pouvez pas utiliser un éditeur de texte pour afficher le contenu du fichier. Pour afficher un fichier minidump, vous devez télécharger et installer un outil de débogage indépendant. Pour plus d'informations, consultez [Outils de débogage pour Windows](/windows-hardware/drivers/debugger/).|  
|PowerPivot : l'espace disque est trop faible sur le lecteur où les données PowerPivot sont mises en cache.|Oui|Non|SharePoint 2010|Par défaut, cette règle d'intégrité est déclenchée lorsque l'espace disque est inférieur à 5 % sur le lecteur de disque où se trouve le dossier de sauvegarde. Pour plus d’informations sur la définition de ce pourcentage, consultez [règles d’intégrité PowerPivot-configurer](configure-power-pivot-health-rules.md). Pour plus d’informations sur l’utilisation des disques, consultez [configurer l’utilisation de l’espace disque &#40;PowerPivot pour SharePoint&#41;](configure-disk-space-usage-power-pivot-for-sharepoint.md).|  
|PowerPivot : les données d'utilisation ne sont pas mises à jour à la fréquence attendue.|Oui|Non|SharePoint 2013<br /><br /> SharePoint 2010|PowerPivot pour SharePoint utilise le système de collecte des données d'utilisation de SharePoint pour obtenir des mesures sur les connexions, les actualisations de données et les temps de réponse des requêtes. Il stocke ces données d'utilisation dans la base de données d'application de service PowerPivot, qui à son tour met à jour un classeur PowerPivot (PowerPivot Management Data.xlsx) fournissant des données aux rapports du Tableau de bord de gestion PowerPivot. Cette règle indique que les données d'utilisation ne sont pas déplacées dans le fichier PowerPivot Management Data.xlsx avec une fréquence suffisante. La règle utilise l'horodateur du fichier .xlsx comme preuve de la mise à jour du fichier. S'il existe d'autres problèmes dans le système de collecte des données d'utilisation qui amoindrissent la précision des données, cette règle ne les détecte pas. Pour résoudre cette erreur, vérifiez les travaux du minuteur pour vous assurer qu'ils sont opérationnels. Pour plus d’informations sur la collecte des données d’utilisation, consultez [configurer la collecte des données d’utilisation pour &#40;PowerPivot pour SharePoint](configure-usage-data-collection-for-power-pivot-for-sharepoint.md).|  
|PowerPivot : le compte de processus Midtier doit disposer de l’autorisation « lecture totale » sur tous les applications spwebapplications associés.|Non|Oui|SharePoint 2013<br /><br /> SharePoint 2010|L’identité de l’application de service PowerPivot doit avoir des autorisations de **lecture totale** afin d’accéder aux bases de données de contenu SharePoint pour le compte des utilisateurs qui disposent d’autorisations afficher uniquement sur un document. Pour déterminer le compte utilisé comme identité de l’application de service PowerPivot, ouvrez la page **configurer les comptes de service** dans l’administration centrale. Vraisemblablement, l'application de service s'exécute dans le pool d'applications de service du **Système des services Web SharePoint** ou dans un pool d'applications dédié. Bien que cette règle fournisse une option réparer automatiquement, vous obtiendrez de meilleurs résultats si vous accordez les autorisations manuellement en procédant comme suit :<br /><br /> 1) Dans l’Administration centrale, cliquez sur **Gérer les applications Web**.<br /><br /> 2) Sélectionnez un site web, puis cliquez sur **Stratégie de l’utilisateur**.<br /><br /> 3) Cliquez sur **Ajouter des utilisateurs**.<br /><br /> 4) Sélectionnez (Toutes les zones) et cliquez sur **Suivant**.<br /><br /> 5) dans utilisateurs, entrez l’identité de l’application de service PowerPivot, puis cliquez sur la case à cocher **lecture totale** . Cliquez sur **Terminer**.<br /><br /> 6) Vérifiez la réparation. Dans Supervision, cliquez sur **Vérifier les définitions de règles**. Recherchez et ouvrez la règle PowerPivot. Cliquez sur **Exécuter maintenant**. Revenez à **Examiner les problèmes et solutions** pour vérifier que la règle ne s'affiche plus.|  
|PowerPivot : le service d'ouverture de session secondaire (seclogon) est désactivé|Non|Non|SharePoint 2013<br /><br /> SharePoint 2010|Le service secondaire d'ouverture de session est utilisé pour générer des images miniatures des classeurs PowerPivot dans la Galerie PowerPivot. Par défaut, le service secondaire d'ouverture de session est configuré pour un démarrage manuel. Si le service est désactivé, la génération de miniatures échoue. En outre, les journaux ULS contiendront l’erreur suivante : « l’erreur 1058 peut avoir comme cause première le fait que le service Windows «ouverture de session secondaire » est désactivé.»<br /><br /> Pour vérifier la configuration du service, utilisez l'application de console Services pour trouver l'ouverture de session secondaire et modifier son **Type de démarrage** sur **Manuel**. Si vous n'arrivez pas à activer le service, il est possible que votre organisation possède une stratégie de groupe qui le désactive. Contactez un administrateur pour déterminer si tel est le cas.<br /><br /> Après avoir activé le service, les images miniature ou d'instantané s'actualiseront dans le temps. Éventuellement, vous pouvez forcer une actualisation en redémarrant le service et en ouvrant puis en enregistrant de nouveau les pages des propriétés d'un rapport spécifique. Pour plus d’informations, consultez [comment utiliser la Galerie PowerPivot](https://go.microsoft.com/fwlink/?LinkId=246462).|  
|PowerPivot : ADOMD.NET n'est pas installé sur un serveur Web frontal autonome configuré pour l'administration centrale|Non|Non|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET est une bibliothèque cliente Analysis Services qui prend en charge les connexions à une base de données Analysis Services. Dans un déploiement de PowerPivot pour SharePoint, ADOMD.NET permet d'accéder aux rapports intégrés du tableau de bord de gestion PowerPivot dans l'Administration centrale. Les rapports intégrés sont en fait des classeurs PowerPivot qui contiennent des données incorporées Analysis Services. Le tableau de bord de gestion utilise ADOMD.NET pour envoyer une demande de connexion au serveur qui charge les données contenues dans le classeur.<br /><br /> Sur les topologies qui prévoient que l'Administration centrale s'exécute sur un serveur Web frontal autonome, vous devez installer ADOMD.NET manuellement si vous souhaitez afficher ces rapports dans le tableau de bord de gestion. Pour plus d’informations, consultez [Installer ADOMD.NET sur des serveurs web frontaux exécutant l’Administration centrale](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md).|  
