---
title: Colonnes calculées (SSAS tabulaire) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: e1011278-556d-4984-b01d-a37f8a33b304
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5d77b36ee3327d1b9e0d31ac97e5dbe135093a63
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87694712"
---
# <a name="calculated-columns-ssas-tabular"></a><span data-ttu-id="8c08f-102">Colonnes calculées (SSAS Tabulaire)</span><span class="sxs-lookup"><span data-stu-id="8c08f-102">Calculated Columns (SSAS Tabular)</span></span>
  <span data-ttu-id="8c08f-103">Les colonnes calculées, dans les modèles tabulaires, vous permettent d'ajouter de nouvelles données à votre modèle.</span><span class="sxs-lookup"><span data-stu-id="8c08f-103">Calculated columns, in tabular models, allow you to add new data to your model.</span></span> <span data-ttu-id="8c08f-104">Au lieu de coller ou d’importer des valeurs dans la colonne, vous créez une formule DAX qui définit les valeurs de niveau de ligne de la colonne.</span><span class="sxs-lookup"><span data-stu-id="8c08f-104">Instead of pasting or importing values into the column, you create a DAX formula that defines the column's row level values.</span></span> <span data-ttu-id="8c08f-105">La colonne calculée peut alors être utilisée dans un rapport, un tableau croisé dynamique ou un graphique croisé dynamique comme toute autre colonne.</span><span class="sxs-lookup"><span data-stu-id="8c08f-105">The calculated column can then be used in a report, PivotTable, or PivotChart as would any other column.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8c08f-106">Les colonnes calculées ne sont pas prises en charge pour les modèles tabulaires en mode DirectQuery.</span><span class="sxs-lookup"><span data-stu-id="8c08f-106">Calculated columns are not supported for tabular models in DirectQuery mode.</span></span> <span data-ttu-id="8c08f-107">Pour plus d’informations, consultez [Mode DirectQuery &#40;SSAS Tabulaire&#41;](directquery-mode-ssas-tabular.md).</span><span class="sxs-lookup"><span data-stu-id="8c08f-107">For more information, see [DirectQuery Mode &#40;SSAS Tabular&#41;](directquery-mode-ssas-tabular.md).</span></span>  
  
 <span data-ttu-id="8c08f-108">Sections de cette rubrique :</span><span class="sxs-lookup"><span data-stu-id="8c08f-108">Sections in this topic:</span></span>  
  
-   [<span data-ttu-id="8c08f-109">Avantages</span><span class="sxs-lookup"><span data-stu-id="8c08f-109">Benefits</span></span>](#bkmk_understanding)  
  
-   [<span data-ttu-id="8c08f-110">Attribution d’un nom à une colonne calculée</span><span class="sxs-lookup"><span data-stu-id="8c08f-110">Naming a Calculated Column</span></span>](#bkmk_naming)  
  
-   [<span data-ttu-id="8c08f-111">Performances des colonnes calculées</span><span class="sxs-lookup"><span data-stu-id="8c08f-111">Performance of Calculated Columns</span></span>](#bkmk_perf)  
  
-   [<span data-ttu-id="8c08f-112">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="8c08f-112">Related Tasks</span></span>](#bkmk_rel_tasks)  
  
##  <a name="benefits"></a><a name="bkmk_understanding"></a> <span data-ttu-id="8c08f-113">Avantages</span><span class="sxs-lookup"><span data-stu-id="8c08f-113">Benefits</span></span>  
 <span data-ttu-id="8c08f-114">Les formules dans les colonnes calculées ressemblent aux formules dans Excel.</span><span class="sxs-lookup"><span data-stu-id="8c08f-114">Formulas in calculated columns are much like formulas in Excel.</span></span> <span data-ttu-id="8c08f-115">Toutefois, contrairement à Excel, vous ne pouvez pas créer des formules différentes pour des lignes distinctes de la table ; la formule DAX est appliquée automatiquement à la colonne entière.</span><span class="sxs-lookup"><span data-stu-id="8c08f-115">Unlike Excel, however, you cannot create different formulas for different rows in a table; instead, the DAX formula is automatically applied to the entire column.</span></span>  
  
 <span data-ttu-id="8c08f-116">Lorsqu'une colonne contient une formule, la valeur est calculée pour chaque ligne.</span><span class="sxs-lookup"><span data-stu-id="8c08f-116">When a column contains a formula, the value is computed for each row.</span></span> <span data-ttu-id="8c08f-117">Les résultats sont calculés pour la colonne lorsque vous entrez une formule valide.</span><span class="sxs-lookup"><span data-stu-id="8c08f-117">The results are calculated for the column when you enter a valid formula.</span></span> <span data-ttu-id="8c08f-118">Les valeurs de colonne sont ensuite recalculées si nécessaire, par exemple lorsque les données sous-jacentes sont actualisées.</span><span class="sxs-lookup"><span data-stu-id="8c08f-118">Column values are then recalculated as necessary, such as when the underlying data is refreshed.</span></span>  
  
 <span data-ttu-id="8c08f-119">Vous pouvez également créer des colonnes calculées reposant sur des mesures ou sur d'autres colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="8c08f-119">You can create calculated columns that are based on measures and other calculated columns.</span></span> <span data-ttu-id="8c08f-120">Par exemple, vous pouvez créer une colonne calculée pour extraire un nombre d'une chaîne de texte, puis utiliser ce nombre dans une autre colonne calculée.</span><span class="sxs-lookup"><span data-stu-id="8c08f-120">For example, you might create one calculated column to extract a number from a string of text, and then use that number in another calculated column.</span></span>  
  
 <span data-ttu-id="8c08f-121">Une colonne calculée est basée sur les données qui figurent déjà dans une table existante, ou créées à l'aide d'une formule DAX.</span><span class="sxs-lookup"><span data-stu-id="8c08f-121">A calculated column is based on data that you already have in an existing table, or created by using a DAX formula.</span></span> <span data-ttu-id="8c08f-122">Par exemple, vous pouvez choisir de concaténer des valeurs, effectuer une addition, extraire des sous-chaînes ou comparer les valeurs dans d'autres champs.</span><span class="sxs-lookup"><span data-stu-id="8c08f-122">For example, you might choose to concatenate values, perform addition, extract substrings, or compare the values in other fields.</span></span> <span data-ttu-id="8c08f-123">Pour ajouter une colonne calculée, vous devez déjà disposer d'au moins une table dans votre modèle.</span><span class="sxs-lookup"><span data-stu-id="8c08f-123">To add a calculated column, you must have at least one table in your model.</span></span>  
  
 <span data-ttu-id="8c08f-124">Cet exemple illustre une formule simple dans une colonne calculée :</span><span class="sxs-lookup"><span data-stu-id="8c08f-124">This example demonstrates a simple formula in a calculated column:</span></span>  
  
```  
=EOMONTH([StartDate],0])  
  
```  
  
 <span data-ttu-id="8c08f-125">Cette formule extrait le mois de la colonne StartDate.</span><span class="sxs-lookup"><span data-stu-id="8c08f-125">This formula extracts the month from the StartDate column.</span></span> <span data-ttu-id="8c08f-126">Elle calcule ensuite la valeur de fin du mois pour chaque ligne de la table.</span><span class="sxs-lookup"><span data-stu-id="8c08f-126">It then calculates the end of the month value for each row in the table.</span></span> <span data-ttu-id="8c08f-127">Le deuxième paramètre spécifie le nombre de mois avant ou après le mois indiqué dans StartDate ; dans cette cas, 0 signifie le même mois.</span><span class="sxs-lookup"><span data-stu-id="8c08f-127">The second parameter specifies the number of months before or after the month in StartDate; in this case, 0 means the same month.</span></span> <span data-ttu-id="8c08f-128">Par exemple, si la valeur de la colonne StartDate est 1/6/2001, la valeur dans la colonne calculée sera 30/6/2001.</span><span class="sxs-lookup"><span data-stu-id="8c08f-128">For example, if the value in the StartDate column is 6/1/2001, the value in the calculated column will be 6/30/2001.</span></span>  
  
##  <a name="naming-a-calculated-column"></a><a name="bkmk_naming"></a><span data-ttu-id="8c08f-129">Attribution d’un nom à une colonne calculée</span><span class="sxs-lookup"><span data-stu-id="8c08f-129">Naming a Calculated Column</span></span>  
 <span data-ttu-id="8c08f-130">Par défaut, les nouvelles colonnes calculées sont ajoutées à droite des autres colonnes d'une table, et le nom par défaut **CalculatedColumn1**, **CalculatedColumn2**, etc. est automatiquement affecté à la colonne.</span><span class="sxs-lookup"><span data-stu-id="8c08f-130">By default, new calculated columns are added to the right of other columns in a table, and the column is automatically assigned the default name of **CalculatedColumn1**, **CalculatedColumn2**, and so forth.</span></span> <span data-ttu-id="8c08f-131">Vous pouvez également cliquer avec le bouton droit sur une colonne, puis sélectionner Insérer une colonne pour créer une nouvelle colonne entre deux colonnes existantes.</span><span class="sxs-lookup"><span data-stu-id="8c08f-131">You can also right click a column, and then click Insert Column to create a new column between two existing columns.</span></span> <span data-ttu-id="8c08f-132">Vous pouvez réorganiser les colonnes dans la même table en cliquant et en faisant glisser, et vous pouvez renommer des colonnes une fois créées ; toutefois, tenez compte des restrictions suivantes relatives aux modifications apportées aux colonnes calculées :</span><span class="sxs-lookup"><span data-stu-id="8c08f-132">You can rearrange columns within the same table by clicking and dragging, and you can rename columns after they are created; however, you should be aware of the following restrictions on changes to calculated columns:</span></span>  
  
-   <span data-ttu-id="8c08f-133">Chaque nom de colonne doit être unique à l'intérieur d'une table.</span><span class="sxs-lookup"><span data-stu-id="8c08f-133">Each column name must be unique within a table.</span></span>  
  
-   <span data-ttu-id="8c08f-134">Évitez les noms qui ont été déjà utilisés pour les mesures dans le même modèle.</span><span class="sxs-lookup"><span data-stu-id="8c08f-134">Avoid names that have already been used for measures within the same model.</span></span> <span data-ttu-id="8c08f-135">Bien qu'il soit possible qu'une colonne calculée et une mesure portent le même nom, des erreurs de calcul peuvent survenir si les noms ne sont pas uniques.</span><span class="sxs-lookup"><span data-stu-id="8c08f-135">Although it is possible for a measure and a calculated column to have the same name, if names are not unique you can get calculation errors.</span></span> <span data-ttu-id="8c08f-136">Pour éviter d'appeler une mesure par inadvertance, utilisez toujours une référence de colonne complète lorsque vous faites référence à une colonne.</span><span class="sxs-lookup"><span data-stu-id="8c08f-136">To avoid accidentally invoking a measure, when referring to a column always use a fully qualified column reference.</span></span>  
  
-   <span data-ttu-id="8c08f-137">Lorsque vous renommez une colonne calculée, toutes les formules qui s'appuient sur la colonne doivent être mises à jour manuellement.</span><span class="sxs-lookup"><span data-stu-id="8c08f-137">When you rename a calculated column, any formulas that rely on the column must be updated manually.</span></span> <span data-ttu-id="8c08f-138">À moins que vous ne soyez en mode de mise à jour manuel, la mise à jour des résultats des formules a lieu automatiquement.</span><span class="sxs-lookup"><span data-stu-id="8c08f-138">Unless you are in manual update mode, updating the results of formulas takes place automatically.</span></span> <span data-ttu-id="8c08f-139">Toutefois, cette opération peut prendre quelque temps.</span><span class="sxs-lookup"><span data-stu-id="8c08f-139">However, this operation might take some time.</span></span>  
  
-   <span data-ttu-id="8c08f-140">Certains caractères ne peuvent pas être utilisés dans les noms de colonnes.</span><span class="sxs-lookup"><span data-stu-id="8c08f-140">There are some characters that cannot be used within the names of columns.</span></span> <span data-ttu-id="8c08f-141">Pour plus d'informations, consultez « Exigences concernant l'affectation des noms » dans [DAX Syntax Specification for PowerPivot](/dax/dax-syntax-reference).</span><span class="sxs-lookup"><span data-stu-id="8c08f-141">For more information, see "Naming Requirements" in [DAX Syntax Specification for PowerPivot](/dax/dax-syntax-reference).</span></span>  
  
##  <a name="performance-of-calculated-columns"></a><a name="bkmk_perf"></a><span data-ttu-id="8c08f-142">Performances des colonnes calculées</span><span class="sxs-lookup"><span data-stu-id="8c08f-142">Performance of Calculated Columns</span></span>  
 <span data-ttu-id="8c08f-143">La formule d'une colonne calculée peut solliciter beaucoup plus de ressources que la formule utilisée pour une mesure.</span><span class="sxs-lookup"><span data-stu-id="8c08f-143">The formula for a calculated column can be more resource-intensive than the formula used for a measure.</span></span> <span data-ttu-id="8c08f-144">L'une des raisons en est que le résultat d'une colonne calculée est toujours calculé pour chaque ligne d'une table, alors qu'une mesure est calculée uniquement pour les cellules définies par le filtre utilisé dans le rapport, le tableau croisé dynamique ou le graphique croisé dynamique.</span><span class="sxs-lookup"><span data-stu-id="8c08f-144">One reason is that the result for a calculated column is always calculated for each row in a table, whereas a measure is only calculated for the cells defined by the filter used in a report, PivotTable, or PivotChart.</span></span> <span data-ttu-id="8c08f-145">Par exemple, une table d'un million de lignes aura toujours une colonne calculée avec un million de résultats et les conséquences que cela implique en termes de performances.</span><span class="sxs-lookup"><span data-stu-id="8c08f-145">For example, a table with a million rows will always have a calculated column with a million results, and a corresponding effect on performance.</span></span> <span data-ttu-id="8c08f-146">Toutefois, un tableau croisé dynamique filtre généralement les données en appliquant des titres de lignes et de colonnes ; par conséquent, une mesure est calculée uniquement pour le sous-ensemble de données dans chaque cellule du tableau croisé dynamique.</span><span class="sxs-lookup"><span data-stu-id="8c08f-146">However, a PivotTable generally filters data by applying row and column headings; therefore, a measure is calculated only for the subset of data in each cell of the PivotTable.</span></span>  
  
 <span data-ttu-id="8c08f-147">Une formule présente des dépendances vis-à-vis des objets auxquels elle fait référence, tels que d'autres colonnes ou expressions qui évaluent des valeurs.</span><span class="sxs-lookup"><span data-stu-id="8c08f-147">A formula has dependencies on the objects that are referenced in the formula, such as other columns or expressions that evaluate values.</span></span> <span data-ttu-id="8c08f-148">Par exemple, une colonne calculée qui est basée sur une autre colonne, ou un calcul qui contient une expression avec une référence de colonne, ne peuvent pas être évalués tant que l'autre colonne n'a pas été évaluée.</span><span class="sxs-lookup"><span data-stu-id="8c08f-148">For example, a calculated column that is based on another column, or a calculation that contains an expression with a column reference, cannot be evaluated until the other column is evaluated.</span></span> <span data-ttu-id="8c08f-149">Par défaut, l'actualisation automatique est activée dans les classeurs, ce qui signifie que de telles dépendances peuvent affecter les performances lorsque les valeurs sont mises à jour et les formules actualisées.</span><span class="sxs-lookup"><span data-stu-id="8c08f-149">By default, automatic refresh is enabled in workbooks; therefore, all such dependencies can affect performance while values are updated and formulas refreshed.</span></span>  
  
 <span data-ttu-id="8c08f-150">Pour éviter les problèmes de performances lorsque vous créez des colonnes calculées, suivez les instructions ci-après :</span><span class="sxs-lookup"><span data-stu-id="8c08f-150">To avoid performance issues when you create calculated columns, follow these guidelines:</span></span>  
  
-   <span data-ttu-id="8c08f-151">Plutôt que de créer une formule individuelle qui contient de nombreuses dépendances complexes, créez les formules par étapes, en enregistrant les résultats dans les colonnes, afin de pouvoir valider les résultats et évaluer les performances.</span><span class="sxs-lookup"><span data-stu-id="8c08f-151">Rather than create a single formula that contains many complex dependencies, create the formulas in steps, with results saved to columns, so that you can validate the results and assess performance.</span></span>  
  
-   <span data-ttu-id="8c08f-152">La modification de données requiert souvent un nouveau calcul des colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="8c08f-152">Modification of data will often require that calculated columns be recalculated.</span></span> <span data-ttu-id="8c08f-153">Vous pouvez éviter cela en optant pour le mode de recalcul manuel. Toutefois, si des valeurs de la colonne calculée sont erronées, la colonne sera grisée tant que vous n'aurez pas actualisé et recalculé les données.</span><span class="sxs-lookup"><span data-stu-id="8c08f-153">You can prevent this by setting the recalculation mode to manual; however, if any values in the calculated column are incorrect the column will be grayed out until you refresh and recalculate the data.</span></span>  
  
-   <span data-ttu-id="8c08f-154">Si vous modifiez ou supprimez des relations entre des tables, les formules qui utilisent des colonnes de ces tables deviennent non valides.</span><span class="sxs-lookup"><span data-stu-id="8c08f-154">If you change or delete relationships between tables, formulas that use columns in those tables will become invalid.</span></span>  
  
-   <span data-ttu-id="8c08f-155">Si vous créez une formule qui contient une dépendance circulaire ou faisant référence à elle-même, une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="8c08f-155">If you create a formula that contains a circular or self-referencing dependency, an error will occur.</span></span>  
  
##  <a name="related-tasks"></a><a name="bkmk_rel_tasks"></a> <span data-ttu-id="8c08f-156">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="8c08f-156">Related Tasks</span></span>  
  
|<span data-ttu-id="8c08f-157">Rubrique</span><span class="sxs-lookup"><span data-stu-id="8c08f-157">Topic</span></span>|<span data-ttu-id="8c08f-158">Description</span><span class="sxs-lookup"><span data-stu-id="8c08f-158">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="8c08f-159">Créer une colonne calculée &#40;SSAS Tabulaire&#41;</span><span class="sxs-lookup"><span data-stu-id="8c08f-159">Create a Calculated Column &#40;SSAS Tabular&#41;</span></span>](ssas-calculated-columns-create-a-calculated-column.md)|<span data-ttu-id="8c08f-160">Les tâches de cette rubrique décrivent comment ajouter une nouvelle colonne calculée dans une table.</span><span class="sxs-lookup"><span data-stu-id="8c08f-160">Tasks in this topic describe how to add a new calculated column to a table.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="8c08f-161">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8c08f-161">See Also</span></span>  
 <span data-ttu-id="8c08f-162">[Tables et colonnes &#40;SSAS tabulaire&#41;](tables-and-columns-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="8c08f-162">[Tables and Columns &#40;SSAS Tabular&#41;](tables-and-columns-ssas-tabular.md) </span></span>  
 <span data-ttu-id="8c08f-163">[Mesures &#40;&#41;tabulaire SSAS](measures-ssas-tabular.md) </span><span class="sxs-lookup"><span data-stu-id="8c08f-163">[Measures &#40;SSAS Tabular&#41;](measures-ssas-tabular.md) </span></span>  
 [<span data-ttu-id="8c08f-164">Calculs &#40;SSAS Tabulaire&#41;</span><span class="sxs-lookup"><span data-stu-id="8c08f-164">Calculations &#40;SSAS Tabular&#41;</span></span>](calculations-ssas-tabular.md)  
  
  
