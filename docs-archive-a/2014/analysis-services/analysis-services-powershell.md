---
title: Analysis Services PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 03/11/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 60bb9610-7229-42eb-a95f-a377268a8720
author: minewiskan
ms.author: owend
ms.openlocfilehash: 56af6f26c29e5c1ddb278b620b6f525c70bd1203
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602645"
---
# <a name="analysis-services-powershell"></a><span data-ttu-id="b3f1d-102">PowerShell Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-102">Analysis Services PowerShell</span></span>
  [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] <span data-ttu-id="b3f1d-103">inclut un fournisseur et des applets de commande PowerShell Analysis Services (SQLAS) afin que vous puissiez utiliser Windows PowerShell pour parcourir, administrer et interroger des objets Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-103">includes an Analysis Services PowerShell (SQLAS) provider and cmdlets so that you can use Windows PowerShell to navigate, administer, and query Analysis Services objects.</span></span>  
  
 <span data-ttu-id="b3f1d-104">PowerShell Analysis Services se compose des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-104">Analysis Services PowerShell consists of the following:</span></span>  
  
-   <span data-ttu-id="b3f1d-105">Fournisseur `SQLAS` utilisé pour naviguer dans la hiérarchie AMO (Analysis Management Object).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-105">`SQLAS` provider used for navigating the Analysis Management Object (AMO) hierarchy.</span></span>  
  
-   <span data-ttu-id="b3f1d-106">Applet de commande `Invoke-ASCmd` utilisé pour exécuter un script MDX, DMX ou XMLA.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-106">`Invoke-ASCmd` cmdlet used for executing MDX, DMX, or XMLA script.</span></span>  
  
-   <span data-ttu-id="b3f1d-107">Applets de commande spécifiques aux tâches pour les opérations courantes, telles que le traitement, la gestion des rôles, la gestion des partitions, la sauvegarde et la restauration.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-107">Task-specific cmdlets for routine operations, such as processing, role management, partition management, backup and restore.</span></span>  
  
## <a name="in-this-article"></a><span data-ttu-id="b3f1d-108">Dans cet article</span><span class="sxs-lookup"><span data-stu-id="b3f1d-108">In this article</span></span>  
 [<span data-ttu-id="b3f1d-109">Composants requis</span><span class="sxs-lookup"><span data-stu-id="b3f1d-109">Prerequisites</span></span>](#bkmk_prereq)  
  
 [<span data-ttu-id="b3f1d-110">Versions et modes de Analysis Services pris en charge</span><span class="sxs-lookup"><span data-stu-id="b3f1d-110">Supported Versions and Modes of Analysis Services</span></span>](#bkmk_vers)  
  
 [<span data-ttu-id="b3f1d-111">Exigences d'authentification et considérations sur la sécurité</span><span class="sxs-lookup"><span data-stu-id="b3f1d-111">Authentication Requirements and Security Considerations</span></span>](#bkmk_auth)  
  
 [<span data-ttu-id="b3f1d-112">Tâches PowerShell Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-112">Analysis Services PowerShell Tasks</span></span>](#bkmk_tasks)  

<span data-ttu-id="b3f1d-113">Pour plus d’informations sur la syntaxe et des exemples, consultez [Analysis Services de référence PowerShell](/sql/analysis-services/powershell/analysis-services-powershell-reference).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-113">For more information about syntax and examples, see [Analysis Services PowerShell Reference](/sql/analysis-services/powershell/analysis-services-powershell-reference).</span></span>

##  <a name="prerequisites"></a><a name="bkmk_prereq"></a> <span data-ttu-id="b3f1d-114">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="b3f1d-114">Prerequisites</span></span>  
 <span data-ttu-id="b3f1d-115">Windows PowerShell 2.0 doit être installé.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-115">Windows PowerShell 2.0 must be installed.</span></span> <span data-ttu-id="b3f1d-116">Il est installé par défaut sur les versions plus récentes des systèmes d'exploitation Windows.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-116">It is installed by default on newer versions of the Windows operating systems.</span></span> <span data-ttu-id="b3f1d-117">Pour plus d’informations, consultez [installer Windows PowerShell 2,0](https://msdn.microsoft.com/library/ff637750.aspx)</span><span class="sxs-lookup"><span data-stu-id="b3f1d-117">For more information, see [Install Windows PowerShell 2.0](https://msdn.microsoft.com/library/ff637750.aspx)</span></span>

<!-- ff637750.aspx above is linked to by:  (https://go.microsoft.com/fwlink/?LinkId=227613). -->
  
 <span data-ttu-id="b3f1d-118">Vous devez installer une fonctionnalité SQL Server qui inclut les bibliothèques de module et clients SQL Server PowerShell (SQLPS).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-118">You must install a SQL Server feature that includes the SQL Server PowerShell (SQLPS) module and client libraries.</span></span> <span data-ttu-id="b3f1d-119">La façon la plus simple consiste à installer SQL Server Management Studio, qui inclut automatiquement la fonctionnalité PowerShell et les bibliothèques clientes.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-119">The easiest way to do this is by installing SQL Server Management Studio, which includes the PowerShell feature and client libraries automatically.</span></span> <span data-ttu-id="b3f1d-120">Le module SQLPS (SQL Server PowerShell) contient les fournisseurs et applets de commande PowerShell pour toutes les fonctionnalités SQL Server, y compris le module SQLASCmdlets et le fournisseur SQLAS qui ajoute la prise en charge de la navigation dans la hiérarchie d'objets Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-120">The SQL Server PowerShell (SQLPS) module contains the PowerShell providers and cmdlets for all SQL Server features, including the SQLASCmdlets module and SQLAS provider used for navigating the Analysis Services object hierarchy.</span></span>  
  
 <span data-ttu-id="b3f1d-121">Vous devez importer le module **sqlps** avant de pouvoir utiliser le `SQLAS` fournisseur et les applets de commande.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-121">You must import the **SQLPS** module before you can use the `SQLAS` provider and cmdlets.</span></span> <span data-ttu-id="b3f1d-122">Le fournisseur SQLAS est une extension du `SQLServer` fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-122">The SQLAS provider is an extension of the `SQLServer` provider.</span></span> <span data-ttu-id="b3f1d-123">Il existe plusieurs façons d'importer le module SQLPS.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-123">There are several ways to import the SQLPS module.</span></span> <span data-ttu-id="b3f1d-124">Pour plus d’informations, consultez [Importer le module SQLPS](../../2014/database-engine/import-the-sqlps-module.md).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-124">For more information, see [Import the SQLPS Module](../../2014/database-engine/import-the-sqlps-module.md).</span></span>  
  
 <span data-ttu-id="b3f1d-125">L'accès à distance à une instance Analysis Services requiert l'activation de l'administration à distance et du partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-125">Remote access to an Analysis Services instance requires that you enable remote administration and file sharing.</span></span> <span data-ttu-id="b3f1d-126">Pour plus d’informations, consultez [activer l’administration à distance](#bkmk_remote) dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-126">For more information, see [Enable Remote Administration](#bkmk_remote) in this topic.</span></span>  
  
##  <a name="supported-versions-and-modes-of-analysis-services"></a><a name="bkmk_vers"></a> <span data-ttu-id="b3f1d-127">Versions et modes d'Analysis Services pris en charge</span><span class="sxs-lookup"><span data-stu-id="b3f1d-127">Supported Versions and Modes of Analysis Services</span></span>  
 <span data-ttu-id="b3f1d-128">Actuellement, PowerShell Analysis Services est pris en charge sur n'importe quelle édition de [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] Analysis Services s'exécutant sur Windows Server 2008 R2, Windows Server 2008 SP1 ou Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-128">Currently, Analysis Services PowerShell is supported on any edition of [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] Analysis Services running on Windows Server 2008 R2, Windows Server 2008 SP1, or Windows 7.</span></span>  
  
 <span data-ttu-id="b3f1d-129">Le tableau suivant montre la disponibilité de PowerShell Analysis Services dans différents contextes.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-129">The following table shows the availability of Analysis Services PowerShell in different contexts.</span></span>  
  
|<span data-ttu-id="b3f1d-130">Contexte</span><span class="sxs-lookup"><span data-stu-id="b3f1d-130">Context</span></span>|<span data-ttu-id="b3f1d-131">Disponibilité des fonctionnalités PowerShell</span><span class="sxs-lookup"><span data-stu-id="b3f1d-131">PowerShell Feature Availability</span></span>|  
|-------------|-------------------------------------|  
|<span data-ttu-id="b3f1d-132">Bases de données et instances multidimensionnelles</span><span class="sxs-lookup"><span data-stu-id="b3f1d-132">Multidimensional instances and databases</span></span>|<span data-ttu-id="b3f1d-133">Prise en charge pour l'administration locale et à distance.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-133">Supported for local and remote administration.</span></span><br /><br /> <span data-ttu-id="b3f1d-134">La fusion-partition requiert une connexion locale.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-134">Merge-partition requires a local connection.</span></span>|  
|<span data-ttu-id="b3f1d-135">Bases de données et instances tabulaires</span><span class="sxs-lookup"><span data-stu-id="b3f1d-135">Tabular instances and databases</span></span>|<span data-ttu-id="b3f1d-136">Prise en charge pour l'administration locale et à distance.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-136">Supported for local and remote administration.</span></span><br /><br /> <span data-ttu-id="b3f1d-137">Pour plus d’informations, consultez le blog d’août 2011 sur la [gestion des modèles tabulaires à l’aide de PowerShell](https://go.microsoft.com/fwlink/?linkID=227685).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-137">For more information, see an August 2011 blog about [Manage Tabular Models Using PowerShell](https://go.microsoft.com/fwlink/?linkID=227685).</span></span>|  
|<span data-ttu-id="b3f1d-138">Bases de données et instances PowerPivot pour SharePoint</span><span class="sxs-lookup"><span data-stu-id="b3f1d-138">PowerPivot for SharePoint instances and databases</span></span>|<span data-ttu-id="b3f1d-139">Prise en charge limitée.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-139">Limited support.</span></span> <span data-ttu-id="b3f1d-140">Vous pouvez utiliser des connexions HTTP et le fournisseur SQLAS pour afficher des informations d'instance et de base de données.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-140">You can use HTTP connections and the SQLAS provider to view instance and database information.</span></span><br /><br /> <span data-ttu-id="b3f1d-141">Toutefois, l'utilisation des applets de commande n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-141">However, using the cmdlets is not supported.</span></span> <span data-ttu-id="b3f1d-142">Vous ne devez pas utiliser Analysis Services PowerShell pour sauvegarder et restaurer la base de données PowerPivot en mémoire, et vous ne devez pas ajouter ou supprimer des rôles, des données de processus ni exécuter un script XMLA aléatoire.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-142">You must not use Analysis Services PowerShell to backup and restore in-memory PowerPivot database, nor should you add or remove roles, process data, or run arbitrary XMLA script.</span></span><br /><br /> <span data-ttu-id="b3f1d-143">À des fins de configuration, PowerPivot pour SharePoint a une prise en charge PowerShell intégrée qui est fournie séparément.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-143">For configuration purposes, PowerPivot for SharePoint has built-in PowerShell support that is provided separately.</span></span> <span data-ttu-id="b3f1d-144">Pour plus d’informations, consultez informations [de référence sur PowerShell pour PowerPivot pour SharePoint](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-144">For more information, see [PowerShell Reference for PowerPivot for SharePoint](/sql/analysis-services/powershell/powershell-reference-for-power-pivot-for-sharepoint).</span></span>|  
|<span data-ttu-id="b3f1d-145">Connexions natives à des cubes locaux</span><span class="sxs-lookup"><span data-stu-id="b3f1d-145">Native connections to local cubes</span></span><br /><br /> <span data-ttu-id="b3f1d-146">« Data source = c:\backup\test.CUB »</span><span class="sxs-lookup"><span data-stu-id="b3f1d-146">"Data Source=c:\backup\test.cub"</span></span>|<span data-ttu-id="b3f1d-147">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-147">Not supported.</span></span>|  
|<span data-ttu-id="b3f1d-148">Connexions HTTP aux fichiers de connexion de modèle sémantique BI (.bism) dans SharePoint</span><span class="sxs-lookup"><span data-stu-id="b3f1d-148">HTTP connections to BI semantic model (.bism) connection files in SharePoint</span></span><br /><br /> <span data-ttu-id="b3f1d-149">"Data source = http://server/shared_docs/name.bism "</span><span class="sxs-lookup"><span data-stu-id="b3f1d-149">"Data Source=http://server/shared_docs/name.bism"</span></span>|<span data-ttu-id="b3f1d-150">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-150">Not supported.</span></span>|  
|<span data-ttu-id="b3f1d-151">Connexions incorporées aux bases de données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="b3f1d-151">Embedded connections to PowerPivot databases</span></span><br /><br /> <span data-ttu-id="b3f1d-152">"Data source = $Embedded $"</span><span class="sxs-lookup"><span data-stu-id="b3f1d-152">"Data Source=$Embedded$"</span></span>|<span data-ttu-id="b3f1d-153">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-153">Not supported.</span></span>|  
|<span data-ttu-id="b3f1d-154">Contexte de serveur local dans les procédures stockées Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-154">Local server context in Analysis Services stored procedures</span></span><br /><br /> <span data-ttu-id="b3f1d-155">« Source de données = \* »</span><span class="sxs-lookup"><span data-stu-id="b3f1d-155">"Data Source=\*"</span></span>|<span data-ttu-id="b3f1d-156">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-156">Not supported.</span></span>|  
  
##  <a name="authentication-requirements-and-security-considerations"></a><a name="bkmk_auth"></a><span data-ttu-id="b3f1d-157">Exigences en matière d’authentification et considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="b3f1d-157">Authentication Requirements and Security Considerations</span></span>  
 <span data-ttu-id="b3f1d-158">Lors de la connexion à Analysis Services, vous devez utiliser une identité d'utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-158">When connecting to Analysis Services, you must make the connection using a Windows user identity.</span></span> <span data-ttu-id="b3f1d-159">Dans la plupart des cas, la connexion se fait via la sécurité intégrée Windows, où l'identité de l'utilisateur actuel définit le contexte de sécurité selon lequel les opérations du serveur sont effectuées.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-159">For the most part, a connection is made using Windows integrated security, where the identity of the current user sets the security context under which server operations are performed.</span></span> <span data-ttu-id="b3f1d-160">Toutefois, des méthodes d'authentification supplémentaires sont à votre disposition lorsque vous configurez un accès HTTP à Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-160">However, additional authentication methods become available when you configure HTTP access to Analysis Services.</span></span> <span data-ttu-id="b3f1d-161">Cette section explique de quelle façon le type de connexion détermine les options d'authentification que vous pouvez utiliser.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-161">This section explains how the type of connection determines which authentication options you can use.</span></span>  
  
 <span data-ttu-id="b3f1d-162">Les connexions à Analysis Services sont caractérisées en tant que connexions natives ou connexions HTTP.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-162">Connections to Analysis Services are characterized as either native connections or HTTP connections.</span></span> <span data-ttu-id="b3f1d-163">Une connexion native est une connexion directe entre une application cliente et le serveur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-163">A native connection is a direct connection from a client application to the server.</span></span> <span data-ttu-id="b3f1d-164">Dans une session PowerShell, le client PowerShell utilise le fournisseur OLE DB pour Analysis Services pour la connexion directe à une instance d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-164">In a PowerShell session, the PowerShell client uses the OLE DB provider for Analysis Services to connect directly to an Analysis Services instance.</span></span> <span data-ttu-id="b3f1d-165">Une connexion native s'effectue toujours via la sécurité intégrée Windows, où Analysis Services PowerShell s'exécute en tant qu'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-165">A native connection is always made using Windows integrated security, where Analysis Services PowerShell executes as the current user.</span></span> <span data-ttu-id="b3f1d-166">Analysis Services ne prend pas en charge l'emprunt d'identité.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-166">Analysis Services does not support impersonation.</span></span> <span data-ttu-id="b3f1d-167">Si vous souhaitez effectuer une opération en tant qu'utilisateur spécifique, vous devez démarrer la session PowerShell via cet utilisateur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-167">If you want to perform an operation as a specific user, you must start the PowerShell session as that user.</span></span>  
  
 <span data-ttu-id="b3f1d-168">Les connexions HTTP se font indirectement via IIS, avec des options d'authentification supplémentaires, comme l'authentification de base, pour la connexion à une instance d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-168">HTTP connections are made indirectly through IIS, allowing for additional authentication options, such as Basic authentication, to connect to an Analysis Services instance.</span></span> <span data-ttu-id="b3f1d-169">Étant donné qu'IIS prend en charge l'emprunt d'identité, vous pouvez fournir une chaîne de connexion incluant les informations d'identification qu'IIS utilisera pour l'emprunt d'identité lors de la connexion.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-169">Because IIS supports impersonation, you can provide a connection string that includes credentials IIS will use to impersonate when making a connection.</span></span> <span data-ttu-id="b3f1d-170">Pour fournir des informations d’identification, vous pouvez utiliser le paramètre-Credential.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-170">To provide credentials, you can use the -Credential parameter.</span></span>  
  
 <span data-ttu-id="b3f1d-171">**Utilisation du paramètre-Credential dans PowerShell**</span><span class="sxs-lookup"><span data-stu-id="b3f1d-171">**Using the -Credential Parameter in PowerShell**</span></span>  
  
 <span data-ttu-id="b3f1d-172">Le paramètre-Credential prend un objet PSCredential qui spécifie un nom d’utilisateur et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-172">The -Credential parameter takes a PSCredential object that specifies a user name and password.</span></span> <span data-ttu-id="b3f1d-173">Dans Analysis Services PowerShell, le paramètre-Credential est disponible pour les applets de commande qui font une demande de connexion à Analysis Services, par opposition aux cmdlets qui s’exécutent dans le contexte d’une connexion existante.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-173">In Analysis Services PowerShell, the -Credential parameter is available for cmdlets that make a connection request to Analysis Services, as opposed to cmdlets that run within the context of an existing connection.</span></span> <span data-ttu-id="b3f1d-174">Les applets de commande qui créent une requête de connexion incluent Invoke-ASCmd, Backup-ASDatabase et Restore-ASDatabase.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-174">Cmdlets that make a connection request include Invoke-ASCmd, Backup-ASDatabase, and Restore-ASDatabase.</span></span> <span data-ttu-id="b3f1d-175">Pour ces applets de commande, le paramètre-Credential peut être utilisé, en supposant que les critères suivants sont satisfaits :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-175">For these cmdlets, the -Credential parameter can be used, assuming the following criteria are met:</span></span>  
  
1.  <span data-ttu-id="b3f1d-176">Le serveur est configuré pour l'accès HTTP, ce qui signifie qu'IIS gère la connexion, lit le nom d'utilisateur et le mot de passe et emprunte l'identité de l'utilisateur lors de la connexion à Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-176">The server is configured for HTTP access, which means that IIS handles the connection, reads the user name and password, and impersonates that user identity when connecting to Analysis Services.</span></span> <span data-ttu-id="b3f1d-177">Pour plus d’informations, consultez [Configurer l’accès HTTP à Analysis Services sur Internet Information Services &#40;IIS&#41; 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-177">For more information, see [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md).</span></span>  
  
2.  <span data-ttu-id="b3f1d-178">Le répertoire virtuel IIS qui a été créé pour l'accès HTTP à Analysis Services est configuré pour l'authentification de base.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-178">The IIS virtual directory that was created for Analysis Services HTTP access is configured for Basic authentication.</span></span>  
  
3.  <span data-ttu-id="b3f1d-179">Le nom d'utilisateur et le mot de passe fournis par l'objet contenant les informations d'identification retournent une identité d'utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-179">The user name and password provided by the credential object resolves to a Windows user identity.</span></span> <span data-ttu-id="b3f1d-180">Analysis Services utilise cette identité pour l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-180">Analysis Services uses this identity as the current user.</span></span> <span data-ttu-id="b3f1d-181">Si l'utilisateur n'est pas un utilisateur Windows, ou ne dispose pas d'autorisations suffisantes pour effectuer l'opération demandée, la requête échouera.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-181">If the user is not a Windows user, or lacks sufficient permissions to perform the requested operation, the request will fail.</span></span>  
  
 <span data-ttu-id="b3f1d-182">Pour créer un objet contenant des informations d'identification, vous pouvez utiliser l'applet de commande Get-Credential pour collecter des informations auprès de l'opérateur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-182">To create a credential object, you can use the Get-Credential cmdlet to collect the credentials from the operator.</span></span> <span data-ttu-id="b3f1d-183">Vous pouvez ensuite utiliser l'objet contenant les informations d'identification sur une commande qui se connecte à Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-183">You can then use the credential object on a command that connects to Analysis Services.</span></span> <span data-ttu-id="b3f1d-184">L'exemple suivant illustre une approche.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-184">The following example illustrates one approach.</span></span> <span data-ttu-id="b3f1d-185">Dans cet exemple, la connexion concerne une instance locale ( `SQLSERVER:\SQLAS\HTTP_DS` ) configurée pour l’accès http.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-185">In this example, the connection is to a local instance (`SQLSERVER:\SQLAS\HTTP_DS`) configured for HTTP access.</span></span>  
  
```powershell
$cred = Get-Credential adventureworks\dbadmin  
Invoke-ASCmd -Inputfile:"c:\discoverconnections.xmla" -Credential:$cred  
```  
  
 <span data-ttu-id="b3f1d-186">Lorsque vous utilisez l'authentification de base, vous devez toujours utiliser HTTPS avec SSL afin que le nom d'utilisateur et mot de passe soient envoyés sur une connexion chiffrée.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-186">When using Basic authentication, you should always use HTTPS with SSL so that username and passwords are sent over an encrypted connection.</span></span> <span data-ttu-id="b3f1d-187">Pour plus d’informations, consultez [configurer des protocole SSL dans iis 7,0](https://go.microsoft.com/fwlink/?linkID=184299) et [configurer l’authentification de base (IIS 7)](https://go.microsoft.com/fwlink/?LinkId=230776).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-187">For more information, see [Configure Secure Sockets Layer in IIS 7.0](https://go.microsoft.com/fwlink/?linkID=184299) and [Configure Basic Authentication (IIS 7)](https://go.microsoft.com/fwlink/?LinkId=230776).</span></span>  
  
 <span data-ttu-id="b3f1d-188">Souvenez-vous que les informations d'identification, les requêtes et les commandes que vous fournissez dans PowerShell sont transmises sans modification à la couche de transport.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-188">Remember that credentials, queries, and commands that you provide in PowerShell are passed unchanged to the transport layer.</span></span> <span data-ttu-id="b3f1d-189">Notamment, le contenu sensible dans vos scripts augmente le risque d'une attaque par injection malveillante.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-189">Including sensitive content in your scripts increases the risk of a malicious injection attack.</span></span>  
  
 <span data-ttu-id="b3f1d-190">**Mot de passe en tant qu'objet Microsoft.Secure.String**</span><span class="sxs-lookup"><span data-stu-id="b3f1d-190">**Providing a password as a Microsoft.Secure.String object**</span></span>  
  
 <span data-ttu-id="b3f1d-191">Certaines opérations, comme la sauvegarde et la restauration, prennent en charge des options de chiffrement qui sont activées lorsque vous fournissez un mot de passe dans la commande.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-191">Some operations, such as backup and restore, support encryption options that are activated when you provide a password in the command.</span></span> <span data-ttu-id="b3f1d-192">Le mot de passe fourni indique à Analysis Services de chiffrer ou déchiffrer le fichier de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-192">Providing the password signals Analysis Services to encrypt or decrypt the backup file.</span></span> <span data-ttu-id="b3f1d-193">Dans Analysis Services, le mot de passe est instancié en tant qu'objet de chaîne sécurisée.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-193">In Analysis Services, this password is instantiated as a secure string object.</span></span> <span data-ttu-id="b3f1d-194">L'exemple suivant illustre l'utilisation de ce paramètre pour collecter un mot de passe de l'opérateur à l'exécution.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-194">The following example provides an illustration of how to collect a password from the operator at run time.</span></span>  
  
```powershell
$pwd = read-host -AsSecureString -Prompt "Password"  
$pwd -is [System.IDisposable]  
```  
  
 <span data-ttu-id="b3f1d-195">Vous pouvez maintenant sauvegarder ou restaurer un fichier de base de données chiffré, en passant la variable $pwd au paramètre de mot de passe.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-195">You can now backup or restore an encrypted database file, passing the $pwd variable to the password parameter.</span></span> <span data-ttu-id="b3f1d-196">Pour afficher un exemple complet qui combine cette illustration avec d’autres applets de commande, consultez applet de commande [Backup-ASDatabase](/powershell/module/sqlserver/backup-asdatabase) et applet de commande [Restore-ASDatabase](/powershell/module/sqlserver/restore-asdatabase).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-196">To view a complete example that combines this illustration with other cmdlets, see [Backup-ASDatabase cmdlet](/powershell/module/sqlserver/backup-asdatabase) and [Restore-ASDatabase cmdlet](/powershell/module/sqlserver/restore-asdatabase).</span></span>
  
 <span data-ttu-id="b3f1d-197">Comme étape finale, supprimez le mot de passe et la variable de la session.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-197">As a follow up step, remove both the password and variable from the session.</span></span>  
  
```powershell
$pwd.Dispose()  
Remove-Variable -Name pwd  
```  
  
##  <a name="analysis-services-powershell-tasks"></a><a name="bkmk_tasks"></a><span data-ttu-id="b3f1d-198">Tâches Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="b3f1d-198">Analysis Services PowerShell Tasks</span></span>  
 <span data-ttu-id="b3f1d-199">Vous pouvez exécuter PowerShell Analysis Services à partir du shell de gestion Windows PowerShell ou d'une invite de commandes Windows.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-199">You can run Analysis Services PowerShell from the Windows PowerShell management shell or a Windows command prompt.</span></span> <span data-ttu-id="b3f1d-200">L'exécution d'Analysis Services PowerShell à partir de [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-200">Running Analysis Services PowerShell from [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)] is not supported.</span></span>  
  
 <span data-ttu-id="b3f1d-201">Cette section décrit les tâches courantes pour l'utilisation de PowerShell Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-201">This section describes common tasks for using Analysis Services PowerShell.</span></span>  
  
-   [<span data-ttu-id="b3f1d-202">Charger le fournisseur et les applets de commande Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-202">Load the Analysis Services Provider and Cmdlets</span></span>](#bkmk_load)  
  
-   [<span data-ttu-id="b3f1d-203">Activer l'administration à distance</span><span class="sxs-lookup"><span data-stu-id="b3f1d-203">Enable Remote Administration</span></span>](#bkmk_remote)  
  
-   [<span data-ttu-id="b3f1d-204">Se connecter à un objet Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-204">Connect to an Analysis Services Object</span></span>](#bkmk_connect)  
  
-   [<span data-ttu-id="b3f1d-205">Administrer le service</span><span class="sxs-lookup"><span data-stu-id="b3f1d-205">Administer the Service</span></span>](#bkmk_admin)  
  
-   [<span data-ttu-id="b3f1d-206">Obtenir de l'aide pour PowerShell Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-206">Get Help for Analysis Services PowerShell</span></span>](#bkmk_help)  
  
###  <a name="load-the-analysis-services-provider-and-cmdlets"></a><a name="bkmk_load"></a><span data-ttu-id="b3f1d-207">Charger le fournisseur et les applets de commande Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-207">Load the Analysis Services Provider and Cmdlets</span></span>  
 <span data-ttu-id="b3f1d-208">Le fournisseur Analysis Services est une extension du fournisseur racine SQL Server qui devient disponible lorsque vous importez le module SQLPS.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-208">The Analysis Services provider is an extension of the SQL Server root provider that becomes available when you import the SQLPS module.</span></span> <span data-ttu-id="b3f1d-209">Les applets de commande Analysis Services sont chargés simultanément ; vous pouvez également les charger indépendamment si vous souhaitez les utiliser sans le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-209">Analysis Services cmdlets are loaded simultaneously; you can also load them independently if you want to use them without the provider.</span></span>  
  
-   <span data-ttu-id="b3f1d-210">Exécutez l'applet de commande Import-module pour charger SQLPS qui inclut toutes les fonctionnalités PowerShell Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-210">Run the Import-module cmdlet to load SQLPS that includes all of the Analysis Services PowerShell functionality.</span></span> <span data-ttu-id="b3f1d-211">Si vous ne pouvez pas importer le module, vous pouvez temporairement utiliser une stratégie d'exécution sans restriction afin de charger le module.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-211">If you cannot import the module, you can temporarily change the execution policy to unrestricted for the purpose of the loading the module.</span></span> <span data-ttu-id="b3f1d-212">Pour plus d’informations, consultez [Importer le module SQLPS](../../2014/database-engine/import-the-sqlps-module.md).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-212">For more information, see [Import the SQLPS Module](../../2014/database-engine/import-the-sqlps-module.md).</span></span>  
  
    ```powershell
    Import-Module "sqlps"  
    ```  
  
     <span data-ttu-id="b3f1d-213">Sinon, utilisez `import-module "sqlps" -disablenamechecking` pour supprimer l'avertissement concernant les noms de verbe non approuvés.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-213">Alternatively, use `import-module "sqlps" -disablenamechecking` to suppress the warning about unapproved verb names.</span></span>  
  
-   <span data-ttu-id="b3f1d-214">Pour charger uniquement les applets de commande Analysis Services spécifiques à une tâche, sans le fournisseur Analysis Services ou l'applet de commande Invoke-ASCmd, vous pouvez charger le module SQLASCmdlets comme opération indépendante.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-214">To load just the task-specific Analysis Services cmdlets, without the Analysis Services provider or the Invoke-ASCmd cmdlet, you can load the SQLASCmdlets module as an independent operation.</span></span>  
  
    ```powershell
    Import-Module "sqlascmdlets"  
    ```  
  
###  <a name="enable-remote-administration"></a><a name="bkmk_remote"></a><span data-ttu-id="b3f1d-215">Activer l’administration à distance</span><span class="sxs-lookup"><span data-stu-id="b3f1d-215">Enable Remote Administration</span></span>  
 <span data-ttu-id="b3f1d-216">Avant de pouvoir utiliser PowerShell Analysis Services avec une instance Analysis Services distante, vous devez d'abord activer l'administration à distance et le partage de fichiers.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-216">Before you can use Analysis Services PowerShell with a remote Analysis Services instance, you must first enable remote administration and file sharing.</span></span> <span data-ttu-id="b3f1d-217">L’erreur suivante indique un problème de configuration du pare-feu : «le serveur RPC n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-217">The following error indicates a firewall configuration issue: "The RPC server is unavailable.</span></span> <span data-ttu-id="b3f1d-218">(Exception de HRESULT : 0x800706BA) ».</span><span class="sxs-lookup"><span data-stu-id="b3f1d-218">(Exception from HRESULT: 0x800706BA)".</span></span>  
  
1.  <span data-ttu-id="b3f1d-219">Vérifiez que les ordinateurs local et distant ont tous deux les versions [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] des outils clients et serveur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-219">Verify that both local and remote computers have the [!INCLUDE[ssASCurrent](../includes/ssascurrent-md.md)] versions of the client and server tools.</span></span>  
  
2.  <span data-ttu-id="b3f1d-220">Sur le serveur distant qui héberge une instance Analysis Services, ouvrez le port TCP 2383 dans le Pare-feu Windows.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-220">On the remote server that is hosting an Analysis Services instance, open TCP port 2383 in Windows Firewall.</span></span> <span data-ttu-id="b3f1d-221">Si vous avez installé Analysis Services comme instance nommée ou utilisez un port personnalisé, le numéro de port sera différent.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-221">If you installed Analysis Services as a named instance or are using a custom port, the port number will be different.</span></span> <span data-ttu-id="b3f1d-222">Pour plus d’informations, consultez [Configure the Windows Firewall to Allow Analysis Services Access](instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-222">For more information, see [Configure the Windows Firewall to Allow Analysis Services Access](instances/configure-the-windows-firewall-to-allow-analysis-services-access.md).</span></span>  
  
3.  <span data-ttu-id="b3f1d-223">Sur le serveur distant, vérifiez que les services suivants sont démarrés : service d'appel de procédure distante (RPC), service d'assistance TCP/IP NetBIOS, service WMI (Windows Management Instrumentation), service Gestion à distance de Windows (Gestion WSM).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-223">On the remote server, verify that the followings services are started:  Remote Procedure Call (RPC) service, TCP/IP NetBIOS Helper service, Windows Management Instrumentation (WMI) service, Windows Remote Management (WS-Management) service.</span></span>  
  
4.  <span data-ttu-id="b3f1d-224">Sur le serveur distant, démarrez le composant logiciel enfichable Éditeur d'objets de stratégie de groupe (gpedit.msc).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-224">On the remote server, start the Group Policy Object Editor snap-in (gpedit.msc).</span></span>  
  
5.  <span data-ttu-id="b3f1d-225">Ouvrez Configuration ordinateur, Modèles d'administration, Réseau, Connexions réseau, Pare-feu Windows, puis Profil de domaine.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-225">Open Computer Configuration, open Administrative Templates, open Network, open Network Connections, open Windows Firewall, and then open Domain Profile.</span></span>  
  
6.  <span data-ttu-id="b3f1d-226">Double-cliquez sur **pare-feu Windows : autoriser l’exception d’administration à distance entrante**, sélectionnez **activé**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-226">Double-click **Windows Firewall: Allow inbound remote administration exception**, select **Enabled**, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="b3f1d-227">Double-cliquez sur **pare-feu Windows : autoriser l’exception de partage de fichiers entrants et d’imprimantes**, sélectionnez **activé**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-227">Double-click **Windows Firewall: Allow inbound file and printer sharing exception**, select **Enabled**, and then click **OK**.</span></span>  
  
8.  <span data-ttu-id="b3f1d-228">Sur l’ordinateur local qui contient les outils clients, utilisez les applets de commande suivantes pour vérifier l’administration à distance, en remplaçant le nom de serveur réel de l’espace réservé de *nom de serveur distant* .</span><span class="sxs-lookup"><span data-stu-id="b3f1d-228">On the local computer that has the client tools, use the following cmdlets to verify remote administration, substituting the actual server name for the *remote-server-name* placeholder.</span></span> <span data-ttu-id="b3f1d-229">Omettez le nom de l'instance si Analysis Services est installé comme instance par défaut.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-229">Omit the instance name if Analysis Services is installed as the default instance.</span></span> <span data-ttu-id="b3f1d-230">Vous devez avoir déjà importé le module SQLPS pour que la commande fonctionne.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-230">You must have previously imported the SQLPS module in order for the command to work.</span></span>  
  
    ```
    PS SQLSERVER:\> cd sqlas
    PS SQLSERVER:\sqlas> cd <remote-server-name\instance-name>  
    PS SQLSERVER:\sqlas\<remote-server-name\instance-name> dir  
    ```  
  
 <span data-ttu-id="b3f1d-231">Dans certains cas, une configuration supplémentaire peut être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-231">In some cases, additional configuration might be necessary.</span></span> <span data-ttu-id="b3f1d-232">Vous devrez peut-être taper ce qui suit sur le serveur distant avant de pouvoir lui fournir des commandes à partir d'un autre ordinateur :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-232">You might need to type the following on the remote server before you can issue commands to it from another computer:</span></span>  
  
```powershell
Enable-PSRemoting  
```  
  
  
###  <a name="connect-to-an-analysis-services-object"></a><a name="bkmk_connect"></a><span data-ttu-id="b3f1d-233">Se connecter à un objet Analysis Services</span><span class="sxs-lookup"><span data-stu-id="b3f1d-233">Connect to an Analysis Services Object</span></span>  
 <span data-ttu-id="b3f1d-234">Le fournisseur PowerShell Analysis Services prend en charge la navigation de la hiérarchie d'objets Analysis Services et définit le contexte pour l'exécution de commandes.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-234">The Analysis Services PowerShell provider supports navigation of the Analysis Services object hierarchy and sets the context for running commands.</span></span> <span data-ttu-id="b3f1d-235">Le fournisseur est une extension du fournisseur racine SQLSERVER disponible par le module SQLPS.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-235">The provider is an extension of the SQLSERVER root provider available through the SQLPS module.</span></span> <span data-ttu-id="b3f1d-236">Après avoir chargé le module SQLPS, vous pouvez naviguer dans le chemin d'accès.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-236">After you load the SQLPS module, you can navigate the path.</span></span>  
  
 <span data-ttu-id="b3f1d-237">Vous pouvez vous connecter à une instance locale ou distante, mais certains applets de commande sont exécutés uniquement sur une instance locale (à savoir, merge-partition).</span><span class="sxs-lookup"><span data-stu-id="b3f1d-237">You can connect to a local or remote instance, but some cmdlets only run on a local instance (namely, merge-partition).</span></span> <span data-ttu-id="b3f1d-238">Vous pouvez utiliser une connexion native ou une connexion HTTP pour les serveurs Analysis Services que vous avez configurés pour l'accès HTTP.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-238">You can use a native connection or an HTTP connection for Analysis Services servers that you configured for HTTP access.</span></span> <span data-ttu-id="b3f1d-239">Les illustrations suivantes montrent le chemin de navigation pour les connexions native et HTTP.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-239">The following illustrations show the navigation path for native and HTTP connections.</span></span> <span data-ttu-id="b3f1d-240">Les illustrations suivantes montrent le chemin de navigation pour les connexions native et HTTP.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-240">The following illustrations show the navigation path for native and HTTP connections.</span></span>  
  
 <span data-ttu-id="b3f1d-241">**Connexions natives à Analysis Services**</span><span class="sxs-lookup"><span data-stu-id="b3f1d-241">**Native Connections to Analysis Services**</span></span>  
  
 <span data-ttu-id="b3f1d-242">![Connexion native à Analysis Services](media/ssas-powershell-nativeconnection.gif "Connexion native à Analysis Services")</span><span class="sxs-lookup"><span data-stu-id="b3f1d-242">![Native connection to Analysis Services](media/ssas-powershell-nativeconnection.gif "Native connection to Analysis Services")</span></span>  
  
 <span data-ttu-id="b3f1d-243">L'exemple suivant montre comment utiliser une connexion native pour naviguer dans la hiérarchie d'objets.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-243">The following example is a demonstration of how to use a native connection to navigate object hierarchy.</span></span> <span data-ttu-id="b3f1d-244">À partir du fournisseur, vous pouvez émettre `dir` pour afficher les informations d'instance.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-244">From the provider, you can issue a `dir` to view instance information.</span></span> <span data-ttu-id="b3f1d-245">Vous pouvez utiliser `cd` pour afficher les objets de cette instance.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-245">You can use `cd` to view objects of that instance.</span></span>  
  
```  
PS SQLSERVER:> cd sqlas  
PS SQLSERVER\sqlas:> dir  
PS SQLSERVER\sqlas:> cd localhost\default  
PS SQLSERVER\sqlas\localhost\default:> dir  
```  
  
 <span data-ttu-id="b3f1d-246">Vous devez voir les collections suivantes : Assemblies, Databases, Roles et Traces.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-246">You should see the following collections: Assemblies, Databases, Roles, and Traces.</span></span> <span data-ttu-id="b3f1d-247">En continuant à utiliser `cd` et `dir`, vous pouvez afficher le contenu de chaque collection.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-247">Continuing to use `cd` and `dir`, you can view the contents of each collection.</span></span>  
  
 <span data-ttu-id="b3f1d-248">**Connexions HTTP à Analysis Services**</span><span class="sxs-lookup"><span data-stu-id="b3f1d-248">**HTTP Connections to Analysis Services**</span></span>  
  
 <span data-ttu-id="b3f1d-249">![Connexion HTTP à Analysis Services](media/ssas-powershell-httpconnection.gif "Connexion HTTP à Analysis Services")</span><span class="sxs-lookup"><span data-stu-id="b3f1d-249">![HTTP Connection to Analysis Services](media/ssas-powershell-httpconnection.gif "HTTP Connection to Analysis Services")</span></span>  
  
 <span data-ttu-id="b3f1d-250">Les connexions HTTP sont utiles si vous avez configuré votre serveur pour l’accès HTTP à l’aide des instructions de cette rubrique : [configurer l’accès http à Analysis Services sur Internet Information Services &#40;IIS&#41; 8,0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)</span><span class="sxs-lookup"><span data-stu-id="b3f1d-250">HTTP connections are useful if you configured your server for HTTP access using the instructions in this topic: [Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)</span></span>  
  
 <span data-ttu-id="b3f1d-251">En supposant une URL de serveur de http://localhost/olap/msmdpump.dll , une connexion peut se présenter comme suit :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-251">Assuming a server URL of http://localhost/olap/msmdpump.dll, a connection might look like the following:</span></span>  
  
```  
PS SQLSERVER\sqlas:> cd http_ds  
PS SQLSERVER\sqlas\http_ds:> $Url=Encode-SqlName "http://localhost/olap/msmdpump.dll"  
PS SQLSERVER\sqlas\http_ds:> cd $Url  
PS SQLSERVER\sqlas\http_ds\http%3A%2F%2Flocalhost%2olap%2msmdpump%2Edll:> dir  
```  
  
 <span data-ttu-id="b3f1d-252">Vous devez voir les collections suivantes : Assemblies, Databases, Roles et Traces.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-252">You should see the following collections: Assemblies, Databases, Roles, and Traces.</span></span> <span data-ttu-id="b3f1d-253">Si vous ne pouvez pas afficher le contenu de ces collections, vérifiez les paramètres d'authentification dans le répertoire virtuel OLAP.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-253">If you cannot view the contents of these collections, check the authentication settings on the OLAP virtual directory.</span></span> <span data-ttu-id="b3f1d-254">Vérifiez que l'accès anonyme est désactivé.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-254">Make sure that Anonymous Access is disabled.</span></span> <span data-ttu-id="b3f1d-255">Si vous utilisez l'authentification Windows, assurez-vous que votre compte d'utilisateur Windows dispose d'autorisations d'administrateur sur l'instance Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-255">If you are using Windows Authentication, be sure that your Windows user account has administrative permissions on the Analysis Services instance.</span></span>  
  
###  <a name="administer-the-service"></a><a name="bkmk_admin"></a><span data-ttu-id="b3f1d-256">Administrer le service</span><span class="sxs-lookup"><span data-stu-id="b3f1d-256">Administer the Service</span></span>  
 <span data-ttu-id="b3f1d-257">Vérifiez que le service est en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-257">Verify the service is running.</span></span> <span data-ttu-id="b3f1d-258">Retourne l'état, le nom et le nom complet pour les services SQL Server, notamment Analysis Services (MSSQLServerOLAPService) et le moteur de base de données.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-258">Returns status, name, and display name for SQL Server services, including Analysis Services (MSSQLServerOLAPService) and the Database Engine.</span></span>  
  
```powershell
Get-Service mssql*  
```  
  
 <span data-ttu-id="b3f1d-259">Retourne les propriétés d'un processus, y compris l'ID de processus, le nombre de handles et l'utilisation de la mémoire :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-259">Returns properties about a process, including process ID, handle count, and memory usage:</span></span>  
  
```powershell
Get-Process msmdsrv  
```  
  
 <span data-ttu-id="b3f1d-260">Redémarre le service lorsque vous émettez l'applet de commande suivant à partir du shell d'administrateur :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-260">Restarts the service when you issue the following cmdlet from the administrator shell:</span></span>  
  
```powershell
Restart-Service mssqlserverolapservice  
```  
  
###  <a name="get-help-for-analysis-services-powershell"></a><a name="bkmk_help"></a><span data-ttu-id="b3f1d-261">Obtenir de l’aide pour Analysis Services PowerShell</span><span class="sxs-lookup"><span data-stu-id="b3f1d-261">Get Help for Analysis Services PowerShell</span></span>  
 <span data-ttu-id="b3f1d-262">Utilisez l'un des applets de commande suivants pour vérifier la disponibilité des applets de commande et pour obtenir plus d'informations sur les services, processus et objets.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-262">Use any of the following cmdlets to verify cmdlet availability and to get more information about services, processes, and objects.</span></span>  
  
1.  <span data-ttu-id="b3f1d-263">`Get-Help` retourne l'aide intégrée pour un applet de commande Analysis Services, notamment des exemples :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-263">`Get-Help` returns the built-in help for an Analysis Services cmdlet, including examples:</span></span>  
  
    ```powershell
    Get-Help invoke-ascmd -Examples  
    ```  
  
2.  <span data-ttu-id="b3f1d-264">`Get-Command` retourne une liste des onze applets de commande PowerShell Analysis Services :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-264">`Get-Command` returns a list of the eleven Analysis Services PowerShell cmdlets:</span></span>  
  
    ```powershell
    Get-Command -module SQLASCmdlets  
    ```  
  
3.  <span data-ttu-id="b3f1d-265">`Get-Member` retourne des propriétés ou des méthodes d'un service ou processus.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-265">`Get-Member` returns properties or methods of a service or process.</span></span>  
  
    ```powershell
    Get-Service mssqlserverolapservice | Get-Member -Type Property  
    ```  
  
    ```powershell
    Get-Service mssqlserverolapservice | Get-Member -Type Method  
    ```  
  
    ```powershell
    Get-Process msmdsrv | Get-Member -Type Property  
    ```  
  
4.  <span data-ttu-id="b3f1d-266">`Get-Member` peut également être utilisé pour retourner des propriétés ou des méthodes d'un objet (par exemple, les méthodes AMO sur l'objet serveur) à l'aide du fournisseur SQLAS pour spécifier l'instance de serveur.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-266">`Get-Member` can also be used to return properties or methods of an object (for example, AMO methods on the server object) using the SQLAS provider to specify the server instance.</span></span>  
  
    ```
    PS SQLSERVER:\sqlas\localhost\default > $serverObj = New-Object Microsoft.AnalysisServices.Server  
    PS SQLSERVER:\sqlas\localhost\default > $serverObj = | Get-Member -Type Method  
    ```  
  
5.  <span data-ttu-id="b3f1d-267">`Get-PSdrive` retourne la liste des fournisseurs qui sont actuellement installés.</span><span class="sxs-lookup"><span data-stu-id="b3f1d-267">`Get-PSdrive` returns a list of the providers that are currently installed.</span></span> <span data-ttu-id="b3f1d-268">Si vous avez importé le module SQLPS, le fournisseur `SQLServer` s'affiche dans la liste (SQLAS fait partie du fournisseur SQLServer et n'apparaît jamais séparément dans la liste) :</span><span class="sxs-lookup"><span data-stu-id="b3f1d-268">If you imported the SQLPS module, you will see the `SQLServer` provider in the list (SQLAS is part of the SQLServer provider and never appears separately in the list):</span></span>  
  
    ```powershell
    Get-PSDrive  
    ```  
  
## <a name="see-also"></a><span data-ttu-id="b3f1d-269">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b3f1d-269">See Also</span></span>  
 <span data-ttu-id="b3f1d-270">[Installer SQL Server PowerShell](../database-engine/install-windows/install-sql-server-powershell.md) </span><span class="sxs-lookup"><span data-stu-id="b3f1d-270">[Install SQL Server PowerShell](../database-engine/install-windows/install-sql-server-powershell.md) </span></span>  
 <span data-ttu-id="b3f1d-271">[Gérer les modèles tabulaires à l’aide de PowerShell (blog)](https://go.microsoft.com/fwlink/?linkID=227685) </span><span class="sxs-lookup"><span data-stu-id="b3f1d-271">[Manage Tabular Models Using PowerShell (blog)](https://go.microsoft.com/fwlink/?linkID=227685) </span></span>  
 [<span data-ttu-id="b3f1d-272">Configurer l’accès HTTP à Analysis Services sur Internet Information Services &#40;IIS&#41; 8.0</span><span class="sxs-lookup"><span data-stu-id="b3f1d-272">Configure HTTP Access to Analysis Services on Internet Information Services &#40;IIS&#41; 8.0</span></span>](instances/configure-http-access-to-analysis-services-on-iis-8-0.md)  
  
  
