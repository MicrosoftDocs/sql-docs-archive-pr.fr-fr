---
title: Calculs | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: reference
helpviewer_keywords:
- calculations [Analysis Services]
- OLAP objects [Analysis Services], calculations
- MDX [Analysis Services], calculations
- calculations [Analysis Services], about calculations
- cubes [Analysis Services], calculations
ms.assetid: 6be84916-fd05-4efc-ab98-6adbbad80154
author: minewiskan
ms.author: owend
ms.openlocfilehash: 4457a5fa434be3865edf770f7ca69a676c051893
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706895"
---
# <a name="calculations"></a><span data-ttu-id="ea692-102">Calculs</span><span class="sxs-lookup"><span data-stu-id="ea692-102">Calculations</span></span>
  <span data-ttu-id="ea692-103">Un calcul est une expression MDX (Multidimensional Expressions) ou un script qui est utilisé pour définir un membre calculé, un jeu nommé ou une assignation d’étendue dans un cube dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ea692-103">A calculation is a Multidimensional Expressions (MDX) expression or script that is used to define a calculated member, a named set, or a scoped assignment in a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="ea692-104">Les calculs vous permettent d'ajouter des objets définis non pas par les données du cube, mais par des expressions qui peuvent référencer d'autres parties du cube, d'autres cubes voire des informations à l'extérieur de la base de données [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ea692-104">Calculations let you add objects that are defined not by the data of the cube, but by expressions that can reference other parts of the cube, other cubes, or even information outside the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="ea692-105">Les calculs vous permettent d'étendre les capacités d'un cube, en renforçant la flexibilité et la puissance des applications de décisionnel.</span><span class="sxs-lookup"><span data-stu-id="ea692-105">Calculations let you extend the capabilities of a cube, adding flexibility and power to business intelligence applications.</span></span> <span data-ttu-id="ea692-106">Pour plus d’informations sur les calculs de script, consultez [Introduction aux scripts MDX dans Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span><span class="sxs-lookup"><span data-stu-id="ea692-106">For more information about scripting calculations, see [Introduction to MDX Scripting in Microsoft SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=81892).</span></span> <span data-ttu-id="ea692-107">Pour plus d’informations sur les problèmes de performances liés aux calculs et aux requêtes MDX, consultez le [Guide des performances SQL Server 2005 Analysis Services](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span><span class="sxs-lookup"><span data-stu-id="ea692-107">For more information about performance issues related to MDX queries and calculations, see the [SQL Server 2005 Analysis Services Performance Guide](https://docsbay.net/Microsoft-SQL-Server-2005-Analysis-Services-Performance-Guide).</span></span>  
  
## <a name="calculated-members"></a><span data-ttu-id="ea692-108">Membres calculés</span><span class="sxs-lookup"><span data-stu-id="ea692-108">Calculated Members</span></span>  
 <span data-ttu-id="ea692-109">Un membre calculé est un membre dont la valeur est calculée au moment de l'exécution en utilisant une expression MDX (Multidimensional Expressions) que vous spécifiez lorsque vous définissez le membre calculé.</span><span class="sxs-lookup"><span data-stu-id="ea692-109">A calculated member is a member whose value is calculated at run time using a Multidimensional Expressions (MDX) expression that you specify when you define the calculated member.</span></span> <span data-ttu-id="ea692-110">Un membre calculé est disponible pour les applications de décisionnel comme n'importe quel autre membre.</span><span class="sxs-lookup"><span data-stu-id="ea692-110">A calculated member is available to business intelligence applications just like any other member.</span></span> <span data-ttu-id="ea692-111">Les membres calculés n'augmentent pas la taille du cube, car seules les définitions sont stockées dans le cube ; les valeurs sont calculées dans la mémoire lorsqu'il faut répondre à une requête.</span><span class="sxs-lookup"><span data-stu-id="ea692-111">Calculated members do not increase the size of the cube because only the definitions are stored in the cube; values are calculated in memory as required to answer a query.</span></span>  
  
 <span data-ttu-id="ea692-112">Les membres calculés peuvent être définis pour n'importe quelle dimension, y compris la dimension de mesures.</span><span class="sxs-lookup"><span data-stu-id="ea692-112">Calculated members can be defined for any dimension, including the measures dimension.</span></span> <span data-ttu-id="ea692-113">Les membres calculés créés sur la dimension de mesures sont appelés mesures calculées.</span><span class="sxs-lookup"><span data-stu-id="ea692-113">Calculated members created on the Measures dimension are called calculated measures.</span></span>  
  
 <span data-ttu-id="ea692-114">Bien que les membres calculés reposent généralement sur les données qui existent déjà dans le cube, vous pouvez créer des expressions complexes en combinant les données avec des opérateurs arithmétiques, des nombres et des fonctions.</span><span class="sxs-lookup"><span data-stu-id="ea692-114">Although calculated members are typically based on data that already exists in the cube, you can create complex expressions by combining data with arithmetic operators, numbers, and functions.</span></span> <span data-ttu-id="ea692-115">Vous pouvez également utiliser des fonctions MDX, telles que LookupCube, pour accéder aux données d'autres cubes de la base de données [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ea692-115">You can also use MDX functions, such as LookupCube, to access data in other cubes in the [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="ea692-116">inclut des bibliothèques de fonctions Visual Studio standardisées et vous permet d'utiliser des procédures stockées pour récupérer des données à partir d'autres sources que la base de données [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] active.</span><span class="sxs-lookup"><span data-stu-id="ea692-116">includes standardized Visual Studio function libraries, and you can use stored procedures to retrieve data from sources other than the current [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] database.</span></span> <span data-ttu-id="ea692-117">Pour plus d’informations sur les procédures stockées, consultez [définition des procédures stockées](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span><span class="sxs-lookup"><span data-stu-id="ea692-117">For more information about stored procedures, see [Defining Stored Procedures](../multidimensional-models-extending-olap-stored-procedures/defining-stored-procedures.md).</span></span>  
  
 <span data-ttu-id="ea692-118">Supposons, par exemple, que les cadres d'une société de transport veuillent déterminer les types de cargaisons les plus rentables à transporter, en fonction du bénéfice par unité de volume.</span><span class="sxs-lookup"><span data-stu-id="ea692-118">For example, suppose executives in a shipping company want to determine which types of cargo are more profitable to carry, based on profit per unit of volume.</span></span> <span data-ttu-id="ea692-119">Ils utilisent un cube Shipments qui contient les dimensions Cargo, Fleet et Time et les mesures Price_to_Ship, Cost_to_Ship et Volume_in_Cubic_Meters ; cependant, ce cube ne contient pas de mesure de rentabilité.</span><span class="sxs-lookup"><span data-stu-id="ea692-119">They use a Shipments cube that contains the dimensions Cargo, Fleet, and Time and the measures Price_to_Ship, Cost_to_Ship, and Volume_in_Cubic_Meters; however, the cube does not contain a measure for profitability.</span></span> <span data-ttu-id="ea692-120">Vous pouvez créer un membre calculé correspondant à une mesure appelée Profit_per_Cubic_Meter dans le cube en combinant les mesures existantes dans l'expression suivante :</span><span class="sxs-lookup"><span data-stu-id="ea692-120">You can create a calculated member as a measure named Profit_per_Cubic_Meter in the cube by combining the existing measures in the following expression:</span></span>  
  
```  
([Measures].[Price_to_Ship] - [Measures].[Cost_to_Ship]) /  
[Measures].[Volume_in_Cubic_Meters]  
```  
  
 <span data-ttu-id="ea692-121">Une fois que vous avez créé le membre calculé, Profit_per_Cubic_Meter s'affichera avec les autres mesures au prochain affichage du cube Shipments.</span><span class="sxs-lookup"><span data-stu-id="ea692-121">After you create the calculated member, the Profit_per_Cubic_Meter appears together with the other measures the next time that the Shipments cube is browsed.</span></span>  
  
 <span data-ttu-id="ea692-122">Pour créer des membres calculés, utilisez l’onglet **calcul**s du concepteur de cube.</span><span class="sxs-lookup"><span data-stu-id="ea692-122">To create calculated members, use the **Calculation**s tab in Cube Designer.</span></span> <span data-ttu-id="ea692-123">Pour plus d’informations, consultez [créer des membres calculés](../multidimensional-models/create-calculated-members.md)</span><span class="sxs-lookup"><span data-stu-id="ea692-123">For more information, see [Create Calculated Members](../multidimensional-models/create-calculated-members.md)</span></span>  
  
## <a name="named-sets"></a><span data-ttu-id="ea692-124">Jeux nommés</span><span class="sxs-lookup"><span data-stu-id="ea692-124">Named Sets</span></span>  
 <span data-ttu-id="ea692-125">Un jeu nommé est une expression contenant une instruction MDX CREATE SET qui retourne un jeu.</span><span class="sxs-lookup"><span data-stu-id="ea692-125">A named set is a CREATE SET MDX statement expression that returns a set.</span></span> <span data-ttu-id="ea692-126">L’expression MDX est enregistrée dans le cadre de la définition d’un cube dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ea692-126">The MDX expression is saved as part of the definition of a cube in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="ea692-127">Un jeu nommé est créé afin d'être réutilisé dans les requêtes MDX (Multidimensional Expressions).</span><span class="sxs-lookup"><span data-stu-id="ea692-127">A named set is created for reuse in Multidimensional Expressions (MDX) queries.</span></span> <span data-ttu-id="ea692-128">Un jeu nommé permet aux utilisateurs professionnels de simplifier leurs requêtes et d'utiliser un nom de jeu au lieu d'une expression de jeu pour les expressions de jeu complexes et fréquemment employées.</span><span class="sxs-lookup"><span data-stu-id="ea692-128">A named set enables business users to simplify queries, and use a set name instead of a set expression for complex, frequently used set expressions.</span></span> <span data-ttu-id="ea692-129">**Rubrique connexe :** [créer des jeux nommés](../multidimensional-models/create-named-sets.md)</span><span class="sxs-lookup"><span data-stu-id="ea692-129">**Related topic:** [Create Named Sets](../multidimensional-models/create-named-sets.md)</span></span>  
  
## <a name="script-commands"></a><span data-ttu-id="ea692-130">Commandes de script</span><span class="sxs-lookup"><span data-stu-id="ea692-130">Script Commands</span></span>  
 <span data-ttu-id="ea692-131">Une commande de script est un script MDX, intégré dans la définition du cube.</span><span class="sxs-lookup"><span data-stu-id="ea692-131">A script command is an MDX script, included as part of the definition of the cube.</span></span> <span data-ttu-id="ea692-132">Les commandes de script permettent d'effectuer quasiment toute action prise en charge par MDX sur un cube, telle que l'attribution d'étendue d'un calcul à une seule partie du cube.</span><span class="sxs-lookup"><span data-stu-id="ea692-132">Script commands let you perform almost any action that is supported by MDX on a cube, such as scoping a calculation to apply to only part of the cube.</span></span> <span data-ttu-id="ea692-133">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , les scripts MDX peuvent s’appliquer à l’intégralité du cube ou à des sections spécifiques du cube, à des moments spécifiques tout au long de l’exécution du script.</span><span class="sxs-lookup"><span data-stu-id="ea692-133">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], MDX scripts can apply either to the whole cube or to specific sections of the cube, at specific points throughout the execution of the script.</span></span> <span data-ttu-id="ea692-134">La commande de script par défaut, l'instruction CALCULATE, remplit les cellules du cube avec des données agrégées en fonction de l'étendue par défaut.</span><span class="sxs-lookup"><span data-stu-id="ea692-134">The default script command, which is the CALCULATE statement, populates cells in the cube with aggregated data based on the default scope.</span></span>  
  
 <span data-ttu-id="ea692-135">L'étendue par défaut est le cube tout entier, mais vous pouvez définir une étendue plus limitée - que l'on appelle sous-cube - puis appliquer un script MDX seulement à cet espace particulier du cube.</span><span class="sxs-lookup"><span data-stu-id="ea692-135">The default scope is the whole cube, but you can define a more limited scope, known as a subcube, and then apply an MDX script to only that particular cube space.</span></span> <span data-ttu-id="ea692-136">L'instruction SCOPE définit l'étendue de toutes les instructions et expressions MDX ultérieures dans le script de calcul jusqu'à ce que l'étendue soit arrêtée ou redéfinie.</span><span class="sxs-lookup"><span data-stu-id="ea692-136">The SCOPE statement defines the scope of all subsequent MDX expressions and statements in the calculation script until the scope is terminated or redefined.</span></span> <span data-ttu-id="ea692-137">L'instruction THIS est ensuite utilisée pour appliquer une expression MDX à l'étendue actuelle.</span><span class="sxs-lookup"><span data-stu-id="ea692-137">The THIS statement is then used to apply an MDX expression to the current scope.</span></span> <span data-ttu-id="ea692-138">Vous pouvez utiliser l'instruction BACK_COLOR pour spécifier une couleur d'arrière-plan de cellule pour les cellules de l'étendue actuelle, afin de faciliter le débogage.</span><span class="sxs-lookup"><span data-stu-id="ea692-138">You can use the BACK_COLOR statement to specify a background cell color for the cells in the current scope, to help you during debugging.</span></span>  
  
 <span data-ttu-id="ea692-139">Par exemple, vous pouvez utiliser une commande de script pour attribuer des quotas de ventes à des employés en fonction du temps et des territoires de ventes en utilisant comme références les valeurs pondérées des ventes dans une période antérieure.</span><span class="sxs-lookup"><span data-stu-id="ea692-139">For example, you can use a script command to allocate sales quotas to employees across time and sales territory based on the weighted values of sales for a prior time period.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea692-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ea692-140">See Also</span></span>  
 [<span data-ttu-id="ea692-141">Calculs dans les modèles multidimensionnels</span><span class="sxs-lookup"><span data-stu-id="ea692-141">Calculations in Multidimensional Models</span></span>](../multidimensional-models/calculations-in-multidimensional-models.md)  
  
  
