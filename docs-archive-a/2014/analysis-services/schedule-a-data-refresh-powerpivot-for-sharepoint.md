---
title: Planifier une actualisation des données (PowerPivot pour SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9d6078cf59c27c15ead8f22047ba9add20757be7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602371"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a><span data-ttu-id="13e57-102">Planifier une actualisation des données (PowerPivot pour SharePoint)</span><span class="sxs-lookup"><span data-stu-id="13e57-102">Schedule a Data Refresh (PowerPivot for SharePoint)</span></span>
  <span data-ttu-id="13e57-103">Vous pouvez planifier l'actualisation des données pour obtenir des mises à jour automatiques des données PowerPivot figurant dans un classeur Excel que vous avez publié sur un site SharePoint.</span><span class="sxs-lookup"><span data-stu-id="13e57-103">You can schedule data refresh to get automatic updates to PowerPivot data inside an Excel workbook that you published to a SharePoint site.</span></span>  
  
 <span data-ttu-id="13e57-104">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="13e57-104">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>  
  
 <span data-ttu-id="13e57-105">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="13e57-105">**In this topic:**</span></span>  
  
 [<span data-ttu-id="13e57-106">Composants requis</span><span class="sxs-lookup"><span data-stu-id="13e57-106">Prerequisites</span></span>](#prereq)  
  
 [<span data-ttu-id="13e57-107">Vue d'ensemble de l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-107">Data Refresh Overview</span></span>](#intro)  
  
 [<span data-ttu-id="13e57-108">Activer et planifier l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-108">Enable and schedule data refresh</span></span>](#drenablesched)  
  
 [<span data-ttu-id="13e57-109">Vérifier l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-109">Verify Data Refresh</span></span>](#drverify)  
  
> [!NOTE]  
>  <span data-ttu-id="13e57-110">L'actualisation des données PowerPivot est effectuée par les instances de serveur Analysis Services de la batterie de serveurs SharePoint.</span><span class="sxs-lookup"><span data-stu-id="13e57-110">PowerPivot data refresh is performed by Analysis Services server instances in the SharePoint farm.</span></span> <span data-ttu-id="13e57-111">Elle n'a aucun rapport avec la fonctionnalité d'actualisation des données proposée par Excel Services.</span><span class="sxs-lookup"><span data-stu-id="13e57-111">It is not related to the data refresh feature that is provided in Excel Services.</span></span> <span data-ttu-id="13e57-112">La fonctionnalité d'actualisation de la planification des données PowerPivot n'actualise pas les données non-PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="13e57-112">The PowePivot Schedule data refresh feature will not refresh non PowerPivot data.</span></span>  
  
##  <a name="prerequisites"></a><a name="prereq"></a> <span data-ttu-id="13e57-113">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="13e57-113">Prerequisites</span></span>  
 <span data-ttu-id="13e57-114">Pour créer une planification d'actualisation des données, vous devez disposer au moins du niveau d'autorisation Collaboration sur le classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-114">You must have Contribute level of permission or greater on the workbook to create a data refresh schedule.</span></span>  
  
 <span data-ttu-id="13e57-115">Les sources de données externes utilisées pendant l'actualisation des données doivent être disponibles et les informations d'identification que vous spécifiez dans la planification doivent avoir l'autorisation d'accéder à ces sources de données.</span><span class="sxs-lookup"><span data-stu-id="13e57-115">External data sources that are accessed during data refresh must be available and the credentials you specify in the schedule must have permission to access those data sources.</span></span> <span data-ttu-id="13e57-116">L'actualisation des données planifiée requiert que l'emplacement des sources de données soit accessible sur une connexion réseau (par exemple, sur un partage de fichiers réseau plutôt qu'un dossier local sur votre station de travail).</span><span class="sxs-lookup"><span data-stu-id="13e57-116">Scheduled data refresh requires a data source location that is accessible over a network connection (for example, from a network file share rather than a local folder on your workstation).</span></span>  
  
 <span data-ttu-id="13e57-117">La source de données ne peut pas être un document Office ou une base de données Access.</span><span class="sxs-lookup"><span data-stu-id="13e57-117">The data source cannot be an Office document or Access database.</span></span> <span data-ttu-id="13e57-118">Office ne prend pas en charge l'utilisation des composants de connectivité des données Office dans un environnement serveur.</span><span class="sxs-lookup"><span data-stu-id="13e57-118">Office does not support the use of the Office data connectivity components in a server environment.</span></span> <span data-ttu-id="13e57-119">Si votre classeur contient des données de ces sources, veillez à les supprimer de la liste des sources de données dans votre planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-119">If your workbook contains data from these sources, be sure to remove those sources from the data source list in your data refresh schedule.</span></span>  
  
 <span data-ttu-id="13e57-120">Le classeur doit être de version [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="13e57-120">The workbook must be a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version.</span></span> <span data-ttu-id="13e57-121">Si vous utilisez des classeurs créés dans la version précédente de PowerPivot pour Excel, l'actualisation des données de planification ne fonctionnera que lorsque vous aurez effectué la mise à niveau de la base de données vers la version la plus récente.</span><span class="sxs-lookup"><span data-stu-id="13e57-121">If you use workbooks that were created in the previous release of PowerPivot for Excel, schedule data refresh will not work unless you upgrade the database to the most recent version.</span></span>  
  
 <span data-ttu-id="13e57-122">Le classeur doit être archivé au moment où l'opération d'actualisation se termine.</span><span class="sxs-lookup"><span data-stu-id="13e57-122">The workbook must be checked in at the time the refresh operation is finished.</span></span> <span data-ttu-id="13e57-123">Un verrou sur le classeur est placé sur le fichier à la fin de l'actualisation des données, lorsque le fichier est enregistré, plutôt que lors du démarrage de l'actualisation.</span><span class="sxs-lookup"><span data-stu-id="13e57-123">A lock on the workbook is placed on the file at the end of data refresh, when the file is saved, rather than when refresh starts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="13e57-124">Le serveur ne verrouille pas le classeur pendant l'opération d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-124">The server does not lock the workbook while the data refresh is in progress.</span></span> <span data-ttu-id="13e57-125">Toutefois, il verrouille le fichier à la fin de l'actualisation des données en vue d'archiver le fichier mis à jour.</span><span class="sxs-lookup"><span data-stu-id="13e57-125">However, it does lock the file at the end of data refresh for the purpose of checking in the updated file.</span></span> <span data-ttu-id="13e57-126">Si, à ce stade, le fichier est extrait par un autre utilisateur, les données actualisées seront levées. De même, si le fichier est archivé, mais qu’il est très différent de la copie récupérée par le serveur au début de l’actualisation des données, les données actualisées sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="13e57-126">If at this time, the file is checked out to another user, the refreshed data will be thrown out. Similarly, if the file is checked in, but it is significantly different from the copy retrieved by the server at the start of data refresh, the refreshed data will be discarded.</span></span>  
  
##  <a name="data-refresh-overview"></a><a name="intro"></a><span data-ttu-id="13e57-127">Vue d’ensemble de l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-127">Data Refresh Overview</span></span>  
 <span data-ttu-id="13e57-128">Les données PowerPivot dans un classeur Excel peuvent provenir de plusieurs sources de données externes, notamment de bases de données externes ou de fichiers de données auxquels vous accédez par des serveurs distants ou des partages de fichiers réseau.</span><span class="sxs-lookup"><span data-stu-id="13e57-128">PowerPivot data in an Excel workbook can originate from multiple external data sources, including external databases or data files that you access from remote servers or network file shares.</span></span> <span data-ttu-id="13e57-129">Pour les classeurs PowerPivot qui contiennent des données importées à partir de sources de données connectées ou externes, vous pouvez configurer l'actualisation des données de façon à planifier une importation automatique des données mises à jour de ces sources d'origine.</span><span class="sxs-lookup"><span data-stu-id="13e57-129">For PowerPivot workbooks that contain imported data from connected or external data sources, you can configure data refresh to schedule an automatic import of updated data from those original sources.</span></span>  
  
 <span data-ttu-id="13e57-130">L'accès à une source de données externe s'effectue au moyen d'une chaîne de connexion incorporée, d'une URL ou d'un chemin d'accès UNC spécifié lors de l'importation des données d'origine dans le classeur à l'aide de l'application cliente PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="13e57-130">An external data source is accessed through an embedded connection string, URL, or UNC path that you specified when you imported the original data into the workbook using the PowerPivot client application.</span></span> <span data-ttu-id="13e57-131">Les informations de connexion d'origine stockées dans le classeur PowerPivot sont réutilisées pour les opérations d'actualisation des données suivantes.</span><span class="sxs-lookup"><span data-stu-id="13e57-131">Original connection information that is stored in the PowerPivot workbook is reused for subsequent data refresh operations.</span></span> <span data-ttu-id="13e57-132">Bien que vous puissiez remplacer les informations d'identification utilisées pour se connecter aux sources de données, vous ne pouvez pas remplacer les chaînes de connexion à des fins d'actualisation des données ; seules les informations de connexion existantes sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="13e57-132">Although you can overwrite credentials used to connect to data sources, you cannot overwrite connection strings for data refresh purposes; only existing connection information is used.</span></span>  
  
 <span data-ttu-id="13e57-133">Il existe une seule page de planification d'actualisation des données pour chaque classeur, et toutes les informations de planification sont spécifiées dans cette page.</span><span class="sxs-lookup"><span data-stu-id="13e57-133">There is only one data refresh schedule page for each workbook, and all schedule information is specified on that page.</span></span> <span data-ttu-id="13e57-134">En règle générale, c'est la personne qui a créé le classeur qui définit la planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-134">Typically, the person who authored the workbook defines the schedule.</span></span>  
  
 <span data-ttu-id="13e57-135">En tant que propriétaire de la planification, vous pouvez effectuer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="13e57-135">As the schedule owner, you perform the following tasks:</span></span>  
  
-   <span data-ttu-id="13e57-136">Définissez la planification par défaut.</span><span class="sxs-lookup"><span data-stu-id="13e57-136">Define the default schedule.</span></span> <span data-ttu-id="13e57-137">Il s'agit de la planification utilisée lorsqu'aucune planification n'est définie au niveau de la source de données.</span><span class="sxs-lookup"><span data-stu-id="13e57-137">This is the schedule that is used if there are no scheduled defined at the data source level.</span></span>  
  
-   <span data-ttu-id="13e57-138">Spécifier les informations d'identification utilisées pour exécuter l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-138">Specify the credentials used to run data refresh</span></span>  
  
-   <span data-ttu-id="13e57-139">Choisissez les sources de données à inclure dans l'opération d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-139">Choose which data sources to include in the refresh operation.</span></span>  
  
-   <span data-ttu-id="13e57-140">Éventuellement, spécifiez les planifications et les informations d'identification individuelles en ligne pour chaque source de données interrogée pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-140">Optionally, specify in-line, individual schedules and credentials for each data source that is queried during data refresh.</span></span> <span data-ttu-id="13e57-141">Chaque source de données peut être actualisée indépendamment.</span><span class="sxs-lookup"><span data-stu-id="13e57-141">Each data source can be refreshed independently.</span></span> <span data-ttu-id="13e57-142">Si vous créez des planifications personnalisées pour chaque source de données, la planification par défaut est ignorée.</span><span class="sxs-lookup"><span data-stu-id="13e57-142">If you create custom schedules for every data source, the default schedule is ignored.</span></span>  
  
 <span data-ttu-id="13e57-143">La création de planifications avec précision pour des sources de données individuelles permet d'adapter la planification de l'actualisation aux fluctuations des sources de données externes.</span><span class="sxs-lookup"><span data-stu-id="13e57-143">Creating granular schedules for individual data sources enables you to match the refresh schedule to fluctuations in the external data sources.</span></span> <span data-ttu-id="13e57-144">Par exemple, si une source de données externe contient des données transactionnelles générées pendant la journée, vous pouvez créer une planification d'actualisation des données individuelle pour cette source de données de façon à obtenir ses informations mises à jour de nuit.</span><span class="sxs-lookup"><span data-stu-id="13e57-144">For example, if an external data source contains transactional data that is generated throughout the day, you can create an individual data refresh schedule for that data source to get its updated information nightly.</span></span>  
  
##  <a name="enable-and-schedule-data-refresh"></a><a name="drenablesched"></a><span data-ttu-id="13e57-145">Activer et planifier l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-145">Enable and schedule data refresh</span></span>  
 <span data-ttu-id="13e57-146">Utilisez les instructions suivantes pour planifier l'actualisation des données PowerPivot d'un classeur Excel publié dans une bibliothèque SharePoint.</span><span class="sxs-lookup"><span data-stu-id="13e57-146">Use the following instructions to schedule data refresh for PowerPivot data in an Excel workbook that is published to a SharePoint library.</span></span>  
  
1.  <span data-ttu-id="13e57-147">Dans la bibliothèque qui contient le classeur, sélectionnez ce dernier, puis cliquez sur la flèche orientée vers le bas pour afficher une liste de commandes.</span><span class="sxs-lookup"><span data-stu-id="13e57-147">In the library that contains the workbook, select the workbook and then click the down arrow to display a list of commands.</span></span>  
  
2.  <span data-ttu-id="13e57-148">Cliquez sur **Gérer l'actualisation des données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="13e57-148">Click **Manage PowerPivot Data Refresh**.</span></span> <span data-ttu-id="13e57-149">Si une planification d'actualisation des données est déjà définie, vous verrez à la place la page Historique d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-149">If a data refresh schedule is already defined, you will see the View Data Refresh history page instead.</span></span> <span data-ttu-id="13e57-150">Vous pouvez cliquer sur **Configurer l'actualisation des données** pour ouvrir la page de définition de la planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-150">You can click **Configure data refresh** to open the schedule definition page.</span></span>  
  
3.  <span data-ttu-id="13e57-151">Dans la page de définition de la planification, sélectionnez la case à cocher **Activer** .</span><span class="sxs-lookup"><span data-stu-id="13e57-151">In the schedule definition page, select the **Enable** checkbox.</span></span>  
  
4.  <span data-ttu-id="13e57-152">Dans Détails de la planification, spécifiez le type de planification et ses détails.</span><span class="sxs-lookup"><span data-stu-id="13e57-152">In Schedule Details, specify the type of schedule and specify its details.</span></span> <span data-ttu-id="13e57-153">Cette étape crée la planification par défaut.</span><span class="sxs-lookup"><span data-stu-id="13e57-153">This step creates the default schedule.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="13e57-154">Veillez à activer la case à cocher **Aussi actualiser dès que possible** .</span><span class="sxs-lookup"><span data-stu-id="13e57-154">Be sure to select the **Also refresh as soon as possible** checkbox.</span></span> <span data-ttu-id="13e57-155">Cela vous permet de vérifier que l'actualisation des données est opérationnelle pour ce classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-155">Doing so lets you verify that data refresh is operational for this workbook.</span></span> <span data-ttu-id="13e57-156">Notez qu'une fois que vous avez enregistré la planification, le démarrage de l'actualisation des données peut prendre jusqu'à une minute.</span><span class="sxs-lookup"><span data-stu-id="13e57-156">Note that after you save schedule, it can take up to a minute for data refresh to start.</span></span>  
  
5.  <span data-ttu-id="13e57-157">Dans Heure de début (au plus tôt), choisissez l'une des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="13e57-157">In Earliest Start Time, choose one of the following:</span></span>  
  
    1.  <span data-ttu-id="13e57-158">**Après les heures d'ouverture** spécifie une période de traitement en dehors des heures d'ouverture, lorsque les serveurs de base de données sont le plus susceptibles de contenir les données actuelles générées pendant la journée de travail.</span><span class="sxs-lookup"><span data-stu-id="13e57-158">**After business hours** specifies an off-hours processing period when database servers are more likely to have current data that was generated throughout the business day.</span></span>  
  
    2.  <span data-ttu-id="13e57-159">**Heure de début (au plus tôt) spécifique** est l'indication exacte (heure et minutes) de l'heure du jour la plus tôt où vous souhaitez que la demande d'actualisation des données soit ajoutée à une file d'attente de traitement.</span><span class="sxs-lookup"><span data-stu-id="13e57-159">**Specific earliest start time** is the hour and minutes of the earliest time of day the data refresh request is added to a process queue.</span></span> <span data-ttu-id="13e57-160">Les minutes peuvent être spécifiées par intervalles de 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="13e57-160">You can specify minutes in 15-minute intervals.</span></span> <span data-ttu-id="13e57-161">Ce paramètre s'applique au jour actuel, ainsi qu'à des dates dans le futur.</span><span class="sxs-lookup"><span data-stu-id="13e57-161">The setting applies to the current day as well as future dates.</span></span> <span data-ttu-id="13e57-162">Par exemple, si vous spécifiez une valeur de 6 h 30 du matin</span><span class="sxs-lookup"><span data-stu-id="13e57-162">For example, if you specify a value of 6:30 A.M.</span></span> <span data-ttu-id="13e57-163">et qu'il est actuellement 4 h 30 de l'après-midi, la demande d'actualisation sera ajoutée à la file d'attente du jour actuel, car 4 h 30 de l'après-midi</span><span class="sxs-lookup"><span data-stu-id="13e57-163">and the current time is 4:30 P.M., the refresh request will be added to the queue in the current day because 4:30 P.M.</span></span> <span data-ttu-id="13e57-164">est ultérieur à 6 h 30 du matin.</span><span class="sxs-lookup"><span data-stu-id="13e57-164">is after 6:30 A.M.</span></span>  
  
     <span data-ttu-id="13e57-165">L'heure de début au plus tôt définit le moment où une requête est ajoutée à la file d'attente de traitement.</span><span class="sxs-lookup"><span data-stu-id="13e57-165">Earliest start time defines when a request is added to the process queue.</span></span> <span data-ttu-id="13e57-166">Le traitement en lui-même intervient lorsque le serveur dispose des ressources adéquates pour commencer le traitement des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-166">Actual processing occurs when the server has adequate resources to begin data processing.</span></span> <span data-ttu-id="13e57-167">L'heure réelle du traitement est enregistrée dans l'historique d'actualisation des données à la fin du traitement.</span><span class="sxs-lookup"><span data-stu-id="13e57-167">Actual processing time will be recorded in data refresh history after processing is complete.</span></span>  
  
6.  <span data-ttu-id="13e57-168">Cochez la case **Aussi actualiser dès que possible** pour exécuter l'actualisation des données dès que le serveur peut traiter l'opération.</span><span class="sxs-lookup"><span data-stu-id="13e57-168">Select the checkbox **Also refresh as soon as possible** to run data refresh as soon as the server can process it.</span></span> <span data-ttu-id="13e57-169">Pour une actualisation des données réussie, il faut vérifier que les sources de données sont disponibles et que les autorisations et la configuration du serveur sont définies correctement.</span><span class="sxs-lookup"><span data-stu-id="13e57-169">A successful outcome of a data refresh job verifies that the data sources are available and that permissions and server configuration are set correctly.</span></span>  
  
7.  <span data-ttu-id="13e57-170">Dans Notifications par courrier électronique, entrez l'adresse de messagerie de la personne qui doit être notifiée en cas d'erreur de traitement.</span><span class="sxs-lookup"><span data-stu-id="13e57-170">In E-mail notifications, enter the e-mail address of the person who should be notified in the event of a processing error.</span></span>  
  
8.  <span data-ttu-id="13e57-171">Dans les informations d'identification, spécifiez un compte qui sera utilisé pour exécuter le travail d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-171">In Credentials, specify an account used to run the data refresh job.</span></span> <span data-ttu-id="13e57-172">Le compte doit avoir des autorisations de collaboration sur le classeur afin qu'il puisse ouvrir le classeur pour actualiser ses données.</span><span class="sxs-lookup"><span data-stu-id="13e57-172">The account must have Contribute permissions on the workbook so that it can open the workbook to refresh its data.</span></span> <span data-ttu-id="13e57-173">Il doit s'agir d'un compte d'utilisateur de domaine Windows.</span><span class="sxs-lookup"><span data-stu-id="13e57-173">It must be a Windows domain user account.</span></span> <span data-ttu-id="13e57-174">Dans de nombreux cas, ce compte doit également avoir des autorisations de lecture sur les sources de données externes utilisées pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-174">In many cases, this account must also have read permissions on the external data sources used during data refresh.</span></span> <span data-ttu-id="13e57-175">Plus précisément, si vous avez importé à l'origine les données à l'aide de l'option Utiliser l'authentification Windows, la chaîne de connexion est construite pour utiliser les informations d'identification Windows de l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="13e57-175">Specifically, if you originally imported the data using the Use Windows Authentication option, then the connection string is built to use the Windows credentials of the current user.</span></span> <span data-ttu-id="13e57-176">Si l'utilisateur actuel correspond au compte d'actualisation des données, ce compte doit avoir des autorisations de lecture sur la source de données externe pour que l'actualisation des données réussisse.</span><span class="sxs-lookup"><span data-stu-id="13e57-176">If the current user is the data refresh account, that account must have read permissions on the external data source in order for data refresh to succeed.</span></span> <span data-ttu-id="13e57-177">Choisissez l'une des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="13e57-177">Choose one of the following options:</span></span>  
  
    1.  <span data-ttu-id="13e57-178">Choisissez **Utilisez le compte d'actualisation des données configuré par l'administrateur** pour traiter l'opération d'actualisation des données à l'aide du compte d'actualisation des données PowerPivot sans assistance.</span><span class="sxs-lookup"><span data-stu-id="13e57-178">Choose **Use the data refresh account configured by the administrator** to process the data refresh operation using the PowerPivot unattended data refresh account.</span></span>  
  
    2.  <span data-ttu-id="13e57-179">Choisissez **Connectez-vous à l'aide des informations d'identification d'utilisateur Windows suivantes** si vous souhaitez entrer un nom d'utilisateur et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="13e57-179">Choose **Connect using the following Windows user credentials** if you want to enter a user name and password.</span></span> <span data-ttu-id="13e57-180">Entrez les informations de compte au format domaine\utilisateur.</span><span class="sxs-lookup"><span data-stu-id="13e57-180">Enter the account information in domain\user format.</span></span>  
  
    3.  <span data-ttu-id="13e57-181">Choisissez **Connectez-vous à l'aide des informations d'identification enregistrées dans le Service Banque d'informations sécurisé** si vous connaissez l'ID d'une application cible qui contient les informations d'identification préalablement stockées que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="13e57-181">Choose **Connect using the credentials saved in Secure Store Service** if you know the ID of a target application that contains previously stored credentials you want to use.</span></span>  
  
     <span data-ttu-id="13e57-182">Pour plus d’informations sur ces options, consultez [configurer les informations d’identification stockées pour l’actualisation des données powerpivot &#40;PowerPivot pour SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) et [configurer le compte d’actualisation des données powerpivot sans assistance &#40;PowerPivot pour SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="13e57-182">For more information about these options, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) and [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>  
  
9. <span data-ttu-id="13e57-183">Dans Sources de données, activez la case à cocher **Toutes les sources de données** si vous souhaitez que l'actualisation des données réinterroge l'ensemble des sources de données d'origine.</span><span class="sxs-lookup"><span data-stu-id="13e57-183">In Data Sources, select the **All data sources** checkbox if you want data refresh to re-query all of the original data sources.</span></span>  
  
     <span data-ttu-id="13e57-184">Si vous sélectionnez cette option, toute source de données externe qui fournit des données PowerPivot est automatiquement incluse dans l'actualisation, même si la liste des sources de données évolue à mesure que vous ajoutez ou supprimez des sources de données qui fournissent des données au classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-184">If you select this option, any external data source that provides PowerPivot data is automatically included in the refresh, even if the list of data sources changes over time as you add or remove data sources that provide data to the workbook.</span></span>  
  
     <span data-ttu-id="13e57-185">Désactivez la case à cocher **Toutes les sources de données** si vous souhaitez sélectionner manuellement les sources de données à inclure.</span><span class="sxs-lookup"><span data-stu-id="13e57-185">Clear the **All data sources** checkbox if you want to manually select which data sources to include.</span></span> <span data-ttu-id="13e57-186">Si, par la suite, vous modifiez le classeur en ajoutant une nouvelle source de données, veillez à mettre à jour la liste des sources de données dans la planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-186">If you later modify the workbook by adding a new data source, be sure to update the data source list in the schedule.</span></span> <span data-ttu-id="13e57-187">Si vous ne le faites pas, les nouvelles sources de données ne seront pas incluses dans l'opération d'actualisation.</span><span class="sxs-lookup"><span data-stu-id="13e57-187">Otherwise, newer data sources will not be included in the refresh operation.</span></span>  
  
     <span data-ttu-id="13e57-188">La liste des sources de données que vous pouvez sélectionner est récupérée du classeur PowerPivot lorsque vous ouvrez la page Gérer l'actualisation des données PowerPivot pour le classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-188">The list of data sources that you can choose from is retrieved from the PowerPivot workbook when you open the Manage PowerPivot Data Refresh page for the workbook.</span></span>  
  
     <span data-ttu-id="13e57-189">Veillez à ne sélectionner que des sources de données qui répondent aux critères suivants :</span><span class="sxs-lookup"><span data-stu-id="13e57-189">Be sure to select only those data sources that meet the following criteria:</span></span>  
  
    -   <span data-ttu-id="13e57-190">La source de données doit être disponible au moment où s'effectue l'actualisation des données et à l'emplacement indiqué.</span><span class="sxs-lookup"><span data-stu-id="13e57-190">The data source must be available at the time that data refresh occurs and at the stated location.</span></span> <span data-ttu-id="13e57-191">Si la source de données d'origine se trouve sur un lecteur de disque local de la personne qui a créé le classeur, vous devez soit exclure cette source de données de l'opération d'actualisation, soit trouver un moyen de publier cette source de données à un emplacement accessible via une connexion réseau.</span><span class="sxs-lookup"><span data-stu-id="13e57-191">If the original data source is on a local disk drive of the person who authored the workbook, you must either exclude that data source from the data refresh operation, or find a way to publish that data source to a location that is accessible through a network connection.</span></span> <span data-ttu-id="13e57-192">Si vous déplacez une source de données vers un emplacement réseau, veillez à ouvrir le classeur dans [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] et mettez à jour les informations de connexion à la source de données.</span><span class="sxs-lookup"><span data-stu-id="13e57-192">If you move a data source to a network location, be sure to open the workbook in [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] and update the data source connection information.</span></span> <span data-ttu-id="13e57-193">Ces opérations sont nécessaires pour rétablir les informations de connexion stockées dans le classeur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="13e57-193">This is necessary to re-establish the connection information that is stored in the PowerPivot workbook.</span></span>  
  
    -   <span data-ttu-id="13e57-194">L'accès à la source de données doit se faire au moyen des informations d'identification incorporées dans le classeur PowerPivot ou de celles qui sont spécifiées dans la planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-194">The data source must be accessed using the credential information that is embedded in the PowerPivot workbook or that is specified in the schedule.</span></span> <span data-ttu-id="13e57-195">Les informations d'identification incorporées sont stockées dans le classeur PowerPivot lorsque vous importez des données à l'aide de PowerPivot pour Excel.</span><span class="sxs-lookup"><span data-stu-id="13e57-195">Embedded credential information is stored in the PowerPivot workbook when you import data using PowerPivot for Excel.</span></span> <span data-ttu-id="13e57-196">Les informations d'identification incorporées sont souvent sécurisées SSPI=IntegratedSecurity ou SSPI=TrustedConnection, ce qui signifie qu'elles utilisent les informations d'identification de l'utilisateur actuel pour se connecter à la source de données.</span><span class="sxs-lookup"><span data-stu-id="13e57-196">Embedded credential information is often SSPI=IntegratedSecurity or SSPI=TrustedConnection, which means use the credentials of the current user to connect to the data source.</span></span> <span data-ttu-id="13e57-197">Si vous souhaitez remplacer les informations d'identification dans votre planification d'actualisation des données, vous pouvez spécifier des informations d'identification prédéfinies et stockées.</span><span class="sxs-lookup"><span data-stu-id="13e57-197">If you want to override the credential information in your data refresh schedule, you can specify predefined, stored credentials.</span></span> <span data-ttu-id="13e57-198">Pour plus d’informations, consultez [configurer les informations d’identification stockées pour l’actualisation des données PowerPivot &#40;PowerPivot pour SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="13e57-198">For more information, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>  
  
    -   <span data-ttu-id="13e57-199">L'actualisation des données doit réussir pour toutes les sources de données que vous spécifiez.</span><span class="sxs-lookup"><span data-stu-id="13e57-199">Data refresh must succeed for all of the data sources that you specify.</span></span> <span data-ttu-id="13e57-200">Si ce n'est pas le cas, les données actualisées sont ignorées, vous laissant avec la dernière version enregistrée du classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-200">Otherwise, the refreshed data is discarded, leaving you with the last saved version of the workbook.</span></span> <span data-ttu-id="13e57-201">Excluez toutes les sources de données pour lesquelles vous avez un doute.</span><span class="sxs-lookup"><span data-stu-id="13e57-201">Exclude any data sources that you are not sure about.</span></span>  
  
    -   <span data-ttu-id="13e57-202">L'actualisation des données ne doit pas invalider d'autres données de votre classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-202">Data refresh must not invalidate other data in your workbook.</span></span> <span data-ttu-id="13e57-203">Lorsque vous actualisez un sous-ensemble de vos données, il est essentiel que vous compreniez si le classeur est toujours valide une fois les données les plus récentes agrégées avec les données statiques qui ne s'inscrivent pas sur la même période.</span><span class="sxs-lookup"><span data-stu-id="13e57-203">When you refresh a subset of your data, it is important that you understand whether the workbook is still valid once newer data is aggregated with static data that is not from the same time period.</span></span> <span data-ttu-id="13e57-204">En tant qu'auteur du classeur, il vous appartient de connaître les dépendances de vos données et de faire en sorte que l'actualisation des données soit appropriée pour le classeur lui-même.</span><span class="sxs-lookup"><span data-stu-id="13e57-204">As a workbook author, it is up to you to know your data dependencies and ensure that data refresh is appropriate for the workbook itself.</span></span>  
  
10. <span data-ttu-id="13e57-205">Vous pouvez éventuellement définir des planifications individuelles pour des sources de données spécifiques.</span><span class="sxs-lookup"><span data-stu-id="13e57-205">Optionally, you can define individual schedules for specific data sources.</span></span> <span data-ttu-id="13e57-206">Cela peut être utile si vous disposez de sources de données d'origine qui sont elles-mêmes mises à jour selon une planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-206">This is useful if you have original data sources that are themselves updated on a schedule.</span></span> <span data-ttu-id="13e57-207">Par exemple, si une source de données PowerPivot utilise les données d'un mini-Data Warehouse actualisé chaque lundi à 02:00, vous pouvez définir une planification incluse pour le mini-Data Warehouse de façon à récupérer ses données actualisées chaque lundi à 04:00.</span><span class="sxs-lookup"><span data-stu-id="13e57-207">For example, if a PowerPivot data source uses data from a data mart that is refreshed every Monday at 02:00 hours, you can define an inline schedule for the data mart to retrieve its refreshed data every Monday at 04:00 hours.</span></span>  
  
11. <span data-ttu-id="13e57-208">Cliquez sur **OK** pour enregistrer la planification.</span><span class="sxs-lookup"><span data-stu-id="13e57-208">Click **OK** to save your schedule.</span></span>  
  
##  <a name="verify-data-refresh"></a><a name="drverify"></a><span data-ttu-id="13e57-209">Vérifier l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="13e57-209">Verify Data Refresh</span></span>  
 <span data-ttu-id="13e57-210">La meilleure méthode pour vérifier l'actualisation des données est de l'exécuter, puis de consulter la page d'historique pour voir se elle s'est terminée avec succès.</span><span class="sxs-lookup"><span data-stu-id="13e57-210">The best way to verify data refresh is to execute data refresh right away and then review the history page to see whether it completed successfully.</span></span> <span data-ttu-id="13e57-211">En cochant la case **Aussi actualiser dès que possible** sur votre planification vous pouvez vérifier que l'actualisation des données fonctionne.</span><span class="sxs-lookup"><span data-stu-id="13e57-211">Selecting the **Also refresh as soon as possible** checkbox on your schedule will provide the verification that data refresh is operational.</span></span>  
  
 <span data-ttu-id="13e57-212">Vous pouvez consulter les opérations d'actualisation des données actuelles et passées dans la page Historique d'actualisation des données du classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-212">You can view the current and past record of data refresh operations in the Data Refresh History page for the workbook.</span></span> <span data-ttu-id="13e57-213">Cette page ne s'affiche que si une actualisation des données a été planifiée pour un classeur.</span><span class="sxs-lookup"><span data-stu-id="13e57-213">This page only appears if data refresh has been scheduled for a workbook.</span></span> <span data-ttu-id="13e57-214">Si ce n'est pas le cas, c'est la page de définition de la planification qui s'affiche à la place.</span><span class="sxs-lookup"><span data-stu-id="13e57-214">If there is no data refresh schedule, the schedule definition page appears instead.</span></span>  
  
 <span data-ttu-id="13e57-215">Pour afficher l'historique d'actualisation des données, vous devez disposer d'autorisations Collaboration ou supérieures.</span><span class="sxs-lookup"><span data-stu-id="13e57-215">You must have Contribute permissions or greater to view data refresh history.</span></span>  
  
1.  <span data-ttu-id="13e57-216">Sur un site SharePoint, ouvrez la bibliothèque qui contient un classeur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="13e57-216">On a SharePoint site, open the library that contains a PowerPivot workbook.</span></span>  
  
     <span data-ttu-id="13e57-217">Aucun indicateur visuel ne permet d'identifier les classeurs d'une bibliothèque SharePoint qui contiennent des données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="13e57-217">There is no visual indicator that identifies which workbooks in a SharePoint library contain PowerPivot data.</span></span> <span data-ttu-id="13e57-218">Vous devez savoir à l'avance quels classeurs contiennent des données PowerPivot actualisables.</span><span class="sxs-lookup"><span data-stu-id="13e57-218">You must know in advance which workbooks contain refreshable PowerPivot data.</span></span>  
  
2.  <span data-ttu-id="13e57-219">Sélectionnez le document, puis cliquez sur la flèche orientée vers le bas qui s'affiche à droite.</span><span class="sxs-lookup"><span data-stu-id="13e57-219">Select the document, and then click the down arrow that appears to the right.</span></span>  
  
3.  <span data-ttu-id="13e57-220">Sélectionnez **Gérer l'actualisation des données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="13e57-220">Select **Manage PowerPivot Data Refresh**.</span></span>  
  
 <span data-ttu-id="13e57-221">La page d'historique s'affiche. Elle contient des informations complètes sur l'ensemble de l'activité d'actualisation des données PowerPivot du classeur Excel actif, notamment l'état de l'opération d'actualisation des données la plus récente.</span><span class="sxs-lookup"><span data-stu-id="13e57-221">The history page appears, showing a complete record for all refresh activity for PowerPivot data in the current Excel workbook, including the status of the most recent data refresh operation.</span></span>  
  
 <span data-ttu-id="13e57-222">Il peut arriver que vous constatiez des heures de traitement différentes de celles que vous avez spécifiées.</span><span class="sxs-lookup"><span data-stu-id="13e57-222">In some cases, you might see actual processing times that differ from the time you specified.</span></span> <span data-ttu-id="13e57-223">Cela peut se produire si le serveur doit faire face à une charge de traitement importante.</span><span class="sxs-lookup"><span data-stu-id="13e57-223">This will occur if there is a heavy processing load on the server.</span></span> <span data-ttu-id="13e57-224">En cas de surcharge, l'instance du service [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] attend pour lancer l'actualisation des données que les ressources système soient à nouveau suffisantes.</span><span class="sxs-lookup"><span data-stu-id="13e57-224">Under heavy load, the [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] service instance will wait until enough system resources are free before it begins a data refresh.</span></span>  
  
 <span data-ttu-id="13e57-225">Le classeur doit être archivé à l'heure où l'opération d'actualisation se termine.</span><span class="sxs-lookup"><span data-stu-id="13e57-225">The workbook must be checked in when the refresh operation is finished.</span></span> <span data-ttu-id="13e57-226">Le classeur est enregistré avec les données actualisées à la même heure.</span><span class="sxs-lookup"><span data-stu-id="13e57-226">The workbook will be saved with the refreshed data at that time.</span></span> <span data-ttu-id="13e57-227">Si le fichier est extrait, l'actualisation des données est ignorée jusqu'à l'heure planifiée suivante.</span><span class="sxs-lookup"><span data-stu-id="13e57-227">If the file is checked out, data refresh is skipped until the next scheduled time.</span></span>  
  
 <span data-ttu-id="13e57-228">Si un message d'état inattendu s'affiche (indiquant par exemple qu'une opération d'actualisation a échoué ou a été annulée), vous pouvez étudier le problème en vérifiant les autorisations et la disponibilité du serveur.</span><span class="sxs-lookup"><span data-stu-id="13e57-228">If you see a status message that is unexpected (for example, a refresh operation failed or was cancelled), you can investigate the problem by checking permissions and server availability.</span></span>  
  
 <span data-ttu-id="13e57-229">Examinez la page Résolution des problèmes d'actualisation des données PowerPivot sur le wiki TechNet pour obtenir de l'aide sur la résolution des problèmes d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="13e57-229">Review the PowerPivot data refresh troubleshooting page on the TechNet WIKI for help on resolving data refresh problems.</span></span> <span data-ttu-id="13e57-230">Pour plus d'informations, consultez [Résolution des problèmes d'actualisation des données PowerPivot](https://go.microsoft.com/fwlink/?LinkId=251594).</span><span class="sxs-lookup"><span data-stu-id="13e57-230">For more information see [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkId=251594).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="13e57-231">Les administrateurs SharePoint peuvent vous aider à résoudre des problèmes d'actualisation des données en consultant les rapports d'actualisation des données consolidés dans le Tableau de bord de gestion PowerPivot dans l'Administration centrale.</span><span class="sxs-lookup"><span data-stu-id="13e57-231">SharePoint administrators can help you troubleshoot data refresh problems by viewing the consolidated data refresh reports in the PowerPivot Management Dashboard in Central Administration.</span></span> <span data-ttu-id="13e57-232">Pour plus d'informations, consultez [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span><span class="sxs-lookup"><span data-stu-id="13e57-232">For more information, see [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="13e57-233">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="13e57-233">See Also</span></span>  
 <span data-ttu-id="13e57-234">[Actualisation des données PowerPivot avec SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span><span class="sxs-lookup"><span data-stu-id="13e57-234">[PowerPivot Data Refresh with SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md) </span></span>  
 <span data-ttu-id="13e57-235">[Afficher l’historique d’actualisation des données &#40;PowerPivot pour SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span><span class="sxs-lookup"><span data-stu-id="13e57-235">[View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md) </span></span>  
 [<span data-ttu-id="13e57-236">Configurez les informations d’identification stockées pour l’actualisation des données PowerPivot &#40;PowerPivot pour SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="13e57-236">Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;</span></span>](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
