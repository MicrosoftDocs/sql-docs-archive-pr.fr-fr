---
title: Actualisation des données PowerPivot avec SharePoint 2010 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
ms.openlocfilehash: 01874bf521055d1441b695a238d09440021d2718
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704384"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a><span data-ttu-id="5751c-102">Actualisation des données PowerPivot avec SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="5751c-102">PowerPivot Data Refresh with SharePoint 2010</span></span>
  <span data-ttu-id="5751c-103">L'actualisation des données [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] est une opération côté serveur planifiée qui interroge des sources de données externes pour mettre à jour les données incorporées [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] dans un classeur Excel 2010 stocké dans la bibliothèque de contenus.</span><span class="sxs-lookup"><span data-stu-id="5751c-103">[!INCLUDE[ssGemini](../includes/ssgemini-md.md)]t data refresh is a scheduled server-side operation that queries external data sources to update embedded [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data in an Excel 2010 workbook that is stored in a content library.</span></span>

 <span data-ttu-id="5751c-104">L'actualisation des données est une fonctionnalité intégrée de [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] pour SharePoint, mais pour l'utiliser, vous devez exécuter des services spécifiques et des travaux de minuteur dans votre batterie SharePoint 2010.</span><span class="sxs-lookup"><span data-stu-id="5751c-104">Data refresh is a built-in feature of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint, but using it requires that you run specific services and timer jobs in your SharePoint 2010 farm.</span></span> <span data-ttu-id="5751c-105">Des étapes administratives supplémentaires, comme installer des fournisseurs de données et vérifier les autorisations des bases de données, sont souvent requises pour que l'actualisation des données réussisse.</span><span class="sxs-lookup"><span data-stu-id="5751c-105">Additional administrative steps, such as installing data providers and checking database permissions, are often required for data refresh to succeed.</span></span>

 <span data-ttu-id="5751c-106">**[!INCLUDE[applies](../includes/applies-md.md)]** SharePoint 2010</span><span class="sxs-lookup"><span data-stu-id="5751c-106">**[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010</span></span>

> [!NOTE]
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="5751c-107">et SharePoint Server 2013 Excel Services utilisent une architecture différente pour l'actualisation des données des modèles de données [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="5751c-107">and SharePoint Server 2013 Excel Services use a different architecture for data refresh of [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] data models.</span></span> <span data-ttu-id="5751c-108">La nouvelle architecture utilise Excel Services en tant que composant principal pour charger les modèles de données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-108">The new architecture utilizes Excel Services as the primary component to load PowerPivot data models.</span></span> <span data-ttu-id="5751c-109">L'architecture d'actualisation des données précédente reposait sur un serveur exécutant le service système PowerPivot et [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] en mode SharePoint afin de charger les modèles de données.</span><span class="sxs-lookup"><span data-stu-id="5751c-109">The previous data refresh architecture used relied on a server running PowerPivot System Service and [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] in SharePoint mode to load data models.</span></span> <span data-ttu-id="5751c-110">Pour plus d’informations, consultez [actualisation des données PowerPivot avec SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-110">For more information, see [PowerPivot Data Refresh with SharePoint 2013](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md).</span></span>

 <span data-ttu-id="5751c-111">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="5751c-111">**In this topic:**</span></span>

 [<span data-ttu-id="5751c-112">Étape 1 : activer Service Banque d’informations sécurisé et générer une clé principale</span><span class="sxs-lookup"><span data-stu-id="5751c-112">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>](#bkmk_services)

 [<span data-ttu-id="5751c-113">Étape 2 : désactiver les options d'informations d'identification que vous ne souhaitez pas prendre en charge</span><span class="sxs-lookup"><span data-stu-id="5751c-113">Step 2: Turn off credential options that you do not want to support</span></span>](#bkmk_creds)

 [<span data-ttu-id="5751c-114">Étape 3 : créer des applications cibles pour stocker les informations d'identification utilisées pour l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-114">Step 3: Create target applications to store credentials used in data refresh</span></span>](#bkmk_stored)

 [<span data-ttu-id="5751c-115">Étape 4 : configurer le serveur pour l'actualisation des données évolutive</span><span class="sxs-lookup"><span data-stu-id="5751c-115">Step 4: Configure the server for scalable data refresh</span></span>](#bkmk_scale)

 [<span data-ttu-id="5751c-116">Étape 5 : installer les fournisseurs de données utilisés pour importer les données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5751c-116">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>](#bkmk_installdp)

 [<span data-ttu-id="5751c-117">Étape 6 : octroyer les autorisations pour la création de planifications et l'accès aux sources de données externes</span><span class="sxs-lookup"><span data-stu-id="5751c-117">Step 6: Grant permissions to create schedules and access external data sources</span></span>](#bkmk_accounts)

 [<span data-ttu-id="5751c-118">Étape 7 : activer la mise à niveau de classeur pour l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-118">Step 7: Enable workbook upgrade for data refresh</span></span>](#bkmk_upgradewrkbk)

 [<span data-ttu-id="5751c-119">Étape 8 : vérifier la configuration de l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-119">Step 8: Verify data refresh configuration</span></span>](#bkmk_verify)

 [<span data-ttu-id="5751c-120">Modifier les paramètres de configuration de l'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-120">Modify Configuration Settings for Data Refresh</span></span>](#bkmk_config)

 [<span data-ttu-id="5751c-121">Replanifier le travail du minuteur d’actualisation des données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5751c-121">Reschedule the PowerPivot Data Refresh timer job</span></span>](#configTimerJob)

 [<span data-ttu-id="5751c-122">Désactiver le travail du minuteur d'actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-122">Disable the Data Refresh Timer Job</span></span>](#bkmk_disableDR)

 <span data-ttu-id="5751c-123">Une fois l'environnement de serveur et les autorisations configurés, vous pouvez utiliser l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-123">After you ensure that the server environment and permissions are configured, data refresh is ready to use.</span></span> <span data-ttu-id="5751c-124">Pour utiliser l'actualisation des données, un utilisateur SharePoint crée une planification sur un classeur PowerPivot qui spécifie quand et à quelle fréquence elle se produira.</span><span class="sxs-lookup"><span data-stu-id="5751c-124">To use data refresh, a SharePoint user creates a schedule on a PowerPivot workbook that specifies how often data refresh occurs.</span></span> <span data-ttu-id="5751c-125">C'est généralement le propriétaire du classeur qui crée la planification, ou bien l'auteur qui a publié le fichier sur SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5751c-125">Creating the schedule is typically done by the workbook owner or author who published the file to SharePoint.</span></span> <span data-ttu-id="5751c-126">Cette personne crée et gère les planifications d'actualisation des données pour les classeurs dont elle est propriétaire.</span><span class="sxs-lookup"><span data-stu-id="5751c-126">This person creates and manages the data refresh schedules for the workbooks that he or she owns.</span></span> <span data-ttu-id="5751c-127">Pour plus d’informations, consultez [planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-127">For more information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).</span></span>

##  <a name="step-1-enable-secure-store-service-and-generate-a-master-key"></a><a name="bkmk_services"></a><span data-ttu-id="5751c-128">Étape 1 : activer Service Banque d’informations sécurisé et générer une clé principale</span><span class="sxs-lookup"><span data-stu-id="5751c-128">Step 1: Enable Secure Store Service and Generate a Master Key</span></span>
 <span data-ttu-id="5751c-129">L'actualisation des données PowerPivot dépend du Service Banque d'informations sécurisé pour fournir les informations d'identification utilisées pour exécuter des travaux d'actualisation des données et se connecter aux sources de données externes qui utilisent les informations d'identification stockées.</span><span class="sxs-lookup"><span data-stu-id="5751c-129">PowerPivot data refresh depends on Secure Store Service to provide credentials used to run data refresh jobs and to connect to external data sources that use stored credentials.</span></span>

 <span data-ttu-id="5751c-130">Si vous avez installé PowerPivot pour SharePoint à l'aide de l'option Nouveau serveur, le Service Banque d'informations sécurisé est automatiquement configuré.</span><span class="sxs-lookup"><span data-stu-id="5751c-130">If you installed PowerPivot for SharePoint using the New Server option, the Secure Store Service is configured for you.</span></span> <span data-ttu-id="5751c-131">Pour tous les autres scénarios d'installation, vous devez créer et configurer une application de service et générer une clé de chiffrement principale pour le Service Banque d'informations sécurisé.</span><span class="sxs-lookup"><span data-stu-id="5751c-131">For all other installation scenarios, you must create and configure a service application and generate a master encryption key for Secure Store Service.</span></span>

> [!NOTE]
>  <span data-ttu-id="5751c-132">Vous devez être administrateur de batterie de serveurs pour configurer le service Banque d'informations sécurisé ou pour déléguer l'administration du service Banque d'informations sécurisé à un autre utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5751c-132">You must be a farm administrator to configure Secure Store Service or delegate Secure Store Service administration to another user.</span></span> <span data-ttu-id="5751c-133">Vous devez être administrateur d'application de service pour configurer ou modifier des paramètres après leur activation.</span><span class="sxs-lookup"><span data-stu-id="5751c-133">You must be a service application administrator to configure or modify settings after it is enabled.</span></span>

1.  <span data-ttu-id="5751c-134">Dans l'Administration centrale, sous Gestion des applications, cliquez sur **Gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="5751c-134">In Central Administration, in Application Management, click **Manage service applications**.</span></span>

2.  <span data-ttu-id="5751c-135">Dans le ruban applications de service, dans créer, cliquez sur **nouveau**.</span><span class="sxs-lookup"><span data-stu-id="5751c-135">In the Service Applications ribbon, in Create, click **New**.</span></span>

3.  <span data-ttu-id="5751c-136">Sélectionnez **service Banque d’informations sécurisé**.</span><span class="sxs-lookup"><span data-stu-id="5751c-136">Select **Secure Store Service**.</span></span>

4.  <span data-ttu-id="5751c-137">Dans la page **créer une application Banque d’enregistrement sécurisée** , entrez un nom pour l’application.</span><span class="sxs-lookup"><span data-stu-id="5751c-137">In the **Create Secure Store Application** page, enter a name for the application.</span></span>

5.  <span data-ttu-id="5751c-138">Dans **base de données**, spécifiez l’instance de SQL Server qui hébergera la base de données pour cette application de service.</span><span class="sxs-lookup"><span data-stu-id="5751c-138">In **Database**, specify the SQL Server instance that will host the database for this service application.</span></span> <span data-ttu-id="5751c-139">La valeur par défaut est l'instance du moteur de base de données SQL Server qui héberge les bases de données de configuration de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-139">The default value is the SQL Server Database Engine instance that hosts the farm configuration databases.</span></span>

6.  <span data-ttu-id="5751c-140">Dans **nom de la base de données**, entrez le nom de la base de données d’application de service.</span><span class="sxs-lookup"><span data-stu-id="5751c-140">In **Database Name**, enter the name of the service application database.</span></span> <span data-ttu-id="5751c-141">La valeur par défaut est Secure_Store_Service_DB_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="5751c-141">The default value is Secure_Store_Service_DB_\<guid>.</span></span> <span data-ttu-id="5751c-142">Le nom par défaut correspond au nom par défaut de l'application de service.</span><span class="sxs-lookup"><span data-stu-id="5751c-142">The default name corresponds to the default name of the service application.</span></span> <span data-ttu-id="5751c-143">Si vous avez entré un nom d'application de service unique, suivez une convention d'affectation des noms similaire pour la base de données afin de pouvoir les gérer ensemble.</span><span class="sxs-lookup"><span data-stu-id="5751c-143">If you entered a unique service application name, follow a similar naming convention for your database name so that you can manage them together.</span></span>

7.  <span data-ttu-id="5751c-144">Dans **Authentification de la base de données**, la valeur par défaut est Authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="5751c-144">In **Database Authentication**, the default is Windows Authentication.</span></span> <span data-ttu-id="5751c-145">Si vous choisissez Authentification SQL, reportez-vous au guide de l'administrateur SharePoint pour des recommandations concernant l'utilisation de ce type d'authentification dans votre batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-145">If you choose SQL Authentication, refer to the SharePoint administrator guide for guidance on how to use the authentication type in your farm.</span></span>

8.  <span data-ttu-id="5751c-146">Dans pool d’applications, sélectionnez **créer un nouveau pool d’applications.**</span><span class="sxs-lookup"><span data-stu-id="5751c-146">In Application Pool, select **Create new application pool.**</span></span> <span data-ttu-id="5751c-147">Spécifiez un nom descriptif qui permettra aux autres administrateurs de serveurs d'identifier la manière dont le pool d'applications est utilisé.</span><span class="sxs-lookup"><span data-stu-id="5751c-147">Specify a descriptive name that will help other server administrators identify how the application pool is used.</span></span>

9. <span data-ttu-id="5751c-148">Sélectionnez un compte de sécurité pour le pool d'applications.</span><span class="sxs-lookup"><span data-stu-id="5751c-148">Select a security account for the application pool.</span></span> <span data-ttu-id="5751c-149">Spécifiez un compte géré pour utiliser un compte d'utilisateur de domaine.</span><span class="sxs-lookup"><span data-stu-id="5751c-149">Specify a managed account to use a domain user account.</span></span>

10. <span data-ttu-id="5751c-150">Acceptez les valeurs par défaut restantes, puis cliquez sur **OK.**</span><span class="sxs-lookup"><span data-stu-id="5751c-150">Accept the remaining default values, and then click **OK.**</span></span> <span data-ttu-id="5751c-151">. L'application de service apparaît avec les autres services gérés dans la liste des applications de service de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-151">The service application will appear alongside other managed services in the farm's service application list.</span></span>

11. <span data-ttu-id="5751c-152">Cliquez sur l'application de service Banque d'informations sécurisé dans la liste.</span><span class="sxs-lookup"><span data-stu-id="5751c-152">Click the Secure Store Service application from the list.</span></span>

12. <span data-ttu-id="5751c-153">Dans le ruban applications de service, cliquez sur **gérer**.</span><span class="sxs-lookup"><span data-stu-id="5751c-153">In the Service Applications ribbon, click **Manage**.</span></span>

13. <span data-ttu-id="5751c-154">Dans gestion des clés, cliquez sur **générer une nouvelle clé**.</span><span class="sxs-lookup"><span data-stu-id="5751c-154">In Key Management, click **Generate New Key**.</span></span>

14. <span data-ttu-id="5751c-155">Entrez une phrase secrète et confirmez-la.</span><span class="sxs-lookup"><span data-stu-id="5751c-155">Enter and then confirm a pass phrase.</span></span> <span data-ttu-id="5751c-156">Elle sera utilisée pour ajouter d'autres applications de service Banque d'informations sécurisé partagé.</span><span class="sxs-lookup"><span data-stu-id="5751c-156">The pass phrase will be used to add additional secure store shared service applications.</span></span>

15. <span data-ttu-id="5751c-157">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="5751c-157">Click **OK**.</span></span>

 <span data-ttu-id="5751c-158">L'enregistrement de l'audit des opérations du Service Banque d'informations, utile à des fins de résolution des problèmes, doit être activé avant de pouvoir être utilisé.</span><span class="sxs-lookup"><span data-stu-id="5751c-158">Audit logging of Store Service operations, which is useful for troubleshooting purposes, must be enabled before it is available.</span></span> <span data-ttu-id="5751c-159">Pour plus d’informations sur l’activation de la journalisation, consultez [configurer des service Banque d’informations sécurisé (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span><span class="sxs-lookup"><span data-stu-id="5751c-159">For more information about how to enable logging, see [Configure Secure Store Service (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294).</span></span>

##  <a name="step-2-turn-off-credential-options-that-you-do-not-want-to-support"></a><a name="bkmk_creds"></a><span data-ttu-id="5751c-160">Étape 2 : désactiver les options d’informations d’identification que vous ne souhaitez pas prendre en charge</span><span class="sxs-lookup"><span data-stu-id="5751c-160">Step 2: Turn off credential options that you do not want to support</span></span>
 <span data-ttu-id="5751c-161">L'actualisation des données PowerPivot fournit trois options d'informations d'identification dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-161">PowerPivot data refresh provides three credential options in a data refresh schedule.</span></span> <span data-ttu-id="5751c-162">Lorsqu'un propriétaire de classeur planifie l'actualisation des données, il choisit l'une de ces options, en déterminant le compte sous lequel le travail d'actualisation des données s'exécute.</span><span class="sxs-lookup"><span data-stu-id="5751c-162">When a workbook owner schedules data refresh, he or she chooses one of these options, thereby determining the account under which the data refresh job runs.</span></span> <span data-ttu-id="5751c-163">En tant qu'administrateur, vous pouvez déterminer quelles options d'informations d'identification sont disponibles pour les propriétaires de planification.</span><span class="sxs-lookup"><span data-stu-id="5751c-163">As an administrator, you can determine which credential options are available to schedule owners.</span></span>

 <span data-ttu-id="5751c-164">Vous devez avoir au moins une option disponible pour que l'actualisation des données fonctionne.</span><span class="sxs-lookup"><span data-stu-id="5751c-164">You must have at least one option that is available in order for data refresh to work.</span></span>

 <span data-ttu-id="5751c-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="5751c-165">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="5751c-166">L’option 1, **utiliser le compte d’actualisation des données configuré par l’administrateur**, apparaît toujours sur la page définition de la planification, mais fonctionne uniquement si vous configurez le compte d’actualisation des données sans assistance.</span><span class="sxs-lookup"><span data-stu-id="5751c-166">Option 1, **Use the data refresh account configured by the administrator**, always appears on the schedule definition page, but only works if you configure the unattended data refresh account.</span></span> <span data-ttu-id="5751c-167">Pour plus d’informations sur la création du compte, consultez [configurer le compte d’actualisation des données PowerPivot sans assistance &#40;PowerPivot pour SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-167">For more information on how to create the account, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="5751c-168">L’option 2, **se connecter à l’aide des informations d’identification Windows suivantes**, s’affiche toujours sur la page, mais fonctionne uniquement lorsque vous activez l’option **autoriser les utilisateurs à entrer des informations d’identification Windows personnalisées** dans la page Configuration de l’application de service.</span><span class="sxs-lookup"><span data-stu-id="5751c-168">Option 2, **Connect using the following windows credentials**, always appears on the page, but only works when you enable the **Allow users to enter custom Windows credentials** option in the service application configuration page.</span></span> <span data-ttu-id="5751c-169">Cette option est activée par défaut, mais vous pouvez la désactiver si les inconvénients liés à son utilisation l'emportent sur les avantages (voir ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="5751c-169">This option is enabled by default, but you can disable it if the disadvantages of using it outweigh the advantages (see below).</span></span>

 <span data-ttu-id="5751c-170">L’option 3, **se connecter à l’aide des informations d’identification enregistrées dans service Banque d’informations sécurisé**, apparaît toujours sur la page, mais fonctionne uniquement lorsqu’un propriétaire de planification fournit une application cible valide.</span><span class="sxs-lookup"><span data-stu-id="5751c-170">Option 3, **Connect using the credentials saved in Secure Store Service**, always appears on the page, but only works when a schedule owner provides a valid target application.</span></span> <span data-ttu-id="5751c-171">Un administrateur doit créer ces applications cibles à l'avance, puis fournir le nom de l'application à ceux qui créent les planifications d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-171">An administrator must create these target applications in advance and then provide the application name to those who create the data refresh schedules.</span></span> <span data-ttu-id="5751c-172">Pour plus d’informations sur la création d’une application cible pour les opérations d’actualisation des données, consultez [configurer les informations d’identification stockées pour l’actualisation des données PowerPivot &#40;PowerPivot pour SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-172">For more information on how to create a target application for data refresh operations, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="5751c-173">**Configuration de l’option d’informations d’identification 2, « se connecter à l’aide des informations d’identification d’utilisateur Windows suivantes »**</span><span class="sxs-lookup"><span data-stu-id="5751c-173">**Configuring credential option 2, "Connect using the following Windows user credentials"**</span></span>

 <span data-ttu-id="5751c-174">Une application de service PowerPivot inclut une option d'informations d'identification qui permet aux propriétaires de planification d'entrer un nom d'utilisateur Windows arbitraire et un mot de passe pour l'exécution d'un travail d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-174">PowerPivot service application includes a credential option that allows schedule owners to enter an arbitrary Windows user name and password for running a data refresh job.</span></span> <span data-ttu-id="5751c-175">Il s'agit de la deuxième option d'informations d'identification dans la page de définition de la planification :</span><span class="sxs-lookup"><span data-stu-id="5751c-175">This is the second credential option in the schedule definition page:</span></span>

 <span data-ttu-id="5751c-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="5751c-176">![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")</span></span>

 <span data-ttu-id="5751c-177">Cette option d'identification est activée par défaut.</span><span class="sxs-lookup"><span data-stu-id="5751c-177">This credential option is enabled by default.</span></span> <span data-ttu-id="5751c-178">Lorsque cette option d'informations d'identification est activée, le service système PowerPivot génère une application cible dans le Service Banque d'informations sécurisé pour stocker le nom d'utilisateur et le mot de passe entrés par le propriétaire de la planification.</span><span class="sxs-lookup"><span data-stu-id="5751c-178">When this credential option is enabled, PowerPivot System Service will generate a target application in Secure Store Service to store the user name and password entered by the schedule owner.</span></span> <span data-ttu-id="5751c-179">Une application cible générée est créée à l’aide de cette Convention d’affectation de noms : PowerPivotDataRefresh_ \<guid> .</span><span class="sxs-lookup"><span data-stu-id="5751c-179">A generated target application is created using this naming convention: PowerPivotDataRefresh_\<guid>.</span></span> <span data-ttu-id="5751c-180">Une application de cible est créée pour chaque ensemble d'informations d'identification Windows.</span><span class="sxs-lookup"><span data-stu-id="5751c-180">One target application is created for each set of Windows credentials.</span></span> <span data-ttu-id="5751c-181">Si une application cible existe déjà, détenue par le service système PowerPivot, et stocke le nom d'utilisateur et le mot de passe entrés par la personne qui définit la planification, le service système PowerPivot utilisera cette application cible au lieu d'en créer une.</span><span class="sxs-lookup"><span data-stu-id="5751c-181">If a target application already exists that is owned by the PowerPivot System Service and stores the username and password entered by the person defining the schedule, PowerPivot System Service will use that target application rather than create a new one.</span></span>

 <span data-ttu-id="5751c-182">Le principal avantage de l'utilisation de cette option d'informations d'identification est la facilité d'utilisation et la simplicité.</span><span class="sxs-lookup"><span data-stu-id="5751c-182">The primary advantage of using this credential option is ease of use and simplicity.</span></span> <span data-ttu-id="5751c-183">Le travail préalable est minime, car les applications cibles sont créées pour vous.</span><span class="sxs-lookup"><span data-stu-id="5751c-183">Advance work is minimal because target applications are created for you.</span></span> <span data-ttu-id="5751c-184">En outre, l'exécution de l'actualisation des données sous les informations d'identification du propriétaire de la planification (qui est très probablement la personne qui a créé le classeur) simplifie les autorisations requises en aval.</span><span class="sxs-lookup"><span data-stu-id="5751c-184">Also, running data refresh under the credentials of the schedule owner (who is most likely the person who created the workbook) simplifies permission requirements downstream.</span></span> <span data-ttu-id="5751c-185">Très probablement, cet utilisateur dispose déjà des autorisations nécessaires sur la base de données cible.</span><span class="sxs-lookup"><span data-stu-id="5751c-185">Most likely, this user already has permissions on the target database.</span></span> <span data-ttu-id="5751c-186">Lorsque l’actualisation des données s’exécute sous l’identité d’utilisateur Windows de cette personne, toutes les connexions de données qui spécifient « utilisateur actuel » fonctionnent automatiquement.</span><span class="sxs-lookup"><span data-stu-id="5751c-186">When data refresh runs under this person's Windows user identity, any data connections that specify 'current user' will work automatically.</span></span>

 <span data-ttu-id="5751c-187">L'inconvénient est la fonction de gestion limitée.</span><span class="sxs-lookup"><span data-stu-id="5751c-187">The disadvantage is limited management capability.</span></span> <span data-ttu-id="5751c-188">Bien que les applications cibles soient créées automatiquement, elles ne sont pas supprimées ou mises à jour automatiquement à mesure que les informations sur le compte changent.</span><span class="sxs-lookup"><span data-stu-id="5751c-188">Although target applications are created automatically, they are not deleted automatically or updated as account information changes.</span></span> <span data-ttu-id="5751c-189">Avec les stratégies d'expiration des mots de passe, ces applications cibles risquent de devenir obsolètes.</span><span class="sxs-lookup"><span data-stu-id="5751c-189">Password expiration policies might cause these target applications to become out of date.</span></span> <span data-ttu-id="5751c-190">Les travaux d'actualisation des données qui utilisent des informations d'identification arrivées à expiration commenceront à échouer.</span><span class="sxs-lookup"><span data-stu-id="5751c-190">Data refresh jobs that use expired credentials will start to fail.</span></span> <span data-ttu-id="5751c-191">Lorsque cela se produit, les propriétaires de planification doivent mettre à jour leurs informations d'identification en fournissant des valeurs de nom d'utilisateur et de mot de passe actuelles dans une planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-191">When this occurs, schedule owners will need to update their credentials by providing current user name and password values in a data refresh schedule.</span></span> <span data-ttu-id="5751c-192">Une nouvelle application cible sera créée à ce stade.</span><span class="sxs-lookup"><span data-stu-id="5751c-192">A new target application will be created at that point.</span></span> <span data-ttu-id="5751c-193">Avec le temps, comme les utilisateurs ajoutent et modifient les informations d'identification dans leurs planifications d'actualisation des données, vous pouvez constater que vous avez un grand nombre d'applications cibles générées automatiquement sur votre système.</span><span class="sxs-lookup"><span data-stu-id="5751c-193">Over time, as users add and revise credential information in their data refresh schedules, you might find that you have a large number of auto-generated target applications on your system.</span></span>

 <span data-ttu-id="5751c-194">Actuellement, il n'existe aucune méthode pour déterminer lesquelles de ces applications cibles sont actives ou inactives, ni pour suivre une application cible spécifique jusqu'aux planifications d'actualisation des données qui l'utilisent.</span><span class="sxs-lookup"><span data-stu-id="5751c-194">Currently, there is no way to determine which of these target applications are active or inactive, nor is there a way to trace a specific target application back to the data refresh schedules that use it.</span></span> <span data-ttu-id="5751c-195">En général, vous devez vous abstenir de toucher aux applications cibles, car leur suppression peut entraver des planifications d'actualisation des données existantes.</span><span class="sxs-lookup"><span data-stu-id="5751c-195">In general, you should leave the target applications alone, as deleting them might break existing data refresh schedules.</span></span> <span data-ttu-id="5751c-196">La suppression d’une application cible qui est toujours en cours d’utilisation entraîne l’échec de l’actualisation des données avec le message « application cible introuvable », qui apparaît dans la page historique d’actualisation des données du classeur.</span><span class="sxs-lookup"><span data-stu-id="5751c-196">Deleting a target application that is still in use will cause data refresh to fail with the message, "Target application not found", appearing in the data refresh history page of the workbook.</span></span>

 <span data-ttu-id="5751c-197">Si vous devez choisir de désactiver cette option d'informations d'identification, vous pouvez supprimer sans risque toutes les applications cibles générées pour l'actualisation des données PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-197">Should you choose to disable this credential option, you can safely delete all of the target applications that were generated for PowerPivot data refresh.</span></span>

 <span data-ttu-id="5751c-198">**Désactiver l'utilisation d'informations d'identification Windows arbitraires dans les planifications d'actualisation des données**</span><span class="sxs-lookup"><span data-stu-id="5751c-198">**Disabling the use of arbitrary Windows credentials in data refresh schedules**</span></span>

1.  <span data-ttu-id="5751c-199">Dans administration centrale, dans gestion des applications, cliquez sur **gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="5751c-199">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="5751c-200">Cliquez sur le nom de l'application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-200">Click the PowerPivot service application name.</span></span> <span data-ttu-id="5751c-201">Le Tableau de bord de gestion PowerPivot apparaît.</span><span class="sxs-lookup"><span data-stu-id="5751c-201">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="5751c-202">Dans actions, cliquez sur configurer les paramètres de l' **application de service** pour ouvrir la page Paramètres de l’application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-202">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="5751c-203">Dans la section actualisation des données, désactivez la case à cocher **autoriser les utilisateurs à entrer des informations d’identification Windows personnalisées** .</span><span class="sxs-lookup"><span data-stu-id="5751c-203">In the Data Refresh section, clear the **Allow users to enter custom Windows credentials** checkbox.</span></span>

     <span data-ttu-id="5751c-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span><span class="sxs-lookup"><span data-stu-id="5751c-204">![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")</span></span>

##  <a name="step-3-create-target-applications-to-store-credentials-used-in-data-refresh"></a><a name="bkmk_stored"></a><span data-ttu-id="5751c-205">Étape 3 : créer des applications cibles pour stocker les informations d’identification utilisées lors de l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-205">Step 3: Create target applications to store credentials used in data refresh</span></span>
 <span data-ttu-id="5751c-206">Une fois le service Banque d'informations sécurisé configuré, les administrateurs SharePoint peuvent créer des applications cibles pour rendre les informations d'identification stockées disponibles à des fins d'actualisation des données, notamment le compte d'actualisation des données PowerPivot sans assistance ou tout autre compte utilisé pour exécuter le travail ou se connecter aux sources de données externes.</span><span class="sxs-lookup"><span data-stu-id="5751c-206">Once Secure Store Service is configured, SharePoint administrators can create target applications to make stored credentials available for data refresh purposes, including the PowerPivot unattended data refresh account or any other account that is used to either run the job or connect to external data sources.</span></span>

 <span data-ttu-id="5751c-207">Nous avons vu dans la section précédente que vous devez créer des applications cibles de façon à pouvoir utiliser certaines options d'informations d'identification.</span><span class="sxs-lookup"><span data-stu-id="5751c-207">Recall from the previous section that you need to create target applications in order for certain credential options to be usable.</span></span> <span data-ttu-id="5751c-208">Spécifiquement, vous devez créer des applications cibles pour le compte d'actualisation des données PowerPivot sans assistance, plus toutes les informations d'identification stockées supplémentaires dont vous pensez qu'elles seront utilisées dans les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-208">Specifically, you must create target applications for the PowerPivot unattended data refresh account, plus any additional stored credentials that you expect would be used in data refresh operations.</span></span>

 <span data-ttu-id="5751c-209">Pour plus d’informations sur la création d’applications cibles qui contiennent des informations d’identification stockées, consultez [configurer le compte d’actualisation des données PowerPivot sans assistance &#40;PowerPivot pour SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) et [configurer les informations d’identification stockées pour l’actualisation des données powerpivot &#40;PowerPivot pour SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-209">For more information about how to create target applications that contain stored credentials, see [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) and [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

##  <a name="step-4-configure-the-server-for-scalable-data-refresh"></a><a name="bkmk_scale"></a><span data-ttu-id="5751c-210">Étape 4 : configurer le serveur pour l’actualisation des données évolutive</span><span class="sxs-lookup"><span data-stu-id="5751c-210">Step 4: Configure the server for scalable data refresh</span></span>
 <span data-ttu-id="5751c-211">Par défaut, chaque installation PowerPivot pour SharePoint prend en charge à la fois des requêtes à la demande et l'actualisation des données planifiée.</span><span class="sxs-lookup"><span data-stu-id="5751c-211">By default, each PowerPivot for SharePoint installation supports both on-demand queries and scheduled data refresh.</span></span>

 <span data-ttu-id="5751c-212">Pour chaque installation, vous pouvez spécifier si l'instance de serveur Analysis Services prend en charge les requêtes et l'actualisation des données planifiée, ou est dédiée à un type d'opération spécifique.</span><span class="sxs-lookup"><span data-stu-id="5751c-212">For each installation, you can specify whether the Analysis Services server instance supports both query and scheduled data refresh, or is dedicated to a specific type of operation.</span></span> <span data-ttu-id="5751c-213">Si vous avez plusieurs installations de PowerPivot pour SharePoint dans votre batterie, vous pouvez envisager de consacrer un serveur uniquement aux opérations d'actualisation des données si vous constatez que les travaux sont différés ou échouent.</span><span class="sxs-lookup"><span data-stu-id="5751c-213">If you have multiple installations of PowerPivot for SharePoint in your farm, you might consider dedicating a server for just data refresh operations if you find that jobs are delayed or failing.</span></span>

 <span data-ttu-id="5751c-214">En outre, si le matériel sous-jacent prend en charge cette opération, vous pouvez augmenter le nombre de travaux d'actualisation des données qui s'exécutent en parallèle.</span><span class="sxs-lookup"><span data-stu-id="5751c-214">Additionally, if the underlying hardware supports it, you can increase the number of data refresh jobs that run in parallel.</span></span> <span data-ttu-id="5751c-215">Par défaut, le nombre de travaux qui peuvent s'exécuter en parallèle est calculé selon la mémoire système, mais vous pouvez augmenter ce nombre si vous disposez d'une capacité d'UC supplémentaire pour prendre en charge la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="5751c-215">By default, the number of jobs that can run in parallel is calculated based on system memory, but you can increase that number if you have additional CPU capacity to support the workload.</span></span>

 <span data-ttu-id="5751c-216">Pour plus d’informations, consultez [configurer l’actualisation des données dédiées ou le traitement des requêtes uniquement &#40;PowerPivot pour SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-216">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span>

##  <a name="step-5-install-data-providers-used-to-import-powerpivot-data"></a><a name="bkmk_installdp"></a><span data-ttu-id="5751c-217">Étape 5 : installer les fournisseurs de données utilisés pour importer les données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5751c-217">Step 5: Install Data Providers Used to Import PowerPivot Data</span></span>
 <span data-ttu-id="5751c-218">Une opération d'actualisation des données est essentiellement une répétition d'une opération d'importation ayant récupéré les données d'origine.</span><span class="sxs-lookup"><span data-stu-id="5751c-218">A data refresh operation is essentially a repeat of an import operation that retrieved the original data.</span></span> <span data-ttu-id="5751c-219">Cela signifie que les mêmes fournisseurs de données utilisés pour importer les données dans l'application cliente PowerPivot doivent également être installés sur le serveur PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-219">This means that the same data providers used to import the data in the PowerPivot client application must also be installed on the PowerPivot server.</span></span>

 <span data-ttu-id="5751c-220">Vous devez être un administrateur local pour installer des fournisseurs de données sur un serveur Windows.</span><span class="sxs-lookup"><span data-stu-id="5751c-220">You must be a local administrator to install data providers on a Windows server.</span></span> <span data-ttu-id="5751c-221">Si vous installez des pilotes supplémentaires, veillez à les installer sur chaque ordinateur dans la batterie de serveurs SharePoint qui possède une installation de PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5751c-221">If you install additional drivers, be sure to install them on each computer in the SharePoint farm that has an installation of PowerPivot for SharePoint.</span></span> <span data-ttu-id="5751c-222">Si vous avez plusieurs serveurs PowerPivot dans la batterie, vous devez installer les fournisseurs sur chacun.</span><span class="sxs-lookup"><span data-stu-id="5751c-222">If you have multiple PowerPivot servers in the farm, you must install the providers on each one.</span></span>

 <span data-ttu-id="5751c-223">n'oubliez pas que les serveurs SharePoint sont des applications 64 bits.</span><span class="sxs-lookup"><span data-stu-id="5751c-223">Remember that SharePoint servers are 64-bit applications.</span></span> <span data-ttu-id="5751c-224">Assurez-vous d'avoir installé la version 64 bits des fournisseurs de données que vous utilisez pour prendre en charge les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-224">Be sure to install the 64-bit version of the data providers you are using to support data refresh operations.</span></span>

##  <a name="step-6-grant-permissions-to-create-schedules-and-access-external-data-sources"></a><a name="bkmk_accounts"></a><span data-ttu-id="5751c-225">Étape 6 : accorder des autorisations pour créer des planifications et accéder à des sources de données externes</span><span class="sxs-lookup"><span data-stu-id="5751c-225">Step 6: Grant permissions to create schedules and access external data sources</span></span>
 <span data-ttu-id="5751c-226">Les propriétaires ou auteurs de classeurs doivent avoir l'autorisation **Collaboration** pour planifier des actualisation de données sur un classeur.</span><span class="sxs-lookup"><span data-stu-id="5751c-226">Workbook owners or authors must have **Contribute** permission to schedule data refresh on a workbook.</span></span> <span data-ttu-id="5751c-227">À partir de ce niveau d’autorisation, il peut ouvrir et modifier la page de configuration de l’actualisation des données du classeur pour spécifier les informations d’identification et de planification utilisées pour actualiser les données.</span><span class="sxs-lookup"><span data-stu-id="5751c-227">Given this permission level, he or she can open and edit the workbook's data refresh configuration page to specify the credentials and schedule information used to refresh the data.</span></span>

 <span data-ttu-id="5751c-228">En plus des autorisations SharePoint, les autorisations relatives à la base de données sur les sources de données externes doivent également être examinées pour vérifier que les comptes utilisés pendant l'actualisation des données ont des droits d'accès suffisants aux données.</span><span class="sxs-lookup"><span data-stu-id="5751c-228">In addition to SharePoint permissions, database permissions on external data sources must also be reviewed to ensure that accounts used during data refresh have sufficient access rights to the data.</span></span> <span data-ttu-id="5751c-229">La détermination des autorisations requises nécessite une évaluation prudente de votre part, car les autorisations que vous devez accorder varieront selon la chaîne de connexion dans le classeur et l'identité de l'utilisateur sous laquelle le travail d'actualisation des données s'exécute.</span><span class="sxs-lookup"><span data-stu-id="5751c-229">Determining permission requirements will require careful evaluation on your part because the permissions that you need to grant will vary depending on the connection string in the workbook and the user identity under which the data refresh job is running.</span></span>

 <span data-ttu-id="5751c-230">**Pourquoi les chaînes de connexion existantes dans un classeur PowerPivot comptent pour les opérations d'actualisation des données PowerPivot ?**</span><span class="sxs-lookup"><span data-stu-id="5751c-230">**Why existing connection strings in a PowerPivot workbook matter to PowerPivot data refresh operations**</span></span>

 <span data-ttu-id="5751c-231">Lorsque l'actualisation des données s'exécute, le serveur envoie une demande de connexion à la source de données externe à l'aide de la chaîne de connexion créée lors de l'importation d'origine des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-231">When data refresh runs, the server sends a connection request to the external data source using the connection string that was created when the data was originally imported.</span></span> <span data-ttu-id="5751c-232">L'emplacement du serveur, le nom de la base de données et les paramètres d'authentification spécifiés dans cette chaîne de connexion sont maintenant réutilisés pendant l'actualisation des données de façon à accéder aux mêmes sources de données.</span><span class="sxs-lookup"><span data-stu-id="5751c-232">The server location, database name, and authentication parameters specified in that connection string are now reused during data refresh to access the same data sources.</span></span> <span data-ttu-id="5751c-233">La chaîne de connexion et sa construction globale ne peuvent pas être modifiées à des fins d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-233">The connection string and its overall construction cannot be modified for data refresh purposes.</span></span> <span data-ttu-id="5751c-234">Elle est simplement réutilisée tel quel pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-234">It is simply reused as-is during data refresh.</span></span> <span data-ttu-id="5751c-235">Dans certains cas, si vous utilisez une authentification autre que l'authentification Windows pour vous connecter à une source de données, vous pouvez remplacer le nom d'utilisateur et le mot de passe dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="5751c-235">In some cases, if you are using non-Windows authentication to connect to a data source, you can override the user name and password in the connection string.</span></span> <span data-ttu-id="5751c-236">Vous trouverez plus d'informations à ce sujet plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="5751c-236">More detail about this is provided further on in this topic.</span></span>

 <span data-ttu-id="5751c-237">Pour la plupart des classeurs, l'option d'authentification par défaut sur la connexion consiste à utiliser des connexions approuvées ou la sécurité intégrée de Windows, provoquant des chaînes de connexion qui incluent `SSPI=IntegratedSecurity` ou `SSPI=TrustedConnection`.</span><span class="sxs-lookup"><span data-stu-id="5751c-237">For most workbooks, the default authentication option on the connection is to use trusted connections or Windows integrated security, resulting in connection strings that include `SSPI=IntegratedSecurity` or `SSPI=TrustedConnection`.</span></span> <span data-ttu-id="5751c-238">Lorsque cette chaîne de connexion est utilisée pendant l’actualisation des données, le compte utilisé pour exécuter le travail d’actualisation des données devient l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="5751c-238">When this connection string is used during data refresh, the account used to run the data refresh job becomes the 'current user'.</span></span> <span data-ttu-id="5751c-239">En tant que tel, ce compte a besoin d'autorisations de lecture sur toute source de données externe à laquelle il a accès via une connexion approuvée.</span><span class="sxs-lookup"><span data-stu-id="5751c-239">As such, this account needs read permissions on any external data source that is accessed via a trusted connection.</span></span>

 <span data-ttu-id="5751c-240">**Avez-vous activé le compte d'actualisation des données PowerPivot sans assistance ?**</span><span class="sxs-lookup"><span data-stu-id="5751c-240">**Did you enable the PowerPivot unattended data refresh account?**</span></span>

 <span data-ttu-id="5751c-241">Dans l'affirmative, vous devez accorder à ce compte des autorisations de lecture sur les sources de données auxquelles il accède pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-241">If yes, then you should grant that account read permissions on data sources that are accessed during data refresh.</span></span> <span data-ttu-id="5751c-242">La raison pour laquelle ce compte a besoin d’autorisations de lecture est que dans un classeur qui utilise les options d’authentification par défaut, le compte sans assistance est l’utilisateur actuel lors de l’actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-242">The reason why this account needs read permissions is because in a workbook that uses the default authentication options, the unattended account will be the 'current user' during data refresh.</span></span> <span data-ttu-id="5751c-243">À moins que le propriétaire de planification remplace les informations d'identification dans la chaîne de connexion, ce compte aura besoin d'autorisations de lecture sur un nombre illimité de sources de données utilisées activement dans votre organisation.</span><span class="sxs-lookup"><span data-stu-id="5751c-243">Unless the schedule owner overrides the credentials in the connection string, this account will need read permissions on any number of data sources that are actively used in your organization.</span></span>

 <span data-ttu-id="5751c-244">**Utilisez-vous l'option d'informations d'identification 2 : permettre au propriétaire de planification d'entrer un nom d'utilisateur Windows et un mot de passe ?**</span><span class="sxs-lookup"><span data-stu-id="5751c-244">**Are you using credential option 2: allowing the schedule owner to enter a Windows user name and password?**</span></span>

 <span data-ttu-id="5751c-245">En général, les utilisateurs qui créent des classeurs PowerPivot disposent déjà des autorisations suffisantes, car ils ont déjà importé les données en premier lieu.</span><span class="sxs-lookup"><span data-stu-id="5751c-245">Typically, users who create PowerPivot workbooks already have sufficient permissions because he or she already imported the data in the first place.</span></span> <span data-ttu-id="5751c-246">Si ces utilisateurs configurent par la suite l'actualisation des données de façon à ce qu'elle s'exécute sous leur propre identité d'utilisateur Windows, leur compte d'utilisateur Windows, qui a déjà des droits sur la base de données, sera utilisé pour extraire les données pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-246">If these users subsequently configure data refresh to run under their own Windows user identity, their Windows user account, which already has rights on the database, will be used to retrieve data during data refresh.</span></span> <span data-ttu-id="5751c-247">Les autorisations existantes doivent être suffisantes.</span><span class="sxs-lookup"><span data-stu-id="5751c-247">Existing permissions should be sufficient.</span></span>

 <span data-ttu-id="5751c-248">**Utilisez-vous l'option d'informations d'identification 3 : utilisation d'une application cible du service Banque d'informations sécurisé pour fournir une identité d'utilisateur en vue de l'exécution des travaux d'actualisation des données ?**</span><span class="sxs-lookup"><span data-stu-id="5751c-248">**Are you using credential option 3: using a Secure Store Service target application to provide a user identity for running data refresh jobs?**</span></span>

 <span data-ttu-id="5751c-249">Tout compte utilisé pour exécuter un travail d'actualisation des données a besoin d'autorisations d'accès en lecture, pour les mêmes raisons que celles décrites pour le compte d'actualisation des données PowerPivot sans assistance.</span><span class="sxs-lookup"><span data-stu-id="5751c-249">Any account used to run a data refresh job needs read permissions, for the same reasons as those described for the PowerPivot unattended data refresh account.</span></span>

 <span data-ttu-id="5751c-250">**Comment vérifier les chaînes de connexion pour déterminer si vous pouvez remplacer les informations d'identification utilisées pendant l'actualisation des données**</span><span class="sxs-lookup"><span data-stu-id="5751c-250">**How to check connection strings to determine whether you can override credentials used during data refresh**</span></span>

 <span data-ttu-id="5751c-251">Comme indiqué précédemment, vous pouvez remplacer un nom d'utilisateur et mot de passe au niveau du travail d'actualisation des données si la connexion utilise une authentification autre que l'authentification Windows (par exemple, l'authentification SQL Server).</span><span class="sxs-lookup"><span data-stu-id="5751c-251">As previously noted, you can substitute a different user name and password at the data refresh job level if the connection is using non-Windows authentication (for example, SQL Server authentication).</span></span> <span data-ttu-id="5751c-252">Les informations d'identification non-Windows sont passées à la chaîne de connexion à l'aide des paramètres ID d'utilisateur et Mot de passe.</span><span class="sxs-lookup"><span data-stu-id="5751c-252">Non-Windows credentials are passed on the connection string using the User ID and Password parameters.</span></span> <span data-ttu-id="5751c-253">Si votre classeur contient une chaîne de connexion avec ces paramètres, vous pouvez spécifier éventuellement un autre nom d'utilisateur et un mot de passe pour l'actualisation des données de cette source de données.</span><span class="sxs-lookup"><span data-stu-id="5751c-253">If your workbook contains a connection string with these parameters, you can optionally specify a different user name and password for refreshing data from that data source.</span></span>

 <span data-ttu-id="5751c-254">Les étapes suivantes expliquent comment déterminer si vous avez une chaîne de connexion qui accepte les substitutions de nom d'utilisateur et de mot de passe.</span><span class="sxs-lookup"><span data-stu-id="5751c-254">The following steps explain how to determine whether you have a connection string that accepts user name and password overrides.</span></span>

1.  <span data-ttu-id="5751c-255">Ouvrez le classeur dans Excel.</span><span class="sxs-lookup"><span data-stu-id="5751c-255">Open the workbook in Excel.</span></span>

2.  <span data-ttu-id="5751c-256">Ouvrez fenêtre PowerPivot (dans Excel, sur le ruban PowerPivot, cliquez sur Fenêtre PowerPivot).</span><span class="sxs-lookup"><span data-stu-id="5751c-256">Open the PowerPivot window (in Excel, on the PowerPivot ribbon, click PowerPivot Window).</span></span>

3.  <span data-ttu-id="5751c-257">Cliquez sur **conception**.</span><span class="sxs-lookup"><span data-stu-id="5751c-257">Click **Design**.</span></span>

4.  <span data-ttu-id="5751c-258">Cliquez sur **connexions existantes**.</span><span class="sxs-lookup"><span data-stu-id="5751c-258">Click **Existing Connections**.</span></span>

     <span data-ttu-id="5751c-259">Toutes les connexions utilisées dans le classeur sont répertoriées sous **connexions de données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="5751c-259">All of the connections used in the workbook are listed under **PowerPivot Data Connections**.</span></span>

5.  <span data-ttu-id="5751c-260">Sélectionnez la connexion et cliquez sur **modifier**, puis sur **avancé**.</span><span class="sxs-lookup"><span data-stu-id="5751c-260">Select the connection and click **Edit**, and then click **Advanced**.</span></span> <span data-ttu-id="5751c-261">La chaîne de connexion est en bas de la page.</span><span class="sxs-lookup"><span data-stu-id="5751c-261">The connection string is at the bottom of the page.</span></span>

 <span data-ttu-id="5751c-262">Si vous voyez **Integrated Security = SSPI** dans la chaîne de connexion, vous ne pouvez pas remplacer les informations d’identification dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="5751c-262">If you see **Integrated Security=SSPI** in the connection string, you cannot override the credentials in the connection string.</span></span> <span data-ttu-id="5751c-263">La connexion utilisera toujours l'utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="5751c-263">The connection will always use the current user.</span></span> <span data-ttu-id="5751c-264">Toutes les informations d'identification que vous spécifiées sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="5751c-264">Any credentials that you provide are ignored.</span></span>

 <span data-ttu-id="5751c-265">Si vous voyez **Persist Security Info = false, password = \* \* \* \* \* \* \* \* \* \* \* , userid \<userlogin> =**, vous avez une chaîne de connexion qui accepte les substitutions d’informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="5751c-265">If you see **Persist Security Info=False, Password=\*\*\*\*\*\*\*\*\*\*\*, UserID=\<userlogin>**,then you have a connection string that will accept credential overrides.</span></span> <span data-ttu-id="5751c-266">Les informations d'identification qui s'affichent dans une chaîne de connexion (comme UserID et Password) ne sont pas des informations d'identification Windows, mais plutôt des connexions à une base de données ou d'autres comptes d'ouverture de session qui sont valides pour la source de données cible.</span><span class="sxs-lookup"><span data-stu-id="5751c-266">Credentials that appear in a connection string (such as UserID and Password) are not Windows credentials, but rather database logins or other sign-in accounts that are valid for the target data source.</span></span>

 <span data-ttu-id="5751c-267">**Comment remplacer des informations d'identification dans la chaîne de connexion**</span><span class="sxs-lookup"><span data-stu-id="5751c-267">**How to override credentials in the connection string**</span></span>

 <span data-ttu-id="5751c-268">Le remplacement des informations d'identification s'effectue en spécifiant les informations d'identification de la source de données dans la planification d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-268">Overriding credentials is done by specifying data source credentials in the data refresh schedule.</span></span> <span data-ttu-id="5751c-269">En tant qu'administrateur, vous pouvez spécifier une application cible dans le Service Banque d'informations sécurisé qui mappe les informations d'identification utilisées pour accéder aux données externes.</span><span class="sxs-lookup"><span data-stu-id="5751c-269">As an administrator, you can provide a target application in Secure Store Service that maps the credentials used to access external data.</span></span> <span data-ttu-id="5751c-270">Le propriétaire de la planification peut ensuite entrer l'ID de l'application cible dans la planification d'actualisation des données qu'il définit.</span><span class="sxs-lookup"><span data-stu-id="5751c-270">The schedule owner can then enter the target application ID in the data refresh schedule that he or she defines.</span></span> <span data-ttu-id="5751c-271">Pour plus d’informations sur la création de cette application cible, consultez [configurer les informations d’identification stockées pour l’actualisation des données PowerPivot &#40;PowerPivot pour SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-271">For more information about creating this target application, see [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).</span></span>

 <span data-ttu-id="5751c-272">Le propriétaire de la planification peut également taper l'ensemble des informations d'identification utilisées pour se connecter aux sources de données pendant l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-272">Alternatively, the schedule owner can type in the set of credentials that are used to connect to data sources during data refresh.</span></span> <span data-ttu-id="5751c-273">L'illustration ci-dessous montre cette option de source de données dans la page de définition de la planification.</span><span class="sxs-lookup"><span data-stu-id="5751c-273">The following illustration shows this data source option in the schedule definition page.</span></span>

 <span data-ttu-id="5751c-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span><span class="sxs-lookup"><span data-stu-id="5751c-274">![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")</span></span>

 <span data-ttu-id="5751c-275">**Identification des conditions d'accès aux données requises**</span><span class="sxs-lookup"><span data-stu-id="5751c-275">**Identifying data access requirements**</span></span>

 <span data-ttu-id="5751c-276">Comme mentionné dans les sections précédentes, le compte utilisé pour exécuter l'actualisation des données et se connecte aux sources de données externes est souvent le même.</span><span class="sxs-lookup"><span data-stu-id="5751c-276">As noted in previous sections, the account used to run data refresh and connect to external data sources is often one and the same.</span></span> <span data-ttu-id="5751c-277">De ce fait, le compte utilisé pour accéder aux sources de données externes est déterminé par les options définies dans cette partie de la page de planification de l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-277">As such, the account used to access external data sources is determined by the options set in this part of the data refresh schedule page.</span></span> <span data-ttu-id="5751c-278">Ce peut être le compte d'actualisation des données PowerPivot sans assistance, le compte Windows d'un utilisateur individuel, ou le compte stocké dans une application cible prédéfinie.</span><span class="sxs-lookup"><span data-stu-id="5751c-278">This might be the PowerPivot unattended data refresh account, the Windows account of an individual user, or the account that is stored in a predefined target application.</span></span>

 <span data-ttu-id="5751c-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span><span class="sxs-lookup"><span data-stu-id="5751c-279">![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")</span></span>

 <span data-ttu-id="5751c-280">Dans les cas où le compte utilisé pour exécuter l'actualisation des données est différent du compte utilisé pour importer les données (par exemple, le compte d'actualisation des données PowerPivot sans assistance via l'option d'informations d'identification 1, ou un autre ensemble d'informations d'identification stockées via l'option 3), vous devrez créer une connexion à une base de données pour ce compte et lui accorder des autorisations de lecture sur les sources de données externes.</span><span class="sxs-lookup"><span data-stu-id="5751c-280">In cases where the account used to run data refresh is different from the account used to import data (for example, the PowerPivot unattended data refresh account via credential option one, or some other set of stored credentials via credential option three), you will need to create a new database login for that account and grant it read permissions on the external data sources.</span></span>

 <span data-ttu-id="5751c-281">Après avoir compris quels comptes requièrent l'accès aux données, vous pouvez commencer à vérifier les autorisations sur les sources de données utilisées le plus souvent dans les classeurs PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-281">Once you understand which accounts require data access, you can begin to check permissions on the data sources that are most often used in PowerPivot workbooks.</span></span> <span data-ttu-id="5751c-282">Démarrez avec des entrepôts de données ou des bases de données de création de rapports utilisés activement, mais sollicitez également l'entrée de vos utilisateurs PowerPivot les plus actifs pour déterminer quelles sources de données ils utilisent.</span><span class="sxs-lookup"><span data-stu-id="5751c-282">Start with any data warehouses or reporting databases that are actively used, but also solicit input from your most active PowerPivot users to find out which data sources they are using.</span></span> <span data-ttu-id="5751c-283">Une fois que vous avez une liste de sources de données, vous pouvez commencer à vérifier chacune d'entre elles de façon à vous assurer que les autorisations sont définies correctement.</span><span class="sxs-lookup"><span data-stu-id="5751c-283">Once you have a list of data sources, you can begin checking each one to ensure that permissions are set correctly.</span></span>

##  <a name="step-7-enable-workbook-upgrade-for-data-refresh"></a><a name="bkmk_upgradewrkbk"></a><span data-ttu-id="5751c-284">Étape 7 : activer la mise à niveau du classeur pour l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-284">Step 7: Enable workbook upgrade for data refresh</span></span>
 <span data-ttu-id="5751c-285">Par défaut, les classeurs créés à l'aide de la version [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] de PowerPivot pour Excel ne peuvent pas être configurés pour l'actualisation des données planifiée sur une version [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] de PowerPivot pour SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5751c-285">By default, workbooks that were created using the [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] version of PowerPivot for Excel cannot be configured for scheduled data refresh on a [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] version of PowerPivot for SharePoint.</span></span> <span data-ttu-id="5751c-286">Si vous hébergez des versions anciennes et récentes des classeurs PowerPivot dans votre environnement SharePoint, vous devez d'abord mettre à niveau tous les classeurs [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] avant qu'ils ne puissent être planifiés pour une actualisation automatique des données sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="5751c-286">If you host newer and older versions of PowerPivot workbooks in your SharePoint environment, you must upgrade any [!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] workbooks first before they can be scheduled for automatic data refresh on the server.</span></span>

##  <a name="step-8-verify-data-refresh-configuration"></a><a name="bkmk_verify"></a><span data-ttu-id="5751c-287">Étape 8 : vérifier la configuration de l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-287">Step 8: Verify data refresh configuration</span></span>
 <span data-ttu-id="5751c-288">Pour vérifier l'actualisation des données, vous devez avoir un classeur PowerPivot publié sur un site SharePoint.</span><span class="sxs-lookup"><span data-stu-id="5751c-288">To verify data refresh, you must have a PowerPivot workbook that is published to a SharePoint site.</span></span> <span data-ttu-id="5751c-289">Vous devez avoir des autorisations Collaboration sur le classeur et des autorisations d'accès à toutes les sources de données incluses dans la planification de l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-289">You must have Contribute permissions on the workbook and permissions to access any data sources that are included in the data refresh schedule.</span></span>

 <span data-ttu-id="5751c-290">Lorsque vous créez la planification, activez la case à cocher **aussi actualiser dès que possible** pour exécuter immédiatement l’actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-290">When you create the schedule, select the **Also refresh as soon as possible** checkbox to run data refresh immediately.</span></span> <span data-ttu-id="5751c-291">Vous pouvez ensuite examiner la page d'historique d'actualisation des données de ce classeur pour vérifier qu'elle s'est exécutée avec succès.</span><span class="sxs-lookup"><span data-stu-id="5751c-291">You can then check the data refresh history page of that workbook to verify that it ran successfully.</span></span> <span data-ttu-id="5751c-292">N'oubliez pas que le travail du minuteur d'actualisation des données PowerPivot s'exécute toutes les minutes.</span><span class="sxs-lookup"><span data-stu-id="5751c-292">Recall that the PowerPivot Data Refresh timer job runs every minute.</span></span> <span data-ttu-id="5751c-293">Il faut autant de temps pour d'obtenir la confirmation de réussite de l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-293">It will take at least that long to get confirmation that data refresh succeeded.</span></span>

 <span data-ttu-id="5751c-294">Veillez à essayer toutes les options d'informations d'identification que vous projetez de prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="5751c-294">Be sure to try all of the credential options you plan to support.</span></span> <span data-ttu-id="5751c-295">Par exemple, si vous avez configuré le compte d'actualisation des données PowerPivot sans assistance, vérifiez que l'actualisation des données réussit à l'aide de cette option.</span><span class="sxs-lookup"><span data-stu-id="5751c-295">For example, if you configured the PowerPivot unattended data refresh account, verify that data refresh succeeds using that option.</span></span> <span data-ttu-id="5751c-296">Pour plus d’informations sur la planification et l’affichage des informations d’État, consultez [planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) et [afficher l’historique d’actualisation des données &#40;PowerPivot pour SharePoint ](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)&#41;.</span><span class="sxs-lookup"><span data-stu-id="5751c-296">For more information about scheduling and viewing status information, see [Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) and [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="5751c-297">Si l’actualisation des données échoue, reportez-vous à la page [résolution des problèmes d’actualisation des données PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) sur le wiki TechNet pour les solutions possibles.</span><span class="sxs-lookup"><span data-stu-id="5751c-297">If data refresh fails, refer to the [Troubleshooting PowerPivot Data Refresh](https://go.microsoft.com/fwlink/?LinkID=223279) page on the TechNet wiki for possible solutions.</span></span>

##  <a name="modify-configuration-settings-for-data-refresh"></a><a name="bkmk_config"></a><span data-ttu-id="5751c-298">Modifier les paramètres de configuration pour l’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-298">Modify Configuration Settings for Data Refresh</span></span>
 <span data-ttu-id="5751c-299">Chaque application de service PowerPivot possède des paramètres de configuration qui affectent les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-299">Each PowerPivot service application has configuration settings that affect data refresh operations.</span></span> <span data-ttu-id="5751c-300">Cette section explique comment modifier ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="5751c-300">This section explains how to modify those settings.</span></span>

###  <a name="set-business-hours-to-determine-off-hours-processing"></a><a name="procIntervals"></a><span data-ttu-id="5751c-301">Définir les « heures de travail » pour déterminer le traitement en dehors des heures d’ouverture</span><span class="sxs-lookup"><span data-stu-id="5751c-301">Set 'Business Hours' to determine off-hours processing</span></span>
 <span data-ttu-id="5751c-302">Les utilisateurs SharePoint qui planifient des opérations d'actualisation des données peuvent spécifier une heure de début au plus tôt « Après les heures d'ouverture ».</span><span class="sxs-lookup"><span data-stu-id="5751c-302">SharePoint users who schedule data refresh operations can specify an earliest start time of "After business hours".</span></span> <span data-ttu-id="5751c-303">Ils ont ainsi la possibilité de récupérer les données de transaction qui se sont accumulées pendant la journée de travail.</span><span class="sxs-lookup"><span data-stu-id="5751c-303">This may be useful if they want to retrieve business transaction data that accumulated during the business day.</span></span> <span data-ttu-id="5751c-304">En tant qu'administrateur de batterie de serveurs, vous pouvez spécifier la plage horaire qui définit au mieux la journée de travail dans votre organisation.</span><span class="sxs-lookup"><span data-stu-id="5751c-304">As a farm administrator, you can specify the range of hours that best defines a business day for your organization.</span></span> <span data-ttu-id="5751c-305">Si vous définissez cette journée de sorte qu'elle s'étende de 04:00 à 20:00, le traitement de l'actualisation des données basé sur l'heure de début « Après les heures d'ouverture » commence à 20:01.</span><span class="sxs-lookup"><span data-stu-id="5751c-305">If you define the business day to be from 04:00 to 20:00, then data refresh processing that is based on an "After business hours" start time will begin at 20:01.</span></span>

 <span data-ttu-id="5751c-306">Les requêtes d'actualisation des données qui s'exécutent en dehors des heures d'ouverture sont ajoutées à la file d'attente dans leur ordre de réception.</span><span class="sxs-lookup"><span data-stu-id="5751c-306">Data refresh requests that run during off-hours are added to the queue in the order in which the request is received.</span></span> <span data-ttu-id="5751c-307">Les requêtes individuelles sont traitées à mesure que des ressources du serveur se libèrent.</span><span class="sxs-lookup"><span data-stu-id="5751c-307">Individual requests will be processed as server resources become available.</span></span>

1.  <span data-ttu-id="5751c-308">Dans administration centrale, dans gestion des applications, cliquez sur **gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="5751c-308">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="5751c-309">Cliquez sur le nom de l'application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-309">Click the PowerPivot service application name.</span></span> <span data-ttu-id="5751c-310">Le Tableau de bord de gestion PowerPivot apparaît.</span><span class="sxs-lookup"><span data-stu-id="5751c-310">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="5751c-311">Dans actions, cliquez sur configurer les paramètres de l' **application de service** pour ouvrir la page Paramètres de l’application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-311">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="5751c-312">Dans la section Actualisation des données, dans Heures d'ouverture, entrez une heure de début et une heure de fin indiquant la période de traitement après les heures d'ouverture.</span><span class="sxs-lookup"><span data-stu-id="5751c-312">In the Data Refresh section, in Business Hours, enter a start time and end time that defines the after business hours processing period.</span></span>

     <span data-ttu-id="5751c-313">Si vous ne souhaitez pas définir de période de traitement en dehors des heures d'ouverture, vous pouvez entrer la même valeur à la fois pour Heure de début et pour Heure de fin (par exemple, 12:00 pour les deux).</span><span class="sxs-lookup"><span data-stu-id="5751c-313">If you do not want an off-hours processing period defined, you can enter the same value for both Start Time and End Time (for example, 12:00 for both times).</span></span> <span data-ttu-id="5751c-314">Sachez toutefois que les pages de définition de la planification sur les sites SharePoint proposeront tout de même une option « Après les heures d'ouverture ».</span><span class="sxs-lookup"><span data-stu-id="5751c-314">However, be aware that the schedule definition pages on the SharePoint sites will still have "After business hours" as an option.</span></span> <span data-ttu-id="5751c-315">Des utilisateurs qui sélectionnent cette option sur une batterie de serveurs pour laquelle aucune plage de traitement en dehors des heures d'ouverture n'est définie peuvent alors recevoir des erreurs d'actualisation des données en rapport avec l'échec du démarrage de tel ou tel travail de traitement.</span><span class="sxs-lookup"><span data-stu-id="5751c-315">Users who select that option on a farm that has no off-hour processing range defined for it will eventually get data refresh errors as processing jobs fail to start.</span></span>

5.  <span data-ttu-id="5751c-316">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="5751c-316">Click **OK**.</span></span>

###  <a name="limit-how-long-data-refresh-history-is-retained"></a><a name="usagehist"></a><span data-ttu-id="5751c-317">Limiter la durée de conservation de l’historique d’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-317">Limit how long data refresh history is retained</span></span>
 <span data-ttu-id="5751c-318">L'historique d'actualisation des données est un enregistrement détaillé des messages d'échec et de réussite générés au fil du temps pour les opérations d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-318">Data refresh history is a detailed record of the success and failure messages that are generated for data refresh operations over time.</span></span> <span data-ttu-id="5751c-319">Les informations d'historique sont collectées et gérées via le système de collecte des données d'utilisation de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-319">History information is gathered and managed through the usage data collection system in the farm.</span></span> <span data-ttu-id="5751c-320">En tant que telles, les limites que vous définissez pour l'historique des données d'utilisation s'appliquent également à l'historique d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-320">As such, limits that you set on usage data history also apply to data refresh history.</span></span> <span data-ttu-id="5751c-321">Dans la mesure où les rapports sur l'utilisation rassemblent des données provenant de l'ensemble du système PowerPivot, un même paramètre d'historique permet de contrôler la rétention des données aussi bien pour l'historique d'actualisation des données que pour toutes les autres données d'utilisation collectées et stockées.</span><span class="sxs-lookup"><span data-stu-id="5751c-321">Because the usage activity reports pull together data from across the PowerPivot system, a single history setting is used to control data retention for both data refresh history and all other usage data that is collected and stored.</span></span>

1.  <span data-ttu-id="5751c-322">Dans administration centrale, dans gestion des applications, cliquez sur **gérer les applications de service**.</span><span class="sxs-lookup"><span data-stu-id="5751c-322">In Central Administration, in Application Management, click **Manage Service Applications**.</span></span>

2.  <span data-ttu-id="5751c-323">Cliquez sur le nom de l'application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-323">Click the PowerPivot service application name.</span></span> <span data-ttu-id="5751c-324">Le Tableau de bord de gestion PowerPivot apparaît.</span><span class="sxs-lookup"><span data-stu-id="5751c-324">The PowerPivot Management Dashboard appears.</span></span>

3.  <span data-ttu-id="5751c-325">Dans actions, cliquez sur configurer les paramètres de l' **application de service** pour ouvrir la page Paramètres de l’application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-325">In Actions, click **Configure service application settings** to open the PowerPivot Service Application Settings page</span></span>

4.  <span data-ttu-id="5751c-326">Dans la section Collection des données d'utilisation, dans Historique des données d'utilisation, tapez le nombre de jours pendant lequel vous souhaitez conserver un enregistrement de l'activité d'actualisation des données pour chaque classeur.</span><span class="sxs-lookup"><span data-stu-id="5751c-326">In the Usage Data Collection section, in Usage Data History, type the number of days for which you want to keep a record of data refresh activity for each workbook.</span></span>

     <span data-ttu-id="5751c-327">La valeur par défaut est 365 jours.</span><span class="sxs-lookup"><span data-stu-id="5751c-327">The default is 365 days.</span></span> <span data-ttu-id="5751c-328">La valeur minimale est 1 jour ; la valeur maximale 5 000 jours.</span><span class="sxs-lookup"><span data-stu-id="5751c-328">The minimum value is 1 day and the maximum is 5000 days.</span></span> <span data-ttu-id="5751c-329">La valeur 0 spécifie une période de rétention illimitée ; les données ne sont jamais supprimées.</span><span class="sxs-lookup"><span data-stu-id="5751c-329">0 specifies an unlimited retention period; data is never deleted.</span></span> <span data-ttu-id="5751c-330">Notez qu'il n'y a aucun paramètre pour désactiver l'historique.</span><span class="sxs-lookup"><span data-stu-id="5751c-330">Note that there is no setting for turning off history.</span></span>

5.  <span data-ttu-id="5751c-331">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="5751c-331">Click **OK**.</span></span>

 <span data-ttu-id="5751c-332">Les utilisateurs SharePoint peuvent accéder aux informations d'historique en choisissant l'option Gérer l'actualisation des données d'un classeur assorti d'un historique d'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-332">History information is made available to SharePoint users when they choose the Manage Data Refresh option on a workbook that has a data refresh history.</span></span> <span data-ttu-id="5751c-333">Ces informations sont également présentées dans le Tableau de bord de gestion PowerPivot utilisé par les administrateurs de batterie de serveurs pour gérer le fonctionnement des services PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-333">This information is also used in the PowerPivot Management Dashboard used by farm administrators to manage PowerPivot service operations.</span></span> <span data-ttu-id="5751c-334">Pour plus d’informations, consultez [afficher l’historique d’actualisation des données &#40;PowerPivot pour SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-334">For more information, see [View Data Refresh History &#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).</span></span>

 <span data-ttu-id="5751c-335">Pour l'application de service PowerPivot, le stockage physique à long terme des données d'historique s'effectue dans la base de données de l'application de service PowerPivot.</span><span class="sxs-lookup"><span data-stu-id="5751c-335">Long-term physical storage of history data is in the PowerPivot service application database for the PowerPivot service application.</span></span> <span data-ttu-id="5751c-336">Pour plus d’informations sur la façon dont les données d’utilisation sont collectées et stockées, consultez [collecte des données d’utilisation PowerPivot](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-336">For more information about how usage data is collected and stored, see [PowerPivot Usage Data Collection](power-pivot-sharepoint/power-pivot-usage-data-collection.md).</span></span>

##  <a name="reschedule-the-powerpivot-data-refresh-timer-job"></a><a name="configTimerJob"></a><span data-ttu-id="5751c-337">Replanifier le travail du minuteur d’actualisation des données PowerPivot</span><span class="sxs-lookup"><span data-stu-id="5751c-337">Reschedule the PowerPivot Data Refresh timer job</span></span>
 <span data-ttu-id="5751c-338">L'actualisation des données planifiée est déclenchée par un travail du minuteur d'actualisation des données PowerPivot qui analyse les informations de planification figurant dans la base de données de l'application de service PowerPivot à intervalles d'une minute.</span><span class="sxs-lookup"><span data-stu-id="5751c-338">Scheduled data refresh is triggered by a PowerPivot Data Refresh timer job that scans schedule information in the PowerPivot service application database at one minute intervals.</span></span> <span data-ttu-id="5751c-339">Lorsque l'actualisation des données est sur le point de commencer, le travail du minuteur ajoute la requête à une file d'attente de traitement d'un serveur PowerPivot disponible.</span><span class="sxs-lookup"><span data-stu-id="5751c-339">When data refresh is scheduled to begin, the timer job adds the request to a processing queue on an available PowerPivot server.</span></span>

 <span data-ttu-id="5751c-340">Vous pouvez augmenter l'intervalle entre deux analyses à des fins d'optimisation des performances.</span><span class="sxs-lookup"><span data-stu-id="5751c-340">You can increase the length of time between scans as a performance tuning technique.</span></span> <span data-ttu-id="5751c-341">Vous pouvez également désactiver le travail du minuteur pour arrêter temporairement les opérations d'actualisation de données lorsque vous devez résoudre des problèmes.</span><span class="sxs-lookup"><span data-stu-id="5751c-341">You can also disable the timer job to temporarily stop data refresh operations while you troubleshoot problems.</span></span>

 <span data-ttu-id="5751c-342">Le paramétrage par défaut est d'une minute, soit la valeur minimale pouvant être spécifiée.</span><span class="sxs-lookup"><span data-stu-id="5751c-342">The default setting is one minute, which is the lowest value you can specify.</span></span> <span data-ttu-id="5751c-343">Cette valeur est recommandée, car elle fournit le résultat le plus prédictible pour les planifications qui s'exécutent à des horaires arbitraires au cours de la journée.</span><span class="sxs-lookup"><span data-stu-id="5751c-343">This value is recommended because it provides the most predictable outcome for schedules that run at arbitrary times throughout the day.</span></span> <span data-ttu-id="5751c-344">Par exemple, si un utilisateur planifie l'actualisation des données pour 16:15 et que le travail du minuteur recherche les planifications toutes les minutes, la requête d'actualisation des données planifiée est détectée à 16:15 et le traitement intervient quelques minutes après 16:15.</span><span class="sxs-lookup"><span data-stu-id="5751c-344">For example, if a user schedules data refresh for 4:15 PM, and the timer job scans for schedules every minute, the scheduled data refresh request will be detected at 4:15 and processing will occur within a few minutes of 4:15.</span></span>

 <span data-ttu-id="5751c-345">Si vous augmentez l'intervalle d'analyse de sorte que celle-ci n'intervienne que très rarement (par exemple, une fois par jour à minuit), toutes les opérations d'actualisation des données planifiées au cours de cet intervalle sont ajoutées à la fois à la file d'attente de traitement, ce qui peut surcharger le serveur et priver de ressources système d'autres applications.</span><span class="sxs-lookup"><span data-stu-id="5751c-345">If you raise the scan interval so that it runs very infrequently (for example, once a day at midnight), all of the data refresh operations that were scheduled to run during that interval are added to the processing queue all at once, potentially overwhelming the server and starving other applications of system resources.</span></span> <span data-ttu-id="5751c-346">En fonction du nombre d'actualisations planifiées, la file d'attente de traitement peut prendre des proportions telles que tous les travaux ne pourront pas être effectués.</span><span class="sxs-lookup"><span data-stu-id="5751c-346">Depending on the number of scheduled refreshes, the processing queue for data refresh operations might build up to such an extent that not all jobs will be able to complete.</span></span> <span data-ttu-id="5751c-347">Les requêtes d'actualisation des données figurant en fin de file d'attente peuvent alors être supprimées si elles coïncident avec le début de l'intervalle de traitement suivant.</span><span class="sxs-lookup"><span data-stu-id="5751c-347">Data refresh requests at the end of the queue might be dropped if they run into the next processing interval.</span></span>

 <span data-ttu-id="5751c-348">Si votre configuration matérielle le permet, vous pouvez mitiger ce problème en spécifiant des processeurs supplémentaires afin d'exécuter davantage de travaux d'actualisation de données simultanés.</span><span class="sxs-lookup"><span data-stu-id="5751c-348">If your hardware supports it, you can mitigate this problem by specifying additional processors to run more data refresh jobs in parallel.</span></span> <span data-ttu-id="5751c-349">Pour plus d’informations, consultez [configurer l’actualisation des données dédiées ou le traitement des requêtes uniquement &#40;PowerPivot pour SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-349">For more information, see [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md).</span></span> <span data-ttu-id="5751c-350">Pour plus d’informations sur la façon dont les demandes d’actualisation des données sont découvertes, ajoutées à une file d’attente et traitées, consultez [actualisation des données PowerPivot](power-pivot-sharepoint/power-pivot-data-refresh.md).</span><span class="sxs-lookup"><span data-stu-id="5751c-350">For more information about how data refresh requests are discovered, added to a queue, and processed, see [PowerPivot Data Refresh](power-pivot-sharepoint/power-pivot-data-refresh.md).</span></span>

1.  <span data-ttu-id="5751c-351">Dans l'Administration centrale, cliquez sur **Analyse**.</span><span class="sxs-lookup"><span data-stu-id="5751c-351">In Central Administration, click **Monitoring**.</span></span>

2.  <span data-ttu-id="5751c-352">Cliquez sur **Examiner les définitions de travail**.</span><span class="sxs-lookup"><span data-stu-id="5751c-352">Click **Review Job Definitions**.</span></span>

3.  <span data-ttu-id="5751c-353">Sélectionnez le **travail du minuteur d’actualisation des données PowerPivot**.</span><span class="sxs-lookup"><span data-stu-id="5751c-353">Select the **PowerPivot Data Refresh Timer Job**.</span></span>

4.  <span data-ttu-id="5751c-354">Modifiez la fréquence de la planification pour modifier la fréquence à laquelle le travail du minuteur doit rechercher les informations de planification de l'actualisation des données.</span><span class="sxs-lookup"><span data-stu-id="5751c-354">Modify the schedule frequency to change how often the timer job scans for data refresh schedule information.</span></span>

##  <a name="disable-the-data-refresh-timer-job"></a><a name="bkmk_disableDR"></a><span data-ttu-id="5751c-355">Désactiver le travail du minuteur d’actualisation des données</span><span class="sxs-lookup"><span data-stu-id="5751c-355">Disable the Data Refresh Timer Job</span></span>
 <span data-ttu-id="5751c-356">Le travail du minuteur d'actualisation des données PowerPivot est un travail de niveau batterie de serveurs qui est soit activé, soit désactivé pour toutes les instances du serveur PowerPivot de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-356">The PowerPivot data refresh timer job is a farm-level timer job that is either enabled or disabled for all PowerPivot server instances in the farm.</span></span> <span data-ttu-id="5751c-357">Il n'est pas attaché à une application Web ou de service PowerPivot spécifique.</span><span class="sxs-lookup"><span data-stu-id="5751c-357">It is not tied to a specific Web application or PowerPivot service application.</span></span> <span data-ttu-id="5751c-358">Vous ne pouvez pas le désactiver sur certains serveurs pour forcer le traitement de l'actualisation des données sur d'autres serveurs de la batterie de serveurs.</span><span class="sxs-lookup"><span data-stu-id="5751c-358">You cannot disable it on some servers to force data refresh processing to other servers in the farm.</span></span>

 <span data-ttu-id="5751c-359">Si vous désactivez le travail du minuteur d'actualisation des données PowerPivot, les requêtes déjà présentes dans la file d'attente seront traitées, mais aucune nouvelle requête ne sera ajoutée tant que vous ne l'aurez pas réactivé.</span><span class="sxs-lookup"><span data-stu-id="5751c-359">If you disable the PowerPivot data refresh timer job, requests that were already in the queue will be processed, but no new requests will be added until you re-enable the job.</span></span> <span data-ttu-id="5751c-360">Les requêtes qui ont été planifiées pour intervenir dans le passé ne sont pas traitées.</span><span class="sxs-lookup"><span data-stu-id="5751c-360">Requests that were scheduled to occur in the past are not processed.</span></span>

 <span data-ttu-id="5751c-361">La désactivation du travail du minuteur n'a pas d'incidence sur la disponibilité de la fonctionnalité dans les pages d'application.</span><span class="sxs-lookup"><span data-stu-id="5751c-361">Disabling the timer job has no effect on feature availability in application pages.</span></span> <span data-ttu-id="5751c-362">Il n'existe aucun moyen de supprimer ou masquer la fonctionnalité d'actualisation des données dans les applications Web.</span><span class="sxs-lookup"><span data-stu-id="5751c-362">There is no way to remove or hide the data refresh feature in web applications.</span></span> <span data-ttu-id="5751c-363">Les utilisateurs qui disposent d'autorisations Collaboration ou supérieures restent en mesure de créer des planifications pour les opérations d'actualisation des données même si le travail du minuteur est définitivement désactivé.</span><span class="sxs-lookup"><span data-stu-id="5751c-363">Users who have Contribute permissions or above will still be able to create new schedules for data refresh operations, even if the timer job is permanently disabled.</span></span>

## <a name="see-also"></a><span data-ttu-id="5751c-364">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5751c-364">See Also</span></span>
 <span data-ttu-id="5751c-365">[Planifier une actualisation des données &#40;PowerPivot pour SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [configurer l’actualisation des données dédiée ou le traitement des requêtes uniquement &#40;PowerPivot pour SharePoint](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)&#41;[configurer le compte d’actualisation des données PowerPivot sans assistance &#40;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) PowerPivot pour SharePoint&#41;[configurer les informations d’identification stockées pour l’actualisation des données PowerPivot](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md) &#40;PowerPivot pour SharePoint&#41;</span><span class="sxs-lookup"><span data-stu-id="5751c-365">[Schedule a Data Refresh &#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md) [Configure Dedicated Data Refresh or Query-Only Processing &#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md) [Configure the PowerPivot Unattended Data Refresh Account &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md) [Configure Stored Credentials for PowerPivot Data Refresh &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)</span></span>


