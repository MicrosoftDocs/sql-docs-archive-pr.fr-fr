---
title: 'Leçon 6 : définition des calculs | Microsoft Docs'
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: e0a1e354-e879-4eb8-bb2b-6c3809e32cb6
author: minewiskan
ms.author: owend
ms.openlocfilehash: e0b3f7e925a11146204dc6c55e9ddd6820ecb802
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604228"
---
# <a name="lesson-6-defining-calculations"></a><span data-ttu-id="a9f13-102">Leçon 6 : Définition de calculs</span><span class="sxs-lookup"><span data-stu-id="a9f13-102">Lesson 6: Defining Calculations</span></span>
  <span data-ttu-id="a9f13-103">Dans cette leçon, vous apprenez à définir des calculs, qui sont des expressions ou des scripts MDX (Multidimensional Expressions).</span><span class="sxs-lookup"><span data-stu-id="a9f13-103">In this lesson, you learn to define calculations, which are Multidimensional Expressions (MDX) expressions or scripts.</span></span> <span data-ttu-id="a9f13-104">Les calculs vous permettent de définir des membres calculés, des jeux nommés et d'exécuter d'autres commandes de script pour étendre les possibilités d'un cube [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a9f13-104">Calculations enable you to define calculated members, named sets, and execute other script commands to extend the capabilities of an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] cube.</span></span> <span data-ttu-id="a9f13-105">Par exemple, vous pouvez exécuter une commande de script pour définir un sous-cube et assigner un calcul aux cellules du sous-cube.</span><span class="sxs-lookup"><span data-stu-id="a9f13-105">For example, you can run a script command to define a subcube and then assign a calculation to the cells in the subcube.</span></span>  
  
 <span data-ttu-id="a9f13-106">Lorsque vous définissez un nouveau calcul dans le Concepteur de cube, ce calcul est ajouté au volet **Organisateur de script** de l'onglet **Calculs** du Concepteur de cube, et les champs pour ce type de calcul particulier s'affichent dans un formulaire de calcul dans le volet **Expressions de calcul** .</span><span class="sxs-lookup"><span data-stu-id="a9f13-106">When you define a new calculation in Cube Designer, the calculation is added to the **Script Organizer** pane of the **Calculations** tab of Cube Designer, and the fields for the particular calculation type are displayed in a calculations form in the **Calculation Expressions** pane.</span></span> <span data-ttu-id="a9f13-107">Les calculs sont exécutés dans l'ordre où ils apparaissent dans le volet **Organisateur de script** .</span><span class="sxs-lookup"><span data-stu-id="a9f13-107">Calculations are executed in the order in which they are listed in the **Script Organizer** pane.</span></span> <span data-ttu-id="a9f13-108">Vous pouvez changer l’ordre des calculs en cliquant avec le bouton droit sur un calcul particulier, puis en sélectionnant **Monter** ou **Descendre**. Ou bien, vous pouvez cliquer sur un calcul particulier, puis utiliser l’icône **Monter** ou **Descendre** de la barre d’outils de l’onglet **Calculs** .</span><span class="sxs-lookup"><span data-stu-id="a9f13-108">You can reorder the calculations by right-clicking on a particular calculation and then selecting **Move Up** or **Move Down**, or by clicking a particular calculation and then using the **Move Up** or **Move Down** icons on the toolbar of the **Calculations** tab.</span></span>  
  
 <span data-ttu-id="a9f13-109">Sous l'onglet **Calculs** , vous pouvez ajouter de nouveaux calculs et afficher ou modifier des calculs existants dans l'un des deux modes d'affichage du volet **Expressions de calcul** :</span><span class="sxs-lookup"><span data-stu-id="a9f13-109">On the **Calculations** tab, you can add new calculations and view or edit existing calculations in the following views in the **Calculation Expressions** pane:</span></span>  
  
-   <span data-ttu-id="a9f13-110">Mode Formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9f13-110">Form view.</span></span> <span data-ttu-id="a9f13-111">Ce mode affiche les expressions et les propriétés pour une seule commande dans un format graphique.</span><span class="sxs-lookup"><span data-stu-id="a9f13-111">This view shows the expressions and properties for a single command in a graphical format.</span></span> <span data-ttu-id="a9f13-112">Lorsque vous modifiez un script MDX, une zone d'expression occupe tout le formulaire.</span><span class="sxs-lookup"><span data-stu-id="a9f13-112">When you edit an MDX script, an expression box fills the Form view.</span></span>  
  
-   <span data-ttu-id="a9f13-113">Mode Script.</span><span class="sxs-lookup"><span data-stu-id="a9f13-113">Script view.</span></span> <span data-ttu-id="a9f13-114">Ce mode affiche tous les scripts de calcul dans un éditeur de code, ce qui vous permet de les modifier facilement.</span><span class="sxs-lookup"><span data-stu-id="a9f13-114">This view displays all calculation scripts in a code editor, which lets you easily change the calculation scripts.</span></span> <span data-ttu-id="a9f13-115">Lorsque le volet **Expressions de calcul** est en mode Script, l' **Organisateur de script** est masqué.</span><span class="sxs-lookup"><span data-stu-id="a9f13-115">When the **Calculation Expressions** pane is in Script view, the **Script Organizer** is hidden.</span></span> <span data-ttu-id="a9f13-116">Le mode Script offre un codage en couleurs, un appariement des parenthèses, une saisie semi-automatique et des régions de code MDX.</span><span class="sxs-lookup"><span data-stu-id="a9f13-116">The Script view provides color coding, parenthesis matching, auto-complete, and MDX code regions.</span></span> <span data-ttu-id="a9f13-117">Vous pouvez développer ou réduire les régions de code MDX pour faciliter les modifications.</span><span class="sxs-lookup"><span data-stu-id="a9f13-117">You can expand or collapse the MDX code regions to make editing easier.</span></span>  
  
 <span data-ttu-id="a9f13-118">Pour passer d'un mode à l'autre dans le volet **Expressions de calcul** , cliquez sur **Mode Formulaire** ou sur **Mode Script** dans la barre d'outils de l'onglet **Calculs** .</span><span class="sxs-lookup"><span data-stu-id="a9f13-118">To switch between these views in the **Calculation Expressions** pane, click **Form View** or **Script View** on the toolbar of the **Calculations** tab.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a9f13-119">Si [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] détecte une erreur de syntaxe dans un calcul, l'affichage en mode Formulaire est impossible tant que l'erreur n'a pas été corrigée en mode Script.</span><span class="sxs-lookup"><span data-stu-id="a9f13-119">If [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] detects a syntax error in any calculation, the Form view will not display until the error is corrected in the Script view.</span></span>  
  
 <span data-ttu-id="a9f13-120">Vous pouvez aussi utiliser l'Assistant Business Intelligence pour ajouter certains calculs à un cube.</span><span class="sxs-lookup"><span data-stu-id="a9f13-120">You can also use the Business Intelligence Wizard to add certain calculations to a cube.</span></span> <span data-ttu-id="a9f13-121">Par exemple, vous pouvez utiliser cet Assistant pour ajouter l'analyse chronologique automatisée à un cube, ce qui revient à définir des membres calculés pour des calculs liés à la chronologie, par exemple le cumul dans la période jusqu'à ce jour, les moyennes mobiles ou la croissance d'une période à l'autre.</span><span class="sxs-lookup"><span data-stu-id="a9f13-121">For example, you can use this wizard to add time intelligence to a cube, which means defining calculated members for time-related calculations such as period-to-date, moving averages, or period over period growth.</span></span> <span data-ttu-id="a9f13-122">Pour plus d’informations, consultez [Définir des calculs Time Intelligence à l’aide de l’Assistant Business Intelligence](multidimensional-models/define-time-intelligence-calculations-using-the-business-intelligence-wizard.md).</span><span class="sxs-lookup"><span data-stu-id="a9f13-122">For more information, see [Define Time Intelligence Calculations using the Business Intelligence Wizard](multidimensional-models/define-time-intelligence-calculations-using-the-business-intelligence-wizard.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="a9f13-123">Sous l'onglet **Calculs** , le script de calcul commence par la commande CALCULATE.</span><span class="sxs-lookup"><span data-stu-id="a9f13-123">On the **Calculations** tab, the calculation script starts with the CALCULATE command.</span></span> <span data-ttu-id="a9f13-124">La commande CALCULATE contrôle l'agrégation des cellules du cube et vous ne devez la modifier que si vous comptez spécifier manuellement les modalités de cette agrégation.</span><span class="sxs-lookup"><span data-stu-id="a9f13-124">The CALCULATE command controls the aggregation of the cells in the cube and you should edit this command only if you intend to manually specify how the cube cells should be aggregated.</span></span>  
  
 <span data-ttu-id="a9f13-125">Pour plus d’informations, consultez [Calculs](multidimensional-models-olap-logical-cube-objects/calculations.md), et [Calculs dans les modèles multidimensionnels](multidimensional-models/calculations-in-multidimensional-models.md).</span><span class="sxs-lookup"><span data-stu-id="a9f13-125">For more information, see [Calculations](multidimensional-models-olap-logical-cube-objects/calculations.md), and [Calculations in Multidimensional Models](multidimensional-models/calculations-in-multidimensional-models.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a9f13-126">Les projets achevés de toutes les leçons de ce didacticiel sont disponibles en ligne.</span><span class="sxs-lookup"><span data-stu-id="a9f13-126">Completed projects for all of the lessons in this tutorial are available online.</span></span> <span data-ttu-id="a9f13-127">Vous pouvez sauter des leçons en utilisant le projet achevé de la leçon précédente comme point de départ.</span><span class="sxs-lookup"><span data-stu-id="a9f13-127">You can jump ahead to any lesson by using the completed project from the previous lesson as a starting point.</span></span> <span data-ttu-id="a9f13-128">[Cliquez ici](https://go.microsoft.com/fwlink/?LinkID=221866) pour télécharger les exemples de projet de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="a9f13-128">[Click here](https://go.microsoft.com/fwlink/?LinkID=221866) to download the sample projects that go with this tutorial.</span></span>  
  
 <span data-ttu-id="a9f13-129">Cette leçon contient les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="a9f13-129">This lesson contains the following tasks:</span></span>  
  
 [<span data-ttu-id="a9f13-130">Définition des membres calculés</span><span class="sxs-lookup"><span data-stu-id="a9f13-130">Defining Calculated Members</span></span>](lesson-6-1-defining-calculated-members.md)  
 <span data-ttu-id="a9f13-131">Dans cette tâche, vous apprenez à définir des membres calculés.</span><span class="sxs-lookup"><span data-stu-id="a9f13-131">In this task, you learn to define calculated members.</span></span>  
  
 [<span data-ttu-id="a9f13-132">Définition de jeux nommés</span><span class="sxs-lookup"><span data-stu-id="a9f13-132">Defining Named Sets</span></span>](lesson-6-2-defining-named-sets.md)  
 <span data-ttu-id="a9f13-133">Dans cette tâche, vous apprenez à définir des jeux nommés.</span><span class="sxs-lookup"><span data-stu-id="a9f13-133">In this task, you learn to define named sets.</span></span>  
  
## <a name="next-lesson"></a><span data-ttu-id="a9f13-134">Leçon suivante</span><span class="sxs-lookup"><span data-stu-id="a9f13-134">Next Lesson</span></span>  
 [<span data-ttu-id="a9f13-135">Leçon 7 : Définition d’indicateurs de performance clés &#40;KPIs&#41;</span><span class="sxs-lookup"><span data-stu-id="a9f13-135">Lesson 7: Defining Key Performance Indicators &#40;KPIs&#41;</span></span>](lesson-7-defining-key-performance-indicators-kpis.md)  
  
## <a name="see-also"></a><span data-ttu-id="a9f13-136">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a9f13-136">See Also</span></span>  
 <span data-ttu-id="a9f13-137">[Scénario du didacticiel Analysis Services](analysis-services-tutorial-scenario.md) </span><span class="sxs-lookup"><span data-stu-id="a9f13-137">[Analysis Services Tutorial Scenario](analysis-services-tutorial-scenario.md) </span></span>  
 <span data-ttu-id="a9f13-138">[La modélisation multidimensionnelle &#40;le didacticiel Adventure Works&#41;](multidimensional-modeling-adventure-works-tutorial.md) </span><span class="sxs-lookup"><span data-stu-id="a9f13-138">[Multidimensional Modeling &#40;Adventure Works Tutorial&#41;](multidimensional-modeling-adventure-works-tutorial.md) </span></span>  
 <span data-ttu-id="a9f13-139">[Créer des jeux nommés](multidimensional-models/create-named-sets.md) </span><span class="sxs-lookup"><span data-stu-id="a9f13-139">[Create Named Sets](multidimensional-models/create-named-sets.md) </span></span>  
 [<span data-ttu-id="a9f13-140">Créer des membres calculés</span><span class="sxs-lookup"><span data-stu-id="a9f13-140">Create Calculated Members</span></span>](multidimensional-models/create-calculated-members.md)  
  
  
