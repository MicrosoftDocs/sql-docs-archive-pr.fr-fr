---
title: Création de calculs de cellules d’étendue de requête (MDX) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- WITH keyword
- query-scoped cell calculations [MDX]
ms.assetid: 45987daa-4400-41e9-add7-2428fd75709b
author: minewiskan
ms.author: owend
ms.openlocfilehash: 5a9c9d529bfeb26b959b2521e4ce3c3d7f10d082
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708752"
---
# <a name="creating-query-scoped-cell-calculations-mdx"></a><span data-ttu-id="b9a6c-102">Création de calculs de cellules au niveau de la requête (MDX)</span><span class="sxs-lookup"><span data-stu-id="b9a6c-102">Creating Query-Scoped Cell Calculations (MDX)</span></span>
  <span data-ttu-id="b9a6c-103">Pour décrire les cellules calculées au sein du contexte d'une requête, vous pouvez utiliser le mot clé `WITH` dans la syntaxe MDX (Multidimensional Expressions).</span><span class="sxs-lookup"><span data-stu-id="b9a6c-103">You use the `WITH` keyword in Multidimensional Expressions (MDX) to describe calculated cells within the context of a query.</span></span> <span data-ttu-id="b9a6c-104">Le mot clé `WITH` possède la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="b9a6c-104">The `WITH` keyword has the following syntax:</span></span>  
  
```  
WITH CELL CALCULATION Cube_Name.CellCalc_Identifier  String_Expression  
```  
  
 <span data-ttu-id="b9a6c-105">La valeur `CellCalc_Identifier` est le nom des cellules calculées.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-105">The `CellCalc_Identifier` value is the name of the calculated cells.</span></span> <span data-ttu-id="b9a6c-106">La valeur `String_Expression` contient une liste d’expressions de jeu MDX unidimensionnelles et orthogonales.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-106">The `String_Expression` value contains a list of orthogonal, single-dimensional MDX set expressions.</span></span> <span data-ttu-id="b9a6c-107">Chacune de ces expressions d'ensemble doit être convertie en l'une des catégories répertoriées dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-107">Each of these set expressions must resolve to one of the categories listed in the following table.</span></span>  
  
|<span data-ttu-id="b9a6c-108">Category</span><span class="sxs-lookup"><span data-stu-id="b9a6c-108">Category</span></span>|<span data-ttu-id="b9a6c-109">Description</span><span class="sxs-lookup"><span data-stu-id="b9a6c-109">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="b9a6c-110">Jeu vide</span><span class="sxs-lookup"><span data-stu-id="b9a6c-110">Empty set</span></span>|<span data-ttu-id="b9a6c-111">Expression de jeu MDX qui prend la valeur d'un ensemble vide.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-111">An MDX set expression that resolves into an empty set.</span></span> <span data-ttu-id="b9a6c-112">Dans ce cas, la portée de la cellule calculée est l'intégralité du cube.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-112">In this case, the scope of the calculated cell is the whole cube.</span></span>|  
|<span data-ttu-id="b9a6c-113">Jeu à un seul membre</span><span class="sxs-lookup"><span data-stu-id="b9a6c-113">Single member set</span></span>|<span data-ttu-id="b9a6c-114">Expression de jeu MDX qui prend la valeur d'un seul membre.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-114">An MDX set expression that resolves into a single member.</span></span>|  
|<span data-ttu-id="b9a6c-115">Jeu de membres de niveau</span><span class="sxs-lookup"><span data-stu-id="b9a6c-115">Set of level members</span></span>|<span data-ttu-id="b9a6c-116">Expression de jeu MDX qui prend la valeur des membres d'un même niveau.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-116">An MDX set expression that resolves into the members of a single level.</span></span> <span data-ttu-id="b9a6c-117">Le *Level_Expression*est un exemple d’une telle expression de jeu.`Members`</span><span class="sxs-lookup"><span data-stu-id="b9a6c-117">An example of such a set expression is the *Level_Expression*.`Members`</span></span> <span data-ttu-id="b9a6c-118">Fonction MDX.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-118">MDX function.</span></span> <span data-ttu-id="b9a6c-119">Pour inclure des membres calculés, utilisez l' *Level_Expression*.`AllMembers`</span><span class="sxs-lookup"><span data-stu-id="b9a6c-119">To include calculated members, use the *Level_Expression*.`AllMembers`</span></span> <span data-ttu-id="b9a6c-120">Fonction MDX.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-120">MDX function.</span></span> <span data-ttu-id="b9a6c-121">Pour plus d’informations, consultez [AllMembers &#40;MDX&#41;](/sql/mdx/allmembers-mdx).</span><span class="sxs-lookup"><span data-stu-id="b9a6c-121">For more information, see [AllMembers &#40;MDX&#41;](/sql/mdx/allmembers-mdx).</span></span>|  
|<span data-ttu-id="b9a6c-122">Jeu de descendants</span><span class="sxs-lookup"><span data-stu-id="b9a6c-122">Set of descendants</span></span>|<span data-ttu-id="b9a6c-123">Expression de jeu MDX qui prend la valeur des descendants d'un membre spécifié.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-123">An MDX set expression that resolves into the descendants of a specified member.</span></span> <span data-ttu-id="b9a6c-124">Un exemple d’une telle expression d’ensemble est la `Descendants` fonction MDX (*Member_Expression*, *Level_Expresion*, *Desc_Flag*).</span><span class="sxs-lookup"><span data-stu-id="b9a6c-124">An example of such a set expression is the `Descendants`(*Member_Expression*, *Level_Expresion*, *Desc_Flag*) MDX function.</span></span> <span data-ttu-id="b9a6c-125">Pour plus d’informations, consultez [Descendants &#40;MDX&#41;](/sql/mdx/descendants-mdx).</span><span class="sxs-lookup"><span data-stu-id="b9a6c-125">For more information, see [Descendants &#40;MDX&#41;](/sql/mdx/descendants-mdx).</span></span>|  
  
 <span data-ttu-id="b9a6c-126">Si l’argument `String_Expression` ne décrit pas de dimension, la syntaxe MDX suppose que tous ses membres sont inclus pour la construction du sous-cube de calcul.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-126">If the `String_Expression` argument does not describe a dimension, MDX assumes that all members are included for the purposes of constructing the calculation subcube.</span></span> <span data-ttu-id="b9a6c-127">Par conséquent, si l'argument `String_Expression` a pour valeur NULL, la définition de cellules calculées s'applique au cube tout entier.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-127">Therefore, if the `String_Expression` argument is NULL, the calculated cells definition applies to the whole cube.</span></span>  
  
 <span data-ttu-id="b9a6c-128">L'argument `MDX_Expression` contient une expression MDX qui prend la valeur d'une cellule pour toutes les cellules définies dans l'argument `String_Expression` .</span><span class="sxs-lookup"><span data-stu-id="b9a6c-128">The `MDX_Expression` argument contains an MDX expression that evaluates to a cell value for all the cells defined in the `String_Expression` argument.</span></span>  
  
## <a name="additional-considerations"></a><span data-ttu-id="b9a6c-129">Considérations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="b9a6c-129">Additional Considerations</span></span>  
 <span data-ttu-id="b9a6c-130">MDX ne traite la condition de calcul, spécifiée par la propriété `CONDITION`, qu'à une seule reprise.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-130">MDX processes the calculation condition, specified by the `CONDITION` property, only once.</span></span> <span data-ttu-id="b9a6c-131">Ce traitement unique apporte des performances supplémentaires lors de l'évaluation de plusieurs définitions de cellules calculées, surtout en cas de cellules qui se chevauchent entre différents tests du cube.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-131">This single processing provides increased performance for the evaluation of multiple calculated cells definitions, especially with overlapping calculated cells across cube passes.</span></span>  
  
 <span data-ttu-id="b9a6c-132">Le moment auquel ce traitement unique se produit dépend de la portée de création de la définition de cellules calculées :</span><span class="sxs-lookup"><span data-stu-id="b9a6c-132">When this single processing occurs depends on the creation scope of the calculated cells definition:</span></span>  
  
-   <span data-ttu-id="b9a6c-133">Si elle est créée dans une portée globale et fait partie d'un cube, la syntaxe MDX traite la condition de calcul lors du traitement du cube.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-133">If created at global scope, as part of a cube, MDX process the calculation condition when the cube is processed.</span></span> <span data-ttu-id="b9a6c-134">Si des cellules sont modifiées dans le cube d'une manière quelconque et que ces cellules font partie du sous-cube de calcul d'une définition de cellules calculées, la condition de calcul risque de ne pas être exacte tant que le cube n'est pas retraité.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-134">If cells are modified in the cube in any way, and the cells are included in the calculation subcube of a calculated cells definition, the calculation condition may not be accurate until the cube is reprocessed.</span></span> <span data-ttu-id="b9a6c-135">La modification de cellules peut se produire à partir d'écritures différées, par exemple.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-135">Cell modification can occur from writebacks, for example.</span></span> <span data-ttu-id="b9a6c-136">Lors du retraitement du cube, la condition de calcul fait elle aussi l'objet d'un nouveau traitement.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-136">The calculation condition is reprocessed when the cube is reprocessed.</span></span>  
  
-   <span data-ttu-id="b9a6c-137">Si elle est créée avec une portée de session, la syntaxe DMX traite la condition de calcul lorsque l'instruction est émise au cours de la session.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-137">If created at session scope, MDX process the calculation condition when the statement is issued during the session.</span></span> <span data-ttu-id="b9a6c-138">Comme dans le cas des définitions de cellules calculées à portée globale, si les cellules sont modifiées, la condition de calcul risque de ne pas être exacte pour la définition de cellules calculées.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-138">As with calculated cells definitions created globally, if the cells are modified, the calculation condition may not be accurate for the calculated cells definition.</span></span>  
  
-   <span data-ttu-id="b9a6c-139">Si elle est créée avec une portée de requête, la syntaxe MDX traite la condition de calcul lorsque la requête est exécutée.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-139">If created at query scope, MDX processes the calculation condition when the query runs.</span></span> <span data-ttu-id="b9a6c-140">Le problème de la modification des cellules se pose également, même si les délais de latence sont minimes en raison de la faible vitesse de traitement des requêtes MDX.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-140">The cell modification issue applies here, also, although data latency issues are minimal because of the low processing time of MDX query execution.</span></span>  
  
 <span data-ttu-id="b9a6c-141">Par ailleurs, la syntaxe MDX traite la formule de calcul chaque fois qu'une requête MDX impliquant les cellules comprises dans la définition de cellules calculées est adressée au cube.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-141">On the other hand, MDX processes the calculation formula whenever an MDX query is issued against the cube involving cells included in the calculated cells definition.</span></span> <span data-ttu-id="b9a6c-142">Ce traitement se produit quelle que soit la portée de création.</span><span class="sxs-lookup"><span data-stu-id="b9a6c-142">This processing occurs regardless of the creation scope.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b9a6c-143">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b9a6c-143">See Also</span></span>  
 [<span data-ttu-id="b9a6c-144">Instruction CREATE CELL CALCULATION &#40;MDX&#41;</span><span class="sxs-lookup"><span data-stu-id="b9a6c-144">CREATE CELL CALCULATION Statement &#40;MDX&#41;</span></span>](/sql/mdx/mdx-data-definition-create-cell-calculation)  
  
  
