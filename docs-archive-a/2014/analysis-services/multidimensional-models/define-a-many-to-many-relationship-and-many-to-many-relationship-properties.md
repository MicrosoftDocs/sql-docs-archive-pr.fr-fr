---
title: Définir une relation plusieurs-à-plusieurs et les propriétés d’une relation plusieurs-à-plusieurs | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- many-to-many relationships [Analysis Services]
ms.assetid: edb5f61a-a581-467a-a367-134b7f9b849f
author: minewiskan
ms.author: owend
ms.openlocfilehash: 1cd5d46ce07ff8eb6a3893c0dac261797c6ef19e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613655"
---
# <a name="define-a-many-to-many-relationship-and-many-to-many-relationship-properties"></a><span data-ttu-id="6f6f4-102">Définir une relation plusieurs à plusieurs et les propriétés d’une relation plusieurs à plusieurs</span><span class="sxs-lookup"><span data-stu-id="6f6f4-102">Define a Many-to-Many Relationship and Many-to-Many Relationship Properties</span></span>
  <span data-ttu-id="6f6f4-103">Cette rubrique explique les dimensions plusieurs-à-plusieurs dans Analysis Services, à quel moment les utiliser, et comment les créer.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-103">This topic explains many-to-many dimensions in Analysis Services, including when to use them and how to create them.</span></span>  
  
## <a name="introduction"></a><span data-ttu-id="6f6f4-104">Introduction</span><span class="sxs-lookup"><span data-stu-id="6f6f4-104">Introduction</span></span>  
 <span data-ttu-id="6f6f4-105">Analysis Services prend en charge les dimensions plusieurs-à-plusieurs pour des analyses plus complexes par rapport à un schéma en étoile classique.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-105">Analysis Services supports many-to-many dimensions, allowing for more complex analytics than what can be described in a classic star schema.</span></span> <span data-ttu-id="6f6f4-106">Dans un schéma en étoile classique, toutes les dimensions ont une relation un-à-plusieurs avec une table de faits.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-106">In a classic star schema, all dimensions have a one-to-many relationship with a fact table.</span></span> <span data-ttu-id="6f6f4-107">Chaque fait joint un seul membre de dimension et un seul membre de dimension peut être associé à plusieurs faits.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-107">Each fact joins to one dimension member; a single dimension member is associated with many facts.</span></span>  
  
 <span data-ttu-id="6f6f4-108">La dimension plusieurs-à-plusieurs supprime cette restriction de modèle et permet d'associer un fait (comme un solde de compte) à plusieurs membres de la même dimension (le solde d'un compte joint peut avoir deux ou plus propriétaires d'un compte joint).</span><span class="sxs-lookup"><span data-stu-id="6f6f4-108">Many-to-many removes this modeling restriction by enabling a fact (such as an account balance) to be associated with multiple members of the same dimension (the balance of a joint account can be attributed to two or more owners of a joint account).</span></span>  
  
 <span data-ttu-id="6f6f4-109">Au niveau du concept, une relation dimensionnelle plusieurs-à-plusieurs dans Analysis Services est équivalente aux relations plusieurs-à-plusieurs dans un modèle relationnel, prenant en charge le même type de scénario.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-109">Conceptually, a many-to-many dimensional relationship in Analysis Services is equivalent to many-to-many relationships in a relational model, supporting the same kinds of scenarios.</span></span> <span data-ttu-id="6f6f4-110">Voici quelques exemples de dimensions plusieurs-à-plusieurs :</span><span class="sxs-lookup"><span data-stu-id="6f6f4-110">Common examples of many-to-many include:</span></span>  
  
-   <span data-ttu-id="6f6f4-111">Les étudiants sont inscrits à plusieurs cours ; chaque cours a plusieurs étudiants.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-111">Students are enrolled in many courses; each course has many students.</span></span>  
  
-   <span data-ttu-id="6f6f4-112">Les médecins ont plusieurs patients ; les patients ont plusieurs médecins.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-112">Doctors have many patients; patients have many doctors.</span></span>  
  
-   <span data-ttu-id="6f6f4-113">Les clients ont plusieurs comptes bancaires ; les comptes bancaires peuvent appartenir à plus d'un client.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-113">Customers have many bank accounts; bank accounts might belong to more than one customer.</span></span>  
  
-   <span data-ttu-id="6f6f4-114">Dans Adventure Works, plusieurs clients ont plusieurs motifs pour commander un produit, et le motif de la vente peut être associé à plusieurs commandes.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-114">In Adventure Works, many customers have many reasons for ordering a product, and a sales reason can be associated with many orders.</span></span>  
  
 <span data-ttu-id="6f6f4-115">D'un point de vue analytique, une relation plusieurs-à-plusieurs donne une représentation exacte d'un nombre ou d'une somme afférente à la relation dimensionnelle (généralement, en éliminant les doublons lors des calculs d'un membre de dimension spécifique).</span><span class="sxs-lookup"><span data-stu-id="6f6f4-115">Analytically, the problem that a many-to-many relationship solves is accurate representation of a count or sum relative to the dimensional relationship (usually by eliminating double-counts when performing calculations for a specific dimension member).</span></span> <span data-ttu-id="6f6f4-116">Un exemple permettra de mieux comprendre ce point.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-116">An example is necessary to clarify this point.</span></span> <span data-ttu-id="6f6f4-117">Prenons un produit ou un service qui appartient à plus d'une catégorie.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-117">Consider a product or service that belongs to more than one category.</span></span> <span data-ttu-id="6f6f4-118">Si vous deviez compter le nombre de services par catégorie, un service appartenant à deux catégories serait inclus dans chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-118">If you were counting the number of services by category, you would want a service belonging to both categories to be included in each one.</span></span> <span data-ttu-id="6f6f4-119">Parallèlement, il peut être souhaitable de ne pas surestimer le nombre de services que vous fournissez.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-119">At the same time, you would not want to overstate the number of services that you provide.</span></span> <span data-ttu-id="6f6f4-120">En spécifiant une relation dimensionnelle plusieurs-à-plusieurs, il est probable que vous obtiendrez les résultats corrects lors d'une requête par catégorie ou par service.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-120">By specifying the many-to-many dimensional relationship, you are more likely to get the correct results back when querying by category or by service.</span></span> <span data-ttu-id="6f6f4-121">Toutefois, il est toujours nécessaire de s'en assurer au moyen d'un test.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-121">However, thorough testing is always necessary to ensure that this is the case.</span></span>  
  
 <span data-ttu-id="6f6f4-122">Structurellement, la création d'une relation dimensionnelle plusieurs-à-plusieurs est similaire à la création d'une relation plusieurs-à-plusieurs dans un modèle de données relationnel.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-122">Structurally, creating a many-to-many dimensional relationship is similar to how you might create many-to-many in a relational data model.</span></span> <span data-ttu-id="6f6f4-123">Tandis qu'un modèle relationnel utilise une *table de jonction* pour stocker les associations de ligne, un modèle multidimensionnel utilise un *groupe de mesures intermédiaire*.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-123">Whereas a relational model uses a *junction table* to store row associations, a multidimensional model uses an *intermediate measure group*.</span></span> <span data-ttu-id="6f6f4-124">« Groupe de mesures intermédiaire » est le terme que nous utilisons pour désigner une table qui mappe des membres de différentes dimensions.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-124">Intermediate measure group is the term we use to refer to a table that maps members from different dimensions.</span></span>  
  
 <span data-ttu-id="6f6f4-125">Visuellement, une relation plusieurs-à-plusieurs n'est pas indiquée dans un diagramme de cube.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-125">Visually, a many-to-many dimensional relationship is not indicated in a cube diagram.</span></span> <span data-ttu-id="6f6f4-126">Utilisez plutôt l'onglet Utilisation de la dimension pour identifier rapidement toutes les relations plusieurs-à-plusieurs dans un modèle.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-126">Instead, use the Dimension Usage tab to quickly identify any many-to-many relationships in a model.</span></span> <span data-ttu-id="6f6f4-127">Une relation plusieurs-à-plusieurs est indiquée par l'icône suivante.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-127">A many-to-many relationship is indicated by the following icon.</span></span>  
  
 <span data-ttu-id="6f6f4-128">![Icône d'une dimension plusieurs-à-plusieurs dans l'utilisation de la dimension](../media/ssas-m2m-icondimusage.png "Icône d'une dimension plusieurs-à-plusieurs dans l'utilisation de la dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-128">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
 <span data-ttu-id="6f6f4-129">Cliquez sur le bouton pour ouvrir la boîte de dialogue Définir une relation, vérifier si le type de la relation est plusieurs-à-plusieurs, et pour voir quel groupe de mesures intermédiaire est utilisé dans la relation.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-129">Click the button to open the Define Relationship dialog box to verify the relationship type is many-to-many, and to view which intermediate measure group is used in the relationship.</span></span>  
  
 <span data-ttu-id="6f6f4-130">![Bouton définir une relation dans l’utilisation de la dimension](../media/ssas-m2m-btndimusage.png "Bouton définir une relation dans l’utilisation de la dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-130">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
 <span data-ttu-id="6f6f4-131">Dans les sections suivantes, vous découvrirez comment configurer une dimension plusieurs-à-plusieurs et tester les comportements du modèle.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-131">In subsequent sections, you will learn how to set up a many-to-many dimension and test model behaviors.</span></span> <span data-ttu-id="6f6f4-132">Si vous souhaitez obtenir davantage d'informations, ou commencer par un didacticiel, reportez-vous à la section **En savoir plus** à la fin de cet article.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-132">If you would rather review additional information or try tutorials first, see **Learn More** at the end of this article.</span></span>  
  
## <a name="create-a-many-to-many-dimension"></a><span data-ttu-id="6f6f4-133">Créer une dimension plusieurs-à-plusieurs</span><span class="sxs-lookup"><span data-stu-id="6f6f4-133">Create a many-to-many dimension</span></span>  
 <span data-ttu-id="6f6f4-134">Une relation plusieurs-à-plusieurs simple comprend deux dimensions ayant une cardinalité plusieurs-à-plusieurs, un groupe de mesures intermédiaire pour stocker les associations des membres, et un groupe de mesures de fait contenant les données mesurables, comme la somme des ventes totales ou le solde d'un compte bancaire.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-134">A simple many-to-many relationship includes two dimensions having a many-to-many cardinality, an intermediate measure group for storing member associations, and a fact measure group containing measurable data, such as sum of total sales or the balance of a bank account.</span></span>  
  
 <span data-ttu-id="6f6f4-135">Les dimensions dans une relation plusieurs-à-plusieurs peuvent avoir des tables correspondantes dans la vue de source de données, où chaque dimension dans le modèle est basée sur une table existante dans une source de données.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-135">Dimensions in a many-to-many relationship might have correspondent tables in the DSV, where each dimension in the model is based on an existing table in a data source.</span></span> <span data-ttu-id="6f6f4-136">En revanche, les dimensions dans votre modèle peuvent dériver d'un plus petit nombre de tables ou de tables physiques différentes dans la vue de gestion dynamique.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-136">Conversely, the dimensions in your model might derive from fewer or different physical tables in the DSV.</span></span> <span data-ttu-id="6f6f4-137">En utilisant les motifs de vente et les commandes comme exemple, l'exemple de cube Adventure Works montre une relation plusieurs-à-plusieurs utilisant des dimensions qui existent en tant que structures de données propres au modèle, sans contreparties physiques dans la vue de gestion dynamique.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-137">Using Sales Reasons and Sales Orders as a case in point, the Adventure Works sample cube demonstrates a many-to-many relationship using dimensions that exist as model-only data structures, without physical counterparts in the DSV.</span></span> <span data-ttu-id="6f6f4-138">La dimension Sales Order est basée sur la table de faits et non sur la table de dimensions, dans la source de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-138">The Sales Order dimension is based on a fact table, rather than a dimension table, in the underlying data source.</span></span>  
  
 <span data-ttu-id="6f6f4-139">La procédure suivante suppose que vous connaissez déjà les entités qui participent dans la relation plusieurs-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-139">The next procedure assumes that you already know which entities participate in the many-to-many relationship.</span></span> <span data-ttu-id="6f6f4-140">Pour approfondir ce sujet, consultez **En savoir plus** .</span><span class="sxs-lookup"><span data-stu-id="6f6f4-140">See **Learn More** for further study.</span></span>  
  
 <span data-ttu-id="6f6f4-141">Pour illustrer les étapes de création d'une relation plusieurs-à-plusieurs, cette procédure recrée l'une des relations plusieurs-à-plusieurs dans l'exemple de cube Adventure Works.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-141">To illustrate the steps used to create a many-to-many relationship, this procedure re-creates one of the many-to-many relationships in the Adventure Works sample cube.</span></span> <span data-ttu-id="6f6f4-142">Si les données sources (c'est-à-dire, l'entrepôt de données d'exemple Adventure Works) sont installées sur une instance de moteur de base de données relationnelle, suivez les étapes suivantes.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-142">If you have the source data (that is, the Adventure Works sample data warehouse) installed on a relational database engine instance, you can follow these steps.</span></span>  
  
#### <a name="step-1-verify-dsv-relationships"></a><span data-ttu-id="6f6f4-143">Étape 1 - Vérifier les relations de la vue de gestion dynamique</span><span class="sxs-lookup"><span data-stu-id="6f6f4-143">Step 1: Verify DSV relationships</span></span>  
  
1.  <span data-ttu-id="6f6f4-144">Dans SQL Server Data Tools, dans un projet multidimensionnel, créez une source de données sur l'entrepôt de données Adventure Works DW 2012, hébergé sur une instance de moteur de base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-144">In SQL Server Data Tools, in a multidimensional project, create a data source to the Adventure Works DW 2012 relational data warehouse, hosted on a SQL Server Database Engine instance.</span></span>  
  
2.  <span data-ttu-id="6f6f4-145">Créez une vue de source de données à l'aide des tables existantes suivantes :</span><span class="sxs-lookup"><span data-stu-id="6f6f4-145">Create a Data Source View using the following existing tables:</span></span>  
  
    -   <span data-ttu-id="6f6f4-146">FactInternetSales</span><span class="sxs-lookup"><span data-stu-id="6f6f4-146">FactInternetSales</span></span>  
  
    -   <span data-ttu-id="6f6f4-147">FactInternetSalesReason</span><span class="sxs-lookup"><span data-stu-id="6f6f4-147">FactInternetSalesReason</span></span>  
  
    -   <span data-ttu-id="6f6f4-148">DimSalesReason</span><span class="sxs-lookup"><span data-stu-id="6f6f4-148">DimSalesReason</span></span>  
  
3.  <span data-ttu-id="6f6f4-149">Vérifiez que toutes les tables que vous envisagez d'utiliser dans les relations plusieurs-à-plusieurs sont liées dans la vue de source dynamique via des relations de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-149">Verify that all of the tables you plan to use in the many-to-many relationships are related in the DSV through primary key relationships.</span></span> <span data-ttu-id="6f6f4-150">Cela est requis pour établir un lien au groupe de mesures intermédiaire dans une étape ultérieure.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-150">This is a requirement for establishing a link to the intermediate measure group in a subsequent step.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="6f6f4-151">Si la source de données sous-jacente ne fournit pas de relations de clé primaire et étrangère, vous pouvez créer les relations manuellement dans la vue de gestion dynamique.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-151">If the underlying data source does not provide primary and foreign key relationships, you can create the relationships manually in the DSV.</span></span> <span data-ttu-id="6f6f4-152">Pour plus d’informations, consultez [Définir des relations logiques dans une vue de source de données &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span><span class="sxs-lookup"><span data-stu-id="6f6f4-152">For more information, see [Define Logical Relationships in a Data Source View &#40;Analysis Services&#41;](define-logical-relationships-in-a-data-source-view-analysis-services.md).</span></span>  
  
     <span data-ttu-id="6f6f4-153">L'exemple suivant confirme que les tables utilisées dans cette procédure sont liées à l'aide de clés primaires.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-153">The following example confirms that the tables used in this procedure are linked using primary keys.</span></span>  
  
     <span data-ttu-id="6f6f4-154">![Vue de source de données affichant les tables associées](../media/ssas-m2m-dsvpkeys.PNG "Vue de source de données affichant les tables associées")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-154">![DSV showing related tables](../media/ssas-m2m-dsvpkeys.PNG "DSV showing related tables")</span></span>  
  
#### <a name="step-2-create-dimensions-and-measure-groups"></a><span data-ttu-id="6f6f4-155">Étape 2 - Créer des dimensions et des groupes de mesures</span><span class="sxs-lookup"><span data-stu-id="6f6f4-155">Step 2: Create dimensions and measure groups</span></span>  
  
1.  <span data-ttu-id="6f6f4-156">Dans SQL Server Data Tools, dans un projet multidimensionnel, cliquez avec le bouton droit sur **Dimensions** et sélectionnez **Nouvelle dimension**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-156">In SQL Server Data Tools, in a multidimensional project, right-click **Dimensions** and select **New Dimension**.</span></span>  
  
2.  <span data-ttu-id="6f6f4-157">Créez une dimension basée sur la table existante, **DimSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-157">Create a new dimension based on existing table, **DimSalesReason**.</span></span> <span data-ttu-id="6f6f4-158">Acceptez toutes les valeurs par défaut lorsque vous spécifiez la source.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-158">Accept all of the default values when specifying the source.</span></span>  
  
     <span data-ttu-id="6f6f4-159">Sélectionnez tous les attributs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-159">For attributes, select all.</span></span>  
  
     <span data-ttu-id="6f6f4-160">![Liste des attributs dans une nouvelle dimension](../media/ssas-m2m-dimsalesreason.PNG "Liste des attributs dans une nouvelle dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-160">![Attributes list in new dimension](../media/ssas-m2m-dimsalesreason.PNG "Attributes list in new dimension")</span></span>  
  
3.  <span data-ttu-id="6f6f4-161">Créez une seconde dimension basée sur la table existante, Fact Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-161">Create a second dimension based on existing table, Fact Internet Sales.</span></span> <span data-ttu-id="6f6f4-162">Bien qu'il s'agisse d'une table de faits, elle contient des informations de commande (Sales Order).</span><span class="sxs-lookup"><span data-stu-id="6f6f4-162">Although this is a fact table, it contains Sales Order information.</span></span> <span data-ttu-id="6f6f4-163">Nous allons l'utiliser pour créer une dimension Sales Order.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-163">We'll use it to build a Sales Order dimension.</span></span>  
  
4.  <span data-ttu-id="6f6f4-164">Dans Spécifier des informations sur la source, un avertissement indique que la colonne de nom doit être spécifiée.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-164">In Specify Source Information, you will see a warning that indicates a Name column must be specified.</span></span> <span data-ttu-id="6f6f4-165">Choisissez **SalesOrderNumber** comme nom.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-165">Choose **SalesOrderNumber** as the Name.</span></span>  
  
     <span data-ttu-id="6f6f4-166">![Dimension de commande affichant la colonne de nom](../media/ssas-m2m-dimsalesordersource.PNG "Dimension de commande affichant la colonne de nom")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-166">![Sales Order dimension showing the name column](../media/ssas-m2m-dimsalesordersource.PNG "Sales Order dimension showing the name column")</span></span>  
  
5.  <span data-ttu-id="6f6f4-167">Dans la page suivante de l'Assistant, choisissez les attributs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-167">On the next page of the wizard, choose the attributes.</span></span> <span data-ttu-id="6f6f4-168">Dans cet exemple, sélectionnez uniquement **SalesOrderNumber**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-168">In this example, you can select just **SalesOrderNumber**.</span></span>  
  
     <span data-ttu-id="6f6f4-169">![Dimension de commande affichant la liste d'attributs](../media/ssas-m2m-dimsalesorderattrib.PNG "Dimension de commande affichant la liste d'attributs")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-169">![Sales order dimension showing attribute list](../media/ssas-m2m-dimsalesorderattrib.PNG "Sales order dimension showing attribute list")</span></span>  
  
6.  <span data-ttu-id="6f6f4-170">Renommez la dimension sous la forme **Dim Sales Orders**afin de disposer d’une convention d’affectation de noms cohérente pour les dimensions.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-170">Rename the dimension to **Dim Sales Orders**, so that you have a consistent naming convention for the dimensions.</span></span>  
  
     <span data-ttu-id="6f6f4-171">![Page de l'Assistant affichant le changement de nom de la dimension](../media/ssas-m2m-dimsalesorders.PNG "Page de l'Assistant affichant le changement de nom de la dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-171">![Wizard page showing dimension rename](../media/ssas-m2m-dimsalesorders.PNG "Wizard page showing dimension rename")</span></span>  
  
7.  <span data-ttu-id="6f6f4-172">Cliquez avec le bouton droit sur **Cubes** , puis sélectionnez **Nouveau cube**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-172">Right-click **Cubes** and select **New Cube**.</span></span>  
  
8.  <span data-ttu-id="6f6f4-173">Dans les tables de groupe de mesures, choisissez **FactInternetSales** et **FactInternetSalesReason**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-173">In measure group tables, choose **FactInternetSales** and **FactInternetSalesReason**.</span></span>  
  
     <span data-ttu-id="6f6f4-174">Vous devez choisir la table **FactInternetSales** , car elle contient les mesures que vous souhaitez utiliser dans ce cube.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-174">You are choosing **FactInternetSales** because it contains the measures you want to use in the cube.</span></span> <span data-ttu-id="6f6f4-175">Vous devez choisir **FactInternetSalesReason** , car il s’agit du groupe de mesures intermédiaire fournissant les données d’association des membres qui lient les commandes aux motifs de commande.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-175">You are choosing **FactInternetSalesReason** because it is the intermediate measure group, providing member association data that relates sales orders to sales reasons.</span></span>  
  
9. <span data-ttu-id="6f6f4-176">Choisissez les mesures pour chaque table de faits.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-176">Choose measures for each fact table.</span></span>  
  
     <span data-ttu-id="6f6f4-177">Pour simplifier votre modèle, effacez toutes les mesures, puis sélectionnez uniquement **Sales Amount** et **Fact Internet Sales Count** au bas de la liste.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-177">To simplify your model, clear all the measures, and then select just **Sales Amount** and **Fact Internet Sales Count** at the bottom of the list.</span></span> <span data-ttu-id="6f6f4-178">**FactInternetSalesReason** ne comporte qu’une seule mesure, qui est donc automatiquement sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-178">The **FactInternetSalesReason** only has one measure, so it is selected for you automatically.</span></span>  
  
10. <span data-ttu-id="6f6f4-179">La liste des dimensions devrait contenir **Dim Sales Reason** et **Dim Sales Orders**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-179">In the dimension list, you should see **Dim Sales Reason** and **Dim Sales Orders**.</span></span>  
  
     <span data-ttu-id="6f6f4-180">Sur la page Sélectionner de nouvelles dimensions, l’Assistant vous invite à créer une dimension pour **Fact Internet Sales Dimension**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-180">In the Select New Dimensions page, the wizard prompts you to create a new dimension for **Fact Internet Sales Dimension**.</span></span> <span data-ttu-id="6f6f4-181">Vous n'avez pas besoin de cette dimension, par conséquent, effacez-la de la liste.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-181">You do not need this dimension, so you can clear it from the list.</span></span>  
  
11. <span data-ttu-id="6f6f4-182">Nommez le cube et cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-182">Name the cube and click **Finish**.</span></span>  
  
#### <a name="step-3-define-many-to-many-relationship"></a><span data-ttu-id="6f6f4-183">Étape 3 - Définir une relation plusieurs-à-plusieurs</span><span class="sxs-lookup"><span data-stu-id="6f6f4-183">Step 3: Define Many-to-Many relationship</span></span>  
  
1.  <span data-ttu-id="6f6f4-184">Dans le concepteur de cube, cliquez sur l’onglet utilisation de la dimension. Notez qu’il existe déjà une relation plusieurs-à-plusieurs entre la **raison des ventes** et le **fait Internet Sales**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-184">In cube designer, click Dimension Usage tab. Notice that there is already a many-to-many relationship between **Dim Sales Reason** and **Fact Internet Sales**.</span></span> <span data-ttu-id="6f6f4-185">Rappelez-vous que l'icône suivante indique une relation plusieurs-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-185">Recall that the following icon indicates a many-to-many relationship.</span></span>  
  
     <span data-ttu-id="6f6f4-186">![Icône d'une dimension plusieurs-à-plusieurs dans l'utilisation de la dimension](../media/ssas-m2m-icondimusage.png "Icône d'une dimension plusieurs-à-plusieurs dans l'utilisation de la dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-186">![Many-to-many icon in dimension usage](../media/ssas-m2m-icondimusage.png "Many-to-many icon in dimension usage")</span></span>  
  
2.  <span data-ttu-id="6f6f4-187">Cliquez sur la cellule à l’intersection entre **Dim Sales Reason** et **Fact Internet Sales**, puis cliquez sur le bouton pour ouvrir la boîte de dialogue Définir une relation.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-187">Click on the intersection cell between **Dim Sales Reason** and **Fact Internet Sales**, and then click the button to open the Define Relationship dialog box.</span></span>  
  
     <span data-ttu-id="6f6f4-188">Notez que cette boîte de dialogue est utilisée pour spécifier une relation plusieurs-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-188">You can see that this dialog box is used to specify a many-to-many relationship.</span></span> <span data-ttu-id="6f6f4-189">Si vous deviez ajouter des dimensions avec une relation normale, vous utiliseriez cette boîte de dialogue pour la modifier en relation plusieurs-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-189">If you were adding dimensions that had a regular relationship instead, you would use this dialog box to change it to many-to-many.</span></span>  
  
     <span data-ttu-id="6f6f4-190">![Bouton définir une relation dans l’utilisation de la dimension](../media/ssas-m2m-btndimusage.png "Bouton définir une relation dans l’utilisation de la dimension")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-190">![Define Relationship button  in dimension usage](../media/ssas-m2m-btndimusage.png "Define Relationship button  in dimension usage")</span></span>  
  
3.  <span data-ttu-id="6f6f4-191">Déployez le projet dans une instance multidimensionnelle d'Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-191">Deploy the project to an Analysis Services multidimensional instance.</span></span> <span data-ttu-id="6f6f4-192">Au cours de la prochaine étape, vous allez explorer le cube dans Excel pour vérifier ses comportements.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-192">In the next step, you will browse the cube in Excel to verify its behaviors.</span></span>  
  
## <a name="testing-many-to-many"></a><span data-ttu-id="6f6f4-193">Test d'une relation plusieurs-à-plusieurs</span><span class="sxs-lookup"><span data-stu-id="6f6f4-193">Testing Many-to-Many</span></span>  
 <span data-ttu-id="6f6f4-194">Lorsque vous définissez une relation plusieurs-à-plusieurs dans un cube, il est impératif de la tester afin de vous assurer que les requêtes retournent les résultats attendus.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-194">When you define a many-to-many relationship in a cube, testing is imperative to ensure queries return expected results.</span></span> <span data-ttu-id="6f6f4-195">Vous devez tester le cube avec l'outil client qui sera utilisé par les utilisateurs finaux.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-195">You should test the cube using the client application tool that will be used by end-users.</span></span> <span data-ttu-id="6f6f4-196">Dans la procédure suivante, vous allez utiliser Excel pour vous connecter au cube et vérifier les résultats des requêtes.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-196">In this next procedure, you will use Excel to connect to the cube and verify query results.</span></span>  
  
#### <a name="browse-the-cube-in-excel"></a><span data-ttu-id="6f6f4-197">Parcourir le cube dans Excel</span><span class="sxs-lookup"><span data-stu-id="6f6f4-197">Browse the cube in Excel</span></span>  
  
1.  <span data-ttu-id="6f6f4-198">Déployez le projet, puis parcourez le cube pour vérifier que les agrégations sont valides.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-198">Deploy the project and then browse the cube to confirm the aggregations are valid.</span></span>  
  
2.  <span data-ttu-id="6f6f4-199">Dans Excel, cliquez sur **données**  |  **à partir d’autres sources**  |  **à partir de Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-199">In Excel, click **Data** | **From Other Sources** | **From Analysis Services**.</span></span> <span data-ttu-id="6f6f4-200">Entrez le nom du serveur, puis choisissez la base de données et le cube.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-200">Enter the name of the server, choose the database and cube.</span></span>  
  
3.  <span data-ttu-id="6f6f4-201">Créez un tableau croisé dynamique qui utilise les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="6f6f4-201">Create a PivotTable that uses the following:</span></span>  
  
    -   <span data-ttu-id="6f6f4-202">**Sales Amount** pour la valeur</span><span class="sxs-lookup"><span data-stu-id="6f6f4-202">**Sales Amount** as the Value</span></span>  
  
    -   <span data-ttu-id="6f6f4-203">**Sales Reason Name** pour les colonnes</span><span class="sxs-lookup"><span data-stu-id="6f6f4-203">**Sales Reason Name** on Columns</span></span>  
  
    -   <span data-ttu-id="6f6f4-204">**Sales Order Number** pour les lignes</span><span class="sxs-lookup"><span data-stu-id="6f6f4-204">**Sales Order Number** on Rows</span></span>  
  
4.  <span data-ttu-id="6f6f4-205">Analyser les résultats.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-205">Analyze the results.</span></span> <span data-ttu-id="6f6f4-206">Étant donné que nous utilisons des exemples de données, l'impression initiale est que toutes les commandes ont des valeurs identiques.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-206">Because we are using sample data, the initial impression is that all sales orders have identical values.</span></span> <span data-ttu-id="6f6f4-207">Toutefois, si vous faites défiler le tableau, vous commencez à voir des différences.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-207">However, if you scroll down, you begin to see data variation.</span></span>  
  
     <span data-ttu-id="6f6f4-208">À la moitié du tableau, repérez le montant de vente et le motif de vente de la commande **SO5382**.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-208">Part way down, you can find the sales amount and sales reasons for order number **SO5382**.</span></span> <span data-ttu-id="6f6f4-209">Le total global de cette commande est de **539,99**, et les motifs de vente attribués à cette commande comprennent Promotion, Other et Price.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-209">Grand total of this particular order is **539.99**, and the purchase reasons attributed to this order include Promotion, Other and Price.</span></span>  
  
     <span data-ttu-id="6f6f4-210">![Feuille de calcul Excel affichant les agrégations plusieurs-à-plusieurs](../media/ssas-m2m-excel.png "Feuille de calcul Excel affichant les agrégations plusieurs-à-plusieurs")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-210">![Excel worksheet showing many-to-many aggregations](../media/ssas-m2m-excel.png "Excel worksheet showing many-to-many aggregations")</span></span>  
  
     <span data-ttu-id="6f6f4-211">Notez que le montant de vente est correctement calculé pour la commande, soit **539,99** pour la totalité de la commande.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-211">Notice that the Sales Amount is correctly calculated for the order; it is **539.99** for the entire order.</span></span> <span data-ttu-id="6f6f4-212">Bien que la valeur **539,99** soit indiquée pour chaque motif, cette valeur n’est pas additionnée pour les trois motifs, car cela gonflerait incorrectement le total global.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-212">Although **539.99** is indicated for each reason, that value is not summed for all three reasons, erroneously inflating our grand total.</span></span>  
  
     <span data-ttu-id="6f6f4-213">Quelle est l'utilité d'ajouter le montant de vente sous chaque motif de vente ?</span><span class="sxs-lookup"><span data-stu-id="6f6f4-213">Why put a sales amount under each sales reason in the first place?</span></span> <span data-ttu-id="6f6f4-214">Cela permet d'identifier le montant de vente attribuable à chaque motif.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-214">The answer is that it allows us to identify the amount of sales we can attribute to each reason.</span></span>  
  
5.  <span data-ttu-id="6f6f4-215">Faites défiler la feuille jusqu'en bas.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-215">Scroll to the bottom of the worksheet.</span></span> <span data-ttu-id="6f6f4-216">Nous pouvons maintenant voir que le prix est le principal motif d'achat des clients, par rapport aux autres motifs, et par rapport au total global.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-216">It is now easy to see that Price is the most important reason for customer purchases, relative to other reasons as well as the grand total.</span></span>  
  
     <span data-ttu-id="6f6f4-217">![Classeur Excel affichant les totaux dans une dimension plusieurs-à-plusieurs](../media/ssas-m2m-excelgrandtotal.png "Classeur Excel affichant les totaux dans une dimension plusieurs-à-plusieurs")</span><span class="sxs-lookup"><span data-stu-id="6f6f4-217">![Excel workbook showing totals in many-to-many](../media/ssas-m2m-excelgrandtotal.png "Excel workbook showing totals in many-to-many")</span></span>  
  
#### <a name="tips-for-handling-unexpected-query-results"></a><span data-ttu-id="6f6f4-218">Astuces en cas de résultats de requête inattendu</span><span class="sxs-lookup"><span data-stu-id="6f6f4-218">Tips for handling unexpected query results</span></span>  
  
1.  <span data-ttu-id="6f6f4-219">Dans le groupe de mesures intermédiaire, masquez les mesures, par exemple le nombre, qui ne retournent pas des résultats significatifs dans une requête.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-219">Hide measures in the intermediate measure group, such as the count, that do not return meaningful results in a query.</span></span> <span data-ttu-id="6f6f4-220">Cela évite que les utilisateurs tentent d'utiliser des agrégations qui produisent des données inutiles.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-220">This prevents people from trying to use aggregations producing meaningless data.</span></span> <span data-ttu-id="6f6f4-221">Pour masquer une mesure, définissez **Visibilité** sur **False** pour l'attribut, dans le concepteur de dimensions.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-221">To hide a measure, set **Visibility** to **False** on the attribute in dimension designer.</span></span>  
  
2.  <span data-ttu-id="6f6f4-222">Créez des perspectives pour utiliser un sous-ensemble de mesures et dimensions qui prennent en charge l'expérience d'analyse souhaitée.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-222">Create perspectives to use a subset of measures and dimensions that support the analytical experience you want to provide.</span></span> <span data-ttu-id="6f6f4-223">Un cube qui contient de nombreux groupes de mesures et dimensions ne fonctionne pas bien de toutes façons.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-223">Possibly, a cube that contains many measure groups and dimensions do not work well together in all cases.</span></span> <span data-ttu-id="6f6f4-224">En isolant les dimensions et les groupes de mesures que vous souhaitez utiliser ensemble, le résultat sera plus prévisible.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-224">By isolating the dimensions and measure groups that you intend to be used together, you ensure a more predictable outcome.</span></span>  
  
3.  <span data-ttu-id="6f6f4-225">N'oubliez pas de déployer et vous reconnecter après avoir modifié un modèle.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-225">Always remember to deploy and reconnect after changing a model.</span></span> <span data-ttu-id="6f6f4-226">Dans Excel, utilisez le bouton Actualiser sur le ruban Analyser du tableau croisé dynamique.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-226">In Excel, use the Refresh button on the PivotTable Analyze ribbon.</span></span>  
  
4.  <span data-ttu-id="6f6f4-227">Évitez d'utiliser des groupes de mesures liés dans des relations plusieurs-à-plusieurs, en particulier lorsque ces relations sont dans des cubes différents.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-227">Avoid using linked measure groups in multiple many-to-many relationships, especially when those relationships are in different cubes.</span></span> <span data-ttu-id="6f6f4-228">Cela peut entraîner des agrégations ambiguës.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-228">Doing so can result in ambiguous aggregations.</span></span> <span data-ttu-id="6f6f4-229">Pour plus d’informations, consultez [Quantités incorrectes de mesures liées dans les cubes contenant des relations plusieurs-à-plusieurs](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx).</span><span class="sxs-lookup"><span data-stu-id="6f6f4-229">For more information, see [Incorrect Amounts for Linked Measures in Cubes containing Many-to-Many Relationships](https://social.technet.microsoft.com/wiki/contents/articles/22911.incorrect-amounts-for-linked-measures-in-cubes-containing-many-to-many-relationships-ssas-troubleshooting.aspx).</span></span>  
  
##  <a name="learn-more"></a><a name="bkmk_Learn"></a><span data-ttu-id="6f6f4-230">Pour en savoir plus</span><span class="sxs-lookup"><span data-stu-id="6f6f4-230">Learn more</span></span>  
 <span data-ttu-id="6f6f4-231">Consultez les liens suivants pour obtenir davantage d'informations sur ces concepts.</span><span class="sxs-lookup"><span data-stu-id="6f6f4-231">Use the following links to get additional information that helps you master the concepts.</span></span>  
  
 [<span data-ttu-id="6f6f4-232">Comment définir des dimensions plusieurs-à-plusieurs dans Analysis Services ?</span><span class="sxs-lookup"><span data-stu-id="6f6f4-232">How do I define a many-to-many dimension in Analysis Services</span></span>](../lesson-5-3-defining-a-many-to-many-relationship.md)  
  
 [<span data-ttu-id="6f6f4-233">La révolution 2.0 des relations plusieurs-à-plusieurs</span><span class="sxs-lookup"><span data-stu-id="6f6f4-233">The many-to-many Revolution 2.0</span></span>](https://go.microsoft.com/fwlink/?LinkId=324760)  
  
 [<span data-ttu-id="6f6f4-234">Didacticiel - Exemple d'une dimension plusieurs-à-plusieurs pour SQL Server Analysis Services</span><span class="sxs-lookup"><span data-stu-id="6f6f4-234">Tutorial: Many-to-many dimension example for SQL Server Analysis Services</span></span>](https://go.microsoft.com/fwlink/?LinkId=324761)  
  
## <a name="see-also"></a><span data-ttu-id="6f6f4-235">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6f6f4-235">See Also</span></span>  
 <span data-ttu-id="6f6f4-236">[Relations de dimension](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span><span class="sxs-lookup"><span data-stu-id="6f6f4-236">[Dimension Relationships](../multidimensional-models-olap-logical-cube-objects/dimension-relationships.md) </span></span>  
 <span data-ttu-id="6f6f4-237">[Installer des exemples de données et des projets pour le Analysis Services didacticiel sur la modélisation multidimensionnelle](../install-sample-data-and-projects.md) </span><span class="sxs-lookup"><span data-stu-id="6f6f4-237">[Install Sample Data and Projects for the Analysis Services Multidimensional Modeling Tutorial](../install-sample-data-and-projects.md) </span></span>  
 <span data-ttu-id="6f6f4-238">[Déployer des projets Analysis Services &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span><span class="sxs-lookup"><span data-stu-id="6f6f4-238">[Deploy Analysis Services Projects &#40;SSDT&#41;](deploy-analysis-services-projects-ssdt.md) </span></span>  
 [<span data-ttu-id="6f6f4-239">Perspectives dans les modèles multidimensionnels</span><span class="sxs-lookup"><span data-stu-id="6f6f4-239">Perspectives in Multidimensional Models</span></span>](perspectives-in-multidimensional-models.md)  
  
  
