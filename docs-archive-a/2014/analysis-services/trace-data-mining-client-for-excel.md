---
title: Suivi (client d’exploration de données pour Excel) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- tracer
- connections
ms.assetid: 4aea3e17-cd0f-48dd-8f22-b54a6c716426
author: minewiskan
ms.author: owend
ms.openlocfilehash: 74e1a5be21aa6981ccefa76f7bb1892d8d517be5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706759"
---
# <a name="trace-data-mining-client-for-excel"></a><span data-ttu-id="f28d9-102">Trace (Client d'exploration de données pour Excel)</span><span class="sxs-lookup"><span data-stu-id="f28d9-102">Trace (Data Mining Client for Excel)</span></span>
  <span data-ttu-id="f28d9-103">![Bouton Trace](media/misc-trace.gif "Bouton Trace")</span><span class="sxs-lookup"><span data-stu-id="f28d9-103">![Trace button](media/misc-trace.gif "Trace button")</span></span>

 <span data-ttu-id="f28d9-104">La boîte de dialogue **traceur** vous permet de surveiller les instructions envoyées à l’instance de [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] que vous utilisez pour l’exploration de données.</span><span class="sxs-lookup"><span data-stu-id="f28d9-104">The **Tracer** dialog box helps you monitor the statements that are sent to the instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] that you are using for data mining.</span></span> <span data-ttu-id="f28d9-105">Une fois que vous avez créé une connexion à une instance de [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] , toutes les interactions entre le client et le serveur sont **Tracer** consignées dans le volet de suivi, y compris les instructions qui créent des structures, ajoutent des modèles d’exploration de données et effectuent des prédictions, ainsi que certains messages renvoyés par le serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-105">After you have created a connection to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], all interactions between the client and the server are logged in the **Tracer** pane, including statements that create structures, add mining models, and make predictions, as well as some messages returning from the server.</span></span>

 <span data-ttu-id="f28d9-106">Selon l'action demandée, l'instruction peut être une requête de définition de données DMX (Data Mining Extensions) ou une requête de manipulation de données, un paquet ASSL (Analysis Services Scripting Language) ou un appel à une procédure stockée Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="f28d9-106">Depending on the action that is requested, the statement might be a Data Mining Extensions (DMX) data definition query or data manipulation query, an Analysis Services Scripting Language (ASSL) packet, or a call to an Analysis Services stored procedure.</span></span> <span data-ttu-id="f28d9-107">Toutefois, les valeurs de données et les résultats numériques réels ne sont pas affichés.</span><span class="sxs-lookup"><span data-stu-id="f28d9-107">Actual numerical results and data values are not shown, however.</span></span>

 <span data-ttu-id="f28d9-108">**Trace** surveille uniquement la connexion active et le contenu de la boîte de dialogue **traceur** n’est pas stocké.</span><span class="sxs-lookup"><span data-stu-id="f28d9-108">**Trace** monitors only the current connection, and the contents of the **Tracer** dialog box are not stored.</span></span>

## <a name="options"></a><span data-ttu-id="f28d9-109">Options</span><span class="sxs-lookup"><span data-stu-id="f28d9-109">Options</span></span>
 <span data-ttu-id="f28d9-110">Volet de suivi répertorie toutes les instructions envoyées du client Excel au serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-110">Tracer pane Lists all statements sent from the Excel client to the server.</span></span>

 <span data-ttu-id="f28d9-111">Selon l'action demandée, l'instruction peut être une manipulation de données DMX, une instruction de définition de données, un appel à une procédure stockée Analysis Service ou un paquet XML/A.</span><span class="sxs-lookup"><span data-stu-id="f28d9-111">Depending on the action that is being requested, the statement might be a DMX data manipulation or data definition statement, a call to an Analysis Services stored procedure, or an XML/A packet.</span></span>

 <span data-ttu-id="f28d9-112">**Connexion actuelle** Cliquez pour afficher la définition de la connexion actuelle.</span><span class="sxs-lookup"><span data-stu-id="f28d9-112">**Current Connection** Click to display the definition of the current connection.</span></span> <span data-ttu-id="f28d9-113">La définition inclut le nom de la connexion, le fournisseur, la source de données, le catalogue, l'heure à laquelle la connexion a été utilisée pour la dernière fois dans le cadre d'une transaction, ainsi que l'état actuel (Ouvert, Inactif).</span><span class="sxs-lookup"><span data-stu-id="f28d9-113">The definition includes the name of the connection, the provider, data source, and catalog, the time the connection was last used for a transaction, and the current state (Open, Inactive).</span></span>

 <span data-ttu-id="f28d9-114">**Utiliser des modèles de session** Activez cette case à cocher pour stocker les modèles et les structures d’exploration de données en tant qu’objets temporaires sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-114">**Use session models** Select this check box to store data mining models and structures as temporary objects on the server.</span></span> <span data-ttu-id="f28d9-115">Les modèles et structures que vous créez seront uniquement disponibles pendant la durée de la session actuelle.</span><span class="sxs-lookup"><span data-stu-id="f28d9-115">The models and structures that you create will be available only for the duration of the current session.</span></span>

 <span data-ttu-id="f28d9-116">Désélectionnez cette option pour enregistrer vos modèles ou structures en les stockant sur un serveur Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="f28d9-116">Deselect this option to save your models or structures by storing them on an Analysis Services server.</span></span>

 <span data-ttu-id="f28d9-117">**Remarque** La possibilité d’utiliser des objets temporaires est disponible uniquement lorsque vous utilisez les outils d’analyse de table pour Excel.</span><span class="sxs-lookup"><span data-stu-id="f28d9-117">**Note** The ability to use temporary objects is available only when you are using the Table Analysis Tools for Excel.</span></span> <span data-ttu-id="f28d9-118">Les modèles d'exploration de données Visio et le Client d'exploration de données pour Excel nécessitent le stockage des structures et des modèles sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-118">The Visio Data Mining templates and the Data Mining Client for Excel require structures and models to be stored on the server.</span></span>

## <a name="tracing-temporary-structures-and-models"></a><span data-ttu-id="f28d9-119">Traçage des structures et modèles temporaires</span><span class="sxs-lookup"><span data-stu-id="f28d9-119">Tracing Temporary Structures and Models</span></span>
 <span data-ttu-id="f28d9-120">Si vous utilisez les Outils d'analyse de table, lesquels créent par défaut des modèles et structures temporaires, l'activité entre le serveur et le client est surveillée, mais les modèles ou les structures que vous créez ne sont pas enregistrés de façon permanente sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-120">If you are using the Table Analysis Tools, which by default create temporary structures and models, the activity between the server and the client is monitored, but the models or structures that you create are not saved permanently to the server.</span></span>

 <span data-ttu-id="f28d9-121">Si vous souhaitez conserver votre travail lorsque vous utilisez l’un des outils d’analyse de table, vous pouvez désélectionner l’option **utiliser les modèles de session**pour que vos modèles soient enregistrés de façon permanente sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="f28d9-121">If you want to preserve your work when using one of the Table Analysis Tools, you can deselect the option, **Use session models**, to cause your models to be permanently saved on the server.</span></span> <span data-ttu-id="f28d9-122">Vous pouvez également **copier les instructions du volet de** suivi dans un fichier afin de pouvoir recréer votre travail ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="f28d9-122">You can also copy the statements in the **Tracer** pane to a file so that you can re-create your work later.</span></span>

## <a name="understanding-sessions"></a><span data-ttu-id="f28d9-123">Description des sessions</span><span class="sxs-lookup"><span data-stu-id="f28d9-123">Understanding Sessions</span></span>
 <span data-ttu-id="f28d9-124">Lorsque vous vous connectez à une instance d'[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], le complément d'exploration de données lance une session.</span><span class="sxs-lookup"><span data-stu-id="f28d9-124">When you connect to an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)], the data mining add-in initiates a session.</span></span> <span data-ttu-id="f28d9-125">Chaque session reçoit un identificateur de session qui identifie une session existante sur l'instance d'[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f28d9-125">Each session receives a session identifier that identifies an existing session on the [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] instance.</span></span> <span data-ttu-id="f28d9-126">Cependant, un identificateur de session ne garantit pas qu'une session reste valide.</span><span class="sxs-lookup"><span data-stu-id="f28d9-126">However, a session identifier does not guarantee that a session remains valid.</span></span> <span data-ttu-id="f28d9-127">La session peut expirer si son délai d'expiration est écoulé ou si la connexion associée à la session est déconnectée.</span><span class="sxs-lookup"><span data-stu-id="f28d9-127">The session can expire if the session times out or the connection associated with the session is disconnected.</span></span> <span data-ttu-id="f28d9-128">Si la session expire et n'est plus valide, [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] termine la session et restaure toutes les transactions qui sont en cours.</span><span class="sxs-lookup"><span data-stu-id="f28d9-128">If the session expires and is no longer valid, [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ends the session and rolls back any transactions that are in process.</span></span> <span data-ttu-id="f28d9-129">Si un message est envoyé avec un identificateur de session qui n'est plus valide, le message échoue et génère une erreur indiquant que la session spécifiée est introuvable.</span><span class="sxs-lookup"><span data-stu-id="f28d9-129">If a message is sent with a session identifier that is no longer valid, the message fails with an error indicating that the specified session cannot be found.</span></span>

 <span data-ttu-id="f28d9-130">Bien que certains modèles d'exploration de données soient explicitement stockés sur le serveur, ce n'est pas le cas des modèles et structures d'exploration de données de session, et aucun enregistrement de l'activité de l'exploration de données de session n'est conservé.</span><span class="sxs-lookup"><span data-stu-id="f28d9-130">Although some data mining models are explicitly stored on the server, session mining models and structures are not, and no record is persisted of session data mining activity.</span></span> <span data-ttu-id="f28d9-131">Étant donné que les modèles et structures d'exploration de données temporaires sont supprimés dès que vous mettez fin à la session, vous devez éviter de fermer votre classeur Excel tant que vous n'avez pas enregistré le travail que vous souhaitez conserver.</span><span class="sxs-lookup"><span data-stu-id="f28d9-131">Because temporary mining models and structures are deleted as soon as you end the session, you should avoid closing your Excel workbook until after you have saved any work that you want to keep.</span></span>

## <a name="changing-connections"></a><span data-ttu-id="f28d9-132">Modification des connexions</span><span class="sxs-lookup"><span data-stu-id="f28d9-132">Changing Connections</span></span>
 <span data-ttu-id="f28d9-133">Les modifications apportées aux connexions ne suppriment pas les traces des connexions précédentes.</span><span class="sxs-lookup"><span data-stu-id="f28d9-133">Changing connections does not delete traces from previous connections.</span></span> <span data-ttu-id="f28d9-134">Seule la fermeture du classeur efface la session.</span><span class="sxs-lookup"><span data-stu-id="f28d9-134">Only closing the workbook erases the session.</span></span>

 <span data-ttu-id="f28d9-135">Si vous modifiez les connexions pendant que vous travaillez dans un classeur Excel, la modification des connexions n’est pas enregistrée dans **le volet de** suivi.</span><span class="sxs-lookup"><span data-stu-id="f28d9-135">If you change connections while working in an Excel workbook, the change of connections is not recorded in the **Tracer** pane.</span></span> <span data-ttu-id="f28d9-136">Pour afficher explicitement le nom et l’état de la connexion actuelle, vous devez cliquer sur **connexion actuelle**.</span><span class="sxs-lookup"><span data-stu-id="f28d9-136">To explicitly display the name and status of the current connection, you must click **Current Connection**.</span></span>

## <a name="understanding-statements-in-the-tracer"></a><span data-ttu-id="f28d9-137">Présentation des instructions du volet Tracer</span><span class="sxs-lookup"><span data-stu-id="f28d9-137">Understanding Statements in the Tracer</span></span>
 <span data-ttu-id="f28d9-138">Le langage DMX vous permet de créer et d'utiliser des modèles d'exploration de données dans [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f28d9-138">DMX is a language that you can use to create and work with data mining models in [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span> <span data-ttu-id="f28d9-139">Vous pouvez utiliser le langage DMX pour créer la structure de nouveaux modèles d'exploration de données, pour effectuer l'apprentissage de ces modèles ainsi que pour les parcourir, les gérer et effectuer des prédictions.</span><span class="sxs-lookup"><span data-stu-id="f28d9-139">You can use DMX to create the structure of new data mining models, train these models, and to browse, manage, and predict against them.</span></span> <span data-ttu-id="f28d9-140">Le langage DMX se compose d'instructions DDL (langage de définition de données), d'instructions DML (langage de manipulation de données), de fonctions et d'opérateurs.</span><span class="sxs-lookup"><span data-stu-id="f28d9-140">DMX is composed of data definition language (DDL) statements, data manipulation language (DML) statements, and functions and operators.</span></span>

 <span data-ttu-id="f28d9-141">Toutefois, cette rubrique n'a pas pour objectif de traiter de manière approfondie les instructions DMX et leur syntaxe.</span><span class="sxs-lookup"><span data-stu-id="f28d9-141">A complete discussion of DMX statements and their syntax is beyond the scope of this topic.</span></span> <span data-ttu-id="f28d9-142">Toutefois, vous pouvez **utiliser les informations du volet de** suivi pour rechercher des informations détaillées sur le comportement d’une instruction DMX.</span><span class="sxs-lookup"><span data-stu-id="f28d9-142">However, you can use the information in the **Tracer** pane to find detailed information about the behavior of a DMX statement.</span></span> <span data-ttu-id="f28d9-143">Les compléments d'exploration de données pour Excel peuvent également vous permettre de créer des instructions DMX complexes et d'interagir avec un serveur [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f28d9-143">The Data Mining Add-ins for Excel can also help you build complex DMX statements and interact with an [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] server.</span></span> <span data-ttu-id="f28d9-144">Pour plus d’informations, consultez [&#40;des compléments d’exploration de données SQL Server&#41;](query-sql-server-data-mining-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="f28d9-144">For more information, see [Query &#40;SQL Server Data Mining Add-ins&#41;](query-sql-server-data-mining-add-ins.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="f28d9-145">Un grand nombre d'instructions DMX sont paramétrées.</span><span class="sxs-lookup"><span data-stu-id="f28d9-145">Many DMX statements are parameterized.</span></span> <span data-ttu-id="f28d9-146">Pour les types simples, les valeurs des paramètres sont répertoriées sous l'instruction.</span><span class="sxs-lookup"><span data-stu-id="f28d9-146">For simple types, the values of the parameters are listed under the statement.</span></span> <span data-ttu-id="f28d9-147">Toutefois, pour les types complexes, seul le type de paramètre est répertorié.</span><span class="sxs-lookup"><span data-stu-id="f28d9-147">However, for complex types, only the type of the parameter is listed.</span></span>

 <span data-ttu-id="f28d9-148">SQL Server Analysis Services utilise également le protocole XMLA (XML for Analysis) pour gérer toutes les communications entre les applications clientes, notamment le Client d'exploration de données pour Excel et une instance d'[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f28d9-148">SQL Server Analysis Services also uses the XML for Analysis (XMLA) protocol to handle all communications between client applications, including the Data Mining Client for Excel and an instance of [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)].</span></span>

 <span data-ttu-id="f28d9-149">Pour plus d'informations sur la syntaxe DMX ainsi que sur les commandes et les éléments dans XMLA, consultez la documentation en ligne de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f28d9-149">For more information about DMX syntax, and about the commands and elements in XMLA, see [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Books Online.</span></span>

 <span data-ttu-id="f28d9-150">Certaines instructions envoyées au serveur peuvent inclure des requêtes qui appellent des procédures stockées système Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="f28d9-150">Some of the statements sent to the server may include queries that call Analysis Services system stored procedures.</span></span> <span data-ttu-id="f28d9-151">Pour plus d'informations, consultez la documentation en ligne de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f28d9-151">For more information, see SQL Server Books Online.</span></span>


