---
title: Gérer les étapes de travail | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- job steps [SQL Server replication]
- job steps [SQL Server Agent]
- jobs [SQL Server Agent], Integration Services package step
- executable programs as job steps
- operating systems [SQL Server], job steps
- Transact-SQL job step
- job steps [Transact-SQL]
- Integration Services packages, job steps
- replication job steps [SQL Server]
- logs [SQL Server], jobs
- SQL Server Agent jobs, job steps
- ActiveX scripting jobs [SQL Server]
- job steps [Analysis Services]
ms.assetid: 51352afc-a0a4-428b-8985-f9e58bb57c31
author: stevestein
ms.author: sstein
ms.openlocfilehash: 7362df13956e44b73d6984691e882bec2f39a1e4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611493"
---
# <a name="manage-job-steps"></a><span data-ttu-id="9f3a1-102">Gérer les étapes de travail</span><span class="sxs-lookup"><span data-stu-id="9f3a1-102">Manage Job Steps</span></span>
  <span data-ttu-id="9f3a1-103">Une étape du travail est une action exécutée par le travail sur une base de données ou un serveur.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-103">A job step is an action that the job takes on a database or a server.</span></span> <span data-ttu-id="9f3a1-104">Chaque travail doit posséder au moins une étape de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-104">Every job must have at least one job step.</span></span> <span data-ttu-id="9f3a1-105">Les étapes de travail peuvent être :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-105">Job steps can be:</span></span>  
  
-   <span data-ttu-id="9f3a1-106">Des programmes exécutables et des commandes du système d'exploitation</span><span class="sxs-lookup"><span data-stu-id="9f3a1-106">Executable programs and operating system commands.</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9f3a1-107">Des instructions, notamment des procédures stockées ou des procédures stockées étendues</span><span class="sxs-lookup"><span data-stu-id="9f3a1-107">statements, including stored procedures and extended stored procedures.</span></span>  
  
-   <span data-ttu-id="9f3a1-108">Des scripts PowerShell</span><span class="sxs-lookup"><span data-stu-id="9f3a1-108">PowerShell scripts.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="9f3a1-109">Des scripts ActiveX</span><span class="sxs-lookup"><span data-stu-id="9f3a1-109">ActiveX scripts.</span></span>  
  
-   <span data-ttu-id="9f3a1-110">Des tâches de réplication</span><span class="sxs-lookup"><span data-stu-id="9f3a1-110">Replication tasks.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="9f3a1-111">Des tâches</span><span class="sxs-lookup"><span data-stu-id="9f3a1-111">tasks.</span></span>  
  
-   [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="9f3a1-112">Des packages</span><span class="sxs-lookup"><span data-stu-id="9f3a1-112">packages.</span></span>  
  
 <span data-ttu-id="9f3a1-113">Chaque étape de travail s'exécute dans un contexte de sécurité spécifique.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-113">Every job step runs in a specific security context.</span></span> <span data-ttu-id="9f3a1-114">Si l'étape de travail spécifie un proxy, elle s'exécute dans le contexte des informations d'identification du proxy.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-114">If the job step specifies a proxy, the job step runs in the security context of the credential for the proxy.</span></span> <span data-ttu-id="9f3a1-115">Dans le cas inverse, l'étape de travail s'exécute dans le contexte du compte du service [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-115">If a job step does not specify a proxy, the job step runs in the context of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account.</span></span> <span data-ttu-id="9f3a1-116">Seuls les membres du rôle de serveur fixe sysadmin sont autorisés à créer des travaux qui ne spécifient pas explicitement de proxy.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-116">Only members of the sysadmin fixed server role can create jobs that do not explicitly specify a proxy.</span></span>  
  
 <span data-ttu-id="9f3a1-117">Les étapes de travail étant exécutées dans le contexte d’un utilisateur [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows spécifique, cet utilisateur doit disposer des autorisations et de la configuration nécessaires à l’exécution de l’étape de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-117">Because job steps run in the context of a specific [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows user, that user must have the permissions and configuration necessary for the job step to execute.</span></span> <span data-ttu-id="9f3a1-118">Par exemple, si vous créez un travail qui requiert une lettre de lecteur ou un chemin d'accès UNC (Universal Naming Convention), les étapes du travail peuvent être exécutées sous votre compte d'utilisateur Windows pendant que les tâches sont testées.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-118">For example, if you create a job that requires a drive letter or a Universal Naming Convention (UNC) path, the job steps may run under your Windows user account while testing the tasks.</span></span> <span data-ttu-id="9f3a1-119">Toutefois, l'utilisateur Windows associé à l'étape de travail doit par ailleurs disposer des autorisations nécessaires, des configurations de lettres de lecteurs appropriées ou des droits d'accès au lecteur requis.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-119">However, the Windows user for the job step must also have the necessary permissions, drive letter configurations, or access to the required drive.</span></span> <span data-ttu-id="9f3a1-120">Sinon, l'étape de travail échoue.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-120">Otherwise, the job step fails.</span></span> <span data-ttu-id="9f3a1-121">Pour éviter ce problème, vérifiez que le proxy associé à chaque étape de travail dispose des autorisations nécessaires pour la tâche correspondant à l'étape de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-121">To prevent this problem, ensure that the proxy for each job step has the necessary permissions for the task that the job step performs.</span></span> <span data-ttu-id="9f3a1-122">Pour plus d’informations, consultez [Security Center pour SQL Server moteur de base de données et Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-122">For more information, see [Security Center for SQL Server Database Engine and Azure SQL Database](../../relational-databases/security/security-center-for-sql-server-database-engine-and-azure-sql-database.md).</span></span>  
  
## <a name="job-step-logs"></a><span data-ttu-id="9f3a1-123">Journaux d'étapes de travail</span><span class="sxs-lookup"><span data-stu-id="9f3a1-123">Job Step Logs</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9f3a1-124">Agent peut écrire le résultat de certaines étapes de travail dans un fichier du système d’exploitation ou dans la table sysjobstepslogs de la base de données msdb.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-124">Agent can write output from some job steps either to an operating system file or to the sysjobstepslogs table in the msdb database.</span></span> <span data-ttu-id="9f3a1-125">Les types d'étapes de travail suivants peuvent écrire les résultats sur les deux destinations :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-125">The following job step types can write output to both destinations:</span></span>  
  
-   <span data-ttu-id="9f3a1-126">Des programmes exécutables et des commandes du système d'exploitation</span><span class="sxs-lookup"><span data-stu-id="9f3a1-126">Executable programs and operating system commands.</span></span>  
  
-   <span data-ttu-id="9f3a1-127">Instructions[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9f3a1-127">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] <span data-ttu-id="9f3a1-128">Des tâches</span><span class="sxs-lookup"><span data-stu-id="9f3a1-128">tasks.</span></span>  
  
 <span data-ttu-id="9f3a1-129">Seules les étapes de travail exécutées par des utilisateurs membres du rôle de serveur fixe sysadmin peuvent écrire le résultat des étapes de travail dans des fichiers du système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-129">Only job steps that are executed by users who are members of the sysadmin fixed server role can write job step output to operating system files.</span></span> <span data-ttu-id="9f3a1-130">Si les étapes de travail sont exécutées par des utilisateurs membres du rôle de base de données fixe SQLAgentUserRole, SQLAgentReaderRole ou SQLAgentOperatorRole dans la base de données msdb, le résultat de ces étapes de travail peut être écrit uniquement dans la table sysjobstepslogs.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-130">If job steps are executed by users who are members of the SQLAgentUserRole, SQLAgentReaderRole, or the SQLAgentOperatorRole fixed database roles in the msdb database, then the output from these job steps can be written only to the sysjobstepslogs table.</span></span>  
  
 <span data-ttu-id="9f3a1-131">Les journaux d'étapes de travail sont automatiquement supprimés dès lors que les travaux ou les étapes de travail sont supprimés.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-131">Job step logs are automatically deleted when jobs or job steps are deleted.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9f3a1-132">La journalisation des tâches de réplication et des étapes de travail des packages [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] est assurée par leur sous-système respectif.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-132">Replication task and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step logging is handled by their respective subsystem.</span></span> <span data-ttu-id="9f3a1-133">Vous ne pouvez pas utiliser l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour configurer la journalisation des étapes de travail pour ces types d'étapes de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-133">You cannot use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent to configure jog step logging for these types of job steps.</span></span>  
  
## <a name="executable-programs-and-operating-system-commands-as-job-steps"></a><span data-ttu-id="9f3a1-134">Programmes exécutables et commandes du système d'exploitation en tant qu'étapes de travail</span><span class="sxs-lookup"><span data-stu-id="9f3a1-134">Executable Programs and Operating-System Commands As Job Steps</span></span>  
 <span data-ttu-id="9f3a1-135">Les programmes exécutables et les commandes du système d'exploitation peuvent être utilisés en tant qu'étapes de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-135">Executable programs and operating-system commands can be used as job steps.</span></span> <span data-ttu-id="9f3a1-136">Ces fichiers peuvent posséder les extension bat, .cmd, .com ou .exe.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-136">These files may have .bat, .cmd, .com, or .exe file extensions.</span></span>  
  
 <span data-ttu-id="9f3a1-137">Lorsque vous utilisez un programme exécutable ou une commande du système d'exploitation en tant qu'étape de travail, vous devez spécifier :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-137">When you use an executable program or an operating-system command as a job step, you must specify:</span></span>  
  
-   <span data-ttu-id="9f3a1-138">le code de sortie du processus renvoyé en cas de succès de la commande ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-138">The process exit code returned if the command was successful.</span></span>  
  
-   <span data-ttu-id="9f3a1-139">Commande à exécuter.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-139">The command to execute.</span></span> <span data-ttu-id="9f3a1-140">S'il s'agit d'exécuter une commande du système d'exploitation, vous spécifiez simplement la commande elle-même.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-140">To execute an operating system command, this is simply the command itself.</span></span> <span data-ttu-id="9f3a1-141">Dans le cas d’un programme externe, il s’agit du nom du programme et des arguments à transmettre au programme, par exemple : **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span><span class="sxs-lookup"><span data-stu-id="9f3a1-141">For an external program, this is the name of the program and the arguments to the program, for example: **C:\Program Files\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe -e -q "sp_who"**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="9f3a1-142">Vous devez indiquer le chemin d'accès complet au fichier exécutable si ce dernier ne réside pas dans un répertoire spécifié dans le chemin système ou le chemin d'accès de l'utilisateur sous le nom duquel l'étape de travail est exécutée.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-142">You must provide the full path to the executable if the executable is not located in a directory specified in the system path or the path for the user that the job step runs as.</span></span>  
  
## <a name="transact-sql-job-steps"></a><span data-ttu-id="9f3a1-143">Étapes de travail Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9f3a1-143">Transact-SQL Job Steps</span></span>  
 <span data-ttu-id="9f3a1-144">Lorsque vous créez une étape de travail [!INCLUDE[tsql](../../includes/tsql-md.md)] , vous devez :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-144">When you create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step, you must:</span></span>  
  
-   <span data-ttu-id="9f3a1-145">identifier la base de données dans laquelle le travail va être exécuté ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-145">Identify the database in which to run the job.</span></span>  
  
-   <span data-ttu-id="9f3a1-146">taper l'instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] à exécuter.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-146">Type the [!INCLUDE[tsql](../../includes/tsql-md.md)] statement to execute.</span></span> <span data-ttu-id="9f3a1-147">L'instruction peut faire appel à une procédure stockée ou à une procédure stockée étendue.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-147">The statement may call a stored procedure or an extended stored procedure.</span></span>  
  
 <span data-ttu-id="9f3a1-148">Vous pouvez éventuellement ouvrir un fichier [!INCLUDE[tsql](../../includes/tsql-md.md)] existant en tant que commande pour l'étape de travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-148">Optionally, you can open an existing [!INCLUDE[tsql](../../includes/tsql-md.md)] file as the command for the job step.</span></span>  
  
 [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9f3a1-149">Les étapes de travail n’utilisent pas les proxies de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-149">job steps do not use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent proxies.</span></span> <span data-ttu-id="9f3a1-150">Au lieu de cela, l'étape de travail s'exécute au nom de son propriétaire ou sous le compte du service Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , si le propriétaire de l'étape de travail est membre du rôle de serveur sysadmin.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-150">Instead, the job step runs as the owner of the job step, or as the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent service account if the owner of the job step is a member of the sysadmin fixed server role.</span></span> <span data-ttu-id="9f3a1-151">Les membres du rôle serveur fixe sysadmin peuvent également préciser que les étapes de travail [!INCLUDE[tsql](../../includes/tsql-md.md)] s’exécutent sous le contexte d’un autre utilisateur par le biais du paramètre *database_user_name* de la procédure stockée sp_add_jobstep.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-151">Members of the sysadmin fixed server role can also specify that [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps run under the context of another user by using the *database_user_name* parameter of the sp_add_jobstep stored procedure.</span></span> <span data-ttu-id="9f3a1-152">Pour plus d’informations, consultez [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-152">For more information, see [sp_add_jobstep &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-add-jobstep-transact-sql).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="9f3a1-153">Une même étape de travail [!INCLUDE[tsql](../../includes/tsql-md.md)] peut contenir plusieurs lots.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-153">A single [!INCLUDE[tsql](../../includes/tsql-md.md)] job step can contain multiple batches.</span></span> [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="9f3a1-154">Les étapes de travail peuvent intégrer des commandes GO incorporées.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-154">job steps can contain embedded GO commands.</span></span>  
  
## <a name="powershell-scripting-job-steps"></a><span data-ttu-id="9f3a1-155">Étapes de travail de scripts PowerShell</span><span class="sxs-lookup"><span data-stu-id="9f3a1-155">PowerShell Scripting Job Steps</span></span>  
 <span data-ttu-id="9f3a1-156">Lorsque vous créez une étape de travail de script PowerShell, vous devez spécifier l'un des deux éléments suivants comme commande pour l'étape :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-156">When you create a PowerShell script job step, you must specify one of two things as the command for the step:</span></span>  
  
-   <span data-ttu-id="9f3a1-157">Le texte d'un script PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-157">The text of a PowerShell script.</span></span>  
  
-   <span data-ttu-id="9f3a1-158">Un fichier de script PowerShell existant à ouvrir.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-158">An existing PowerShell script file to be opened.</span></span>  
  
 <span data-ttu-id="9f3a1-159">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sous-système PowerShell de l’agent ouvre une session PowerShell et charge les [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] composants logiciels enfichables PowerShell. Le script PowerShell utilisé comme commande d’étape de travail peut faire référence au [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur PowerShell et aux applets de commande.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-159">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell subsystem opens a PowerShell session and loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins. The PowerShell script used as the job step command can reference the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider and cmdlets.</span></span> <span data-ttu-id="9f3a1-160">Pour plus d’informations sur l’écriture de scripts PowerShell à l’aide des composants logiciels enfichables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell, consultez [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-160">For more information about writing PowerShell scripts using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins, see the [SQL Server PowerShell](../../powershell/sql-server-powershell.md).</span></span>  
  
## <a name="activex-scripting-job-steps"></a><span data-ttu-id="9f3a1-161">Étapes de travail ActiveX Scripting</span><span class="sxs-lookup"><span data-stu-id="9f3a1-161">ActiveX Scripting Job Steps</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9f3a1-162">L’étape de travail de scripts ActiveX sera supprimé de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent dans une version ultérieure de [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9f3a1-162">The ActiveX scripting job step will be removed from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent in a future version of [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="9f3a1-163">Évitez d'utiliser cette fonctionnalité dans de nouveaux travaux de développement, et prévoyez de modifier les applications qui utilisent actuellement cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-163">Avoid using this feature in new development work, and plan to modify applications that currently use this feature.</span></span>  
  
 <span data-ttu-id="9f3a1-164">Lorsque vous créez une étape de travail ActiveX Scripting, vous devez :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-164">When you create an ActiveX scripting job step, you must:</span></span>  
  
-   <span data-ttu-id="9f3a1-165">identifier le langage de script dans lequel l'étape de travail est écrite ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-165">Identify the scripting language in which the job step is written.</span></span>  
  
-   <span data-ttu-id="9f3a1-166">écrire le script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-166">Write the ActiveX script.</span></span>  
  
 <span data-ttu-id="9f3a1-167">Vous pouvez également ouvrir un fichier de script ActiveX existant en tant que commande pour l'étape du travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-167">You can also open an existing ActiveX script file as the command for the job step.</span></span> <span data-ttu-id="9f3a1-168">Les commandes de script ActiveX peuvent aussi être compilées en externe (par exemple, à l'aide de Microsoft Visual Basic), puis exécutées en tant que programmes exécutables.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-168">Alternatively, ActiveX script commands can be externally compiled (for example, using Microsoft Visual Basic) and then run as executable programs.</span></span>  
  
 <span data-ttu-id="9f3a1-169">Lorsqu'une commande d'étape de travail est un script ActiveX, vous pouvez utiliser l'objet SQLActiveScriptHost pour imprimer le résultat dans le journal d'historique des étapes de travail ou créer des objets COM.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-169">When a job step command is an ActiveX script, you can use the SQLActiveScriptHost object to print output to the job step history log or create COM objects.</span></span> <span data-ttu-id="9f3a1-170">SQLActiveScriptHost est un objet global introduit par le système hôte d'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dans l'espace de noms de script.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-170">SQLActiveScriptHost is a global object that is introduced by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent hosting system into the script name space.</span></span> <span data-ttu-id="9f3a1-171">L’objet a deux méthodes (Print et CreateObject).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-171">The object has two methods (Print and CreateObject).</span></span> <span data-ttu-id="9f3a1-172">L'exemple suivant illustre le fonctionnement du script ActiveX dans Visual Basic Scripting Edition (VBScript).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-172">The following example shows how ActiveX scripting works in Visual Basic Scripting Edition (VBScript).</span></span>  
  
```  
' VBScript example for ActiveX Scripting job step  
' Create a Dmo.Server object. The object connects to the  
' server on which the script is running.  
  
Set oServer = CreateObject("SQLDmo.SqlServer")  
oServer.LoginSecure = True  
oServer.Connect "(local)"  
'Disconnect and destroy the server object  
oServer.DisConnect  
Set oServer = nothing
```  
  
## <a name="replication-job-steps"></a><span data-ttu-id="9f3a1-173">Étapes de travail de réplication</span><span class="sxs-lookup"><span data-stu-id="9f3a1-173">Replication Job Steps</span></span>  
 <span data-ttu-id="9f3a1-174">Lorsque vous créez des publications et des abonnements par le biais de la réplication, des travaux de réplication sont créés par défaut.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-174">When you create publications and subscriptions using replication, replication jobs are created by default.</span></span> <span data-ttu-id="9f3a1-175">Le type de travail créé dépend du type de réplication (instantané, transactionnelle ou fusion) et des options utilisées.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-175">The type of job created is determined by the type of replication (snapshot, transactional, or merge) and the options used.</span></span>  
  
 <span data-ttu-id="9f3a1-176">Les étapes de travail de réplication activent l'un des agents de réplication suivants :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-176">Replication job steps activate one of these replication agents:</span></span>  
  
-   <span data-ttu-id="9f3a1-177">Agent d'instantané (travail Snapshot)</span><span class="sxs-lookup"><span data-stu-id="9f3a1-177">Snapshot Agent (Snapshot job)</span></span>  
  
-   <span data-ttu-id="9f3a1-178">Agent de lecture du journal (travail LogReader)</span><span class="sxs-lookup"><span data-stu-id="9f3a1-178">Log Reader Agent (LogReader job)</span></span>  
  
-   <span data-ttu-id="9f3a1-179">Agent de distribution (travail de distribution)</span><span class="sxs-lookup"><span data-stu-id="9f3a1-179">Distribution Agent (Distribution job)</span></span>  
  
-   <span data-ttu-id="9f3a1-180">Agent de fusion (travail Merge)</span><span class="sxs-lookup"><span data-stu-id="9f3a1-180">Merge Agent (Merge job)</span></span>  
  
-   <span data-ttu-id="9f3a1-181">Agent de lecture de file d'attente (travail QueueReader)</span><span class="sxs-lookup"><span data-stu-id="9f3a1-181">Queue Reader Agent (QueueReader job)</span></span>  
  
 <span data-ttu-id="9f3a1-182">Lorsque la réplication est configurée, vous pouvez spécifier l'un des trois modes d'exécution suivants pour les agents de réplication : en continu après le démarrage de l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , à la demande, ou selon un programme.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-182">When replication is set up, you can specify to run the replication agents in one of three ways: continuously after [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is started, on demand, or according to a schedule.</span></span> <span data-ttu-id="9f3a1-183">Pour plus d’informations sur les agents de réplication, consultez [Présentation des Agents de réplication](../../relational-databases/replication/agents/replication-agents-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-183">For more information about replication agents, see [Replication Agents Overview](../../relational-databases/replication/agents/replication-agents-overview.md).</span></span>  
  
## <a name="analysis-services-job-steps"></a><span data-ttu-id="9f3a1-184">Étapes de travail Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9f3a1-184">Analysis Services Job Steps</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="9f3a1-185">Agent prend en charge deux types distincts d’étapes de travail Analysis Services : les étapes de travail de commande et les étapes de travail de requête.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-185">Agent supports two distinct types of Analysis Services job steps, command job steps, and query job steps.</span></span>  
  
### <a name="analysis-services-command-job-steps"></a><span data-ttu-id="9f3a1-186">Étapes de travail de commande Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9f3a1-186">Analysis Services Command Job Steps</span></span>  
 <span data-ttu-id="9f3a1-187">Lorsque vous créez une étape de travail de commande [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , vous devez :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-187">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] command job step, you must:</span></span>  
  
-   <span data-ttu-id="9f3a1-188">identifier le serveur de bases de données OLAP sur lequel l'étape de travail doit s'exécuter ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-188">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="9f3a1-189">taper l'instruction à exécuter.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-189">Type the statement to execute.</span></span> <span data-ttu-id="9f3a1-190">L’instruction doit être une méthode XML pour [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute**.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-190">The statement must be an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Execute** method.</span></span> <span data-ttu-id="9f3a1-191">L’instruction ne doit pas contenir d’enveloppe SOAP complète ou de méthode XML pour [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover**.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-191">The statement may not contain a complete SOAP envelope or an XML for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] **Discover** method.</span></span> <span data-ttu-id="9f3a1-192">Notez que, bien que [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] prenne en charge les enveloppes SOAP (Simple Object Access Protocol) complètes et la méthode **Discover** , ce n’est pas le cas pour les étapes de travail de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-192">Notice that, while [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] supports complete SOAP envelopes and the **Discover** method, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps do not.</span></span>  
  
### <a name="analysis-services-query-job-steps"></a><span data-ttu-id="9f3a1-193">Étapes de travail de requête Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9f3a1-193">Analysis Services Query Job Steps</span></span>  
 <span data-ttu-id="9f3a1-194">Lorsque vous créez une étape de travail de requête [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , vous devez :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-194">When you create an [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] query job step, you must:</span></span>  
  
-   <span data-ttu-id="9f3a1-195">identifier le serveur de bases de données OLAP sur lequel l'étape de travail doit s'exécuter ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-195">Identify the database OLAP server in which to run the job step.</span></span>  
  
-   <span data-ttu-id="9f3a1-196">taper l'instruction à exécuter.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-196">Type the statement to execute.</span></span> <span data-ttu-id="9f3a1-197">L'instruction doit être une requête MDX (Multidimensional Expressions).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-197">The statement must be a multidimensional expressions (MDX) query.</span></span>  
  
 <span data-ttu-id="9f3a1-198">Pour plus d’informations sur MDX, consultez [principes de base des requêtes mdx &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-198">For more information on MDX, see [MDX Query Fundamentals &#40;Analysis Services&#41;](https://docs.microsoft.com/analysis-services/multidimensional-models/mdx/mdx-query-fundamentals-analysis-services).</span></span>  
  
## <a name="integration-services-packages"></a><span data-ttu-id="9f3a1-199">Packages Integration Services</span><span class="sxs-lookup"><span data-stu-id="9f3a1-199">Integration Services Packages</span></span>  
 <span data-ttu-id="9f3a1-200">Lorsque vous créez une étape de travail de package [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , vous devez effectuer les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="9f3a1-200">When you create an [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] package job step, you must do the following:</span></span>  
  
-   <span data-ttu-id="9f3a1-201">identifier la source du package ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-201">Identify the source of the package.</span></span>  
  
-   <span data-ttu-id="9f3a1-202">identifier l'emplacement du package ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-202">Identify the location of the package.</span></span>  
  
-   <span data-ttu-id="9f3a1-203">identifier les fichiers de configuration, dans la mesure où le package requiert des fichiers de configuration ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-203">If configuration files are required for the package, identify the configuration files.</span></span>  
  
-   <span data-ttu-id="9f3a1-204">identifier les fichiers de commandes, dans la mesure où le package requiert des fichiers de commandes ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-204">If command files are required for the package, identify the command files.</span></span>  
  
-   <span data-ttu-id="9f3a1-205">identifier la vérification à utiliser pour le package.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-205">Identify the verification to use for the package.</span></span> <span data-ttu-id="9f3a1-206">Par exemple, vous pouvez préciser que le package doit être signé ou posséder un ID de package spécifique ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-206">For example, you can specify that the package must be signed, or that the package must have a specific package ID.</span></span>  
  
-   <span data-ttu-id="9f3a1-207">identifier les sources de données du package ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-207">Identify the data sources for the package.</span></span>  
  
-   <span data-ttu-id="9f3a1-208">identifier les fournisseurs d'informations du package ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-208">Identify the log providers for the package.</span></span>  
  
-   <span data-ttu-id="9f3a1-209">préciser les variables et les valeurs à définir préalablement à l'exécution du package ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-209">Specify variables and values to set before running the package.</span></span>  
  
-   <span data-ttu-id="9f3a1-210">identifier les options d'exécution ;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-210">Identify execution options.</span></span>  
  
-   <span data-ttu-id="9f3a1-211">ajouter ou modifier les options de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-211">Add or modify command-line options.</span></span>  
  
 <span data-ttu-id="9f3a1-212">Notez que si vous avez déployé le package dans le catalogue SSIS et que vous spécifiez **Catalogue SSIS** comme source du package, la plupart de ces informations de configuration sont obtenues automatiquement à partir du package.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-212">Note that if you deployed the package to the SSIS Catalog and you specify **SSIS Catalog** as the package source, much of this configuration information is obtained automatically from the package.</span></span> <span data-ttu-id="9f3a1-213">Sous l’onglet **Configuration** , vous pouvez spécifier l’environnement, les valeurs de paramètres, les valeurs de gestionnaire de connexions, les substitutions de propriété, et si le package s’exécute dans un environnement 32 bits.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-213">Under the **Configuration** tab you can specify the environment, parameter values, connection manager values, property overrides, and whether the package runs in a 32-bit runtime environment.</span></span>  
  
 <span data-ttu-id="9f3a1-214">Pour plus d’informations sur la création d’étapes de travail qui exécutent des packages [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] , consultez [Travaux de SQL Server Agent pour les packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span><span class="sxs-lookup"><span data-stu-id="9f3a1-214">For more information about creating job steps that run [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] packages, see [SQL Server Agent Jobs for Packages](../../integration-services/packages/sql-server-agent-jobs-for-packages.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="9f3a1-215">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="9f3a1-215">Related Tasks</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="9f3a1-216">**Description**</span><span class="sxs-lookup"><span data-stu-id="9f3a1-216">**Description**</span></span>|<span data-ttu-id="9f3a1-217">**Rubrique**</span><span class="sxs-lookup"><span data-stu-id="9f3a1-217">**Topic**</span></span>|  
|<span data-ttu-id="9f3a1-218">Décrit comment créer une étape de travail avec un programme exécutable.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-218">Describes how to create a job step with an executable program.</span></span>|[<span data-ttu-id="9f3a1-219">Créer une étape de travail CmdExec</span><span class="sxs-lookup"><span data-stu-id="9f3a1-219">Create a CmdExec Job Step</span></span>](create-a-cmdexec-job-step.md)|  
|<span data-ttu-id="9f3a1-220">Décrit comment réinitialiser les autorisations de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-220">Describes how to reset [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent permissions.</span></span>|[<span data-ttu-id="9f3a1-221">Configurer un utilisateur de manière à créer et à gérer des travaux de SQL Server Agent</span><span class="sxs-lookup"><span data-stu-id="9f3a1-221">Configure a User to Create and Manage SQL Server Agent Jobs</span></span>](configure-a-user-to-create-and-manage-sql-server-agent-jobs.md)|  
|<span data-ttu-id="9f3a1-222">Décrit comment créer une étape de travail [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9f3a1-222">Describes how to create a [!INCLUDE[tsql](../../includes/tsql-md.md)] job step.</span></span>|[<span data-ttu-id="9f3a1-223">Créer une étape de travail Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9f3a1-223">Create a Transact-SQL Job Step</span></span>](create-a-transact-sql-job-step.md)|  
|<span data-ttu-id="9f3a1-224">Décrit comment définir les options des étapes de travail Transact-SQL de l'Agent Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9f3a1-224">Describes how to define options for Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent Transact-SQL job steps.</span></span>|[<span data-ttu-id="9f3a1-225">Définir les options d'une étape de travail Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="9f3a1-225">Define Transact-SQL Job Step Options</span></span>](define-transact-sql-job-step-options.md)|  
|<span data-ttu-id="9f3a1-226">Décrit comment créer une étape de travail de script ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-226">Describes how to create an ActiveX script job step.</span></span>|[<span data-ttu-id="9f3a1-227">Créer une étape de travail de script ActiveX</span><span class="sxs-lookup"><span data-stu-id="9f3a1-227">Create an ActiveX Script Job Step</span></span>](create-an-activex-script-job-step.md)|  
|<span data-ttu-id="9f3a1-228">Décrit comment créer et définir les étapes de travail de l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] qui exécutent les commandes et requêtes Analysis Services de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9f3a1-228">Describes how to create and define [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job steps that execute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Analysis Services commands and queries.</span></span>|[<span data-ttu-id="9f3a1-229">Créer une étape de travail Analysis Services</span><span class="sxs-lookup"><span data-stu-id="9f3a1-229">Create an Analysis Services Job Step</span></span>](create-an-analysis-services-job-step.md)|  
|<span data-ttu-id="9f3a1-230">Décrit quelle mesure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] doit exécuter si une défaillance se produit pendant l'exécution d'une tâche.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-230">Describes what action [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] should take if a failure occurs during job execution.</span></span>|[<span data-ttu-id="9f3a1-231">Définir un flux en cas de réussite ou d'échec de l'étape de travail</span><span class="sxs-lookup"><span data-stu-id="9f3a1-231">Set Job Step Success or Failure Flow</span></span>](set-job-step-success-or-failure-flow.md)|  
|<span data-ttu-id="9f3a1-232">Décrit comment afficher les détails d'une étape de travail dans la boîte de dialogue Propriétés de l'étape du travail.</span><span class="sxs-lookup"><span data-stu-id="9f3a1-232">Describes how to view job step details in the Job Step Properties dialog.</span></span>|[<span data-ttu-id="9f3a1-233">View Job Step Information</span><span class="sxs-lookup"><span data-stu-id="9f3a1-233">View Job Step Information</span></span>](view-job-step-information.md)|  
|<span data-ttu-id="9f3a1-234">Décrit comment supprimer un journal d'étapes de travail de l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="9f3a1-234">Describes how to delete a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent job step log.</span></span>|[<span data-ttu-id="9f3a1-235">Supprimer un journal d’étapes de travail</span><span class="sxs-lookup"><span data-stu-id="9f3a1-235">Delete a Job Step Log</span></span>](delete-a-job-step-log.md)|  
  
## <a name="see-also"></a><span data-ttu-id="9f3a1-236">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9f3a1-236">See Also</span></span>  
 <span data-ttu-id="9f3a1-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="9f3a1-237">[dbo.sysjobstepslogs &#40;Transact-SQL&#41;](/sql/relational-databases/system-tables/dbo-sysjobstepslogs-transact-sql) </span></span>  
 <span data-ttu-id="9f3a1-238">[Créer des travaux](create-jobs.md) </span><span class="sxs-lookup"><span data-stu-id="9f3a1-238">[Create Jobs](create-jobs.md) </span></span>  
 [<span data-ttu-id="9f3a1-239">sp_add_job &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="9f3a1-239">sp_add_job &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-add-job-transact-sql)  
