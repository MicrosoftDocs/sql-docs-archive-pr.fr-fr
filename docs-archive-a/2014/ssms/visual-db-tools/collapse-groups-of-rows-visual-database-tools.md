---
title: Réduire des groupes de lignes (Visual Database Tools) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- group collapsing [SQL Server]
- collapsing rows
- row collapsing [SQL Server]
ms.assetid: 7338dad0-965d-44ba-8c1a-b993acb7156d
author: stevestein
ms.author: sstein
ms.openlocfilehash: f7ec2f3072f9fea7c96179934924421080e75821
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603743"
---
# <a name="collapse-groups-of-rows-visual-database-tools"></a><span data-ttu-id="849eb-102">Réduire des groupes de lignes (Visual Database Tools)</span><span class="sxs-lookup"><span data-stu-id="849eb-102">Collapse Groups of Rows (Visual Database Tools)</span></span>
  <span data-ttu-id="849eb-103">Vous pouvez créer un résultat de requête dans lequel chaque ligne de résultat correspond à tout un groupe de lignes des données d'origine.</span><span class="sxs-lookup"><span data-stu-id="849eb-103">You can create a query result in which each result row corresponds to an entire group of rows from the original data.</span></span> <span data-ttu-id="849eb-104">La réduction de lignes donne les possibilités suivantes :</span><span class="sxs-lookup"><span data-stu-id="849eb-104">When collapsing rows, there are several things to keep in mind:</span></span>  
  
-   <span data-ttu-id="849eb-105">**Élimination de lignes en double** Certaines requêtes donnent des ensembles de résultats faisant apparaître plusieurs lignes identiques.</span><span class="sxs-lookup"><span data-stu-id="849eb-105">**You can eliminate duplicate rows** Some queries can create result sets in which multiple identical rows appear.</span></span> <span data-ttu-id="849eb-106">Par exemple, vous pouvez créer un jeu de résultats où les lignes citent une ville et son état si un auteur quelconque y réside. Si plusieurs auteurs résident dans la même ville, vous obtiendrez plusieurs lignes identiques.</span><span class="sxs-lookup"><span data-stu-id="849eb-106">For example, you can create a result set in which each row contains the city and state name of a city containing an author - but if a city contains several authors, there will be several identical rows.</span></span> <span data-ttu-id="849eb-107">L'instruction SQL obtenue peut se présenter de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="849eb-107">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state  
    FROM authors  
    ```  
  
     <span data-ttu-id="849eb-108">L'ensemble des résultats généré par la requête ci-dessus n'est pas très utile.</span><span class="sxs-lookup"><span data-stu-id="849eb-108">The result set generated by the preceding query is not very useful.</span></span> <span data-ttu-id="849eb-109">Si quatre auteurs résident dans la même ville, l'ensemble des résultats inclut quatre lignes identiques.</span><span class="sxs-lookup"><span data-stu-id="849eb-109">If a city contains four authors, the result set will include four identical rows.</span></span> <span data-ttu-id="849eb-110">Comme l'ensemble des résultats n'inclut pas d'autres colonnes que celles de la ville et de l'état, il n'y a aucun moyen de faire une distinction entre les lignes identiques obtenues.</span><span class="sxs-lookup"><span data-stu-id="849eb-110">Since the result set does not include any columns other than city and state, there is no way to distinguish the identical rows from each other.</span></span> <span data-ttu-id="849eb-111">Une façon d'éviter ces doublons serait d'inclure d'autres colonnes pour établir une distinction entre les lignes.</span><span class="sxs-lookup"><span data-stu-id="849eb-111">One way to avoid such duplicate rows is to include additional columns that can make the rows different.</span></span> <span data-ttu-id="849eb-112">Par exemple, si vous incluez le nom de l'auteur, les risques de doublons diminuent (les seuls doublons seront les lignes dans lesquelles deux auteurs de même nom résident dans la même ville).</span><span class="sxs-lookup"><span data-stu-id="849eb-112">For example, if you include author name, each row will be different (provided no two like-named authors live within any one city).</span></span> <span data-ttu-id="849eb-113">L'instruction SQL obtenue peut se présenter de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="849eb-113">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, fname, minit, lname  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="849eb-114">Si la requête précédente élimine le symptôme, elle ne résout cependant pas vraiment le problème.</span><span class="sxs-lookup"><span data-stu-id="849eb-114">Of course, the preceding query eliminates the symptom, but does not really solve the problem.</span></span> <span data-ttu-id="849eb-115">Vous pouvez obtenir un ensemble de résultats sans doublon, mais il ne s'agit plus d'un ensemble de résultats sur les villes.</span><span class="sxs-lookup"><span data-stu-id="849eb-115">That is, the result set has no duplicates, but it is no longer a result set about cities.</span></span> <span data-ttu-id="849eb-116">Pour éliminer les doublons de l'ensemble des résultats d'origine et lui garder son but, les villes dans lesquelles réside un auteur, créez une requête ne retournant des lignes que lorsqu'elles sont différentes les unes des autres.</span><span class="sxs-lookup"><span data-stu-id="849eb-116">To eliminate duplicates in the original result set, and still have each row describe a city, you can create a query returning only distinct rows.</span></span> <span data-ttu-id="849eb-117">L'instruction SQL obtenue peut se présenter de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="849eb-117">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT DISTINCT city, state  
    FROM authors  
  
    ```  
  
     <span data-ttu-id="849eb-118">Pour plus de détails sur l’élimination des doublons, consultez [Exclure les doublons de lignes &#40;Visual Database Tools&#41;](visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="849eb-118">For details about eliminating duplicates, see [Exclude Duplicate Rows &#40;Visual Database Tools&#41;](visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="849eb-119">**Calculs sur des groupes de lignes** Vous pouvez synthétiser des informations par groupe de lignes.</span><span class="sxs-lookup"><span data-stu-id="849eb-119">**You can calculate on groups of rows** That is, you can summarize information in groups of rows.</span></span> <span data-ttu-id="849eb-120">Par exemple, il serait possible de demander un ensemble de résultats dans lequel chaque ligne indiquerait le nom d'une ville si elle contient un auteur, ainsi que le nombre d'auteurs résidant dans la ville.</span><span class="sxs-lookup"><span data-stu-id="849eb-120">For example, you can create a result set in which each row contains the city and state name of a city containing an author, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="849eb-121">L'instruction SQL obtenue peut se présenter de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="849eb-121">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
  
    ```  
  
     <span data-ttu-id="849eb-122">Pour plus d’informations sur les calculs possibles sur des groupes de lignes, consultez [Résumer les résultats de la requête &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) et [Trier et regrouper des résultats de requête &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="849eb-122">For details about calculating on groups of rows, see [Summarize Query Results &#40;Visual Database Tools&#41;](summarize-query-results-visual-database-tools.md) and [Sort and Group Query Results &#40;Visual Database Tools&#41;](sort-and-group-query-results-visual-database-tools.md).</span></span>  
  
-   <span data-ttu-id="849eb-123">**Utilisation de critères de sélection pour inclure des groupes de lignes** Par exemple, il serait possible de demander un ensemble de résultats dans lequel chaque ligne indiquerait le nom d'une ville et son état si elle contient plusieurs auteurs, ainsi que le nombre d'auteurs résidant dans la ville.</span><span class="sxs-lookup"><span data-stu-id="849eb-123">**You can use selection criteria to include groups of rows** For example, you can create a result set in which each row contains the city and state name of a city containing several authors, plus a count of the number of authors contained in that city.</span></span> <span data-ttu-id="849eb-124">L'instruction SQL obtenue peut se présenter de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="849eb-124">The resulting SQL might look like this:</span></span>  
  
    ```  
    SELECT city, state, COUNT(*)  
    FROM authors  
    GROUP BY city, state  
    HAVING COUNT(*) > 1  
  
    ```  
  
     <span data-ttu-id="849eb-125">Pour plus d’informations sur la façon d’appliquer des critères de sélection aux groupes de lignes, consultez [Spécifier des conditions pour des groupes &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) et [Utiliser les clauses HAVING et WHERE dans la même requête &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span><span class="sxs-lookup"><span data-stu-id="849eb-125">For details about applying selection criteria on groups of rows, see [Specify Conditions for Groups &#40;Visual Database Tools&#41;](specify-conditions-for-groups-visual-database-tools.md) and [Use HAVING and WHERE Clauses in the Same Query &#40;Visual Database Tools&#41;](use-having-and-where-clauses-in-the-same-query-visual-database-tools.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="849eb-126">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="849eb-126">See Also</span></span>  
 <span data-ttu-id="849eb-127">[Spécifier les critères de recherche &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span><span class="sxs-lookup"><span data-stu-id="849eb-127">[Specify Search Criteria &#40;Visual Database Tools&#41;](specify-search-criteria-visual-database-tools.md) </span></span>  
 [<span data-ttu-id="849eb-128">Rubriques de procédures relatives à la conception de requêtes et de vues &#40;Visual Database Tools&#41;</span><span class="sxs-lookup"><span data-stu-id="849eb-128">Design Queries and Views How-to Topics &#40;Visual Database Tools&#41;</span></span>](design-queries-and-views-how-to-topics-visual-database-tools.md)  
  
  
