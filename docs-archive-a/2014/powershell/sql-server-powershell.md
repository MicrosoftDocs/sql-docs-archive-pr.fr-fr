---
title: SQL Server PowerShell | Microsoft Docs
ms.custom: ''
ms.date: 01/19/2019
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: scripting
ms.topic: conceptual
ms.assetid: 89b70725-bbe7-4ffe-a27d-2a40005a97e7
author: stevestein
ms.author: sstein
ms.openlocfilehash: 87b4a21bf46bb27fba604c81af633576da6342c9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87699870"
---
# <a name="sql-server-powershell"></a><span data-ttu-id="3ae2e-102">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-102">SQL Server PowerShell</span></span>
  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] <span data-ttu-id="3ae2e-103">prend en charge Windows PowerShell, un environnement de script puissant qui permet aux administrateurs et aux développeurs d'automatiser l'administration de serveurs et le déploiement d'applications.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-103">supports Windows PowerShell, which is a powerful scripting shell that lets administrators and developers automate server administration and application deployment.</span></span> <span data-ttu-id="3ae2e-104">Le langage Windows PowerShell prend en charge une logique plus complexe que les scripts [!INCLUDE[tsql](../includes/tsql-md.md)] , ce qui permet aux administrateurs [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] de générer des scripts d'administration fiables.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-104">The Windows PowerShell language supports more complex logic than [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, giving [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] administrators the ability to build robust administration scripts.</span></span> <span data-ttu-id="3ae2e-105">Les scripts Windows PowerShell peuvent également être utilisés pour administrer d'autres produits serveur [!INCLUDE[msCoName](../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3ae2e-105">Windows PowerShell scripts can also be used to administer other [!INCLUDE[msCoName](../includes/msconame-md.md)] server products.</span></span> <span data-ttu-id="3ae2e-106">Cela fournit aux administrateurs un langage de script commun entre les serveurs.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-106">This gives administrators a common scripting language across servers.</span></span>  
  
## <a name="sql-server-powershell-components"></a><span data-ttu-id="3ae2e-107">Composants de SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-107">SQL Server PowerShell Components</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="3ae2e-108">fournit un module Windows PowerShell nommé `sqlps` utilisé pour importer les composants de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] dans un environnement ou un script Windows PowerShell 2.0.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-108">provides a Windows PowerShell module named `sqlps` that is used to import the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components into a Windows PowerShell 2.0 environment or script.</span></span> <span data-ttu-id="3ae2e-109">Le module `sqlps` charge deux composants logiciels enfichables Windows PowerShell qui implémentent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="3ae2e-109">The `sqlps` module loads two Windows PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="3ae2e-110">Un fournisseur [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] , qui active un mécanisme de navigation simple semblable aux chemins d'accès de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-110">A [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider, which enables a simple navigation mechanism similar to file system paths.</span></span> <span data-ttu-id="3ae2e-111">Vous pouvez générer des chemins d'accès semblables aux chemins d'accès de système de fichiers, où le lecteur est associé à un modèle SMO ( [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Management Object) et les nœuds sont basés sur les classes du modèle objet.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-111">You can build paths similar to file system paths, where the drive is associated with a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] management object model, and the nodes are based on the object model classes.</span></span> <span data-ttu-id="3ae2e-112">Vous pouvez ensuite utiliser des commandes familières telles que **cd** et **dir** pour naviguer parmi les chemins d’accès de la même façon que vous naviguez parmi des dossiers dans une fenêtre d’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-112">You can then use familiar commands such as **cd** and **dir** to navigate the paths similar to the way you navigate folders in a command prompt window.</span></span> <span data-ttu-id="3ae2e-113">Vous pouvez utiliser d’autres commandes, telles que **ren** ou **del**, pour exécuter des actions sur les nœuds du chemin d’accès.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-113">You can use other commands, such as **ren** or **del**, to perform actions on the nodes in the path.</span></span>  
  
-   <span data-ttu-id="3ae2e-114">Un jeu d'applets de commande, qui sont des commandes utilisées dans les scripts Windows PowerShell pour spécifier une action [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3ae2e-114">A set of cmdlets, which are commands used in Windows PowerShell scripts to specify a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] action.</span></span> <span data-ttu-id="3ae2e-115">Les applets de commande [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] prennent en charge des actions telles que l’exécution d’un script **sqlcmd** contenant des instructions [!INCLUDE[tsql](../includes/tsql-md.md)] ou XQuery.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-115">The [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets support actions such as running a **sqlcmd** script containing [!INCLUDE[tsql](../includes/tsql-md.md)] or XQuery statements.</span></span>  
  
 <span data-ttu-id="3ae2e-116">Pour en savoir plus sur Windows PowerShell, consultez le [Guide Mise en route de Windows PowerShell](https://msdn.microsoft.com/library/hh857337.aspx).</span><span class="sxs-lookup"><span data-stu-id="3ae2e-116">To learn about Windows PowerShell, see the [Windows PowerShell Getting Started Guide](https://msdn.microsoft.com/library/hh857337.aspx).</span></span>  
  
## <a name="sql-server-versions"></a><span data-ttu-id="3ae2e-117">versions SQL Server</span><span class="sxs-lookup"><span data-stu-id="3ae2e-117">SQL Server Versions</span></span>  
 <span data-ttu-id="3ae2e-118">Les composants [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell permettent de gérer des instances de [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-118">The [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components can be used to manage instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] or later.</span></span> <span data-ttu-id="3ae2e-119">Les instances de [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] doivent exécuter SP2 ou ultérieur.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-119">Instances of [!INCLUDE[ssVersion2005](../includes/ssversion2005-md.md)] must be running SP2 or later.</span></span> <span data-ttu-id="3ae2e-120">Les instances de [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] doivent exécuter SP4 ou ultérieur.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-120">Instances of [!INCLUDE[ssVersion2000](../includes/ssversion2000-md.md)] must be running SP4 or later.</span></span> <span data-ttu-id="3ae2e-121">Lorsque les composants [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell sont utilisés avec des versions antérieures de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], ils sont limités aux fonctionnalités disponible dans ces versions.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-121">When the [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] PowerShell components are used with earlier versions of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], they are limited to the functionality available in those versions.</span></span>  
  
## <a name="sql-server-powershell-tasks"></a><span data-ttu-id="3ae2e-122">Tâches de SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-122">SQL Server PowerShell Tasks</span></span>  
  
|<span data-ttu-id="3ae2e-123">Description de la tâche</span><span class="sxs-lookup"><span data-stu-id="3ae2e-123">Task Description</span></span>|<span data-ttu-id="3ae2e-124">Rubrique</span><span class="sxs-lookup"><span data-stu-id="3ae2e-124">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="3ae2e-125">Décrit le mécanisme par défaut pour exécuter les composants de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell, ouvrir une session PowerShell et charger le module `sqlps`.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-125">Describes the preferred mechanism for running the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell components; to open a PowerShell session and load the `sqlps` module.</span></span> <span data-ttu-id="3ae2e-126">Le module `sqlps` charge le fournisseur et les applets de commande [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell, ainsi que les assemblys SMO (SQL Server Management Object) utilisés par le fournisseur et les applets de commande.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-126">The `sqlps` module loads in the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] PowerShell provider and cmdlets, and the SQL Server Management Object (SMO) assemblies used by the provider and cmdlets.</span></span>|[<span data-ttu-id="3ae2e-127">Importer le module SQLPS</span><span class="sxs-lookup"><span data-stu-id="3ae2e-127">Import the SQLPS Module</span></span>](../database-engine/import-the-sqlps-module.md)|  
|<span data-ttu-id="3ae2e-128">Explique comment charger uniquement les assemblys SMO sans fournisseur ni applet de commande.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-128">Describes how to load only the SMO assemblies without the provider or cmdlets.</span></span>|[<span data-ttu-id="3ae2e-129">Charger les assemblys SMO dans Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-129">Load the SMO Assemblies in Windows PowerShell</span></span>](load-the-smo-assemblies-in-windows-powershell.md)|  
|<span data-ttu-id="3ae2e-130">Explique comment exécuter une session Windows PowerShell en cliquant avec le bouton droit sur un nœud dans l’ **Explorateur d’objets**.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-130">Describes how to run a Windows PowerShell session by right-clicking a node in **Object Explorer**.</span></span> [!INCLUDE[ssManStudio](../includes/ssmanstudio-md.md)]<span data-ttu-id="3ae2e-131">lance une session Windows PowerShell, charge le `sqlps` module et définit le SQL Server chemin d’accès du fournisseur à l’objet sélectionné.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-131">launches a Windows PowerShell session, loads the `sqlps` module, and sets the SQL Server provider path to the object selected.</span></span>|[<span data-ttu-id="3ae2e-132">Exécuter Windows PowerShell à partir de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="3ae2e-132">Run Windows PowerShell from SQL Server Management Studio</span></span>](run-windows-powershell-from-sql-server-management-studio.md)|  
|<span data-ttu-id="3ae2e-133">Explique comment créer les étapes d'un travail de l'Agent SQL Server qui exécutent un script Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-133">Describes how to create SQL Server Agent job steps that run a Windows PowerShell script.</span></span> <span data-ttu-id="3ae2e-134">Les travaux peuvent ensuite être planifiés de manière à s'exécuter à des heures spécifiques ou en réponse à des événements.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-134">The jobs can then be scheduled to run at specific times or in response to events.</span></span>|[<span data-ttu-id="3ae2e-135">Utiliser Windows PowerShell dans les étapes de travail de l'Agent SQL Server</span><span class="sxs-lookup"><span data-stu-id="3ae2e-135">Run Windows PowerShell Steps in SQL Server Agent</span></span>](run-windows-powershell-steps-in-sql-server-agent.md)|  
|<span data-ttu-id="3ae2e-136">Explique comment utiliser le fournisseur [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] pour naviguer dans une hiérarchie d'objets [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3ae2e-136">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] provider to navigate a hierarchy of [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] objects.</span></span>|[<span data-ttu-id="3ae2e-137">Fournisseur SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-137">SQL Server PowerShell Provider</span></span>](sql-server-powershell-provider.md)|  
|<span data-ttu-id="3ae2e-138">Explique comment utiliser les applets de commande [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] qui spécifient des actions du [!INCLUDE[ssDE](../includes/ssde-md.md)] , telles que l'exécution d'un script [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3ae2e-138">Describes how to use the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cmdlets that specify [!INCLUDE[ssDE](../includes/ssde-md.md)] actions such as running a [!INCLUDE[tsql](../includes/tsql-md.md)] script.</span></span>|[<span data-ttu-id="3ae2e-139">Utiliser les applets de commande du Moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="3ae2e-139">Use the Database Engine cmdlets</span></span>](../database-engine/use-the-database-engine-cmdlets.md)|  
|<span data-ttu-id="3ae2e-140">Explique comment spécifier des identificateurs délimités [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] qui contiennent des caractères non pris en charge par Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-140">Describes how to specify [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] delimited identifiers that contain characters not supported by Windows PowerShell.</span></span>|[<span data-ttu-id="3ae2e-141">Identificateurs SQL Server dans PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-141">SQL Server Identifiers in PowerShell</span></span>](sql-server-identifiers-in-powershell.md)|  
|<span data-ttu-id="3ae2e-142">Explique comment établir des connexions d'authentification SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-142">Describes how to make SQL Server Authentication connections.</span></span> <span data-ttu-id="3ae2e-143">Par défaut, les composants SQL Server PowerShell utilisent des connexions d'authentification Windows à l'aide des informations d'identification Windows du processus exécutant Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-143">By default, the SQL Server PowerShell components use Windows Authentication connections using the Windows credentials of the process running Windows PowerShell.</span></span>|[<span data-ttu-id="3ae2e-144">Gérer l'authentification dans le moteur de base de données PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-144">Manage Authentication in Database Engine PowerShell</span></span>](manage-authentication-in-database-engine-powershell.md)|  
|<span data-ttu-id="3ae2e-145">Explique comment utiliser des variables implémentées par le fournisseur SQL Server PowerShell pour contrôler le nombre d'objets répertoriés lors de l'utilisation de la saisie semi-automatique par tabulation Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-145">Describes how to use variables implemented by the SQL Server PowerShell provider to control how many objects are listed when using Windows PowerShell tab completion.</span></span> <span data-ttu-id="3ae2e-146">Cela est particulièrement utile lorsque vous travaillez sur des bases de données qui contiennent un grand nombre d'objets.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-146">This is particularly useful when working on databases that contain large numbers of objects.</span></span>|[<span data-ttu-id="3ae2e-147">Gérer la saisie semi-automatique par tabulation &#40;SQL Server PowerShell&#41;</span><span class="sxs-lookup"><span data-stu-id="3ae2e-147">Manage Tab Completion &#40;SQL Server PowerShell&#41;</span></span>](manage-tab-completion-sql-server-powershell.md)|  
|<span data-ttu-id="3ae2e-148">Explique comment utiliser Get-Help pour obtenir des informations sur les composants [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] dans l'environnement Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3ae2e-148">Describes how to use Get-Help to get information about the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] components in the Windows PowerShell environment.</span></span>|[<span data-ttu-id="3ae2e-149">Obtenir de l'aide sur SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="3ae2e-149">Get Help SQL Server PowerShell</span></span>](../database-engine/get-help-sql-server-powershell.md)|  
  
  
