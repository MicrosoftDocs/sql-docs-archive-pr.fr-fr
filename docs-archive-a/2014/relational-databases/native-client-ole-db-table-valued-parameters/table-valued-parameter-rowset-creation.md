---
title: Création d'un ensemble de lignes de paramètre table | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
ms.assetid: ffe213ca-cc0e-465e-b31c-a8272324c4fe
author: rothja
ms.author: jroth
ms.openlocfilehash: a22ccbd583d95c41daa0a113363985828cf1e9d6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603472"
---
# <a name="table-valued-parameter-rowset-creation"></a><span data-ttu-id="7002f-102">Création d'un ensemble de lignes de paramètre table</span><span class="sxs-lookup"><span data-stu-id="7002f-102">Table-Valued Parameter Rowset Creation</span></span>
  <span data-ttu-id="7002f-103">Bien que les consommateurs puissent fournir n'importe quel objet d'ensemble de lignes pour les paramètres table, les objets d'ensemble de lignes communs sont implémentés dans des banques de données principales, ce qui limite leurs performances.</span><span class="sxs-lookup"><span data-stu-id="7002f-103">Although consumers can provide any rowset object for table-valued parameters, typical rowset objects are implemented against back-end data stores, and therefore provide limited performance.</span></span> <span data-ttu-id="7002f-104">C'est pourquoi le fournisseur OLE DB de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client permet aux consommateurs de créer un objet d'ensemble de lignes spécialisé par-dessus les données en mémoire.</span><span class="sxs-lookup"><span data-stu-id="7002f-104">For this reason, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider enables consumers to create a specialized rowset object on top of in-memory data.</span></span> <span data-ttu-id="7002f-105">Cet objet d’ensemble de lignes spécial en mémoire est un nouvel objet COM appelé ensemble de lignes de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-105">This special, in-memory rowset object is a new COM object called a table-valued parameter rowset .</span></span> <span data-ttu-id="7002f-106">Il fournit des fonctionnalités similaires aux jeux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="7002f-106">It provides functionality similar to parameter sets.</span></span>  
  
 <span data-ttu-id="7002f-107">Les objets d'ensemble de lignes de paramètre table sont créés explicitement par le consommateur pour les paramètres d'entrée via plusieurs interfaces de niveau session.</span><span class="sxs-lookup"><span data-stu-id="7002f-107">Table-valued parameter rowset objects are created explicitly by the consumer for input parameters through multiple session-level interfaces.</span></span> <span data-ttu-id="7002f-108">Il existe une instance d'un objet d'ensemble de lignes de paramètre table par paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-108">There is one instance of a table-valued parameter rowset object per table-valued parameter.</span></span> <span data-ttu-id="7002f-109">Le consommateur peut créer les objets d'ensemble de lignes de paramètre table soit en fournissant des informations de métadonnées qui sont déjà connues (scénario statique), soit en révélant ces informations par le biais des interfaces du fournisseur (scénario dynamique).</span><span class="sxs-lookup"><span data-stu-id="7002f-109">The consumer can create the table-valued parameter rowset objects either by providing metadata information that is already known (static scenario), or by discovering it through provider interfaces (dynamic scenario).</span></span> <span data-ttu-id="7002f-110">Les sections qui suivent décrivent ces deux scénarios :</span><span class="sxs-lookup"><span data-stu-id="7002f-110">The following sections describe these two scenarios.</span></span>  
  
## <a name="static-scenario"></a><span data-ttu-id="7002f-111">Scénario statique</span><span class="sxs-lookup"><span data-stu-id="7002f-111">Static Scenario</span></span>  
 <span data-ttu-id="7002f-112">Lorsque les informations de type sont connues, le consommateur utilise ITableDefinitionWithConstraints::CreateTableWithConstraints pour instancier un objet d'ensemble de lignes de paramètre table qui correspond à un paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-112">When the type information is known, the consumer uses ITableDefinitionWithConstraints::CreateTableWithConstraints to instantiate a table-valued parameter rowset object that corresponds to a table-valued parameter.</span></span>  
  
 <span data-ttu-id="7002f-113">Le champ *guid* (paramètre *pTableID*) contient le GUID spécial (CLSID_ROWSET_TVP).</span><span class="sxs-lookup"><span data-stu-id="7002f-113">The *guid* field (*pTableID* parameter) contains the special GUID (CLSID_ROWSET_TVP).</span></span> <span data-ttu-id="7002f-114">Le membre *pwszName* contient le nom du type de paramètre table que le consommateur souhaite instancier.</span><span class="sxs-lookup"><span data-stu-id="7002f-114">The *pwszName* member contains the name of the table-valued parameter type that the consumer wants to instantiate.</span></span> <span data-ttu-id="7002f-115">Le champ *eKind* sera défini sur DBKIND_GUID_NAME.</span><span class="sxs-lookup"><span data-stu-id="7002f-115">The *eKind* field will be set to DBKIND_GUID_NAME.</span></span> <span data-ttu-id="7002f-116">Ce nom est requis lorsque l'instruction est une instruction SQL ad hoc ; le nom est facultatif s'il s'agit d'un appel de procédure.</span><span class="sxs-lookup"><span data-stu-id="7002f-116">This name is required when the statement is ad hoc SQL; the name is optional if it is a procedure call.</span></span>  
  
 <span data-ttu-id="7002f-117">Pour l'agrégation, le consommateur passe le paramètre *pUnkOuter* avec l'IUnknown de contrôle.</span><span class="sxs-lookup"><span data-stu-id="7002f-117">For aggregation, the consumer passes the *pUnkOuter* parameter with the controlling IUnknown.</span></span>  
  
 <span data-ttu-id="7002f-118">Les propriétés d’objet d’ensemble de lignes de paramètre table étant en lecture seule, le consommateur n’est pas censé définir des propriétés dans *rgPropertySets*.</span><span class="sxs-lookup"><span data-stu-id="7002f-118">The table-valued parameter rowset object properties are read only, so the consumer is not expected to set any properties in *rgPropertySets*.</span></span>  
  
 <span data-ttu-id="7002f-119">Pour le membre *rgPropertySets* de chaque structure DBCOLUMNDESC, le consommateur peut spécifier des propriétés supplémentaires pour chaque colonne.</span><span class="sxs-lookup"><span data-stu-id="7002f-119">For the *rgPropertySets* member of each DBCOLUMNDESC structure, the consumer can specify additional properties for each column.</span></span> <span data-ttu-id="7002f-120">Ces propriétés appartiennent au jeu de propriétés DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="7002f-120">These properties belong to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span> <span data-ttu-id="7002f-121">Elles vous permettent de spécifier les paramètres calculés et les paramètres par défaut de chaque colonne.</span><span class="sxs-lookup"><span data-stu-id="7002f-121">They enable you to specify computed and default settings for each column.</span></span> <span data-ttu-id="7002f-122">Elles prennent également en charge les propriétés de colonnes existantes, telles que la possibilité de valeur Null et l'identité.</span><span class="sxs-lookup"><span data-stu-id="7002f-122">They also support existing column properties, such as nullability and identity.</span></span>  
  
 <span data-ttu-id="7002f-123">Pour récupérer les informations correspondantes d’un objet d’ensemble de lignes de paramètre table, le consommateur utilise IRowsetInfo::GetProperties.</span><span class="sxs-lookup"><span data-stu-id="7002f-123">To retrieve corresponding information from a table-valued parameter rowset object, the consumer uses IRowsetInfo::GetProperties.</span></span>  
  
 <span data-ttu-id="7002f-124">Pour récupérer les informations sur l’État null, unique, calculé et mis à jour de chaque colonne, le consommateur utilise IColumnsRowset :: GetColumnsRowset ou IColumnsInfo :: GetColumnInfo.</span><span class="sxs-lookup"><span data-stu-id="7002f-124">To retrieve information about the null, unique, computed, and update status of each column, the consumer use IColumnsRowset::GetColumnsRowset or IColumnsInfo::GetColumnInfo.</span></span> <span data-ttu-id="7002f-125">Ces méthodes fournissent des informations détaillées sur chaque colonne de l'ensemble de lignes du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-125">These methods provide detailed information about each table-valued parameter rowset column.</span></span>  
  
 <span data-ttu-id="7002f-126">Le consommateur spécifie le type de chaque colonne du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-126">The consumer specifies the type of each column of the table-valued parameter.</span></span> <span data-ttu-id="7002f-127">Cela est identique à la spécification de colonnes lors de la création d'une table dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7002f-127">This is similar to how columns are specified when a table is created in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="7002f-128">Le consommateur obtient un objet d’ensemble de lignes de paramètre table à partir du [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client via le paramètre de sortie *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="7002f-128">The consumer obtains a table-valued parameter rowset object from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider through the *ppRowset* output parameter.</span></span>  
  
## <a name="dynamic-scenario"></a><span data-ttu-id="7002f-129">Scénario Dynamique</span><span class="sxs-lookup"><span data-stu-id="7002f-129">Dynamic Scenario</span></span>  
 <span data-ttu-id="7002f-130">Lorsque le consommateur n’a pas d’informations de type, il doit utiliser IOpenRowset :: OpenRowset pour instancier des objets d’ensemble de lignes de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="7002f-130">When the consumer does not have type information, it should use IOpenRowset::OpenRowset to instantiate table-valued parameter rowset objects.</span></span> <span data-ttu-id="7002f-131">Tout ce que le consommateur doit fournir au fournisseur est le nom du type.</span><span class="sxs-lookup"><span data-stu-id="7002f-131">All the consumer has to provide to the provider is the type name.</span></span>  
  
 <span data-ttu-id="7002f-132">Dans ce scénario, le fournisseur obtient les informations de type d'un objet d'ensemble de lignes de paramètre table à partir du serveur au nom du consommateur.</span><span class="sxs-lookup"><span data-stu-id="7002f-132">In this scenario, the provider obtains type information about a table-valued parameter rowset object from the server on behalf of the consumer.</span></span>  
  
 <span data-ttu-id="7002f-133">Les paramètres *pTableID* et *pUnkOuter* doivent être définis comme dans le scénario statique.</span><span class="sxs-lookup"><span data-stu-id="7002f-133">The *pTableID* and *pUnkOuter* parameters should be set as in the static scenario.</span></span> <span data-ttu-id="7002f-134">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client obtient ensuite les informations de type (informations de colonne et contraintes) à partir du serveur et retourne un objet d’ensemble de lignes de paramètre table par le biais du paramètre *ppRowset* .</span><span class="sxs-lookup"><span data-stu-id="7002f-134">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB Provider then obtains the type information (column information and constraints) from the server, and return a table-valued parameter rowset object through the *ppRowset* parameter.</span></span> <span data-ttu-id="7002f-135">Cette opération requiert une communication avec le serveur, et par conséquent ne fonctionne pas aussi bien que le scénario statique.</span><span class="sxs-lookup"><span data-stu-id="7002f-135">This operation requires communication with the server, and therefore does not perform as well as the static scenario.</span></span> <span data-ttu-id="7002f-136">Le scénario dynamique fonctionne uniquement avec des appels de procédure paramétrables.</span><span class="sxs-lookup"><span data-stu-id="7002f-136">The dynamic scenario works only with parameterized procedure calls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7002f-137">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7002f-137">See Also</span></span>  
 <span data-ttu-id="7002f-138">[Paramètres table &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="7002f-138">[Table-Valued Parameters &#40;OLE DB&#41;](table-valued-parameters-ole-db.md) </span></span>  
 [<span data-ttu-id="7002f-139">Utiliser les paramètres table &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="7002f-139">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](../native-client-ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
