---
title: Prise en charge des types de paramètre table OLE DB (méthodes) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603477"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="4bcdb-102">Prise en charge des types de paramètre table OLE DB (méthodes)</span><span class="sxs-lookup"><span data-stu-id="4bcdb-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="4bcdb-103">Les méthodes OLE DB standard suivantes prennent en charge les paramètres table :</span><span class="sxs-lookup"><span data-stu-id="4bcdb-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="4bcdb-104">Méthode</span><span class="sxs-lookup"><span data-stu-id="4bcdb-104">Method</span></span>|<span data-ttu-id="4bcdb-105">Prise en charge des paramètres table</span><span class="sxs-lookup"><span data-stu-id="4bcdb-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="4bcdb-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="4bcdb-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="4bcdb-107">Utilisée lorsque vous connaissez les informations de type du paramètre table, et que vous souhaitez instancier un objet d'ensemble de lignes de paramètre table en fonction des informations de type.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="4bcdb-108">Pour plus d’informations, consultez « Scénario statique » dans [Création d’un ensemble de lignes de paramètres table](table-valued-parameter-rowset-creation.md).</span><span class="sxs-lookup"><span data-stu-id="4bcdb-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="4bcdb-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="4bcdb-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="4bcdb-110">Utilisée lorsque vous ne connaissez pas les informations de type d'un paramètre table, et que vous souhaitez instancier un objet d'ensemble de lignes de paramètre table en fonction des informations de métadonnées extraites du serveur.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="4bcdb-111">Pour plus d’informations, consultez « Scénario dynamique » dans [Création d’un ensemble de lignes de paramètres table](table-valued-parameter-rowset-creation.md).</span><span class="sxs-lookup"><span data-stu-id="4bcdb-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="4bcdb-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="4bcdb-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="4bcdb-113">Pour spécifier un paramètre de commande de paramètre table, le consommateur spécifie le type de paramètre « table » ou « DBTYPE_TABLE » dans le membre *pwszName* de la structure DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="4bcdb-114">*ulParamSize* est défini sur ~0.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="4bcdb-115">Pour plus d’informations, consultez « Spécification des paramètres table » dans [Exécution de commandes contenant des paramètres table](executing-commands-containing-table-valued-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="4bcdb-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="4bcdb-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="4bcdb-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="4bcdb-117">Définit les propriétés spécifiques aux paramètres table, telles que le nom de schéma, le nom de type, l'ordre des colonnes et les colonnes par défaut.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="4bcdb-118">Le consommateur spécifie l’ordinal du paramètre dans le membre *iOrdinal* de la structure SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="4bcdb-119">Le jeu de propriétés demandé est DBPROPSET_SQLSERVERPARAMETER.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="4bcdb-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="4bcdb-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="4bcdb-121">Obtient les types de tous les paramètres d'une commande spécifiée.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="4bcdb-122">Pour les paramètres table, le champ *wType* de la structure DBPARAMINFO a la valeur DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="4bcdb-123">Le champ *ulParamSize* est défini sur ~0 pour indiquer une longueur inconnue.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="4bcdb-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="4bcdb-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="4bcdb-125">Obtient des informations de type supplémentaires pour les paramètres du type DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="4bcdb-126">Le consommateur spécifie l’ordinal du paramètre dans le membre *iOrdinal* de la structure SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="4bcdb-127">Le consommateur peut demander chacune des propriétés du jeu de propriétés DBPROPSET_SQLSERVERPARAMETER répertoriées sous ISSCommandWithParameters::SetParameterProperties.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="4bcdb-128">Dans la mesure où le consommateur ne connaît pas le type de paramètre table, le fournisseur doit définir SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME et SSPROP_PARAM_TYPE_CATALOGNAME sur leurs valeurs correctes.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="4bcdb-129">Les propriétés restantes, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS et SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, utilisent leurs valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="4bcdb-130">Une fois que le consommateur a découvert le nom du type de paramètre table, il utilise IOpenRowset::OpenRowset pour créer une instance de ce paramètre table, en spécifiant le nom du type de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="4bcdb-131">Pour plus d'informations, consultez [Découverte du type de paramètre table](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="4bcdb-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="4bcdb-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="4bcdb-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="4bcdb-133">Obtient les propriétés de l'ensemble de lignes de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="4bcdb-134">Le consommateur peut utiliser ces propriétés pour optimiser la configuration des liaisons.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="4bcdb-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="4bcdb-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="4bcdb-136">Récupère les informations de métadonnées relatives une table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4bcdb-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="4bcdb-137">Pour les paramètres table, cette même interface fournit des informations de métadonnées détaillées à propos de chaque colonne, notamment les suivantes :</span><span class="sxs-lookup"><span data-stu-id="4bcdb-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="4bcdb-138">-DBCOLUMN_FLAGS indique une possibilité de valeur NULL par le biais du bit DBCOLUMNFLAGS_ISNULLABLE.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="4bcdb-139">-DBCOLUMN_ISUNIQUE indique si la colonne est une colonne d’identité.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="4bcdb-140">-DBCOLUMN_COMPUTEMODE indique si la colonne est calculée.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="4bcdb-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="4bcdb-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="4bcdb-142">Pour lier un objet d’ensemble de lignes de paramètre table à un paramètre de commande, créez un accesseur dont le membre *wType* a la valeur DBTYPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="4bcdb-143">La structure DBOBJECT contiendra IID_IRowset ou toute autre interface d’objet d’ensemble de lignes valide dans le membre *iid*.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="4bcdb-144">Les autres champs sont traités de la même façon que DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="4bcdb-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4bcdb-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4bcdb-145">See Also</span></span>  
 <span data-ttu-id="4bcdb-146">[Prise en charge du type de paramètre table OLE DB](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="4bcdb-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="4bcdb-147">[Création d’un ensemble de lignes de paramètre table](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="4bcdb-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="4bcdb-148">Utiliser les paramètres table &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="4bcdb-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
