---
title: Champs de descripteur pour les colonnes constituantes des paramètres table | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields for constituent columns
ms.assetid: 944b3968-fd47-4847-98d6-b87e8ef2acdc
author: rothja
ms.author: jroth
ms.openlocfilehash: 7474a4a80309f6ce9754fefabfd0080c89f803b3
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612814"
---
# <a name="descriptor-fields-for-table-valued-parameter-constituent-columns"></a><span data-ttu-id="289d8-102">Champs de descripteur pour les colonnes constituantes des paramètres table</span><span class="sxs-lookup"><span data-stu-id="289d8-102">Descriptor Fields for Table-Valued Parameter Constituent Columns</span></span>
  <span data-ttu-id="289d8-103">Les champs de descripteur de paramètre table décrits dans cette section sont manipulés à l’aide de [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) et de [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) avec le descripteur du descripteur de paramètre d’implémentation (IPD).</span><span class="sxs-lookup"><span data-stu-id="289d8-103">The table-valued parameter descriptor fields described in this section are manipulated by using [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) and [SQLSetDescField](../native-client-odbc-api/sqlsetdescfield.md) with the handle for the implementation parameter descriptor (IPD).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="289d8-104">Notes</span><span class="sxs-lookup"><span data-stu-id="289d8-104">Remarks</span></span>  
 <span data-ttu-id="289d8-105">SQL_DESC_AUTO_UNIQUE_VALUE est utilisé pour les paramètres table ainsi que pour d'autres fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="289d8-105">SQL_DESC_AUTO_UNIQUE_VALUE is used for table-valued parameters as well as other features.</span></span>  
  
|<span data-ttu-id="289d8-106">Nom de l’attribut</span><span class="sxs-lookup"><span data-stu-id="289d8-106">Attribute name</span></span>|<span data-ttu-id="289d8-107">Type</span><span class="sxs-lookup"><span data-stu-id="289d8-107">Type</span></span>|<span data-ttu-id="289d8-108">Description</span><span class="sxs-lookup"><span data-stu-id="289d8-108">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="289d8-109">SQL_DESC_AUTO_UNIQUE_VALUE</span><span class="sxs-lookup"><span data-stu-id="289d8-109">SQL_DESC_AUTO_UNIQUE_VALUE</span></span>|<span data-ttu-id="289d8-110">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="289d8-110">SQLINTEGER</span></span>|<span data-ttu-id="289d8-111">SQL_TRUE indique que cette colonne est une colonne d'identité.</span><span class="sxs-lookup"><span data-stu-id="289d8-111">SQL_TRUE indicates that this column is an identity column.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="289d8-112">peut utiliser ces informations pour optimiser les performances, mais les applications ne sont pas obligées de le définir pour les colonnes d’identité.</span><span class="sxs-lookup"><span data-stu-id="289d8-112">can use this information to optimize performance, but applications are not required to set it for identity columns.</span></span>|  
  
 <span data-ttu-id="289d8-113">Les attributs suivants sont ajoutés à tous les types de paramètres du descripteur de paramètre d'application (APD, Application Parameter Descriptor) et du descripteur IPD :</span><span class="sxs-lookup"><span data-stu-id="289d8-113">The following attributes are added to all parameter types in the application parameter descriptor (APD) and implementation parameter descriptor (IPD):</span></span>  
  
|<span data-ttu-id="289d8-114">Nom de l’attribut</span><span class="sxs-lookup"><span data-stu-id="289d8-114">Attribute name</span></span>|<span data-ttu-id="289d8-115">Type</span><span class="sxs-lookup"><span data-stu-id="289d8-115">Type</span></span>|<span data-ttu-id="289d8-116">Description</span><span class="sxs-lookup"><span data-stu-id="289d8-116">Description</span></span>|  
|--------------------|----------|-----------------|  
|<span data-ttu-id="289d8-117">SQL_CA_SS_COLUMN_COMPUTED</span><span class="sxs-lookup"><span data-stu-id="289d8-117">SQL_CA_SS_COLUMN_COMPUTED</span></span>|<span data-ttu-id="289d8-118">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="289d8-118">SQLSMALLINT</span></span>|<span data-ttu-id="289d8-119">SQL_TRUE indique que cette colonne est calculée.</span><span class="sxs-lookup"><span data-stu-id="289d8-119">SQL_TRUE indicates that this column is computed.</span></span><br /><br /> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="289d8-120">peut utiliser ces informations pour optimiser les performances, mais les applications ne sont pas obligées de le définir pour les colonnes calculées.</span><span class="sxs-lookup"><span data-stu-id="289d8-120">can use this information to optimize performance, but applications are not required to set it for computed columns.</span></span><br /><br /> <span data-ttu-id="289d8-121">Cet attribut est ignoré pour les liaisons qui ne sont pas des colonnes de paramètres table.</span><span class="sxs-lookup"><span data-stu-id="289d8-121">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="289d8-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span><span class="sxs-lookup"><span data-stu-id="289d8-122">SQL_CA_SS_COLUMN_IN_UNIQUE_KEY</span></span>|<span data-ttu-id="289d8-123">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="289d8-123">SQLSMALLINT</span></span>|<span data-ttu-id="289d8-124">SQL_TRUE indique qu'une colonne de paramètre table participe à une clé unique.</span><span class="sxs-lookup"><span data-stu-id="289d8-124">SQL_TRUE indicates that a table-valued parameter column participates in a unique key.</span></span> <span data-ttu-id="289d8-125">Cela peut accroître les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="289d8-125">This can result in better query performance.</span></span> <span data-ttu-id="289d8-126">Cet attribut est ignoré pour les liaisons qui ne sont pas des colonnes de paramètres table.</span><span class="sxs-lookup"><span data-stu-id="289d8-126">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span>|  
|<span data-ttu-id="289d8-127">SQL_CA_SS_COLUMN_SORT_ORDER</span><span class="sxs-lookup"><span data-stu-id="289d8-127">SQL_CA_SS_COLUMN_SORT_ORDER</span></span>|<span data-ttu-id="289d8-128">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="289d8-128">SQLSMALLINT</span></span>|<span data-ttu-id="289d8-129">Indique l'ordre de tri d'une colonne de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="289d8-129">Indicates the sort order of a table-valued parameter column.</span></span> <span data-ttu-id="289d8-130">Cela peut accroître les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="289d8-130">This can result in better query performance.</span></span> <span data-ttu-id="289d8-131">Cet attribut est ignoré pour les liaisons qui ne sont pas des colonnes de paramètres table.</span><span class="sxs-lookup"><span data-stu-id="289d8-131">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="289d8-132">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="289d8-132">The possible values are the following:</span></span><br /><br /> <span data-ttu-id="289d8-133">-SQL_SS_ASCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="289d8-133">-   SQL_SS_ASCENDING_ORDER</span></span><br /><span data-ttu-id="289d8-134">-SQL_SS_DESCENDING_ORDER</span><span class="sxs-lookup"><span data-stu-id="289d8-134">-   SQL_SS_DESCENDING_ORDER</span></span><br /><span data-ttu-id="289d8-135">-SQL_SS_ORDER_UNSPECIFIED</span><span class="sxs-lookup"><span data-stu-id="289d8-135">-   SQL_SS_ORDER_UNSPECIFIED</span></span><br /><br /> <span data-ttu-id="289d8-136">Les valeurs différentes de SQL_SS_ASCENDING_ORDER et SQL_SS_DESCENDING_ORDER génèrent une erreur avec SQLSTATE HY024 et le message « Valeur d'attribut non valide » ; par ailleurs, elles sont traitées en tant que SQL_SS_ORDER_UNSPECIFIED, qui représente la valeur par défaut de cet attribut.</span><span class="sxs-lookup"><span data-stu-id="289d8-136">Values other than SQL_SS_ASCENDING_ORDER and SQL_SS_DESCENDING_ORDER generate an error with SQLSTATE HY024 and message 'Invalid attribute value' and are treated as SQL_SS_ORDER_UNSPECIFIED, which is the default value for this attribute.</span></span>|  
|<span data-ttu-id="289d8-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span><span class="sxs-lookup"><span data-stu-id="289d8-137">SQL_CA_SS_COLUMN_SORT_ORDINAL</span></span>|<span data-ttu-id="289d8-138">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="289d8-138">SQLSMALLINT</span></span>|<span data-ttu-id="289d8-139">Indique l'ordinal d'une colonne de paramètre table dans le jeu des colonnes qui définissent l'ordre global d'un paramètre table.</span><span class="sxs-lookup"><span data-stu-id="289d8-139">Indicates the ordinal of a table-valued parameter column in the set of columns that define the overall ordering for a table-valued parameter.</span></span> <span data-ttu-id="289d8-140">Cela peut accroître les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="289d8-140">This can result in better query performance.</span></span> <span data-ttu-id="289d8-141">Cet attribut est ignoré pour les liaisons qui ne sont pas des colonnes de paramètres table.</span><span class="sxs-lookup"><span data-stu-id="289d8-141">This attribute is ignored for bindings that are not table-valued parameter columns.</span></span> <span data-ttu-id="289d8-142">Les ordinaux de tri commencent à 1.</span><span class="sxs-lookup"><span data-stu-id="289d8-142">Sort ordinals start at 1.</span></span> <span data-ttu-id="289d8-143">La valeur 0 (valeur par défaut) indique qu'une colonne de paramètre table n'a pas d'ordre de tri.</span><span class="sxs-lookup"><span data-stu-id="289d8-143">A value of 0, the default, indicates that a table-valued parameter column does not have column ordering.</span></span>|  
|<span data-ttu-id="289d8-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span><span class="sxs-lookup"><span data-stu-id="289d8-144">SQL_CA_SS_COLUMN_HAS_DEFAULT_VALUE</span></span>|<span data-ttu-id="289d8-145">SQLSMALLINT</span><span class="sxs-lookup"><span data-stu-id="289d8-145">SQLSMALLINT</span></span>|<span data-ttu-id="289d8-146">Indique si toutes les lignes du paramètre table ont la valeur par défaut de cette colonne.</span><span class="sxs-lookup"><span data-stu-id="289d8-146">Indicates whether all rows in the table-valued parameter will have the default value for this column.</span></span> <span data-ttu-id="289d8-147">Pour les paramètres table, il n'est pas possible de sélectionner la valeur par défaut ligne par ligne.</span><span class="sxs-lookup"><span data-stu-id="289d8-147">For table-valued parameters, it is not possible to select the default value on a row-by-row basis.</span></span> <span data-ttu-id="289d8-148">Une valeur SQL_FALSE indique que les lignes ont des valeurs qui ne sont pas définies par défaut.</span><span class="sxs-lookup"><span data-stu-id="289d8-148">A value of SQL_FALSE indicates that rows will have non-default values.</span></span> <span data-ttu-id="289d8-149">Il s'agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="289d8-149">This is the default.</span></span> <span data-ttu-id="289d8-150">Une valeur SQL_TRUE indique que cette colonne a des valeurs par défaut pour toutes les lignes.</span><span class="sxs-lookup"><span data-stu-id="289d8-150">A value of SQL_TRUE indicates that this column will have default values for all rows.</span></span><br /><br /> <span data-ttu-id="289d8-151">Avec SQL_TRUE, aucune donnée n'est envoyée au serveur.</span><span class="sxs-lookup"><span data-stu-id="289d8-151">If set to SQL_TRUE, no data will be sent to the server.</span></span><br /><br /> <span data-ttu-id="289d8-152">Ce champ peut également être utilisé avec des colonnes d'identité ou des colonnes calculées, si les valeurs de colonnes ne sont pas requises pour le traitement serveur.</span><span class="sxs-lookup"><span data-stu-id="289d8-152">This field can also be used with identity or computed columns if the column values are not required for server processing.</span></span>|  
  
 <span data-ttu-id="289d8-153">Ces attributs sont uniquement valides pour les colonnes de paramètres table.</span><span class="sxs-lookup"><span data-stu-id="289d8-153">These attributes are only valid for table-valued parameter columns.</span></span> <span data-ttu-id="289d8-154">Ils sont ignorés pour les autres paramètres.</span><span class="sxs-lookup"><span data-stu-id="289d8-154">They are ignored for other parameters.</span></span>  
  
 <span data-ttu-id="289d8-155">Si SQL_CA_SS_COL_HAS_DEFAULT_VALUE est défini pour une colonne de paramètre table, la valeur de SQL_DESC_DATA_PTR pour cette colonne doit être un pointeur Null.</span><span class="sxs-lookup"><span data-stu-id="289d8-155">If SQL_CA_SS_COL_HAS_DEFAULT_VALUE is set for a table-valued parameter column, SQL_DESC_DATA_PTR for that column must be a null pointer.</span></span> <span data-ttu-id="289d8-156">Sinon, SQLExecute ou SQLExecDirect retourne SQL_ERROR.</span><span class="sxs-lookup"><span data-stu-id="289d8-156">Otherwise, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="289d8-157">Un enregistrement de diagnostic est généré avec SQLSTATE = 07S01 et le message « utilisation non valide du paramètre par défaut pour \<p> le paramètre, \<c> la colonne », où \<p> est le paramètre ordinal et \<c> est l’ordinal de colonne.</span><span class="sxs-lookup"><span data-stu-id="289d8-157">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>, column \<c>", where \<p> is the parameter ordinal and \<c> is the column ordinal.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="289d8-158">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="289d8-158">See Also</span></span>  
 [<span data-ttu-id="289d8-159">Paramètres table &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="289d8-159">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
