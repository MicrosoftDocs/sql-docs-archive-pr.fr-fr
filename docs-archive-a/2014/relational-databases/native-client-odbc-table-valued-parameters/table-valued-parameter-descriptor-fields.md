---
title: Champs de descripteur de paramètre table | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698147"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="e4228-102">Champs de descripteur de paramètre table</span><span class="sxs-lookup"><span data-stu-id="e4228-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="e4228-103">La prise en charge des paramètres table inclut de nouveaux champs spécifiques à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dans les descripteurs de paramètre d'application (APD) ODBC et les descripteurs de paramètre d'implémentation (IPD).</span><span class="sxs-lookup"><span data-stu-id="e4228-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="e4228-104">Notes</span><span class="sxs-lookup"><span data-stu-id="e4228-104">Remarks</span></span>  
  
|<span data-ttu-id="e4228-105">Nom</span><span class="sxs-lookup"><span data-stu-id="e4228-105">Name</span></span>|<span data-ttu-id="e4228-106">Emplacement</span><span class="sxs-lookup"><span data-stu-id="e4228-106">Location</span></span>|<span data-ttu-id="e4228-107">Type</span><span class="sxs-lookup"><span data-stu-id="e4228-107">Type</span></span>|<span data-ttu-id="e4228-108">Description</span><span class="sxs-lookup"><span data-stu-id="e4228-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="e4228-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="e4228-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="e4228-110">IPD</span><span class="sxs-lookup"><span data-stu-id="e4228-110">IPD</span></span>|<span data-ttu-id="e4228-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e4228-111">SQLTCHAR\*</span></span>|<span data-ttu-id="e4228-112">Nom du type de serveur du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="e4228-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="e4228-113">Lorsqu’un nom de type de paramètre table est spécifié sur un appel à SQLBindParameter, il doit toujours être spécifié en tant que valeur Unicode, même dans les applications générées en tant qu’applications ANSI.</span><span class="sxs-lookup"><span data-stu-id="e4228-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="e4228-114">La valeur utilisée pour le paramètre *StrLen_or_IndPtr* doit être SQL_NTS ou la longueur de chaîne du nom multipliée par sizeof (WCHAR).</span><span class="sxs-lookup"><span data-stu-id="e4228-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="e4228-115">Lorsqu’un nom de type de paramètre table est spécifié via SQLSetDescField, il peut être spécifié à l’aide d’un littéral qui est conforme à la façon dont l’application est générée.</span><span class="sxs-lookup"><span data-stu-id="e4228-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="e4228-116">Le Gestionnaire de pilotes ODBC effectuera toute conversion Unicode requise.</span><span class="sxs-lookup"><span data-stu-id="e4228-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="e4228-117">SQL_CA_SS_TYPE_CATALOG_NAME (lecture seule)</span><span class="sxs-lookup"><span data-stu-id="e4228-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="e4228-118">IPD</span><span class="sxs-lookup"><span data-stu-id="e4228-118">IPD</span></span>|<span data-ttu-id="e4228-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e4228-119">SQLTCHAR\*</span></span>|<span data-ttu-id="e4228-120">Catalogue où le type est défini.</span><span class="sxs-lookup"><span data-stu-id="e4228-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="e4228-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="e4228-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="e4228-122">IPD</span><span class="sxs-lookup"><span data-stu-id="e4228-122">IPD</span></span>|<span data-ttu-id="e4228-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="e4228-123">SQLTCHAR\*</span></span>|<span data-ttu-id="e4228-124">Schéma où le type est défini.</span><span class="sxs-lookup"><span data-stu-id="e4228-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="e4228-125">Les applications ne doivent pas définir SQL_CA_SS_TYPE_CATALOG_NAME pour les paramètres table.</span><span class="sxs-lookup"><span data-stu-id="e4228-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="e4228-126">Si tel est le cas, SQL_ERROR est retourné et un enregistrement de diagnostic est journalisé avec SQLSTATE = HY091 et le message « Identificateur de champ de descripteur non valide ».</span><span class="sxs-lookup"><span data-stu-id="e4228-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="e4228-127">Les attributs d'instruction et les champs d'en-tête de descripteur suivants s'appliquent aux paramètres table lorsque le focus de paramètre est défini sur un paramètre table :</span><span class="sxs-lookup"><span data-stu-id="e4228-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="e4228-128">Nom</span><span class="sxs-lookup"><span data-stu-id="e4228-128">Name</span></span>|<span data-ttu-id="e4228-129">Emplacement</span><span class="sxs-lookup"><span data-stu-id="e4228-129">Location</span></span>|<span data-ttu-id="e4228-130">Type</span><span class="sxs-lookup"><span data-stu-id="e4228-130">Type</span></span>|<span data-ttu-id="e4228-131">Description</span><span class="sxs-lookup"><span data-stu-id="e4228-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="e4228-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="e4228-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="e4228-133">(Équivaut à SQL_DESC_ARRAY_SIZE dans le descripteur APD.)</span><span class="sxs-lookup"><span data-stu-id="e4228-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="e4228-134">APD</span><span class="sxs-lookup"><span data-stu-id="e4228-134">APD</span></span>|<span data-ttu-id="e4228-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="e4228-135">SQLUINTEGER</span></span>|<span data-ttu-id="e4228-136">Taille du tableau de mémoires tampon pour un paramètre table.</span><span class="sxs-lookup"><span data-stu-id="e4228-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="e4228-137">Il s'agit du nombre maximal de lignes que les mémoires tampon peuvent prendre en charge ou de la taille des mémoires tampon dans les lignes ; la valeur du paramètre table peut elle-même avoir un nombre de lignes supérieur ou inférieur à la capacité des mémoires tampon.</span><span class="sxs-lookup"><span data-stu-id="e4228-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="e4228-138">1 constitue la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="e4228-138">Default is 1.</span></span> <span data-ttu-id="e4228-139">**Remarque :**  Si SQL_SOPT_SS_PARAM_FOCUS a la valeur par défaut 0, SQL_ATTR_PARAMSET_SIZE fait référence à l’instruction et spécifie le nombre de jeux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="e4228-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="e4228-140">Si SQL_SOPT_SS_PARAM_FOCUS est pour valeur l'ordinal d'un paramètre table, il fait référence au paramètre table et spécifie le nombre de lignes par jeu de paramètres pour le paramètre table.</span><span class="sxs-lookup"><span data-stu-id="e4228-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="e4228-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="e4228-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="e4228-142">APD</span><span class="sxs-lookup"><span data-stu-id="e4228-142">APD</span></span>|<span data-ttu-id="e4228-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="e4228-143">SQLINTEGER</span></span>|<span data-ttu-id="e4228-144">La valeur par défaut est SQL_PARAM_BIND_BY_COLUMN.</span><span class="sxs-lookup"><span data-stu-id="e4228-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="e4228-145">Pour sélectionner la liaison selon les lignes, ce champ a pour valeur la longueur de la structure ou une instance d'une mémoire tampon qui sera liée à un jeu de lignes de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="e4228-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="e4228-146">Cette durée doit inclure l'espace pour toutes les colonnes dépendantes et tout remplissage de la structure ou de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="e4228-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="e4228-147">Cela garantit que lorsque l'adresse d'une colonne dépendante est incrémentée de la longueur spécifiée, le résultat pointera vers le début de la même colonne dans la ligne suivante.</span><span class="sxs-lookup"><span data-stu-id="e4228-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="e4228-148">Lorsque vous utilisez l'opérateur `sizeof` dans ANSI C, ce comportement est garanti.</span><span class="sxs-lookup"><span data-stu-id="e4228-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="e4228-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="e4228-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="e4228-150">APD</span><span class="sxs-lookup"><span data-stu-id="e4228-150">APD</span></span>|<span data-ttu-id="e4228-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="e4228-151">SQLINTEGER\*</span></span>|<span data-ttu-id="e4228-152">La valeur par défaut est un pointeur null.</span><span class="sxs-lookup"><span data-stu-id="e4228-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="e4228-153">Si ce champ n'est pas NULL, le pilote déréférence le pointeur, ajoute la valeur déréférencée à chacun des champs différés dans l'enregistrement de descripteur (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR et SQL_DESC_OCTET_LENGTH_PTR) et utilise les nouvelles valeurs de pointeur pour accéder aux valeurs de données.</span><span class="sxs-lookup"><span data-stu-id="e4228-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="e4228-154">Ces champs sont uniquement valides avec des paramètres table et sont ignorés pour d'autres types de données.</span><span class="sxs-lookup"><span data-stu-id="e4228-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="e4228-155">SQL_CA_SS_TYPE_NAME est facultatif pour les appels de procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="e4228-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="e4228-156">Il doit être spécifié pour les instructions SQL qui ne sont pas des appels de procédure pour permettre au serveur de déterminer le type du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="e4228-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="e4228-157">Si le nom de type est reqired et que le type de table pour le paramètre table est défini dans un schéma différent de la procédure stockée, SQL_CA_SS_TYPE_SCHEMA_NAME doit être spécifié dans le descripteur de paramètre d'implémentation (IPD).</span><span class="sxs-lookup"><span data-stu-id="e4228-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="e4228-158">Sinon, le serveur ne pourra pas déterminer le type du paramètre table</span><span class="sxs-lookup"><span data-stu-id="e4228-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="e4228-159">Cela génère une erreur lorsque vous appelez SQLExecute ou SQLExecDirect.</span><span class="sxs-lookup"><span data-stu-id="e4228-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="e4228-160">L'erreur indiquera SQLSTATE = 07006 et le message « Violation de l'attribut de type de données restreint ».</span><span class="sxs-lookup"><span data-stu-id="e4228-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="e4228-161">Les colonnes de paramètre table peuvent utiliser la liaison selon les lignes ou selon les colonnes.</span><span class="sxs-lookup"><span data-stu-id="e4228-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="e4228-162">La valeur par défaut est la liaison selon les colonnes.</span><span class="sxs-lookup"><span data-stu-id="e4228-162">The default is column-wise binding.</span></span> <span data-ttu-id="e4228-163">La liaison selon les lignes peut être spécifiée en définissant SQL_ATTR_PARAM_BIND_TYPE et SQL_ATTR_PARAM_BIND_OFFSET_PTR.</span><span class="sxs-lookup"><span data-stu-id="e4228-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="e4228-164">Cela équivaut à la liaison selon les lignes de colonnes et de paramètres.</span><span class="sxs-lookup"><span data-stu-id="e4228-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="e4228-165">SQL_CA_SS_TYPE_CATALOG_NAME et SQL_CA_SS_TYPE_SCHEMA_NAME peuvent également être utilisés pour récupérer le catalogue et le schéma associés aux paramètres du type CLR défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e4228-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="e4228-166">Ils constituent des alternatives aux attributs existants de schéma de catalogue spécifiques au type pour ces types.</span><span class="sxs-lookup"><span data-stu-id="e4228-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e4228-167">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e4228-167">See Also</span></span>  
 [<span data-ttu-id="e4228-168">Paramètres table &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="e4228-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
