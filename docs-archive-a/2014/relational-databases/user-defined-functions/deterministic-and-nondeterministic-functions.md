---
title: Fonctions déterministes et non déterministes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- built-in functions [SQL Server]
- nondeterministic functions
- extended stored procedures [SQL Server], functions that call
- deterministic functions
- user-defined functions [SQL Server], deterministic
ms.assetid: 2f3ce5f5-c81c-4470-8141-8144d4f218dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 9e755532e06d64e273408c7e81936a1c2d370697
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708140"
---
# <a name="deterministic-and-nondeterministic-functions"></a><span data-ttu-id="3c7b5-102">Fonctions déterministes et non déterministes</span><span class="sxs-lookup"><span data-stu-id="3c7b5-102">Deterministic and Nondeterministic Functions</span></span>
  <span data-ttu-id="3c7b5-103">Les fonctions déterministes retournent toujours le même résultat quel que soit le moment auquel elles sont appelées avec un ensemble spécifique de valeurs d'entrée et sur la base du même état de la base de données.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-103">Deterministic functions always return the same result any time they are called with a specific set of input values and given the same state of the database.</span></span> <span data-ttu-id="3c7b5-104">Les fonctions non déterministes peuvent retourner différents résultats chaque fois qu'elles sont appelées avec un ensemble spécifique de valeurs d'entrée, même si l'état de la base de données à laquelle elles accèdent demeure inchangé.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-104">Nondeterministic functions may return different results each time they are called with a specific set of input values even if the database state that they access remains the same.</span></span> <span data-ttu-id="3c7b5-105">Par exemple, la fonction AVG retourne toujours le même résultat pour les conditions ci-dessus, mais la fonction GETDATE, qui retourne la valeur datetime actuelle, retourne toujours un résultat différent.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-105">For example, the function AVG always returns the same result given the qualifications stated above, but the GETDATE function, which returns the current datetime value, always returns a different result.</span></span>  
  
 <span data-ttu-id="3c7b5-106">Plusieurs propriétés de fonctions définies par l’utilisateur déterminent la possibilité pour le [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] d’indexer les résultats d’une fonction, par le biais d’index sur des colonnes calculées qui appellent la fonction, ou de vues indexées qui y font référence.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-106">There are several properties of user-defined functions that determine the ability of the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to index the results of the function, either through indexes on computed columns that call the function, or through indexed views that reference the function.</span></span> <span data-ttu-id="3c7b5-107">Le déterminisme d'une fonction est l'une de ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-107">The determinism of a function is one such property.</span></span> <span data-ttu-id="3c7b5-108">Par exemple, un index cluster ne peut pas être créé sur une vue si celle-ci fait référence à une fonction non déterministe.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-108">For example, a clustered index cannot be created on a view if the view references any nondeterministic functions.</span></span> <span data-ttu-id="3c7b5-109">Pour plus d’informations sur les propriétés des fonctions, dont le déterminisme, consultez [Fonctions définies par l’utilisateur](user-defined-functions.md).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-109">For more information about the properties of functions, including determinism, see [User-Defined Functions](user-defined-functions.md).</span></span>  
  
 <span data-ttu-id="3c7b5-110">Cette rubrique identifie le déterminisme des fonctions système intégrées, ainsi que l'effet sur la propriété déterministe des fonctions définies par l'utilisateur lorsqu'elle contient un appel à des procédures stockées étendues.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-110">This topic identifies the determinism of built-in system functions and the effect on the deterministic property of user-defined functions when it contains a call to extended stored procedures.</span></span>  
  
## <a name="built-in-function-determinism"></a><span data-ttu-id="3c7b5-111">Déterminisme des fonctions intégrées</span><span class="sxs-lookup"><span data-stu-id="3c7b5-111">Built-in Function Determinism</span></span>  
 <span data-ttu-id="3c7b5-112">Vous ne pouvez pas influer sur le déterminisme d'une fonction intégrée.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-112">You cannot influence the determinism of any built-in function.</span></span> <span data-ttu-id="3c7b5-113">Chaque fonction intégrée est déterministe ou non déterministe en fonction de son implémentation par [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3c7b5-113">Each built-in function is deterministic or nondeterministic based on how the function is implemented by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3c7b5-114">Par exemple, spécifier une clause ORDER BY dans une requête ne modifie pas le déterminisme d'une fonction utilisée dans cette requête.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-114">For example, specifying an ORDER BY clause in a query does not change the determinism of a function that used in that query.</span></span>  
  
 <span data-ttu-id="3c7b5-115">Toutes les fonctions de chaîne intégrées sont déterministes.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-115">All of the string built-in functions are deterministic.</span></span> <span data-ttu-id="3c7b5-116">Pour obtenir la liste de ces fonctions, consultez [Fonctions de chaîne &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-116">For a list of these functions, see [String Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/string-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="3c7b5-117">Les fonctions intégrées suivantes, qui ne sont pas des fonctions de chaîne, sont toujours déterministes :</span><span class="sxs-lookup"><span data-stu-id="3c7b5-117">The following built-in functions from categories of built-in functions other than string functions are always deterministic.</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="3c7b5-118">ABS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-118">ABS</span></span>|<span data-ttu-id="3c7b5-119">DATEDIFF</span><span class="sxs-lookup"><span data-stu-id="3c7b5-119">DATEDIFF</span></span>|<span data-ttu-id="3c7b5-120">POWER</span><span class="sxs-lookup"><span data-stu-id="3c7b5-120">POWER</span></span>|  
|<span data-ttu-id="3c7b5-121">ACOS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-121">ACOS</span></span>|<span data-ttu-id="3c7b5-122">DAY</span><span class="sxs-lookup"><span data-stu-id="3c7b5-122">DAY</span></span>|<span data-ttu-id="3c7b5-123">RADIANS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-123">RADIANS</span></span>|  
|<span data-ttu-id="3c7b5-124">ASIN</span><span class="sxs-lookup"><span data-stu-id="3c7b5-124">ASIN</span></span>|<span data-ttu-id="3c7b5-125">DEGREES</span><span class="sxs-lookup"><span data-stu-id="3c7b5-125">DEGREES</span></span>|<span data-ttu-id="3c7b5-126">ROUND</span><span class="sxs-lookup"><span data-stu-id="3c7b5-126">ROUND</span></span>|  
|<span data-ttu-id="3c7b5-127">ATAN</span><span class="sxs-lookup"><span data-stu-id="3c7b5-127">ATAN</span></span>|<span data-ttu-id="3c7b5-128">EXP</span><span class="sxs-lookup"><span data-stu-id="3c7b5-128">EXP</span></span>|<span data-ttu-id="3c7b5-129">SIGN</span><span class="sxs-lookup"><span data-stu-id="3c7b5-129">SIGN</span></span>|  
|<span data-ttu-id="3c7b5-130">ATN2</span><span class="sxs-lookup"><span data-stu-id="3c7b5-130">ATN2</span></span>|<span data-ttu-id="3c7b5-131">FLOOR</span><span class="sxs-lookup"><span data-stu-id="3c7b5-131">FLOOR</span></span>|<span data-ttu-id="3c7b5-132">SIN</span><span class="sxs-lookup"><span data-stu-id="3c7b5-132">SIN</span></span>|  
|<span data-ttu-id="3c7b5-133">CEILING</span><span class="sxs-lookup"><span data-stu-id="3c7b5-133">CEILING</span></span>|<span data-ttu-id="3c7b5-134">ISNULL</span><span class="sxs-lookup"><span data-stu-id="3c7b5-134">ISNULL</span></span>|<span data-ttu-id="3c7b5-135">SQUARE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-135">SQUARE</span></span>|  
|<span data-ttu-id="3c7b5-136">COALESCE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-136">COALESCE</span></span>|<span data-ttu-id="3c7b5-137">ISNUMERIC</span><span class="sxs-lookup"><span data-stu-id="3c7b5-137">ISNUMERIC</span></span>|<span data-ttu-id="3c7b5-138">SQRT</span><span class="sxs-lookup"><span data-stu-id="3c7b5-138">SQRT</span></span>|  
|<span data-ttu-id="3c7b5-139">COS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-139">COS</span></span>|<span data-ttu-id="3c7b5-140">LOG</span><span class="sxs-lookup"><span data-stu-id="3c7b5-140">LOG</span></span>|<span data-ttu-id="3c7b5-141">TAN</span><span class="sxs-lookup"><span data-stu-id="3c7b5-141">TAN</span></span>|  
|<span data-ttu-id="3c7b5-142">COT</span><span class="sxs-lookup"><span data-stu-id="3c7b5-142">COT</span></span>|<span data-ttu-id="3c7b5-143">LOG10</span><span class="sxs-lookup"><span data-stu-id="3c7b5-143">LOG10</span></span>|<span data-ttu-id="3c7b5-144">YEAR</span><span class="sxs-lookup"><span data-stu-id="3c7b5-144">YEAR</span></span>|  
|<span data-ttu-id="3c7b5-145">DATALENGTH</span><span class="sxs-lookup"><span data-stu-id="3c7b5-145">DATALENGTH</span></span>|<span data-ttu-id="3c7b5-146">MONTH</span><span class="sxs-lookup"><span data-stu-id="3c7b5-146">MONTH</span></span>||  
|<span data-ttu-id="3c7b5-147">DATEADD</span><span class="sxs-lookup"><span data-stu-id="3c7b5-147">DATEADD</span></span>|<span data-ttu-id="3c7b5-148">NULLIF</span><span class="sxs-lookup"><span data-stu-id="3c7b5-148">NULLIF</span></span>||  
  
 <span data-ttu-id="3c7b5-149">Les fonctions suivantes ne sont pas toujours déterministes mais peuvent être utilisées dans les vues indexées ou les index de colonnes calculées si elles sont spécifiées de manière déterministe :</span><span class="sxs-lookup"><span data-stu-id="3c7b5-149">The following functions are not always deterministic, but can be used in indexed views or indexes on computed columns when they are specified in a deterministic manner.</span></span>  
  
|<span data-ttu-id="3c7b5-150">Fonction</span><span class="sxs-lookup"><span data-stu-id="3c7b5-150">Function</span></span>|<span data-ttu-id="3c7b5-151">Commentaires</span><span class="sxs-lookup"><span data-stu-id="3c7b5-151">Comments</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="3c7b5-152">Toutes les fonctions d'agrégation</span><span class="sxs-lookup"><span data-stu-id="3c7b5-152">all aggregate functions</span></span>|<span data-ttu-id="3c7b5-153">Toutes les fonctions d'agrégation sont déterministes, sauf si elles sont spécifiées avec les clauses OVER et ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-153">All aggregate functions are deterministic unless they are specified with the OVER and ORDER BY clauses.</span></span> <span data-ttu-id="3c7b5-154">Pour obtenir la liste de ces fonctions, consultez [Fonctions d’agrégation &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-154">For a list of these functions, see [Aggregate Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/aggregate-functions-transact-sql).</span></span>|  
|<span data-ttu-id="3c7b5-155">CAST</span><span class="sxs-lookup"><span data-stu-id="3c7b5-155">CAST</span></span>|<span data-ttu-id="3c7b5-156">Déterministe sauf si elle est utilisée avec `datetime`, `smalldatetime` ou `sql_variant`.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-156">Deterministic unless used with `datetime`, `smalldatetime`, or `sql_variant`.</span></span>|  
|<span data-ttu-id="3c7b5-157">CONVERT</span><span class="sxs-lookup"><span data-stu-id="3c7b5-157">CONVERT</span></span>|<span data-ttu-id="3c7b5-158">Déterministe sauf dans l'un des cas suivants :</span><span class="sxs-lookup"><span data-stu-id="3c7b5-158">Deterministic unless one of these conditions exists:</span></span><br /><br /> <span data-ttu-id="3c7b5-159">Le type de source est `sql_variant`.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-159">Source type is `sql_variant`.</span></span><br /><br /> <span data-ttu-id="3c7b5-160">Le type de cible est `sql_variant` et son type de source est non déterministe.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-160">Target type is `sql_variant` and its source type is nondeterministic.</span></span><br /><br /> <span data-ttu-id="3c7b5-161">Le type de source ou de cible est `datetime` ou `smalldatetime`, l'autre type de cible ou de source est une chaîne de caractères et un style non déterministe est spécifié.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-161">Source or target type is `datetime` or `smalldatetime`, the other source or target type is a character string, and a nondeterministic style is specified.</span></span> <span data-ttu-id="3c7b5-162">Pour être déterministe, le paramètre de style doit être une constante.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-162">To be deterministic, the style parameter must be a constant.</span></span> <span data-ttu-id="3c7b5-163">De plus, les styles inférieurs ou égaux à 100 sont non-déterministes, à l'exception des styles 20 et 21.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-163">Additionally, styles less than or equal to 100 are nondeterministic, except for styles 20 and 21.</span></span> <span data-ttu-id="3c7b5-164">Les styles supérieurs à 100 sont déterministes, à l'exception des styles 106, 107, 109 et 113.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-164">Styles greater than 100 are deterministic, except for styles 106, 107, 109 and 113.</span></span>|  
|<span data-ttu-id="3c7b5-165">CHECKSUM</span><span class="sxs-lookup"><span data-stu-id="3c7b5-165">CHECKSUM</span></span>|<span data-ttu-id="3c7b5-166">Déterministe, sauf CHECKSUM(\*).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-166">Deterministic, with the exception of CHECKSUM(\*).</span></span>|  
|<span data-ttu-id="3c7b5-167">ISDATE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-167">ISDATE</span></span>|<span data-ttu-id="3c7b5-168">Déterministe uniquement si utilisé avec la fonction CONVERT, si le paramètre de style CONVERT est spécifié et si le style est différent de 0, 100, 9 ou 109.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-168">Deterministic only if used with the CONVERT function, the CONVERT style parameter is specified and style is not equal to 0, 100, 9, or 109.</span></span>|  
|<span data-ttu-id="3c7b5-169">RAND</span><span class="sxs-lookup"><span data-stu-id="3c7b5-169">RAND</span></span>|<span data-ttu-id="3c7b5-170">RAND est déterministe uniquement quand un paramètre *seed* est spécifié.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-170">RAND is deterministic only when a *seed* parameter is specified.</span></span>|  
  
 <span data-ttu-id="3c7b5-171">Toutes les fonctions relatives à la configuration, aux curseurs, aux métadonnées, à la sécurité et aux statistiques système sont non déterministes.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-171">All the configuration, cursor, metadata, security, and system statistical functions are nondeterministic.</span></span> <span data-ttu-id="3c7b5-172">Pour obtenir la liste de ces fonctions, consultez [Fonctions de configuration &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql), [Fonctions de curseur &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql), [Fonctions de métadonnées &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql), [Fonctions de sécurité &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql) et [Fonctions statistiques du système &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-172">For a list of these functions, see [Configuration Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/configuration-functions-transact-sql), [Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql), [Metadata Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/metadata-functions-transact-sql), [Security Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/security-functions-transact-sql), and [System Statistical Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/system-statistical-functions-transact-sql).</span></span>  
  
 <span data-ttu-id="3c7b5-173">Les fonctions intégrées suivantes, qui appartiennent à d'autres catégories, sont toujours non déterministes.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-173">The following built-in functions from other categories are always nondeterministic.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="3c7b5-174">@@CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-174">@@CONNECTIONS</span></span>|<span data-ttu-id="3c7b5-175">GETDATE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-175">GETDATE</span></span>|  
|<span data-ttu-id="3c7b5-176">@@CPU_BUSY</span><span class="sxs-lookup"><span data-stu-id="3c7b5-176">@@CPU_BUSY</span></span>|<span data-ttu-id="3c7b5-177">GETUTCDATE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-177">GETUTCDATE</span></span>|  
|<span data-ttu-id="3c7b5-178">@@DBTS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-178">@@DBTS</span></span>|<span data-ttu-id="3c7b5-179">GET_TRANSMISSION_STATUS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-179">GET_TRANSMISSION_STATUS</span></span>|  
|<span data-ttu-id="3c7b5-180">@@IDLE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-180">@@IDLE</span></span>|<span data-ttu-id="3c7b5-181">LAG</span><span class="sxs-lookup"><span data-stu-id="3c7b5-181">LAG</span></span>|  
|<span data-ttu-id="3c7b5-182">@@IO_BUSY</span><span class="sxs-lookup"><span data-stu-id="3c7b5-182">@@IO_BUSY</span></span>|<span data-ttu-id="3c7b5-183">LAST_VALUE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-183">LAST_VALUE</span></span>|  
|<span data-ttu-id="3c7b5-184">@@MAX_CONNECTIONS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-184">@@MAX_CONNECTIONS</span></span>|<span data-ttu-id="3c7b5-185">LEAD</span><span class="sxs-lookup"><span data-stu-id="3c7b5-185">LEAD</span></span>|  
|<span data-ttu-id="3c7b5-186">@@PACK_RECEIVED</span><span class="sxs-lookup"><span data-stu-id="3c7b5-186">@@PACK_RECEIVED</span></span>|<span data-ttu-id="3c7b5-187">MIN_ACTIVE_ROWVERSION</span><span class="sxs-lookup"><span data-stu-id="3c7b5-187">MIN_ACTIVE_ROWVERSION</span></span>|  
|<span data-ttu-id="3c7b5-188">@@PACK_SENT</span><span class="sxs-lookup"><span data-stu-id="3c7b5-188">@@PACK_SENT</span></span>|<span data-ttu-id="3c7b5-189">NEWID</span><span class="sxs-lookup"><span data-stu-id="3c7b5-189">NEWID</span></span>|  
|<span data-ttu-id="3c7b5-190">@@PACKET_ERRORS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-190">@@PACKET_ERRORS</span></span>|<span data-ttu-id="3c7b5-191">NEWSEQUENTIALID</span><span class="sxs-lookup"><span data-stu-id="3c7b5-191">NEWSEQUENTIALID</span></span>|  
|<span data-ttu-id="3c7b5-192">@@TIMETICKS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-192">@@TIMETICKS</span></span>|<span data-ttu-id="3c7b5-193">NEXT VALUE FOR</span><span class="sxs-lookup"><span data-stu-id="3c7b5-193">NEXT VALUE FOR</span></span>|  
|<span data-ttu-id="3c7b5-194">@@TOTAL_ERRORS</span><span class="sxs-lookup"><span data-stu-id="3c7b5-194">@@TOTAL_ERRORS</span></span>|<span data-ttu-id="3c7b5-195">NTILE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-195">NTILE</span></span>|  
|<span data-ttu-id="3c7b5-196">@@TOTAL_READ</span><span class="sxs-lookup"><span data-stu-id="3c7b5-196">@@TOTAL_READ</span></span>|<span data-ttu-id="3c7b5-197">PARSENAME</span><span class="sxs-lookup"><span data-stu-id="3c7b5-197">PARSENAME</span></span>|  
|<span data-ttu-id="3c7b5-198">@@TOTAL_WRITE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-198">@@TOTAL_WRITE</span></span>|<span data-ttu-id="3c7b5-199">PERCENTILE_CONT</span><span class="sxs-lookup"><span data-stu-id="3c7b5-199">PERCENTILE_CONT</span></span>|  
|<span data-ttu-id="3c7b5-200">CUME_DIST</span><span class="sxs-lookup"><span data-stu-id="3c7b5-200">CUME_DIST</span></span>|<span data-ttu-id="3c7b5-201">PERCENTILE_DISC</span><span class="sxs-lookup"><span data-stu-id="3c7b5-201">PERCENTILE_DISC</span></span>|  
|<span data-ttu-id="3c7b5-202">CURRENT_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="3c7b5-202">CURRENT_TIMESTAMP</span></span>|<span data-ttu-id="3c7b5-203">PERCENT_RANK</span><span class="sxs-lookup"><span data-stu-id="3c7b5-203">PERCENT_RANK</span></span>|  
|<span data-ttu-id="3c7b5-204">DENSE_RANK</span><span class="sxs-lookup"><span data-stu-id="3c7b5-204">DENSE_RANK</span></span>|<span data-ttu-id="3c7b5-205">RAND</span><span class="sxs-lookup"><span data-stu-id="3c7b5-205">RAND</span></span>|  
|<span data-ttu-id="3c7b5-206">FIRST_VALUE</span><span class="sxs-lookup"><span data-stu-id="3c7b5-206">FIRST_VALUE</span></span>|<span data-ttu-id="3c7b5-207">RANK</span><span class="sxs-lookup"><span data-stu-id="3c7b5-207">RANK</span></span>|  
||<span data-ttu-id="3c7b5-208">ROW_NUMBER</span><span class="sxs-lookup"><span data-stu-id="3c7b5-208">ROW_NUMBER</span></span>|  
||<span data-ttu-id="3c7b5-209">TEXTPTR</span><span class="sxs-lookup"><span data-stu-id="3c7b5-209">TEXTPTR</span></span>|  
  
## <a name="calling-extended-stored-procedures-from-functions"></a><span data-ttu-id="3c7b5-210">Appel de procédures stockées étendues à partir de fonctions</span><span class="sxs-lookup"><span data-stu-id="3c7b5-210">Calling Extended Stored Procedures from Functions</span></span>  
 <span data-ttu-id="3c7b5-211">Les fonctions qui appellent des procédures stockées étendues sont non déterministes car les procédures stockées étendues peuvent provoquer des effets secondaires sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-211">Functions that call extended stored procedures are nondeterministic, because the extended stored procedures can cause side effects on the database.</span></span> <span data-ttu-id="3c7b5-212">Ces effets secondaires sont des modifications de l'état global de la base de données, comme la mise à jour d'une table ou d'une ressource externe, telle qu'un fichier ou le réseau (par exemple la modification d'un fichier ou l'envoi d'un courrier électronique).</span><span class="sxs-lookup"><span data-stu-id="3c7b5-212">Side effects are changes to a global state of the database, such as an update to a table, or to an external resource, such as a file or the network; for example, modifying a file or sending an e-mail message.</span></span> <span data-ttu-id="3c7b5-213">Vous ne pouvez pas être assuré d'obtenir un jeu de résultats cohérent lors de l'exécution d'une procédure stockée étendue à partir d'une fonction définie par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-213">You should not rely on returning a consistent result set when executing an extended stored procedure from a user-defined function.</span></span> <span data-ttu-id="3c7b5-214">Les fonctions définies par l'utilisateur qui créent des effets secondaires sur la base de données ne sont pas recommandées.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-214">User-defined functions that create side effects on the database are not recommended.</span></span>  
  
 <span data-ttu-id="3c7b5-215">Une procédure stockée étendue appelée depuis l'intérieur d'une fonction ne peut pas retourner de jeux de résultats au client.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-215">When called from inside a function, the extended stored procedure cannot return result sets to the client.</span></span> <span data-ttu-id="3c7b5-216">Toute API Open Data Services qui retourne des jeux de résultats au client aura un code de retour FAIL.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-216">Any Open Data Services API that returns result sets to the client will have a return code of FAIL.</span></span>  
  
 <span data-ttu-id="3c7b5-217">La procédure stockée étendue ne peut pas se reconnecter à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3c7b5-217">The extended stored procedure can connect back to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3c7b5-218">Cependant, la procédure ne peut pas joindre la même transaction que la fonction originale ayant appelé la procédure stockée étendue.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-218">However, the procedure cannot join the same transaction as the original function that invoked the extended stored procedure.</span></span>  
  
 <span data-ttu-id="3c7b5-219">Comme pour les appels à partir d'une procédure stockée ou de traitement par lot, la procédure stockée étendue est exécutée dans le contexte du compte de sécurité [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows sous lequel fonctionne [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="3c7b5-219">Similar to invocations from a batch or stored procedure, the extended stored procedure is executed in the context of the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows security account under which [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is running.</span></span> <span data-ttu-id="3c7b5-220">Le propriétaire de la procédure stockée étendue doit prendre ce fait en considération lorsqu'il accorde à d'autres utilisateurs la permission d'exécuter la procédure.</span><span class="sxs-lookup"><span data-stu-id="3c7b5-220">The owner of the extended stored procedure should consider this when granting permissions to other users to execute the procedure.</span></span>  
  
  
