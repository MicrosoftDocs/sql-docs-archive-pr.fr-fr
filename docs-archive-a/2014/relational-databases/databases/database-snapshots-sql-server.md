---
title: Instantanés de base de données (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
helpviewer_keywords:
- static database views
- snapshots [SQL Server database snapshots]
- source databases [SQL Server]
- snapshots [SQL Server database snapshots], about database snapshots
- database snapshots [SQL Server]
- read-only database views
- database snapshots [SQL Server], about database snapshots
ms.assetid: 00179314-f23e-47cb-a35c-da6f180f86d3
author: stevestein
ms.author: sstein
ms.openlocfilehash: 8a0fa9b6cee2287d4e6060d4cb39f34d909e7db9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709575"
---
# <a name="database-snapshots-sql-server"></a><span data-ttu-id="4ad2e-102">Instantanés de base de données (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="4ad2e-102">Database Snapshots (SQL Server)</span></span>
  <span data-ttu-id="4ad2e-103">Une capture instantanée de base de données est une vue statique en lecture seule d’une base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (la *base de données source*).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-103">A database snapshot is a read-only, static view of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database (the *source database*).</span></span> <span data-ttu-id="4ad2e-104">Au moment de sa création, l'instantané de base de données est cohérent au niveau transactionnel avec la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-104">The database snapshot is transactionally consistent with the source database as of the moment of the snapshot's creation.</span></span> <span data-ttu-id="4ad2e-105">Un instantané de base de données réside toujours sur la même instance de serveur que sa base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-105">A database snapshot always resides on the same server instance as its source database.</span></span> <span data-ttu-id="4ad2e-106">Lorsque la base de données source est mise à jour, l'instantané de base de données est mis à jour.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-106">As the source database is updated, the database snapshot is updated.</span></span> <span data-ttu-id="4ad2e-107">Par conséquent, plus l'existence d'un instantané de base de données est longue, plus la probabilité qu'il épuise son espace disque disponible est élevée.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-107">Therefore, the longer a database snapshot exists, the more likely it is to use up its available disk space.</span></span>  
  
 <span data-ttu-id="4ad2e-108">Plusieurs instantanés peuvent exister sur une base de données source donnée.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-108">Multiple snapshots can exist on a given source database.</span></span> <span data-ttu-id="4ad2e-109">Chaque instantané de base de données existe jusqu'à ce qu'il soit explicitement supprimé par le propriétaire de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-109">Each database snapshot persists until it is explicitly dropped by the database owner.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4ad2e-110">Les instantanés de base de données n'ont aucun rapport avec les sauvegardes d'instantanés, les instantanés liés à l'isolation des transactions ou la réplication d'instantanés.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-110">Database snapshots are unrelated to snapshot backups, snapshot isolation of transactions, or snapshot replication.</span></span>  
  
 <span data-ttu-id="4ad2e-111">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="4ad2e-111">**In this Topic:**</span></span>  
  
-   [<span data-ttu-id="4ad2e-112">Vue d'ensemble des fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="4ad2e-112">Feature Overview</span></span>](#FeatureOverview)  
  
-   [<span data-ttu-id="4ad2e-113">Avantages des instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-113">Benefits of Database Snapshots</span></span>](#Benefits)  
  
-   [<span data-ttu-id="4ad2e-114">Termes et définitions</span><span class="sxs-lookup"><span data-stu-id="4ad2e-114">Terms and Definitions</span></span>](#TermsAndDefinitions)  
  
-   [<span data-ttu-id="4ad2e-115">Conditions préalables et limitations relatives aux instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-115">Prerequisites for and Limitations on Database Snapshots</span></span>](#LimitationsRequirements)  
  
-   [<span data-ttu-id="4ad2e-116">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="4ad2e-116">Related Tasks</span></span>](#RelatedTasks)  
  
##  <a name="feature-overview"></a><a name="FeatureOverview"></a> <span data-ttu-id="4ad2e-117">Vue d'ensemble des fonctionnalités</span><span class="sxs-lookup"><span data-stu-id="4ad2e-117">Feature Overview</span></span>  
 <span data-ttu-id="4ad2e-118">Les instantanés de base de données fonctionnent au niveau de la page de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-118">Database snapshots operate at the data-page level.</span></span> <span data-ttu-id="4ad2e-119">Toute page de la base de données source qui n'a pas encore été modifiée est copiée de la base de données source vers l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-119">Before a page of the source database is modified for the first time, the original page is copied from the source database to the snapshot.</span></span> <span data-ttu-id="4ad2e-120">L'instantané stocke la page d'origine, conservant ainsi les enregistrements de données tels qu'ils étaient lorsque l'instantané a été créé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-120">The snapshot stores the original page, preserving the data records as they existed when the snapshot was created.</span></span> <span data-ttu-id="4ad2e-121">Le même processus se répète chaque fois qu'une page est modifiée pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-121">The same process is repeated for every page that is being modified for the first time.</span></span> <span data-ttu-id="4ad2e-122">Pour l'utilisateur, un instantané de base de données semble ne jamais changer, car les opérations de lecture dans un instantané de base de données accèdent toujours aux pages de données d'origine, quel que soit leur emplacement.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-122">To the user, a database snapshot appears never to change, because read operations on a database snapshot always access the original data pages, regardless of where they reside.</span></span>  
  
 <span data-ttu-id="4ad2e-123">Pour stocker les pages d'origine copiées, l'instantané utilise un ou plusieurs *fichiers partiellement alloués*.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-123">To store the copied original pages, the snapshot uses one or more *sparse files*.</span></span> <span data-ttu-id="4ad2e-124">Initialement, un fichier partiellement alloué est un fichier essentiellement vide qui ne contient pas de données d'utilisateur et qui ne dispose pas encore d'espace disque alloué à cet effet.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-124">Initially, a sparse file is an essentially empty file that contains no user data and has not yet been allocated disk space for user data.</span></span> <span data-ttu-id="4ad2e-125">À mesure que le nombre de pages mises à jour augmente dans la base de données source, le fichier devient de plus en plus volumineux.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-125">As more and more pages are updated in the source database, the size of the file grows.</span></span> <span data-ttu-id="4ad2e-126">La figure suivante illustre les effets de deux schémas de mise à jour distincts sur la taille d'un instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-126">The following figure illustrates the effects of two contrasting update patterns on the size of a snapshot.</span></span> <span data-ttu-id="4ad2e-127">Le schéma de mise à jour A représente un environnement dans lequel seules 30% des pages d'origine sont mises à jour pendant la durée d'existence de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-127">Update pattern A reflects an environment in which only 30 percent of the original pages are updated during the life of the snapshot.</span></span> <span data-ttu-id="4ad2e-128">Le schéma de mise à jour B correspond à un environnement dans lequel 80 % des pages d'origine sont mises à jour pendant la durée d'existence de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-128">Update pattern B reflects an environment in which 80 percent of the original pages are updated during the life of the snapshot.</span></span>  
  
 <span data-ttu-id="4ad2e-129">![Autres modèles de mise à jour et taille d’instantané](../../database-engine/media/dbview-04.gif "Autres modèles de mise à jour et taille d’instantané")</span><span class="sxs-lookup"><span data-stu-id="4ad2e-129">![Alternative update patterns and snapshot size](../../database-engine/media/dbview-04.gif "Alternative update patterns and snapshot size")</span></span>  
  
##  <a name="benefits-of-database-snapshots"></a><a name="Benefits"></a> <span data-ttu-id="4ad2e-130">Avantages des instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-130">Benefits of Database Snapshots</span></span>  
  
-   <span data-ttu-id="4ad2e-131">Les instantanés peuvent être utilisés à des fins de création de rapports.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-131">Snapshots can be used for reporting purposes.</span></span>  
  
     <span data-ttu-id="4ad2e-132">Les clients peuvent interroger un instantané de base de données, ce qui le rend utile pour l'écriture de rapports basés sur la date et l'heure de sa création.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-132">Clients can query a database snapshot, which makes it useful for writing reports based on the data at the time of snapshot creation.</span></span>  
  
-   <span data-ttu-id="4ad2e-133">Gestion des données d'historique pour la création de rapports.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-133">Maintaining historical data for report generation.</span></span>  
  
     <span data-ttu-id="4ad2e-134">Un instantané peut étendre l'accès utilisateur aux données à partir d'un moment donné dans le temps.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-134">A snapshot can extend user access to data from a particular point in time.</span></span> <span data-ttu-id="4ad2e-135">Par exemple, vous pouvez créer un instantané au terme d'une période donnée (par ex. un trimestre financier) pour créer un rapport ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-135">For example, you can create a database snapshot at the end of a given time period (such as a financial quarter) for later reporting.</span></span> <span data-ttu-id="4ad2e-136">Vous pouvez ensuite exécuter des rapports de fin de période sur l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-136">You can then run end-of-period reports on the snapshot.</span></span> <span data-ttu-id="4ad2e-137">Si l'espace disque le permet, vous pouvez également conserver des instantanés de fin de période indéfiniment afin d'interroger les résultats pour cette période, par exemple pour étudier les performances de l'organisation.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-137">If disk space permits, you can also maintain end-of-period snapshots indefinitely, allowing queries against the results from these periods; for example, to investigate organizational performance.</span></span>  
  
-   <span data-ttu-id="4ad2e-138">Utilisation d'une base de données miroir maintenue à des fins de disponibilité pour décharger la création de rapports.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-138">Using a mirror database that you are maintaining for availability purposes to offload reporting.</span></span>  
  
     <span data-ttu-id="4ad2e-139">L'utilisation d'instantanés de bases de données avec mise en miroir vous permet de rendre les données du serveur miroir accessibles à des fins de création de rapports.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-139">Using database snapshots with database mirroring permits you to make the data on the mirror server accessible for reporting.</span></span> <span data-ttu-id="4ad2e-140">De plus, l'exécution de requêtes sur la base de données miroir peut libérer des ressources sur la base de données primaire.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-140">Additionally, running queries on the mirror database can free up resources on the principal.</span></span> <span data-ttu-id="4ad2e-141">Pour plus d’informations, consultez [Mise en miroir et instantanés de bases de données &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-141">For more information, see [Database Mirroring and Database Snapshots &#40;SQL Server&#41;](database-snapshots-sql-server.md).</span></span>  
  
-   <span data-ttu-id="4ad2e-142">Protection des données contre les erreurs d'administration.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-142">Safeguarding data against administrative error.</span></span>  
  
-   <span data-ttu-id="4ad2e-143">Si une erreur utilisateur se produit dans une base de données source, vous pouvez rétablir la base de données source dans l'état qui était le sien au moment où un instantané de base de données spécifié a été créé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-143">In the event of a user error on a source database, you can revert the source database to the state it was in when a given database snapshot was created.</span></span> <span data-ttu-id="4ad2e-144">La perte de données est limitée aux mises à jour de la base de données depuis la création de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-144">Data loss is confined to updates to the database since the snapshot's creation.</span></span>  
  
     <span data-ttu-id="4ad2e-145">Par exemple, avant d'effectuer des mises à jour importantes, comme une mise à jour en bloc ou une modification de schéma, créez un instantané de votre base de données afin d'en protéger les données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-145">For example, before doing major updates, such as a bulk update or a schema change, create a database snapshot on the database protects data.</span></span> <span data-ttu-id="4ad2e-146">Si vous commettez une erreur, vous pourrez utiliser l'instantané pour restaurer la base de données telle qu'elle était au moment de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-146">If you make a mistake, you can use the snapshot to recover by reverting the database to the snapshot.</span></span> <span data-ttu-id="4ad2e-147">Ce retour à un état précédent de la base de données est potentiellement plus rapide que la restauration à partir d'une sauvegarde. En revanche, la restauration par progression ne sera plus possible par la suite.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-147">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="4ad2e-148">La restauration ne fonctionne pas sur une base de données hors connexion ou endommagée.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-148">Reverting does not work in an offline or corrupted database.</span></span> <span data-ttu-id="4ad2e-149">Par conséquent, la réalisation de sauvegardes régulières et le test de votre plan de restauration sont essentiels pour la protection d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-149">Therefore, taking regular backups and testing your restore plan are necessary to protect a database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4ad2e-150">Les instantanés de base de données dépendent de la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-150">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="4ad2e-151">Par conséquent, l'utilisation d'instantanés pour rétablir l'état précédent d'une base de données ne remplace pas votre stratégie de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-151">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="4ad2e-152">L'exécution de toutes les sauvegardes planifiées reste primordiale.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-152">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="4ad2e-153">Si vous devez restaurer la base de données source au point dans le temps où vous avez créé un instantané de base de données, implémentez une stratégie de sauvegarde qui vous permette une telle opération.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-153">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="4ad2e-154">Protection des données contre les erreurs des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-154">Safeguarding data against user error.</span></span>  
  
     <span data-ttu-id="4ad2e-155">En créant régulièrement des instantanés, vous pouvez réparer les dégâts liés à certaines erreurs commises par les utilisateurs, comme la suppression d'une table.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-155">By creating database snapshots on a regular basis, you can mitigate the impact of a major user error, such as a dropped table.</span></span> <span data-ttu-id="4ad2e-156">Pour encore plus de protection, vous pouvez créer une série d'instantanés couvrant une période suffisamment importante pour identifier et réagir à la plupart des erreurs commises par les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-156">For a high level of protection, you can create a series of database snapshots spanning enough time to recognize and respond to most user errors.</span></span> <span data-ttu-id="4ad2e-157">Par exemple, vous pourriez maintenir un roulement de 6 à 12 instantanés couvrant une période de 24 heures en fonction de l'espace disponible sur vos disques.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-157">For instance, you might maintain 6 to 12 rolling snapshots spanning a 24-hour interval, depending on your disk resources.</span></span> <span data-ttu-id="4ad2e-158">Chaque fois qu'un instantané est créé, l'instantané le plus ancien est supprimé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-158">Then, each time a new snapshot is created, the earliest snapshot can be deleted.</span></span>  
  
    -   <span data-ttu-id="4ad2e-159">Pour récupérer après une erreur, vous pouvez rétablir la base de données telle qu'elle était juste avant l'erreur.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-159">To recover from a user error, you can revert the database to the snapshot immediately before the error.</span></span> <span data-ttu-id="4ad2e-160">Ce retour à un état précédent de la base de données est potentiellement plus rapide que la restauration à partir d'une sauvegarde. En revanche, la restauration par progression ne sera plus possible par la suite.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-160">Reverting is potentially much faster for this purpose than restoring from a backup; however, you cannot roll forward afterward.</span></span>  
  
    -   <span data-ttu-id="4ad2e-161">Vous pourrez également reconstruire manuellement une table supprimée ou récupérer toute autre donnée perdue à partir des informations contenues dans un instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-161">Alternatively, you may be able to manually reconstruct a dropped table or other lost data from the information in a snapshot.</span></span> <span data-ttu-id="4ad2e-162">Par exemple, vous pouvez copier en bloc les données de l'instantané et les fusionner manuellement avec les données de la base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-162">For instance, you could bulk copy the data out of the snapshot into the database and manually merge the data back into the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4ad2e-163">Le nombre d'instantanés maintenus à un moment donné, la fréquence de création des instantanés et la durée de conservation des instantanés dépendent de votre objectif final.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-163">Your reasons for using database snapshots determine how many concurrent snapshots you need on a database, how frequently to create a new snapshot, and how long to keep it.</span></span>  
  
-   <span data-ttu-id="4ad2e-164">Gestion d'une base de données test</span><span class="sxs-lookup"><span data-stu-id="4ad2e-164">Managing a test database</span></span>  
  
     <span data-ttu-id="4ad2e-165">Dans un environnement de test, il peut être utile en cas d'exécution répétée d'un protocole de test que la base de données contienne des données identiques au démarrage de chaque nouveau test.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-165">In a testing environment, it can be useful when repeatedly running a test protocol for the database to contain identical data at the start of each round of testing.</span></span> <span data-ttu-id="4ad2e-166">Avant l'exécution du premier test, un testeur ou un développeur d'applications peut créer un instantané de base de données sur la base de données test.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-166">Before running the first round, an application developer or tester can create a database snapshot on the test database.</span></span> <span data-ttu-id="4ad2e-167">À l'issue de chaque test, il est possible de revenir rapidement à l'état antérieur de la base de données en rétablissant l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-167">After each test run, the database can be quickly returned to its prior state by reverting the database snapshot.</span></span>  
  
##  <a name="terms-and-definitions"></a><a name="TermsAndDefinitions"></a> <span data-ttu-id="4ad2e-168">Termes et définitions</span><span class="sxs-lookup"><span data-stu-id="4ad2e-168">Terms and Definitions</span></span>  
 <span data-ttu-id="4ad2e-169">database snapshot</span><span class="sxs-lookup"><span data-stu-id="4ad2e-169">database snapshot</span></span>  
 <span data-ttu-id="4ad2e-170">Vue statique, en lecture seule et cohérente sur le plan transactionnel d'une base de données (la base de données source).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-170">A transactionally consistent, read-only, static view of a database (the source database).</span></span>  
  
 <span data-ttu-id="4ad2e-171">base de données source</span><span class="sxs-lookup"><span data-stu-id="4ad2e-171">source database</span></span>  
 <span data-ttu-id="4ad2e-172">Pour un instantané de base de données, la base de données sur laquelle l'instantané a été créé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-172">For a database snapshot, the database on which the snapshot was created.</span></span> <span data-ttu-id="4ad2e-173">Les instantanés de base de données dépendent de la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-173">Database snapshots are dependent on the source database.</span></span> <span data-ttu-id="4ad2e-174">Les instantanés d'une base de données doivent résider sur la même instance de serveur que la base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-174">The snapshots of a database must be on the same server instance as the database.</span></span> <span data-ttu-id="4ad2e-175">De plus, si une base de données n'est plus disponible pour une raison quelconque, tous ses instantanés de base de données cessent d'être disponibles.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-175">Furthermore, if that database becomes unavailable for any reason, all of its database snapshots also become unavailable.</span></span>  
  
 <span data-ttu-id="4ad2e-176">fichier partiellement alloué</span><span class="sxs-lookup"><span data-stu-id="4ad2e-176">sparse file</span></span>  
 <span data-ttu-id="4ad2e-177">Fichier fourni par le système de fichiers NTFS requérant beaucoup moins d'espace disque qu'il n'en serait requis autrement.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-177">A file provided by the NTFS file system that requires much less disk space than would otherwise be needed.</span></span> <span data-ttu-id="4ad2e-178">Un fichier partiellement alloué est utilisé pour stocker les pages copiées dans un instantané de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-178">A sparse file is used to store pages copied to a database snapshot.</span></span> <span data-ttu-id="4ad2e-179">À sa création, un fichier partiellement alloué occupe très peu d'espace disque.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-179">When first created, a sparse file takes up little disk space.</span></span> <span data-ttu-id="4ad2e-180">Lorsque des données sont écrites dans un instantané de base de données, NTFS alloue de l'espace disque progressivement au fichier partiellement alloué correspondant.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-180">As data is written to a database snapshot, NTFS allocates disk space gradually to the corresponding sparse file.</span></span>  
  
##  <a name="prerequisites-for-and-limitations-on-database-snapshots"></a><a name="LimitationsRequirements"></a> <span data-ttu-id="4ad2e-181">Conditions préalables et limitations relatives aux instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-181">Prerequisites for and Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="4ad2e-182">**Dans cette section :**</span><span class="sxs-lookup"><span data-stu-id="4ad2e-182">**In This Section:**</span></span>  
  
-   [<span data-ttu-id="4ad2e-183">Composants requis</span><span class="sxs-lookup"><span data-stu-id="4ad2e-183">Prerequisites</span></span>](#Prerequisites)  
  
-   [<span data-ttu-id="4ad2e-184">Limitations relatives à la base de données source</span><span class="sxs-lookup"><span data-stu-id="4ad2e-184">Limitations on the Source Database</span></span>](#LimitsOnSourceDb)  
  
-   [<span data-ttu-id="4ad2e-185">Limitations relatives aux instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-185">Limitations on Database Snapshots</span></span>](#LimitsOnDbSS)  
  
-   [<span data-ttu-id="4ad2e-186">Espace disque nécessaire</span><span class="sxs-lookup"><span data-stu-id="4ad2e-186">Disk Space Requirements</span></span>](#DiskSpace)  
  
-   [<span data-ttu-id="4ad2e-187">Instantanés de base de données avec des groupes de fichiers hors ligne</span><span class="sxs-lookup"><span data-stu-id="4ad2e-187">Database Snapshots with Offline Filegroups</span></span>](#OfflineFGs)  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="4ad2e-188">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="4ad2e-188">Prerequisites</span></span>  
 <span data-ttu-id="4ad2e-189">La base de données source, qui peut utiliser n'importe quel mode de récupération, doit respecter les conditions préalables suivantes :</span><span class="sxs-lookup"><span data-stu-id="4ad2e-189">The source database, which can use any recovery model, must meet the following prerequisites:</span></span>  
  
-   <span data-ttu-id="4ad2e-190">L'instance de serveur doit s'exécuter sur une édition de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui prend en charge les instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-190">The server instance must be running on an edition of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that supports database snapshots.</span></span> <span data-ttu-id="4ad2e-191">Pour plus d’informations, consultez [fonctionnalités prises en charge par les éditions de SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-191">For more information, see [Features Supported by the Editions of SQL Server 2014](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md).</span></span>  
  
-   <span data-ttu-id="4ad2e-192">La base de données source doit être en ligne, à moins que la base de données soit une base de données miroir au sein d'une session de mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-192">The source database must be online, unless the database is a mirror database within a database mirroring session.</span></span>  
  
-   <span data-ttu-id="4ad2e-193">Vous pouvez créer un instantané de base de données sur toute base de données primaire ou secondaire dans un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-193">You can create a database snapshot on any primary or secondary database in an availability group.</span></span> <span data-ttu-id="4ad2e-194">Le rôle de réplica doit être PRIMARY ou SECONDARY, et non dans l'état RESOLVING.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-194">The replica role must be either PRIMARY or SECONDARY, not in the RESOLVING state.</span></span>  
  
     <span data-ttu-id="4ad2e-195">Nous vous recommandons que l'état de synchronisation de base de données soit SYNCHRONIZING ou SYNCHRONIZED lorsque vous créez un instantané de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-195">We recommend that the database synchronization state be SYNCHRONIZING or SYNCHRONIZED when you create a database snapshot.</span></span> <span data-ttu-id="4ad2e-196">Toutefois, les instantanés de base de données peuvent être créés lorsque l'état de synchronisation de base de données est NOT SYNCHRONIZING.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-196">However, database snapshots can be created when the database synchronization state is NOT SYNCHRONIZING.</span></span>  
  
     <span data-ttu-id="4ad2e-197">Pour plus d’informations, consultez [Instantanés de base de données avec des groupes de disponibilité Always On &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-197">For more information, see [Database Snapshots with AlwaysOn Availability Groups &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/database-snapshots-with-always-on-availability-groups-sql-server.md).</span></span>  
  
-   <span data-ttu-id="4ad2e-198">Pour créer un instantané de base de données dans une base de données miroir, la base de données doit être dans un état de mise en miroir SYNCHRONIZED.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-198">To create a database snapshot on a mirror database, the database must be in the SYNCHRONIZED mirroring state.</span></span>  
  
-   <span data-ttu-id="4ad2e-199">La base de données source ne peut pas être configurée en tant que base de données partagée évolutive.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-199">The source database cannot be configured as a scalable shared database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4ad2e-200">Tous les modes de récupération prennent en charge les instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-200">All recovery models support database snapshots.</span></span>  
  
###  <a name="limitations-on-the-source-database"></a><a name="LimitsOnSourceDb"></a> <span data-ttu-id="4ad2e-201">Limitations relatives à la base de données source</span><span class="sxs-lookup"><span data-stu-id="4ad2e-201">Limitations on the Source Database</span></span>  
 <span data-ttu-id="4ad2e-202">Dans la mesure où il existe un instantané de base de données, les limitations suivantes s'appliquent à la base de données source de l'instantané :</span><span class="sxs-lookup"><span data-stu-id="4ad2e-202">As long as a database snapshot exists, the following limitations exist on the snapshot's source database:</span></span>  
  
-   <span data-ttu-id="4ad2e-203">La base de données ne peut pas être supprimée, détachée ou restaurée.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-203">The database cannot be dropped, detached, or restored.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4ad2e-204">La sauvegarde de la base de données source fonctionne normalement ; elle n'est pas affectée par les instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-204">Backing up the source database works normally; it is unaffected by database snapshots.</span></span>  
  
-   <span data-ttu-id="4ad2e-205">Les performances sont réduites, en raison du nombre accru d'entrées/sorties sur la base de données source suite à une opération de copie lors d'une écriture sur l'instantané chaque fois qu'une page est mise à jour.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-205">Performance is reduced, due to increased I/O on the source database resulting from a copy-on-write operation to the snapshot every time a page is updated.</span></span>  
  
-   <span data-ttu-id="4ad2e-206">Les fichiers ne peuvent pas être supprimés de la base de données source ni des instantanés.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-206">Files cannot be dropped from the source database or from any snapshots.</span></span>  
  
###  <a name="limitations-on-database-snapshots"></a><a name="LimitsOnDbSS"></a> <span data-ttu-id="4ad2e-207">Limitations relatives aux instantanés de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-207">Limitations on Database Snapshots</span></span>  
 <span data-ttu-id="4ad2e-208">Les limitations suivantes s'appliquent aux instantanés de base de données :</span><span class="sxs-lookup"><span data-stu-id="4ad2e-208">The following limitations apply to database snapshots:</span></span>  
  
-   <span data-ttu-id="4ad2e-209">Un instantané de base de données doit être créé et demeurer sur la même instance de serveur que la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-209">A database snapshot must be created and remain on the same server instance as the source database.</span></span>  
  
-   <span data-ttu-id="4ad2e-210">Les instantanés de base de données fonctionnent toujours sur une base de données complète.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-210">Database snapshots always work on an entire database.</span></span>  
  
-   <span data-ttu-id="4ad2e-211">Les instantanés de base de données dépendent de la base de données source et ne correspondent pas à un stockage redondant.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-211">Database snapshots are dependent on the source database and are not redundant storage.</span></span> <span data-ttu-id="4ad2e-212">Ils ne vous protègent pas face à des erreurs disque ou d'autres types d'endommagement.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-212">They do not protect against disk errors or other types of corruption.</span></span> <span data-ttu-id="4ad2e-213">Par conséquent, l'utilisation d'instantanés pour rétablir l'état précédent d'une base de données ne remplace pas votre stratégie de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-213">Therefore, using database snapshots for reverting a database is not a substitute for your backup and restore strategy.</span></span> <span data-ttu-id="4ad2e-214">L'exécution de toutes les sauvegardes planifiées reste primordiale.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-214">Performing all your scheduled backups remains essential.</span></span> <span data-ttu-id="4ad2e-215">Si vous devez restaurer la base de données source au point dans le temps où vous avez créé un instantané de base de données, implémentez une stratégie de sauvegarde qui vous permette une telle opération.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-215">If you must restore the source database to the point in time at which you created a database snapshot, implement a backup policy that enables you to do that.</span></span>  
  
-   <span data-ttu-id="4ad2e-216">Lorsqu'une page mise à jour sur la base de données source est envoyée vers un instantané, si l'instantané manque d'espace disque ou rencontre une autre erreur, il devient suspect et doit être supprimé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-216">When a page getting updated on the source database is pushed to a snapshot, if the snapshot runs out of disk space or encounters some other error, the snapshot becomes suspect and must be deleted.</span></span>  
  
-   <span data-ttu-id="4ad2e-217">Les instantanés sont en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-217">Snapshots are read-only.</span></span> <span data-ttu-id="4ad2e-218">Comme ils sont en lecture seule, ils ne peuvent pas être mis à niveau.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-218">Since they are read only, they cannot be upgraded.</span></span> <span data-ttu-id="4ad2e-219">C'est pourquoi, les instantanés de base de données ne sont pas viables après une mise à niveau.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-219">Therefore, database snapshots are not expected to be viable after an upgrade.</span></span>  
  
-   <span data-ttu-id="4ad2e-220">Les instantanés des bases de données **model**, **master**et **tempdb** sont interdits.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-220">Snapshots of the **model**, **master**, and **tempdb** databases are prohibited.</span></span>  
  
-   <span data-ttu-id="4ad2e-221">Vous ne pouvez pas modifier les spécifications des fichiers d'instantané de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-221">You cannot change any of the specifications of the database snapshot files.</span></span>  
  
-   <span data-ttu-id="4ad2e-222">Vous ne pouvez pas supprimer des fichiers d'un instantané de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-222">You cannot drop files from a database snapshot.</span></span>  
  
-   <span data-ttu-id="4ad2e-223">Vous ne pouvez pas sauvegarder ni restaurer des instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-223">You cannot back up or restore database snapshots.</span></span>  
  
-   <span data-ttu-id="4ad2e-224">Vous ne pouvez pas attacher ni détacher des instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-224">You cannot attach or detach database snapshots.</span></span>  
  
-   <span data-ttu-id="4ad2e-225">Vous ne pouvez pas créer d'instantanés de base de données sur le système de fichiers FAT32 ou sur des partitions RAW.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-225">You cannot create database snapshots on FAT32 file system or RAW partitions.</span></span> <span data-ttu-id="4ad2e-226">Les fichiers partiellement alloués utilisés par les instantanés de base de données sont fournis par le système de fichiers NTFS.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-226">The sparse files used by database snapshots are provided by the NTFS file system.</span></span>  
  
-   <span data-ttu-id="4ad2e-227">L'indexation de texte intégral n'est pas prise en charge sur les instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-227">Full-text indexing is not supported on database snapshots.</span></span> <span data-ttu-id="4ad2e-228">Les catalogues de texte intégral ne sont pas propagés à partir de la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-228">Full-text catalogs are not propagated from the source database.</span></span>  
  
-   <span data-ttu-id="4ad2e-229">Un instantané hérite des contraintes de sécurité de sa base de données source au moment de la création de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-229">A database snapshot inherits the security constraints of its source database at the time of snapshot creation.</span></span> <span data-ttu-id="4ad2e-230">Compte tenu que les instantanés sont en lecture seule, les autorisations héritées ne peuvent pas être modifiées, et les modifications d'autorisations apportées à la source ne seront pas répercutées dans les instantanés existants.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-230">Because snapshots are read-only, inherited permissions cannot be changed and permission changes made to the source will not be reflected in existing snapshots.</span></span>  
  
-   <span data-ttu-id="4ad2e-231">Un instantané reflète toujours l'état de groupes de fichiers au moment de la création de l'instantané : les groupes de fichiers en ligne demeurent en ligne et les groupes de fichiers hors connexion demeurent hors connexion.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-231">A snapshot always reflects the state of filegroups at the time of snapshot creation: online filegroups remain online, and offline filegroups remain offline.</span></span> <span data-ttu-id="4ad2e-232">Pour plus d'informations, consultez « Instantanés de base de données avec des groupes de fichiers hors ligne », plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-232">For more information, see "Database Snapshots with Offline Filegroups" later in this topic.</span></span>  
  
-   <span data-ttu-id="4ad2e-233">Si une base de données source se voit affecter l'état RECOVERY_PENDING, ses instantanés peuvent devenir inaccessibles.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-233">If a source database becomes RECOVERY_PENDING, its database snapshots may become inaccessible.</span></span> <span data-ttu-id="4ad2e-234">Toutefois, lorsque le problème affectant la base de données source a été résolu, ses instantanés sont à nouveau accessibles.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-234">After the issue on the source database is resolved, however, its snapshots should become available again.</span></span>  
  
-   <span data-ttu-id="4ad2e-235">La restauration n'est pas prise en charge pour les groupes de fichiers en lecture seule ni pour les groupes de fichiers compressés.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-235">Reverting is unsupported for read-only filegroups and for compressed filegroups.</span></span> <span data-ttu-id="4ad2e-236">Les tentatives de restauration d'une base de données contenant l'un de ces types de groupe de fichiers échouent.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-236">Attempts to revert a database containing either of these types of filegroups fail.</span></span>  
  
-   <span data-ttu-id="4ad2e-237">Dans une configuration de copie des journaux de transactions, des instantanés de base de données peuvent être créés seulement sur la base de données primaire et non sur une base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-237">In a log shipping configuration, database snapshots can be created only on the primary database, not on a secondary database.</span></span> <span data-ttu-id="4ad2e-238">Si vous basculez les rôles entre l'instance du serveur primaire et une instance de serveur secondaire, vous devez supprimer tous les instantanés de base de données pour pouvoir configurer la base de données primaire en tant que base de données secondaire.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-238">If you switch roles between the primary server instance and a secondary server instance, you must drop all the database snapshots before you can set the primary database up as a secondary database.</span></span>  
  
-   <span data-ttu-id="4ad2e-239">Un instantané de base de données ne peut pas être configuré en tant que base de données partagée évolutive.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-239">A database snapshot cannot be configured as a scalable shared database.</span></span>  
  
-   <span data-ttu-id="4ad2e-240">Les groupes de fichiers FILESTREAM ne sont pas pris en charge par les instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-240">FILESTREAM filegroups are not supported by database snapshots.</span></span> <span data-ttu-id="4ad2e-241">S'il existe des groupes de fichiers FILESTREAM dans une base de données source, ils sont marqués comme hors connexion dans ses instantanés de base de données et les instantanés de base de données ne peuvent pas être utilisés pour restaurer la base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-241">If FILESTREAM filegroups exist in a source database, they are marked as offline in its database snapshots, and the database snapshots cannot be used for reverting the database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="4ad2e-242">Une instruction SELECT exécutée sur un instantané de base de données ne doit pas spécifier de colonne FILESTREAM ; autrement, le message d'erreur suivant est retourné : `Could not continue scan with NOLOCK due to data movement.`</span><span class="sxs-lookup"><span data-stu-id="4ad2e-242">A SELECT statement that is executed on a database snapshot must not specify a FILESTREAM column; otherwise, the following error message will be returned: `Could not continue scan with NOLOCK due to data movement.`</span></span>  
  
-   <span data-ttu-id="4ad2e-243">Quand les statistiques sur une capture instantanée en lecture seule sont absentes ou obsolètes, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] crée et gère les statistiques temporaires dans tempdb.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-243">When statistics on a read-only snapshot are missing or stale, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] creates and maintains temporary statistics in tempdb.</span></span> <span data-ttu-id="4ad2e-244">Pour plus d’informations, consultez [Statistiques](../statistics/statistics.md).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-244">For more information, see [Statistics](../statistics/statistics.md).</span></span>  
  
###  <a name="disk-space-requirements"></a><a name="DiskSpace"></a> <span data-ttu-id="4ad2e-245">Espace disque nécessaire</span><span class="sxs-lookup"><span data-stu-id="4ad2e-245">Disk Space Requirements</span></span>  
 <span data-ttu-id="4ad2e-246">Les instantanés de base de données consomment une grande quantité d'espace disque.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-246">Database snapshots consume disk space.</span></span> <span data-ttu-id="4ad2e-247">Si un instantané de base de données ne dispose plus de suffisamment d'espace disque, il est signalé comme suspect et doit être supprimé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-247">If a database snapshot runs out of disk space, it is marked as suspect and must be dropped.</span></span> <span data-ttu-id="4ad2e-248">(Toutefois, la base de données source n'est pas affectée ; les opérations sur cette base de données se poursuivent normalement.) Par rapport à une copie complète d'une base de données, les instantanés utilisent beaucoup moins d'espace disque.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-248">(The source database, however, is not affected; actions on it continue normally.) Compared to a full copy of a database, however, snapshots are highly space efficient.</span></span> <span data-ttu-id="4ad2e-249">Un instantané nécessite uniquement un espace de stockage adapté aux pages qui changent au cours de sa durée de vie.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-249">A snapshot requires only enough storage for the pages that change during its lifetime.</span></span> <span data-ttu-id="4ad2e-250">En général, les instantanés sont conservés pour une courte durée ; par conséquent, leur taille n'est pas une préoccupation importante.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-250">Generally, snapshots are kept for a limited time, so their size is not a major concern.</span></span>  
  
 <span data-ttu-id="4ad2e-251">Plus la durée de conservation d'un instantané est longue, plus l'instantané épuisera la quantité d'espace disponible.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-251">The longer you keep a snapshot, however, the more likely it is to use up available space.</span></span> <span data-ttu-id="4ad2e-252">La taille maximale que peut atteindre un fichier partiellement alloué correspond à la taille du fichier de base de données source correspondant, au moment de la création de l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-252">The maximum size to which a sparse file can grow is the size of the corresponding source database file at the time of the snapshot creation.</span></span>  
  
 <span data-ttu-id="4ad2e-253">Si un instantané de base de données ne dispose plus de suffisamment d'espace disque, il doit être supprimé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-253">If a database snapshot runs out of disk space, it must be deleted (dropped).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4ad2e-254">À l'exception de l'espace de fichier, un instantané de base de données consomme grossièrement autant de ressources qu'une base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-254">Except for file space, a database snapshot consumes roughly as many resources as a database.</span></span>  
  
###  <a name="database-snapshots-with-offline-filegroups"></a><a name="OfflineFGs"></a> <span data-ttu-id="4ad2e-255">Instantanés de base de données avec des groupes de fichiers hors ligne</span><span class="sxs-lookup"><span data-stu-id="4ad2e-255">Database Snapshots with Offline Filegroups</span></span>  
 <span data-ttu-id="4ad2e-256">Les groupes de fichiers hors ligne dans la base de données source ont une incidence sur les instantanés de base de données lorsque vous tentez d'effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="4ad2e-256">Offline filegroups in the source database affect database snapshots when you try to do any of the following:</span></span>  
  
-   <span data-ttu-id="4ad2e-257">Créer un instantané</span><span class="sxs-lookup"><span data-stu-id="4ad2e-257">Create a snapshot</span></span>  
  
     <span data-ttu-id="4ad2e-258">Lorsqu'une base de données source possède un ou plusieurs groupes de fichiers hors ligne, la création d'instantanés réussit avec les groupes de fichiers hors ligne.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-258">When a source database has one or more offline filegroups, snapshot creation succeeds with the filegroups offline.</span></span> <span data-ttu-id="4ad2e-259">Aucun fichier partiellement alloué n'est créé pour les groupes de fichiers hors ligne.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-259">Sparse files are not created for the offline filegroups.</span></span>  
  
-   <span data-ttu-id="4ad2e-260">Mettre hors connexion un groupe de fichiers</span><span class="sxs-lookup"><span data-stu-id="4ad2e-260">Take a filegroup offline</span></span>  
  
     <span data-ttu-id="4ad2e-261">Vous pouvez mettre un fichier hors ligne dans la base de données source.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-261">You can take a file offline in the source database.</span></span> <span data-ttu-id="4ad2e-262">Cependant, le groupe de fichiers reste en ligne dans les instantanés de la base de données s'il était en ligne lorsque l'instantané a été créé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-262">However, the filegroup remains online in database snapshots if it was online when the snapshot was created.</span></span> <span data-ttu-id="4ad2e-263">Si les données interrogées ont changé depuis la création de l'instantané, la page de données d'origine sera accessible dans l'instantané.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-263">If the queried data has changed since snapshot creation, the original data page will be accessible in the snapshot.</span></span> <span data-ttu-id="4ad2e-264">Cependant, les requêtes qui utilisent l'instantané pour accéder aux données non modifiées dans le groupe de fichiers échoueront probablement en raison d'erreurs d'entrées/sorties (E/S).</span><span class="sxs-lookup"><span data-stu-id="4ad2e-264">However, queries that use the snapshot to access unmodified data in the filegroup are likely to fail with input/output (I/O) errors.</span></span>  
  
-   <span data-ttu-id="4ad2e-265">Mettre en ligne un groupe de fichiers</span><span class="sxs-lookup"><span data-stu-id="4ad2e-265">Bring a filegroup online</span></span>  
  
     <span data-ttu-id="4ad2e-266">Vous ne pouvez pas mettre en ligne un groupe de fichiers dans une base de données qui possède des instantanés de base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-266">You cannot bring a filegroup online in a database that has any database snapshots.</span></span> <span data-ttu-id="4ad2e-267">Si un groupe de fichiers est hors connexion au moment de la création de l'instantané ou est mis hors connexion alors qu'un instantané de base de données existe, le groupe de fichiers reste hors connexion.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-267">If a filegroup is offline at the time of snapshot creation or is taken offline while a database snapshot exists, the filegroup remains offline.</span></span> <span data-ttu-id="4ad2e-268">Cela est dû au fait que la remise en ligne d'un fichier implique sa restauration, ce qui n'est pas possible si un instantané de base de données existe sur la base de données.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-268">This is because bringing a file back online involves restoring it, which is not possible if a database snapshot exists on the database.</span></span>  
  
-   <span data-ttu-id="4ad2e-269">Restaurer la base de données source de l'instantané</span><span class="sxs-lookup"><span data-stu-id="4ad2e-269">Revert the source database to the snapshot</span></span>  
  
     <span data-ttu-id="4ad2e-270">Pour qu'une base de données source puisse être restaurée en un instantané, tous les groupes de fichiers doivent être en ligne, à l'exception des groupes de fichiers qui étaient hors connexion lorsque l'instantané a été créé.</span><span class="sxs-lookup"><span data-stu-id="4ad2e-270">Reverting a source database to a database snapshot requires that all of the filegroups are online except for filegroups that were offline when the snapshot was created.</span></span>  
  
##  <a name="related-tasks"></a><a name="RelatedTasks"></a> <span data-ttu-id="4ad2e-271">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="4ad2e-271">Related Tasks</span></span>  
  
-   [<span data-ttu-id="4ad2e-272">Créer un instantané de base de données &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="4ad2e-272">Create a Database Snapshot &#40;Transact-SQL&#41;</span></span>](create-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="4ad2e-273">Afficher un instantané de base de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4ad2e-273">View a Database Snapshot &#40;SQL Server&#41;</span></span>](view-a-database-snapshot-sql-server.md)  
  
-   [<span data-ttu-id="4ad2e-274">Afficher la taille du fichier partiellement alloué d’un instantané de base de données &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="4ad2e-274">View the Size of the Sparse File of a Database Snapshot &#40;Transact-SQL&#41;</span></span>](view-the-size-of-the-sparse-file-of-a-database-snapshot-transact-sql.md)  
  
-   [<span data-ttu-id="4ad2e-275">Rétablir une base de données dans l’état d’un instantané de base de données</span><span class="sxs-lookup"><span data-stu-id="4ad2e-275">Revert a Database to a Database Snapshot</span></span>](revert-a-database-to-a-database-snapshot.md)  
  
-   [<span data-ttu-id="4ad2e-276">Supprimer un instantané de base de données &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="4ad2e-276">Drop a Database Snapshot &#40;Transact-SQL&#41;</span></span>](drop-a-database-snapshot-transact-sql.md)  
  
## <a name="see-also"></a><span data-ttu-id="4ad2e-277">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4ad2e-277">See Also</span></span>  
 [<span data-ttu-id="4ad2e-278">Mise en miroir et instantanés de bases de données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="4ad2e-278">Database Mirroring and Database Snapshots &#40;SQL Server&#41;</span></span>](database-snapshots-sql-server.md)  
  
  
