---
title: Reconstruire des bases de données système | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- master database [SQL Server], rebuilding
- REBUILDDATABASE parameter
- rebuilding databases, master
- system databases [SQL Server], rebuilding
ms.assetid: af457ecd-523e-4809-9652-bdf2e81bd876
author: stevestein
ms.author: sstein
ms.openlocfilehash: 5f695589fa0fc1b86d4433d36afa1bc6357aabd6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604546"
---
# <a name="rebuild-system-databases"></a><span data-ttu-id="c5234-102">Reconstruire des bases de données système</span><span class="sxs-lookup"><span data-stu-id="c5234-102">Rebuild System Databases</span></span>
  <span data-ttu-id="c5234-103">Les bases de données système doivent être reconstruites pour résoudre des problèmes d’altération dans les bases de données système [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md)ou [resource](resource-database.md) ou pour modifier le classement au niveau du serveur par défaut.</span><span class="sxs-lookup"><span data-stu-id="c5234-103">System databases must be rebuilt to fix corruption problems in the [master](master-database.md), [model](model-database.md), [msdb](msdb-database.md), or [resource](resource-database.md) system databases or to modify the default server-level collation.</span></span> <span data-ttu-id="c5234-104">Cette rubrique fournit des instructions détaillées sur la reconstruction des bases de données système dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5234-104">This topic provides step-by-step instructions to rebuild system databases in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
 <span data-ttu-id="c5234-105">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="c5234-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="c5234-106">**Avant de commencer :**</span><span class="sxs-lookup"><span data-stu-id="c5234-106">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="c5234-107">Limitations et restrictions</span><span class="sxs-lookup"><span data-stu-id="c5234-107">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="c5234-108">Composants requis</span><span class="sxs-lookup"><span data-stu-id="c5234-108">Prerequisites</span></span>](#Prerequisites)  
  
-   <span data-ttu-id="c5234-109">**Procédures :**</span><span class="sxs-lookup"><span data-stu-id="c5234-109">**Procedures:**</span></span>  
  
     [<span data-ttu-id="c5234-110">Reconstruire des bases de données système</span><span class="sxs-lookup"><span data-stu-id="c5234-110">Rebuild System Databases</span></span>](#RebuildProcedure)  
  
     [<span data-ttu-id="c5234-111">Reconstruire la base de données resource</span><span class="sxs-lookup"><span data-stu-id="c5234-111">Rebuild the resource Database</span></span>](#Resource)  
  
     [<span data-ttu-id="c5234-112">Créer une nouvelle base de données msdb</span><span class="sxs-lookup"><span data-stu-id="c5234-112">Create a New msdb Database</span></span>](#CreateMSDB)  
  
-   <span data-ttu-id="c5234-113">**Suivi :**</span><span class="sxs-lookup"><span data-stu-id="c5234-113">**Follow Up:**</span></span>  
  
     [<span data-ttu-id="c5234-114">Corriger les erreurs liées à la reconstruction</span><span class="sxs-lookup"><span data-stu-id="c5234-114">Troubleshoot Rebuild Errors</span></span>](#Troubleshoot)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="c5234-115">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="c5234-115">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="c5234-116">Limitations et restrictions</span><span class="sxs-lookup"><span data-stu-id="c5234-116">Limitations and Restrictions</span></span>  
 <span data-ttu-id="c5234-117">Lorsque les bases de données système master, model, msdb et tempdb sont reconstruites, les bases de données sont supprimées et recréées à leur emplacement d'origine.</span><span class="sxs-lookup"><span data-stu-id="c5234-117">When the master, model, msdb, and tempdb system databases are rebuilt, the databases are dropped and re-created in their original location.</span></span> <span data-ttu-id="c5234-118">Si un nouveau classement est spécifié dans l'instruction de reconstruction, les bases de données système sont créées à l'aide de ce paramètre de classement.</span><span class="sxs-lookup"><span data-stu-id="c5234-118">If a new collation is specified in the rebuild statement, the system databases are created using that collation setting.</span></span> <span data-ttu-id="c5234-119">Les modifications apportées par les utilisateurs à ces bases de données sont perdues.</span><span class="sxs-lookup"><span data-stu-id="c5234-119">Any user modifications to these databases are lost.</span></span> <span data-ttu-id="c5234-120">Par exemple, les utilisateurs peuvent avoir défini des objets dans la base de données master et planifié des travaux dans msdb ou avoir modifié le paramétrage par défaut dans la base de données model.</span><span class="sxs-lookup"><span data-stu-id="c5234-120">For example, you may have user-defined objects in the master database, scheduled jobs in msdb, or changes to the default database settings in the model database.</span></span>  
  
###  <a name="prerequisites"></a><a name="Prerequisites"></a> <span data-ttu-id="c5234-121">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="c5234-121">Prerequisites</span></span>  
 <span data-ttu-id="c5234-122">Avant de reconstruire les bases de données système, effectuez les tâches suivantes pour être certain de pouvoir restaurer les bases de données système avec leurs paramètres actuels.</span><span class="sxs-lookup"><span data-stu-id="c5234-122">Perform the following tasks before you rebuild the system databases to ensure that you can restore the system databases to their current settings.</span></span>  
  
1.  <span data-ttu-id="c5234-123">Enregistrez toutes les valeurs de configuration à l'échelle du serveur.</span><span class="sxs-lookup"><span data-stu-id="c5234-123">Record all server-wide configuration values.</span></span>  
  
    ```  
    SELECT * FROM sys.configurations;  
    ```  
  
2.  <span data-ttu-id="c5234-124">Enregistrez tous les Service Packs et correctifs logiciels appliqués à l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le classement actuel.</span><span class="sxs-lookup"><span data-stu-id="c5234-124">Record all service packs and hotfixes applied to the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the current collation.</span></span> <span data-ttu-id="c5234-125">Vous devrez réappliquer ces mises à jour après avoir reconstruit les bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-125">You must reapply these updates after rebuilding the system databases.</span></span>  
  
    ```  
    SELECT  
    SERVERPROPERTY('ProductVersion ') AS ProductVersion,  
    SERVERPROPERTY('ProductLevel') AS ProductLevel,  
    SERVERPROPERTY('ResourceVersion') AS ResourceVersion,  
    SERVERPROPERTY('ResourceLastUpdateDateTime') AS ResourceLastUpdateDateTime,  
    SERVERPROPERTY('Collation') AS Collation;  
    ```  
  
3.  <span data-ttu-id="c5234-126">Enregistrez l'emplacement actuel de tous les fichiers de données et fichiers journaux des bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-126">Record the current location of all data and log files for the system databases.</span></span> <span data-ttu-id="c5234-127">La reconstruction des bases de données système installe toutes les bases de données système à leur emplacement d'origine.</span><span class="sxs-lookup"><span data-stu-id="c5234-127">Rebuilding the system databases installs all system databases to their original location.</span></span> <span data-ttu-id="c5234-128">Si vous avez déplacé des fichiers de données ou des fichiers journaux de bases de données système, vous devrez à nouveau les déplacer.</span><span class="sxs-lookup"><span data-stu-id="c5234-128">If you have moved system database data or log files to a different location, you must move the files again.</span></span>  
  
    ```  
    SELECT name, physical_name AS current_file_location  
    FROM sys.master_files  
    WHERE database_id IN (DB_ID('master'), DB_ID('model'), DB_ID('msdb'), DB_ID('tempdb'));  
    ```  
  
4.  <span data-ttu-id="c5234-129">Localisez la sauvegarde actuelle des bases de données master, model et msdb.</span><span class="sxs-lookup"><span data-stu-id="c5234-129">Locate the current backup of the master, model, and msdb databases.</span></span>  
  
5.  <span data-ttu-id="c5234-130">Si l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est configurée en tant que serveur de distribution de réplication, localisez la sauvegarde actuelle de la base de données de distribution.</span><span class="sxs-lookup"><span data-stu-id="c5234-130">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, locate the current backup of the distribution database.</span></span>  
  
6.  <span data-ttu-id="c5234-131">Vérifiez que vous disposez des autorisations appropriées pour reconstruire les bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-131">Ensure you have appropriate permissions to rebuild the system databases.</span></span> <span data-ttu-id="c5234-132">Pour effectuer cette opération, vous devez être membre du rôle serveur fixe `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="c5234-132">To perform this operation, you must be a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="c5234-133">Pour plus d’informations, consultez [Rôles de niveau serveur](../security/authentication-access/server-level-roles.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-133">For more information, see [Server-Level Roles](../security/authentication-access/server-level-roles.md).</span></span>  
  
7.  <span data-ttu-id="c5234-134">Vérifiez que des copies des fichiers modèles de données et de journaux de master, model et msdb existent sur le serveur local.</span><span class="sxs-lookup"><span data-stu-id="c5234-134">Verify that copies of the master, model, msdb data and log template files exist on the local server.</span></span> <span data-ttu-id="c5234-135">L'emplacement par défaut des fichiers modèles est C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="c5234-135">The default location for the template files is C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\Templates.</span></span> <span data-ttu-id="c5234-136">Ces fichiers sont utilisés pendant le processus de reconstruction et doivent être présents pour que l'installation réussisse.</span><span class="sxs-lookup"><span data-stu-id="c5234-136">These files are used during the rebuild process and must be present for Setup to succeed.</span></span> <span data-ttu-id="c5234-137">S'il en manque, exécutez la fonctionnalité Réparer du programme d'installation ou copiez manuellement les fichiers à partir du média d'installation.</span><span class="sxs-lookup"><span data-stu-id="c5234-137">If they are missing, run the Repair feature of Setup, or manually copy the files from your installation media.</span></span> <span data-ttu-id="c5234-138">Pour trouver les fichiers sur le média d'installation, accédez au répertoire correspondant à la plateforme appropriée (x86 ou x64), puis accédez à setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span><span class="sxs-lookup"><span data-stu-id="c5234-138">To locate the files on the installation media, navigate to the appropriate platform directory (x86 or x64) and then navigate to setup\sql_engine_core_inst_msi\Pfiles\SqlServr\MSSQL.X\MSSQL\Binn\Templates.</span></span>  
  
##  <a name="rebuild-system-databases"></a><a name="RebuildProcedure"></a> <span data-ttu-id="c5234-139">Reconstruire des bases de données système</span><span class="sxs-lookup"><span data-stu-id="c5234-139">Rebuild System Databases</span></span>  
 <span data-ttu-id="c5234-140">La procédure suivante reconstruit les bases de données système master, model, msdb et tempdb.</span><span class="sxs-lookup"><span data-stu-id="c5234-140">The following procedure rebuilds the master, model, msdb, and tempdb system databases.</span></span> <span data-ttu-id="c5234-141">Vous ne pouvez pas spécifier les bases de données système à reconstruire.</span><span class="sxs-lookup"><span data-stu-id="c5234-141">You cannot specify the system databases to be rebuilt.</span></span> <span data-ttu-id="c5234-142">Pour les instances cluster, cette procédure doit être effectuée sur le nœud actif et la ressource [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dans le groupe d'applications cluster correspondant doit être en mode hors connexion avant d'effectuer la procédure.</span><span class="sxs-lookup"><span data-stu-id="c5234-142">For clustered instances, this procedure must be performed on the active node and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] resource in the corresponding cluster application group must be taken offline before performing the procedure.</span></span>  
  
 <span data-ttu-id="c5234-143">Cette procédure ne reconstruit pas la base de données resource.</span><span class="sxs-lookup"><span data-stu-id="c5234-143">This procedure does not rebuild the resource database.</span></span> <span data-ttu-id="c5234-144">Consultez la section « Procédure de reconstruction de la base de données resource », plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="c5234-144">See the section, "Rebuild the resource Database Procedure" later in this topic.</span></span>  
  
#### <a name="to-rebuild-system-databases-for-an-instance-of-sql-server"></a><span data-ttu-id="c5234-145">Pour reconstruire les bases de données système pour une instance de SQL Server :</span><span class="sxs-lookup"><span data-stu-id="c5234-145">To rebuild system databases for an instance of SQL Server:</span></span>  
  
1.  <span data-ttu-id="c5234-146">Insérez le média d'installation [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] dans le lecteur de disque ou, à partir d'une invite de commandes, changez de répertoire pour accéder à l'emplacement du fichier setup.exe situé sur le serveur local.</span><span class="sxs-lookup"><span data-stu-id="c5234-146">Insert the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] installation media into the disk drive, or, from a command prompt, change directories to the location of the setup.exe file on the local server.</span></span> <span data-ttu-id="c5234-147">L'emplacement par défaut sur le serveur est C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Release.</span><span class="sxs-lookup"><span data-stu-id="c5234-147">The default location on the server is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Release.</span></span>  
  
2.  <span data-ttu-id="c5234-148">À partir d'une fenêtre d'invite de commandes, tapez la commande ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="c5234-148">From a command prompt window, enter the following command.</span></span> <span data-ttu-id="c5234-149">Les crochets indiquent des paramètres facultatifs.</span><span class="sxs-lookup"><span data-stu-id="c5234-149">Square brackets are used to indicate optional parameters.</span></span> <span data-ttu-id="c5234-150">N'entrez pas les crochets.</span><span class="sxs-lookup"><span data-stu-id="c5234-150">Do not enter the brackets.</span></span> <span data-ttu-id="c5234-151">Si vous utilisez un système d'exploitation Windows avec le Contrôle de compte d'utilisateur activé, l'exécution du programme d'installation requiert des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="c5234-151">When using a Windows operating system that has User Account Control (UAC) enabled, running Setup requires elevated privileges.</span></span> <span data-ttu-id="c5234-152">Pour utiliser l'invite de commandes, vous devez être administrateur.</span><span class="sxs-lookup"><span data-stu-id="c5234-152">The command prompt must be run as Administrator.</span></span>  
  
     `Setup /QUIET /ACTION=REBUILDDATABASE /INSTANCENAME=InstanceName /SQLSYSADMINACCOUNTS=accounts [ /SAPWD= StrongPassword ] [ /SQLCOLLATION=CollationName]`  
  
    |<span data-ttu-id="c5234-153">Nom du paramètre</span><span class="sxs-lookup"><span data-stu-id="c5234-153">Parameter name</span></span>|<span data-ttu-id="c5234-154">Description</span><span class="sxs-lookup"><span data-stu-id="c5234-154">Description</span></span>|  
    |--------------------|-----------------|  
    |<span data-ttu-id="c5234-155">/QUIET ou /Q</span><span class="sxs-lookup"><span data-stu-id="c5234-155">/QUIET or /Q</span></span>|<span data-ttu-id="c5234-156">Spécifie que le programme d'installation doit s'exécuter sans interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c5234-156">Specifies that Setup run without any user interface.</span></span>|  
    |<span data-ttu-id="c5234-157">/ACTION=REBUILDDATABASE</span><span class="sxs-lookup"><span data-stu-id="c5234-157">/ACTION=REBUILDDATABASE</span></span>|<span data-ttu-id="c5234-158">Spécifie que le programme d'installation doit recréer les bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-158">Specifies that Setup re-create the system databases.</span></span>|  
    |<span data-ttu-id="c5234-159">/INSTANCENAME=*Nom_Instance*</span><span class="sxs-lookup"><span data-stu-id="c5234-159">/INSTANCENAME=*InstanceName*</span></span>|<span data-ttu-id="c5234-160">Représente le nom de l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5234-160">Is the name of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="c5234-161">Pour l'instance par défaut, entrez MSSQLSERVER.</span><span class="sxs-lookup"><span data-stu-id="c5234-161">For the default instance, enter MSSQLSERVER.</span></span>|  
    |<span data-ttu-id="c5234-162">/SQLSYSADMINACCOUNTS=*comptes*</span><span class="sxs-lookup"><span data-stu-id="c5234-162">/SQLSYSADMINACCOUNTS=*accounts*</span></span>|<span data-ttu-id="c5234-163">Spécifie les comptes de groupes Windows ou les comptes individuels à ajouter au rôle serveur fixe `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="c5234-163">Specifies the Windows groups or individual accounts to add to the `sysadmin` fixed server role.</span></span> <span data-ttu-id="c5234-164">Lorsque vous spécifiez plusieurs comptes, utilisez l'espace comme séparateur.</span><span class="sxs-lookup"><span data-stu-id="c5234-164">When specifying more than one account, separate the accounts with a blank space.</span></span> <span data-ttu-id="c5234-165">Par exemple, entrez **BUILTIN\Administrateurs MonDomaine\MonUtilisateur**.</span><span class="sxs-lookup"><span data-stu-id="c5234-165">For example, enter **BUILTIN\Administrators MyDomain\MyUser**.</span></span> <span data-ttu-id="c5234-166">Lorsque vous spécifiez un compte qui contient un espace vide dans son nom, placez le compte entre guillemets doubles.</span><span class="sxs-lookup"><span data-stu-id="c5234-166">When you are specifying an account that contains a blank space within the account name, enclose the account in double quotation marks.</span></span> <span data-ttu-id="c5234-167">Par exemple, entrez `NT AUTHORITY\SYSTEM`.</span><span class="sxs-lookup"><span data-stu-id="c5234-167">For example, enter `NT AUTHORITY\SYSTEM`.</span></span>|  
    |<span data-ttu-id="c5234-168">[ /SAPWD=*MotDePasseFort* ]</span><span class="sxs-lookup"><span data-stu-id="c5234-168">[ /SAPWD=*StrongPassword* ]</span></span>|<span data-ttu-id="c5234-169">Spécifie le mot de passe du [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` compte.</span><span class="sxs-lookup"><span data-stu-id="c5234-169">Specifies the password for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] `sa` account.</span></span> <span data-ttu-id="c5234-170">Ce paramètre est requis si l’instance utilise le mode Authentification mixte (authentification[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et Windows).</span><span class="sxs-lookup"><span data-stu-id="c5234-170">This parameter is required if the instance uses Mixed Authentication ([!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and Windows Authentication) mode.</span></span><br /><br /> <span data-ttu-id="c5234-171">Note de sécurité le compte est \*\* \* un compte bien connu \* et il est souvent ciblé par des utilisateurs malveillants. \* \* \*\* `sa` [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]</span><span class="sxs-lookup"><span data-stu-id="c5234-171">**\*\* Security Note \*\*** The `sa` account is a well-known [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] account and it is often targeted by malicious users.</span></span> <span data-ttu-id="c5234-172">Il est par conséquent essentiel d'utiliser un mot de passe fort pour la connexion `sa`.</span><span class="sxs-lookup"><span data-stu-id="c5234-172">It is very important that you use a strong password for the `sa` login.</span></span><br /><br /> <span data-ttu-id="c5234-173">Ne spécifiez pas ce paramètre pour le mode Authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="c5234-173">Do not specify this parameter for Windows Authentication mode.</span></span>|  
    |<span data-ttu-id="c5234-174">[ /SQLCOLLATION=*NomClassement* ]</span><span class="sxs-lookup"><span data-stu-id="c5234-174">[ /SQLCOLLATION=*CollationName* ]</span></span>|<span data-ttu-id="c5234-175">Spécifie un nouveau classement au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="c5234-175">Specifies a new server-level collation.</span></span> <span data-ttu-id="c5234-176">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="c5234-176">This parameter is optional.</span></span> <span data-ttu-id="c5234-177">S'il n'est pas spécifié, c'est le classement actuel du serveur qui est utilisé.</span><span class="sxs-lookup"><span data-stu-id="c5234-177">When not specified, the current collation of the server is used.</span></span><br /><br /> <span data-ttu-id="c5234-178">**\*\* Important \*\*** La modification du classement de niveau serveur ne modifie pas le classement des bases de données utilisateur existantes.</span><span class="sxs-lookup"><span data-stu-id="c5234-178">**\*\* Important \*\*** Changing the server-level collation does not change the collation of existing user databases.</span></span> <span data-ttu-id="c5234-179">En revanche, les bases de données utilisateur qui seront créées utiliseront le nouveau classement par défaut.</span><span class="sxs-lookup"><span data-stu-id="c5234-179">All newly created user databases will use the new collation by default.</span></span><br /><br /> <span data-ttu-id="c5234-180">Pour plus d’informations, consultez [Définir ou modifier le classement du serveur](../collations/set-or-change-the-server-collation.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-180">For more information, see [Set or Change the Server Collation](../collations/set-or-change-the-server-collation.md).</span></span>|  
  
3.  <span data-ttu-id="c5234-181">Lorsque le programme d'installation a terminé la reconstruction des bases de données système, il revient à l'invite de commandes sans afficher de message.</span><span class="sxs-lookup"><span data-stu-id="c5234-181">When Setup has completed rebuilding the system databases, it returns to the command prompt with no messages.</span></span> <span data-ttu-id="c5234-182">Examinez le fichier journal Summary.txt pour vérifier que le processus s'est correctement déroulé.</span><span class="sxs-lookup"><span data-stu-id="c5234-182">Examine the Summary.txt log file to verify that the process completed successfully.</span></span> <span data-ttu-id="c5234-183">Ce fichier se trouve à l'emplacement C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="c5234-183">This file is located at C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span>  
  
## <a name="post-rebuild-tasks"></a><span data-ttu-id="c5234-184">Tâches à effectuer après la reconstruction</span><span class="sxs-lookup"><span data-stu-id="c5234-184">Post-Rebuild Tasks</span></span>  
 <span data-ttu-id="c5234-185">Après avoir reconstruit la base de données, vous devrez peut-être effectuer les tâches supplémentaires suivantes :</span><span class="sxs-lookup"><span data-stu-id="c5234-185">After rebuilding the database you may need to perform the following additional tasks:</span></span>  
  
-   <span data-ttu-id="c5234-186">Restaurer vos sauvegardes complètes les plus récentes des bases de données master, model et msdb.</span><span class="sxs-lookup"><span data-stu-id="c5234-186">Restore your most recent full backups of the master, model, and msdb databases.</span></span> <span data-ttu-id="c5234-187">Pour plus d’informations, consultez [Sauvegarder et restaurer des bases de données système &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-187">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c5234-188">Si vous avez modifié le classement du serveur, ne restaurez pas les bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-188">If you have changed the server collation, do not restore the system databases.</span></span> <span data-ttu-id="c5234-189">Cette opération remplacerait le nouveau classement par le paramétrage de classement précédent.</span><span class="sxs-lookup"><span data-stu-id="c5234-189">Doing so will replace the new collation with the previous collation setting.</span></span>  
  
     <span data-ttu-id="c5234-190">Si une sauvegarde n'est pas disponible ou si la sauvegarde restaurée n'est pas actuelle, recréez toutes les entrées manquantes.</span><span class="sxs-lookup"><span data-stu-id="c5234-190">If a backup is not available or if the restored backup is not current, re-create any missing entries.</span></span> <span data-ttu-id="c5234-191">Par exemple, recréez toutes les entrées manquantes pour vos bases de données utilisateur, unités de sauvegarde, connexions [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , points de terminaison, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="c5234-191">For example, re-create all missing entries for your user databases, backup devices, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logins, end points, and so on.</span></span> <span data-ttu-id="c5234-192">Le meilleur moyen de recréer des entrées est d'exécuter les scripts d'origine qui les ont créées.</span><span class="sxs-lookup"><span data-stu-id="c5234-192">The best way to re-create entries is to run the original scripts that created them.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c5234-193">Nous vous conseillons de protéger vos scripts et de les conserver en lieu sûr pour éviter que des personnes non autorisées ne les modifient.</span><span class="sxs-lookup"><span data-stu-id="c5234-193">We recommend that you secure your scripts to prevent their being altered by unauthorized by individuals.</span></span>  
  
-   <span data-ttu-id="c5234-194">Si l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est configurée comme serveur de distribution de réplication, vous devez restaurer la base de données de distribution.</span><span class="sxs-lookup"><span data-stu-id="c5234-194">If the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is configured as a replication Distributor, you must restore the distribution database.</span></span> <span data-ttu-id="c5234-195">Pour plus d’informations, consultez [Sauvegarder et restaurer des bases de données répliquées](../replication/administration/back-up-and-restore-replicated-databases.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-195">For more information, see [Back Up and Restore Replicated Databases](../replication/administration/back-up-and-restore-replicated-databases.md).</span></span>  
  
-   <span data-ttu-id="c5234-196">Déplacer les bases de données système vers les emplacements que vous avez enregistrés précédemment.</span><span class="sxs-lookup"><span data-stu-id="c5234-196">Move the system databases to the locations you recorded previously.</span></span> <span data-ttu-id="c5234-197">Pour plus d’informations, consultez [Déplacer des bases de données système](system-databases.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-197">For more information, see [Move System Databases](system-databases.md).</span></span>  
  
-   <span data-ttu-id="c5234-198">Vérifier que les valeurs de configuration à l'échelle du serveur correspondent à celles que vous avez enregistrées précédemment.</span><span class="sxs-lookup"><span data-stu-id="c5234-198">Verify the server-wide configuration values match the values you recorded previously.</span></span>  
  
##  <a name="rebuild-the-resource-database"></a><a name="Resource"></a> <span data-ttu-id="c5234-199">Reconstruire la base de données resource</span><span class="sxs-lookup"><span data-stu-id="c5234-199">Rebuild the resource Database</span></span>  
 <span data-ttu-id="c5234-200">La procédure suivante reconstruit la base de données système resource.</span><span class="sxs-lookup"><span data-stu-id="c5234-200">The following procedure rebuilds the resource system database.</span></span> <span data-ttu-id="c5234-201">La reconstruction de la base de données resource entraîne la perte de tous les Service Packs et correctifs logiciels, qui devront par conséquent être réappliqués.</span><span class="sxs-lookup"><span data-stu-id="c5234-201">When you rebuild the resource database, all service packs and hot fixes are lost, and therefore must be reapplied.</span></span>  
  
#### <a name="to-rebuild-the-resource-system-database"></a><span data-ttu-id="c5234-202">Pour reconstruire la base de données système resource :</span><span class="sxs-lookup"><span data-stu-id="c5234-202">To rebuild the resource system database:</span></span>  
  
1.  <span data-ttu-id="c5234-203">Lancez le programme d'installation de [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] (setup.exe) à partir du média de distribution.</span><span class="sxs-lookup"><span data-stu-id="c5234-203">Launch the [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Setup program (setup.exe) from the distribution media.</span></span>  
  
2.  <span data-ttu-id="c5234-204">Dans la zone de navigation gauche, cliquez sur **Maintenance**, puis sur **Réparer**.</span><span class="sxs-lookup"><span data-stu-id="c5234-204">In the left navigation area, click **Maintenance**, and then click **Repair**.</span></span>  
  
3.  <span data-ttu-id="c5234-205">La règle de support du programme d'installation et les routines de fichiers sont exécutées pour garantir que les composants requis sont installés sur votre système et que les règles de validation du programme d'installation ont été correctement exécutées sur l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="c5234-205">Setup support rule and file routines run to ensure that your system has prerequisites installed and that the computer passes Setup validation rules.</span></span> <span data-ttu-id="c5234-206">Cliquez sur **OK** ou sur **Installer** pour continuer.</span><span class="sxs-lookup"><span data-stu-id="c5234-206">Click **OK** or **Install** to continue.</span></span>  
  
4.  <span data-ttu-id="c5234-207">Dans la page Sélectionner une instance, sélectionnez l'instance à réparer, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="c5234-207">On the Select Instance page, select the instance to repair, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="c5234-208">Les règles de réparation sont exécutées pour valider l'opération.</span><span class="sxs-lookup"><span data-stu-id="c5234-208">The repair rules will run to validate the operation.</span></span> <span data-ttu-id="c5234-209">Pour continuer, cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="c5234-209">To continue, click **Next**.</span></span>  
  
6.  <span data-ttu-id="c5234-210">Dans la page **Prêt à réparer** , cliquez sur **Réparer**.</span><span class="sxs-lookup"><span data-stu-id="c5234-210">From the **Ready to Repair** page, click **Repair**.</span></span> <span data-ttu-id="c5234-211">La page Terminé indique que l'opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="c5234-211">The Complete page indicates that the operation is finished.</span></span>  
  
##  <a name="create-a-new-msdb-database"></a><a name="CreateMSDB"></a> <span data-ttu-id="c5234-212">Créer une nouvelle base de données msdb</span><span class="sxs-lookup"><span data-stu-id="c5234-212">Create a New msdb Database</span></span>  
 <span data-ttu-id="c5234-213">Si la `msdb` base de données est endommagée et que vous n’avez pas de sauvegarde de la `msdb` base de données, vous pouvez créer une nouvelle `msdb` à l’aide du script **instmsdb** .</span><span class="sxs-lookup"><span data-stu-id="c5234-213">If the `msdb` database is damaged and you do not have a backup of the `msdb` database, you can create a new `msdb` by using the **instmsdb** script.</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="c5234-214">La reconstruction `msdb` de la base de données à l’aide du script **instmsdb** élimine toutes les informations stockées dans, `msdb` telles que les travaux, les alertes, les opérateurs, les plans de maintenance, l’historique de sauvegarde, les paramètres de gestion basée sur des stratégies, les Database mail, les Data Warehouse de performances, etc.</span><span class="sxs-lookup"><span data-stu-id="c5234-214">Rebuilding the `msdb` database using the **instmsdb** script will eliminate all the information stored in `msdb` such as jobs, alert, operators, maintenance plans, backup history, Policy-Based Management settings, Database Mail, Performance Data Warehouse, etc.</span></span>  
  
1.  <span data-ttu-id="c5234-215">Arrêtez tous les services qui établissent des connexions au [!INCLUDE[ssDE](../../includes/ssde-md.md)], dont [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)]et toutes les applications qui utilisent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en tant que banque de données.</span><span class="sxs-lookup"><span data-stu-id="c5234-215">Stop all services connecting to the [!INCLUDE[ssDE](../../includes/ssde-md.md)], including [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent, [!INCLUDE[ssRS](../../includes/ssrs.md)], [!INCLUDE[ssIS](../../includes/ssis-md.md)], and all applications using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] as data store.</span></span>  
  
2.  <span data-ttu-id="c5234-216">Démarrez [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à partir de la ligne de commande à l'aide de la commande : `NET START MSSQLSERVER /T3608`</span><span class="sxs-lookup"><span data-stu-id="c5234-216">Start [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] from the command line using the command: `NET START MSSQLSERVER /T3608`</span></span>  
  
     <span data-ttu-id="c5234-217">Pour plus d'informations, consultez [Démarrer, arrêter, suspendre, reprendre, redémarrer les services SQL Server](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span><span class="sxs-lookup"><span data-stu-id="c5234-217">For more information, see [Start, Stop, Pause, Resume, Restart the Database Engine, SQL Server Agent, or SQL Server Browser Service](../../database-engine/configure-windows/start-stop-pause-resume-restart-sql-server-services.md).</span></span>  
  
3.  <span data-ttu-id="c5234-218">Dans une autre fenêtre de ligne de commande, détachez la `msdb` base de données en exécutant la commande suivante, en remplaçant *\<servername>* par l’instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] :`SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span><span class="sxs-lookup"><span data-stu-id="c5234-218">In another command line window, detach the `msdb` database by executing the following command, replacing *\<servername>* with the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]: `SQLCMD -E -S<servername> -dmaster -Q"EXEC sp_detach_db msdb"`</span></span>  
  
4.  <span data-ttu-id="c5234-219">À l’aide de l’Explorateur Windows, renommez les `msdb` fichiers de base de données.</span><span class="sxs-lookup"><span data-stu-id="c5234-219">Using the Windows Explorer, rename the `msdb` database files.</span></span> <span data-ttu-id="c5234-220">Par défaut, ils se trouvent dans le sous-dossier DATA de l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c5234-220">By default these are in the DATA sub-folder for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance.</span></span>  
  
5.  <span data-ttu-id="c5234-221">À l'aide du Gestionnaire de configuration [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , arrêtez et redémarrez le service [!INCLUDE[ssDE](../../includes/ssde-md.md)] normalement.</span><span class="sxs-lookup"><span data-stu-id="c5234-221">Using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Configuration Manager, stop and restart the [!INCLUDE[ssDE](../../includes/ssde-md.md)] service normally.</span></span>  
  
6.  <span data-ttu-id="c5234-222">Dans une fenêtre de ligne de commande, connectez-vous à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et exécutez la commande : `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span><span class="sxs-lookup"><span data-stu-id="c5234-222">In a command line window, connect to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and execute the command: `SQLCMD -E -S<servername> -i"C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.sql" -o" C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Install\instmsdb.out"`</span></span>  
  
     <span data-ttu-id="c5234-223">Remplacez *\<servername>* par l'instance du [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5234-223">Replace *\<servername>* with the instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)].</span></span> <span data-ttu-id="c5234-224">Utilisez le chemin d'accès au système de fichiers de l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5234-224">Use the file system path of the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
7.  <span data-ttu-id="c5234-225">À l'aide du Bloc-notes Windows, ouvrez le fichier **instmsdb.out** et vérifiez qu'il ne présente aucune erreur.</span><span class="sxs-lookup"><span data-stu-id="c5234-225">Using the Windows Notepad, open the **instmsdb.out** file and check the output for any errors.</span></span>  
  
8.  <span data-ttu-id="c5234-226">Réappliquez tous les Service Packs ou les correctifs logiciels installés sur l'instance.</span><span class="sxs-lookup"><span data-stu-id="c5234-226">Re-apply any service packs or hotfix installed on the instance.</span></span>  
  
9. <span data-ttu-id="c5234-227">Recréez le contenu de l’utilisateur stocké dans la `msdb` base de données, tel que les travaux, l’alerte, etc.</span><span class="sxs-lookup"><span data-stu-id="c5234-227">Recreate the user content stored in the `msdb` database, such as jobs, alert, etc.</span></span>  
  
10. <span data-ttu-id="c5234-228">Sauvegardez la base de données `msdb` .</span><span class="sxs-lookup"><span data-stu-id="c5234-228">Backup the `msdb` database.</span></span>  
  
##  <a name="troubleshoot-rebuild-errors"></a><a name="Troubleshoot"></a> <span data-ttu-id="c5234-229">Corriger les erreurs liées à la reconstruction</span><span class="sxs-lookup"><span data-stu-id="c5234-229">Troubleshoot Rebuild Errors</span></span>  
 <span data-ttu-id="c5234-230">Les erreurs de syntaxe et autres erreurs d'exécution sont affichées dans la fenêtre d'invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="c5234-230">Syntax and other run-time errors are displayed in the command prompt window.</span></span> <span data-ttu-id="c5234-231">Vérifiez que l'instruction Setup ne comporte pas les erreurs de syntaxe suivantes :</span><span class="sxs-lookup"><span data-stu-id="c5234-231">Examine the Setup statement for the following syntax errors:</span></span>  
  
-   <span data-ttu-id="c5234-232">Barre oblique (/) manquante devant chaque nom de paramètre.</span><span class="sxs-lookup"><span data-stu-id="c5234-232">Missing slash mark (/) in front of each parameter name.</span></span>  
  
-   <span data-ttu-id="c5234-233">Signe égal (=) manquant entre le nom du paramètre et sa valeur.</span><span class="sxs-lookup"><span data-stu-id="c5234-233">Missing equal sign (=) between the parameter name and the parameter value.</span></span>  
  
-   <span data-ttu-id="c5234-234">Présence d'espaces entre le nom du paramètre et le signe égal.</span><span class="sxs-lookup"><span data-stu-id="c5234-234">Presence of blank spaces between the parameter name and the equal sign.</span></span>  
  
-   <span data-ttu-id="c5234-235">Présence de virgules (,) ou d'autres caractères qui ne sont pas spécifiés dans la syntaxe.</span><span class="sxs-lookup"><span data-stu-id="c5234-235">Presence of commas (,) or other characters that are not specified in the syntax.</span></span>  
  
 <span data-ttu-id="c5234-236">Une fois l'opération de reconstruction terminée, examinez les journaux [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour vérifier s'ils contiennent des erreurs.</span><span class="sxs-lookup"><span data-stu-id="c5234-236">After the rebuild operation is complete, examine the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] logs for any errors.</span></span> <span data-ttu-id="c5234-237">L'emplacement par défaut des journaux est C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span><span class="sxs-lookup"><span data-stu-id="c5234-237">The default log location is C:\Program Files\Microsoft SQL Server\120\Setup Bootstrap\Logs.</span></span> <span data-ttu-id="c5234-238">Pour localiser le fichier journal qui contient les résultats du processus de reconstruction, accédez au dossier Logs à partir d'une invite de commandes, puis exécutez `findstr /s RebuildDatabase summary*.*`.</span><span class="sxs-lookup"><span data-stu-id="c5234-238">To locate the log file that contains the results of the rebuild process, change directories to the Logs folder from a command prompt, and then run `findstr /s RebuildDatabase summary*.*`.</span></span> <span data-ttu-id="c5234-239">Cette recherche vous dirige vers les fichiers journaux qui contiennent les résultats de la reconstruction des bases de données système.</span><span class="sxs-lookup"><span data-stu-id="c5234-239">This search will point you to any log files that contain the results of rebuilding system databases.</span></span> <span data-ttu-id="c5234-240">Ouvrez les fichiers journaux et recherchez les messages d'erreur pertinents.</span><span class="sxs-lookup"><span data-stu-id="c5234-240">Open the log files and examine them for relevant error messages.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5234-241">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c5234-241">See Also</span></span>  
 [<span data-ttu-id="c5234-242">Bases de données système</span><span class="sxs-lookup"><span data-stu-id="c5234-242">System Databases</span></span>](system-databases.md)  
  
  
