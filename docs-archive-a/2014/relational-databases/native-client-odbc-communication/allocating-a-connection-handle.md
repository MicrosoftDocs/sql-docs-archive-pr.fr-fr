---
title: Allocation d’un handle de connexion | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- ODBC applications, passwords
- ODBC applications, connections
- handles [SQL Server Native Client]
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- SQL Server Native Client ODBC driver, connection handles
- connection handles [SQL Server Native Client]
- modifying passwords
- SQLAllocHandle function
ms.assetid: 471d8a31-199c-4f92-bb10-004fc7733b35
author: rothja
ms.author: jroth
ms.openlocfilehash: d3cf84e541f114d527d9a00cd19bce705a09af30
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709395"
---
# <a name="allocating-a-connection-handle"></a><span data-ttu-id="b5c88-102">Allocation d'un handle de connexion</span><span class="sxs-lookup"><span data-stu-id="b5c88-102">Allocating a Connection Handle</span></span>
  <span data-ttu-id="b5c88-103">Pour que l'application puisse se connecter à une source de données ou à un pilote, elle doit auparavant allouer un handle de connexion.</span><span class="sxs-lookup"><span data-stu-id="b5c88-103">Before the application can connect to a data source or driver, it must allocate a connection handle.</span></span> <span data-ttu-id="b5c88-104">Pour ce faire, appelez **SQLAllocHandle** avec le paramètre *comme handletype* défini sur SQL_HANDLE_DBC et *InputHandle* pointant vers un handle d’environnement initialisé.</span><span class="sxs-lookup"><span data-stu-id="b5c88-104">This is done by calling **SQLAllocHandle** with the *HandleType* parameter set to SQL_HANDLE_DBC and *InputHandle* pointing to an initialized environment handle.</span></span>  
  
 <span data-ttu-id="b5c88-105">Les caractéristiques de la connexion sont contrôlées en définissant des attributs de connexion.</span><span class="sxs-lookup"><span data-stu-id="b5c88-105">The characteristics of the connection are controlled by setting connection attributes.</span></span> <span data-ttu-id="b5c88-106">Par exemple, étant donné que les transactions se produisent au niveau de la connexion, le niveau d'isolation de la transaction est un attribut de connexion.</span><span class="sxs-lookup"><span data-stu-id="b5c88-106">For example, because transactions occur at the connection level, the transaction isolation level is a connection attribute.</span></span> <span data-ttu-id="b5c88-107">De la même façon, le délai d'expiration de la connexion (c'est-à-dire le nombre de secondes s'écoulant avant l'expiration de la tentative de connexion) est un attribut de connexion.</span><span class="sxs-lookup"><span data-stu-id="b5c88-107">Similarly, the login time-out, or number of seconds to wait while trying to connect before timing out, is a connection attribute.</span></span>  
  
 <span data-ttu-id="b5c88-108">Les attributs de connexion sont définis avec [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md)et leurs paramètres actuels sont récupérés avec [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="b5c88-108">Connection attributes are set with [SQLSetConnectAttr](../native-client-odbc-api/sqlsetconnectattr.md), and their current settings are retrieved with [SQLGetConnectAttr](../native-client-odbc-api/sqlgetconnectattr.md).</span></span> <span data-ttu-id="b5c88-109">Si le pilote **SQLSetConnectAttr** est appelé avant une tentative de connexion, le gestionnaire de pilotes ODBC stocke les attributs dans sa structure de connexion et les définit dans le pilote dans le cadre du processus de connexion.</span><span class="sxs-lookup"><span data-stu-id="b5c88-109">If **SQLSetConnectAttr** is called before a connection is attempted, the ODBC Driver Manager stores the attributes in its connection structure and sets them in the driver as part of the connection process.</span></span> <span data-ttu-id="b5c88-110">Certains attributs de connexion doivent être définis avant toute tentative de connexion de l'application ; d'autres peuvent être définis une fois la connexion établie.</span><span class="sxs-lookup"><span data-stu-id="b5c88-110">Some connection attributes must be set before the application attempts to connect; others can be set after the connection has completed.</span></span> <span data-ttu-id="b5c88-111">Par exemple, SQL_ATTR_ODBC_CURSORS doit être défini avant l'établissement d'une connexion, mais SQL_ATTR_AUTOCOMMIT peut être défini une fois la connexion établie.</span><span class="sxs-lookup"><span data-stu-id="b5c88-111">For example, SQL_ATTR_ODBC_CURSORS must be set before a connection is made, but SQL_ATTR_AUTOCOMMIT can be set after connecting.</span></span>  
  
 <span data-ttu-id="b5c88-112">Les applications s'exécutant sur [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 ou version ultérieure peuvent améliorer leurs performances en réinitialisant la taille du paquet réseau du flux TDS (Tabular Data Stream).</span><span class="sxs-lookup"><span data-stu-id="b5c88-112">Applications running against [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] version 7.0 or later can sometimes improve their performance by resetting the tabular data stream (TDS) network packet size.</span></span> <span data-ttu-id="b5c88-113">La taille du paquet par défaut est définie au niveau du serveur avec la valeur 4 Ko.</span><span class="sxs-lookup"><span data-stu-id="b5c88-113">The default packet size is set at the server, at 4 KB.</span></span> <span data-ttu-id="b5c88-114">Une taille de paquet comprise entre 4 Ko et 8 Ko offre généralement les meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="b5c88-114">A packet size of 4 KB to 8 KB generally gives the best performance.</span></span> <span data-ttu-id="b5c88-115">Si les tests indiquent qu'une taille de paquet différente offre de meilleures performances, l'application peut réinitialiser la taille du paquet.</span><span class="sxs-lookup"><span data-stu-id="b5c88-115">If testing shows that it performs better with a different packet size, the application can reset the packet size.</span></span> <span data-ttu-id="b5c88-116">Les applications ODBC peuvent effectuer cette opération avant de se connecter en appelant **SQLSetConnectAttr** avec l’option SQL_ATTR_PACKET_SIZE.</span><span class="sxs-lookup"><span data-stu-id="b5c88-116">ODBC applications can do this before connecting by calling **SQLSetConnectAttr** with the SQL_ATTR_PACKET_SIZE option.</span></span> <span data-ttu-id="b5c88-117">Certaines applications fonctionnent mieux avec une taille de paquet plus grande, mais les gains en termes de performances sont généralement minimes pour les tailles de paquet supérieures à 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="b5c88-117">Some applications perform better with a larger packet size, but performance improvements are generally minimal for packet sizes larger than 8 KB.</span></span>  
  
 <span data-ttu-id="b5c88-118">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pilote ODBC native client possède un certain nombre d’attributs de connexion étendus qu’une application peut utiliser pour augmenter ses fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="b5c88-118">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver has a number of extended connection attributes that an application can use to increase its functionality.</span></span> <span data-ttu-id="b5c88-119">Certains de ces attributs contrôlent les mêmes options que celles qui peuvent être spécifiées dans les sources de données et qui sont utilisées pour remplacer n'importe quelle option définie dans une source de données.</span><span class="sxs-lookup"><span data-stu-id="b5c88-119">Some of these attributes control the same options that can be specified in data sources and used to override whatever option is set in a data source.</span></span> <span data-ttu-id="b5c88-120">Par exemple, si une application utilise des identificateurs entre guillemets, elle peut attribuer à l'attribut SQL_COPT_SS_QUOTED_IDENT spécifique au pilote la valeur SQL_QI_ON pour faire en sorte que cette option soit toujours définie indépendamment du paramètre dans une source de données quelconque.</span><span class="sxs-lookup"><span data-stu-id="b5c88-120">For example, if an application uses quoted identifiers, it can set the driver-specific attribute SQL_COPT_SS_QUOTED_IDENT to SQL_QI_ON to ensure this option is always set regardless of the setting in any data source.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b5c88-121">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b5c88-121">See Also</span></span>  
 [<span data-ttu-id="b5c88-122">Communication avec SQL Server &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="b5c88-122">Communicating with SQL Server &#40;ODBC&#41;</span></span>](communicating-with-sql-server-odbc.md)  
  
  
