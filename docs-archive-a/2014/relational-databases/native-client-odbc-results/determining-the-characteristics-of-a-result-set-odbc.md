---
title: Détermination des caractéristiques d’un jeu de résultats (ODBC) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- result sets [ODBC], characteristics
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- SQLDescribeCol function
- metadata [ODBC]
- SQLColAttribute function
- SQLNumResultCols function
ms.assetid: 90be414c-04b3-46c0-906b-ae7537989b7d
author: rothja
ms.author: jroth
ms.openlocfilehash: 5957092cdddfbcbce904d9a6483914672565d337
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603491"
---
# <a name="determining-the-characteristics-of-a-result-set-odbc"></a><span data-ttu-id="ffde5-102">Détermination des caractéristiques d'un jeu de résultats (ODBC)</span><span class="sxs-lookup"><span data-stu-id="ffde5-102">Determining the Characteristics of a Result Set (ODBC)</span></span>
  <span data-ttu-id="ffde5-103">Les métadonnées sont des données qui décrivent d'autres données.</span><span class="sxs-lookup"><span data-stu-id="ffde5-103">Metadata is data that describes other data.</span></span> <span data-ttu-id="ffde5-104">Par exemple, les métadonnées d'un jeu de résultats décrivent les caractéristiques de ce dernier, notamment le nombre de colonnes du jeu de résultats, les types de données de ces colonnes, leurs noms, leur précision, et si elles autorisent les valeurs Null.</span><span class="sxs-lookup"><span data-stu-id="ffde5-104">For example, result set metadata describes the characteristics of a result set, such as the number of columns in the result set, the data types of those columns, their names, precision, and nullability.</span></span>  
  
 <span data-ttu-id="ffde5-105">ODBC fournit des métadonnées aux applications via ses fonctions API de catalogue.</span><span class="sxs-lookup"><span data-stu-id="ffde5-105">ODBC supplies metadata to applications through its catalog API functions.</span></span> <span data-ttu-id="ffde5-106">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pilote ODBC Native Client implémente la plupart des fonctions de catalogue d’API ODBC en tant qu’appels à une [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] procédure de catalogue correspondante.</span><span class="sxs-lookup"><span data-stu-id="ffde5-106">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver implements many of the ODBC API catalog functions as calls to a corresponding [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] catalog procedure.</span></span>  
  
 <span data-ttu-id="ffde5-107">Les applications requièrent des métadonnées pour la plupart des opérations de jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="ffde5-107">Applications require metadata for most result set operations.</span></span> <span data-ttu-id="ffde5-108">Par exemple, l'application utilise le type de données d'une colonne pour déterminer le type de variable à lier à cette colonne.</span><span class="sxs-lookup"><span data-stu-id="ffde5-108">For example, the application uses the data type of a column to determine what kind of variable to bind to that column.</span></span> <span data-ttu-id="ffde5-109">Elle utilise la longueur d'octet d'une colonne de type caractère pour déterminer l'espace nécessaire à l'affichage des données à partir de cette colonne.</span><span class="sxs-lookup"><span data-stu-id="ffde5-109">It uses the byte length of a character column to determine how much space it must have to display data from that column.</span></span> <span data-ttu-id="ffde5-110">La façon dont une application détermine les métadonnées d'une colonne dépend du type de l'application.</span><span class="sxs-lookup"><span data-stu-id="ffde5-110">How an application determines the metadata for a column depends on the type of the application.</span></span>  
  
 <span data-ttu-id="ffde5-111">Les applications verticales utilisent en général des tables prédéfinies et effectuent des opérations prédéfinies sur ces tables.</span><span class="sxs-lookup"><span data-stu-id="ffde5-111">Vertical applications typically work with predefined tables and perform predefined operations on those tables.</span></span> <span data-ttu-id="ffde5-112">Dans la mesure où les métadonnées du jeu de résultats de ces applications sont définies avant même l'écriture de l'application, et comme elles sont contrôlées par le développeur, elles peuvent être codées de manière irréversible dans l'application.</span><span class="sxs-lookup"><span data-stu-id="ffde5-112">Because the result set metadata for such applications is defined before the application is even written and is controlled by the developer, it can be hard-coded into the application.</span></span> <span data-ttu-id="ffde5-113">Par exemple, si une colonne d'ID d'ordre est définie en tant qu'entier de 4 octets dans la source de données, l'application peut toujours lier un entier de 4 octets à cette colonne.</span><span class="sxs-lookup"><span data-stu-id="ffde5-113">For example, if an order ID column is defined as a 4-byte integer in the data source, the application can always bind a 4-byte integer to that column.</span></span> <span data-ttu-id="ffde5-114">Lorsque les métadonnées sont codées de manière irréversible dans l'application, une modification des tables utilisées par l'application implique en général une modification du code de l'application.</span><span class="sxs-lookup"><span data-stu-id="ffde5-114">When metadata is hard-coded in the application, a change to the tables used by the application generally implies a change to the application code.</span></span>  
  
 <span data-ttu-id="ffde5-115">Dans les applications génériques, en particulier les applications qui prennent en charge les requêtes ad hoc, les métadonnées des jeux de résultats qu'elles créent sont en général inconnues jusqu'au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="ffde5-115">In generic applications, especially applications that support ad hoc queries, the metadata of the result sets they create is typically unknown until run time.</span></span>  
  
 <span data-ttu-id="ffde5-116">Pour déterminer les caractéristiques d'un jeu de résultats, une application peut appeler :</span><span class="sxs-lookup"><span data-stu-id="ffde5-116">To determine the characteristics of a result set, an application can call:</span></span>  
  
-   <span data-ttu-id="ffde5-117">[SQLNumResultCols](../native-client-odbc-api/sqlnumresultcols.md) pour déterminer le nombre de colonnes retournées par une requête.</span><span class="sxs-lookup"><span data-stu-id="ffde5-117">[SQLNumResultCols](../native-client-odbc-api/sqlnumresultcols.md) to determine how many columns a request returned.</span></span>  
  
-   <span data-ttu-id="ffde5-118">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md) ou [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) pour décrire une colonne dans le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="ffde5-118">[SQLColAttribute](../native-client-odbc-api/sqlcolattribute.md) or [SQLDescribeCol](../native-client-odbc-api/sqldescribecol.md) to describe a column in the result set.</span></span>  
  
 <span data-ttu-id="ffde5-119">Une application bien conçue est écrite à partir de l'hypothèse selon laquelle le jeu de résultats est inconnu ; en outre, elle utilise les informations retournées par ces fonctions pour lier les colonnes dans le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="ffde5-119">A well-designed application is written with the assumption that the result set is unknown and uses the information returned by these functions to bind the columns in the result set.</span></span> <span data-ttu-id="ffde5-120">Une application peut appeler ces fonctions à tout moment, une fois qu'une instruction a été préparée ou exécutée.</span><span class="sxs-lookup"><span data-stu-id="ffde5-120">An application can call these functions at any time after a statement is prepared or executed.</span></span> <span data-ttu-id="ffde5-121">Toutefois, pour des performances optimales, une application doit appeler **SQLColAttribute**, **SQLDescribeCol**et **SQLNumResultCols** après l’exécution d’une instruction.</span><span class="sxs-lookup"><span data-stu-id="ffde5-121">However, for optimal performance, an application should call **SQLColAttribute**, **SQLDescribeCol**, and **SQLNumResultCols** after a statement is executed.</span></span>  
  
 <span data-ttu-id="ffde5-122">Vous pouvez avoir plusieurs appels simultanés pour des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="ffde5-122">You can have multiple concurrent calls for metadata.</span></span> <span data-ttu-id="ffde5-123">Les procédures du catalogue système sous-jacentes aux implémentations des API de catalogue ODBC peuvent être appelées par le pilote ODBC pendant qu'il utilise des curseurs côté serveur statiques.</span><span class="sxs-lookup"><span data-stu-id="ffde5-123">The system catalog procedures underlying the ODBC catalog API implementations can be called by the ODBC driver while it is using static server cursors.</span></span> <span data-ttu-id="ffde5-124">Cela permet aux applications de traiter de manière simultanée plusieurs appels aux fonctions de catalogue ODBC.</span><span class="sxs-lookup"><span data-stu-id="ffde5-124">This lets applications concurrently process multiple calls to ODBC catalog functions.</span></span>  
  
 <span data-ttu-id="ffde5-125">Si une application utilise un jeu de métadonnées particulier à plusieurs reprises, elle peut tirer parti de la mise en cache des informations dans des variables privées lors de leur obtention initiale.</span><span class="sxs-lookup"><span data-stu-id="ffde5-125">If an application uses a particular set of metadata more than one time, it will probably benefit from caching the information in private variables when it is first obtained.</span></span> <span data-ttu-id="ffde5-126">Cela évite d'appeler ultérieurement les fonctions de catalogue ODBC pour obtenir les mêmes informations en obligeant le pilote à effectuer des allers-retours au serveur.</span><span class="sxs-lookup"><span data-stu-id="ffde5-126">This prevents later calls to the ODBC catalog functions for the same information, which force the driver to make round trips to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ffde5-127">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ffde5-127">See Also</span></span>  
 [<span data-ttu-id="ffde5-128">Traitement des résultats &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="ffde5-128">Processing Results &#40;ODBC&#41;</span></span>](processing-results-odbc.md)  
  
  
