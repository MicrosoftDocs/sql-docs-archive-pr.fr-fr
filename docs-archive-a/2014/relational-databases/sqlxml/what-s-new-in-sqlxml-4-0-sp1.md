---
title: Nouveautés&#39;dans SQLXML 4,0 SP1 | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: reference
helpviewer_keywords:
- registry keys [SQLXML]
- SQLNCLI, SQLXML
- what's new [SQLXML]
- SQLXML, what's new
- migrating SQLXML applications
- redistributing SQLXML
- SQL Server Native Client, SQLXML
- side-by-side installations [SQLXML]
ms.assetid: 48f7720b-1705-402d-93ce-097ff1737877
author: rothja
ms.author: jroth
ms.openlocfilehash: 880937520385fbe6ce64be3fdfcbbf7d11c73741
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87696708"
---
# <a name="what39s-new-in-sqlxml-40-sp1"></a><span data-ttu-id="46920-102">Nouveautés&#39;dans SQLXML 4,0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-102">What&#39;s New in SQLXML 4.0 SP1</span></span>
  [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="46920-103">SQLXML 4.0 SP1 inclut différentes mises à jour et améliorations.</span><span class="sxs-lookup"><span data-stu-id="46920-103">SQLXML 4.0 SP1 includes various updates and enhancements.</span></span> <span data-ttu-id="46920-104">Cette rubrique résume les mises à jour et fournit, le cas échéant, des liens vers des pages contenant des informations plus détaillées.</span><span class="sxs-lookup"><span data-stu-id="46920-104">This topic summarizes the updates and provides links to more detailed information, where available.</span></span> <span data-ttu-id="46920-105">SQLXML 4.0 SP1 fournit des améliorations supplémentaires pour prendre en charge les nouveaux types de données présentés dans [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46920-105">SQLXML 4.0 SP1 provides additional enhancements to support the new data types introduced in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)].</span></span> <span data-ttu-id="46920-106">Cette rubrique traite des sujets suivants :</span><span class="sxs-lookup"><span data-stu-id="46920-106">This topic includes the following subjects:</span></span>  
  
-   <span data-ttu-id="46920-107">Installation de SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-107">Installing SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="46920-108">Problèmes liés à l'installation côte à côte</span><span class="sxs-lookup"><span data-stu-id="46920-108">Side-by-Side Installation Issues</span></span>  
  
-   <span data-ttu-id="46920-109">SQLXML 4.0 et MSXML</span><span class="sxs-lookup"><span data-stu-id="46920-109">SQLXML 4.0 and MSXML</span></span>  
  
-   <span data-ttu-id="46920-110">Redistribution de SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="46920-110">Redistributing SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="46920-111">Prise en charge de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client</span><span class="sxs-lookup"><span data-stu-id="46920-111">Support for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client</span></span>  
  
-   <span data-ttu-id="46920-112">Prise en charge des types de données introduits dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span><span class="sxs-lookup"><span data-stu-id="46920-112">Support for Data Types Introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]</span></span>  
  
-   <span data-ttu-id="46920-113">Modifications apportées au chargement en masse XML pour SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="46920-113">XML Bulk Load Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="46920-114">Modifications apportées aux clés de Registre pour SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="46920-114">Registry Key Changes for SQLXML 4.0</span></span>  
  
-   <span data-ttu-id="46920-115">Problèmes de migration</span><span class="sxs-lookup"><span data-stu-id="46920-115">Migration Issues</span></span>  
  
## <a name="installing-sqlxml-40-sp1"></a><span data-ttu-id="46920-116">Installation de SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-116">Installing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="46920-117">Avant [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], SQLXML 4.0 était fourni avec SQL Server et faisait partie de l'installation par défaut de toutes les versions de SQL Server, à l'exception de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="46920-117">Before [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], SQLXML 4.0 was released with SQL Server and was part of the default installation of all SQL Server versions except for SQL Server Express.</span></span> <span data-ttu-id="46920-118">À partir de [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], la dernière version de SQLXML (SQLXML 4.0 SP1) n'est plus incluse dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="46920-118">Starting with [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], the latest version of SQLXML (SQLXML 4.0 SP1) is no longer included in SQL Server.</span></span> <span data-ttu-id="46920-119">Pour installer SQLXML 4,0 SP1, téléchargez-le à partir de l' [emplacement d’installation de sqlxml 4,0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span><span class="sxs-lookup"><span data-stu-id="46920-119">To install SQLXML 4.0 SP1, download it from [Install Location for SQLXML 4.0 SP1](https://www.microsoft.com/download/details.aspx?id=30403).</span></span>  
  
 <span data-ttu-id="46920-120">Les fichiers SQLXML 4.0 SP1 sont installés à l'emplacement suivant :</span><span class="sxs-lookup"><span data-stu-id="46920-120">The SQLXML 4.0 SP1 files are installed in the following location:</span></span>  
  
 `%PROGRAMFILES%\SQLXML 4.0\`  
  
> [!NOTE]  
>  <span data-ttu-id="46920-121">Tous les paramètres du Registre appropriés pour SQLXML 4.0 sont définis dans le cadre de la procédure d'installation.</span><span class="sxs-lookup"><span data-stu-id="46920-121">All appropriate registry settings for SQLXML 4.0 are made as part of the installation process.</span></span>  
  
 <span data-ttu-id="46920-122">Pour permettre l'exécution des applications SQLXML 32 bits sous WOW64 (Windows on Windows64) sur les systèmes d'exploitation Windows 64 bits, exécutez le package SQLXML 4.0 SP1 64 bits, nommé sqlxml4.msi, qui se trouve sur le Centre de téléchargement.</span><span class="sxs-lookup"><span data-stu-id="46920-122">To allow 32-bit SQLXML applications to run under Windows on Windows (WOW64) on 64-bit Windows operating systems, run the 64-bit SQLXML 4.0 SP1 package, named sqlxml4.msi, which can be found on the Download Center.</span></span>  
  
#### <a name="uninstalling-sqlxml-40-sp1"></a><span data-ttu-id="46920-123">Désinstallation de SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-123">Uninstalling SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="46920-124">Il existe des clés de Registre partagées entre SQLXML 3.0 SP3, SQLXML 4.0 et SQLXML 4.0 SP1.</span><span class="sxs-lookup"><span data-stu-id="46920-124">Shared registry keys exist between SQLXML 3.0 SP3, SQLXML 4.0 and SQLXML 4.0 SP1.</span></span> <span data-ttu-id="46920-125">Si les versions ultérieures de SQLXML sont désinstallées sur le même ordinateur qui contient SQLXML 3.0 SP3, il est possible que vous deviez réinstaller SQLXML 3.0 SP3.</span><span class="sxs-lookup"><span data-stu-id="46920-125">If the later versions of SQLXML are uninstalled on the same computer which contains SQLXML 3.0 SP3, you might need to reinstall SQLXML 3.0 SP3.</span></span>  
  
## <a name="side-by-side-installation-issues"></a><span data-ttu-id="46920-126">Problèmes liés à l'installation côte à côte</span><span class="sxs-lookup"><span data-stu-id="46920-126">Side-by-Side Installation Issues</span></span>  
 <span data-ttu-id="46920-127">La procédure d'installation de SQLXML 4.0 ne supprime pas les fichiers installés par les versions antérieures de SQLXML.</span><span class="sxs-lookup"><span data-stu-id="46920-127">The installation process for SQLXML 4.0 does not remove the files that were installed by earlier versions of SQLXML.</span></span> <span data-ttu-id="46920-128">Par conséquent, les DLL de différentes installations de SQLXML avec des versions distinctes peuvent figurer sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="46920-128">Therefore, you can have DLLs for several different version-distinctive installations of SQLXML on your computer.</span></span> <span data-ttu-id="46920-129">Vous pouvez exécuter les installations côte à côte.</span><span class="sxs-lookup"><span data-stu-id="46920-129">You can run the installations side-by-side.</span></span> <span data-ttu-id="46920-130">SQLXML 4.0 inclut des PROGID dépendants et indépendants de la version.</span><span class="sxs-lookup"><span data-stu-id="46920-130">SQLXML 4.0 includes both version-independent and version-dependent PROGIDs.</span></span> <span data-ttu-id="46920-131">Toutes les applications de production doivent utiliser des PROGID dépendants de la version.</span><span class="sxs-lookup"><span data-stu-id="46920-131">All production applications should use version-dependent PROGIDs.</span></span>  
  
## <a name="sqlxml-40-sp1-and-msxml"></a><span data-ttu-id="46920-132">SQLXML 4.0 SP1 et MSXML</span><span class="sxs-lookup"><span data-stu-id="46920-132">SQLXML 4.0 SP1 and MSXML</span></span>  
 <span data-ttu-id="46920-133">SQLXML 4.0 n'installe pas MSXML.</span><span class="sxs-lookup"><span data-stu-id="46920-133">SQLXML 4.0 does not install MSXML.</span></span> <span data-ttu-id="46920-134">SQLXML 4.0 utilise MSXML 6.0, qui est installé dans le cadre de l'installation de [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="46920-134">SQLXML 4.0 uses MSXML 6.0, which is installed as part of the [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later installation.</span></span>  
  
## <a name="redistributing-sqlxml-40-sp1"></a><span data-ttu-id="46920-135">Redistribution de SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-135">Redistributing SQLXML 4.0 SP1</span></span>  
 <span data-ttu-id="46920-136">Vous pouvez distribuer SQLXML 4.0 SP1 en utilisant le package du programme d'installation redistribuable.</span><span class="sxs-lookup"><span data-stu-id="46920-136">You can distribute SQLXML 4.0 SP1 using the redistributable installer package.</span></span> <span data-ttu-id="46920-137">Une façon d'installer plusieurs packages dans ce qui paraît à l'utilisateur être une installation unique consiste à utiliser la technologie des programmes de chaînage et d'amorçage.</span><span class="sxs-lookup"><span data-stu-id="46920-137">One way to install multiple packages in what seems to the user to be a single installation is to use chainer and bootstrapper technology.</span></span> <span data-ttu-id="46920-138">Pour plus d'informations, consultez Création d'un package de programme d'amorçage personnalisé pour Visual Studio 2005 et Ajout de composants requis personnalisés.</span><span class="sxs-lookup"><span data-stu-id="46920-138">For more information, see Authoring a Custom Bootstrapper Package for Visual Studio 2005 and Adding Custom Prerequisites.</span></span>  
  
 <span data-ttu-id="46920-139">Si votre application vise une plateforme autre que celle sur laquelle elle a été développée, vous pouvez télécharger les versions de sqlncli.msi pour x64, Itanium et x86 à partir du Centre de téléchargement Microsoft.</span><span class="sxs-lookup"><span data-stu-id="46920-139">If your application targets a platform other than the one it was developed on, you can download versions of sqlncli.msi for x64, Itanium, and x86 from the Microsoft Download Center.</span></span>  
  
 <span data-ttu-id="46920-140">Il existe également des programmes d'installation de redistribution séparés pour MSXML 6.0 (msxml6.msi).</span><span class="sxs-lookup"><span data-stu-id="46920-140">There are also separate redistribution installation programs for MSXML 6.0 (msxml6.msi).</span></span> <span data-ttu-id="46920-141">Ceux-ci se trouvent sur le CD d'installation de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à l'emplacement suivant :</span><span class="sxs-lookup"><span data-stu-id="46920-141">These can be found on the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] installation CD in the following location:</span></span>  
  
 `%CD%\Setup\`  
  
 <span data-ttu-id="46920-142">Ces fichiers d'installation peuvent être utilisés pour installer MSXML 6.0 directement à partir du CD.</span><span class="sxs-lookup"><span data-stu-id="46920-142">These installation files can be used to install MSXML 6.0 directly from the CD.</span></span> <span data-ttu-id="46920-143">Ils peuvent également être utilisés pour redistribuer librement MSXML 6.0 et SQLXML 4.0 SP1 avec vos propres applications personnalisées.</span><span class="sxs-lookup"><span data-stu-id="46920-143">They can also be used to freely redistribute MSXML 6.0 along with SQLXML 4.0 SP1 with your own custom applications.</span></span>  
  
 <span data-ttu-id="46920-144">Vous devrez également redistribuer [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client si vous l'utilisez comme fournisseur de données avec votre application.</span><span class="sxs-lookup"><span data-stu-id="46920-144">You will also need to redistribute [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client if you are using it as the data provider with your application.</span></span> <span data-ttu-id="46920-145">Pour plus d’informations, consultez [Installation de SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="46920-145">For more information, see [Installing SQL Server Native Client](../native-client/applications/installing-sql-server-native-client.md).</span></span>  
  
## <a name="support-for-sql-server-native-client"></a><span data-ttu-id="46920-146">Prise en charge de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="46920-146">Support for SQL Server Native Client</span></span>  
 <span data-ttu-id="46920-147">SQLXML 4,0 prend en charge les fournisseurs SQLOLEDB et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="46920-147">SQLXML 4.0 supports both the SQLOLEDB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client providers.</span></span> <span data-ttu-id="46920-148">Nous vous recommandons d’utiliser la même version du [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur Native Client et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , car [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client est développé pour prendre en charge tous les nouveaux types de données fournis avec le serveur, tels que les `Date, Time` `DateTime2` `dateTimeOffset` types de données, et dans [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] et pris en charge par [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="46920-148">It is recommended that you use the same version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client provider and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] because [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is developed to support any new data types that ship in the server, such as the `Date, Time`, `DateTime2`, and `dateTimeOffset` data types in [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] and supported by [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="46920-149">Native Client est une technologie d'accès aux données qui a été introduite dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46920-149">Native Client is a data access technology that was introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="46920-150">Elle associe le fournisseur SQLOLEDB et le pilote SQLODBC dans une même bibliothèque de liens dynamiques (DLL), tout en proposant également de nouvelles fonctionnalités distinctes des composants MDAC (Microsoft Data Access Components).</span><span class="sxs-lookup"><span data-stu-id="46920-150">It combines the SQLOLEDB Provider and the SQLODBC Driver into one native dynamic link library (DLL), while also providing new functionality that is separate and distinct from the Microsoft Data Access Components (MDAC).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="46920-151">Native Client peut être utilisé pour créer des applications ou améliorer des applications existantes qui doivent tirer parti des fonctionnalités introduites dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] qui ne sont pas prises en charge par SQLOLEDB et SQLODBC dans MDAC et [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span><span class="sxs-lookup"><span data-stu-id="46920-151">Native Client can be used to create new applications or enhance existing applications that need to take advantage of features introduced in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that are not supported by SQLOLEDB and SQLODBC in MDAC and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows.</span></span> <span data-ttu-id="46920-152">Par exemple, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client est requis pour que des fonctionnalités SQLXML côté client, telles que FOR XML, puissent utiliser le type de données `xml`.</span><span class="sxs-lookup"><span data-stu-id="46920-152">For example, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client is required for client-side SQLXML features, such as FOR XML, to use the `xml` data type.</span></span> <span data-ttu-id="46920-153">Pour plus d’informations, consultez [mise en forme XML côté Client &#40;SQLXML 4,0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [utilisation d’ADO pour exécuter des requêtes SQLXML 4,0](using-ado-to-execute-sqlxml-4-0-queries.md)et [programmation de SQL Server Native Client](../native-client/sql-server-native-client-programming.md).</span><span class="sxs-lookup"><span data-stu-id="46920-153">For more information, see [Client-side XML Formatting &#40;SQLXML 4.0&#41;](formatting/client-side-xml-formatting-sqlxml-4-0.md), [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md), and [SQL Server Native Client Programming](../native-client/sql-server-native-client-programming.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="46920-154">SQLXML 4.0 n'assure pas une compatibilité descendante complète avec SQLXML 3.0.</span><span class="sxs-lookup"><span data-stu-id="46920-154">SQLXML 4.0 is not completely backward compatible with SQLXML 3.0.</span></span> <span data-ttu-id="46920-155">En raison de quelques résolutions de bogue et d'autres modifications fonctionnelles, en particulier la suppression de la prise en charge de l'interface ISAPI SQLXML, vous ne pouvez pas utiliser de répertoires virtuels IIS avec SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="46920-155">Because of some bug fixes and other functional changes, particularly the removal of SQLXML ISAPI support, you cannot use IIS virtual directories with SQLXML 4.0.</span></span> <span data-ttu-id="46920-156">Bien que la plupart des applications s'exécutent avec des modifications mineures, vous devez les tester avant de les mettre en production avec SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="46920-156">Although most applications will run with minor modifications, you must test them before putting them into production with SQLXML 4.0.</span></span>  
  
## <a name="support-for-data-types-introduced-in-sql-server-2005-and-sql-server-2008"></a><span data-ttu-id="46920-157">Prise en charge des types de données introduits dans SQL Server 2005 et SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="46920-157">Support for Data Types Introduced in SQL Server 2005 and SQL Server 2008</span></span>  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]<span data-ttu-id="46920-158">a introduit le `xml` type de données et SQLXML 4,0 prend en charge le `xml` type de données.</span><span class="sxs-lookup"><span data-stu-id="46920-158">introduced the `xml` data type, and SQLXML 4.0 supports the `xml` data type.</span></span> <span data-ttu-id="46920-159">Pour plus d’informations, consultez [prise en charge du type de données XML dans SQLXML 4,0](xml-data-type-support-in-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="46920-159">For more information, see [xml Data Type Support in SQLXML 4.0](xml-data-type-support-in-sqlxml-4-0.md).</span></span>  
  
 <span data-ttu-id="46920-160">Pour obtenir des exemples illustrant l'utilisation du type de données `xml` dans SQLXML lors du mappage de vues XML, du chargement en masse XML ou de l'exécution de codes de mise à jour XML, consultez les exemples fournis dans les rubriques suivantes.</span><span class="sxs-lookup"><span data-stu-id="46920-160">For examples of how to use the `xml` data type in SQLXML when mapping XML views, bulk loading XML or executing XML updategrams, refer to examples provided in the following topics.</span></span>  
  
-   [<span data-ttu-id="46920-161">Mappage par défaut d'éléments et d'attributs XSD à des tables et des colonnes</span><span class="sxs-lookup"><span data-stu-id="46920-161">Default Mapping of XSD Elements and Attributes to Tables and Columns</span></span>](../sqlxml-annotated-xsd-schemas-using/default-mapping-of-xsd-elements-and-attributes-to-tables-and-columns-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="46920-162">Insertion de données à l'aide de codes de mise à jour (updategrams) XML</span><span class="sxs-lookup"><span data-stu-id="46920-162">Inserting Data by Using XML Updategrams</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/updategrams/inserting-data-using-xml-updategrams-sqlxml-4-0.md)  
  
-   [<span data-ttu-id="46920-163">Exemples du chargement en masse de documents XML</span><span class="sxs-lookup"><span data-stu-id="46920-163">Examples of Bulk Loading XML Documents</span></span>](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/xml-bulk-load-examples-sqlxml-4-0.md)  
  
 [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]<span data-ttu-id="46920-164">a introduit `Date, Time` les `DateTime2` types de données, et **DateTimeOffset** .</span><span class="sxs-lookup"><span data-stu-id="46920-164">introduced the `Date, Time`, `DateTime2`, and **DateTimeOffset** data types.</span></span> <span data-ttu-id="46920-165">SQLXML 4.0 SP1 activera ces quatre nouveaux types de données sous la forme de types scalaires intégrés lors d'une utilisation avec le fournisseur OLE DB [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client (SQLNCLI11), fourni avec [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46920-165">SQLXML 4.0 SP1 will enable these four new data types as built-in scalar types when used with [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] Native Client OLE DB Provider (SQLNCLI11), which ships in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)].</span></span>  
  
## <a name="xml-bulk-load-changes-for-sqlxml-40-sp1"></a><span data-ttu-id="46920-166">Modifications apportées au chargement en masse XML pour SQLXML 4.0 SP1</span><span class="sxs-lookup"><span data-stu-id="46920-166">XML Bulk Load Changes for SQLXML 4.0 SP1</span></span>  
  
-   <span data-ttu-id="46920-167">Pour SQLXML 4,0, le champ de dépassement SchemaGen est créé à l’aide du `xml` type de données.</span><span class="sxs-lookup"><span data-stu-id="46920-167">For SQLXML 4.0, the SchemaGen overflow field is created using the `xml` data type.</span></span> <span data-ttu-id="46920-168">Pour plus d’informations, consultez [SQL Server modèle objet de chargement en masse XML](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span><span class="sxs-lookup"><span data-stu-id="46920-168">For more information, see [SQL Server XML Bulk Load Object Model](../sqlxml-annotated-xsd-schemas-xpath-queries/bulk-load-xml/sql-server-xml-bulk-load-object-model-sqlxml-4-0.md).</span></span>  
  
-   <span data-ttu-id="46920-169">Si vous avez précédemment créé des applications [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic et que vous souhaitez utiliser SQLXML 4.0, vous devez recompiler l'application avec une référence à Xblkld4.dll.</span><span class="sxs-lookup"><span data-stu-id="46920-169">If you have previously created [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic applications and you want to use SQLXML 4.0, you must recompile the application with reference to Xblkld4.dll.</span></span>  
  
-   <span data-ttu-id="46920-170">Pour les applications Visual Basic Scripting Edition, vous devez inscrire la DLL que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="46920-170">For Visual Basic Scripting Edition applications, you must register the DLL you want to use.</span></span> <span data-ttu-id="46920-171">Dans l'exemple suivant, si vous spécifiez des PROGID indépendants de la version, l'application dépend de la dernière DLL inscrite :</span><span class="sxs-lookup"><span data-stu-id="46920-171">In the following example, if you specify version-independent PROGIDs, the application depends on the last registered DLL:</span></span>  
  
    ```  
    set objBulkLoad = CreateObject("SQLXMLBulkLoad.SQLXMLBulkLoad")   
    ```  
  
    > [!NOTE]  
    >  <span data-ttu-id="46920-172">Le PROGID dépendant de la version est SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span><span class="sxs-lookup"><span data-stu-id="46920-172">The version-dependent PROGID is SQLXMLBulkLoad.SQLXMLBulkLoad.4.0.</span></span>  
  
## <a name="registry-key-changes-for-sqlxml-40"></a><span data-ttu-id="46920-173">Modifications apportées aux clés de Registre pour SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="46920-173">Registry Key Changes for SQLXML 4.0</span></span>  
 <span data-ttu-id="46920-174">Les clés de Registre ont été modifiées par rapport aux versions précédentes. Dans SQLXML 4.0, elles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="46920-174">In SQLXML 4.0, the registry keys have changed from the earlier releases to the following:</span></span>  
  
 <span data-ttu-id="46920-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span><span class="sxs-lookup"><span data-stu-id="46920-175">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\TemplateCacheSize</span></span>  
  
 <span data-ttu-id="46920-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span><span class="sxs-lookup"><span data-stu-id="46920-176">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSSQLServer\Client\SQLXML4\SchemaCacheSize</span></span>  
  
 <span data-ttu-id="46920-177">Vous devez modifier les paramètres si vous souhaitez que ces clés soient appliquées pour SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="46920-177">You must change the settings if you want these keys to be in effect for SQLXML 4.0.</span></span>  
  
 <span data-ttu-id="46920-178">De plus, SQLXML 4.0 introduit les clés de Registre suivantes :</span><span class="sxs-lookup"><span data-stu-id="46920-178">In addition, SQLXML 4.0 introduces the following registry keys:</span></span>  
  
-   `HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\ReportErrorsWithSQLInfo`  
  
     <span data-ttu-id="46920-179">Par défaut, SQLXML 4.0 retourne des informations d'erreur native fournies par OLE DB et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] au lieu d'une erreur SQLXML de niveau supérieur (comme cela était le cas dans les versions antérieures de SQLXML).</span><span class="sxs-lookup"><span data-stu-id="46920-179">By default, SQLXML 4.0 returns native error information provided by OLE DB and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instead of a high-level SQLXML error (as was the case in earlier versions of SQLXML).</span></span> <span data-ttu-id="46920-180">Si ce comportement ne vous convient pas, attribuez la valeur 0 à cette clé de Registre de type DWORD (la valeur par défaut est 1).</span><span class="sxs-lookup"><span data-stu-id="46920-180">If you do not want this behavior, the value of this registry key of type DWORD must be set to 0 (default is 1).</span></span>  
  
-   <span data-ttu-id="46920-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span><span class="sxs-lookup"><span data-stu-id="46920-181">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\FORXML_GenerateGUIDBraces</span></span>  
  
     <span data-ttu-id="46920-182">Par défaut, SQLXML retourne des valeurs GUID SQL Server sans accolades de délimitation.</span><span class="sxs-lookup"><span data-stu-id="46920-182">By default, SQLXML return SQL Server GUID values without the enclosing braces.</span></span> <span data-ttu-id="46920-183">Si vous souhaitez que la valeur GUID soit retournée avec les accolades (par exemple, {*some GUID*}), la valeur de cette clé de registre doit être définie sur 1 (la valeur par défaut est 0).</span><span class="sxs-lookup"><span data-stu-id="46920-183">If you want the GUID value returned with the braces (for example, {*some GUID*}), value of this registry key must be set to 1 (default is 0).</span></span>  
  
-   <span data-ttu-id="46920-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span><span class="sxs-lookup"><span data-stu-id="46920-184">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer\Client\SQLXML4\SQL2000CompatMode</span></span>  
  
     <span data-ttu-id="46920-185">Par défaut, lorsque l'analyseur XML charge les données, les espaces blancs sont normalisés selon les règles du langage XML 1.0.</span><span class="sxs-lookup"><span data-stu-id="46920-185">By default, when the XML parser loads the data, white spaces are normalized according to the XML 1.0 rules.</span></span> <span data-ttu-id="46920-186">Cela entraîne la perte de quelques espaces blancs dans vos données.</span><span class="sxs-lookup"><span data-stu-id="46920-186">This results in loss of some of the white space characters in your data.</span></span> <span data-ttu-id="46920-187">Par conséquent, la représentation textuelle de vos données peut ne pas être la même après l'analyse, bien que les données soient les mêmes sur le plan sémantique.</span><span class="sxs-lookup"><span data-stu-id="46920-187">Thus, the textual representation of your data may not be the same after parsing, although semantically the data is the same.</span></span>  
  
     <span data-ttu-id="46920-188">Cette clé est introduite pour que vous puissiez conserver les espaces blancs dans les données si vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="46920-188">This key is introduced so that you can choose to keep the white space characters in the data.</span></span> <span data-ttu-id="46920-189">Si vous ajoutez cette clé de Registre et que vous lui attribuez la valeur 0, les espaces blancs (saut de ligne, retour chariot et tabulation) dans le code XML sont retournés encodés en cas de valeurs d'attribut.</span><span class="sxs-lookup"><span data-stu-id="46920-189">If you add this registry key and set its value to 0, white space characters (LF, CR, and tab) in the XML are returned encoded in case of attribute values.</span></span> <span data-ttu-id="46920-190">En cas de valeurs d'élément, seul le retour chariot est retourné encodé.</span><span class="sxs-lookup"><span data-stu-id="46920-190">In case of element values, only CR is returned encoded.</span></span>  
  
     <span data-ttu-id="46920-191">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="46920-191">For example:</span></span>  
  
    ```  
    CREATE TABLE T( Col1 int, Col2 nvarchar(100));  
    GO  
    -- Insert data with tab, line feed and carriage return).  
    INSERT INTO T VALUES (1, 'This is a tab    . This is a line feed and CR   
     more text');  
    GO  
    -- Test this query (without the registry key).  
    SELECT * FROM T   
    FOR XML AUTO;  
    -- This is the result (no encoding of special characters).  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
    -- Now add registry key with value 0 and execute the query again.  
    -- Note the encoding for carriage return, line-feed and tab in the attribute value.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
      <T Col1="1"   
         Col2="This is a tab    . This is a line feed and CR   
     more text"/>  
    </r>  
  
    -- Update the query and specify ELEMENTS directive  
    SELECT * FROM T  
    FOR XML AUTO, ELEMENTS  
    -- Only the carriage return is returned encoded.  
    <?xml version="1.0" encoding="utf-8" ?>  
    <r>  
       <T>  
          <Col1>1</Col1>  
          <Col2>This is a tab    . This is a line feed and CR   
     more text</Col2>  
       </T>  
    </r>  
    ```  
  
## <a name="migration-issues"></a><span data-ttu-id="46920-192">Problèmes de migration</span><span class="sxs-lookup"><span data-stu-id="46920-192">Migration Issues</span></span>  
 <span data-ttu-id="46920-193">Les problèmes suivants peuvent affecter la migration de vos applications SQLXML héritées vers SQLXML 4.0.</span><span class="sxs-lookup"><span data-stu-id="46920-193">The following are issues that could impact migration of your legacy SQLXML applications to SQLXML 4.0.</span></span>  
  
### <a name="ado-and-sqlxml-40-queries"></a><span data-ttu-id="46920-194">Requêtes ADO et SQLXML 4.0</span><span class="sxs-lookup"><span data-stu-id="46920-194">ADO and SQLXML 4.0 Queries</span></span>  
 <span data-ttu-id="46920-195">Dans les versions antérieures de SQLXML, l'exécution de requêtes basées sur une URL à l'aide de répertoires virtuels IIS et du filtre ISAPI SQLXML était prise en charge.</span><span class="sxs-lookup"><span data-stu-id="46920-195">In earlier versions of SQLXML, support for URL-based query execution using IIS virtual directories and the SQLXML ISAPI filter was provided.</span></span> <span data-ttu-id="46920-196">Pour les applications qui utilisent SQLXML 4.0, cette prise en charge n'est plus offerte.</span><span class="sxs-lookup"><span data-stu-id="46920-196">For applications that use SQLXML 4.0, this support is no longer available.</span></span>  
  
 <span data-ttu-id="46920-197">Au lieu de cela, les requêtes, modèles et codes de mise à jour SQLXML peuvent être exécutées à l'aide des extensions SQLXML aux objets ADO (ActiveX Data Objects) qui ont été introduites pour la première fois dans Microsoft Data Access Components (MDAC) 2.6 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="46920-197">Instead, SQLXML queries, templates, and updategrams can be executed by using the SQLXML extensions to ActiveX Data Objects (ADO) first introduced in Microsoft Data Access Components (MDAC) 2.6 and later.</span></span>  
  
 <span data-ttu-id="46920-198">Pour plus d’informations, consultez [utilisation d’ADO pour exécuter des requêtes SQLXML 4,0](using-ado-to-execute-sqlxml-4-0-queries.md).</span><span class="sxs-lookup"><span data-stu-id="46920-198">For more information, see [Using ADO to Execute SQLXML 4.0 Queries](using-ado-to-execute-sqlxml-4-0-queries.md).</span></span>  
  
### <a name="supportability-for-sqlxml-30-isapi-and-data-types-introduced-in-sql-server-2005"></a><span data-ttu-id="46920-199">Prise en charge de l'interface ISAPI SQLXML 3.0 et des types de données introduits dans SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="46920-199">Supportability for SQLXML 3.0 ISAPI and Data Types Introduced in SQL Server 2005</span></span>  
 <span data-ttu-id="46920-200">Étant donné que la prise en charge d’ISAPI a été supprimée de SQLXML 4,0, si votre solution requiert les fonctionnalités de typage de données améliorées introduites dans, [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] telles que le [type](/sql/t-sql/xml/xml-transact-sql) de données XML ou les [types de données définis par l’utilisateur (UDT)](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) et l’accès Web, vous devez utiliser une autre solution telle que les [classes managées SQLXML](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) ou un autre type de gestionnaire HTTP, tel 2005 SQL Server que</span><span class="sxs-lookup"><span data-stu-id="46920-200">Because ISAPI support has been removed from SQLXML 4.0, if your solution requires the enhanced data typing features introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] such as the [xml data type](/sql/t-sql/xml/xml-transact-sql) or [user-defined data types (UDTs)](../../relational-databases/clr-integration-database-objects-user-defined-types/clr-user-defined-types.md) and Web-based access, you will need to use another solution such as [SQLXML managed classes](../sqlxml-annotated-xsd-schemas-xpath-queries/net-framework-classes/sqlxml-4-0-net-framework-support-managed-classes.md) or another type of HTTP handler, such as Native XML Web Services for SQL Server 2005.</span></span>  
  
 <span data-ttu-id="46920-201">Sinon, si vous n’avez pas besoin de ces extensions de type, vous pouvez continuer à utiliser SQLXML 3,0 pour vous connecter aux [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] installations de et [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46920-201">Alternately, if you do not require these type extensions, you can continue to use SQLXML 3.0 to connect to [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] installations.</span></span> <span data-ttu-id="46920-202">La prise en charge de l'interface ISAPI SQLXML 3.0 fonctionne avec ces versions ultérieures, mais elle ne prend pas en charge et ne reconnaît pas le type de données `xml` ou le type UDT introduit dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46920-202">The SQLXML 3.0 ISAPI support will work against these later versions but does not support or recognize the `xml` data type or UDT type support introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span>  
  
### <a name="xml-bulk-load-security-changes-for-temporary-files"></a><span data-ttu-id="46920-203">Modifications apportées à la sécurité du chargement en masse XML pour les fichiers temporaires</span><span class="sxs-lookup"><span data-stu-id="46920-203">XML Bulk Load Security Changes for Temporary Files</span></span>  
 <span data-ttu-id="46920-204">Pour SQLXML 4.0 et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], les autorisations sur les fichiers de chargement en masse XML sont accordées à l'utilisateur qui exécute l'opération de chargement en masse.</span><span class="sxs-lookup"><span data-stu-id="46920-204">For SQLXML 4.0 and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], XML Bulk Load file permissions are granted to the user executing the bulk load operation.</span></span> <span data-ttu-id="46920-205">Les autorisations en lecture et en écriture sont héritées du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="46920-205">Read and Write permissions are inherited from the file system.</span></span> <span data-ttu-id="46920-206">Dans les versions précédentes de SQLXML et de SQL Server, le chargement en masse XML sous SQLXML créait des fichiers temporaires qui n'étaient pas sécurisés et qui pouvaient être lus par n'importe qui.</span><span class="sxs-lookup"><span data-stu-id="46920-206">In previous releases of SQLXML and SQL Server, XML Bulk Load under SQLXML would create temporary files that were not secured and could be readable by anyone.</span></span>  
  
### <a name="migration-issues-for-client-side-for-xml"></a><span data-ttu-id="46920-207">Problèmes de migration pour FOR XML côté client</span><span class="sxs-lookup"><span data-stu-id="46920-207">Migration Issues for Client-Side FOR XML</span></span>  
 <span data-ttu-id="46920-208">En raison des modifications apportées au moteur d’exécution, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peut retourner des valeurs différentes dans les métadonnées d’une table de base, par rapport à la valeur retournée si la requête for XML a été exécutée sous [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="46920-208">Due to changes in the execution engine, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might return different values in the metadata for a base table than would be returned if the FOR XML query was executed under [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span></span> <span data-ttu-id="46920-209">Si cela se produit, la mise en forme côté client des résultats de la requête FOR XML aura une sortie différente selon la version sur laquelle la requête est exécutée.</span><span class="sxs-lookup"><span data-stu-id="46920-209">In cases where this occurs, client-side formatting of the FOR XML query results will have differing output depending on which version the query is run against.</span></span>  
  
 <span data-ttu-id="46920-210">Si une requête FOR XML est exécutée côté client à l'aide de SQLXML 3.0 sur une colonne de type de données `xml`, les données dans les résultats reviendront sous la forme d'une chaîne entièrement décomposée.</span><span class="sxs-lookup"><span data-stu-id="46920-210">If a FOR XML query is executed client-side using SQLXML 3.0 over an `xml` data type column, the data in the results will come back as a fully entitized string.</span></span> <span data-ttu-id="46920-211">Dans SQLXML 4.0, si [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client (SQLNCLI11) est spécifié en tant que fournisseur, les données seront retournées sous forme de données XML.</span><span class="sxs-lookup"><span data-stu-id="46920-211">In SQLXML 4.0, if the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client (SQLNCLI11) is specified as the provider, the data will be returned as XML.</span></span>  
  
  
