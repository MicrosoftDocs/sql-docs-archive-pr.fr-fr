---
title: Résoudre les problèmes de mémoire insuffisante | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: f855e931-7502-44bd-8a8b-b8543645c7f4
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: f5f57725d559b0cd62679550e2bb7c04dbd7e2bd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87604005"
---
# <a name="resolve-out-of-memory-issues"></a><span data-ttu-id="79d45-102">Résoudre les problèmes de mémoire insuffisante</span><span class="sxs-lookup"><span data-stu-id="79d45-102">Resolve Out Of Memory Issues</span></span>
  [!INCLUDE[hek_1](../../includes/hek-1-md.md)] <span data-ttu-id="79d45-103">, l' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="79d45-103">uses more memory and in different ways than does [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="79d45-104">Il est possible que la quantité de mémoire que vous avez installée et allouée pour [!INCLUDE[hek_2](../../includes/hek-2-md.md)] ne convienne plus à vos besoins croissants.</span><span class="sxs-lookup"><span data-stu-id="79d45-104">It is possible that the amount of memory you installed and allocated for [!INCLUDE[hek_2](../../includes/hek-2-md.md)] becomes inadequate for your growing needs.</span></span> <span data-ttu-id="79d45-105">Si c'est le cas, vous risquez de manquer de mémoire.</span><span class="sxs-lookup"><span data-stu-id="79d45-105">If so, you could run out of memory.</span></span> <span data-ttu-id="79d45-106">Cette rubrique explique les procédures à mettre en œuvre en cas d'insuffisance de mémoire.</span><span class="sxs-lookup"><span data-stu-id="79d45-106">This topic covers how to recover from an OOM situation.</span></span> <span data-ttu-id="79d45-107">Consultez [Analyse et dépannage de l’utilisation de mémoire](monitor-and-troubleshoot-memory-usage.md) pour des conseils pouvant vous aider à éviter de nombreuses situations d’épuisement de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="79d45-107">See [Monitor and Troubleshoot Memory Usage](monitor-and-troubleshoot-memory-usage.md) for guidance that can help you avoid many OOM situations.</span></span>  
  
## <a name="covered-in-this-topic"></a><span data-ttu-id="79d45-108">Thèmes abordés dans cette rubrique</span><span class="sxs-lookup"><span data-stu-id="79d45-108">Covered in this topic</span></span>  
  
|<span data-ttu-id="79d45-109">Rubrique</span><span class="sxs-lookup"><span data-stu-id="79d45-109">Topic</span></span>|<span data-ttu-id="79d45-110">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="79d45-110">Overview</span></span>|  
|-----------|--------------|  
| [<span data-ttu-id="79d45-111">Résoudre les problèmes de restauration de base de données en cas d'insuffisance de mémoire</span><span class="sxs-lookup"><span data-stu-id="79d45-111">Resolve database restore failures due to OOM</span></span>](#resolve-database-restore-failures-due-to-oom) |<span data-ttu-id="79d45-112">Explique la procédure à suivre si vous recevez le message d'erreur « Échec de l’opération de restauration pour la base de données ' *\<databaseName>* ' en raison d'une insuffisance de mémoire dans le pool de ressources ' *\<resourcePoolName>* ' ».</span><span class="sxs-lookup"><span data-stu-id="79d45-112">What to do if you get the error message, "Restore operation failed for database '*\<databaseName>*' due to insufficient memory in the resource pool '*\<resourcePoolName>*'."</span></span>|  
| [<span data-ttu-id="79d45-113">Résoudre les problèmes d'insuffisance de mémoire ayant un impact sur la charge de travail</span><span class="sxs-lookup"><span data-stu-id="79d45-113">Resolve impact of low memory or OOM conditions on the workload</span></span>](#resolve-impact-of-low-memory-or-oom-conditions-on-the-workload)|<span data-ttu-id="79d45-114">Explique la procédure à suivre si vous constatez que les problèmes d'insuffisance de mémoire ont un effet négatif sur les performances.</span><span class="sxs-lookup"><span data-stu-id="79d45-114">What to do if you find low memory issues are negatively impacting performance.</span></span>|  
| [<span data-ttu-id="79d45-115">Résoudre les échecs d'allocation de pages dus à une mémoire insuffisante alors qu'il y a suffisamment de mémoire à disposition</span><span class="sxs-lookup"><span data-stu-id="79d45-115">Resolve page allocation failures due to insufficient memory when sufficient memory is available</span></span>](#resolve-page-allocation-failures-due-to-insufficient-memory-when-sufficient-memory-is-available) |<span data-ttu-id="79d45-116">Explique la procédure à suivre si vous recevez le message d’erreur « Désactivation des allocations de pages pour la base de données ' *\<databaseName>* ' en raison d’une insuffisance de mémoire dans le pool de ressources ' *\<resourcePoolName>* '.</span><span class="sxs-lookup"><span data-stu-id="79d45-116">What to do if you get the error message, "Disallowing page allocations for database '*\<databaseName>*' due to insufficient memory in the resource pool '*\<resourcePoolName>*'.</span></span> <span data-ttu-id="79d45-117">... » lorsque la mémoire disponible est suffisante pour l’opération.</span><span class="sxs-lookup"><span data-stu-id="79d45-117">..." when available memory is sufficient for the operation.</span></span>|  
  
## <a name="resolve-database-restore-failures-due-to-oom"></a><span data-ttu-id="79d45-118">Résoudre les problèmes de restauration de base de données en cas d'insuffisance de mémoire</span><span class="sxs-lookup"><span data-stu-id="79d45-118">Resolve database restore failures due to OOM</span></span>  
 <span data-ttu-id="79d45-119">Lorsque vous tentez de restaurer une base de données, vous pouvez obtenir le message d’erreur suivant : « échec de l’opération de restauration pour la base de données » *\<databaseName>* en raison d’une insuffisance de mémoire dans le pool de ressources « *\<resourcePoolName>* ». Avant de pouvoir restaurer correctement la base de données, vous devez résoudre le problème de mémoire insuffisante en mettant davantage de mémoire à disposition.</span><span class="sxs-lookup"><span data-stu-id="79d45-119">When you attempt to restore a database you may get the error message: "Restore operation failed for database '*\<databaseName>*' due to insufficient memory in the resource pool '*\<resourcePoolName>*'." Before you can successfully restore the database you must resolve the insufficient memory issue by making more memory available.</span></span>  
  
 <span data-ttu-id="79d45-120">Pour résoudre un échec de récupération dû à une situation d'insuffisance de mémoire, augmentez la mémoire disponible à l'aide de tous les moyens à votre disposition afin de disposer temporairement d'une mémoire suffisante pour l'opération de récupération.</span><span class="sxs-lookup"><span data-stu-id="79d45-120">To resolve recovery failure due to OOM increase available memory using any or al of these means to temporarily increase memory available for the recovery operation.</span></span>  
  
-   <span data-ttu-id="79d45-121">Fermez temporairement les applications en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="79d45-121">Temporarily close running applications.</span></span>   
    <span data-ttu-id="79d45-122">En fermant une ou plusieurs applications en cours d’exécution, comme Visual Studio, Internet Explorer, OneNote et autres, vous mettez à disposition de l’opération de restauration la quantité de mémoire qu’elles utilisaient.</span><span class="sxs-lookup"><span data-stu-id="79d45-122">By closing one or more running applications, such as Visual Studio, Internet Explorer, OneNote, and others, you make the memory they were using available for the restore operation.</span></span> <span data-ttu-id="79d45-123">Vous pourrez les redémarrer à la fin de la restauration.</span><span class="sxs-lookup"><span data-stu-id="79d45-123">You can restart them following the successful restore.</span></span>  
  
-   <span data-ttu-id="79d45-124">Augmentez la valeur de MAX_MEMORY_PERCENT.</span><span class="sxs-lookup"><span data-stu-id="79d45-124">Increase the value of MAX_MEMORY_PERCENT.</span></span>   
    <span data-ttu-id="79d45-125">Cet extrait de code modifie la valeur de MAX_MEMORY_PERCENT pour le pool de ressources PoolHk à 70 % de la mémoire installée.</span><span class="sxs-lookup"><span data-stu-id="79d45-125">This code snippet changes MAX_MEMORY_PERCENT for the resource pool PoolHk to 70% of installed memory.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="79d45-126">Si le serveur s'exécute sur une machine virtuelle sans être dédié, attribuez à MIN_MEMORY_PERCENT et à MAX_MEMORY_PERCENT la même valeur.</span><span class="sxs-lookup"><span data-stu-id="79d45-126">If the server is running on a VM and is not dedicated, set the value of MIN_MEMORY_PERCENT to the same value as MAX_MEMORY_PERCENT.</span></span>   
    > <span data-ttu-id="79d45-127">Consultez la rubrique [Bonnes pratiques : Utilisation de l’OLTP en mémoire dans un environnement de machine virtuelle](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="79d45-127">See the topic [Best Practices: Using In-Memory OLTP in a VM environment](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) for more information.</span></span>  
  
    ```sql  
  
    -- disable resource governor  
    ALTER RESOURCE GOVERNOR DISABLE  
  
    -- change the value of MAX_MEMORY_PERCENT  
    ALTER RESOURCE POOL PoolHk  
    WITH  
         ( MAX_MEMORY_PERCENT = 70 )  
    GO  
  
    -- reconfigure the Resource Governor  
    --    RECONFIGURE enables resource governor  
    ALTER RESOURCE GOVERNOR RECONFIGURE  
    GO  
  
    ```  
  
     <span data-ttu-id="79d45-128">Pour plus d’informations sur les valeurs maximales pour MAX_MEMORY_PERCENT consultez la rubrique [pourcentage de mémoire disponible pour les index et les tables optimisés en mémoire](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#percent-of-memory-available-for-memory-optimized-tables-and-indexes) .</span><span class="sxs-lookup"><span data-stu-id="79d45-128">For information on maximum values for MAX_MEMORY_PERCENT see the topic section [Percent of memory available for memory-optimized tables and indexes](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#percent-of-memory-available-for-memory-optimized-tables-and-indexes)</span></span>
  
-   <span data-ttu-id="79d45-129">Reconfigurezz **max server memory**.</span><span class="sxs-lookup"><span data-stu-id="79d45-129">Reconfigure **max server memory**.</span></span>  
    <span data-ttu-id="79d45-130">Pour plus d’informations sur la configuration de **max server memory**, consultez la rubrique [Optimisation des performances du serveur à l’aide des options de configuration de la mémoire](https://technet.microsoft.com/library/ms177455\(v=SQL.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="79d45-130">For information on configuring **max server memory** see the topic [Optimizing Server Performance Using Memory Configuration Options](https://technet.microsoft.com/library/ms177455\(v=SQL.105\).aspx).</span></span>  
  
## <a name="resolve-impact-of-low-memory-or-oom-conditions-on-the-workload"></a><span data-ttu-id="79d45-131">Résoudre les problèmes d'insuffisance de mémoire ayant un impact sur la charge de travail</span><span class="sxs-lookup"><span data-stu-id="79d45-131">Resolve impact of low memory or OOM conditions on the workload</span></span>  
 <span data-ttu-id="79d45-132">Évidemment, il est préférable de ne pas se trouver dans une situation d'insuffisance de mémoire.</span><span class="sxs-lookup"><span data-stu-id="79d45-132">Obviously, it is best to not get into a low memory or OOM (Out of Memory) situation.</span></span> <span data-ttu-id="79d45-133">Une planification et une surveillance appropriées permettent souvent d'éviter ce type de problème.</span><span class="sxs-lookup"><span data-stu-id="79d45-133">Good planning and monitoring can help avoid OOM situations.</span></span> <span data-ttu-id="79d45-134">Néanmoins, même la meilleure des planifications ne suffit pas toujours pour anticiper ce qui va réellement se produire. Vous risquez donc d'être confronté à un problème d'insuffisance de mémoire à un moment ou un autre.</span><span class="sxs-lookup"><span data-stu-id="79d45-134">Still, the best planning does not always foresee what actually happens and you might end up with low memory or OOM.</span></span> <span data-ttu-id="79d45-135">Vous pouvez mettre fin à une situation d'insuffisance de mémoire en procédant aux deux étapes ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="79d45-135">There are two steps to recovering from OOM:</span></span>  
  
1.  [<span data-ttu-id="79d45-136">Ouvrir une connexion administrateur dédiée (DAC).</span><span class="sxs-lookup"><span data-stu-id="79d45-136">Open a DAC (Dedicated Administrator Connection)</span></span>](#open-a-dac-dedicated-administrator-connection) 
  
2.  [<span data-ttu-id="79d45-137">Prendre une mesure corrective</span><span class="sxs-lookup"><span data-stu-id="79d45-137">Take corrective action</span></span>](#take-corrective-action) 
  
### <a name="open-a-dac-dedicated-administrator-connection"></a><span data-ttu-id="79d45-138">Ouvrir une connexion administrateur dédiée (DAC).</span><span class="sxs-lookup"><span data-stu-id="79d45-138">Open a DAC (Dedicated Administrator Connection)</span></span>  
 <span data-ttu-id="79d45-139">Microsoft SQL Server propose une connexion administrateur dédiée (DAC).</span><span class="sxs-lookup"><span data-stu-id="79d45-139">Microsoft SQL Server provides a dedicated administrator connection (DAC).</span></span> <span data-ttu-id="79d45-140">Cette connexion DAC permet à un administrateur d’accéder à une instance active du moteur de base de données SQL Server afin de résoudre les problèmes sur le serveur, même si ce serveur ne répond pas aux autres connexions clientes.</span><span class="sxs-lookup"><span data-stu-id="79d45-140">The DAC allows an administrator to access a running instance of SQL Server Database Engine to troubleshoot problems on the server-even when the server is unresponsive to other client connections.</span></span> <span data-ttu-id="79d45-141">La connexion DAC est disponible via l'utilitaire `sqlcmd` et SQL Server Management Studio (SSMS).</span><span class="sxs-lookup"><span data-stu-id="79d45-141">The DAC is available through the `sqlcmd` utility and SQL Server Management Studio (SSMS).</span></span>  
  
 <span data-ttu-id="79d45-142">Pour obtenir des conseils sur l'utilisation de `sqlcmd` et de DAC, consultez [Utilisation d'une connexion administrateur dédiée](../../database-engine/configure-windows/diagnostic-connection-for-database-administrators.md).</span><span class="sxs-lookup"><span data-stu-id="79d45-142">For guidance on using `sqlcmd` and DAC see [Using a Dedicated Administrator Connection](../../database-engine/configure-windows/diagnostic-connection-for-database-administrators.md).</span></span> <span data-ttu-id="79d45-143">Pour obtenir des conseils sur l'utilisation de DAC via SSMS, consultez [Procédure : utiliser la connexion administrateur dédiée avec SQL Server Management Studio](https://msdn.microsoft.com/library/ms178068.aspx).</span><span class="sxs-lookup"><span data-stu-id="79d45-143">For guidance on using DAC through SSMS see [How to: Use the Dedicated Administrator Connection with SQL Server Management Studio](https://msdn.microsoft.com/library/ms178068.aspx).</span></span>  
  
### <a name="take-corrective-action"></a><span data-ttu-id="79d45-144">Prendre une mesure corrective</span><span class="sxs-lookup"><span data-stu-id="79d45-144">Take corrective action</span></span>  
 <span data-ttu-id="79d45-145">Pour résoudre une situation d'insuffisance de mémoire, vous devez libérer de la mémoire existante en réduisant son utilisation ou mettre plus de mémoire à la disposition de vos tables en mémoire.</span><span class="sxs-lookup"><span data-stu-id="79d45-145">To resolve your OOM condition you need to either free up existing memory by reducing usage, or make more memory available to your in-memory tables.</span></span>  
  
#### <a name="free-up-existing-memory"></a><span data-ttu-id="79d45-146">Libérer de la mémoire existante</span><span class="sxs-lookup"><span data-stu-id="79d45-146">Free up existing memory</span></span>  
  
##### <a name="delete-non-essential-memory-optimized-table-rows-and-wait-for-garbage-collection"></a><span data-ttu-id="79d45-147">Supprimer les lignes non essentielles des tables mémoire optimisées et patienter jusqu'au prochain garbage collection</span><span class="sxs-lookup"><span data-stu-id="79d45-147">Delete non-essential memory optimized table rows and wait for garbage collection</span></span>  
 <span data-ttu-id="79d45-148">Vous pouvez supprimer les lignes non essentielles d'une table mémoire optimisée.</span><span class="sxs-lookup"><span data-stu-id="79d45-148">You can remove non-essential rows from a memory optimized table.</span></span> <span data-ttu-id="79d45-149">Le garbage collector remet à disposition la mémoire utilisée par ces lignes.</span><span class="sxs-lookup"><span data-stu-id="79d45-149">The garbage collector returns the memory used by these rows to available memory.</span></span> <span data-ttu-id="79d45-150">.</span><span class="sxs-lookup"><span data-stu-id="79d45-150">.</span></span> <span data-ttu-id="79d45-151">Le moteur de l'OLTP en mémoire collecte les lignes à nettoyer de façon agressive.</span><span class="sxs-lookup"><span data-stu-id="79d45-151">In-memory OLTP engine collects garbage rows aggressively.</span></span> <span data-ttu-id="79d45-152">Cependant, une transaction longue peut empêcher cette opération de garbage collection.</span><span class="sxs-lookup"><span data-stu-id="79d45-152">However, a long running transaction can prevent garbage collection.</span></span> <span data-ttu-id="79d45-153">Par exemple, si une transaction s’exécute pendant 5 minutes, les versions de ligne créées par des opérations de mise à jour ou de suppression alors que la transaction était active ne peuvent pas être récupérées par le garbage collector.</span><span class="sxs-lookup"><span data-stu-id="79d45-153">For example, if you have a transaction that runs for 5 minutes, any row versions created due to update/delete operations while the transaction was active can't be garbage collected.</span></span>  
  
##### <a name="move-one-or-more-rows-to-a-disk-based-table"></a><span data-ttu-id="79d45-154">Déplacer une ou plusieurs lignes dans une table sur disque</span><span class="sxs-lookup"><span data-stu-id="79d45-154">Move one or more rows to a disk-based table</span></span>  
 <span data-ttu-id="79d45-155">Les articles TechNet suivants donnent des conseils pour déplacer des lignes d'une table mémoire optimisée vers une table sur disque.</span><span class="sxs-lookup"><span data-stu-id="79d45-155">The following TechNet articles provide guidance on moving rows from a memory-optimized table to a disk-based table.</span></span>  
  
-   <span data-ttu-id="79d45-156">[Partitionnement au niveau de l’application](https://technet.microsoft.com/library/dn296452\(v=sql.120\).aspx)</span><span class="sxs-lookup"><span data-stu-id="79d45-156">[Application-Level Partitioning](https://technet.microsoft.com/library/dn296452\(v=sql.120\).aspx)</span></span>  
  
-   <span data-ttu-id="79d45-157">[Modèle d’application pour partitionner des tables mémoire optimisées](https://technet.microsoft.com/library/dn133171\(v=sql.120\).aspx)</span><span class="sxs-lookup"><span data-stu-id="79d45-157">[Application Pattern for Partitioning Memory-Optimized Tables](https://technet.microsoft.com/library/dn133171\(v=sql.120\).aspx)</span></span>  
  
#### <a name="increase-available-memory"></a><span data-ttu-id="79d45-158">Augmenter la mémoire disponible</span><span class="sxs-lookup"><span data-stu-id="79d45-158">Increase available memory</span></span>  
  
##### <a name="increase-value-of-max_memory_percent-on-the-resource-pool"></a><span data-ttu-id="79d45-159">Augmenter la valeur de MAX_MEMORY_PERCENT sur le pool de ressources</span><span class="sxs-lookup"><span data-stu-id="79d45-159">Increase value of MAX_MEMORY_PERCENT on the resource pool</span></span>  
 <span data-ttu-id="79d45-160">Si vous n'avez pas créé de pool de ressources nommé pour les tables en mémoire, vous devez le faire et lier les bases de données de l' [!INCLUDE[hek_2](../../includes/hek-2-md.md)] à ce pool.</span><span class="sxs-lookup"><span data-stu-id="79d45-160">If you have not created a named resource pool for your in-memory tables you should do that and bind your [!INCLUDE[hek_2](../../includes/hek-2-md.md)] databases to it.</span></span> <span data-ttu-id="79d45-161">Consultez la rubrique [Lier une base de données avec des tables mémoire optimisées à un pool de ressources](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md) pour obtenir des conseils sur la création et la liaison de vos bases de données [!INCLUDE[hek_2](../../includes/hek-2-md.md)] à un pool de ressources.</span><span class="sxs-lookup"><span data-stu-id="79d45-161">See the topic [Bind a Database with Memory-Optimized Tables to a Resource Pool](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md) for guidance on creating and binding your [!INCLUDE[hek_2](../../includes/hek-2-md.md)] databases to a resource pool.</span></span>  
  
 <span data-ttu-id="79d45-162">Si votre base de données de l' [!INCLUDE[hek_2](../../includes/hek-2-md.md)] est liée à un pool de ressources, vous pouvez éventuellement augmenter le pourcentage de la mémoire à laquelle le pool peut accéder.</span><span class="sxs-lookup"><span data-stu-id="79d45-162">If your [!INCLUDE[hek_2](../../includes/hek-2-md.md)] database is bound to a resource pool you may be able to increase the percent of memory the pool can access.</span></span> <span data-ttu-id="79d45-163">Consultez la sous-rubrique [Modifier MIN_MEMORY_PERCENT et MAX_MEMORY_PERCENT sur un pool existant](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#change-min-memory-percent-and-max-memory-percent-on-an-existing-pool) pour obtenir des conseils sur la modification des valeurs MIN_MEMORY_PERCENT et MAX_MEMORY_PERCENT pour un pool de ressources.</span><span class="sxs-lookup"><span data-stu-id="79d45-163">See the sub-topic [Change MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT on an existing pool](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#change-min-memory-percent-and-max-memory-percent-on-an-existing-pool) for guidance on changing the value of MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT for a resource pool.</span></span>  
  
 <span data-ttu-id="79d45-164">Augmentez la valeur de MAX_MEMORY_PERCENT.</span><span class="sxs-lookup"><span data-stu-id="79d45-164">Increase the value of MAX_MEMORY_PERCENT.</span></span>   
<span data-ttu-id="79d45-165">Cet extrait de code modifie la valeur de MAX_MEMORY_PERCENT pour le pool de ressources PoolHk à 70 % de la mémoire installée.</span><span class="sxs-lookup"><span data-stu-id="79d45-165">This code snippet changes MAX_MEMORY_PERCENT for the resource pool PoolHk to 70% of installed memory.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="79d45-166">Si le serveur s'exécute sur une machine virtuelle sans être dédié, attribuez à MIN_MEMORY_PERCENT et à MAX_MEMORY_PERCENT la même valeur.</span><span class="sxs-lookup"><span data-stu-id="79d45-166">If the server is running on a VM and is not dedicated, set the value of MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT to the same value.</span></span>   
> <span data-ttu-id="79d45-167">Consultez la rubrique [Bonnes pratiques : Utilisation de l’OLTP en mémoire dans un environnement de machine virtuelle](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="79d45-167">See the topic [Best Practices: Using In-Memory OLTP in a VM environment](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) for more information.</span></span>  
  
```sql  
  
-- disable resource governor  
ALTER RESOURCE GOVERNOR DISABLE  
  
-- change the value of MAX_MEMORY_PERCENT  
ALTER RESOURCE POOL PoolHk  
WITH  
     ( MAX_MEMORY_PERCENT = 70 )  
GO  
  
-- reconfigure the Resource Governor  
--    RECONFIGURE enables resource governor  
ALTER RESOURCE GOVERNOR RECONFIGURE  
GO  
  
```  
  
 <span data-ttu-id="79d45-168">Pour plus d’informations sur les valeurs maximales de MAX_MEMORY_PERCENT, consultez la section [Pourcentage de mémoire disponible pour les tables et index mémoire optimisés](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#percent-of-memory-available-for-memory-optimized-tables-and-indexes).</span><span class="sxs-lookup"><span data-stu-id="79d45-168">For information on maximum values for MAX_MEMORY_PERCENT see the topic section [Percent of memory available for memory-optimized tables and indexes](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#percent-of-memory-available-for-memory-optimized-tables-and-indexes).</span></span>  
  
##### <a name="install-additional-memory"></a><span data-ttu-id="79d45-169">Installer de la mémoire supplémentaire</span><span class="sxs-lookup"><span data-stu-id="79d45-169">Install additional memory</span></span>  
 <span data-ttu-id="79d45-170">En fin de compte, la meilleure solution, le cas échéant, consiste à installer de la mémoire physique supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="79d45-170">Ultimately the best solution, if possible, is to install additional physical memory.</span></span> <span data-ttu-id="79d45-171">Si vous choisissez cette solution, souvenez-vous que vous pourrez sans doute augmenter également la valeur de MAX_MEMORY_PERCENT (consultez la sous-rubrique [Modifier MIN_MEMORY_PERCENT et MAX_MEMORY_PERCENT sur un pool existant](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#change-min-memory-percent-and-max-memory-percent-on-an-existing-pool)) dans la mesure où [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] n’aura probablement pas besoin de davantage de mémoire. Cela vous permettra d’optimiser cette opération si la nouvelle mémoire installée n’est pas disponible dans son intégralité pour le pool de ressources.</span><span class="sxs-lookup"><span data-stu-id="79d45-171">If you do this, remember that you will probably be able to also increase the value of MAX_MEMORY_PERCENT (see the sub-topic [Change MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT on an existing pool](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md#change-min-memory-percent-and-max-memory-percent-on-an-existing-pool)) since [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] won't likely need more memory, allowing you to make most if not all of the newly installed memory available to the resource pool.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="79d45-172">Si le serveur s'exécute sur une machine virtuelle sans être dédié, attribuez à MIN_MEMORY_PERCENT et à MAX_MEMORY_PERCENT la même valeur.</span><span class="sxs-lookup"><span data-stu-id="79d45-172">If the server is running on a VM and is not dedicated, set the value of MIN_MEMORY_PERCENT and MAX_MEMORY_PERCENT to the same value.</span></span>   
> <span data-ttu-id="79d45-173">Consultez la rubrique [Bonnes pratiques : Utilisation de l’OLTP en mémoire dans un environnement de machine virtuelle](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="79d45-173">See the topic [Best Practices: Using In-Memory OLTP in a VM environment](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md) for more information.</span></span>  
  
## <a name="resolve-page-allocation-failures-due-to-insufficient-memory-when-sufficient-memory-is-available"></a><span data-ttu-id="79d45-174">Résoudre les échecs d'allocation de pages dus à une mémoire insuffisante alors qu'il y a suffisamment de mémoire à disposition</span><span class="sxs-lookup"><span data-stu-id="79d45-174">Resolve page allocation failures due to insufficient memory when sufficient memory is available</span></span>  
 <span data-ttu-id="79d45-175">Si vous recevez le message d’erreur « désautorisation des allocations de pages pour la base de données » *\<databaseName>* en raison d’une mémoire insuffisante dans le pool de ressources « *\<resourcePoolName>* ».</span><span class="sxs-lookup"><span data-stu-id="79d45-175">If you get the error message, "Disallowing page allocations for database '*\<databaseName>*' due to insufficient memory in the resource pool '*\<resourcePoolName>*'.</span></span> <span data-ttu-id="79d45-176"><https://go.microsoft.com/fwlink/?LinkId=330673>Pour plus d’informations, consultez «».</span><span class="sxs-lookup"><span data-stu-id="79d45-176">See '<https://go.microsoft.com/fwlink/?LinkId=330673>' for more information."</span></span> <span data-ttu-id="79d45-177">dans le journal des erreurs lorsque la mémoire physique disponible est suffisante pour allouer la page, il peut être dû à la désactivation de Resource Governor.</span><span class="sxs-lookup"><span data-stu-id="79d45-177">in the error log when the available physical memory is sufficient to allocate the page, it may be due to a disabled Resource Governor.</span></span> <span data-ttu-id="79d45-178">Lorsque Resource Governor est désactivé, MEMORYBROKER_FOR_RESERVE induit une sollicitation de la mémoire artificielle.</span><span class="sxs-lookup"><span data-stu-id="79d45-178">When the Resource Governor is disabled MEMORYBROKER_FOR_RESERVE induces artificial memory pressure.</span></span>  
  
 <span data-ttu-id="79d45-179">Pour corriger le problème, vous devez activer Resource Governor.</span><span class="sxs-lookup"><span data-stu-id="79d45-179">To resolve this you need to enable the Resource Governor.</span></span>  
  
 <span data-ttu-id="79d45-180">Consultez [Activer Resource Governor](https://technet.microsoft.com/library/bb895149.aspx) pour obtenir des informations sur les limites et les restrictions, ainsi que sur l’activation de Resource Governor à l’aide de l’Explorateur d’objets, sur les propriétés de Resource Governor et sur Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="79d45-180">See [Enable Resource Governor](https://technet.microsoft.com/library/bb895149.aspx) for information on Limits and Restrictions as well as guidance on enabling Resource Governor using Object Explorer, Resource Governor properties, or Transact-SQL.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="79d45-181">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="79d45-181">See Also</span></span>  
 <span data-ttu-id="79d45-182">[Gestion de la mémoire pour l'OLTP en mémoire](../../database-engine/managing-memory-for-in-memory-oltp.md) </span><span class="sxs-lookup"><span data-stu-id="79d45-182">[Managing Memory for In-Memory OLTP](../../database-engine/managing-memory-for-in-memory-oltp.md) </span></span>  
 <span data-ttu-id="79d45-183">[Analyse et dépannage de l’utilisation de mémoire](monitor-and-troubleshoot-memory-usage.md) </span><span class="sxs-lookup"><span data-stu-id="79d45-183">[Monitor and Troubleshoot Memory Usage](monitor-and-troubleshoot-memory-usage.md) </span></span>  
 <span data-ttu-id="79d45-184">[Lier une base de données avec des tables mémoire optimisées à un pool de ressources](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md) </span><span class="sxs-lookup"><span data-stu-id="79d45-184">[Bind a Database with Memory-Optimized Tables to a Resource Pool](bind-a-database-with-memory-optimized-tables-to-a-resource-pool.md) </span></span>  
 [<span data-ttu-id="79d45-185">Meilleures pratiques : utilisation de l’OLTP en mémoire dans un environnement de machine virtuelle</span><span class="sxs-lookup"><span data-stu-id="79d45-185">Best Practices: Using In-Memory OLTP in a VM environment</span></span>](../../database-engine/using-in-memory-oltp-in-a-vm-environment.md)  
  
  
