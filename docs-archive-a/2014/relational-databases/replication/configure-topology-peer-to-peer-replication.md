---
title: Configurer la topologie (réplication d’égal à égal) | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
f1_keywords:
- sql12.rep.p2pwizard.peers.f1
ms.assetid: 5377c59f-2e25-4852-a306-c87ae3dca9fd
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2dfc09f5ae7f488afd46f29c301d11b7687e0a4b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600829"
---
# <a name="configure-topology-peer-to-peer-replication"></a><span data-ttu-id="cd6f4-102">Configurer la topologie (réplication d'égal à égal)</span><span class="sxs-lookup"><span data-stu-id="cd6f4-102">Configure Topology (Peer-to-Peer Replication)</span></span>
  <span data-ttu-id="cd6f4-103">Utilisez la page **Configurer la topologie** pour effectuer des tâches de configuration communes, telles que l'ajout de nouveaux nœuds, la suppression de nœuds et l'ajout de nouvelles connexions entre des nœuds existants.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-103">Use the **Configure topology** page to perform common configuration tasks, such as adding new nodes, deleting nodes, and adding new connections between existing nodes.</span></span> <span data-ttu-id="cd6f4-104">Le nœud que vous avez sélectionné dans la page **Publication** de cet Assistant s'affiche dans l'aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-104">The node you selected on the **Publication** page of this wizard is displayed on the design surface.</span></span> <span data-ttu-id="cd6f4-105">Pour spécifier des options de configuration, cliquez avec le bouton droit sur un nœud, une connexion ou l'aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-105">To specify configuration options, right-click a node, a connection, or the design surface.</span></span>

> [!NOTE]
>  <span data-ttu-id="cd6f4-106">L'Assistant Configurer la topologie d'égal à égal demande des informations de topologie lorsque l'Assistant est fermé.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-106">The Configure Peer to Peer Topology Wizard requests topology information when the wizard is closed.</span></span> <span data-ttu-id="cd6f4-107">Si l'Assistant est fermé et ouvert de nouveau avant que tous les nœuds répondent à la demande d'informations, l'Assistant peut afficher un réseau partiel.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-107">If the wizard is closed and reopened before all nodes respond to the request for information, the wizard might show a partial network.</span></span>

## <a name="options"></a><span data-ttu-id="cd6f4-108">Options</span><span class="sxs-lookup"><span data-stu-id="cd6f4-108">Options</span></span>
 <span data-ttu-id="cd6f4-109">La page **Configurer la topologie** contient des éléments d'interface et des options qui sont disponibles lorsque vous cliquez avec le bouton droit sur un élément.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-109">The **Configure topology** page contains interface elements and options that are available when you right-click an element.</span></span> <span data-ttu-id="cd6f4-110">Le tableau suivant décrit chaque élément d'interface.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-110">The following table describes each interface element.</span></span>

|<span data-ttu-id="cd6f4-111">Élément d'interface</span><span class="sxs-lookup"><span data-stu-id="cd6f4-111">Interface Element</span></span>|<span data-ttu-id="cd6f4-112">Description</span><span class="sxs-lookup"><span data-stu-id="cd6f4-112">Description</span></span>|
|-----------------------|-----------------|
|<span data-ttu-id="cd6f4-113">Aire de conception</span><span class="sxs-lookup"><span data-stu-id="cd6f4-113">Design surface</span></span>|<span data-ttu-id="cd6f4-114">Affiche d'autres éléments d'interface.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-114">Displays other interface elements.</span></span> <span data-ttu-id="cd6f4-115">Pour ajouter des éléments, cliquez avec le bouton droit sur l'aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-115">To add elements, right-click the design surface.</span></span>|
|<span data-ttu-id="cd6f4-116">![Premier nœud d’une topologie](media/p2pwizard-firstnode.gif "Premier nœud d’une topologie")</span><span class="sxs-lookup"><span data-stu-id="cd6f4-116">![The first node in a topology](media/p2pwizard-firstnode.gif "The first node in a topology")</span></span>|<span data-ttu-id="cd6f4-117">Nœud d'origine dans la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-117">The original node in the topology.</span></span> <span data-ttu-id="cd6f4-118">Les nouveaux nœuds sont initialisés grâce à une copie de la base de données de publication du nœud d'origine.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-118">New nodes are initialized by using a copy of the publication database from the original node.</span></span>|
|<span data-ttu-id="cd6f4-119">![Nœud pour lequel nous avons des informations complètes](media/p2pwizard-complete.gif "Nœud pour lequel nous avons des informations complètes") ou une version ultérieure, pour lesquelles la réplication a des informations complètes.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-119">![A node for which we have complete information](media/p2pwizard-complete.gif "A node for which we have complete information") or a later version, for which replication has complete information.</span></span> <span data-ttu-id="cd6f4-120">Pour spécifier des options de configuration, cliquez avec le bouton droit sur le nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-120">To specify configuration options, right-click the node.</span></span>|
|<span data-ttu-id="cd6f4-121">![Nœud pour lequel nous avons des informations incomplètes](media/p2pwizard-incomplete.gif "Nœud pour lequel nous avons des informations incomplètes")</span><span class="sxs-lookup"><span data-stu-id="cd6f4-121">![A node for which we have incomplete information](media/p2pwizard-incomplete.gif "A node for which we have incomplete information")</span></span>|<span data-ttu-id="cd6f4-122">Nœud sur lequel la réplication possède des informations incomplètes.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-122">A node for which replication has incomplete information.</span></span> <span data-ttu-id="cd6f4-123">Pour spécifier des options de configuration, cliquez avec le bouton droit sur le nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-123">To specify configuration options, right-click the node.</span></span> <span data-ttu-id="cd6f4-124">La réplication possède des informations incomplètes pour l'une des raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="cd6f4-124">Replication has incomplete information because of one of the following reasons:</span></span><br /><br /> <span data-ttu-id="cd6f4-125">Le nœud exécute une instance de [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] qui ne stocke pas toutes les métadonnées requises par l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-125">The node is running an instance of [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], which does not store all the metadata required by the wizard.</span></span><br /><br /> <span data-ttu-id="cd6f4-126">Le nœud exécute une version ultérieure de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], mais la réplication ne peut pas récupérer les informations d'abonnement du nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-126">The node is running a later version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], but replication cannot retrieve subscription information from the node.</span></span> <span data-ttu-id="cd6f4-127">Pour résoudre ce problème :</span><span class="sxs-lookup"><span data-stu-id="cd6f4-127">To troubleshoot this situation:</span></span><br /><span data-ttu-id="cd6f4-128">-Assurez-vous que la base de données au niveau du nœud est en ligne et que vous pouvez vous y connecter en utilisant les mêmes informations d’identification que les agents de distribution qui se connectent au nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-128">-Make sure that the database at the node is online and that you can connect to it by using the same credentials as the Distribution Agents that connect to the node.</span></span><br /><span data-ttu-id="cd6f4-129">-Assurez-vous que l’agent de lecture du journal et tous les agents de distribution qui se connectent au nœud sont en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-129">-Make sure that the Log Reader Agent and all Distribution Agents that connect to the node are running.</span></span><br /><span data-ttu-id="cd6f4-130">-Assurez-vous que le délai d’expiration de l’actualisation est suffisamment élevé pour collecter toutes les informations de topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-130">-Make sure that the refresh timeout is set high enough to gather all topology information.</span></span> <span data-ttu-id="cd6f4-131">Pour définir le délai, cliquez avec le bouton droit sur l'aire de conception, puis cliquez sur **Définir le délai d'actualisation**.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-131">To set the time-out, right-click the design surface, and click **Set Refresh Timeout**.</span></span>|
|<span data-ttu-id="cd6f4-132">Ligne grise avec des flèches</span><span class="sxs-lookup"><span data-stu-id="cd6f4-132">Gray line with arrows</span></span>|<span data-ttu-id="cd6f4-133">Connexion entre deux nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-133">The connection between two nodes.</span></span> <span data-ttu-id="cd6f4-134">Pour ajouter une connexion, cliquez avec le bouton droit sur l'un des nœuds que vous souhaitez connecter.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-134">To add a connection, right-click one of the nodes that you want to connect.</span></span> <span data-ttu-id="cd6f4-135">Pour supprimer une connexion, cliquez avec le bouton droit sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-135">To remove a connection, right-click the connection.</span></span><br /><br /> <span data-ttu-id="cd6f4-136">Si la ligne a une flèche unique, la réplication possède des informations incomplètes sur l'un des nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-136">If the line has a single arrow, replication has incomplete information for one of the nodes.</span></span>|

### <a name="options-for-the-design-surface"></a><span data-ttu-id="cd6f4-137">Options relatives à l'aire de conception</span><span class="sxs-lookup"><span data-stu-id="cd6f4-137">Options for the Design Surface</span></span>
 <span data-ttu-id="cd6f4-138">**Redessiner le graphique** Redessinez les objets sur l’aire de conception sans actualiser la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-138">**Redraw Graph** Redraw the objects on the design surface without refreshing the topology.</span></span> <span data-ttu-id="cd6f4-139">Le fait de redessiner peut fournir une meilleure vue de la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-139">Redrawing might provide a better view of the topology.</span></span>

 <span data-ttu-id="cd6f4-140">**Actualiser la topologie** Interrogez chaque nœud de la topologie et affichez les informations mises à jour sur chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-140">**Refresh Topology** Query each node in the topology, and display updated information about each node.</span></span> <span data-ttu-id="cd6f4-141">Si vous avez plusieurs nœuds, ce processus peut prendre plusieurs minutes.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-141">With many nodes, this process can take several minutes.</span></span>

 <span data-ttu-id="cd6f4-142">Si l'Assistant demande des informations de topologie et que vous fermez puis rouvrez l'Assistant avant que tous les nœuds répondent à la demande, cette page peut ne pas afficher tous les nœuds dans la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-142">If the wizard requests topology information, and then you close and reopen the wizard before all nodes respond to the request, this page might not display all nodes in the topology.</span></span>

 <span data-ttu-id="cd6f4-143">**Ajouter un nouveau nœud homologue** Ajoutez une instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à la topologie d’égal à égal.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-143">**Add a New Peer Node** Add an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the peer-to-peer topology.</span></span> <span data-ttu-id="cd6f4-144">L'ajout d'une instance en tant que nœud crée une publication au niveau de cette instance une fois l'Assistant terminé.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-144">Adding an instance as a node creates a publication at that instance after the wizard completes.</span></span> <span data-ttu-id="cd6f4-145">Après avoir ajouté le nœud, cliquez dessus avec le bouton droit pour ajouter une connexion entre le nouveau nœud et un nœud existant.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-145">After you add the node, right-click it to add a connection between the new node and an existing node.</span></span>

 <span data-ttu-id="cd6f4-146">Pour participer à une topologie d'égal à égal, l'instance doit remplir les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="cd6f4-146">To participate in a peer-to-peer topology, the instance must meet the following requirements:</span></span>

-   <span data-ttu-id="cd6f4-147">elle doit déjà être configurée en tant que serveur de distribution ou être associée à un serveur de distribution distant ;</span><span class="sxs-lookup"><span data-stu-id="cd6f4-147">It must already be configured as a Distributor or be associated with a remote Distributor.</span></span>

-   <span data-ttu-id="cd6f4-148">elle doit contenir une copie de la base de données impliquée dans la réplication</span><span class="sxs-lookup"><span data-stu-id="cd6f4-148">It must contain a copy of the database involved in replication.</span></span> <span data-ttu-id="cd6f4-149">(cette copie est généralement une sauvegarde restaurée de la base de données de publication d'origine).</span><span class="sxs-lookup"><span data-stu-id="cd6f4-149">This copy is typically a restored backup of the original publication database.</span></span>

 <span data-ttu-id="cd6f4-150">**Sélectionner le (s) nœud (s) à afficher** Sélectionnez les nœuds à afficher sur l’aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-150">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="cd6f4-151">Cette option est utile si la topologie possède un grand nombre de nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-151">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="cd6f4-152">N'oubliez pas que vous pouvez ajouter des connexions uniquement entre des nœuds qui sont visibles dans l'aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-152">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

 <span data-ttu-id="cd6f4-153">**Définir le délai d’actualisation** Spécifiez la durée pendant laquelle le processus d’actualisation peut s’exécuter avant l’expiration de l’opération.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-153">**Set Refresh Timeout** Specify how long the refresh process can run before the operation times out.</span></span>

### <a name="options-for-each-node"></a><span data-ttu-id="cd6f4-154">Options pour chaque nœud</span><span class="sxs-lookup"><span data-stu-id="cd6f4-154">Options for Each Node</span></span>
 <span data-ttu-id="cd6f4-155">**Ajouter une nouvelle connexion d’homologue** Ajoutez une connexion entre deux nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-155">**Add a New Peer Connection** Add a connection between two nodes.</span></span> <span data-ttu-id="cd6f4-156">Par exemple, si vous ajoutez une connexion entre un nœud A et un nœud B, la réplication ajoute deux abonnements : le premier autorise le nœud A à recevoir des modifications de la publication au niveau du nœud B, et le second autorise le nœud B à recevoir des modifications de la publication au niveau du nœud A.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-156">For example, if you add a connection between Node A and Node B, replication adds two subscriptions: The first enables Node A to receive changes from the publication at Node B, and the second enables Node B to receive changes from the publication at Node A.</span></span>

 <span data-ttu-id="cd6f4-157">**Supprimer le nœud homologue** Supprime un nœud de la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-157">**Delete Peer Node** Removes a node from the topology.</span></span> <span data-ttu-id="cd6f4-158">Par exemple, si vous supprimez le nœud C, la publication au niveau de ce nœud est supprimée.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-158">For example, if you remove Node C, the publication at that node is removed.</span></span> <span data-ttu-id="cd6f4-159">Les abonnements entre le nœud A et le nœud C sont aussi supprimés, de même qu'entre le nœud B et le nœud C.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-159">Subscriptions between Node A and Node C, and Node B and Node C are also removed.</span></span> <span data-ttu-id="cd6f4-160">La base de données au niveau du nœud C n'est pas supprimée, et la publication et la distribution ne sont pas désactivées.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-160">The database at Node C is not deleted, and publishing and distribution are not disabled.</span></span>

> [!NOTE]
>  <span data-ttu-id="cd6f4-161">Lorsque vous configurez la réplication d'égal à égal, vous spécifiez un ID pour chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-161">When you configure peer-to-peer replication, you specify an ID for each node.</span></span> <span data-ttu-id="cd6f4-162">Cet ID, qui doit être unique sur tous les nœuds de la topologie, est stocké dans la colonne originator_id de la table système [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="cd6f4-162">This ID, which must be unique across all nodes in the topology, is stored in the originator_id column in the [MSpeer_originatorid_history](/sql/relational-databases/system-tables/mspeer-originatorid-history-transact-sql) system table.</span></span> <span data-ttu-id="cd6f4-163">Si un nœud est supprimé de la topologie, l'ID est toujours conservé dans la table d'historique.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-163">If a node is removed from the topology, the ID is still retained in the history table.</span></span> <span data-ttu-id="cd6f4-164">L'ID est conservé pour empêcher de faux conflits d'avoir lieu si des modifications du nœud supprimé sont encore répliquées à travers la topologie.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-164">The ID is retained to prevent false conflicts from occurring if there are changes from the removed node that are still being replicated across the topology.</span></span> <span data-ttu-id="cd6f4-165">Si vous souhaitez réutiliser l'ID pour un nouveau nœud, vous devez tout d'abord supprimer manuellement l'ID de la table MSpeer_originatorid_history à tous les nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-165">If you want to reuse the ID for a new node, you must first manually delete the ID from the MSpeer_originatorid_history table at all nodes.</span></span> <span data-ttu-id="cd6f4-166">Avant de supprimer un ID pour un nœud, exécutez [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) pour vérifier que toutes les modifications apportées à partir de ce nœud ont été répliquées.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-166">Before you delete an ID for a node, execute [sp_requestpeerresponse](/sql/relational-databases/system-stored-procedures/sp-requestpeerresponse-transact-sql) to verify that all changes that originated from that node have been replicated.</span></span>

 <span data-ttu-id="cd6f4-167">**Se connecter à tous les nœuds affichés** Ajoute des connexions entre le nœud sélectionné et tous les autres nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-167">**Connect to ALL Displayed Nodes** Adds connections between the selected node and all other nodes.</span></span> <span data-ttu-id="cd6f4-168">Par exemple, si vous avez sélectionné cette option pour le nœud C dans une topologie à trois nœuds, la réplication ajoute quatre abonnements : deux qui autorisent les nœuds A et B à recevoir des modifications de la publication au niveau du nœud C, et deux qui autorisent le nœud C à recevoir des modifications des publications au niveau des nœuds A et B.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-168">For example, if you selected this option for Node C in a three node topology, replication adds four subscriptions: two that enable Node A and Node B to receive changes from the publication at Node C, and two that enable Node C to receive changes from the publications at Node A and Node B.</span></span>

 <span data-ttu-id="cd6f4-169">**Sélectionner le (s) nœud (s) à afficher** Sélectionnez les nœuds à afficher sur l’aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-169">**Select Node(s) to View** Select which nodes to view on the design surface.</span></span> <span data-ttu-id="cd6f4-170">Cette option est utile si la topologie possède un grand nombre de nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-170">This option is useful if the topology has a large number of nodes.</span></span> <span data-ttu-id="cd6f4-171">N'oubliez pas que vous pouvez ajouter des connexions uniquement entre des nœuds qui sont visibles dans l'aire de conception.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-171">Be aware that you can add connections only between nodes that are visible on the design surface.</span></span>

### <a name="options-for-the-connection-arrows"></a><span data-ttu-id="cd6f4-172">Options pour les flèches de connexion</span><span class="sxs-lookup"><span data-stu-id="cd6f4-172">Options for the Connection Arrows</span></span>
 <span data-ttu-id="cd6f4-173">**Supprimer la connexion homologue** Supprimer une connexion entre deux nœuds.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-173">**Remove Peer Connection** Remove a connection between two nodes.</span></span> <span data-ttu-id="cd6f4-174">Par exemple, si vous supprimez une connexion entre un nœud A et un nœud B, la réplication supprime deux abonnements : l'un qui autorise le nœud A à recevoir des modifications de la publication au niveau du nœud B, et l'autre qui autorise le nœud B à recevoir des modifications de la publication au niveau du nœud A.</span><span class="sxs-lookup"><span data-stu-id="cd6f4-174">For example, if you remove a connection between Node A and Node B, replication drops two subscriptions: the one that enables Node A to receive changes from the publication at Node B, and the one that enables Node B to receive changes from the publication at Node A.</span></span>

## <a name="see-also"></a><span data-ttu-id="cd6f4-175">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cd6f4-175">See Also</span></span>
 <span data-ttu-id="cd6f4-176">[Configurer la publication et la distribution](configure-publishing-and-distribution.md) [administration d’une topologie d’égal à égal &#40;la programmation Transact-SQL de la réplication&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [la réplication transactionnelle d’égal à égal](transactional/peer-to-peer-transactional-replication.md)</span><span class="sxs-lookup"><span data-stu-id="cd6f4-176">[Configure Publishing and Distribution](configure-publishing-and-distribution.md) [Administer a Peer-to-Peer Topology &#40;Replication Transact-SQL Programming&#41;](administration/administer-a-peer-to-peer-topology-replication-transact-sql-programming.md) [Peer-to-Peer Transactional Replication](transactional/peer-to-peer-transactional-replication.md)</span></span>


