---
title: Regrouper les modifications apportées à des lignes connexes à l’aide d’enregistrements logiques | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- merge replication logical records [SQL Server replication]
- articles [SQL Server replication], logical records
- logical records [SQL Server replication]
ms.assetid: ad76799c-4486-4b98-9705-005433041321
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 433e0edbe83d102e6002bd133f967f27a236f66e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599951"
---
# <a name="group-changes-to-related-rows-with-logical-records"></a><span data-ttu-id="309a7-102">Regrouper les modifications apportées à des lignes connexes à l'aide d'enregistrements logiques</span><span class="sxs-lookup"><span data-stu-id="309a7-102">Group Changes to Related Rows with Logical Records</span></span>
  
> [!NOTE]
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]

 <span data-ttu-id="309a7-103">Par défaut, la réplication de fusion traite les modifications de données ligne par ligne.</span><span class="sxs-lookup"><span data-stu-id="309a7-103">By default, merge replication processes data changes on a row-by-row basis.</span></span> <span data-ttu-id="309a7-104">Dans de nombreux cas, c'est parfaitement justifié mais pour certaines applications, il est primordial de traiter les lignes connexes en tant qu'unité.</span><span class="sxs-lookup"><span data-stu-id="309a7-104">In many circumstances this is appropriate, but for some applications, it is essential that related rows be processed as a unit.</span></span> <span data-ttu-id="309a7-105">La fonctionnalité d'enregistrements logiques de la réplication de fusion permet de définir une relation entre des lignes connexes de différentes tables afin que les lignes soient traitées en tant qu'unité.</span><span class="sxs-lookup"><span data-stu-id="309a7-105">The logical records feature of merge replication allows you to define a relationship between related rows in different tables so that the rows are processed as a unit.</span></span>

> [!NOTE]
>  <span data-ttu-id="309a7-106">Cette fonctionnalité peut être utilisée seule ou avec des filtres de jointure.</span><span class="sxs-lookup"><span data-stu-id="309a7-106">The logical records feature can be used alone or in conjunction with join filters.</span></span> <span data-ttu-id="309a7-107">Pour plus d'informations sur les filtres de jointure, consultez [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-107">For more information about join filters, see [Join Filters](join-filters.md).</span></span> <span data-ttu-id="309a7-108">Pour utiliser les enregistrements logiques, le niveau de compatibilité de la publication doit être au minimum égal à 90RTM.</span><span class="sxs-lookup"><span data-stu-id="309a7-108">To use logical records, the compatibility level of the publication must be at least 90RTM.</span></span>

 <span data-ttu-id="309a7-109">Prenons l'exemple des trois tables liées suivantes :</span><span class="sxs-lookup"><span data-stu-id="309a7-109">Consider these three related tables:</span></span>

 <span data-ttu-id="309a7-110">![Enregistrement logique impliquant trois tables, avec les noms de colonnes uniquement](../media/logical-records-01.gif "Enregistrement logique impliquant trois tables, avec les noms de colonnes uniquement")</span><span class="sxs-lookup"><span data-stu-id="309a7-110">![Three table logical record, with column names only](../media/logical-records-01.gif "Three table logical record, with column names only")</span></span>

 <span data-ttu-id="309a7-111">La table **Customers** est la table parent dans cette relation et possède une colonne clé primaire **CustID**.</span><span class="sxs-lookup"><span data-stu-id="309a7-111">The **Customers** table is the parent table in this relationship and has a primary key column **CustID**.</span></span> <span data-ttu-id="309a7-112">La table **Orders** possède une colonne clé primaire **OrderID**, avec une contrainte de clé étrangère sur la colonne **CustID** qui fait référence à la colonne **CustID** de la table **Customers** .</span><span class="sxs-lookup"><span data-stu-id="309a7-112">The **Orders** table has a primary key column **OrderID**, with a foreign key constraint on the **CustID** column that references the **CustID** column in the **Customers** table.</span></span> <span data-ttu-id="309a7-113">De la même façon, la table **OrderItems** possède une colonne clé primaire **OrderItemID**, avec une contrainte de clé étrangère sur la colonne **OrderID** qui fait référence à la colonne **OrderID** de la table **Orders** .</span><span class="sxs-lookup"><span data-stu-id="309a7-113">Similarly, the **OrderItems** table has a primary key column **OrderItemID**, with a foreign key constraint on the **OrderID** column that references the **OrderID** column in the **Orders** table.</span></span>

 <span data-ttu-id="309a7-114">Dans cet exemple, un enregistrement logique est constitué de toutes les lignes de la table **Orders** associées à une valeur **CustID** unique et de toutes les lignes de la table **OrderItems** associées aux lignes de la table **Orders** .</span><span class="sxs-lookup"><span data-stu-id="309a7-114">In this example, a logical record consists of all the rows in the **Orders** table that are related to a single **CustID** value and all of the rows in the **OrderItems** table that are related to those rows in the **Orders** table.</span></span> <span data-ttu-id="309a7-115">Ce diagramme illustre toutes les lignes des trois tables figurant dans l'enregistrement logique de Customer2 :</span><span class="sxs-lookup"><span data-stu-id="309a7-115">This diagram shows all the rows in the three tables that are in the logical record for Customer2:</span></span>

 <span data-ttu-id="309a7-116">![Enregistrement logique impliquant trois tables avec valeurs](../media/logical-records-02.gif "Enregistrement logique impliquant trois tables avec valeurs")</span><span class="sxs-lookup"><span data-stu-id="309a7-116">![Three table logical record with values](../media/logical-records-02.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="309a7-117">Pour définir une relation d'enregistrement logique entre articles, consultez [Définir une relation d'enregistrement logique entre des articles de table de fusion](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-117">To define a logical record relationship between articles, see [Define a Logical Record Relationship Between Merge Table Articles](../publish/define-a-logical-record-relationship-between-merge-table-articles.md).</span></span>

## <a name="benefits-of-logical-records"></a><span data-ttu-id="309a7-118">Avantages des enregistrements logiques</span><span class="sxs-lookup"><span data-stu-id="309a7-118">Benefits of Logical Records</span></span>
 <span data-ttu-id="309a7-119">La fonctionnalité des enregistrements logiques possède essentiellement deux avantages :</span><span class="sxs-lookup"><span data-stu-id="309a7-119">The logical records feature has two primary benefits:</span></span>

-   <span data-ttu-id="309a7-120">Application des modifications de données en tant qu'unité.</span><span class="sxs-lookup"><span data-stu-id="309a7-120">Application of data changes as a unit.</span></span>

-   <span data-ttu-id="309a7-121">Détection et résolution de conflits simultanément sur plusieurs lignes de plusieurs tables.</span><span class="sxs-lookup"><span data-stu-id="309a7-121">The detection and resolution of conflicts simultaneously on multiple rows from multiple tables.</span></span>

### <a name="the-application-of-changes-as-a-unit"></a><span data-ttu-id="309a7-122">Application des modifications en tant qu'unité</span><span class="sxs-lookup"><span data-stu-id="309a7-122">The Application of Changes As a Unit</span></span>
 <span data-ttu-id="309a7-123">Si le traitement de fusion est interrompu, par exemple en cas d'abandon de la connexion, le jeu partiellement exécuté de modifications répliquées liées est restauré lorsque vous utilisez les enregistrements logiques.</span><span class="sxs-lookup"><span data-stu-id="309a7-123">If merge processing is interrupted, such as in the case of a dropped connection, the partially completed set of related replicated changes is rolled back if logical records are used.</span></span> <span data-ttu-id="309a7-124">Prenons l'exemple d'un Abonné qui ajoute une nouvelle commande ( **OrderID** = 6) et deux nouvelles lignes dans la table **OrderItems** ( **OrderItemID** = 10 et **OrderItemID** = 11) pour **OrderID** = 6.</span><span class="sxs-lookup"><span data-stu-id="309a7-124">For example, consider the case where a Subscriber adds a new order with **OrderID** = 6 and two new rows in the **OrderItems** table with **OrderItemID** = 10 and **OrderItemID** = 11 for **OrderID** = 6.</span></span>

 <span data-ttu-id="309a7-125">![Enregistrement logique impliquant trois tables avec valeurs](../media/logical-records-04.gif "Enregistrement logique impliquant trois tables avec valeurs")</span><span class="sxs-lookup"><span data-stu-id="309a7-125">![Three table logical record with values](../media/logical-records-04.gif "Three table logical record with values")</span></span>

 <span data-ttu-id="309a7-126">Si le processus de réplication est interrompu après l'exécution de la ligne **Orders** de **OrderID** = 6 mais avant la fin de l'exécution de **OrderItems** 10 et 11 et que vous n'utilisez pas les enregistrements logiques, la valeur **OrderTotal** pour **OrderID** = 6 ne correspondra pas à la somme des valeurs **OrderAmount** des lignes **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="309a7-126">If the replication process is interrupted after the **Orders** row for **OrderID** = 6 is complete, but before the **OrderItems** 10 and 11 are completed, and logical records are not used, the **OrderTotal** value for **OrderID** = 6 will not be consistent with the sum of the **OrderAmount** values for the **OrderItems** rows.</span></span> <span data-ttu-id="309a7-127">Si vous utilisez les enregistrements logiques, la ligne **Orders** de **OrderID** = 6 n'est pas validée tant que les modifications de **OrderItems** liées ne sont pas répliquées.</span><span class="sxs-lookup"><span data-stu-id="309a7-127">If logical records are used, the **Orders** row for **OrderID** = 6 is not committed until the related **OrderItems** changes are replicated.</span></span>

 <span data-ttu-id="309a7-128">Dans un autre scénario, si les enregistrements logiques sont utilisés et qu'un utilisateur interroge les tables pendant l'application de modifications par le processus de fusion, il ne voit les modifications partiellement répliquées qu'à partir du moment où elles sont toutes terminées.</span><span class="sxs-lookup"><span data-stu-id="309a7-128">In a different scenario, if logical records are used, and someone is querying tables when the merge process is applying changes, the user will not see the partially replicated changes until they are all complete.</span></span> <span data-ttu-id="309a7-129">Imaginons que le processus de réplication a téléchargé la ligne Orders de **OrderID** = 6 mais qu'un utilisateur interroge les tables avant que le processus de réplication ait répliqué les lignes **OrderItems** : la valeur de **OrderTotal** ne correspondra pas à la somme des valeurs de **OrderAmount** .</span><span class="sxs-lookup"><span data-stu-id="309a7-129">For example, the replication process has uploaded the Orders row for **OrderID** = 6, but a user queries the tables before the replication process has replicated the **OrderItems** rows, the **OrderTotal** value would not be the same as the sum of the **OrderAmount** values.</span></span> <span data-ttu-id="309a7-130">Si vous utilisez des enregistrements logiques, la ligne **Orders** ne sera pas visible tant que les lignes **OrderItems** ne sont pas terminées et que la transaction n'a pas été validée en tant qu'unité.</span><span class="sxs-lookup"><span data-stu-id="309a7-130">If logical records are used, the **Orders** row would not be visible until the **OrderItems** rows are complete and the transaction has been committed as a unit.</span></span>

### <a name="the-application-of-conflict-handling-to-more-than-one-table"></a><span data-ttu-id="309a7-131">Application de la gestion des conflits à plusieurs tables</span><span class="sxs-lookup"><span data-stu-id="309a7-131">The Application of Conflict Handling to More Than One Table</span></span>
 <span data-ttu-id="309a7-132">Envisageons le cas où deux Abonnés disposent du dataset ci-dessus :</span><span class="sxs-lookup"><span data-stu-id="309a7-132">Consider the case where two Subscribers have the data set above:</span></span>

-   <span data-ttu-id="309a7-133">Un utilisateur du premier Abonné remplace la valeur 100 figurant dans **OrderAmount** de **OrderItemID** 5 par 150 et la valeur 200 figurant dans **OrderTotal** de **OrderID** 3 par 250.</span><span class="sxs-lookup"><span data-stu-id="309a7-133">A user at the first Subscriber changes the **OrderAmount** of **OrderItemID** 5 from 100 to 150 and the **OrderTotal** of **OrderID** 3 from 200 to 250.</span></span>

-   <span data-ttu-id="309a7-134">Un utilisateur du deuxième Abonné remplace la valeur 25 figurant dans **OrderAmount** de **OrderItemID** 6 par 125 et la valeur 200 figurant dans **OrderTotal** de **OrderID** 3 par 300.</span><span class="sxs-lookup"><span data-stu-id="309a7-134">A user at the second Subscriber changes the **OrderAmount** of **OrderItemID** 6 from 25 to 125 and the **OrderTotal** of **OrderID** 3 from 200 to 300.</span></span>

 <span data-ttu-id="309a7-135">Si ces modifications sont répliquées sans utiliser d'enregistrement logique, les différentes valeurs de **OrderTotal** se traduisent par un conflit et seule l'une d'elles est répliquée.</span><span class="sxs-lookup"><span data-stu-id="309a7-135">If these changes are replicated without using logical records, the different **OrderTotal** values would result in a conflict and only one of them would be replicated.</span></span> <span data-ttu-id="309a7-136">Mais les modifications non conflictuelles apportées à la table **OrderItems** seront répliquées sans conflit, avec pour conséquence une incohérence des valeurs finales de **OrderTotal** par rapport aux lignes **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="309a7-136">But the non-conflicting changes in the **OrderItems** table would be replicated without conflict, leaving the final **OrderTotal** values in an inconsistent state with respect to the **OrderItems** rows.</span></span> <span data-ttu-id="309a7-137">Si vous utilisez des enregistrements logiques dans ce scénario, la modification de **OrderItems** associée à la modification perdante de la table **Orders** sera également restaurée et la valeur finale de **OrderTotal** représentera la synthèse exacte des lignes **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="309a7-137">If logical records are used in this scenario, the **OrderItems** change associated with the losing **Orders** table change would also be rolled back, and the final **OrderTotal** value would be an accurate summary of the **OrderItems** rows.</span></span>

 <span data-ttu-id="309a7-138">Pour plus d’informations sur la détection et la résolution des conflits avec des enregistrements logiques, consultez [Détection et résolution des conflits dans les enregistrements logiques](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-138">For more information about options related to conflict detection and resolution with logical records, see [Detecting and Resolving Conflicts in Logical Records](advanced-merge-replication-conflict-resolving-in-logical-record.md).</span></span>

## <a name="considerations-for-using-logical-records"></a><span data-ttu-id="309a7-139">Considérations sur l'utilisation des enregistrements logiques</span><span class="sxs-lookup"><span data-stu-id="309a7-139">Considerations for Using Logical Records</span></span>
 <span data-ttu-id="309a7-140">Les éléments suivants doivent être pris en compte lors de l'utilisation d'enregistrements logiques.</span><span class="sxs-lookup"><span data-stu-id="309a7-140">Keep the following considerations in mind when using logical records.</span></span>

### <a name="general-considerations"></a><span data-ttu-id="309a7-141">Considérations d’ordre général</span><span class="sxs-lookup"><span data-stu-id="309a7-141">General Considerations</span></span>

-   <span data-ttu-id="309a7-142">Il est recommandé de limiter au maximum le nombre de tables dans un enregistrement logique : cinq tables ou moins.</span><span class="sxs-lookup"><span data-stu-id="309a7-142">It is recommended that you keep the number of tables in a logical record as low as possible; five tables or less is recommended.</span></span>

-   <span data-ttu-id="309a7-143">Les enregistrements logiques ne peuvent pas référencer des colonnes contenant l'un des types de données suivants :</span><span class="sxs-lookup"><span data-stu-id="309a7-143">Logical records cannot reference columns with any of the following data types:</span></span>

    -   <span data-ttu-id="309a7-144">`varchar(max)` et `nvarchar(max)`</span><span class="sxs-lookup"><span data-stu-id="309a7-144">`varchar(max)` and `nvarchar(max)`</span></span>

    -   `varbinary(max)`

    -   <span data-ttu-id="309a7-145">`text` et `ntext`</span><span class="sxs-lookup"><span data-stu-id="309a7-145">`text` and `ntext`</span></span>

    -   `image`

    -   `XML`

    -   `UDT`

-   <span data-ttu-id="309a7-146">Les relations de clé étrangère dans les tables publiées ne peuvent pas être définies avec l'option CASCADE.</span><span class="sxs-lookup"><span data-stu-id="309a7-146">Foreign key relationships in published tables cannot be defined with the CASCADE option.</span></span> <span data-ttu-id="309a7-147">Pour plus d’informations, consultez [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) et [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="309a7-147">For more information, see [CREATE TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql) and [ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql).</span></span>

-   <span data-ttu-id="309a7-148">Vous ne pouvez pas mettre à jour des colonnes utilisées dans la clause de relation logique.</span><span class="sxs-lookup"><span data-stu-id="309a7-148">You cannot update any columns that are used in the logical relation clause.</span></span>

-   <span data-ttu-id="309a7-149">La résolution de conflits personnalisée avec des gestionnaires de logique métier ou des outils de résolution personnalisés n'est pas prise en charge pour les articles inclus dans un enregistrement logique.</span><span class="sxs-lookup"><span data-stu-id="309a7-149">Custom conflict resolution with business logic handlers or custom resolvers is not supported for articles that are included in a logical record.</span></span>

-   <span data-ttu-id="309a7-150">Si des enregistrements logiques sont utilisés dans une publication qui comprend des filtres paramétrés, vous devez initialiser chaque Abonné avec un instantané de sa partition.</span><span class="sxs-lookup"><span data-stu-id="309a7-150">If logical records are used in a publication that includes parameterized filters, you must initialize each Subscriber with a snapshot for its partition.</span></span> <span data-ttu-id="309a7-151">Si vous initialisez un Abonné avec une autre méthode, l'Agent de fusion échoue.</span><span class="sxs-lookup"><span data-stu-id="309a7-151">If you initialize a Subscriber with another method, the Merge Agent will fail.</span></span> <span data-ttu-id="309a7-152">Pour plus d'informations, voir [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-152">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>

-   <span data-ttu-id="309a7-153">Les conflits qui concernent des enregistrements logiques ne sont pas affichés dans l'Outil de résolution des conflits.</span><span class="sxs-lookup"><span data-stu-id="309a7-153">Conflicts that involve logical records are not displayed in Conflict Viewer.</span></span> <span data-ttu-id="309a7-154">Pour afficher des informations sur ces conflits, utilisez des procédures stockées de réplication.</span><span class="sxs-lookup"><span data-stu-id="309a7-154">To view information about these conflicts, use replication stored procedures.</span></span> <span data-ttu-id="309a7-155">Pour plus d’informations, consultez [Afficher les informations relatives aux conflits pour les publications de fusion &#40;programmation Transact-SQL de la réplication&#41;](../view-conflict-information-for-merge-publications.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-155">For more information, see [View Conflict Information for Merge Publications &#40;Replication Transact-SQL Programming&#41;](../view-conflict-information-for-merge-publications.md).</span></span>

### <a name="publication-settings"></a><span data-ttu-id="309a7-156">Paramètres de la publication</span><span class="sxs-lookup"><span data-stu-id="309a7-156">Publication Settings</span></span>

-   <span data-ttu-id="309a7-157">La publication doit présenter un niveau de compatibilité supérieur ou égal à 90RTM.</span><span class="sxs-lookup"><span data-stu-id="309a7-157">The publication must have a compatibility level of 90RTM or greater.</span></span> <span data-ttu-id="309a7-158">Pour plus d’informations, consultez la section « Niveau de compatibilité de la publication » dans [Compatibilité descendante de la réplication](../replication-backward-compatibility.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-158">For more information, see the "Publication Compatibility Level" section of [Replication Backward Compatibility](../replication-backward-compatibility.md).</span></span>

-   <span data-ttu-id="309a7-159">La publication doit utiliser le mode d'instantané natif.</span><span class="sxs-lookup"><span data-stu-id="309a7-159">The publication must use native snapshot mode.</span></span> <span data-ttu-id="309a7-160">Ceci est le mode par défaut sauf lorsque vous effectuez une réplication vers [!INCLUDE[ssEW](../../../includes/ssew-md.md)], qui ne prend pas en charge les enregistrements logiques.</span><span class="sxs-lookup"><span data-stu-id="309a7-160">This is the default unless you are replicating to [!INCLUDE[ssEW](../../../includes/ssew-md.md)], which does not support logical records.</span></span>

-   <span data-ttu-id="309a7-161">La publication n'autorise pas la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="309a7-161">The publication cannot allow Web synchronization.</span></span> <span data-ttu-id="309a7-162">Pour plus d'informations sur la synchronisation Web, consultez [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-162">For more information about Web synchronization, see [Web Synchronization for Merge Replication](../web-synchronization-for-merge-replication.md).</span></span>

-   <span data-ttu-id="309a7-163">Pour utiliser des enregistrements logiques sur une publication filtrée :</span><span class="sxs-lookup"><span data-stu-id="309a7-163">In order to use logical records on a filtered publication:</span></span>

    -   <span data-ttu-id="309a7-164">Des partitions précalculées doivent également être utilisées.</span><span class="sxs-lookup"><span data-stu-id="309a7-164">Precomputed partitions must also be used.</span></span> <span data-ttu-id="309a7-165">Les conditions requises associées aux partitions précalculées s'appliquent également aux enregistrements logiques.</span><span class="sxs-lookup"><span data-stu-id="309a7-165">The requirements of precomputed partitions also apply to logical records.</span></span> <span data-ttu-id="309a7-166">Pour plus d’informations, consultez [Optimiser les performances des filtres paramétrés avec des partitions précalculées](parameterized-filters-optimize-for-precomputed-partitions.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-166">For more information, see [Optimize Parameterized Filter Performance with Precomputed Partitions](parameterized-filters-optimize-for-precomputed-partitions.md).</span></span>

    -   <span data-ttu-id="309a7-167">Vous ne pouvez pas utiliser de filtres paramétrés qui ne se chevauchent pas.</span><span class="sxs-lookup"><span data-stu-id="309a7-167">You cannot use nonoverlapping parameterized filters.</span></span> <span data-ttu-id="309a7-168">Pour plus d'informations, consultez la section « Définition des options de partition » de [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-168">For more information, see the "Setting 'partition options'" section of [Parameterized Row Filters](parameterized-filters-parameterized-row-filters.md).</span></span>

-   <span data-ttu-id="309a7-169">Si la publication utilise des filtres de jointure, la propriété **join unique key** doit avoir la valeur **true** pour tous les filtres de jointure intervenant dans des relations d'enregistrement logique.</span><span class="sxs-lookup"><span data-stu-id="309a7-169">If the publication uses join filters, the **join unique key** property must be set to **true** for all join filters that are involved in logical record relationships.</span></span> <span data-ttu-id="309a7-170">Pour plus d’informations, voir [Join Filters](join-filters.md).</span><span class="sxs-lookup"><span data-stu-id="309a7-170">For more information, see [Join Filters](join-filters.md).</span></span>

### <a name="relationships-between-tables"></a><span data-ttu-id="309a7-171">Relations entre tables</span><span class="sxs-lookup"><span data-stu-id="309a7-171">Relationships Between Tables</span></span>

-   <span data-ttu-id="309a7-172">Les tables liées par l'intermédiaire d'enregistrements logiques doivent avoir une relation clé primaire-clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="309a7-172">Tables related through logical records must have a primary key-foreign key relationship.</span></span>

-   <span data-ttu-id="309a7-173">L'option NOT FOR REPLICATION ne peut pas être définie pour des contraintes de clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="309a7-173">The NOT FOR REPLICATION option cannot be set for foreign key constraints.</span></span>

-   <span data-ttu-id="309a7-174">Les tables enfants ne peuvent avoir qu'une table parent.</span><span class="sxs-lookup"><span data-stu-id="309a7-174">Child tables can have only one parent table.</span></span>

     <span data-ttu-id="309a7-175">Par exemple, une base de données effectuant un suivi des classes et des étudiants peut présenter une conception similaire à :</span><span class="sxs-lookup"><span data-stu-id="309a7-175">For example, a database tracking classes and students might have a design similar to:</span></span>

     <span data-ttu-id="309a7-176">![Table enfant avec plusieurs tables parentes](../media/logical-records-03.gif "Table enfant avec plusieurs tables parentes")</span><span class="sxs-lookup"><span data-stu-id="309a7-176">![Child table with more than one parent table](../media/logical-records-03.gif "Child table with more than one parent table")</span></span>

     <span data-ttu-id="309a7-177">Vous ne pouvez pas utiliser un enregistrement logique pour représenter les trois tables de cette relation car les lignes de **ClassMembers** ne sont pas associées à une ligne de clé primaire unique.</span><span class="sxs-lookup"><span data-stu-id="309a7-177">You cannot use a logical record to represent the three tables in this relationship, because the rows in **ClassMembers** are not associated with a single primary key row.</span></span> <span data-ttu-id="309a7-178">Les tables **Classes** et **ClassMembers** peuvent néanmoins constituer un enregistrement logique, de même que les tables **ClassMembers** et **Students**mais pas les trois ensemble.</span><span class="sxs-lookup"><span data-stu-id="309a7-178">The tables **Classes** and **ClassMembers** could still form a logical record, as could the tables **ClassMembers** and **Students**, but not all three.</span></span>

-   <span data-ttu-id="309a7-179">La publication ne peut pas contenir des relations de filtre de jointure circulaires.</span><span class="sxs-lookup"><span data-stu-id="309a7-179">The publication cannot contain circular join filter relationships.</span></span>

     <span data-ttu-id="309a7-180">Dans l'exemple des tables **Customers**, **Orders**et **OrderItems**, vous ne pourriez pas utiliser des enregistrements logiques si la table **Orders** possèdait également une contrainte de clé étrangère qui faisait référence à la table **OrderItems** .</span><span class="sxs-lookup"><span data-stu-id="309a7-180">Using the example with the tables **Customers**, **Orders**, and **OrderItems**, you could not use logical records if the **Orders** table also had a foreign key constraint that referenced the **OrderItems** table.</span></span>

## <a name="performance-implications-of-logical-records"></a><span data-ttu-id="309a7-181">Impact des enregistrements logiques sur les performances</span><span class="sxs-lookup"><span data-stu-id="309a7-181">Performance implications of logical records</span></span>
 <span data-ttu-id="309a7-182">La fonctionnalité d'enregistrement logique a une incidence sur les performances.</span><span class="sxs-lookup"><span data-stu-id="309a7-182">The logical record feature does come with a performance cost.</span></span> <span data-ttu-id="309a7-183">Si vous n'utilisez pas les enregistrements logiques, l'Agent de réplication peut traiter toutes les modifications d'un article donné en même temps et, comme les modifications sont appliquées ligne par ligne, le verrouillage et les activités du journal des transactions requis pour l'application des modifications sont minimes.</span><span class="sxs-lookup"><span data-stu-id="309a7-183">If logical records are not used, the replication agent can process all of the changes for a given article at the same time, and because the changes are applied in a row-by-row fashion, the locking and transaction log requirements necessary for applying the changes are minimal.</span></span>

 <span data-ttu-id="309a7-184">Si vous utilisez des enregistrements logiques, l'Agent de fusion doit traiter les modifications de tout l'enregistrement logique ensemble.</span><span class="sxs-lookup"><span data-stu-id="309a7-184">If logical records are used, the Merge Agent must process the changes for each entire logical record together.</span></span> <span data-ttu-id="309a7-185">Le temps nécessaire à l'Agent de fusion pour répliquer les lignes est alors plus long.</span><span class="sxs-lookup"><span data-stu-id="309a7-185">This has an effect on the amount of time it takes the Merge Agent to replicate the rows.</span></span> <span data-ttu-id="309a7-186">En outre, comme l'Agent ouvre une transaction distincte pour chaque enregistrement logique, le verrouillage requis est plus important.</span><span class="sxs-lookup"><span data-stu-id="309a7-186">Additionally, because the agent opens a separate transaction for each logical record, locking requirements can increase.</span></span>

## <a name="see-also"></a><span data-ttu-id="309a7-187">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="309a7-187">See Also</span></span>
 [<span data-ttu-id="309a7-188">Options d’articles pour la réplication de fusion</span><span class="sxs-lookup"><span data-stu-id="309a7-188">Article Options for Merge Replication</span></span>](article-options-for-merge-replication.md)


