---
title: Réinitialiser un abonnement | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- initializing subscriptions [SQL Server replication], reinitializing
- subscriptions [SQL Server replication], reinitializing
- reinitializing subscriptions
ms.assetid: ca3625c5-c62e-4ab7-9829-d511f838e385
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: f751928c05caa5c4acdcc6c667dc59bb7824021b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709132"
---
# <a name="reinitialize-a-subscription"></a><span data-ttu-id="c6bab-102">Réinitialiser un abonnement</span><span class="sxs-lookup"><span data-stu-id="c6bab-102">Reinitialize a Subscription</span></span>
  <span data-ttu-id="c6bab-103">Cette rubrique explique comment réinitialiser un abonnement par extraction de données (pull) dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], de [!INCLUDE[tsql](../../includes/tsql-md.md)]ou d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="c6bab-103">This topic describes how to reinitialize a subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="c6bab-104">Des abonnements individuels peuvent être marqués pour réinitialisation afin qu'un nouvel instantané soit appliqué lors de la synchronisation suivante.</span><span class="sxs-lookup"><span data-stu-id="c6bab-104">Individual subscriptions can be marked for reinitialization so that a new snapshot is applied during the next synchronization.</span></span>  
  
 <span data-ttu-id="c6bab-105">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="c6bab-105">**In This Topic**</span></span>  
  
-   <span data-ttu-id="c6bab-106">**Pour réinitialiser un abonnement à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="c6bab-106">**To reinitialize a subscription, using:**</span></span>  
  
     [<span data-ttu-id="c6bab-107">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="c6bab-107">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="c6bab-108">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="c6bab-108">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="c6bab-109">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="c6bab-109">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="c6bab-110">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="c6bab-110">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="c6bab-111">La réinitialisation d'un abonnement est un processus en deux parties :</span><span class="sxs-lookup"><span data-stu-id="c6bab-111">Reinitializing a subscription is a two-part process:</span></span>  
  
1.  <span data-ttu-id="c6bab-112">Un abonnement seul ou tous les abonnements à une publication sont *marqués* pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-112">A single subscription or all subscriptions to a publication are *marked* for reinitialization.</span></span> <span data-ttu-id="c6bab-113">Marquez des abonnements pour réinitialisation dans la boîte de dialogue **Réinitialiser les abonnements**, qui est disponible à partir du dossier **Publications locales** et du dossier **Abonnements locaux** dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c6bab-113">Mark subscriptions for reinitialization in the **Reinitialize Subscription(s)** dialog box, which is available from the **Local Publications** folder and the **Local Subscriptions** folder in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="c6bab-114">Vous pouvez aussi marquer des abonnements à partir de l'onglet **Tous les abonnements** et du nœud des publications dans le moniteur de réplication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-114">You can also mark subscriptions from the **All Subscriptions** tab and the publications node in Replication Monitor.</span></span> <span data-ttu-id="c6bab-115">Pour plus d’informations sur le démarrage du Moniteur de réplication, consultez [Démarrer le Moniteur de réplication](monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span> <span data-ttu-id="c6bab-116">Quand vous marquez un abonnement pour réinitialisation, vous disposez des options suivantes :</span><span class="sxs-lookup"><span data-stu-id="c6bab-116">When you mark a subscription for reinitialization, you have the following options:</span></span>  
  
     <span data-ttu-id="c6bab-117">**Utiliser l'instantané actuel**</span><span class="sxs-lookup"><span data-stu-id="c6bab-117">**Use the current snapshot**</span></span>  
     <span data-ttu-id="c6bab-118">Permet d'appliquer l'instantané à l'Abonné lors de l'exécution suivante de l'agent de distribution ou de l'agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="c6bab-118">Select to apply the current snapshot to the Subscriber the next time the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="c6bab-119">Si aucun instantané valide n'est disponible, vous ne pouvez pas sélectionner cette option.</span><span class="sxs-lookup"><span data-stu-id="c6bab-119">If there is no valid snapshot available, this option cannot be selected.</span></span>  
  
     <span data-ttu-id="c6bab-120">**Utiliser un nouvel instantané**</span><span class="sxs-lookup"><span data-stu-id="c6bab-120">**Use a new snapshot**</span></span>  
     <span data-ttu-id="c6bab-121">Permet de réinitialiser l'abonnement par un nouvel instantané.</span><span class="sxs-lookup"><span data-stu-id="c6bab-121">Select to reinitialize the subscription with a new snapshot.</span></span> <span data-ttu-id="c6bab-122">L'instantané ne peut être appliqué à l'Abonné qu'après sa génération par l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="c6bab-122">The snapshot can be applied to the Subscriber only after it has been generated by the Snapshot Agent.</span></span> <span data-ttu-id="c6bab-123">Si l'Agent d'instantané est défini pour s'exécuter selon une planification, l'abonnement est réinitialisé seulement après l'exécution planifiée suivante de l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="c6bab-123">If the Snapshot Agent is set to run on a schedule, the subscription is not reinitialized until after the next scheduled Snapshot Agent run.</span></span> <span data-ttu-id="c6bab-124">Sélectionnez **Générer le nouvel instantané maintenant** pour lancer immédiatement l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="c6bab-124">Select **Generate the new snapshot now** to start the Snapshot Agent immediately.</span></span>  
  
     <span data-ttu-id="c6bab-125">**Télécharger les modifications non synchronisées avant la réinitialisation**</span><span class="sxs-lookup"><span data-stu-id="c6bab-125">**Upload unsynchronized changes before reinitialization**</span></span>  
     <span data-ttu-id="c6bab-126">Réplication de fusion uniquement.</span><span class="sxs-lookup"><span data-stu-id="c6bab-126">Merge replication only.</span></span> <span data-ttu-id="c6bab-127">Permet de télécharger vers le serveur toute modification en attente et apportée à la base de données d'abonnement avant que les données au niveau de l'Abonné ne soient écrasées par un instantané.</span><span class="sxs-lookup"><span data-stu-id="c6bab-127">Select to upload any pending changes from the subscription database before the data at the Subscriber is overwritten with a snapshot.</span></span>  
  
     <span data-ttu-id="c6bab-128">Si vous ajoutez, supprimez ou modifiez un filtre paramétré, les modifications en attente chez l'abonné ne peuvent pas être chargées sur le serveur de publication pendant la réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-128">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="c6bab-129">Si vous voulez télécharger les modifications en attente, synchronisez tous les abonnements avant de modifier le filtre.</span><span class="sxs-lookup"><span data-stu-id="c6bab-129">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="c6bab-130">Un abonnement est réinitialisé la prochaine fois qu'il est synchronisé : l'Agent de distribution (pour la réplication transactionnelle) ou l'Agent de fusion (pour la réplication de fusion) applique l'instantané le plus récent à chaque Abonné qui a un abonnement marqué pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-130">A subscription is reinitialized the next time it is synchronized: the Distribution Agent (for transactional replication) or Merge Agent (for merge replication) applies the most recent snapshot to each Subscriber that has a subscription marked for reinitialization.</span></span> <span data-ttu-id="c6bab-131">Pour plus d'informations sur la synchronisation des abonnements, consultez [Synchronize a Push Subscription](synchronize-a-push-subscription.md) et [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-management-studio-at-the-publisher"></a><span data-ttu-id="c6bab-132">Pour marquer un abonnement par envoi de données (push) ou par extraction de données (pull) pour réinitialisation dans Management Studio (sur le serveur de publication)</span><span class="sxs-lookup"><span data-stu-id="c6bab-132">To mark a single push or pull subscription for reinitialization in Management Studio (at the Publisher)</span></span>  
  
1.  <span data-ttu-id="c6bab-133">Connectez-vous au serveur de publication dans [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="c6bab-133">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="c6bab-134">Développez le dossier **Réplication** , puis développez le dossier **Publications locales** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-134">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="c6bab-135">Développez la publication qui a l'abonnement que vous voulez réinitialiser.</span><span class="sxs-lookup"><span data-stu-id="c6bab-135">Expand the publication that has the subscription you want to reinitialize.</span></span>  
  
4.  <span data-ttu-id="c6bab-136">Cliquez avec le bouton droit sur l'abonnement, puis sur **Réinitialiser**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-136">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
5.  <span data-ttu-id="c6bab-137">Dans la boîte de dialogue **Réinitialiser les abonnements** , sélectionnez les options, puis cliquez sur **Marquer pour réinitialisation**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-137">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-pull-subscription-for-reinitialization-in-management-studio-at-the-subscriber"></a><span data-ttu-id="c6bab-138">Pour marquer un seul abonnement par extraction de données (pull) pour réinitialisation dans Management Studio (sur l'Abonné)</span><span class="sxs-lookup"><span data-stu-id="c6bab-138">To mark a single pull subscription for reinitialization in Management Studio (at the Subscriber)</span></span>  
  
1.  <span data-ttu-id="c6bab-139">Connectez-vous à l'Abonné dans [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="c6bab-139">Connect to the Subscriber in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="c6bab-140">Développez le dossier **Réplication** , puis développez le dossier **Abonnements locaux** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-140">Expand the **Replication** folder, and then expand the **Local Subscriptions** folder.</span></span>  
  
3.  <span data-ttu-id="c6bab-141">Cliquez avec le bouton droit sur l'abonnement, puis sur **Réinitialiser**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-141">Right-click the subscription, and then click **Reinitialize**.</span></span>  
  
4.  <span data-ttu-id="c6bab-142">Dans la boîte de dialogue de confirmation qui s'affiche, cliquez sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-142">In the confirmation dialog box that is displayed, click **Yes**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-management-studio"></a><span data-ttu-id="c6bab-143">Pour marquer tous les abonnements pour réinitialisation dans Management Studio</span><span class="sxs-lookup"><span data-stu-id="c6bab-143">To mark all subscriptions for reinitialization in Management Studio</span></span>  
  
1.  <span data-ttu-id="c6bab-144">Connectez-vous au serveur de publication dans [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="c6bab-144">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="c6bab-145">Développez le dossier **Réplication** , puis développez le dossier **Publications locales** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-145">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="c6bab-146">Cliquez avec le bouton droit sur la publication avec les abonnements que vous voulez réinitialiser, puis cliquez sur **Réinitialiser tous les abonnements**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-146">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="c6bab-147">Dans la boîte de dialogue **Réinitialiser les abonnements** , sélectionnez les options, puis cliquez sur **Marquer pour réinitialisation**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-147">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-a-single-push-or-pull-subscription-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="c6bab-148">Pour marquer un seul abonnement par envoi de données (push) ou par extraction de données (pull) pour réinitialisation dans le moniteur de réplication</span><span class="sxs-lookup"><span data-stu-id="c6bab-148">To mark a single push or pull subscription for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="c6bab-149">Dans le moniteur de réplication, développez un groupe de serveurs de publication dans le volet gauche, développez un serveur de publication, puis cliquez sur une publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-149">In Replication Monitor, expand a Publisher group in the left pane, expand a Publisher, and then click a publication.</span></span>  
  
2.  <span data-ttu-id="c6bab-150">Cliquez sur l'onglet **Tous les abonnements** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-150">Click the **All Subscriptions** tab.</span></span>  
  
3.  <span data-ttu-id="c6bab-151">Cliquez avec le bouton droit sur l'abonnement que vous voulez réinitialiser, puis cliquez sur **Réinitialiser un abonnement**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-151">Right-click the subscription you want to reinitialize, and then click **Reinitialize Subscription**.</span></span>  
  
4.  <span data-ttu-id="c6bab-152">Dans la boîte de dialogue **Réinitialiser les abonnements** , sélectionnez les options, puis cliquez sur **Marquer pour réinitialisation**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-152">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
#### <a name="to-mark-all-subscriptions-for-reinitialization-in-replication-monitor"></a><span data-ttu-id="c6bab-153">Pour marquer tous les abonnements pour réinitialisation dans le moniteur de réplication</span><span class="sxs-lookup"><span data-stu-id="c6bab-153">To mark all subscriptions for reinitialization in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="c6bab-154">Dans le moniteur de réplication, développez un groupe de serveurs de publication dans le volet gauche, puis développez un serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-154">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="c6bab-155">Cliquez avec le bouton droit sur la publication avec les abonnements que vous voulez réinitialiser, puis cliquez sur **Réinitialiser tous les abonnements**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-155">Right-click the publication with subscriptions you want to reinitialize, and then click **Reinitialize All Subscriptions**.</span></span>  
  
3.  <span data-ttu-id="c6bab-156">Dans la boîte de dialogue **Réinitialiser les abonnements** , sélectionnez les options, puis cliquez sur **Marquer pour réinitialisation**.</span><span class="sxs-lookup"><span data-stu-id="c6bab-156">In the **Reinitialize Subscription(s)** dialog box, select options, and then click **Mark for Reinitialization**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="c6bab-157">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="c6bab-157">Using Transact-SQL</span></span>  
 <span data-ttu-id="c6bab-158">Les abonnements peuvent être réinitialisés par programme en utilisant des procédures stockées de réplication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-158">Subscriptions can be reinitialized programmatically using replication stored procedures.</span></span> <span data-ttu-id="c6bab-159">La procédure stockée utilisée dépend du type d'abonnement (par extraction ou par émission de données) et du type de publication à laquelle l'abonnement appartient.</span><span class="sxs-lookup"><span data-stu-id="c6bab-159">The stored procedure that is used depends on the type of subscription (push or pull) and the type of publication to which the subscription belongs.</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="c6bab-160">Pour réinitialiser un abonnement par extraction à une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="c6bab-160">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="c6bab-161">Sur l’Abonné, dans la base de données d’abonnement, exécutez [sp_reinitpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c6bab-161">At the Subscriber on the subscription database, execute [sp_reinitpullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitpullsubscription-transact-sql).</span></span> <span data-ttu-id="c6bab-162">Spécifiez **@publisher** , **@publisher_db** et **@publication** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-162">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="c6bab-163">L'abonnement est alors marqué pour réinitialisation lors de la prochaine exécution de l'Agent de distribution.</span><span class="sxs-lookup"><span data-stu-id="c6bab-163">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="c6bab-164">(Facultatif) Démarrez l'Agent de distribution sur l'Abonné pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6bab-164">(Optional) Start the Distribution Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="c6bab-165">Pour plus d’informations, consultez [Synchroniser un abonnement par extraction (pull)](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-165">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="c6bab-166">Pour réinitialiser un abonnement par émission de données à une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="c6bab-166">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="c6bab-167">Sur le serveur de publication, exécutez [sp_reinitsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c6bab-167">At the Publisher, execute [sp_reinitsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitsubscription-transact-sql).</span></span> <span data-ttu-id="c6bab-168">Spécifiez **@publication** , **@subscriber** et **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-168">Specify **@publication**, **@subscriber**, and **@destination_db**.</span></span> <span data-ttu-id="c6bab-169">L'abonnement est alors marqué pour réinitialisation lors de la prochaine exécution de l'Agent de distribution.</span><span class="sxs-lookup"><span data-stu-id="c6bab-169">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
2.  <span data-ttu-id="c6bab-170">(Facultatif) Démarrez l'Agent de distribution sur le serveur de distribution pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6bab-170">(Optional) Start the Distribution Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="c6bab-171">Pour plus d’informations, consultez [Synchroniser un abonnement par émission (push)](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-171">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="c6bab-172">Pour réinitialiser un abonnement par extraction à une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="c6bab-172">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-173">Sur l’Abonné, dans la base de données d’abonnement, exécutez [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c6bab-173">At the Subscriber on the subscription database, execute [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="c6bab-174">Spécifiez **@publisher** , **@publisher_db** et **@publication** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-174">Specify **@publisher**, **@publisher_db**, and **@publication**.</span></span> <span data-ttu-id="c6bab-175">Pour télécharger les modifications de l’abonné avant la réinitialisation, affectez la valeur `true` à **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-175">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="c6bab-176">L'abonnement est alors marqué pour réinitialisation lors de la prochaine exécution de l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="c6bab-176">This marks the subscription for reinitialization the next time the Merge Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6bab-177">Si vous ajoutez, supprimez ou modifiez un filtre paramétré, les modifications en attente chez l'abonné ne peuvent pas être chargées sur le serveur de publication pendant la réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-177">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="c6bab-178">Si vous voulez télécharger les modifications en attente, synchronisez tous les abonnements avant de modifier le filtre.</span><span class="sxs-lookup"><span data-stu-id="c6bab-178">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="c6bab-179">(Facultatif) Démarrez l'Agent de fusion sur l'Abonné pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6bab-179">(Optional) Start the Merge Agent at the Subscriber to synchronize the subscription.</span></span> <span data-ttu-id="c6bab-180">Pour plus d’informations, consultez [Synchroniser un abonnement par extraction (pull)](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-180">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="c6bab-181">Pour réinitialiser un abonnement par émission de données à une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="c6bab-181">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-182">Sur le serveur de publication, exécutez [sp_reinitmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="c6bab-182">At the Publisher, execute [sp_reinitmergesubscription &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-reinitmergesubscription-transact-sql).</span></span> <span data-ttu-id="c6bab-183">Spécifiez **@publication** , **@subscriber** et **@subscriber_db** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-183">Specify **@publication**, **@subscriber**, and **@subscriber_db**.</span></span> <span data-ttu-id="c6bab-184">Pour télécharger les modifications de l’abonné avant la réinitialisation, affectez la valeur `true` à **@upload_first** .</span><span class="sxs-lookup"><span data-stu-id="c6bab-184">To upload changes from the Subscriber before reinitialization occurs, specify a value of `true` for **@upload_first**.</span></span> <span data-ttu-id="c6bab-185">L'abonnement est alors marqué pour réinitialisation lors de la prochaine exécution de l'Agent de distribution.</span><span class="sxs-lookup"><span data-stu-id="c6bab-185">This marks the subscription for reinitialization the next time the Distribution Agent runs.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6bab-186">Si vous ajoutez, supprimez ou modifiez un filtre paramétré, les modifications en attente chez l'abonné ne peuvent pas être chargées sur le serveur de publication pendant la réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-186">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="c6bab-187">Si vous voulez télécharger les modifications en attente, synchronisez tous les abonnements avant de modifier le filtre.</span><span class="sxs-lookup"><span data-stu-id="c6bab-187">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
2.  <span data-ttu-id="c6bab-188">(Facultatif) Démarrez l'Agent de fusion sur le serveur de distribution pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="c6bab-188">(Optional) Start the Merge Agent at the Distributor to synchronize the subscription.</span></span> <span data-ttu-id="c6bab-189">Pour plus d’informations, consultez [Synchroniser un abonnement par émission (push)](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-189">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-set-the-reinitialization-policy-when-creating-a-new-merge-publication"></a><span data-ttu-id="c6bab-190">Pour définir la stratégie de réinitialisation lors de la création d'une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="c6bab-190">To set the reinitialization policy when creating a new merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-191">Dans la base de données de publication sur le serveur de publication, exécutez [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), en spécifiant l'une des valeurs suivantes pour **@automatic_reinitialization_policy**:</span><span class="sxs-lookup"><span data-stu-id="c6bab-191">At the Publisher on the publication database, execute [sp_addmergepublication](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), specifying one of the following values for **@automatic_reinitialization_policy**:</span></span>  
  
    -   <span data-ttu-id="c6bab-192">**1** - les modifications sont téléchargées depuis l'Abonné avant réinitialisation automatique d'un abonnement suite à la modification de la publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-192">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="c6bab-193">**0** - les modifications au niveau de l'Abonné sont ignorées lorsqu'un abonnement est automatiquement réinitialisé suite à la modification de la publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-193">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6bab-194">Si vous ajoutez, supprimez ou modifiez un filtre paramétré, les modifications en attente chez l'abonné ne peuvent pas être chargées sur le serveur de publication pendant la réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-194">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="c6bab-195">Si vous voulez télécharger les modifications en attente, synchronisez tous les abonnements avant de modifier le filtre.</span><span class="sxs-lookup"><span data-stu-id="c6bab-195">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="c6bab-196">Pour plus d’informations, voir [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-196">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
#### <a name="to-change-the-reinitialization-policy-for-an-existing-merge-publication"></a><span data-ttu-id="c6bab-197">Pour modifier la stratégie de réinitialisation pour une publication de fusion existante</span><span class="sxs-lookup"><span data-stu-id="c6bab-197">To change the reinitialization policy for an existing merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-198">Dans la base de données de publication sur le serveur de publication, exécutez [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), en spécifiant **automatic_reinitialization_policy** à **@property** et l'une des valeurs suivantes pour **@value**:</span><span class="sxs-lookup"><span data-stu-id="c6bab-198">At the Publisher on the publication database, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **automatic_reinitialization_policy** for **@property** and one of the following values for **@value**:</span></span>  
  
    -   <span data-ttu-id="c6bab-199">**1** - les modifications sont téléchargées depuis l'Abonné avant réinitialisation automatique d'un abonnement suite à la modification de la publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-199">**1** - changes are uploaded from the Subscriber before a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    -   <span data-ttu-id="c6bab-200">**0** - les modifications au niveau de l'Abonné sont ignorées lorsqu'un abonnement est automatiquement réinitialisé suite à la modification de la publication.</span><span class="sxs-lookup"><span data-stu-id="c6bab-200">**0** - changes at the Subscriber are discarded when a subscription is automatically reinitialized as required by a change to the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="c6bab-201">Si vous ajoutez, supprimez ou modifiez un filtre paramétré, les modifications en attente chez l'abonné ne peuvent pas être chargées sur le serveur de publication pendant la réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-201">If you add, drop, or change a parameterized filter, pending changes at the Subscriber cannot be uploaded to the Publisher during reinitialization.</span></span> <span data-ttu-id="c6bab-202">Si vous voulez télécharger les modifications en attente, synchronisez tous les abonnements avant de modifier le filtre.</span><span class="sxs-lookup"><span data-stu-id="c6bab-202">If you want to upload pending changes, synchronize all subscriptions before changing the filter.</span></span>  
  
     <span data-ttu-id="c6bab-203">Pour plus d'informations, voir [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-203">For more information, see [View and Modify Publication Properties](publish/view-and-modify-publication-properties.md).</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="c6bab-204">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="c6bab-204">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="c6bab-205">Des abonnements individuels peuvent être marqués pour réinitialisation afin qu'un nouvel instantané soit appliqué lors de la synchronisation suivante.</span><span class="sxs-lookup"><span data-stu-id="c6bab-205">Individual subscriptions can be marked for reinitialization so that during the next synchronization, a new snapshot is applied.</span></span> <span data-ttu-id="c6bab-206">Les abonnements peuvent être réinitialisés par programme à l'aide de Replication Management Objects.</span><span class="sxs-lookup"><span data-stu-id="c6bab-206">Subscriptions can be reinitialized programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="c6bab-207">Les classes que vous utilisez dépendent du type de publication à laquelle l'abonnement appartient et du type d'abonnement (par extraction ou par émission de données).</span><span class="sxs-lookup"><span data-stu-id="c6bab-207">The classes you use depend on the type of publication to which the subscription belongs and the type of subscription (that is, a push or pull subscription).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-transactional-publication"></a><span data-ttu-id="c6bab-208">Pour réinitialiser un abonnement par extraction à une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="c6bab-208">To reinitialize a pull subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="c6bab-209">Créez une connexion à l'Abonné en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-209">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6bab-210">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransPullSubscription> , puis définissez <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>et la connexion créée à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="c6bab-210">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="c6bab-211">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="c6bab-211">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-212">Si cette méthode retourne `false`, les propriétés de l'abonnement définies à l'étape 2 sont incorrectes ou l'abonnement par extraction n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="c6bab-212">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="c6bab-213">Appelez la méthode <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-213">Call the <xref:Microsoft.SqlServer.Replication.TransPullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="c6bab-214">Cette méthode marque l'abonnement pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-214">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="c6bab-215">Synchronisez l'abonnement par extraction.</span><span class="sxs-lookup"><span data-stu-id="c6bab-215">Synchronize the pull subscription.</span></span> <span data-ttu-id="c6bab-216">Pour plus d’informations, consultez [Synchroniser un abonnement par extraction (pull)](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-216">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-transactional-publication"></a><span data-ttu-id="c6bab-217">Pour réinitialiser un abonnement par émission de données à une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="c6bab-217">To reinitialize a push subscription to a transactional publication</span></span>  
  
1.  <span data-ttu-id="c6bab-218">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-218">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6bab-219">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransSubscription> , puis définissez <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>et la connexion créée à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="c6bab-219">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="c6bab-220">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="c6bab-220">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-221">Si cette méthode retourne `false`, les propriétés de l'abonnement définies à l'étape 2 sont incorrectes ou l'abonnement par émission de données n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="c6bab-221">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="c6bab-222">Appelez la méthode <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-222">Call the <xref:Microsoft.SqlServer.Replication.TransSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="c6bab-223">Cette méthode marque l'abonnement pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-223">This method marks the subscription for reinitialization.</span></span>  
  
5.  <span data-ttu-id="c6bab-224">Synchronisez l'abonnement par émission de données.</span><span class="sxs-lookup"><span data-stu-id="c6bab-224">Synchronize the push subscription.</span></span> <span data-ttu-id="c6bab-225">Pour plus d’informations, consultez [Synchroniser un abonnement par émission (push)](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-225">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-pull-subscription-to-a-merge-publication"></a><span data-ttu-id="c6bab-226">Pour réinitialiser un abonnement par extraction à une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="c6bab-226">To reinitialize a pull subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-227">Créez une connexion à l'Abonné en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-227">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6bab-228">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePullSubscription> , puis définissez <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>et la connexion créée à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="c6bab-228">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePullSubscription> class, and set <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PullSubscription.PublicationDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="c6bab-229">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="c6bab-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-230">Si cette méthode retourne `false`, les propriétés de l'abonnement définies à l'étape 2 sont incorrectes ou l'abonnement par extraction n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="c6bab-230">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the pull subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="c6bab-231">Appelez la méthode <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-231">Call the <xref:Microsoft.SqlServer.Replication.MergePullSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="c6bab-232">Passez la valeur `true` pour télécharger les modifications sur l'Abonné avant la réinitialisation ou la valeur `false` pour réinitialiser et perdre toute modification en attente sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="c6bab-232">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="c6bab-233">Cette méthode marque l'abonnement pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-233">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-234">Les modifications ne peuvent pas être téléchargées si l'abonnement a expiré.</span><span class="sxs-lookup"><span data-stu-id="c6bab-234">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="c6bab-235">Pour plus d'informations, voir [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-235">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="c6bab-236">Synchronisez l'abonnement par extraction.</span><span class="sxs-lookup"><span data-stu-id="c6bab-236">Synchronize the pull subscription.</span></span> <span data-ttu-id="c6bab-237">Pour plus d’informations, consultez [Synchroniser un abonnement par extraction (pull)](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-237">For more information, see [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
#### <a name="to-reinitialize-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="c6bab-238">Pour réinitialiser un abonnement par émission de données à une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="c6bab-238">To reinitialize a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="c6bab-239">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-239">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="c6bab-240">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergeSubscription> , puis définissez <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>et la connexion créée à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="c6bab-240">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class, and set <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>, <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>, and the connection from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="c6bab-241">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="c6bab-241">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-242">Si cette méthode retourne `false`, les propriétés de l'abonnement définies à l'étape 2 sont incorrectes ou l'abonnement par émission de données n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="c6bab-242">If this method returns `false`, either the subscription properties in step 2 were defined incorrectly or the push subscription does not exist.</span></span>  
  
4.  <span data-ttu-id="c6bab-243">Appelez la méthode <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> .</span><span class="sxs-lookup"><span data-stu-id="c6bab-243">Call the <xref:Microsoft.SqlServer.Replication.MergeSubscription.Reinitialize%2A> method.</span></span> <span data-ttu-id="c6bab-244">Passez la valeur `true` pour télécharger les modifications sur l'Abonné avant la réinitialisation ou la valeur `false` pour réinitialiser et perdre toute modification en attente sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="c6bab-244">Pass a value of `true` to upload changes at the Subscriber before reinitialization or a value of `false` to reinitialize and lose any pending changes at the Subscriber.</span></span> <span data-ttu-id="c6bab-245">Cette méthode marque l'abonnement pour réinitialisation.</span><span class="sxs-lookup"><span data-stu-id="c6bab-245">This method marks the subscription for reinitialization.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="c6bab-246">Les modifications ne peuvent pas être téléchargées si l'abonnement a expiré.</span><span class="sxs-lookup"><span data-stu-id="c6bab-246">Changes cannot be uploaded if the subscription is expired.</span></span> <span data-ttu-id="c6bab-247">Pour plus d'informations, voir [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-247">For more information, see [Set the Expiration Period for Subscriptions](publish/set-the-expiration-period-for-subscriptions.md).</span></span>  
  
5.  <span data-ttu-id="c6bab-248">Synchronisez l'abonnement par émission de données.</span><span class="sxs-lookup"><span data-stu-id="c6bab-248">Synchronize the push subscription.</span></span> <span data-ttu-id="c6bab-249">Pour plus d’informations, consultez [Synchroniser un abonnement par émission (push)](synchronize-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="c6bab-249">For more information, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="c6bab-250">Exemples (RMO)</span><span class="sxs-lookup"><span data-stu-id="c6bab-250">Examples (RMO)</span></span>  
 <span data-ttu-id="c6bab-251">Cet exemple réinitialise un abonnement par extraction à une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="c6bab-251">This example reinitializes a pull subscription to a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitTranPullSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinittranpullsub)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitTranPullSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinittranpullsub)]  
  
 <span data-ttu-id="c6bab-252">Cet exemple réinitialise un abonnement par extraction à une publication de fusion après avoir téléchargé les modifications en attente sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="c6bab-252">This example reinitializes a pull subscription to a merge publication after first uploading pending changes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_ReinitMergePullSub_WithUpload](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_reinitmergepullsub_withupload)]  
  
 [!code-vb[HowTo#rmo_vb_ReinitMergePullSub_WithUpload](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_reinitmergepullsub_withupload)]  
  
## <a name="see-also"></a><span data-ttu-id="c6bab-253">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c6bab-253">See Also</span></span>  
 <span data-ttu-id="c6bab-254">[Réinitialiser des abonnements](reinitialize-subscriptions.md) </span><span class="sxs-lookup"><span data-stu-id="c6bab-254">[Reinitialize Subscriptions](reinitialize-subscriptions.md) </span></span>  
 <span data-ttu-id="c6bab-255">[Concepts liés à RMO (Replication Management Objects)](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="c6bab-255">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 [<span data-ttu-id="c6bab-256">Bonnes pratiques en matière de sécurité de la réplication</span><span class="sxs-lookup"><span data-stu-id="c6bab-256">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
