---
title: Mettre à niveau les scripts de réplication (programmation Transact-SQL de la réplication) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- scripts [SQL Server replication], upgrading
- upgrading SQL Server, replicated databases
- upgrading replication applications
- replication [SQL Server], scripting
- replication [SQL Server], upgrading
- upgrading replicated databases
ms.assetid: 0b8720bd-f339-4842-bc8f-b35a46f6d3ee
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c47101c76ca2c585accd493b74f0e59c56bf009e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603415"
---
# <a name="upgrade-replication-scripts-replication-transact-sql-programming"></a><span data-ttu-id="bb65a-102">Mettre à niveau les scripts de réplication (programmation Transact-SQL de la réplication)</span><span class="sxs-lookup"><span data-stu-id="bb65a-102">Upgrade Replication Scripts (Replication Transact-SQL Programming)</span></span>
  [!INCLUDE[tsql](../../../includes/tsql-md.md)] <span data-ttu-id="bb65a-103">Les fichiers de script peuvent être utilisés pour configurer une topologie de réplication par programmation.</span><span class="sxs-lookup"><span data-stu-id="bb65a-103">script files can be used to programmatically configure a replication topology.</span></span> <span data-ttu-id="bb65a-104">Pour plus d’informations, consultez [Concepts liés aux procédures stockées système de réplication](../concepts/replication-system-stored-procedures-concepts.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-104">For more information, see [Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="bb65a-105">Bien que vous ne soyez pas tenu de mettre à niveau les scripts exécutés par les membres du rôle `sysadmin`, nous vous recommandons de modifier les scripts existants comme décrit dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="bb65a-105">Although you are not required to upgrade scripts that are executed by members of the `sysadmin` role, we recommend that you modify existing scripts as described in this topic.</span></span> <span data-ttu-id="bb65a-106">Spécifiez un compte qui possède les autorisations minimales pour chaque agent de réplication comme décrit dans la section « Autorisations requises par les Agents » de la rubrique [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-106">Specify an account that has minimum permissions for each replication agent as described in the "Permissions Required By Agents" section of the topic [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
 <span data-ttu-id="bb65a-107">Ces améliorations de sécurité, qui offrent un contrôle accru sur les autorisations en vous permettant de spécifier explicitement les comptes Windows [!INCLUDE[msCoName](../../../includes/msconame-md.md)] sous lesquels les travaux de l'Agent de réplication sont exécutés, affectent les procédures stockées suivantes dans les scripts existants :</span><span class="sxs-lookup"><span data-stu-id="bb65a-107">These security improvements, which enable more control over permissions by allowing you to explicitly specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows accounts under which replication agent jobs are executed, affect the following stored procedures in existing scripts:</span></span>  
  
-   <span data-ttu-id="bb65a-108">**sp_addpublication_snapshot**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-108">**sp_addpublication_snapshot**:</span></span>  
  
     <span data-ttu-id="bb65a-109">Vous devez maintenant fournir les informations d’identification Windows comme **@job_login** et lors de l' **@job_password** exécution de [Sp_addpublication_snapshot &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) pour créer le travail sous lequel l’agent d’instantané s’exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-109">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) to create the job under which the Snapshot Agent runs at the Distributor.</span></span>  
  
-   <span data-ttu-id="bb65a-110">**sp_addpushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-110">**sp_addpushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-111">Vous devez maintenant exécuter [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) pour ajouter un travail explicitement et fournir les informations d’identification Windows (**@job_login** et **@job_password**) sous lesquelles le travail de l’Agent de distribution s’exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-111">You should now execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Distribution Agent job runs at the Distributor.</span></span> <span data-ttu-id="bb65a-112">Dans les versions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] antérieures à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], ces actions étaient exécutées automatiquement lors de la création d'un abonnement par émission de données.</span><span class="sxs-lookup"><span data-stu-id="bb65a-112">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="bb65a-113">**sp_addmergepushsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-113">**sp_addmergepushsubscription_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-114">Vous devez maintenant exécuter [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) pour ajouter un travail explicitement et fournir les informations d’identification Windows (**@job_login** et **@job_password**) sous lesquelles le travail de l’Agent de fusion s’exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-114">You should now execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) to explicitly add a job and supply the Windows credentials (**@job_login** and **@job_password**) under which the Merge Agent job runs at the Distributor.</span></span> <span data-ttu-id="bb65a-115">Dans les versions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] antérieures à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], ces actions étaient exécutées automatiquement lors de la création d'un abonnement par émission de données.</span><span class="sxs-lookup"><span data-stu-id="bb65a-115">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a push subscription was created.</span></span>  
  
-   <span data-ttu-id="bb65a-116">**sp_addpullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-116">**sp_addpullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-117">Vous devez maintenant fournir les informations d’identification Windows comme **@job_login** et lors de l' **@job_password** exécution de [Sp_addpullsubscription_agent &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) pour créer le travail sous lequel l’agent de distribution s’exécute sur l’abonné.</span><span class="sxs-lookup"><span data-stu-id="bb65a-117">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to create the job under which the Distribution Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="bb65a-118">**sp_addmergepullsubscription_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-118">**sp_addmergepullsubscription_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-119">Vous devez maintenant fournir les informations d’identification Windows comme **@job_login** et lors de l' **@job_password** exécution de [Sp_addmergepullsubscription_agent &#40;&#41;Transact-SQL](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) pour créer le travail sous lequel l’agent de fusion s’exécute sur l’abonné.</span><span class="sxs-lookup"><span data-stu-id="bb65a-119">You should now supply the Windows credentials as **@job_login** and **@job_password** when executing [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to create the job under which the Merge Agent runs at the Subscriber.</span></span>  
  
-   <span data-ttu-id="bb65a-120">**sp_addlogreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-120">**sp_addlogreader_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-121">Vous devez maintenant exécuter [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) pour ajouter manuellement le travail et fournir les informations d’identification Windows sous lesquelles l’Agent de lecture du journal s’exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-121">You should now execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Log Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="bb65a-122">Dans les versions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] antérieures à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], ces actions étaient exécutées automatiquement lors de la création d'une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="bb65a-122">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication was created.</span></span>  
  
-   <span data-ttu-id="bb65a-123">**sp_addqreader_agent**:</span><span class="sxs-lookup"><span data-stu-id="bb65a-123">**sp_addqreader_agent**:</span></span>  
  
     <span data-ttu-id="bb65a-124">Vous devez maintenant exécuter [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) pour ajouter manuellement le travail et fournir les informations d’identification Windows sous lesquelles l’Agent de lecture de la file d’attente s’exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-124">You should now execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) to manually add the job and supply the Windows credentials under which the Queue Reader Agent runs at the Distributor.</span></span> <span data-ttu-id="bb65a-125">Dans les versions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] antérieures à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], ces actions étaient exécutées automatiquement lors de la création d'une publication transactionnelle prenant en charge la mise à jour en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="bb65a-125">In versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], this was done automatically when a transactional publication that supported queued updating was created.</span></span>  
  
 <span data-ttu-id="bb65a-126">Dans le modèle de sécurité introduit dans [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] , les agents de réplication effectuent toujours des connexions à l’instance locale de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] avec l’authentification Windows à l’aide des informations d’identification fournies dans **@job_name** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-126">In the security model introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], replication agents always make connections to the local instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] with Windows Authentication using the credentials supplied in **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-127">Pour plus d'informations sur la configuration requise des comptes Windows lors de l'exécution des travaux de l'Agent de réplication, consultez [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-127">For information about the requirements of Windows accounts used when running replication agent jobs, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="bb65a-128">Lorsque c'est possible, demande aux utilisateurs de fournir les informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-128">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="bb65a-129">Si vous stockez les informations d'identification dans un fichier de script, assurez-vous que le fichier lui-même est sécurisé.</span><span class="sxs-lookup"><span data-stu-id="bb65a-129">If you store credentials in a script file, ensure that the file itself is secured.</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-snapshot-or-transactional-publication"></a><span data-ttu-id="bb65a-130">Pour mettre à niveau les scripts qui configurent une publication transactionnelle ou d'instantané</span><span class="sxs-lookup"><span data-stu-id="bb65a-130">To upgrade scripts that configure a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="bb65a-131">Dans le script existant, avant [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), exécutez [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) sur le serveur de publication sur la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-131">In the existing script, before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="bb65a-132">Spécifiez les informations d’identification Windows sous lesquelles l’agent de lecture du journal s’exécute pour **@job_name** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-132">Specify the Windows credentials under which the Log Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-133">Si l'agent doit utiliser l'authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] lors de la connexion au serveur de publication, vous devez aussi spécifier la valeur **0** pour **@publisher_security_mode** et les informations de connexion [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **@publisher_login** et **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="bb65a-133">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="bb65a-134">Il s'ensuit la création d'un travail de l'Agent de lecture du journal pour la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-134">This creates a Log Reader Agent job for the publication database.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="bb65a-135">Cette étape concerne uniquement les publications transactionnelles et n'est pas requise pour les publications d'instantané.</span><span class="sxs-lookup"><span data-stu-id="bb65a-135">This step is only for transactional publications and is not required for snapshot publications.</span></span>  
  
2.  <span data-ttu-id="bb65a-136">(Facultatif) Avant [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), exécutez [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) sur la base de données de distribution sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-136">(Optional) Before [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addqreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addqreader-agent-transact-sql) at the Distributor on the distribution database.</span></span> <span data-ttu-id="bb65a-137">Spécifiez les informations d’identification Windows sous lesquelles l’Agent de lecture de la file d’attente s’exécute pour **@job_name** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-137">Specify the Windows credentials under which the Queue Reader Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-138">Il s'ensuit la création d'un travail de l'Agent de lecture de la file d'attente pour le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="bb65a-138">This creates a Queue Reader Agent job for the Distributor.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="bb65a-139">Cette étape n'est requise que pour les publications transactionnelles qui prennent en charge les Abonnés de mise à jour en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="bb65a-139">This step is only required for transactional publications that support queued updating subscribers.</span></span>  
  
3.  <span data-ttu-id="bb65a-140">(Facultatif) Mettez à jour l’exécution de [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) pour spécifier les valeurs non définies par défaut des paramètres qui implémentent les nouvelles fonctionnalités de réplication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-140">(Optional) Update the execution of [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
4.  <span data-ttu-id="bb65a-141">Après [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), exécutez [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) au niveau du serveur de publication sur la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-141">After [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="bb65a-142">Spécifiez **@publication** et les informations d’identification Windows sous lesquelles l’agent d’instantané s’exécute pour **@job_name** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-142">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-143">Si l'agent doit utiliser l'authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] lors de la connexion au serveur de publication, vous devez aussi spécifier la valeur **0** pour **@publisher_security_mode** et les informations de connexion [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **@publisher_login** et **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="bb65a-143">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="bb65a-144">Il s'ensuit la création d'un travail de l'Agent d'instantané pour la publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-144">This creates a Snapshot Agent job for the publication.</span></span>  
  
5.  <span data-ttu-id="bb65a-145">(Facultatif) Mettez à jour l’exécution de [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) pour spécifier les valeurs non définies par défaut des paramètres qui implémentent les nouvelles fonctionnalités de réplication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-145">(Optional) Update the execution of [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="bb65a-146">Pour mettre à niveau les scripts qui ajoutent des abonnements à une publication transactionnelle ou d'instantané</span><span class="sxs-lookup"><span data-stu-id="bb65a-146">To upgrade scripts that add subscriptions to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="bb65a-147">Après avoir exécuté la procédure stockée qui crée l'abonnement, veillez bien à exécuter celle qui crée un travail de l'Agent de distribution pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-147">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Distribution Agent job to synchronize the subscription.</span></span> <span data-ttu-id="bb65a-148">La procédure stockée que vous utilisez dépend du type d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-148">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="bb65a-149">Pour un abonnement par extraction, mettez à jour l’exécution de [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) afin de fournir les informations d’identification Windows sous lesquelles l’Agent de distribution s’exécute sur l’Abonné pour **@job_name** et **@job_password**.</span><span class="sxs-lookup"><span data-stu-id="bb65a-149">For a pull subscription, update the execution of [sp_addpullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-agent-transact-sql) to supply the Windows credentials under which the Distribution Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-150">Cette opération s'effectue après l'exécution de [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="bb65a-150">This is done after the execution of [sp_addpullsubscription](/sql/relational-databases/system-stored-procedures/sp-addpullsubscription-transact-sql).</span></span> <span data-ttu-id="bb65a-151">Pour plus d’informations, consultez [Créer un abonnement par extraction de données (pull)](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-151">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="bb65a-152">Pour un abonnement par émission de données, exécutez [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) sur le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-152">For a push subscription, execute [sp_addpushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="bb65a-153">Spécifiez **@subscriber** , **@subscriber_db** , **@publication** , les informations d’identification Windows sous lesquelles l’agent de distribution s’exécute sur le serveur de distribution pour **@job_name** et **@job_password** , ainsi qu’une planification pour ce travail de l’agent.</span><span class="sxs-lookup"><span data-stu-id="bb65a-153">Specify **@subscriber**, **@subscriber_db**, **@publication**, Windows credentials under which the Distribution Agent runs at the Distributor for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="bb65a-154">Pour plus d’informations, consultez [Spécifier des planifications de synchronisation](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-154">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="bb65a-155">Cette opération s'effectue après l'exécution de [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="bb65a-155">This is done after the execution of [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="bb65a-156">Pour plus d’informations, consultez [Créer un abonnement par émission (push)](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-156">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
### <a name="to-upgrade-scripts-that-configure-a-merge-publication"></a><span data-ttu-id="bb65a-157">Pour mettre à niveau les scripts qui configurent une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="bb65a-157">To upgrade scripts that configure a merge publication</span></span>  
  
1.  <span data-ttu-id="bb65a-158">(Facultatif) Dans le script existant, mettez à jour l’exécution de [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) pour spécifier les valeurs non définies par défaut des paramètres qui implémentent de nouvelles fonctionnalités de réplication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-158">(Optional) In the existing script, update the execution of [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
2.  <span data-ttu-id="bb65a-159">Après [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), exécutez [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) au niveau du serveur de publication sur la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-159">After [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql), execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql) at the Publisher on the publication database.</span></span> <span data-ttu-id="bb65a-160">Spécifiez **@publication** et les informations d’identification Windows sous lesquelles l’agent d’instantané s’exécute pour **@job_name** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-160">Specify **@publication** and the Windows credentials under which the Snapshot Agent runs for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-161">Si l'agent doit utiliser l'authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] lors de la connexion au serveur de publication, vous devez aussi spécifier la valeur **0** pour **@publisher_security_mode** et les informations de connexion [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **@publisher_login** et **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="bb65a-161">If the agent will use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher, you must also specify a value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="bb65a-162">Il s'ensuit la création d'un travail de l'Agent d'instantané pour la publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-162">This creates a Snapshot Agent job for the publication.</span></span>  
  
3.  <span data-ttu-id="bb65a-163">(Facultatif) Mettez à jour l’exécution de [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) pour spécifier les valeurs non définies par défaut des paramètres qui implémentent les nouvelles fonctionnalités de réplication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-163">(Optional) Update the execution of [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to set any non-default values for parameters that implement new replication functionalities.</span></span>  
  
### <a name="to-upgrade-scripts-that-add-subscriptions-to-a-merge-publication"></a><span data-ttu-id="bb65a-164">Pour mettre à niveau les scripts qui ajoutent des abonnements à une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="bb65a-164">To upgrade scripts that add subscriptions to a merge publication</span></span>  
  
1.  <span data-ttu-id="bb65a-165">Après avoir exécuté la procédure stockée qui crée l'abonnement, veillez bien à exécuter celle qui crée un travail de l'Agent de fusion pour synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-165">After executing the stored procedure that creates the subscription, ensure that you execute the stored procedure that creates a Merge Agent job to synchronize the subscription.</span></span> <span data-ttu-id="bb65a-166">La procédure stockée que vous utilisez dépend du type d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-166">The stored procedure that you use will depend on the type of subscription.</span></span>  
  
    -   <span data-ttu-id="bb65a-167">Pour un abonnement par extraction, mettez à jour l’exécution de [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) afin de fournir les informations d’identification Windows sous lesquelles l’Agent de fusion s’exécute sur l’Abonné pour **@job_name** et **@job_password**.</span><span class="sxs-lookup"><span data-stu-id="bb65a-167">For a pull subscription, update the execution of [sp_addmergepullsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql) to supply the Windows credentials under which the Merge Agent runs at the Subscriber for **@job_name** and **@job_password**.</span></span> <span data-ttu-id="bb65a-168">Cette opération s'effectue après l'exécution de [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="bb65a-168">This is done after the execution of [sp_addmergepullsubscription](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-transact-sql).</span></span> <span data-ttu-id="bb65a-169">Pour plus d’informations, consultez [Créer un abonnement par extraction de données (pull)](../create-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-169">For more information, see [Create a Pull Subscription](../create-a-pull-subscription.md).</span></span>  
  
    -   <span data-ttu-id="bb65a-170">Pour un abonnement par émission de données, exécutez [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) sur le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="bb65a-170">For a push subscription, execute [sp_addmergepushsubscription_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql) at the Publisher.</span></span> <span data-ttu-id="bb65a-171">Spécifiez **@subscriber** , **@subscriber_db** ,, **@publication** les informations d’identification Windows sous lesquelles l’agent de fusion sur le serveur de distribution s’exécute pour **@job_name** et **@job_password** , ainsi qu’une planification pour ce travail de l’agent.</span><span class="sxs-lookup"><span data-stu-id="bb65a-171">Specify **@subscriber**, **@subscriber_db**, **@publication**, the Windows credentials under which the Merge Agent at the Distributor runs for **@job_name** and **@job_password**, and a schedule for this agent job.</span></span> <span data-ttu-id="bb65a-172">Pour plus d’informations, consultez [Spécifier des planifications de synchronisation](../specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-172">For more information, see [Specify Synchronization Schedules](../specify-synchronization-schedules.md).</span></span> <span data-ttu-id="bb65a-173">Cette opération s'effectue après l'exécution de [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="bb65a-173">This is done after the execution of [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql).</span></span> <span data-ttu-id="bb65a-174">Pour plus d’informations, consultez [Créer un abonnement par émission (push)](../create-a-push-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="bb65a-174">For more information, see [Create a Push Subscription](../create-a-push-subscription.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="bb65a-175">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-175">Example</span></span>  
 <span data-ttu-id="bb65a-176">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] créant une publication transactionnelle pour la table Product.</span><span class="sxs-lookup"><span data-stu-id="bb65a-176">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a transactional publication for the Product table.</span></span> <span data-ttu-id="bb65a-177">Cette publication prend en charge la mise à jour immédiate avec la mise à jour en file d'attente comme basculement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-177">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="bb65a-178">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-178">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpub80.sql#sp_createtranpub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-179">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-179">Example</span></span>  
 <span data-ttu-id="bb65a-180">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée une publication transactionnelle, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-180">The following is an example of upgrading the previous script, which creates a transactional publication, to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-181">Cette publication prend en charge la mise à jour immédiate avec la mise à jour en file d'attente comme basculement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-181">This publication supports immediate updating with queued updating as failover.</span></span> <span data-ttu-id="bb65a-182">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-182">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-183">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-183">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpublication.sql#sp_createtranpub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-184">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-184">Example</span></span>  
 <span data-ttu-id="bb65a-185">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] qui crée une publication de fusion pour la table Customers.</span><span class="sxs-lookup"><span data-stu-id="bb65a-185">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a merge publication for the Customers table.</span></span> <span data-ttu-id="bb65a-186">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-186">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepub80.sql#sp_createmergepub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-187">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-187">Example</span></span>  
 <span data-ttu-id="bb65a-188">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée une publication de fusion, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-188">The following is an example of the previous script, which creates a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-189">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-189">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-190">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-190">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepublication.sql#sp_createmergepub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-191">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-191">Example</span></span>  
 <span data-ttu-id="bb65a-192">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] qui crée un abonnement par émission de données à une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="bb65a-192">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="bb65a-193">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-193">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwtranpushsub80.sql#sp_createtranpushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-194">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-194">Example</span></span>  
 <span data-ttu-id="bb65a-195">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée un abonnement par émission de données à une publication transactionnelle, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-195">The following is an example of the previous script, which creates a push subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-196">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-196">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-197">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-197">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createtranpushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-198">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-198">Example</span></span>  
 <span data-ttu-id="bb65a-199">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] qui crée un abonnement par émission de données à une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="bb65a-199">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a push subscription to a merge publication.</span></span> <span data-ttu-id="bb65a-200">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-200">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-201">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-201">Example</span></span>  
 <span data-ttu-id="bb65a-202">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée un abonnement par émission de données à une publication de fusion, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-202">The following is an example of the previous script, which creates a push subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-203">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-203">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-204">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-204">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpushsub.sql#sp_createmergepushsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-205">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-205">Example</span></span>  
 <span data-ttu-id="bb65a-206">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] qui crée un abonnement par extraction à une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="bb65a-206">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a transactional publication.</span></span> <span data-ttu-id="bb65a-207">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-207">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepushsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepushsub80.sql#sp_createmergepushsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-208">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-208">Example</span></span>  
 <span data-ttu-id="bb65a-209">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée un abonnement par extraction à une publication transactionnelle, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-209">The following is an example of the previous script, which creates a pull subscription to a transactional publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-210">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-210">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-211">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-211">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createtranpullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createtranpullsub_nwpostupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-212">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-212">Example</span></span>  
 <span data-ttu-id="bb65a-213">Ce qui suit est un exemple de script [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] qui crée un abonnement par extraction à une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="bb65a-213">The following is an example of a [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)] script that creates a pull subscription to a merge publication.</span></span> <span data-ttu-id="bb65a-214">Les paramètres par défaut ont été supprimés pour des raisons de lisibilité.</span><span class="sxs-lookup"><span data-stu-id="bb65a-214">Default parameters have been removed for readability.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpreupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwmergepullsub80.sql#sp_createmergepullsub_nwpreupgrade)]  
  
## <a name="example"></a><span data-ttu-id="bb65a-215">Exemple</span><span class="sxs-lookup"><span data-stu-id="bb65a-215">Example</span></span>  
 <span data-ttu-id="bb65a-216">Ce qui suit est un exemple de mise à niveau du précédent script, lequel crée un abonnement par extraction à une publication de fusion, pour qu'il s'exécute avec succès sous [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="bb65a-216">The following is an example of the previous script, which creates a pull subscription to a merge publication, upgraded to run successfully for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions.</span></span> <span data-ttu-id="bb65a-217">Les valeurs par défaut des nouveaux paramètres ont été déclarées explicitement.</span><span class="sxs-lookup"><span data-stu-id="bb65a-217">Defaults for new parameters have been explicitly declared.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="bb65a-218">Les informations d'identification Windows sont fournies pendant l'exécution à l'aide des variables de script **Sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="bb65a-218">Windows credentials are supplied at runtime using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_createmergepullsub_NWpostupgrade](../../../snippets/tsql/SQL15/replication/howto/tsql/createnwpullsub.sql#sp_createmergepullsub_nwpostupgrade)]  
  
## <a name="see-also"></a><span data-ttu-id="bb65a-219">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bb65a-219">See Also</span></span>  
 <span data-ttu-id="bb65a-220">[Create a Publication](../publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-220">[Create a Publication](../publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="bb65a-221">[Create a Push Subscription](../create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-221">[Create a Push Subscription](../create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="bb65a-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-222">[Create a Pull Subscription](../create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="bb65a-223">[Afficher et modifier les paramètres de sécurité de la réplication](../security/view-and-modify-replication-security-settings.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-223">[View and Modify Replication Security Settings](../security/view-and-modify-replication-security-settings.md) </span></span>  
 <span data-ttu-id="bb65a-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-224">[MSSQL_ENG021797](../mssql-eng021797.md) </span></span>  
 <span data-ttu-id="bb65a-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-225">[MSSQL_ENG021798](../mssql-eng021798.md) </span></span>  
 <span data-ttu-id="bb65a-226">[Concepts liés aux procédures stockées système de réplication](../concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="bb65a-226">[Replication System Stored Procedures Concepts](../concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="bb65a-227">Mettre à niveau des bases de données répliquées</span><span class="sxs-lookup"><span data-stu-id="bb65a-227">Upgrade Replicated Databases</span></span>](../../../database-engine/install-windows/upgrade-replicated-databases.md)  
  
  
