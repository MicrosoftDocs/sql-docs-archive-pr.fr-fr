---
title: Initialiser un abonnement transactionnel sans instantané | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- transactional replication, initializing
- replication [SQL Server], initializing
- initializing subscriptions [SQL Server replication], without snapshots
ms.assetid: 75c8c1f8-60bc-44a8-944b-d18d1f6bda11
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 88e240b75cdbb239548cfcb8e5d8df5eb2af2973
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87601327"
---
# <a name="initialize-a-transactional-subscription-without-a-snapshot"></a><span data-ttu-id="f2a72-102">Initialiser un abonnement transactionnel sans instantané</span><span class="sxs-lookup"><span data-stu-id="f2a72-102">Initialize a Transactional Subscription Without a Snapshot</span></span>
  <span data-ttu-id="f2a72-103">Par défaut, un abonnement à une publication transactionnelle est initialisé avec un instantané, lequel est généré par l'Agent d'instantané et appliqué par l'Agent de distribution.</span><span class="sxs-lookup"><span data-stu-id="f2a72-103">By default, a subscription to a transactional publication is initialized with a snapshot, which is generated by the Snapshot Agent and applied by the Distribution Agent.</span></span> <span data-ttu-id="f2a72-104">Dans certains scénarios, comme ceux impliquant de volumineux datasets initiaux, il est préférable d'initialiser un abonnement à l'aide d'une autre méthode.</span><span class="sxs-lookup"><span data-stu-id="f2a72-104">In some scenarios, such as those involving large initial datasets, it is preferable to initialize a subscription using another method.</span></span> <span data-ttu-id="f2a72-105">Autres méthodes d'initialisation d'un abonné :</span><span class="sxs-lookup"><span data-stu-id="f2a72-105">Other methods of initializing a Subscriber include:</span></span>  
  
-   <span data-ttu-id="f2a72-106">Spécifier une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f2a72-106">Specifying a backup.</span></span> <span data-ttu-id="f2a72-107">Restaurez la sauvegarde sur l'Abonné, l'Agent de distribution copie ensuite toutes les métadonnées de réplication et procédures système requises.</span><span class="sxs-lookup"><span data-stu-id="f2a72-107">Restore the backup on the Subscriber, and then the Distribution Agent copies any required replication metadata and system procedures.</span></span> <span data-ttu-id="f2a72-108">L'initialisation avec une sauvegarde est le moyen le plus rapide pour remettre les données sur l'Abonné, c'est également un moyen pratique, car vous pouvez utiliser n'importe quelle sauvegarde récente si celle-ci a été effectuée après que la publication ait été activée pour l'initialisation avec une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f2a72-108">Initializing with a backup is the fastest way to deliver data to the Subscriber and is convenient, because any recent backup can be used if it was taken after the publication was enabled for initialization with a backup.</span></span>  
  
-   <span data-ttu-id="f2a72-109">Copier un dataset initial sur l'Abonné par un autre mécanisme, comme l'attachement d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="f2a72-109">Copying an initial dataset to the Subscriber through another mechanism, such as attaching a database.</span></span> <span data-ttu-id="f2a72-110">Vous devez vous assurer que les données et schéma corrects se trouvent sur l'Abonné, l'Agent de distribution copie ensuite toutes les métadonnées et procédures système requises.</span><span class="sxs-lookup"><span data-stu-id="f2a72-110">You must ensure the correct data and schema are at the Subscriber, and then the Distribution Agent copies any required metadata and system procedures.</span></span>  
  
## <a name="initializing-a-subscription-with-a-backup"></a><span data-ttu-id="f2a72-111">Initialisation d'un abonnement avec une sauvegarde</span><span class="sxs-lookup"><span data-stu-id="f2a72-111">Initializing a subscription with a backup</span></span>  
 <span data-ttu-id="f2a72-112">Une sauvegarde contient une base de données complète ; de ce fait, chaque base de données d'abonnement contiendra une copie complète de la base de données de publication lorsqu'elle est est initialisée :</span><span class="sxs-lookup"><span data-stu-id="f2a72-112">A backup contains an entire database; therefore each subscription database will contain a complete copy of the publication database when it is initialized:</span></span>  
  
-   <span data-ttu-id="f2a72-113">La sauvegarde inclut des tables n'étant pas spécifiées comme des articles pour la publication.</span><span class="sxs-lookup"><span data-stu-id="f2a72-113">The backup includes tables not specified as articles for the publication.</span></span>  
  
-   <span data-ttu-id="f2a72-114">La sauvegarde inclut toutes les données, même si des filtres de lignes ou de colonnes sont spécifiés sur une table.</span><span class="sxs-lookup"><span data-stu-id="f2a72-114">The backup includes all data, even if row or column filters are specified on a table.</span></span>  
  
 <span data-ttu-id="f2a72-115">L'administrateur ou l'application est responsable de la suppression de tout objet ou donnée non sollicité une fois que la sauvegarde a été restaurée.</span><span class="sxs-lookup"><span data-stu-id="f2a72-115">It is the responsibility of the administrator or application to remove any unwanted objects or data after the backup has been restored.</span></span> <span data-ttu-id="f2a72-116">Dans les synchronisations suivantes, les modifications de données sont répliquées uniquement si elles s'appliquent à des tables spécifiées comme des articles, et que les modifications répondent à tous les critères de filtrage spécifiés.</span><span class="sxs-lookup"><span data-stu-id="f2a72-116">In subsequent synchronizations, data changes are only replicated if they apply to tables specified as articles, and the changes meet any filtering criteria you specified.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f2a72-117">Lors de la restauration d'une sauvegarde, vous devez vous assurer que la sauvegarde provient d'un serveur de publication si vous voulez que l'Abonné se synchronise automatiquement.</span><span class="sxs-lookup"><span data-stu-id="f2a72-117">When restoring a backup, you must ensure that the backup came from the Publisher if you want the Subscriber to automatically synchronize.</span></span> <span data-ttu-id="f2a72-118">Les valeurs du numéro séquentiel dans le journal (LSN) de la sauvegarde (utilisées pour définir le point de démarrage de la synchronisation) sont spécifiques au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="f2a72-118">The log sequence number (LSN) values in the backup (which are used to set the point at which to start synchronizing) are specific to the Publisher.</span></span>  
  
 <span data-ttu-id="f2a72-119">**Pour initialiser un abonnement avec une sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="f2a72-119">**To initialize a subscription with a backup**</span></span>  
  
 <span data-ttu-id="f2a72-120">Pour initialiser un abonnement avec une sauvegarde, vous devez d'abord activer l'option lorsque vous créez une publication, puis spécifier des valeurs pour plusieurs options lorsque vous créez un abonnement.</span><span class="sxs-lookup"><span data-stu-id="f2a72-120">To initialize a subscription with a backup, you first must enable the option when you create a publication, and then specify values for a number of options when you create a subscription.</span></span> <span data-ttu-id="f2a72-121">Les publications peuvent être activées par le biais de l'Assistant Nouvelle publication ou par programme.</span><span class="sxs-lookup"><span data-stu-id="f2a72-121">Publications can be enabled through the New Publication Wizard or programmatically.</span></span> <span data-ttu-id="f2a72-122">Cependant, les valeurs requises pour les options d'abonnement ne peuvent être spécifiées que par programme.</span><span class="sxs-lookup"><span data-stu-id="f2a72-122">However, the values required for the subscription options can only be specified programmatically.</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="f2a72-123">: [Activer l’initialisation avec une sauvegarde pour les publications transactionnelles &#40;SQL Server Management Studio&#41;](enable-initialization-with-backup-for-transactional-publications.md)</span><span class="sxs-lookup"><span data-stu-id="f2a72-123">: [Enable Initialization with a Backup for Transactional Publications &#40;SQL Server Management Studio&#41;](enable-initialization-with-backup-for-transactional-publications.md)</span></span>  
  
-   <span data-ttu-id="f2a72-124">Programmation Transact-SQL de la réplication : [Initialiser un abonnement transactionnel à partir d’une sauvegarde &#40;programmation Transact-SQL de la réplication&#41;](initialize-a-transactional-subscription-from-a-backup.md)</span><span class="sxs-lookup"><span data-stu-id="f2a72-124">Replication Transact-SQL programming: [Initialize a Transactional Subscription from a Backup &#40;Replication Transact-SQL Programming&#41;](initialize-a-transactional-subscription-from-a-backup.md)</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f2a72-125">Si un abonnement est initialisé sans utiliser un instantané, le compte sous lequel fonctionne le service SQL Server sur le serveur de publication doit disposer d'autorisations d'écriture sur le dossier d'instantanés sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="f2a72-125">If a subscription is initialized without using a snapshot, the account under which the SQL Server service runs at the Publisher must have write permissions on the snapshot folder at the Distributor.</span></span> <span data-ttu-id="f2a72-126">Pour plus d'informations sur les autorisations, consultez [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="f2a72-126">For more information about permissions, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
### <a name="ensuring-the-suitability-of-a-backup"></a><span data-ttu-id="f2a72-127">Vérification de la pertinence d'une sauvegarde</span><span class="sxs-lookup"><span data-stu-id="f2a72-127">Ensuring the suitability of a backup</span></span>  
 <span data-ttu-id="f2a72-128">Une sauvegarde est appropriée à l'initialisation d'un abonné si toutes les transactions se produisant après avoir effectué la sauvegarde sont stockées sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="f2a72-128">A backup is suitable for initializing a Subscriber if all transactions that occur after the backup was taken are stored at the Distributor.</span></span> <span data-ttu-id="f2a72-129">La réplication affichera un message d'erreur si la sauvegarde n'est pas appropriée.</span><span class="sxs-lookup"><span data-stu-id="f2a72-129">Replication will display an error message if the backup is not suitable.</span></span>  
  
 <span data-ttu-id="f2a72-130">Afin de vous assurer que l'utilisation d'une sauvegarde est appropriée, suivez les instructions suivantes :</span><span class="sxs-lookup"><span data-stu-id="f2a72-130">To help ensure that a backup is suitable for use, follow these guidelines:</span></span>  
  
-   <span data-ttu-id="f2a72-131">Utilisez la dernière sauvegarde disponible, et si elle est plus ancienne que la période de rétention de distribution maximale, créez une nouvelle sauvegarde avant de tenter d'initialiser un abonnement avec une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f2a72-131">Use the latest backup available, and if the latest backup is older than the maximum distribution retention period, create a new backup before attempting to initialize a subscription with a backup.</span></span> <span data-ttu-id="f2a72-132">Pour plus d'informations sur la période de rétention, consultez [Subscription Expiration and Deactivation](subscription-expiration-and-deactivation.md).</span><span class="sxs-lookup"><span data-stu-id="f2a72-132">For more information about retention period, see [Subscription Expiration and Deactivation](subscription-expiration-and-deactivation.md).</span></span>  
  
-   <span data-ttu-id="f2a72-133">Par défaut, les travaux de nettoyage de la distribution effacent les transactions de plus de 72 heures de la base de données de distribution.</span><span class="sxs-lookup"><span data-stu-id="f2a72-133">By default, the distribution cleanup job clears transactions older than 72 hours from the distribution database.</span></span> <span data-ttu-id="f2a72-134">Le nettoyage est basé sur la période de rétention définie pour la publication.</span><span class="sxs-lookup"><span data-stu-id="f2a72-134">Cleanup is based on the retention period set for the publication.</span></span> <span data-ttu-id="f2a72-135">Lors de la synchronisation avec d'anciennes sauvegardes, envisagez de désactiver temporairement le travail avant la sauvegarde que vous souhaitez restaurer, puis de le réactiver une fois l'abonnement créé avec succès.</span><span class="sxs-lookup"><span data-stu-id="f2a72-135">When synchronizing with older backups, consider temporarily disabling the job before the backup you would like to restore and re-enabling it after the subscription is successfully created.</span></span> <span data-ttu-id="f2a72-136">Cela évite la suppression de transactions de la base de données de distribution pouvant s'avérer nécessaires à la réussite de la synchronisation à partir de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f2a72-136">This prevents removal of transactions from the distribution database that might be needed to synchronize successfully from the backup.</span></span> <span data-ttu-id="f2a72-137">Pour obtenir des informations sur l’exécution des travaux de maintenance, consultez [Exécuter des travaux de maintenance de réplication &#40;SQL Server Management Studio&#41;](administration/run-replication-maintenance-jobs-sql-server-management-studio.md).</span><span class="sxs-lookup"><span data-stu-id="f2a72-137">For information about running cleanup jobs, see [Run Replication Maintenance Jobs &#40;SQL Server Management Studio&#41;](administration/run-replication-maintenance-jobs-sql-server-management-studio.md).</span></span>  
  
 <span data-ttu-id="f2a72-138">Dans certains cas, vous devez effectuer manuellement des personnalisations dans la base de données restaurée de l'Abonné après avoir configuré des abonnements initialisés par une sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="f2a72-138">In some cases you must manually perform customizations in the restored Subscriber database after setting up subscriptions that are initialized with a backup.</span></span> <span data-ttu-id="f2a72-139">En général, les modifications manuelles sur la base de données restaurée de l'Abonné sont nécessaires, si la publication est définie de telle sorte que le contenu de la base de données de l'Abonné est supposé être différent du contenu de la base de données du serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="f2a72-139">In general, manual modifications at the restored Subscriber database are required if the Publication is defined in such a way that the Subscriber database content is expected to be different from the Publisher database content.</span></span>  
  
-   <span data-ttu-id="f2a72-140">Les vues indexées sur la base de données restaurée doivent être converties en tables si elles sont publiées en tant qu'articles de la vue indexée sur la table basés sur un journal</span><span class="sxs-lookup"><span data-stu-id="f2a72-140">Indexed-views at the restored database have to be converted to tables if they are published as log-based indexed-view-to-table articles</span></span>  
  
-   <span data-ttu-id="f2a72-141">Les colonnes de type timestamp abonnées à la base de données restaurée doivent être converties en colonnes **binary(8)** : copiez le contenu des tables contenant les colonnes timestamp vers de nouvelles tables avec des schémas correspondants, sauf pour les colonnes timestamp qui sont remplacées par les colonnes **binary(8)** , supprimez les tables d'origine, et renommez les nouvelles tables avec les mêmes noms que les tables d'origine.</span><span class="sxs-lookup"><span data-stu-id="f2a72-141">Subscribed timestamp columns at the restored database must be converted to **binary(8)** columns: copy the content of the tables containing timestamp columns to new tables with matching schemas except having **binary(8)** columns in place of the timestamp columns, drop the original tables, and rename the new tables with the same names as the original tables.</span></span>  
  
## <a name="initializing-a-subscription-with-an-alternative-method"></a><span data-ttu-id="f2a72-142">Initialisation d'un abonnement avec une méthode de remplacement</span><span class="sxs-lookup"><span data-stu-id="f2a72-142">Initializing a subscription with an alternative method</span></span>  
 <span data-ttu-id="f2a72-143">Il est possible d'initialiser un abonnement à l'aide de n'importe quelle méthode vous autorisant à copier le schéma de la base de données de publication et les données sur l'Abonné, comme [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f2a72-143">It is possible to initialize a subscription using any method that allows you to copy the publication database schema and data to the Subscriber, such as [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span></span> <span data-ttu-id="f2a72-144">Lorsque vous utilisez une méthode de remplacement pour initialiser l'Abonné, les objets de prise en charge de la réplication sont copiés sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="f2a72-144">When you use an alternative method to initialize the Subscriber, replication support objects are copied to the Subscriber.</span></span>  
  
 <span data-ttu-id="f2a72-145">Contrairement à l'initialisation avec une sauvegarde, vous, ou votre application, devez vous assurer que les données et le schéma sont correctement synchronisés au moment d'ajouter l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="f2a72-145">Unlike initializing with a backup, you or your application must ensure the data and schema are properly synchronized at the time you add the subscription.</span></span> <span data-ttu-id="f2a72-146">Si par exemple il y a une activité sur le serveur de publication entre le moment où les données et le schéma sont copiés vers l'Abonné et le moment auquel l'abonnement est ajouté, les modifications résultant de cette activité peuvent ne pas être répliquées vers l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="f2a72-146">If, for example, there is activity on the Publisher between the time data and schema are copied to the Subscriber and the time at which the subscription is added, changes resulting from this activity might not be replicated to the Subscriber.</span></span>  
  
 <span data-ttu-id="f2a72-147">Pour initialiser un abonnement avec une méthode de remplacement, consultez [Initialize a Subscription Manually](initialize-a-subscription-manually.md).</span><span class="sxs-lookup"><span data-stu-id="f2a72-147">To initialize a subscription with an alternative method, see [Initialize a Subscription Manually](initialize-a-subscription-manually.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f2a72-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f2a72-148">See Also</span></span>  
 [<span data-ttu-id="f2a72-149">Initialiser un abonnement</span><span class="sxs-lookup"><span data-stu-id="f2a72-149">Initialize a Subscription</span></span>](initialize-a-subscription.md)  
  
  
