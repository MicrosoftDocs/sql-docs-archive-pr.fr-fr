---
title: Implémenter un gestionnaire de logique métier pour un article de fusion | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], business logic handlers
- merge replication business logic handlers [SQL Server replication]
- conflict resolution [SQL Server replication], merge replication
- business logic handlers [SQL Server replication]
- BusinessLogicModule class
ms.assetid: ed477595-6d46-4fa2-b0d3-a5358903ec05
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c2996a8ca8471ef59d4781e21239a72262daa759
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87601335"
---
# <a name="implement-a-business-logic-handler-for-a-merge-article"></a><span data-ttu-id="89e0e-102">Implémenter un gestionnaire de logique métier pour un article de fusion</span><span class="sxs-lookup"><span data-stu-id="89e0e-102">Implement a Business Logic Handler for a Merge Article</span></span>
  <span data-ttu-id="89e0e-103">Cette rubrique décrit comment implémenter un gestionnaire de logique métier pour un article de fusion dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] à l'aide de la programmation de réplication ou d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="89e0e-103">This topic describes how to implement a business logic handler for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using replication programming or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="89e0e-104">L'espace de noms <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> implémente une interface qui vous permet d'écrire une logique métier complexe afin de gérer les événements qui se produisent au cours du processus de synchronisation de la réplication de fusion.</span><span class="sxs-lookup"><span data-stu-id="89e0e-104">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="89e0e-105">Les méthodes dans le gestionnaire de logique métier peuvent être appelées par le processus de réplication pour chaque ligne modifiée qui est répliquée pendant la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="89e0e-105">Methods in the business logic handler can be invoked by the replication process for each changed row that is replicated during synchronization.</span></span>  
  
 <span data-ttu-id="89e0e-106">La procédure globale permettant d'implémenter un gestionnaire de logique métier est la suivante :</span><span class="sxs-lookup"><span data-stu-id="89e0e-106">The general process for implementing a business logic handler is:</span></span>  
  
1.  <span data-ttu-id="89e0e-107">Créez l'assembly du gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-107">Create the business logic hander assembly.</span></span>  
  
2.  <span data-ttu-id="89e0e-108">Inscrivez l'assembly sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="89e0e-108">Register the assembly at the Distributor.</span></span>  
  
3.  <span data-ttu-id="89e0e-109">Déployez l'assembly sur le serveur où l'Agent de fusion s'exécute.</span><span class="sxs-lookup"><span data-stu-id="89e0e-109">Deploy the assembly at the server on which the Merge Agent runs.</span></span> <span data-ttu-id="89e0e-110">Pour un abonnement par extraction, l'agent s'exécute sur l'Abonné, alors que pour un abonnement par émission de données, il s'exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="89e0e-110">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="89e0e-111">Lorsque vous utilisez la synchronisation Web, l'agent s'exécute sur le serveur Web.</span><span class="sxs-lookup"><span data-stu-id="89e0e-111">When you are using Web synchronization, the agent runs on the Web server.</span></span>  
  
4.  <span data-ttu-id="89e0e-112">Créez un article qui utilise le gestionnaire de logique métier ou modifiez un article existant pour utiliser le gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-112">Create an article that uses the business logic handler or modify an existing article to use the business logic handler.</span></span>  
  
 <span data-ttu-id="89e0e-113">Le gestionnaire de logique métier que vous spécifiez est exécuté pour chaque ligne faisant l'objet d'une synchronisation.</span><span class="sxs-lookup"><span data-stu-id="89e0e-113">The business logic handler you specify is executed for every row that is synchronized.</span></span> <span data-ttu-id="89e0e-114">Une logique complexe et des appels à d'autres applications ou services réseau peuvent avoir une incidence sur les performances.</span><span class="sxs-lookup"><span data-stu-id="89e0e-114">Complex logic and calls to other applications or network services can impact performance.</span></span> <span data-ttu-id="89e0e-115">Pour plus d’informations sur les gestionnaires de logique métier, consultez [Exécuter une logique pendant la synchronisation de fusion](merge/execute-business-logic-during-merge-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="89e0e-115">For more information about business logic handlers, see [Execute Business Logic During Merge Synchronization](merge/execute-business-logic-during-merge-synchronization.md).</span></span>  
  
 <span data-ttu-id="89e0e-116">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="89e0e-116">**In This Topic**</span></span>  
  
-   <span data-ttu-id="89e0e-117">**Pour implémenter un gestionnaire de logique métier pour un article de fusion à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="89e0e-117">**To implement a business logic handler for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="89e0e-118">Programmation de la réplication</span><span class="sxs-lookup"><span data-stu-id="89e0e-118">Replication Programming</span></span>](#ReplProg)  
  
     [<span data-ttu-id="89e0e-119">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="89e0e-119">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-replication-programming"></a><a name="ReplProg"></a> <span data-ttu-id="89e0e-120">Utilisation de la programmation de la réplication</span><span class="sxs-lookup"><span data-stu-id="89e0e-120">Using Replication Programming</span></span>  
  
#### <a name="to-create-and-deploy-a-business-logic-handler"></a><span data-ttu-id="89e0e-121">Pour créer et déployer un gestionnaire de logique métier</span><span class="sxs-lookup"><span data-stu-id="89e0e-121">To create and deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="89e0e-122">Dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, créez un projet pour l'assembly .NET contenant le code qui implémente le gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-122">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="89e0e-123">Ajoutez des références au projet pour les espaces de noms ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="89e0e-123">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="89e0e-124">Référence d'assembly</span><span class="sxs-lookup"><span data-stu-id="89e0e-124">Assembly Reference</span></span>|<span data-ttu-id="89e0e-125">Emplacement</span><span class="sxs-lookup"><span data-stu-id="89e0e-125">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="89e0e-126">COM (installation par défaut)</span><span class="sxs-lookup"><span data-stu-id="89e0e-126">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="89e0e-127">GAC (composant du .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="89e0e-127">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="89e0e-128">GAC (composant du .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="89e0e-128">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="89e0e-129">Ajoutez une classe qui remplace la classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-129">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="89e0e-130">Implémentez la propriété <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> pour indiquer les types de modifications qui sont gérés.</span><span class="sxs-lookup"><span data-stu-id="89e0e-130">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="89e0e-131">Remplacez une ou plusieurs des méthodes suivantes de la classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> :</span><span class="sxs-lookup"><span data-stu-id="89e0e-131">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="89e0e-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> – méthode appelée lorsqu'une modification de données est validée pendant la synchronisation ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-132"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="89e0e-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> – méthode appelée lorsqu'une erreur se produit quand une instruction DELETE est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-133"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked when an error occurs when a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> – méthode appelée lorsque des instructions DELETE sont téléchargées vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-134"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> – méthode appelée lorsqu'une erreur se produit quand une instruction INSERT est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-135"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked when an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> – méthode appelée lorsque des instructions INSERT sont téléchargées vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-136"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> – méthode appelée lorsque des instructions UPDATE en conflit se produisent sur le serveur de publication et l'Abonné ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-137"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="89e0e-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> – méthode appelée lorsque des instructions UPDATE entrent en conflit avec des instructions DELETE sur le serveur de publication et l'Abonné ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-138"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="89e0e-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> – méthode appelée lorsqu'une erreur se produit quand une instruction UPDATE est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-139"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked when an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> – méthode appelée lorsque des instructions UPDATE sont téléchargées vers ou à partir du serveur.</span><span class="sxs-lookup"><span data-stu-id="89e0e-140"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
6.  <span data-ttu-id="89e0e-141">Générez le projet pour créer l'assembly du gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-141">Build the project to create the business logic handler assembly.</span></span>  
  
7.  <span data-ttu-id="89e0e-142">Déployez l'assembly dans le répertoire contenant le fichier exécutable de l'Agent de fusion (replmerg.exe), qui est pour une installation par défaut [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM, ou installez-le dans le .NET Global Assembly Cache (GAC).</span><span class="sxs-lookup"><span data-stu-id="89e0e-142">Deploy the assembly in the directory that contains the Merge Agent executable file (replmerg.exe), which for a default installation is [!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]COM, or install it in the .NET global assembly cache (GAC).</span></span> <span data-ttu-id="89e0e-143">Vous devez installer l'assembly dans le GAC seulement si des applications autres que l'Agent de fusion requièrent l'accès à l'assembly.</span><span class="sxs-lookup"><span data-stu-id="89e0e-143">You should only install the assembly in the GAC if applications other than the Merge Agent require access to the assembly.</span></span> <span data-ttu-id="89e0e-144">L'assembly peut être installé dans le GAC à l'aide de l'outil Global Assembly Cache (**Gacutil.exe)** fourni dans le Kit de développement .NET Framework SDK.</span><span class="sxs-lookup"><span data-stu-id="89e0e-144">The assembly can be installed into the GAC using the Global Assembly Cache tool (**Gacutil.exe)** provided in the .NET Framework SDK.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="89e0e-145">Un gestionnaire de logique métier doit être déployé sur chaque serveur sur lequel l'Agent de fusion s'exécute, ce qui inclut le serveur IIS qui héberge replisapi.dll lors de l'utilisation de la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="89e0e-145">A business logic handler must be deployed on every server on which the Merge Agent runs, which includes the IIS server that hosts the replisapi.dll when using Web synchronization.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="89e0e-146">Pour inscrire un gestionnaire de logique métier</span><span class="sxs-lookup"><span data-stu-id="89e0e-146">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="89e0e-147">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) pour vérifier que l’assembly n’a pas été inscrit en tant que gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-147">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the assembly has not already been registered as a business logic handler.</span></span>  
  
2.  <span data-ttu-id="89e0e-148">Sur le serveur de distribution, exécutez [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), en spécifiant un nom convivial pour le gestionnaire de logique métier pour **@article_resolver** , `true` la valeur pour **@is_dotnet_assembly** , le nom de l’assembly pour **@dotnet_assembly_name** et le nom complet de la classe qui substitue <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> pour **@dotnet_class_name** .</span><span class="sxs-lookup"><span data-stu-id="89e0e-148">At the Distributor, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), specifying a friendly name for the business logic handler for **@article_resolver**, a value of `true` for **@is_dotnet_assembly**, the name of the assembly for **@dotnet_assembly_name**, and the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> for **@dotnet_class_name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="89e0e-149">Si l’assembly n’est pas déployé dans le même répertoire que le fichier exécutable Agent de fusion, dans le même répertoire que l’application qui démarre de façon synchrone le Agent de fusion ou dans le Global Assembly Cache (GAC), vous devez spécifier le chemin d’accès complet avec le nom de l’assembly pour **@dotnet_assembly_name** .</span><span class="sxs-lookup"><span data-stu-id="89e0e-149">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the global assembly cache (GAC), you need to specify the full path with the assembly name for **@dotnet_assembly_name**.</span></span> <span data-ttu-id="89e0e-150">Lorsque vous utilisez la synchronisation Web, vous devez spécifier l'emplacement de l'assembly sur le serveur Web.</span><span class="sxs-lookup"><span data-stu-id="89e0e-150">When using Web synchronization, you must specify the location of assembly at the Web server.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="89e0e-151">Pour utiliser un gestionnaire de logique métier avec un nouvel article de table</span><span class="sxs-lookup"><span data-stu-id="89e0e-151">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="89e0e-152">Exécutez [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) pour définir un article, en spécifiant le nom convivial du gestionnaire de logique métier pour **@article_resolver**.</span><span class="sxs-lookup"><span data-stu-id="89e0e-152">Execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying the friendly name of the business logic handler for **@article_resolver**.</span></span> <span data-ttu-id="89e0e-153">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="89e0e-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="89e0e-154">Pour utiliser un gestionnaire de logique métier avec un article de table existant</span><span class="sxs-lookup"><span data-stu-id="89e0e-154">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="89e0e-155">Exécutez [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), en spécifiant **@publication** , **@article** , une valeur de **article_resolver** pour **@property** et le nom convivial du gestionnaire de logique métier pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="89e0e-155">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the business logic handler for **@value**.</span></span>  
  
###  <a name="examples-replication-programming"></a><a name="TsqlExample"></a> <span data-ttu-id="89e0e-156">Exemples (programmation de la réplication)</span><span class="sxs-lookup"><span data-stu-id="89e0e-156">Examples (Replication Programming)</span></span>  
 <span data-ttu-id="89e0e-157">Cet exemple illustre un gestionnaire de logique métier qui crée un journal d'audit.</span><span class="sxs-lookup"><span data-stu-id="89e0e-157">This example shows a business logic handler that creates an audit log.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="89e0e-158">L'exemple ci-dessous inscrit un assembly du gestionnaire de logique métier sur le serveur de distribution et modifie un article de fusion existant afin d'utiliser cette logique métier personnalisée.</span><span class="sxs-lookup"><span data-stu-id="89e0e-158">The following example registers a business logic handler assembly at the Distributor and changes an existing merge article to use this custom business logic.</span></span>  
  
 [!code-sql[HowTo#sp_RegisterBLH_10](../../snippets/tsql/SQL15/replication/howto/tsql/registerblh_10.sql#sp_registerblh_10)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="89e0e-159">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="89e0e-159">Using Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-create-a-business-logic-handler"></a><span data-ttu-id="89e0e-160">Pour créer un gestionnaire de logique métier</span><span class="sxs-lookup"><span data-stu-id="89e0e-160">To create a business logic handler</span></span>  
  
1.  <span data-ttu-id="89e0e-161">Dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, créez un projet pour l'assembly .NET contenant le code qui implémente le gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-161">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Studio, create a new project for the .NET assembly that contains the code that implements the business logic handler.</span></span>  
  
2.  <span data-ttu-id="89e0e-162">Ajoutez des références au projet pour les espaces de noms ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="89e0e-162">Add references to the project for the following namespaces.</span></span>  
  
    |<span data-ttu-id="89e0e-163">Référence d'assembly</span><span class="sxs-lookup"><span data-stu-id="89e0e-163">Assembly Reference</span></span>|<span data-ttu-id="89e0e-164">Emplacement</span><span class="sxs-lookup"><span data-stu-id="89e0e-164">Location</span></span>|  
    |------------------------|--------------|  
    |<xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>|[!INCLUDE[ssInstallPath](../../includes/ssinstallpath-md.md)]<span data-ttu-id="89e0e-165">COM (installation par défaut)</span><span class="sxs-lookup"><span data-stu-id="89e0e-165">COM (default installation)</span></span>|  
    |<xref:System.Data>|<span data-ttu-id="89e0e-166">GAC (composant du .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="89e0e-166">GAC (component of the .NET Framework)</span></span>|  
    |<xref:System.Data.Common>|<span data-ttu-id="89e0e-167">GAC (composant du .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="89e0e-167">GAC (component of the .NET Framework)</span></span>|  
  
3.  <span data-ttu-id="89e0e-168">Ajoutez une classe qui remplace la classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-168">Add a class that overrides the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class.</span></span>  
  
4.  <span data-ttu-id="89e0e-169">Implémentez la propriété <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> pour indiquer les types de modifications qui sont gérés.</span><span class="sxs-lookup"><span data-stu-id="89e0e-169">Implement the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.HandledChangeStates%2A> property to indicate the types of changes that are handled.</span></span>  
  
5.  <span data-ttu-id="89e0e-170">Remplacez une ou plusieurs des méthodes suivantes de la classe <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> :</span><span class="sxs-lookup"><span data-stu-id="89e0e-170">Override one or more of the following methods of the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> class:</span></span>  
  
    -   <span data-ttu-id="89e0e-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> – méthode appelée lorsqu'une modification de données est validée pendant la synchronisation ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-171"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.CommitHandler%2A> - invoked when a data change is committed during synchronization.</span></span>  
  
    -   <span data-ttu-id="89e0e-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> – méthode appelée si une erreur se produit pendant qu'une instruction DELETE est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-172"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteErrorHandler%2A> - invoked if an error occurs while a DELETE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> – méthode appelée lorsque des instructions DELETE sont téléchargées vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-173"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.DeleteHandler%2A> - invoked when DELETE statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> – méthode appelée si une erreur se produit pendant qu'une instruction INSERT est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-174"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertErrorHandler%2A> - invoked if an error occurs when an INSERT statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> – méthode appelée lorsque des instructions INSERT sont téléchargées vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-175"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.InsertHandler%2A> - invoked when INSERT statements are being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> – méthode appelée lorsque des instructions UPDATE en conflit se produisent sur le serveur de publication et l'Abonné ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-176"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateConflictsHandler%2A> - invoked when conflicting UPDATE statements occur at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="89e0e-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> – méthode appelée lorsque des instructions UPDATE entrent en conflit avec des instructions DELETE sur le serveur de publication et l'Abonné ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-177"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateDeleteConflictHandler%2A> - invoked when UPDATE statements conflict with DELETE statements at the Publisher and Subscriber.</span></span>  
  
    -   <span data-ttu-id="89e0e-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> – méthode appelée si une erreur se produit pendant qu'une instruction UPDATE est téléchargée vers ou à partir du serveur ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-178"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateErrorHandler%2A> - invoked if an error occurs when an UPDATE statement is being uploaded or downloaded.</span></span>  
  
    -   <span data-ttu-id="89e0e-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> – méthode appelée lorsque des instructions UPDATE sont téléchargées vers ou à partir du serveur.</span><span class="sxs-lookup"><span data-stu-id="89e0e-179"><xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule.UpdateHandler%2A> - invoked when UPDATE statements are being uploaded or downloaded.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="89e0e-180">Tous les conflits d'un article qui ne sont pas gérés explicitement par votre logique métier personnalisée sont gérés par le programme de résolution par défaut pour l'article.</span><span class="sxs-lookup"><span data-stu-id="89e0e-180">Any article conflicts not explicitly handled by your custom business logic are handled by the default resolver for the article.</span></span>  
  
6.  <span data-ttu-id="89e0e-181">Générez le projet pour créer l'assembly du gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-181">Build the project to create the business logic handler assembly.</span></span>  
  
#### <a name="to-register-a-business-logic-handler"></a><span data-ttu-id="89e0e-182">Pour inscrire un gestionnaire de logique métier</span><span class="sxs-lookup"><span data-stu-id="89e0e-182">To register a business logic handler</span></span>  
  
1.  <span data-ttu-id="89e0e-183">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-183">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="89e0e-184">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.ReplicationServer>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-184">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationServer> class.</span></span> <span data-ttu-id="89e0e-185">Passez l'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="89e0e-185">Pass the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1.</span></span>  
  
3.  <span data-ttu-id="89e0e-186">Appelez <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> et vérifiez l'objet <xref:System.Collections.ArrayList> retourné pour vous assurer que l'assembly n'a pas déjà été inscrit en tant que gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-186">Call <xref:Microsoft.SqlServer.Replication.ReplicationServer.EnumBusinessLogicHandlers%2A> and check the returned <xref:System.Collections.ArrayList> object to ensure that the assembly has not already been registered as a business logic handler.</span></span>  
  
4.  <span data-ttu-id="89e0e-187">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-187">Create an instance of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler> class.</span></span> <span data-ttu-id="89e0e-188">Spécifiez les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="89e0e-188">Specify the following properties:</span></span>  
  
    -   <span data-ttu-id="89e0e-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> – nom de l'assembly .NET.</span><span class="sxs-lookup"><span data-stu-id="89e0e-189"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetAssemblyName%2A> - the name of the .NET assembly.</span></span> <span data-ttu-id="89e0e-190">Si l'assembly n'est pas déployé dans le même répertoire que l'exécutable de l'Agent de fusion, dans le même répertoire que l'application qui démarre de façon synchrone l'Agent de fusion ou dans le GAC, vous devez inclure le chemin d'accès complet avec le nom de l'assembly.</span><span class="sxs-lookup"><span data-stu-id="89e0e-190">If the assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the GAC, you must include the full path with the assembly name.</span></span> <span data-ttu-id="89e0e-191">Vous devez inclure le chemin d'accès complet avec le nom de l'assembly lorsque vous utilisez un gestionnaire de logique métier avec la synchronisation Web ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-191">You must include the full path with the assembly name when using a business logic handler with Web synchronization.</span></span>  
  
    -   <span data-ttu-id="89e0e-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> – nom complet de la classe qui remplace <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> et implémente le gestionnaire de logique métier ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-192"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.DotNetClassName%2A> - the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> and implements the business logic handler.</span></span>  
  
    -   <span data-ttu-id="89e0e-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> – nom convivial que vous utilisez lorsque vous accédez au gestionnaire de logique métier ;</span><span class="sxs-lookup"><span data-stu-id="89e0e-193"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> - a friendly name you use when you access the business logic handler.</span></span>  
  
    -   <span data-ttu-id="89e0e-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A> – valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="89e0e-194"><xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.IsDotNetAssembly%2A> - a value of `true`.</span></span>  
  
#### <a name="to-deploy-a-business-logic-handler"></a><span data-ttu-id="89e0e-195">Pour déployer un gestionnaire de logique métier</span><span class="sxs-lookup"><span data-stu-id="89e0e-195">To deploy a business logic handler</span></span>  
  
1.  <span data-ttu-id="89e0e-196">Déployez l'assembly sur le serveur où l'Agent de fusion s'exécute, dans l'emplacement de fichier qui a été spécifié quand le gestionnaire de logique métier a été inscrit sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="89e0e-196">Deploy the assembly on the server where the Merge Agent runs in the file location specified when the business logic handler was registered at the Distributor.</span></span> <span data-ttu-id="89e0e-197">Pour un abonnement par extraction, l'agent s'exécute sur l'Abonné, alors que pour un abonnement par émission de données, il s'exécute sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="89e0e-197">For a pull subscription the agent runs on the Subscriber, and for a push subscription the agent runs on the Distributor.</span></span> <span data-ttu-id="89e0e-198">Lorsque vous utilisez la synchronisation Web, l'agent s'exécute sur le serveur Web.</span><span class="sxs-lookup"><span data-stu-id="89e0e-198">When you are using Web synchronization, the agent runs on the Web server.</span></span> <span data-ttu-id="89e0e-199">Si le chemin d'accès complet n'a pas été inclus avec le nom de l'assembly lorsque le gestionnaire de logique métier a été inscrit, déployez l'assembly dans le même répertoire que l'exécutable de l'Agent de fusion, dans le même répertoire que l'application qui démarre de façon synchrone l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="89e0e-199">If the full path was not included with the assembly name when the business logic handler was registered, deploy the assembly in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent.</span></span> <span data-ttu-id="89e0e-200">Vous pouvez installer l'assembly dans le GAC si plusieurs applications utilisent le même assembly.</span><span class="sxs-lookup"><span data-stu-id="89e0e-200">You may install the assembly in the GAC if there are multiple applications that use the same assembly.</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-a-new-table-article"></a><span data-ttu-id="89e0e-201">Pour utiliser un gestionnaire de logique métier avec un nouvel article de table</span><span class="sxs-lookup"><span data-stu-id="89e0e-201">To use a business logic handler with a new table article</span></span>  
  
1.  <span data-ttu-id="89e0e-202">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-202">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="89e0e-203">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergeArticle>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-203">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span> <span data-ttu-id="89e0e-204">Définissez les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="89e0e-204">Set the following properties:</span></span>  
  
    -   <span data-ttu-id="89e0e-205">Le nom de l'article pour <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-205">The name of the article for <xref:Microsoft.SqlServer.Replication.Article.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="89e0e-206">Le nom de la publication pour <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-206">The name of the publication for <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="89e0e-207">le nom de la base de données de publication pour <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>;</span><span class="sxs-lookup"><span data-stu-id="89e0e-207">The name of the publication database for <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="89e0e-208">le nom convivial du gestionnaire de logique métier (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) pour <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-208">The friendly name of the business logic handler (<xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A>) for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span>  
  
3.  <span data-ttu-id="89e0e-209">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Article.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-209">Call the <xref:Microsoft.SqlServer.Replication.Article.Create%2A> method.</span></span> <span data-ttu-id="89e0e-210">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="89e0e-210">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-business-logic-handler-with-an-existing-table-article"></a><span data-ttu-id="89e0e-211">Pour utiliser un gestionnaire de logique métier avec un article de table existant</span><span class="sxs-lookup"><span data-stu-id="89e0e-211">To use a business logic handler with an existing table article</span></span>  
  
1.  <span data-ttu-id="89e0e-212">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-212">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="89e0e-213">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergeArticle>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-213">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeArticle> class.</span></span>  
  
3.  <span data-ttu-id="89e0e-214">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>et <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-214">Set the <xref:Microsoft.SqlServer.Replication.Article.Name%2A>, <xref:Microsoft.SqlServer.Replication.Article.PublicationName%2A>, and <xref:Microsoft.SqlServer.Replication.Article.DatabaseName%2A> properties.</span></span>  
  
4.  <span data-ttu-id="89e0e-215">Définissez la connexion créée à l'étape 1 pour la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> .</span><span class="sxs-lookup"><span data-stu-id="89e0e-215">Set the connection from step 1 for the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property.</span></span>  
  
5.  <span data-ttu-id="89e0e-216">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="89e0e-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="89e0e-217">Si cette méthode retourne `false`, soit les propriétés de l'article ont été définies de manière incorrecte à l'étape 3, soit l'article n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="89e0e-217">If this method returns `false`, either the article properties in step 3 were defined incorrectly or the article does not exist.</span></span> <span data-ttu-id="89e0e-218">Pour plus d'informations, voir [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span><span class="sxs-lookup"><span data-stu-id="89e0e-218">For more information, see [View and Modify Article Properties](publish/view-and-modify-article-properties.md).</span></span>  
  
6.  <span data-ttu-id="89e0e-219">Définissez le nom convivial du gestionnaire de logique métier pour <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span><span class="sxs-lookup"><span data-stu-id="89e0e-219">Set the friendly name of the business logic handler for <xref:Microsoft.SqlServer.Replication.MergeArticle.ArticleResolver%2A>.</span></span> <span data-ttu-id="89e0e-220">Il s'agit de la valeur de la propriété <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> spécifiée lors de l'inscription du gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-220">This is the value of the <xref:Microsoft.SqlServer.Replication.BusinessLogicHandler.FriendlyName%2A> property specified when registering the business logic handler.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="89e0e-221">Exemples (RMO)</span><span class="sxs-lookup"><span data-stu-id="89e0e-221">Examples (RMO)</span></span>  
 <span data-ttu-id="89e0e-222">Cet exemple illustre un gestionnaire de logique métier qui enregistre les informations sur les insertions, les mises à jour et les suppressions sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="89e0e-222">This example is a business logic handler that logs information about inserts, updates, and deletes at the Subscriber.</span></span>  
  
 [!code-csharp[HowTo#rmo_BusinessLogicCode](../../snippets/csharp/SQL15/replication/howto/cs/businesslogic.cs#rmo_businesslogiccode)]  
  
 [!code-vb[HowTo#rmo_vb_BusinessLogicCode](../../snippets/visualbasic/SQL15/replication/howto/vb/businesslogic.vb#rmo_vb_businesslogiccode)]  
  
 <span data-ttu-id="89e0e-223">Cet exemple illustre l'inscription d'un gestionnaire de logique métier sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="89e0e-223">This example registers a business logic handler at the Distributor.</span></span>  
  
 [!code-csharp[HowTo#rmo_RegisterBLH_10](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_registerblh_10)]  
  
 [!code-vb[HowTo#rmo_vb_RegisterBLH_10](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_registerblh_10)]  
  
 <span data-ttu-id="89e0e-224">Cet exemple illustre la modification d'un article existant pour utiliser le gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="89e0e-224">This example changes an existing article to use the business logic handler.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeMergeArticle_BLH](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_changemergearticle_blh)]  
  
 [!code-vb[HowTo#rmo_vb_ChangeMergeArticle_BLH](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_changemergearticle_blh)]  
  
## <a name="see-also"></a><span data-ttu-id="89e0e-225">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="89e0e-225">See Also</span></span>  
 <span data-ttu-id="89e0e-226">[Implémenter un outil personnalisé de résolution des conflits pour un article de fusion](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span><span class="sxs-lookup"><span data-stu-id="89e0e-226">[Implement a Custom Conflict Resolver for a Merge Article](implement-a-custom-conflict-resolver-for-a-merge-article.md) </span></span>  
 <span data-ttu-id="89e0e-227">[Déboguer un gestionnaire de logique métier &#40;&#41;de programmation de la réplication](debug-a-business-logic-handler-replication-programming.md) </span><span class="sxs-lookup"><span data-stu-id="89e0e-227">[Debug a Business Logic Handler &#40;Replication Programming&#41;](debug-a-business-logic-handler-replication-programming.md) </span></span>  
 <span data-ttu-id="89e0e-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="89e0e-228">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 [<span data-ttu-id="89e0e-229">Concepts liés à Replication Management Objects</span><span class="sxs-lookup"><span data-stu-id="89e0e-229">Replication Management Objects Concepts</span></span>](concepts/replication-management-objects-concepts.md)  
  
  
