---
title: Surveiller la réplication par programmation | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- sp_replmonitorhelppublisher
- sp_replmonitorhelpmergesessiondetail
- monitoring performance [SQL Server replication], publication status
- sp_replmonitorhelpmergesession
- sp_replmonitorhelppublicationthresholds
- monitoring performance [SQL Server replication], subscription status
- monitoring performance [SQL Server replication], Transact-SQL programming
- sp_replmonitorsubscriptionpendingcmds
- sp_replmonitorchangepublicationthreshold
- transactional replication, monitoring
- sp_replmonitorhelppublication
- sp_replmonitorhelpsubscription
- monitoring performance [SQL Server replication], thresholds and warnings
- merge replication monitoring [SQL Server replication]
- snapshot replication [SQL Server], monitoring
ms.assetid: e8bf8850-8da5-4a4f-a399-64232b4e476d
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e11f73bf9538fb5ba84f4575631489ef852802c1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709199"
---
# <a name="programmatically-monitor-replication"></a><span data-ttu-id="d5270-102">Surveiller la réplication par programme</span><span class="sxs-lookup"><span data-stu-id="d5270-102">Programmatically Monitor Replication</span></span>
  <span data-ttu-id="d5270-103">Le moniteur de réplication est un outil graphique permettant d'analyser une topologie de réplication.</span><span class="sxs-lookup"><span data-stu-id="d5270-103">Replication Monitor is a graphical tool that allows you to monitor a replication topology.</span></span> <span data-ttu-id="d5270-104">Vous pouvez accéder par programmation aux mêmes données d'analyse en utilisant les procédures stockées de réplication [!INCLUDE[tsql](../../../includes/tsql-md.md)] ou les objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="d5270-104">You can access the same monitoring data programmatically by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] replication stored procedures or replication management objects (RMO).</span></span> <span data-ttu-id="d5270-105">Ces objets permettent de programmer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="d5270-105">These objects enable you to program the following tasks:</span></span>  
  
-   <span data-ttu-id="d5270-106">Analyser l'état des serveurs de publication, des publications et des abonnements.</span><span class="sxs-lookup"><span data-stu-id="d5270-106">Monitor the state of Publishers, publications, and subscriptions.</span></span>  
  
-   <span data-ttu-id="d5270-107">Analyser les sessions de l'Agent de fusion sur un ou plusieurs Abonnés.</span><span class="sxs-lookup"><span data-stu-id="d5270-107">Monitor Merge Agent sessions at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="d5270-108">Analyser les commandes transactionnelles en attente d'application sur un ou plusieurs Abonnés.</span><span class="sxs-lookup"><span data-stu-id="d5270-108">Monitor transactional commands waiting to be applied at one or more Subscribers.</span></span>  
  
-   <span data-ttu-id="d5270-109">Définir la métrique de seuil qui détermine quand une publication nécessite une intervention.</span><span class="sxs-lookup"><span data-stu-id="d5270-109">Define the threshold metrics that determine when a publication requires intervention.</span></span>  
  
-   <span data-ttu-id="d5270-110">Analyser l'état des jetons de suivi.</span><span class="sxs-lookup"><span data-stu-id="d5270-110">Monitor the status of tracer tokens.</span></span>  
  
 <span data-ttu-id="d5270-111">**Dans cette rubrique :**</span><span class="sxs-lookup"><span data-stu-id="d5270-111">**In this topic:**</span></span>  
  
 [<span data-ttu-id="d5270-112">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d5270-112">Transact-SQL</span></span>](#Tsql)  
  
 [<span data-ttu-id="d5270-113">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="d5270-113">Replication Management Objects (RMO)</span></span>](#RMO)  
  
##  <a name="transact-sql"></a><a name="Tsql"></a> <span data-ttu-id="d5270-114">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="d5270-114">Transact-SQL</span></span>  
  
#### <a name="to-monitor-publishers-publications-and-subscriptions-from-the-distributor"></a><span data-ttu-id="d5270-115">Analyser les serveurs de publication, les publications et les abonnements du serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-115">To monitor Publishers, publications, and subscriptions from the Distributor</span></span>  
  
1.  <span data-ttu-id="d5270-116">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-116">At the Distributor on the distribution database, execute [sp_replmonitorhelppublisher](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublisher-transact-sql).</span></span> <span data-ttu-id="d5270-117">Les informations d'analyse pour tous les serveurs de publication utilisant ce serveur de distribution sont ainsi retournées.</span><span class="sxs-lookup"><span data-stu-id="d5270-117">This returns monitoring information for all Publishers using this Distributor.</span></span> <span data-ttu-id="d5270-118">Pour limiter le jeu de résultats à un seul serveur de publication, spécifiez **@publisher** .</span><span class="sxs-lookup"><span data-stu-id="d5270-118">To limit the result set to a single Publisher, specify **@publisher**.</span></span>  
  
2.  <span data-ttu-id="d5270-119">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-119">At the Distributor on the distribution database, execute [sp_replmonitorhelppublication](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublication-transact-sql).</span></span> <span data-ttu-id="d5270-120">Les informations d'analyse pour tous les serveurs de publication utilisant ce serveur de distribution sont ainsi retournées.</span><span class="sxs-lookup"><span data-stu-id="d5270-120">This returns monitoring information for all publications using this Distributor.</span></span> <span data-ttu-id="d5270-121">Pour limiter le jeu de résultats à un serveur de publication, une publication ou une base de données publiée, spécifiez **@publisher** **@publication** respectivement, ou **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d5270-121">To limit the result set to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
3.  <span data-ttu-id="d5270-122">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-122">At the Distributor on the distribution database, execute [sp_replmonitorhelpsubscription](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpsubscription-transact-sql).</span></span> <span data-ttu-id="d5270-123">Les informations d'analyse pour tous les abonnements utilisant ce serveur de distribution sont ainsi retournées.</span><span class="sxs-lookup"><span data-stu-id="d5270-123">This returns monitoring information for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d5270-124">Pour limiter le jeu de résultats aux abonnements appartenant à un serveur de publication, une publication ou une base de données publiée, spécifiez **@publisher** **@publication** respectivement, ou **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d5270-124">To limit the result set to subscriptions belonging to a single Publisher, publication, or published database, specify **@publisher**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-transactional-commands-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="d5270-125">Pour analyser les commandes transactionnelles en attente d'application sur l'Abonné</span><span class="sxs-lookup"><span data-stu-id="d5270-125">To monitor transactional commands waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d5270-126">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-126">At the Distributor on the distribution database, execute [sp_replmonitorsubscriptionpendingcmds](/sql/relational-databases/system-stored-procedures/sp-replmonitorsubscriptionpendingcmds-transact-sql).</span></span> <span data-ttu-id="d5270-127">Les informations d'analyse pour toutes les commandes en attente de tous les abonnements utilisant ce serveur de distribution sont ainsi retournées.</span><span class="sxs-lookup"><span data-stu-id="d5270-127">This returns monitoring information for all commands pending for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d5270-128">Pour limiter le jeu de résultats aux commandes en attente pour les abonnements appartenant à un serveur de publication, un abonné, une publication ou une base de données publiée, spécifiez respectivement,, **@publisher** **@subscriber** **@publication** ou **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d5270-128">To limit the result set to commands pending for subscriptions belonging to a single Publisher, Subscriber, publication, or published database, specify **@publisher**, **@subscriber**, **@publication**, or **@publisher_db**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-changes-waiting-to-be-uploaded-or-downloaded"></a><span data-ttu-id="d5270-129">Pour analyser les modifications de fusion en attente de chargement ou de téléchargement</span><span class="sxs-lookup"><span data-stu-id="d5270-129">To monitor merge changes waiting to be uploaded or downloaded</span></span>  
  
1.  <span data-ttu-id="d5270-130">Dans la base de données de publication du serveur de publication, exécutez [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-130">At the Publisher on the publication database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="d5270-131">Retourne un jeu de résultats affichant des informations sur les modifications en attente de réplication sur les Abonnés.</span><span class="sxs-lookup"><span data-stu-id="d5270-131">This returns a result set showing information on changes that are waiting to be replicated to Subscribers.</span></span> <span data-ttu-id="d5270-132">Pour limiter le jeu de résultats aux modifications qui appartiennent à une publication ou un article unique, spécifiez **@publication** ou **@article** , respectivement.</span><span class="sxs-lookup"><span data-stu-id="d5270-132">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
2.  <span data-ttu-id="d5270-133">Sur un Abonné de la base de données d'abonnement, exécutez [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-133">At a Subscriber on the subscription database, execute [sp_showpendingchanges](/sql/relational-databases/system-stored-procedures/sp-showpendingchanges-transact-sql).</span></span> <span data-ttu-id="d5270-134">Retourne un jeu de résultats affichant des informations sur les modifications en attente de réplication sur le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-134">This returns a result set showing information on changes that are waiting to be replicated to the Publisher.</span></span> <span data-ttu-id="d5270-135">Pour limiter le jeu de résultats aux modifications qui appartiennent à une publication ou un article unique, spécifiez **@publication** ou **@article** , respectivement.</span><span class="sxs-lookup"><span data-stu-id="d5270-135">To limit the result set to changes that belong to a single publication or article, specify **@publication** or **@article**, respectively.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions"></a><span data-ttu-id="d5270-136">Pour analyser les sessions de l'Agent de fusion</span><span class="sxs-lookup"><span data-stu-id="d5270-136">To monitor Merge Agent sessions</span></span>  
  
1.  <span data-ttu-id="d5270-137">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-137">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="d5270-138">Cela retourne les informations d'analyse, y compris **Session_id**, sur toutes les sessions de l'Agent de fusion pour tous les abonnements utilisant ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-138">This returns monitoring information, including **Session_id**, on all Merge Agent sessions for all subscriptions using this Distributor.</span></span> <span data-ttu-id="d5270-139">Vous pouvez également obtenir **Session_id** en interrogeant la table système [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="d5270-139">You can also obtain **Session_id** by querying the [MSmerge_sessions](/sql/relational-databases/system-tables/msmerge-sessions-transact-sql) system table.</span></span>  
  
2.  <span data-ttu-id="d5270-140">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-140">At the Distributor on the distribution database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="d5270-141">Spécifiez une valeur **Session_id** de l'étape 1 pour **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="d5270-141">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="d5270-142">Les informations d'analyse détaillées sur la session sont ainsi affichées.</span><span class="sxs-lookup"><span data-stu-id="d5270-142">This displays detailed monitor information about the session.</span></span>  
  
3.  <span data-ttu-id="d5270-143">Répétez l'étape 2 pour chaque session digne d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="d5270-143">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-monitor-merge-agent-sessions-for-pull-subscriptions-from-the-subscriber"></a><span data-ttu-id="d5270-144">Pour analyser les sessions de l'Agent de fusion pour les abonnements par extraction de l'Abonné</span><span class="sxs-lookup"><span data-stu-id="d5270-144">To monitor Merge Agent sessions for pull subscriptions from the Subscriber</span></span>  
  
1.  <span data-ttu-id="d5270-145">Sur l'Abonné de la base de données d'abonnement, exécutez [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-145">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesession](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesession-transact-sql).</span></span> <span data-ttu-id="d5270-146">Pour un abonnement donné, spécifiez **@publisher** , **@publication** et le nom de la base de données de publication pour **@publisher_db** .</span><span class="sxs-lookup"><span data-stu-id="d5270-146">For a given subscription, specify **@publisher**, **@publication**, and the name of the publication database for **@publisher_db**.</span></span> <span data-ttu-id="d5270-147">Cela retourne des informations d'analyse sur les cinq dernières sessions de l'Agent de fusion pour cet abonnement.</span><span class="sxs-lookup"><span data-stu-id="d5270-147">This returns monitoring information for the last five Merge Agent sessions for this subscription.</span></span> <span data-ttu-id="d5270-148">Notez la valeur de la colonne **Session_id** pour toutes les sessions dignes d'intérêt dans le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="d5270-148">Note the value of **Session_id** for sessions of interest in the result set.</span></span>  
  
2.  <span data-ttu-id="d5270-149">Sur l'Abonné de la base de données d'abonnement, exécutez [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-149">At the Subscriber on the subscription database, execute [sp_replmonitorhelpmergesessiondetail](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelpmergesessiondetail-transact-sql).</span></span> <span data-ttu-id="d5270-150">Spécifiez une valeur **Session_id** de l'étape 1 pour **@session_id**.</span><span class="sxs-lookup"><span data-stu-id="d5270-150">Specify a **Session_id** value from step 1 for **@session_id**.</span></span> <span data-ttu-id="d5270-151">Les informations d'analyse détaillées sur la session sont ainsi affichées.</span><span class="sxs-lookup"><span data-stu-id="d5270-151">This displays detailed monitoring information about the session.</span></span>  
  
3.  <span data-ttu-id="d5270-152">Répétez l'étape 2 pour chaque session digne d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="d5270-152">Repeat step 2 for each session of interest.</span></span>  
  
#### <a name="to-view-and-modify-the-monitor-threshold-metrics-for-a-publication"></a><span data-ttu-id="d5270-153">Pour afficher et modifier la métrique du seuil d'analyse pour une publication</span><span class="sxs-lookup"><span data-stu-id="d5270-153">To view and modify the monitor threshold metrics for a publication</span></span>  
  
1.  <span data-ttu-id="d5270-154">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-154">At the Distributor on the distribution database, execute [sp_replmonitorhelppublicationthresholds](/sql/relational-databases/system-stored-procedures/sp-replmonitorhelppublicationthresholds-transact-sql).</span></span> <span data-ttu-id="d5270-155">Les seuils d'analyse définis pour toutes les publications utilisant ce serveur de distribution sont ainsi retournées.</span><span class="sxs-lookup"><span data-stu-id="d5270-155">This returns the monitoring thresholds set for all publications using this Distributor.</span></span> <span data-ttu-id="d5270-156">Pour limiter le jeu de résultats aux seuils d’analyse des publications appartenant à un serveur de publication unique ou à une base de données publiée ou à une publication unique, spécifiez **@publisher** **@publisher_db** respectivement, ou **@publication** .</span><span class="sxs-lookup"><span data-stu-id="d5270-156">To limit the result set to monitor thresholds to publications belonging to a single Publisher or published database or to a single publication, specify **@publisher**, **@publisher_db**, or **@publication**, respectively.</span></span> <span data-ttu-id="d5270-157">Notez la valeur de **Metric_id** pour les seuils qui doivent être changés.</span><span class="sxs-lookup"><span data-stu-id="d5270-157">Note the value of **Metric_id** for any thresholds that must be changed.</span></span> <span data-ttu-id="d5270-158">Pour plus d’informations, voir [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="d5270-158">For more information, see [Set Thresholds and Warnings in Replication Monitor](set-thresholds-and-warnings-in-replication-monitor.md).</span></span>  
  
2.  <span data-ttu-id="d5270-159">Sur le serveur de distribution de la base de données de distribution, exécutez [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5270-159">At the Distributor on the distribution database, execute [sp_replmonitorchangepublicationthreshold](/sql/relational-databases/system-stored-procedures/sp-replmonitorchangepublicationthreshold-transact-sql).</span></span> <span data-ttu-id="d5270-160">Spécifiez les éléments suivants si nécessaire :</span><span class="sxs-lookup"><span data-stu-id="d5270-160">Specify the following as needed:</span></span>  
  
    -   <span data-ttu-id="d5270-161">La valeur **Metric_id** obtenue dans l'étape 1 pour **@metric_id**.</span><span class="sxs-lookup"><span data-stu-id="d5270-161">The **Metric_id** value obtained in step 1 for **@metric_id**.</span></span>  
  
    -   <span data-ttu-id="d5270-162">Nouvelle valeur pour la métrique du seuil d’analyse pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="d5270-162">A new value for the monitor threshold metric for **@value**.</span></span>  
  
    -   <span data-ttu-id="d5270-163">Une valeur de **1** pour **@shouldalert** pour une alerte à enregistrer lorsque ce seuil est atteint, ou une valeur de **0** si une alerte n'est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d5270-163">A value of **1** for **@shouldalert** for an alert to be logged when this threshold is reached, or a value of **0** if an alert is not needed.</span></span>  
  
    -   <span data-ttu-id="d5270-164">Une valeur de **1** pour **@mode** afin d'activer la métrique du seuil d'analyse ou valeur de **2** pour la désactiver.</span><span class="sxs-lookup"><span data-stu-id="d5270-164">A value of **1** for **@mode** to enable the monitor threshold metric or a value of **2** to disable it.</span></span>  
  
##  <a name="replication-management-objects-rmo"></a><a name="RMO"></a> <span data-ttu-id="d5270-165">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="d5270-165">Replication Management Objects (RMO)</span></span>  
  
#### <a name="to-monitor-a-subscription-to-a-merge-publication-at-the-subscriber"></a><span data-ttu-id="d5270-166">Pour surveiller un abonnement à une publication de fusion sur l'Abonné</span><span class="sxs-lookup"><span data-stu-id="d5270-166">To monitor a subscription to a merge publication at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d5270-167">Créez une connexion à l'Abonné en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-167">Create a connection to the Subscriber by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-168">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> et définissez les propriétés <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> de l'abonnement, puis attribuez à la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> la valeur <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée dans l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-168">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor> class, and set the <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publisher%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.Publication%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.PublisherDB%2A>, <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.SubscriberDB%2A> properties for the subscription, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="d5270-169">Appelez l'une des méthodes suivantes pour retourner les informations sur les sessions de l'Agent de fusion de cet abonnement :</span><span class="sxs-lookup"><span data-stu-id="d5270-169">Call one of the following methods to return information on Merge Agent sessions for this subscription:</span></span>  
  
    -   <span data-ttu-id="d5270-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - retourne un tableau d'objets <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> avec des informations sur les cinq dernières sessions au plus de l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="d5270-170"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on up to the last five Merge Agent sessions.</span></span> <span data-ttu-id="d5270-171">Notez la valeur <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> pour toutes les sessions dignes d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="d5270-171">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d5270-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - retourne un tableau d'objets <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> avec les informations sur les sessions de l'Agent de fusion qui se sont produites pendant le nombre passé d'heures transmis comme paramètre *hours* (jusqu'aux cinq dernières sessions au plus).</span><span class="sxs-lookup"><span data-stu-id="d5270-172"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummary%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> objects with information on Merge Agent sessions that have occurred during the past number of hours passed in as the *hours* parameter (up to the last five sessions).</span></span> <span data-ttu-id="d5270-173">Notez la valeur <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> pour toutes les sessions dignes d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="d5270-173">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d5270-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - retourne un objet <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> avec les informations sur la dernière session de l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="d5270-174"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummary%2A> - returns a <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="d5270-175">Notez la valeur <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> de cette session.</span><span class="sxs-lookup"><span data-stu-id="d5270-175">Note the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary.SessionId%2A> value for this session.</span></span>  
  
    -   <span data-ttu-id="d5270-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - retourne un objet <xref:System.Data.DataSet> avec les informations sur les cinq dernières sessions au plus de l'Agent de fusion, une session par ligne.</span><span class="sxs-lookup"><span data-stu-id="d5270-176"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionsSummaryDataSet%2A> - returns a <xref:System.Data.DataSet> object with information on up to the last five Merge Agent sessions, one in each row.</span></span> <span data-ttu-id="d5270-177">Notez la valeur de la colonne **Session_id** pour toutes les sessions dignes d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="d5270-177">Note the value of the **Session_id** column for any sessions of interest.</span></span>  
  
    -   <span data-ttu-id="d5270-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - retourne un objet <xref:System.Data.DataRow> avec les informations sur la dernière session de l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="d5270-178"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetLastSessionSummaryDataRow%2A> - returns a <xref:System.Data.DataRow> object with information on the last Merge Agent session.</span></span> <span data-ttu-id="d5270-179">Notez la valeur de la colonne **Session_id** pour cette session.</span><span class="sxs-lookup"><span data-stu-id="d5270-179">Note the value of the **Session_id** column for this session.</span></span>  
  
4.  <span data-ttu-id="d5270-180">(Facultatif) Appelez <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> pour actualiser les données de l'objet <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> transmis comme *mss,* ou appelez <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> pour actualiser les données de l'objet <xref:System.Data.DataRow> transmis comme *drRefresh*.</span><span class="sxs-lookup"><span data-stu-id="d5270-180">(Optional) Call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data for the <xref:Microsoft.SqlServer.Replication.MergeSessionSummary> object passed as *mss,* or call <xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.RefreshSessionSummary%2A> to refresh the data in the <xref:System.Data.DataRow> object passed as *drRefresh*.</span></span>  
  
5.  <span data-ttu-id="d5270-181">À l'aide de l'ID de session obtenu à l'étape 3, appelez l'une des méthodes suivantes pour retourner les informations sur les détails d'une session particulière :</span><span class="sxs-lookup"><span data-stu-id="d5270-181">Using the session ID obtained in step 3, call one of the following methods to return information on the details of a particular session:</span></span>  
  
    -   <span data-ttu-id="d5270-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A>-retourne un tableau d' <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objets pour l' *ID de session*fourni.</span><span class="sxs-lookup"><span data-stu-id="d5270-182"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetails%2A> - returns an array of <xref:Microsoft.SqlServer.Replication.MergeSessionDetail> objects for the supplied *sessionID*.</span></span>  
  
    -   <span data-ttu-id="d5270-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A>-retourne un <xref:System.Data.DataSet> objet avec les informations relatives à l' *ID de session*spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-183"><xref:Microsoft.SqlServer.Replication.MergeSubscriberMonitor.GetSessionDetailsDataSet%2A> - returns a <xref:System.Data.DataSet> object with information for the specified *sessionID*.</span></span>  
  
#### <a name="to-monitor-replication-properties-for-all-publications-at-a-distributor"></a><span data-ttu-id="d5270-184">Pour surveiller les propriétés de réplication de toutes les publications sur un serveur de distribution</span><span class="sxs-lookup"><span data-stu-id="d5270-184">To monitor replication properties for all publications at a Distributor</span></span>  
  
1.  <span data-ttu-id="d5270-185">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-185">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-186">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.ReplicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="d5270-186">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> class.</span></span>  
  
3.  <span data-ttu-id="d5270-187">Définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec le <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-187">Set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
4.  <span data-ttu-id="d5270-188">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="d5270-188">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span>  
  
5.  <span data-ttu-id="d5270-189">Exécutez une ou plusieurs des méthodes suivantes pour retourner les informations de réplication de tous les serveurs de publication qui utilisent ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-189">Execute one or more of the following methods to return replication information for all Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les Agents de distribution de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-190"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumDistributionAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Distribution Agents at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur les erreurs stockées sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-191"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains information about errors stored at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les Agents de lecture du journal de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-192"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumLogReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Log Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les Agents de fusion de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-193"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMergeAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Merge Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les autres agents de réplication de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-194"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumMiscellaneousAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all other replication agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les serveurs de publication de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-195"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Publishers at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - retourne un objet <xref:System.Data.DataSet> qui contient les serveurs de publication qui utilisent ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-196"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumPublishers2%2A> - returns a <xref:System.Data.DataSet> object that returns the Publishers that use this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les Agents de lecture de la file d'attente de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-197"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Queue Reader Agents at the Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails sur l'Agent de lecture de la file d'attente et la session spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-198"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Queue Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session sur l'Agent de lecture de la file d'attente spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-199"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumQueueReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Queue Reader Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les Agents d'instantané de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-200"><xref:Microsoft.SqlServer.Replication.ReplicationMonitor.EnumSnapshotAgents%2A> - returns a <xref:System.Data.DataSet> object that contains information about all Snapshot Agents at the Distributor.</span></span>  
  
#### <a name="to-monitor-publication-properties-for-a-specific-publisher-at-the-distributor"></a><span data-ttu-id="d5270-201">Pour analyser les propriétés de publication d'un serveur de publication spécifique d'un serveur de distribution</span><span class="sxs-lookup"><span data-stu-id="d5270-201">To monitor publication properties for a specific Publisher at the Distributor</span></span>  
  
1.  <span data-ttu-id="d5270-202">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-202">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-203">Récupérez un objet <xref:Microsoft.SqlServer.Replication.PublisherMonitor> par l'un ou l'autre de ces moyens.</span><span class="sxs-lookup"><span data-stu-id="d5270-203">Get a <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d5270-204">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.PublisherMonitor>.</span><span class="sxs-lookup"><span data-stu-id="d5270-204">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor> class.</span></span> <span data-ttu-id="d5270-205">Définissez la propriété <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> pour le serveur de publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec le <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-205">Set the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.Name%2A> property for the Publisher, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d5270-206">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="d5270-206">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d5270-207">Si cette méthode retourne `false`, le nom du serveur de publication n'a pas été correctement défini ou la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="d5270-207">If this method returns `false`, either the Publisher name was defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d5270-208">Depuis le <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessible au moyen de la propriété <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> d'un objet <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> existant.</span><span class="sxs-lookup"><span data-stu-id="d5270-208">From the <xref:Microsoft.SqlServer.Replication.PublisherMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.ReplicationMonitor.PublisherMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.ReplicationMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d5270-209">Exécutez une ou plusieurs des méthodes suivantes pour retourner les informations de réplication de toutes les publications qui appartiennent à ce serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-209">Execute one or more of the following methods to return replication information for all publications that belong to this Publisher.</span></span>  
  
    -   <span data-ttu-id="d5270-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails sur l'Agent de distribution et la session spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-210"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Distribution Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session sur l'Agent de distribution spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-211"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumDistributionAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information about the specified Distribution Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations d'enregistrement d'erreur sur l'erreur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d5270-212"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error record information about the specified error.</span></span>  
  
    -   <span data-ttu-id="d5270-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails sur l'Agent de lecture du journal et la session spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-213"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details for the specified Log Reader Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session sur l'Agent de lecture du journal spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-214"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumLogReaderAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Log Reader Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails sur l'Agent de fusion et la session spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-215"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails supplémentaires sur l'Agent de fusion et la session spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-216"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessionDetails2%2A> - returns a <xref:System.Data.DataSet> object that contains additional details about the specified Merge Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session sur l'Agent de fusion spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-217"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session supplémentaires sur l'Agent de fusion spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-218"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumMergeAgentSessions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional session information for the specified Merge Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur toutes les publications de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-219"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications%2A> - returns a <xref:System.Data.DataSet> object that contains information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations supplémentaires sur toutes les publications de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-220"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumPublications2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about all publications at this Distributor.</span></span>  
  
    -   <span data-ttu-id="d5270-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des détails sur la session et l'Agent d'instantané spécifiés.</span><span class="sxs-lookup"><span data-stu-id="d5270-221"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessionDetails%2A> - returns a <xref:System.Data.DataSet> object that contains details about the specified Snapshot Agent and session.</span></span>  
  
    -   <span data-ttu-id="d5270-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de session sur l'Agent d'instantané spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-222"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSnapshotAgentSessions%2A> - returns a <xref:System.Data.DataSet> object that contains session information for the specified Snapshot Agent.</span></span>  
  
    -   <span data-ttu-id="d5270-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations supplémentaires sur tous les abonnements aux publications de ce serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="d5270-223"><xref:Microsoft.SqlServer.Replication.PublisherMonitor.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about all subscriptions to publications at this Distributor.</span></span>  
  
#### <a name="to-monitor-properties-for-a-specific-publication-at-the-distributor"></a><span data-ttu-id="d5270-224">Pour analyser les propriétés d'une publication spécifique du serveur de distribution</span><span class="sxs-lookup"><span data-stu-id="d5270-224">To monitor properties for a specific publication at the Distributor</span></span>  
  
1.  <span data-ttu-id="d5270-225">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-225">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-226">Récupérez un objet <xref:Microsoft.SqlServer.Replication.PublicationMonitor> par l'un ou l'autre de ces moyens.</span><span class="sxs-lookup"><span data-stu-id="d5270-226">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d5270-227">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="d5270-227">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d5270-228">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>et <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> de la publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec le <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-228">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d5270-229">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="d5270-229">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d5270-230">Si cette méthode retourne `false`, les propriétés de publication n'ont pas été correctement définies ou la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="d5270-230">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d5270-231">Depuis le <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessible au moyen de la propriété <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> d'un objet <xref:Microsoft.SqlServer.Replication.PublisherMonitor> existant.</span><span class="sxs-lookup"><span data-stu-id="d5270-231">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d5270-232">Exécutez une ou plusieurs des méthodes suivantes pour retourner des informations sur cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-232">Execute one or more of the following methods to return information about this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des enregistrements d'erreur sur l'erreur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d5270-233"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumErrorRecords%2A> - returns a <xref:System.Data.DataSet> object that contains error records about the specified error.</span></span>  
  
    -   <span data-ttu-id="d5270-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur l'Agent de lecture du journal de cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-234"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumLogReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Log Reader Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - retourne un objet <xref:System.Data.DataSet> qui contient les informations sur les seuils d'avertissement du moniteur pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-235"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> - returns a <xref:System.Data.DataSet> object that contains information about the monitor warning thresholds set for this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur l'Agent de lecture de la file d'attente utilisé par cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-236"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumQueueReaderAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Queue Reader Agent used by this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur l'Agent d'instantané de cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-237"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSnapshotAgent%2A> - returns a <xref:System.Data.DataSet> object that contains information about the Snapshot Agent for this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur les abonnements à cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-238"><xref:Microsoft.SqlServer.Replication.Publication.EnumSubscriptions%2A> - returns a <xref:System.Data.DataSet> object that contains information about subscriptions to this publication.</span></span>  
  
    -   <span data-ttu-id="d5270-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations supplémentaires sur les abonnements à cette publication en fonction du <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>fourni.</span><span class="sxs-lookup"><span data-stu-id="d5270-239"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumSubscriptions2%2A> - returns a <xref:System.Data.DataSet> object that contains additional information about subscriptions to this publication based on the supplied <xref:Microsoft.SqlServer.Replication.SubscriptionResultOption>.</span></span>  
  
    -   <span data-ttu-id="d5270-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations de latence sur le jeton de suivi spécifié.</span><span class="sxs-lookup"><span data-stu-id="d5270-240"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokenHistory%2A> - returns a <xref:System.Data.DataSet> object that contains latency information for the specified tracer token.</span></span>  
  
    -   <span data-ttu-id="d5270-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - retourne un objet <xref:System.Data.DataSet> qui contient des informations sur tous les jetons de suivi insérés dans cette publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-241"><xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumTracerTokens%2A> - returns a <xref:System.Data.DataSet> object that contains information about all tracer tokens inserted into this publication.</span></span>  
  
#### <a name="to-monitor-transactional-commands-that-are-waiting-to-be-applied-at-the-subscriber"></a><span data-ttu-id="d5270-242">Pour analyser les commandes transactionnelles en attente d'application sur l'Abonné</span><span class="sxs-lookup"><span data-stu-id="d5270-242">To monitor transactional commands that are waiting to be applied at the Subscriber</span></span>  
  
1.  <span data-ttu-id="d5270-243">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-243">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-244">Récupérez un objet <xref:Microsoft.SqlServer.Replication.PublicationMonitor> par l'un ou l'autre de ces moyens.</span><span class="sxs-lookup"><span data-stu-id="d5270-244">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d5270-245">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="d5270-245">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d5270-246">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>et <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> de la publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec le <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-246">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d5270-247">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="d5270-247">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d5270-248">Si cette méthode retourne `false`, les propriétés de publication n'ont pas été correctement définies ou la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="d5270-248">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d5270-249">Depuis le <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessible au moyen de la propriété <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> d'un objet <xref:Microsoft.SqlServer.Replication.PublisherMonitor> existant.</span><span class="sxs-lookup"><span data-stu-id="d5270-249">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d5270-250">Exécutez la méthode <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> , qui retourne un objet <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> .</span><span class="sxs-lookup"><span data-stu-id="d5270-250">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.TransPendingCommandInfo%2A> method, which returns a <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object.</span></span>  
  
4.  <span data-ttu-id="d5270-251">Utilisez les propriétés de cet objet <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> pour déterminer le nombre estimé de commandes en attente et la durée nécessaire à la remise complète de ces commandes.</span><span class="sxs-lookup"><span data-stu-id="d5270-251">Use the properties of this <xref:Microsoft.SqlServer.Replication.PendingCommandInfo> object to determine the estimated number of pending commands and the length of time it will take to complete the delivery of these commands.</span></span>  
  
#### <a name="to-set-the-monitor-warning-thresholds-for-a-publication"></a><span data-ttu-id="d5270-252">Pour définir les seuils d'avertissement du moniteur pour une publication</span><span class="sxs-lookup"><span data-stu-id="d5270-252">To set the monitor warning thresholds for a publication</span></span>  
  
1.  <span data-ttu-id="d5270-253">Créez une connexion au serveur de distribution en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="d5270-253">Create a connection to the Distributor by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="d5270-254">Récupérez un objet <xref:Microsoft.SqlServer.Replication.PublicationMonitor> par l'un ou l'autre de ces moyens.</span><span class="sxs-lookup"><span data-stu-id="d5270-254">Get a <xref:Microsoft.SqlServer.Replication.PublicationMonitor> object in one of these ways.</span></span>  
  
    -   <span data-ttu-id="d5270-255">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.PublicationMonitor>.</span><span class="sxs-lookup"><span data-stu-id="d5270-255">Create an instance of the <xref:Microsoft.SqlServer.Replication.PublicationMonitor> class.</span></span> <span data-ttu-id="d5270-256">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>et <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> de la publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec le <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créé au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="d5270-256">Set the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.DistributionDBName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublisherName%2A>, <xref:Microsoft.SqlServer.Replication.PublicationMonitor.PublicationDBName%2A>, and <xref:Microsoft.SqlServer.Replication.PublicationMonitor.Name%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span> <span data-ttu-id="d5270-257">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="d5270-257">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="d5270-258">Si cette méthode retourne `false`, les propriétés de publication n'ont pas été correctement définies ou la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="d5270-258">If this method returns `false`, either the publication properties were defined incorrectly or the publication does not exist.</span></span>  
  
    -   <span data-ttu-id="d5270-259">Depuis le <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessible au moyen de la propriété <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> d'un objet <xref:Microsoft.SqlServer.Replication.PublisherMonitor> existant.</span><span class="sxs-lookup"><span data-stu-id="d5270-259">From the <xref:Microsoft.SqlServer.Replication.PublicationMonitorCollection> accessed by means of the <xref:Microsoft.SqlServer.Replication.PublisherMonitor.PublicationMonitors%2A> property of an existing <xref:Microsoft.SqlServer.Replication.PublisherMonitor> object.</span></span>  
  
3.  <span data-ttu-id="d5270-260">Exécutez la méthode <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> .</span><span class="sxs-lookup"><span data-stu-id="d5270-260">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.EnumMonitorThresholds%2A> method.</span></span> <span data-ttu-id="d5270-261">Notez les paramètres de seuil en cours dans le <xref:System.Collections.ArrayList> retourné des objets <xref:Microsoft.SqlServer.Replication.MonitorThreshold> .</span><span class="sxs-lookup"><span data-stu-id="d5270-261">Note the current threshold settings in the returned <xref:System.Collections.ArrayList> of <xref:Microsoft.SqlServer.Replication.MonitorThreshold> objects.</span></span>  
  
4.  <span data-ttu-id="d5270-262">Exécutez la méthode <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> .</span><span class="sxs-lookup"><span data-stu-id="d5270-262">Execute the <xref:Microsoft.SqlServer.Replication.PublicationMonitor.ChangeMonitorThreshold%2A> method.</span></span> <span data-ttu-id="d5270-263">Transmettez les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="d5270-263">Pass the following parameters:</span></span>  
  
    -   <span data-ttu-id="d5270-264">*metricID* - une valeur <xref:System.Int32> qui représente le seuil d'analyse métrique de la table suivante :</span><span class="sxs-lookup"><span data-stu-id="d5270-264">*metricID* - an <xref:System.Int32> value that represents the monitoring threshold metric from the following table:</span></span>  
  
        |<span data-ttu-id="d5270-265">Valeur</span><span class="sxs-lookup"><span data-stu-id="d5270-265">Value</span></span>|<span data-ttu-id="d5270-266">Description</span><span class="sxs-lookup"><span data-stu-id="d5270-266">Description</span></span>|  
        |-----------|-----------------|  
        |<span data-ttu-id="d5270-267">1</span><span class="sxs-lookup"><span data-stu-id="d5270-267">1</span></span>|<span data-ttu-id="d5270-268">`expiration` : contrôle l'expiration imminente des abonnements aux publications transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="d5270-268">`expiration` - monitors for imminent expiration of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="d5270-269">2</span><span class="sxs-lookup"><span data-stu-id="d5270-269">2</span></span>|<span data-ttu-id="d5270-270">`latency` : contrôle les performances des abonnements aux publications transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="d5270-270">`latency` - monitors for the performance of subscriptions to transactional publications.</span></span>|  
        |<span data-ttu-id="d5270-271">4</span><span class="sxs-lookup"><span data-stu-id="d5270-271">4</span></span>|<span data-ttu-id="d5270-272">`mergeexpiration` : contrôle l'expiration imminente des abonnements aux publications de fusion.</span><span class="sxs-lookup"><span data-stu-id="d5270-272">`mergeexpiration` - monitors for imminent expiration of subscriptions to merge publications.</span></span>|  
        |<span data-ttu-id="d5270-273">5</span><span class="sxs-lookup"><span data-stu-id="d5270-273">5</span></span>|<span data-ttu-id="d5270-274">`mergeslowrunduration` : contrôle la durée des synchronisations de fusion sur les connexions à faible bande passante (accès à distance).</span><span class="sxs-lookup"><span data-stu-id="d5270-274">`mergeslowrunduration` - monitors the duration of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
        |<span data-ttu-id="d5270-275">6</span><span class="sxs-lookup"><span data-stu-id="d5270-275">6</span></span>|<span data-ttu-id="d5270-276">`mergefastrunduration` : contrôle la durée des synchronisations de fusion sur les connexions haut débit (LAN).</span><span class="sxs-lookup"><span data-stu-id="d5270-276">`mergefastrunduration` - monitors the duration of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="d5270-277">7</span><span class="sxs-lookup"><span data-stu-id="d5270-277">7</span></span>|<span data-ttu-id="d5270-278">`mergefastrunspeed` - supervise le taux de synchronisation des synchronisations de fusion sur des connexions à bande passante élevée (LAN).</span><span class="sxs-lookup"><span data-stu-id="d5270-278">`mergefastrunspeed` - monitors the synchronization rate of merge synchronizations over high-bandwidth (LAN) connections.</span></span>|  
        |<span data-ttu-id="d5270-279">8</span><span class="sxs-lookup"><span data-stu-id="d5270-279">8</span></span>|<span data-ttu-id="d5270-280">`mergeslowrunspeed` : contrôle la vitesse de synchronisation des synchronisations de fusion sur les connexions lentes (accès distant).</span><span class="sxs-lookup"><span data-stu-id="d5270-280">`mergeslowrunspeed` - monitors the synchronization rate of merge synchronizations over low-bandwidth (dialup) connections.</span></span>|  
  
    -   <span data-ttu-id="d5270-281">*enable* - <xref:System.Boolean> qui indique si le métrique est activé pour la publication.</span><span class="sxs-lookup"><span data-stu-id="d5270-281">*enable* - <xref:System.Boolean> value that indicates whether the metric is enabled for the publication.</span></span>  
  
    -   <span data-ttu-id="d5270-282">*thresholdValue* - valeur entière qui définit le seuil.</span><span class="sxs-lookup"><span data-stu-id="d5270-282">*thresholdValue* - integer value that sets the threshold.</span></span>  
  
    -   <span data-ttu-id="d5270-283">*shouldAlert* - entier qui indique si ce seuil doit générer une alerte.</span><span class="sxs-lookup"><span data-stu-id="d5270-283">*shouldAlert* - integer that indicates whether this threshold should generate an alert.</span></span>  
  
  
