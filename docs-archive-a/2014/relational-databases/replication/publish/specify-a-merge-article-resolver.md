---
title: Spécifier un programme de résolution d’articles de fusion | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
- merge replication conflict resolution [SQL Server replication], merge article resolvers
ms.assetid: a40083b3-4f7b-4a25-a5a3-6ef67bdff440
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ca32ef4936f31ca5c75dfc2df1eb965d17f7b039
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87702711"
---
# <a name="specify-a-merge-article-resolver"></a><span data-ttu-id="141a9-102">Spécifier un programme de résolution d'articles de fusion</span><span class="sxs-lookup"><span data-stu-id="141a9-102">Specify a Merge Article Resolver</span></span>
  <span data-ttu-id="141a9-103">Cette rubrique explique comment spécifier un programmes de résolution d'articles de fusion dans [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ou de [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="141a9-103">This topic describes how to specify a merge article resolver in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span>  
  
 <span data-ttu-id="141a9-104">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="141a9-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="141a9-105">**Avant de commencer :**</span><span class="sxs-lookup"><span data-stu-id="141a9-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="141a9-106">Recommandations</span><span class="sxs-lookup"><span data-stu-id="141a9-106">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="141a9-107">**Pour spécifier un programme de résolution d'articles de fusion à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="141a9-107">**To specify a merge article resolver, using:**</span></span>  
  
     [<span data-ttu-id="141a9-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="141a9-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="141a9-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="141a9-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="141a9-110">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="141a9-110">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="141a9-111">Recommandations</span><span class="sxs-lookup"><span data-stu-id="141a9-111">Recommendations</span></span>  
  
-   <span data-ttu-id="141a9-112">La réplication de fusion accepte les types de programmes de résolution d'articles suivants :</span><span class="sxs-lookup"><span data-stu-id="141a9-112">Merge replication allows the following types of article resolvers:</span></span>  
  
    -   <span data-ttu-id="141a9-113">Programme de résolution par défaut.</span><span class="sxs-lookup"><span data-stu-id="141a9-113">The default resolver.</span></span> <span data-ttu-id="141a9-114">Le comportement du programme de résolution par défaut varie selon que l'abonnement est un abonnement client ou serveur.</span><span class="sxs-lookup"><span data-stu-id="141a9-114">The behavior of the default resolver depends on whether the subscription is a client subscription or a server subscription.</span></span> <span data-ttu-id="141a9-115">Pour plus d’informations sur la spécification du type d’abonnement, consultez [Spécifier un type d’abonnement de fusion et une priorité pour la résolution des conflits &#40;SQL Server Management Studio&#41;](../specify-a-merge-subscription-type-and-conflict-resolution-priority.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-115">For more information about specifying subscription type, see [Specify a Merge Subscription Type and Conflict Resolution Priority &#40;SQL Server Management Studio&#41;](../specify-a-merge-subscription-type-and-conflict-resolution-priority.md).</span></span>  
  
    -   <span data-ttu-id="141a9-116">Programme de résolution personnalisé que vous avez écrit. Il peut s'agir d'un gestionnaire de logique métier (écrit en code managé) ou d'un programme de résolution COM personnalisé.</span><span class="sxs-lookup"><span data-stu-id="141a9-116">A custom resolver you have written, which can be a business logic handler (written in managed code) or a custom COM-based resolver.</span></span> <span data-ttu-id="141a9-117">Pour plus d’informations, consultez [Détection et résolution avancées des conflits de réplication de fusion](../merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-117">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](../merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span> <span data-ttu-id="141a9-118">Si vous devez implémenter une logique personnalisée qui est exécutée pour chaque ligne répliquée, pas seulement pour les lignes en conflit, consultez [Implémenter un gestionnaire de logique métier pour un article de fusion](../implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-118">If you need to implement custom logic that is executed for each replicated row, not just for conflicting rows, see [Implement a Business Logic Handler for a Merge Article](../implement-a-business-logic-handler-for-a-merge-article.md).</span></span>  
  
    -   <span data-ttu-id="141a9-119">Programme de résolution COM standard, fourni avec [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="141a9-119">A standard COM-based resolver, which is included with [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="141a9-120">Pour utiliser un programme de résolution autre que le programme de résolution par défaut, vous devez le copier sur l'ordinateur exécutant l'Agent de fusion et l'inscrire (si vous utilisez un gestionnaire de logique métier, il doit être également inscrit sur le serveur de publication).</span><span class="sxs-lookup"><span data-stu-id="141a9-120">To use a resolver other than the default resolver, you must copy the resolver to the computer on which the Merge Agent runs and register it (if you are using a business logic handler, it must also be registered at the Publisher).</span></span> <span data-ttu-id="141a9-121">L'Agent de fusion s'exécute sur :</span><span class="sxs-lookup"><span data-stu-id="141a9-121">The Merge Agent runs at:</span></span>  
  
    -   <span data-ttu-id="141a9-122">le serveur de distribution pour un abonnement envoyé ;</span><span class="sxs-lookup"><span data-stu-id="141a9-122">The Distributor for a push subscription</span></span>  
  
    -   <span data-ttu-id="141a9-123">l'Abonné pour un abonnement extrait ;</span><span class="sxs-lookup"><span data-stu-id="141a9-123">The Subscriber for a pull subscription</span></span>  
  
    -   <span data-ttu-id="141a9-124">le serveur [!INCLUDE[msCoName](../../../includes/msconame-md.md)] IIS (Internet Information Services) pour un abonnement extrait qui utilise la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="141a9-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Internet Information Services (IIS) server for a pull subscription that uses Web synchronization</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="141a9-125">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="141a9-125">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="141a9-126">Une fois le programme de résolution inscrit, spécifiez qu’un article doit l’utiliser sous l’onglet **Résolveur** de la boîte de dialogue **Propriétés de l’article - \<Article>** , accessible dans l’Assistant Nouvelle publication et dans la boîte de dialogue **Propriétés de la publication - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="141a9-126">After the resolver is registered, specify that an article should use the resolver on the **Resolver** tab of the **Article Properties - \<Article>** dialog box, which is available in the New Publication Wizard and the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="141a9-127">Pour plus d’informations sur l’utilisation de l’Assistant et sur l’accès à la boîte de dialogue, consultez [Créer une publication](create-a-publication.md) et [Afficher et modifier les propriétés d’une publication](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-127">For more information about using the wizard and accessing the dialog box, see [Create a Publication](create-a-publication.md) and [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span>  
  
#### <a name="to-specify-a-resolver"></a><span data-ttu-id="141a9-128">Pour spécifier un programme de résolution</span><span class="sxs-lookup"><span data-stu-id="141a9-128">To specify a resolver</span></span>  
  
1.  <span data-ttu-id="141a9-129">Dans la page **Articles** de l’Assistant Nouvelle publication ou la boîte de dialogue **Propriétés de la publication - \<Publication>** , sélectionnez une table.</span><span class="sxs-lookup"><span data-stu-id="141a9-129">On the **Articles** page of the New Publication Wizard or the **Publication Properties - \<Publication>** dialog box, select a table.</span></span>  
  
2.  <span data-ttu-id="141a9-130">Cliquez sur **Propriétés de l'article**puis sur **Définir les propriétés de l'article de la table en surbrillance**.</span><span class="sxs-lookup"><span data-stu-id="141a9-130">Click **Article Properties**, and then click **Set Properties of Highlighted Table Article**.</span></span>  
  
3.  <span data-ttu-id="141a9-131">Dans la page **Propriétés de l’article - \<Article>** , cliquez sur l’onglet **Résolveur**.</span><span class="sxs-lookup"><span data-stu-id="141a9-131">On the **Article Properties - \<Article>** page, click the **Resolver** tab.</span></span>  
  
4.  <span data-ttu-id="141a9-132">Sélectionnez **Utiliser un résolveur personnalisé (inscrit sur le serveur de distribution)** puis, dans la liste, cliquez sur le programme de résolution.</span><span class="sxs-lookup"><span data-stu-id="141a9-132">Select **Use a custom resolver (registered at the Distributor)**, and then in the list, click the resolver.</span></span>  
  
5.  <span data-ttu-id="141a9-133">Si le programme de résolution nécessite des entrées (par exemple un nom de colonne), indiquez- les dans la zone de texte **Entrez les informations requises par le résolveur** .</span><span class="sxs-lookup"><span data-stu-id="141a9-133">If the resolver requires input (such as a column name), specify it in the **Enter information needed by the resolver** text box.</span></span>  
  
6.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
7.  <span data-ttu-id="141a9-134">Répétez la procédure pour chaque article exigeant un programme de résolution.</span><span class="sxs-lookup"><span data-stu-id="141a9-134">Repeat this process for each article that requires a resolver.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="141a9-135">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="141a9-135">Using Transact-SQL</span></span>  
  
#### <a name="to-register-a-custom-conflict-resolver"></a><span data-ttu-id="141a9-136">Pour inscrire un outil personnalisé de résolution des conflits</span><span class="sxs-lookup"><span data-stu-id="141a9-136">To register a custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="141a9-137">Si vous projetez d'inscrire votre propre outil personnalisé de résolution des conflits, créez-en un répondant à l'un des types suivants :</span><span class="sxs-lookup"><span data-stu-id="141a9-137">If you plan to register your own custom conflict resolver, create one of the following types:</span></span>  
  
    -   <span data-ttu-id="141a9-138">Programme de résolution s'appuyant sur le code managé, comme un gestionnaire de logique métier.</span><span class="sxs-lookup"><span data-stu-id="141a9-138">Managed code-based resolver as a business logic handler.</span></span> <span data-ttu-id="141a9-139">Pour plus d’informations, voir [Implémenter un gestionnaire de logique métier pour un article de fusion](../implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-139">For more information, see [Implement a Business Logic Handler for a Merge Article](../implement-a-business-logic-handler-for-a-merge-article.md).</span></span>  
  
    -   <span data-ttu-id="141a9-140">Programme de résolution s'appuyant sur des procédures stockées et sur COM.</span><span class="sxs-lookup"><span data-stu-id="141a9-140">Stored procedure-based resolver and COM-based resolver.</span></span> <span data-ttu-id="141a9-141">Pour plus d’informations, consultez [Implémenter un outil personnalisé de résolution des conflits pour un article de fusion](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-141">For more information, see [Implement a Custom Conflict Resolver for a Merge Article](../implement-a-custom-conflict-resolver-for-a-merge-article.md).</span></span>  
  
2.  <span data-ttu-id="141a9-142">Pour déterminer si le programme de résolution souhaité est déjà inscrit, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) au niveau du serveur de publication dans toute base de données.</span><span class="sxs-lookup"><span data-stu-id="141a9-142">To determine if the desired resolver is already registered, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) at the Publisher on any database.</span></span> <span data-ttu-id="141a9-143">Une description du programme de résolution personnalisé est alors affichée, de même que le CLSID de chaque programme de résolution s'appuyant sur l'architecture COM inscrit sur le serveur de distribution ou des informations sur l'assembly managé pour chaque gestionnaire de logique métier inscrit sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="141a9-143">This displays a description of the custom resolver as well as the class identifier (CLSID) for each COM-based resolver registered at the Distributor or information on the managed assembly for each business logic handler registered at the Distributor.</span></span>  
  
3.  <span data-ttu-id="141a9-144">Si le programme de résolution personnalisé souhaité n’est pas encore inscrit, exécutez [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) au niveau du serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="141a9-144">If the desired custom resolver is not already registered, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) at the Distributor.</span></span> <span data-ttu-id="141a9-145">Spécifiez un nom pour le programme de résolution pour **@article_resolver** ; pour un gestionnaire de logique métier, il s’agit du nom convivial de l’assembly.</span><span class="sxs-lookup"><span data-stu-id="141a9-145">Specify a name for the resolver for **@article_resolver**; for a business logic handler, this is the friendly name of the assembly.</span></span> <span data-ttu-id="141a9-146">Pour les programmes de résolution basés sur COM, spécifiez le CLSID de la DLL pour **@resolver_clsid** et, pour un gestionnaire de logique métier, spécifiez la valeur `true` pour **@is_dotnet_assembly** , le nom de l’assembly pour **@dotnet_assembly_name** et le nom complet de la classe qui substitue <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> pour **@dotnet_class_name** .</span><span class="sxs-lookup"><span data-stu-id="141a9-146">For COM-based resolvers, specify the CLSID of the DLL for **@resolver_clsid**, and for a business logic handler, specify a value of `true` for **@is_dotnet_assembly**, the name of the assembly for **@dotnet_assembly_name**, and the fully-qualified name of the class that overrides <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport.BusinessLogicModule> for **@dotnet_class_name**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="141a9-147">Si un assembly de gestionnaire de logique métier n’est pas déployé dans le même répertoire que l’exécutable Agent de fusion, dans le même répertoire que l’application qui démarre de façon synchrone le Agent de fusion ou dans le Global Assembly Cache (GAC), vous devez spécifier le chemin d’accès complet avec le nom de l’assembly pour **@dotnet_assembly_name** .</span><span class="sxs-lookup"><span data-stu-id="141a9-147">If a business logic handler assembly is not deployed in the same directory as the Merge Agent executable, in the same directory as the application that synchronously starts the Merge Agent, or in the global assembly cache (GAC), you need to specify the full path with the assembly name for **@dotnet_assembly_name**.</span></span>  
  
4.  <span data-ttu-id="141a9-148">Si le programme de résolution est un programme de résolution s'appuyant sur l'architecture COM :</span><span class="sxs-lookup"><span data-stu-id="141a9-148">If the resolver is a COM-based resolver:</span></span>  
  
    -   <span data-ttu-id="141a9-149">Copiez la DLL de programme de résolution personnalisé sur le serveur de distribution pour les abonnements par émission de données ou sur l'Abonné pour les abonnements par extraction.</span><span class="sxs-lookup"><span data-stu-id="141a9-149">Copy the custom resolver DLL to the Distributor for push subscriptions or to the Subscriber for pull subscriptions.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="141a9-150">Les programmes de résolution personnalisés[!INCLUDE[msCoName](../../../includes/msconame-md.md)] se trouvent dans le répertoire [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="141a9-150">[!INCLUDE[msCoName](../../../includes/msconame-md.md)] custom resolvers can be found in the [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM directory.</span></span>  
  
    -   <span data-ttu-id="141a9-151">Utilisez regsvr32.exe pour inscrire la DLL du programme de résolution personnalisé auprès du système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="141a9-151">Use regsvr32.exe to register the custom resolver DLL with the operating system.</span></span> <span data-ttu-id="141a9-152">Par exemple, l'exécution de la commande suivante à partir de l'invite de commandes inscrit l'Outil de résolution des conflits d'addition [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="141a9-152">For example, executing the following from the command prompt registers the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver:</span></span>  
  
        ```  
        regsvr32 ssradd.dll  
        ```  
  
5.  <span data-ttu-id="141a9-153">Si le programme de résolution est un gestionnaire de logique métier, déployez l’assembly dans le même dossier que le Agent de fusion exécutable (replmerg.exe), dans le même dossier qu’une application qui appelle le Agent de fusion ou dans le dossier spécifié pour le **@dotnet_assembly_name** paramètre à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="141a9-153">If the resolver is a business logic handler, deploy the assembly in the same folder as the Merge Agent executable (replmerg.exe), in the same folder as an application that invokes the Merge Agent, or in the folder specified for the **@dotnet_assembly_name** parameter in step 3.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="141a9-154">L'emplacement d'installation par défaut du fichier exécutable de l'Agent de fusion est [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span><span class="sxs-lookup"><span data-stu-id="141a9-154">The default installation location of the Merge Agent executable is [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM.</span></span>  
  
#### <a name="to-specify-a-custom-resolver-when-defining-a-merge-article"></a><span data-ttu-id="141a9-155">Pour spécifier un programme de résolution personnalisé lors de la définition d'un article de fusion</span><span class="sxs-lookup"><span data-stu-id="141a9-155">To specify a custom resolver when defining a merge article</span></span>  
  
1.  <span data-ttu-id="141a9-156">Si vous projetez d'utiliser un outil personnalisé de résolution des conflits, créez et inscrivez le programme de résolution à l'aide de la procédure précitée.</span><span class="sxs-lookup"><span data-stu-id="141a9-156">If you plan to use a custom conflict resolver, create and register the resolver using the above procedure.</span></span>  
  
2.  <span data-ttu-id="141a9-157">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) et notez le nom du programme de résolution personnalisé souhaité dans le champ **value** du jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="141a9-157">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the desired custom resolver in the **value** field of result set.</span></span>  
  
3.  <span data-ttu-id="141a9-158">Dans la base de données de publication sur le serveur de publication, exécutez [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="141a9-158">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql).</span></span> <span data-ttu-id="141a9-159">Spécifiez le nom du programme de résolution de l’étape 2 pour **@article_resolver** et toute entrée requise pour le programme de résolution personnalisé à l’aide du **@resolver_info** paramètre.</span><span class="sxs-lookup"><span data-stu-id="141a9-159">Specify the name of the resolver from step 2 for **@article_resolver** and any required input to the custom resolver using the **@resolver_info** parameter.</span></span> <span data-ttu-id="141a9-160">Pour les programmes de résolution personnalisés basés sur des procédures stockées, **@resolver_info** est le nom de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="141a9-160">For stored procedure-based custom resolvers, **@resolver_info** is the name of the stored procedure.</span></span> <span data-ttu-id="141a9-161">Pour plus d’informations sur l’entrée nécessaire aux programmes de résolution fournis par [!INCLUDE[msCoName](../../../includes/msconame-md.md)], consultez [Programmes de résolution COM Microsoft](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-161">For more information about required input for resolvers supplied by [!INCLUDE[msCoName](../../../includes/msconame-md.md)], see [Microsoft COM-Based Resolvers](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span></span>  
  
#### <a name="to-specify-or-change-a-custom-resolver-for-an-existing-merge-article"></a><span data-ttu-id="141a9-162">Pour spécifier ou modifier un programme de résolution personnalisé pour un article de fusion existant</span><span class="sxs-lookup"><span data-stu-id="141a9-162">To specify or change a custom resolver for an existing merge article</span></span>  
  
1.  <span data-ttu-id="141a9-163">Pour déterminer si un programme de résolution personnalisé a été défini pour un article, ou pour obtenir le nom du programme de résolution, exécutez [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="141a9-163">To determine if a custom resolver has been defined for an article, or to get the name of the resolver, execute [sp_helpmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql).</span></span> <span data-ttu-id="141a9-164">Si un programme de résolution personnalisé a été défini pour l'article, son nom est affiché dans le champ **article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="141a9-164">If there is a custom resolver defined for the article, its name will be displayed in the **article_resolver** field.</span></span> <span data-ttu-id="141a9-165">Toute entrée fournie au programme de résolution est affichée dans le champ **resolver_info** du jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="141a9-165">Any input supplied to the resolver will be displayed in the **resolver_info** field of the result set.</span></span>  
  
2.  <span data-ttu-id="141a9-166">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) et notez le nom du programme de résolution personnalisé souhaité dans le champ **value** du jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="141a9-166">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the desired custom resolver in the **value** field of the result set.</span></span>  
  
3.  <span data-ttu-id="141a9-167">Dans la base de données de publication sur le serveur de publication, exécutez [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="141a9-167">At the Publisher on the publication database, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span></span> <span data-ttu-id="141a9-168">Affectez la valeur **article_resolver**, y compris le chemin d'accès complet pour les gestionnaires de logique métier, à **@property**, et le nom du programme de résolution personnalisé souhaité de l'étape 2 à **@value**.</span><span class="sxs-lookup"><span data-stu-id="141a9-168">Specify a value of **article_resolver**, including the full path for business logic handlers, for **@property**, and the name of the desired custom resolver from step 2 for **@value**.</span></span>  
  
4.  <span data-ttu-id="141a9-169">Pour modifier toute entrée requise pour le programme de résolution personnalisé, réexécutez [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="141a9-169">To change any required input for the custom resolver, execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql) again.</span></span> <span data-ttu-id="141a9-170">Affectez la valeur **resolver_info** à **@property** et toute entrée requise pour le programme de résolution personnalisé à **@value**.</span><span class="sxs-lookup"><span data-stu-id="141a9-170">Specify a value of **resolver_info** for **@property** and any required input to the custom resolver for **@value**.</span></span> <span data-ttu-id="141a9-171">Pour les programmes de résolution personnalisés basés sur des procédures stockées, **@resolver_info** est le nom de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="141a9-171">For stored procedure-based custom resolvers, **@resolver_info** is the name of the stored procedure.</span></span> <span data-ttu-id="141a9-172">Pour plus d’informations sur l’entrée nécessaire, consultez [Programmes de résolution COM Microsoft](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="141a9-172">For more information about required input, see [Microsoft COM-Based Resolvers](../merge/advanced-merge-replication-conflict-com-based-resolvers.md).</span></span>  
  
#### <a name="to-unregister-a-custom-conflict-resolver"></a><span data-ttu-id="141a9-173">Pour annuler l'inscription d'un outil personnalisé de résolution des conflits</span><span class="sxs-lookup"><span data-stu-id="141a9-173">To unregister a custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="141a9-174">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) et notez le nom du programme de résolution personnalisé à supprimer dans le champ **value** du jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="141a9-174">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the name of the custom resolver to remove in the **value** field of the result set.</span></span>  
  
2.  <span data-ttu-id="141a9-175">Exécutez [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql) sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="141a9-175">Execute [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql) at the Distributor.</span></span> <span data-ttu-id="141a9-176">Spécifiez le nom complet du programme de résolution personnalisé de l’étape 1 pour **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="141a9-176">Specify the full name of the custom resolver from step 1 for **@article_resolver**.</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="141a9-177">Exemples (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="141a9-177">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="141a9-178">Cet exemple crée un article et spécifie que l'Outil de résolution des conflits de moyenne [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] doit être utilisé pour calculer la moyenne de la colonne **UnitPrice** en cas de conflit.</span><span class="sxs-lookup"><span data-stu-id="141a9-178">This example creates a new article and specifies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Averaging Conflict Resolver be used to calculate the average of the **UnitPrice** column when conflicts occur.</span></span>  
  
 [!code-sql[HowTo#sp_addmerge_resolver](../../../snippets/tsql/SQL15/replication/howto/tsql/mergearticleresolvers.sql#sp_addmerge_resolver)]  
  
 <span data-ttu-id="141a9-179">Cet exemple modifie un article de manière à spécifier que l'Outil de résolution des conflits d'addition [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] doit être utilisé pour calculer la somme de la colonne **UnitsOnOrder** en cas de conflit.</span><span class="sxs-lookup"><span data-stu-id="141a9-179">This example changes an article to specify using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Additive Conflict Resolver to calculate the sum of the **UnitsOnOrder** column when conflicts occur.</span></span>  
  
 [!code-sql[HowTo#sp_changemerge_resolver](../../../snippets/tsql/SQL15/replication/howto/tsql/mergearticleresolvers.sql#sp_changemerge_resolver)]  
  
## <a name="see-also"></a><span data-ttu-id="141a9-180">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="141a9-180">See Also</span></span>  
 <span data-ttu-id="141a9-181">[Détection et résolution des conflits de réplication de fusion avancée](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="141a9-181">[Advanced Merge Replication Conflict Detection and Resolution](../merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 [<span data-ttu-id="141a9-182">Implémenter un gestionnaire de logique métier pour un article de fusion</span><span class="sxs-lookup"><span data-stu-id="141a9-182">Implement a Business Logic Handler for a Merge Article</span></span>](../implement-a-business-logic-handler-for-a-merge-article.md)  
  
  
