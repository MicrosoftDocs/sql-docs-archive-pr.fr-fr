---
title: Modifier le schéma dans les bases de données de publication | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], schema changes
- snapshot replication [SQL Server], replicating schema changes
- merge replication [SQL Server replication], replicating schema changes
- transactional replication, replicating schema changes
- schemas [SQL Server replication], replicating changes
- publishing [SQL Server replication], schema changes
ms.assetid: 926c88d7-a844-402f-bcb9-db49e5013b69
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e26d3e89fcba41d474ca56637f9e465f17127348
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600790"
---
# <a name="make-schema-changes-on-publication-databases"></a><span data-ttu-id="e4bcc-102">Modifier le schéma dans les bases de données de publication</span><span class="sxs-lookup"><span data-stu-id="e4bcc-102">Make Schema Changes on Publication Databases</span></span>
  <span data-ttu-id="e4bcc-103">La réplication prend en charge une grande variété de modifications de schéma pour les objets publiés.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-103">Replication supports a wide range of schema changes to published objects.</span></span> <span data-ttu-id="e4bcc-104">Quand vous effectuez une des modifications de schéma suivantes dans l’objet publié approprié sur un Abonné [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], cette modification est propagée par défaut sur tous les Abonnés [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="e4bcc-104">When you make any of the following schema changes on the appropriate published object at a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publisher, that change is propagated by default to all [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Subscribers:</span></span>  
  
-   <span data-ttu-id="e4bcc-105">ALTER TABLE</span><span class="sxs-lookup"><span data-stu-id="e4bcc-105">ALTER TABLE</span></span>  
  
-   <span data-ttu-id="e4bcc-106">ALTER TABLE SET LOCK ESCALATION ne doit pas être utilisé si la réplication de modification de schéma est activée et qu'une topologie inclut des Abonnés [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] ou [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] : ALTER VIEW.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-106">ALTER TABLE SET LOCK ESCALATION should not be used if schema change replication is enabled and a topology includes [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or [!INCLUDE[ssEWnoversion](../../../includes/ssewnoversion-md.md)] Subscribers.ALTER VIEW</span></span>  
  
-   <span data-ttu-id="e4bcc-107">ALTER PROCEDURE</span><span class="sxs-lookup"><span data-stu-id="e4bcc-107">ALTER PROCEDURE</span></span>  
  
-   <span data-ttu-id="e4bcc-108">ALTER FUNCTION</span><span class="sxs-lookup"><span data-stu-id="e4bcc-108">ALTER FUNCTION</span></span>  
  
-   <span data-ttu-id="e4bcc-109">ALTER TRIGGER</span><span class="sxs-lookup"><span data-stu-id="e4bcc-109">ALTER TRIGGER</span></span>  
  
     <span data-ttu-id="e4bcc-110">ALTER TRIGGER ne peut être utilisé qu'avec les déclencheurs DML car les déclencheurs DDL ne peuvent pas être répliqués.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-110">ALTER TRIGGER can be used only for data manipulation language [DML] triggers because data definition language [DDL] triggers cannot be replicated.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="e4bcc-111">Les modifications de schéma apportées aux tables doivent être effectuées à l'aide de [!INCLUDE[tsql](../../../includes/tsql-md.md)] ou des objets SMO ( [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-111">Schema changes to tables must be made by using [!INCLUDE[tsql](../../../includes/tsql-md.md)] or [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO).</span></span> <span data-ttu-id="e4bcc-112">Lorsque des modifications de schéma sont effectuées dans [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] tente de supprimer puis de recréer la table.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-112">When schema changes are made in [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[ssManStudio](../../../includes/ssmanstudio-md.md)] attempts to drop and re-create the table.</span></span> <span data-ttu-id="e4bcc-113">La suppression des objets publiés étant impossible, la modification de schéma échoue.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-113">You cannot drop published objects, therefore the schema change fails.</span></span>  
  
 <span data-ttu-id="e4bcc-114">Dans le cas de la réplication transactionnelle ou de fusion, les modifications de schéma sont propagées de manière incrémentielle lors de l'exécution de l'Agent de distribution ou de fusion.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-114">For transactional replication and merge replication, schema changes are propagated incrementally when the Distribution Agent or Merge Agent runs.</span></span> <span data-ttu-id="e4bcc-115">Avec la réplication d'instantané, les modifications de schéma sont propagées lors de l'application d'un nouvel instantané sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-115">For snapshot replication, schema changes are propagated when a new snapshot is applied at the Subscriber.</span></span> <span data-ttu-id="e4bcc-116">Dans la réplication d'instantané, une nouvelle copie du schéma est envoyée à l'Abonné à chaque synchronisation.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-116">In snapshot replication, a new copy of the schema is sent to the Subscriber each time synchronization occurs.</span></span> <span data-ttu-id="e4bcc-117">Par conséquent, toutes les modifications de schéma (pas uniquement celles répertoriées ci-dessus) apportées aux objets précédemment publiés sont automatiquement propagées avec chaque synchronisation.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-117">Therefore, all schema changes (not just those listed above) to previously published objects are automatically propagated with each synchronization.</span></span>  
  
 <span data-ttu-id="e4bcc-118">Pour obtenir des informations sur l’ajout et la suppression d’articles dans les publications, consultez [Ajouter et supprimer des articles de publications existantes](add-articles-to-and-drop-articles-from-existing-publications.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-118">For information about adding and removing articles from publications, see [Add Articles to and Drop Articles from Existing Publications](add-articles-to-and-drop-articles-from-existing-publications.md).</span></span>  
  
 <span data-ttu-id="e4bcc-119">**Pour répliquer les modifications de schéma**</span><span class="sxs-lookup"><span data-stu-id="e4bcc-119">**To replicate schema changes**</span></span>  
  
 <span data-ttu-id="e4bcc-120">Les modifications de schéma répertoriées ci-dessus sont répliquées par défaut.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-120">The schema changes listed above are replicated by default.</span></span> <span data-ttu-id="e4bcc-121">Pour plus d'informations sur la désactivation de la réplication des modifications de schéma, consultez [Replicate Schema Changes](replicate-schema-changes.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-121">For information about disabling the replication of schema changes, see [Replicate Schema Changes](replicate-schema-changes.md).</span></span>  
  
## <a name="considerations-for-schema-changes"></a><span data-ttu-id="e4bcc-122">Considérations sur les modifications de schéma</span><span class="sxs-lookup"><span data-stu-id="e4bcc-122">Considerations for Schema Changes</span></span>  
 <span data-ttu-id="e4bcc-123">Les éléments suivants doivent être pris en compte lors de la réplication des modifications de schéma.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-123">Keep the following considerations in mind when replicating schema changes.</span></span>  
  
### <a name="general-considerations"></a><span data-ttu-id="e4bcc-124">Considérations d’ordre général</span><span class="sxs-lookup"><span data-stu-id="e4bcc-124">General Considerations</span></span>  
  
-   <span data-ttu-id="e4bcc-125">Les modifications de schéma sont soumises aux restrictions imposées par [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4bcc-125">Schema changes are subject to any restrictions imposed by [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="e4bcc-126">Par exemple, ALTER TABLE ne vous permet pas de modifier les colonnes clés primaire.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-126">For example, ALTER TABLE does not allow you to ALTER primary key columns.</span></span>  
  
-   <span data-ttu-id="e4bcc-127">Le mappage de type de données est effectué uniquement pour l'instantané initial.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-127">Data type mapping is performed only for the initial snapshot.</span></span> <span data-ttu-id="e4bcc-128">Les modifications de schéma ne sont pas mappées aux versions précédentes des types de données.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-128">Schema changes are not mapped to previous versions of data types.</span></span> <span data-ttu-id="e4bcc-129">Par exemple, si l'instruction `ALTER TABLE ADD datetime2 column` est utilisée dans [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], le type de données n'est pas traduit par `nvarchar` pour les Abonnés [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e4bcc-129">For example, if the statement `ALTER TABLE ADD datetime2 column` is used in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)], the data type is not translated to `nvarchar` for [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] Subscribers.</span></span> <span data-ttu-id="e4bcc-130">Dans certains cas, les modifications de schéma sont bloquées sur le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-130">In some cases, schema changes are blocked on the Publisher.</span></span>  
  
-   <span data-ttu-id="e4bcc-131">Si la configuration d'une publication autorise la propagation des modifications de schéma, celles-ci sont propagées quelle que soit la configuration de l'option de schéma associée pour un article de la publication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-131">If a publication is set to allow the propagation of schema changes, schema changes are propagated regardless of how the related schema option is set for an article in the publication.</span></span> <span data-ttu-id="e4bcc-132">Si, par exemple, vous décidez de ne pas répliquer les contraintes de clé étrangère pour un article de table mais qu'ensuite vous émettez une commande ALTER TABLE qui ajoute une clé étrangère sur le serveur de publication, la clé étrangère est ajoutée à la table sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-132">For example, if you select not to replicate foreign key constraints for a table article, but then issue an ALTER TABLE command that adds a foreign key to the table at the Publisher, the foreign key is added to the table at the Subscriber.</span></span> <span data-ttu-id="e4bcc-133">Pour éviter cela, désactivez la propagation des modifications de schéma avant d'émettre la commande ALTER TABLE.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-133">To prevent this, disable the propagation of schema changes before issuing the ALTER TABLE command.</span></span>  
  
-   <span data-ttu-id="e4bcc-134">Les modifications de schéma doivent être uniquement effectuées sur le serveur de publication et non sur les Abonnés (y compris les Abonnés de republication).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-134">Schema changes should be made only at the Publisher, not at Subscribers (including republishing Subscribers).</span></span> <span data-ttu-id="e4bcc-135">La réplication de fusion interdit les modifications de schéma sur l'Abonné,</span><span class="sxs-lookup"><span data-stu-id="e4bcc-135">Merge replication prevents schema changes at the Subscriber.</span></span> <span data-ttu-id="e4bcc-136">à la différence de la réplication transactionnelle mais dans ce dernier cas, il se peut que les modifications apportées entraînent l'échec de la réplication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-136">Transactional replication does not prevent the changes, but the changes can cause replication to fail.</span></span>  
  
-   <span data-ttu-id="e4bcc-137">Les modifications propagées à un Abonné de republication sont transmises par défaut à ses Abonnés.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-137">Changes propagated to a republishing Subscriber are by default propagated to its Subscribers.</span></span>  
  
-   <span data-ttu-id="e4bcc-138">Si la modification de schéma fait référence à des objets ou des contraintes qui existent sur le serveur de publication mais pas sur l'Abonné, elle est effectuée sur le serveur de publication mais échoue sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-138">If the schema change references objects or constraints existing on the Publisher but not on the Subscriber, the schema change will succeed on the Publisher but will fail on the Subscriber.</span></span>  
  
-   <span data-ttu-id="e4bcc-139">Tous les objets de l'Abonné référencés lors de l'ajout d'une clé étrangère doivent avoir un nom et un propriétaire identiques à l'objet correspondant sur le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-139">All objects on the Subscriber that are referenced when adding a foreign key must have the same name and owner as the corresponding object on the Publisher.</span></span>  
  
-   <span data-ttu-id="e4bcc-140">L'ajout, la suppression ou la modification explicites d'index ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-140">Explicitly adding, dropping, or altering indexes is not supported.</span></span> <span data-ttu-id="e4bcc-141">En revanche, les index créés explicitement pour les contraintes, par exemple une contrainte de clé primaire, le sont.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-141">Indexes created implicitly for constraints (such as a primary key constraint) are supported.</span></span>  
  
-   <span data-ttu-id="e4bcc-142">La modification ou la suppression de colonnes d'identité gérées par la réplication ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-142">Altering or dropping identity columns that are managed by replication is not supported.</span></span> <span data-ttu-id="e4bcc-143">Pour plus d’informations sur la gestion automatique des colonnes d’identité, consultez [Répliquer des colonnes d’identité](replicate-identity-columns.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-143">For more information about automatic management of identity columns, see [Replicate Identity Columns](replicate-identity-columns.md).</span></span>  
  
-   <span data-ttu-id="e4bcc-144">Les modifications de schéma qui comprennent des fonctions non déterministes ne sont pas prises en charge car elles peuvent se traduire par la présence de données différentes sur le serveur de publication et l'Abonné (c'est-à-dire non convergentes).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-144">Schema changes that include nondeterministic functions are not supported because they can result in data at the Publisher and Subscriber being different (referred to as non-convergence).</span></span> <span data-ttu-id="e4bcc-145">Par exemple, si vous émettez la commande suivante sur le serveur de publication : `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, les valeurs diffèrent lorsque la commande est répliquée sur l'Abonné, puis exécutée.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-145">For example, if you issue the following command at the Publisher: `ALTER TABLE SalesOrderDetail ADD OrderDate DATETIME DEFAULT GETDATE()`, the values are different when the command is replicated to the Subscriber and executed.</span></span> <span data-ttu-id="e4bcc-146">Pour plus d'informations sur les fonctions non déterministes, consultez [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-146">For more information about nondeterministic functions, see [Deterministic and Nondeterministic Functions](../../user-defined-functions/deterministic-and-nondeterministic-functions.md).</span></span>  
  
-   <span data-ttu-id="e4bcc-147">Il est conseillé de nommer explicitement les contraintes.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-147">It is recommended that constraints be explicitly named.</span></span> <span data-ttu-id="e4bcc-148">Si les contraintes ne sont pas nommées explicitement, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] génère des noms pour celles-ci, qui seront différents sur le serveur de publication et sur chaque Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-148">If a constraint is not explicitly named, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a name for the constraint, and these names will be different on the Publisher and each Subscriber.</span></span> <span data-ttu-id="e4bcc-149">Cela peut occasionner des problèmes pendant la réplication des modifications de schéma.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-149">This can cause issues during the replication of schema changes.</span></span> <span data-ttu-id="e4bcc-150">Par exemple, si vous supprimez une colonne sur le serveur de publication et qu'une contrainte dépendante est supprimée, la réplication essaie de supprimer la contrainte sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-150">For example, if you drop a column at the Publisher and a dependent constraint is dropped, replication will attempt to drop the constraint at the Subscriber.</span></span> <span data-ttu-id="e4bcc-151">La suppression sur l'Abonné échouera car le nom de la contrainte est différent.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-151">The drop at the Subscriber will fail because the name of the constraint is different.</span></span> <span data-ttu-id="e4bcc-152">Si la synchronisation échoue en raison d'un problème de dénomination de contrainte, supprimez manuellement la contrainte sur l'Abonné, puis réexécutez l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-152">If synchronization fails because of a constraint naming issue, manually drop the constraint at the Subscriber and then rerun the Merge Agent.</span></span>  
  
-   <span data-ttu-id="e4bcc-153">Si une table est publiée pour la réplication, il n'est pas possible de modifier une colonne de cette table en lui attribuant un type de données XML si un instantané de publication a déjà été généré. Pour modifier la colonne, vous devez d'abord supprimer la réplication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-153">If a table is published for replication, it is not possible to alter a column in that table to a data type of XML if a publication snapshot has already been generated To alter the column, you must first remove replication.</span></span>  
  
-   <span data-ttu-id="e4bcc-154">La lecture non validée n'est pas un niveau d'isolement pris en charge lors de l'exécution d'instructions DDL sur une table publiée.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-154">Read uncommitted is not a supported isolation level when doing DDL on a published table.</span></span>  
  
-   <span data-ttu-id="e4bcc-155">`SET CONTEXT_INFO` ne doit pas être utilisée pour modifier le contexte des transactions dans lesquelles des modifications de schéma sont exécutées sur les objets publiés.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-155">`SET CONTEXT_INFO` should not be used to modify the context of transactions where schema changes are performed against published objects.</span></span>  
  
#### <a name="adding-columns"></a><span data-ttu-id="e4bcc-156">Ajout de colonnes</span><span class="sxs-lookup"><span data-stu-id="e4bcc-156">Adding Columns</span></span>  
  
-   <span data-ttu-id="e4bcc-157">Pour ajouter une nouvelle colonne à une table et inclure la colonne dans une publication existante, exécutez ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-157">To add a new column to a table and include that column in an existing publication, execute ALTER TABLE \<Table> ADD \<Column>.</span></span> <span data-ttu-id="e4bcc-158">Par défaut, la colonne est alors répliquée sur tous les Abonnés.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-158">By default, the column is then replicated to all Subscribers.</span></span> <span data-ttu-id="e4bcc-159">La colonne doit accepter des valeurs NULL ou inclure une contrainte par défaut.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-159">The column must allow NULL values or include a default constraint.</span></span> <span data-ttu-id="e4bcc-160">Pour plus d'informations sur l'ajout de colonnes, consultez la section « Réplication de fusion » de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-160">For more information about adding columns, see the "Merge Replication" section in this topic.</span></span>  
  
-   <span data-ttu-id="e4bcc-161">Pour ajouter une nouvelle colonne à une table sans inclure cette colonne dans une publication existante, désactivez la réplication des modifications de schéma, puis exécutez ALTER TABLE \<Table> ADD \<Column>.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-161">To add a new column to a table and not include that column in an existing publication, disable the replication of schema changes, and then execute ALTER TABLE \<Table> ADD \<Column>.</span></span>  
  
-   <span data-ttu-id="e4bcc-162">Pour inclure une colonne existante dans une publication existante, utilisez [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) ou la boîte de dialogue **Propriétés de la publication - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="e4bcc-162">To include an existing column in an existing publication, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="e4bcc-163">Pour plus d'informations, voir [Définir et modifier un filtre de colonne](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-163">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="e4bcc-164">Cette opération exige la réinitialisation des abonnements.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-164">This will require subscriptions to be reinitialized.</span></span>  
  
-   <span data-ttu-id="e4bcc-165">L'ajout d'une colonne d'identité à une table publiée n'est pas pris en charge, car la nouvelle colonne peut entraîner une non-convergence quand la colonne est répliquée vers l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-165">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="e4bcc-166">Les valeurs de la colonne d'identité sur l'Abonné dépendent de l'ordre dans lequel les lignes sont physiquement stockées dans la table affectée.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-166">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="e4bcc-167">Les lignes sont susceptibles d'être stockées différemment sur l'Abonné ; la valeur de la colonne d'identité peut donc être différente pour les mêmes lignes.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-167">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
#### <a name="dropping-columns"></a><span data-ttu-id="e4bcc-168">Suppression de colonnes</span><span class="sxs-lookup"><span data-stu-id="e4bcc-168">Dropping Columns</span></span>  
  
-   <span data-ttu-id="e4bcc-169">Pour supprimer une colonne d’une publication existante et de la table sur le serveur de publication, exécutez ALTER TABLE \<Table> DROP \<Column>.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-169">To drop a column from an existing publication and drop the column from the table at the Publisher, execute ALTER TABLE \<Table> DROP \<Column>.</span></span> <span data-ttu-id="e4bcc-170">Par défaut, la colonne est alors supprimée de la table sur tous les Abonnés.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-170">By default, the column is then dropped from the table at all Subscribers.</span></span>  
  
-   <span data-ttu-id="e4bcc-171">Pour supprimer une colonne d’une publication existante, tout en la conservant dans la table sur le serveur de publication, utilisez [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql) ou la boîte de dialogue **Propriétés de la publication - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="e4bcc-171">To drop a column from an existing publication but retain the column in the table at the Publisher, use [sp_articlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-articlecolumn-transact-sql), [sp_mergearticlecolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-mergearticlecolumn-transact-sql), or the **Publication Properties - \<Publication>** dialog box.</span></span>  
  
     <span data-ttu-id="e4bcc-172">Pour plus d'informations, voir [Définir et modifier un filtre de colonne](define-and-modify-a-column-filter.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-172">For more information, see [Define and Modify a Column Filter](define-and-modify-a-column-filter.md).</span></span> <span data-ttu-id="e4bcc-173">Cette opération exige la génération d'un nouvel instantané.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-173">This will require a new snapshot to be generated.</span></span>  
  
-   <span data-ttu-id="e4bcc-174">La colonne à supprimer ne peut pas être utilisée dans les clauses de filtrage d'un article quelconque d'une publication de la base de données.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-174">The column to be dropped cannot be used in the filter clauses of any article of any publication in the database.</span></span>  
  
-   <span data-ttu-id="e4bcc-175">La suppression d'une colonne d'un article publié nécessite la prise en compte des éventuels contraintes, index ou propriétés de la colonne susceptibles d'affecter la base de données.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-175">When dropping a column from a published article, take into consideration any constraints, indexes, or properties of the column that could affect the database.</span></span> <span data-ttu-id="e4bcc-176">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="e4bcc-176">For example:</span></span>  
  
    -   <span data-ttu-id="e4bcc-177">Vous ne pouvez pas supprimer les colonnes utilisées dans une clé primaire d'articles de publications transactionnelles car elles sont utilisées par la réplication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-177">You cannot drop columns used in a primary key from articles in transactional publications, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="e4bcc-178">Vous ne pouvez pas supprimer la colonne rowguid d'articles de publications de fusion ou la colonne mstran_repl_version d'articles de publications transactionnelles qui prennent en charge les abonnement mis à jour car elles sont utilisées par la réplication.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-178">You cannot drop the rowguid column from articles in merge publications or the mstran_repl_version column from articles in transactional publications that support updating subscriptions, because they are used by replication.</span></span>  
  
    -   <span data-ttu-id="e4bcc-179">Les modifications d'index ne sont pas propagées aux Abonnés : si vous supprimez une colonne sur le serveur de publication et si un index dépendant est supprimé, la suppression de l'index n'est pas répliquée.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-179">Index changes are not propagated to Subscribers: if you drop a column at the Publisher and a dependent index is dropped, the index drop is not replicated.</span></span> <span data-ttu-id="e4bcc-180">Vous devez supprimer l'index sur l'Abonné avant de supprimer la colonne sur le serveur de publication, de manière à ce que la suppression de la colonne réussisse lorsqu'elle est répliquée depuis le serveur de publication vers l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-180">You should drop the index at the Subscriber before dropping the column at the Publisher, so that the column drop succeeds when it is replicated from the Publisher to the Subscriber.</span></span> <span data-ttu-id="e4bcc-181">Si la synchronisation échoue en raison d'un index sur l'Abonné, supprimez manuellement cet index, puis réexécutez l'Agent de fusion.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-181">If synchronization fails because of an index at the Subscriber, manually drop the index and then rerun the Merge Agent.</span></span>  
  
    -   <span data-ttu-id="e4bcc-182">Les opérations de suppression ne fonctionnent que si les contraintes sont nommées explicitement.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-182">Constraints should be explicitly named to allow for dropping.</span></span> <span data-ttu-id="e4bcc-183">Pour plus d'informations, consultez la section « Considérations générales », plus haut dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-183">For more information, see the "General Considerations" section earlier in this topic.</span></span>  
  
### <a name="transactional-replication"></a><span data-ttu-id="e4bcc-184">Réplication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="e4bcc-184">Transactional Replication</span></span>  
  
-   <span data-ttu-id="e4bcc-185">Les modifications de schéma sont propagées aux Abonnés exécutant des versions antérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], mais l'instruction DDL doit absolument inclure la syntaxe prise en charge par la version installée sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-185">Schema changes are propagated to Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], but the DDL statement should only include syntax supported by the version at the Subscriber.</span></span>  
  
     <span data-ttu-id="e4bcc-186">Si l'Abonné republie des données, les seules modifications de schéma prises en charge sont l'ajout et la suppression d'une colonne.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-186">If the Subscriber republishes data, the only supported schema changes are adding and dropping a column.</span></span> <span data-ttu-id="e4bcc-187">Ces modifications doivent être effectuées sur le serveur de publication à l’aide de [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) et [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) à la place de la syntaxe ALTER TABLE DDL.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-187">These changes should be made on the Publisher using [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) rather than ALTER TABLE DDL syntax.</span></span>  
  
-   <span data-ttu-id="e4bcc-188">Les modifications de schéma ne sont pas répliquées sur les Abonnés non SQL Server.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-188">Schema changes are not replicated to non-SQL Server Subscribers.</span></span>  
  
-   <span data-ttu-id="e4bcc-189">Ces modifications de schéma ne sont pas propagées si elles proviennent de serveurs de publication non[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e4bcc-189">Schema changes are not propagated from non-[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Publishers.</span></span>  
  
-   <span data-ttu-id="e4bcc-190">Vous ne pouvez pas modifier des vues indexées répliquées en tant que tables.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-190">You cannot alter indexed views that are replicated as tables.</span></span> <span data-ttu-id="e4bcc-191">Les vues indexées répliquées en tant que vues indexées peuvent l'être mais une fois modifiées, elles deviennent des tables régulières et non plus des vues indexées.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-191">Indexed views that are replicated as indexed views can be altered, but altering them will cause them to become regular views, rather than indexed views.</span></span>  
  
-   <span data-ttu-id="e4bcc-192">Si la publication prend en charge les abonnements avec mise à jour immédiate ou les abonnements avec mise à jour en attente, le système doit être suspendu avant toute modification du schéma : toutes les activités relatives à la table publiée doivent être interrompues au niveau du serveur de publication et des Abonnés. Par ailleurs, les modifications de données en attente doivent être propagées à tous les nœuds.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-192">If the publication supports immediate updating or queued updating subscriptions, the system must be quiesced before making schema changes: all activity on the published table must be stopped at the Publisher and Subscribers, and pending data changes must be propagated to all nodes.</span></span> <span data-ttu-id="e4bcc-193">Après la propagation des modifications de schéma à tous les nœuds, l'activité peut reprendre dans les tables publiées.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-193">After the schema changes have propagated to all nodes, activity can resume on the published tables.</span></span>  
  
-   <span data-ttu-id="e4bcc-194">Si la publication fait partie d'une topologie d'égal à égal, le système doit être suspendu le temps d'effectuer les modifications de schéma :</span><span class="sxs-lookup"><span data-stu-id="e4bcc-194">If the publication is in a peer-to-peer topology, the system must be quiesced before making schema changes.</span></span> <span data-ttu-id="e4bcc-195">Pour plus d’informations, consultez [Suspendre une topologie de réplication &#40;programmation Transact-SQL de la réplication&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-195">For more information, see [Quiesce a Replication Topology &#40;Replication Transact-SQL Programming&#41;](../administration/quiesce-a-replication-topology-replication-transact-sql-programming.md).</span></span>  
  
-   <span data-ttu-id="e4bcc-196">L'ajout d'une colonne d'horodatage à une table et le mappage de l'horodatage à binary(8) entraîne la réinitialisation de l'article pour tous les abonnements actifs.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-196">Adding a timestamp column to a table and mapping the timestamp to binary(8) causes the article to be reinitialized for all active subscriptions.</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="e4bcc-197">Réplication de fusion</span><span class="sxs-lookup"><span data-stu-id="e4bcc-197">Merge Replication</span></span>  
  
-   <span data-ttu-id="e4bcc-198">La façon dont la réplication de fusion gère des modifications de schéma est déterminée par le niveau de compatibilité de la publication et le fait que l'instantané soit défini en mode natif (par défaut) ou en mode caractère :</span><span class="sxs-lookup"><span data-stu-id="e4bcc-198">How merge replication handles schema changes is determined by the publication compatibility level, and whether the snapshot is set to native mode (default) or character mode:</span></span>  
  
    -   <span data-ttu-id="e4bcc-199">Pour répliquer les modifications de schéma, le niveau de compatibilité de la publication doit être au minimum égal à 90RTM.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-199">To replicate schema changes, the compatibility level of the publication must be at least 90RTM.</span></span> <span data-ttu-id="e4bcc-200">Si les Abonnés exécutent des versions antérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ou si le niveau de compatibilité est inférieur à 90RTM, vous pouvez utiliser [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) et [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) pour ajouter et supprimer des colonnes.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-200">If Subscribers are running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] or the compatibility level is less than 90RTM you can use [sp_repladdcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repladdcolumn-transact-sql) and [sp_repldropcolumn &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-repldropcolumn-transact-sql) to add and drop columns.</span></span> <span data-ttu-id="e4bcc-201">Toutefois, ces procédures sont déconseillées.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-201">However, these procedures are deprecated.</span></span>  
  
    -   <span data-ttu-id="e4bcc-202">Si vous essayez d'ajouter à un article existant une colonne avec un type de données qui a été introduit dans [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] présente le comportement suivant :</span><span class="sxs-lookup"><span data-stu-id="e4bcc-202">If you try to add to an existing article a column with a data type that was introduced in [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has the following behavior:</span></span>  
  
        ||<span data-ttu-id="e4bcc-203">100RTM, instantané natif</span><span class="sxs-lookup"><span data-stu-id="e4bcc-203">100RTM, native snapshot</span></span>|<span data-ttu-id="e4bcc-204">100RTM, instantané en mode caractère</span><span class="sxs-lookup"><span data-stu-id="e4bcc-204">100RTM, character snapshot</span></span>|<span data-ttu-id="e4bcc-205">Tous les autres niveaux de compatibilité</span><span class="sxs-lookup"><span data-stu-id="e4bcc-205">All other compatibility levels</span></span>|  
        |-|-----------------------------|--------------------------------|------------------------------------|  
        |`hierarchyid`|<span data-ttu-id="e4bcc-206">Autoriser la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-206">Allow change</span></span>|<span data-ttu-id="e4bcc-207">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-207">Block change</span></span>|<span data-ttu-id="e4bcc-208">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-208">Block change</span></span>|  
        |<span data-ttu-id="e4bcc-209">`geography` et `geometry`</span><span class="sxs-lookup"><span data-stu-id="e4bcc-209">`geography` and `geometry`</span></span>|<span data-ttu-id="e4bcc-210">Autoriser la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-210">Allow change</span></span>|<span data-ttu-id="e4bcc-211">Autoriser le changement<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e4bcc-211">Allow change<sup>1</sup></span></span>|<span data-ttu-id="e4bcc-212">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-212">Block change</span></span>|  
        |`filestream`|<span data-ttu-id="e4bcc-213">Autoriser la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-213">Allow change</span></span>|<span data-ttu-id="e4bcc-214">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-214">Block change</span></span>|<span data-ttu-id="e4bcc-215">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-215">Block change</span></span>|  
        |<span data-ttu-id="e4bcc-216">`date`, `time`, `datetime2` et `datetimeoffset`</span><span class="sxs-lookup"><span data-stu-id="e4bcc-216">`date`, `time`, `datetime2`, and `datetimeoffset`</span></span>|<span data-ttu-id="e4bcc-217">Autoriser la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-217">Allow change</span></span>|<span data-ttu-id="e4bcc-218">Autoriser le changement<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e4bcc-218">Allow change<sup>1</sup></span></span>|<span data-ttu-id="e4bcc-219">Bloquer la modification</span><span class="sxs-lookup"><span data-stu-id="e4bcc-219">Block change</span></span>|  
  
         <span data-ttu-id="e4bcc-220"><sup>1</sup> SQL Server Compact abonnés convertissent ces types de données sur l’abonné.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-220"><sup>1</sup> SQL Server Compact Subscribers convert these data types at the Subscriber.</span></span>  
  
-   <span data-ttu-id="e4bcc-221">Si une erreur se produit lors de l'application d'une modification de schéma (par exemple une erreur résultant de l'ajout d'une clé étrangère référençant une table non disponible sur l'Abonné), la synchronisation échoue et l'abonnement doit être réinitialisé.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-221">If an error occurs when applying a schema change (such as an error resulting from adding a foreign key that references a table not available at the Subscriber), synchronization fails and the subscription must be reinitialized.</span></span>  
  
-   <span data-ttu-id="e4bcc-222">Si une modification de schéma est apportée à une colonne reprise dans un filtre de jointure ou un filtre paramétré, vous devez réinitialiser tous les abonnements et régénérer l'instantané.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-222">If a schema change is made on a column involved in a join filter or parameterized filter, you must reinitialize all subscriptions and regenerate the snapshot.</span></span>  
  
-   <span data-ttu-id="e4bcc-223">La réplication de fusion fournit des procédures stockées qui permettent d'ignorer les modifications de schéma pendant le dépannage.</span><span class="sxs-lookup"><span data-stu-id="e4bcc-223">Merge replication provides stored procedures to skip schema changes during troubleshooting.</span></span> <span data-ttu-id="e4bcc-224">Pour plus d’informations, consultez [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) et [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="e4bcc-224">For more information, see [sp_markpendingschemachange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-markpendingschemachange-transact-sql) and [sp_enumeratependingschemachanges &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumeratependingschemachanges-transact-sql).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e4bcc-225">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e4bcc-225">See Also</span></span>  
 <span data-ttu-id="e4bcc-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-226">[ALTER TABLE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-table-transact-sql) </span></span>  
 <span data-ttu-id="e4bcc-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-227">[ALTER VIEW &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-view-transact-sql) </span></span>  
 <span data-ttu-id="e4bcc-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-228">[ALTER PROCEDURE &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-procedure-transact-sql) </span></span>  
 <span data-ttu-id="e4bcc-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-229">[ALTER FUNCTION &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-function-transact-sql) </span></span>  
 <span data-ttu-id="e4bcc-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-230">[ALTER TRIGGER &#40;Transact-SQL&#41;](/sql/t-sql/statements/alter-trigger-transact-sql) </span></span>  
 <span data-ttu-id="e4bcc-231">[Publier des données et des objets de base de données](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="e4bcc-231">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 [<span data-ttu-id="e4bcc-232">Régénérer des procédures transactionnelles personnalisées pour refléter des modifications de schéma</span><span class="sxs-lookup"><span data-stu-id="e4bcc-232">Regenerate Custom Transactional Procedures to Reflect Schema Changes</span></span>](../transactional/transactional-articles-regenerate-to-reflect-schema-changes.md)  
  
  
