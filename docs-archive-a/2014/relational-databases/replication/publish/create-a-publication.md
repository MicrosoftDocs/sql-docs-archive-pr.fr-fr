---
title: Créer une publication | Microsoft Docs
ms.custom: ''
ms.date: 06/30/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- publications [SQL Server replication], creating
- articles [SQL Server replication], defining
- adding articles
- articles [SQL Server replication], adding
ms.assetid: 52ee6de9-1d58-4cb9-8711-372bddbe7154
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 14d8b3f1a998b18ae0153c1771fa11afd925da9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87614516"
---
# <a name="create-a-publication"></a><span data-ttu-id="104a2-102">Créer une publication</span><span class="sxs-lookup"><span data-stu-id="104a2-102">Create a Publication</span></span>
  <span data-ttu-id="104a2-103">Cette rubrique explique comment créer une publication dans [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], de [!INCLUDE[tsql](../../../includes/tsql-md.md)]ou d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="104a2-103">This topic describes how to create a publication in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span>  
  
 <span data-ttu-id="104a2-104">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="104a2-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="104a2-105">**Avant de commencer :**</span><span class="sxs-lookup"><span data-stu-id="104a2-105">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="104a2-106">Limitations et restrictions</span><span class="sxs-lookup"><span data-stu-id="104a2-106">Limitations and Restrictions</span></span>](#Restrictions)  
  
     [<span data-ttu-id="104a2-107">Sécurité</span><span class="sxs-lookup"><span data-stu-id="104a2-107">Security</span></span>](#Security)  
  
-   <span data-ttu-id="104a2-108">**Pour créer une publication et définir des articles à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="104a2-108">**To create a publication and define articles, using:**</span></span>  
  
     [<span data-ttu-id="104a2-109">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="104a2-109">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="104a2-110">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="104a2-110">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="104a2-111">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="104a2-111">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="104a2-112">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="104a2-112">Before You Begin</span></span>  
  
###  <a name="limitations-and-restrictions"></a><a name="Restrictions"></a> <span data-ttu-id="104a2-113">Limitations et restrictions</span><span class="sxs-lookup"><span data-stu-id="104a2-113">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="104a2-114">Les noms de publications et d’articles ne peuvent pas contenir les caractères suivants : % , \* , [ , ] , | , : , " , ?</span><span class="sxs-lookup"><span data-stu-id="104a2-114">Publication and article names cannot include any of the following characters: % , \* , [ , ] , | , : , " , ?</span></span> <span data-ttu-id="104a2-115">, ' , \ , / , \< , >.</span><span class="sxs-lookup"><span data-stu-id="104a2-115">, ' , \ , / , \< , >.</span></span> <span data-ttu-id="104a2-116">Si les objets de la base de données contiennent un de ces caractères et que vous voulez les répliquer, vous devez spécifier un nom d’article différent du nom de l’objet dans la boîte de dialogue **Propriétés de l’article - \<Article>** , qui est disponible dans la page **Articles** de l’Assistant.</span><span class="sxs-lookup"><span data-stu-id="104a2-116">If objects in the database include any of these characters and you want to replicate them, you must specify an article name that is different from the object name in the **Article Properties - \<Article>** dialog box, which is available from the **Articles** page in the wizard.</span></span>  
  
###  <a name="security"></a><a name="Security"></a> <span data-ttu-id="104a2-117">Sécurité</span><span class="sxs-lookup"><span data-stu-id="104a2-117">Security</span></span>  
 <span data-ttu-id="104a2-118">Lorsque c'est possible, demande aux utilisateurs de fournir les informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="104a2-118">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="104a2-119">Si vous devez stocker des informations d'identification, utilisez les [Services de chiffrement](https://go.microsoft.com/fwlink/?LinkId=34733) fournis par [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="104a2-119">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="104a2-120">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="104a2-120">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="104a2-121">Créez des publication et définissez des articles avec l'Assistant Nouvelle publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-121">Create publications and define articles with the New Publication Wizard.</span></span> <span data-ttu-id="104a2-122">Après avoir créé une publication, affichez et modifiez les propriétés de publication dans la boîte de dialogue **Propriétés de la publication – \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="104a2-122">After a publication is created, view and modify publication properties in the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="104a2-123">Pour plus d’informations sur la création d’une publication à partir d’une base de données Oracle, consultez [Créer une publication à partir d’une base de données Oracle](create-a-publication-from-an-oracle-database.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-123">For information about creating a publication from an Oracle database, see [Create a Publication from an Oracle Database](create-a-publication-from-an-oracle-database.md).</span></span>  
  
#### <a name="to-create-a-publication-and-define-articles"></a><span data-ttu-id="104a2-124">Pour créer une publication et définir des articles</span><span class="sxs-lookup"><span data-stu-id="104a2-124">To create a publication and define articles</span></span>  
  
1.  <span data-ttu-id="104a2-125">Connectez-vous au serveur de publication dans [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="104a2-125">Connect to the Publisher in [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="104a2-126">Développez le dossier **Réplication** , puis cliquez avec le bouton droit sur le dossier **Publications locales** .</span><span class="sxs-lookup"><span data-stu-id="104a2-126">Expand the **Replication** folder, and then right-click the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="104a2-127">Cliquez sur **Nouvelle publication**.</span><span class="sxs-lookup"><span data-stu-id="104a2-127">Click **New Publication**.</span></span>  
  
4.  <span data-ttu-id="104a2-128">Exécutez les pages de l'Assistant Nouvelle publication pour.</span><span class="sxs-lookup"><span data-stu-id="104a2-128">Follow the pages in the New Publication Wizard to:</span></span>  
  
    -   <span data-ttu-id="104a2-129">Spécifier un serveur de distribution si la distribution n'a pas été configurée sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="104a2-129">Specify a Distributor if distribution has not been configured on the server.</span></span> <span data-ttu-id="104a2-130">Pour plus d’informations sur la configuration de la distribution, consultez [Configurer la publication et la distribution](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-130">For more information about configuring distribution, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
         <span data-ttu-id="104a2-131">Si vous spécifiez dans la page **Serveur de distribution** que le serveur de publication se comportera comme son propre serveur de distribution (serveur de distribution local), et si ce serveur n'est pas configuré comme serveur de distribution, l'Assistant Nouvelle publication configurera ce serveur.</span><span class="sxs-lookup"><span data-stu-id="104a2-131">If you specify on the **Distributor** page that the Publisher server will act as its own Distributor (a local Distributor), and the server is not configured as a Distributor, the New Publication Wizard will configure the server.</span></span> <span data-ttu-id="104a2-132">Vous spécifierez un dossier d'instantanés par défaut pour le serveur de distribution dans la page **Dossier d'instantanés** .</span><span class="sxs-lookup"><span data-stu-id="104a2-132">You will specify a default snapshot folder for the Distributor on the **Snapshot Folder** page.</span></span> <span data-ttu-id="104a2-133">Le dossier d'instantanés correspond à un simple répertoire que vous définissez sous la forme d'un partage ; les agents qui lisent et écrivent dans le dossier doivent disposer des autorisations suffisantes pour pouvoir y accéder.</span><span class="sxs-lookup"><span data-stu-id="104a2-133">The snapshot folder is simply a directory that you have designated as a share; agents that read from and write to this folder must have sufficient permissions to access it.</span></span> <span data-ttu-id="104a2-134">Pour plus d’informations sur une sécurisation appropriée du dossier, consultez [Sécuriser le dossier d’instantanés](../security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-134">For more information about securing the folder appropriately, see [Secure the Snapshot Folder](../security/secure-the-snapshot-folder.md).</span></span>  
  
         <span data-ttu-id="104a2-135">Si vous spécifiez qu'un autre serveur doit jouer le rôle de serveur de distribution, vous devez entrer un mot de passe dans la page **Mot de passe d'administration** pour les connexions effectuées du serveur de publication sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="104a2-135">If you specify that another server should act as the Distributor, you must enter a password on the **Administrative Password** page for connections made from the Publisher to the Distributor.</span></span> <span data-ttu-id="104a2-136">Ce mot de passe doit correspondre à celui qui a été spécifié lorsque le serveur de publication a été activé sur le serveur de distribution distant.</span><span class="sxs-lookup"><span data-stu-id="104a2-136">This password must match the password specified when the Publisher was enabled at the remote Distributor.</span></span>  
  
         <span data-ttu-id="104a2-137">Pour plus d'informations, voir [Configure Distribution](../configure-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-137">For more information, see [Configure Distribution](../configure-distribution.md).</span></span>  
  
    -   <span data-ttu-id="104a2-138">Choisissez une base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-138">Choose a publication database.</span></span>  
  
    -   <span data-ttu-id="104a2-139">Sélectionnez un type de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-139">Select a publication type.</span></span> <span data-ttu-id="104a2-140">Pour plus d’informations, consultez [Types de réplication](../types-of-replication.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-140">For more information, see [Types of Replication](../types-of-replication.md).</span></span>  
  
    -   <span data-ttu-id="104a2-141">Spécifiez les données et les objets de base de données à publier ; en option, filtrez les colonnes des articles des tables, et définissez des propriétés d'articles.</span><span class="sxs-lookup"><span data-stu-id="104a2-141">Specify data and database objects to publish; optionally filter columns from table articles, and set article properties.</span></span>  
  
    -   <span data-ttu-id="104a2-142">En option, filtrez les lignes des articles des tables.</span><span class="sxs-lookup"><span data-stu-id="104a2-142">Optionally filter rows from table articles.</span></span> <span data-ttu-id="104a2-143">Pour plus d’informations, consultez [Filtrer des données publiées](filter-published-data.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-143">For more information, see [Filter Published Data](filter-published-data.md).</span></span>  
  
    -   <span data-ttu-id="104a2-144">Définissez la planification de l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="104a2-144">Set the Snapshot Agent schedule.</span></span>  
  
    -   <span data-ttu-id="104a2-145">Spécifiez les informations de connexion sous lesquelles les Agents de réplication suivants s'exécuteront et se connecteront :</span><span class="sxs-lookup"><span data-stu-id="104a2-145">Specify the credentials under which the following replication agents run and make connections:</span></span>  
  
         <span data-ttu-id="104a2-146">\- Agent d’instantané pour toutes les publications.</span><span class="sxs-lookup"><span data-stu-id="104a2-146">\- Snapshot Agent for all publications.</span></span>  
  
         <span data-ttu-id="104a2-147">\- Agent de lecture du journal pour toutes les publications transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="104a2-147">\- Log Reader Agent for all transactional publications.</span></span>  
  
         <span data-ttu-id="104a2-148">\- Agent de lecture de la file d’attente pour les publications transactionnelles acceptant les abonnements avec mise à jour.</span><span class="sxs-lookup"><span data-stu-id="104a2-148">\- Queue Reader Agent for transactional publications that allow updating subscriptions.</span></span>  
  
         <span data-ttu-id="104a2-149">Pour plus d'informations, consultez [Replication Agent Security Model](../security/replication-agent-security-model.md) et [Replication Security Best Practices](../security/replication-security-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-149">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md) and [Replication Security Best Practices](../security/replication-security-best-practices.md).</span></span>  
  
    -   <span data-ttu-id="104a2-150">En option, scriptez la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-150">Optionally script the publication.</span></span> <span data-ttu-id="104a2-151">Pour plus d'informations, voir [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-151">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
    -   <span data-ttu-id="104a2-152">Spécifiez le nom de la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-152">Specify a name for the publication.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="104a2-153">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="104a2-153">Using Transact-SQL</span></span>  
 <span data-ttu-id="104a2-154">Il est possible de créer des publications par programme en utilisant les procédures stockées de réplication.</span><span class="sxs-lookup"><span data-stu-id="104a2-154">Publications can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="104a2-155">Les procédures stockées à utiliser dépendent du type de publication à créer.</span><span class="sxs-lookup"><span data-stu-id="104a2-155">The stored procedures that are used will depend on the type of publication being created.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="104a2-156">Pour créer une publication d'instantané ou une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="104a2-156">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="104a2-157">Dans la base de données de publication sur le serveur de publication, exécutez [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) pour activer la publication de la base de données actuelle à l’aide de la réplication transactionnelle ou d’instantané.</span><span class="sxs-lookup"><span data-stu-id="104a2-157">At the Publisher on the publication database, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using snapshot or transactional replication.</span></span>  
  
2.  <span data-ttu-id="104a2-158">Pour une publication transactionnelle, déterminez si un travail de l'Agent de lecture du journal existe pour la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-158">For a transactional publication, determine whether a Log Reader Agent job exists for the publication database.</span></span> <span data-ttu-id="104a2-159">(Cette étape n'est pas requise pour les publications d'instantané.)</span><span class="sxs-lookup"><span data-stu-id="104a2-159">(This step is not required for snapshot publications.)</span></span>  
  
    -   <span data-ttu-id="104a2-160">Si un travail de l'Agent de lecture du journal existe pour la base de données de publication, passez à l'étape 3.</span><span class="sxs-lookup"><span data-stu-id="104a2-160">If a Log Reader Agent job exists for the publication database, proceed to step 3.</span></span>  
  
    -   <span data-ttu-id="104a2-161">Si vous ne savez pas si un travail de l’Agent de lecture du journal existe pour une base de données publiée, exécutez [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) au niveau du serveur de publication dans la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-161">If you are unsure whether a Log Reader Agent job exists for a published database, execute [sp_helplogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helplogreader-agent-transact-sql) at the Publisher on the publication database.</span></span>  
  
    -   <span data-ttu-id="104a2-162">Si le jeu de résultats est vide, créez un travail de l'Agent de lecture du journal.</span><span class="sxs-lookup"><span data-stu-id="104a2-162">If the result set is empty, create a Log Reader Agent job.</span></span> <span data-ttu-id="104a2-163">Sur le serveur de publication, exécutez [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="104a2-163">At the Publisher, execute [sp_addlogreader_agent &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlogreader-agent-transact-sql).</span></span> <span data-ttu-id="104a2-164">Indiquez les informations d’identification Windows [!INCLUDE[msCoName](../../../includes/msconame-md.md)] sous lesquelles l’agent s’exécute pour **\@job_login** et **\@job_password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-164">Specify the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows credentials under which the agent runs for **\@job_name** and **\@password**.</span></span> <span data-ttu-id="104a2-165">Si l’agent doit utiliser l’authentification SQL Server lors de la connexion au serveur de publication, vous devez également affecter la valeur **0** à **\@publisher_security_mode** et spécifier les informations de connexion [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **\@publisher_login** et **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-165">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="104a2-166">Passez à l'étape 3.</span><span class="sxs-lookup"><span data-stu-id="104a2-166">Proceed to step 3.</span></span>  
  
3.  <span data-ttu-id="104a2-167">Sur le serveur de publication, exécutez [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="104a2-167">At the Publisher, execute [sp_addpublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-transact-sql).</span></span> <span data-ttu-id="104a2-168">Spécifiez un nom de publication pour la \*\* \@ publication**, et, pour le paramètre \*\* \@ repl_freq** , spécifiez la valeur `snapshot` pour une publication d’instantané ou la valeur `continuous` pour une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="104a2-168">Specify a publication name for **\@publication**, and, for the **\@repl_freq** parameter, specify a value of `snapshot` for a snapshot publication or a value of `continuous` for a transactional publication.</span></span> <span data-ttu-id="104a2-169">Spécifiez d'autres options de publication éventuelles.</span><span class="sxs-lookup"><span data-stu-id="104a2-169">Specify any other publication options.</span></span> <span data-ttu-id="104a2-170">Cela définit la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-170">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="104a2-171">Un nom de publication ne doit pas contenir les caractères suivants :</span><span class="sxs-lookup"><span data-stu-id="104a2-171">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="104a2-172">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="104a2-172">% \* [ ] | : " ?</span></span> <span data-ttu-id="104a2-173">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="104a2-173">\ / \< ></span></span>  
  
4.  <span data-ttu-id="104a2-174">Sur le serveur de publication, exécutez [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="104a2-174">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="104a2-175">Spécifiez le nom de publication utilisé à l’étape 3 pour **\@publication** et les informations d’identification Windows sous lesquelles l’Agent d’instantané s’exécute pour **\@snapshot_job_name** et **\@password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-175">Specify the publication name used in step 3 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="104a2-176">Si l’agent doit utiliser l’authentification SQL Server lors de la connexion au serveur de publication, vous devez également affecter la valeur **0** à **\@publisher_security_mode** et spécifier les informations de connexion [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **\@publisher_login** et **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-176">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="104a2-177">Il s'ensuit la création d'un travail de l'Agent d'instantané pour la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-177">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="104a2-178">Lors de la configuration d'un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour tous les paramètres, y compris *job_login* et *job_password*, sont envoyées en texte brut au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="104a2-178">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="104a2-179">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'exécuter cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="104a2-179">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="104a2-180">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-180">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
5.  <span data-ttu-id="104a2-181">Ajoutez des articles à la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-181">Add articles to the publication.</span></span> <span data-ttu-id="104a2-182">Pour plus d’informations, consultez [définir un Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-182">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
6.  <span data-ttu-id="104a2-183">Démarrez le travail de l'Agent d'instantané pour générer l'instantané initial pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-183">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="104a2-184">Pour plus d’informations, voir [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-184">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="104a2-185">Pour créer une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="104a2-185">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="104a2-186">Sur le serveur de publication, exécutez [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) pour activer la publication de la base de données actuelle à l’aide de la réplication de fusion.</span><span class="sxs-lookup"><span data-stu-id="104a2-186">At the Publisher, execute [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql) to enable publication of the current database using merge replication.</span></span>  
  
2.  <span data-ttu-id="104a2-187">Dans la base de données de publication sur le serveur de publication, exécutez [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="104a2-187">At the Publisher on the publication database, execute [sp_addmergepublication &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql).</span></span> <span data-ttu-id="104a2-188">Spécifiez le nom de la publication pour **\@publication** et d’autres options de publication éventuelles.</span><span class="sxs-lookup"><span data-stu-id="104a2-188">Specify a name for the publication for **\@publication** and any other publication options.</span></span> <span data-ttu-id="104a2-189">Cela définit la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-189">This defines the publication.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="104a2-190">Un nom de publication ne doit pas contenir les caractères suivants :</span><span class="sxs-lookup"><span data-stu-id="104a2-190">Publication names cannot include the following characters:</span></span>  
    >   
    >  <span data-ttu-id="104a2-191">% \* [ ] | : " ?</span><span class="sxs-lookup"><span data-stu-id="104a2-191">% \* [ ] | : " ?</span></span> <span data-ttu-id="104a2-192">\ / \< ></span><span class="sxs-lookup"><span data-stu-id="104a2-192">\ / \< ></span></span>  
  
3.  <span data-ttu-id="104a2-193">Sur le serveur de publication, exécutez [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="104a2-193">At the Publisher, execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="104a2-194">Spécifiez le nom de publication utilisé à l’étape 2 pour **\@publication** et les informations d’identification Windows sous lesquelles l’Agent d’instantané s’exécute pour **\@snapshot_job_name** et **\@password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-194">Specify the publication name used in step 2 for **\@publication** and the Windows credentials under which the Snapshot Agent runs for **\@snapshot_job_name** and **\@password**.</span></span> <span data-ttu-id="104a2-195">Si l’agent doit utiliser l’authentification SQL Server lors de la connexion au serveur de publication, vous devez également affecter la valeur **0** à **\@publisher_security_mode** et spécifier les informations de connexion [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour **\@publisher_login** et **\@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="104a2-195">If the agent will use SQL Server Authentication when connecting to the Publisher, you must also specify a value of **0** for **\@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] login information for **\@publisher_login** and **\@publisher_password**.</span></span> <span data-ttu-id="104a2-196">Il s'ensuit la création d'un travail de l'Agent d'instantané pour la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-196">This creates a Snapshot Agent job for the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="104a2-197">Lors de la configuration d'un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour tous les paramètres, y compris *job_login* et *job_password*, sont envoyées en texte brut au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="104a2-197">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="104a2-198">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'exécuter cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="104a2-198">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="104a2-199">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-199">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
4.  <span data-ttu-id="104a2-200">Ajoutez des articles à la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-200">Add articles to the publication.</span></span> <span data-ttu-id="104a2-201">Pour plus d’informations, consultez [définir un Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-201">For more information, see [Define an Article](define-an-article.md).</span></span>  
  
5.  <span data-ttu-id="104a2-202">Démarrez le travail de l'Agent d'instantané pour générer l'instantané initial pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-202">Start the Snapshot Agent job to generate the initial snapshot for this publication.</span></span> <span data-ttu-id="104a2-203">Pour plus d’informations, voir [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-203">For more information, see [Create and Apply the Initial Snapshot](../create-and-apply-the-initial-snapshot.md).</span></span>  
  
###  <a name="example-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="104a2-204">Exemple (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="104a2-204">Example (Transact-SQL)</span></span>  
 <span data-ttu-id="104a2-205">Cet exemple crée une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="104a2-205">This example creates a transactional publication.</span></span> <span data-ttu-id="104a2-206">Des variables de script sont utilisées pour transmettre les informations d'identification Windows nécessaires pour créer les travaux pour l'Agent d'instantané et l'Agent de lecture du journal.</span><span class="sxs-lookup"><span data-stu-id="104a2-206">Scripting variables are used to pass Windows credentials that are needed to create jobs for the Snapshot Agent and Log Reader Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddTranPub](../../../snippets/tsql/SQL15/replication/howto/tsql/createtranpub.sql#sp_addtranpub)]  
  
 <span data-ttu-id="104a2-207">Cet exemple crée une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="104a2-207">This example creates a merge publication.</span></span> <span data-ttu-id="104a2-208">Des variables de script sont utilisées pour transmettre les informations d'identification Windows nécessaires pour créer le travail pour l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="104a2-208">Scripting variables are used to pass Windows credentials that are needed to create the job for the Snapshot Agent.</span></span>  
  
 [!code-sql[HowTo#sp_AddMergePub](../../../snippets/tsql/SQL15/replication/howto/tsql/createmergepub.sql#sp_addmergepub)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="104a2-209">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="104a2-209">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="104a2-210">Vous pouvez créer des publications par programme à l'aide d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="104a2-210">You can create publications programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="104a2-211">Les classes RMO que vous utilisez pour créer une publication dépendent du type de publication créé.</span><span class="sxs-lookup"><span data-stu-id="104a2-211">The RMO classes that you use to create a publication depend on the type of publication you create.</span></span>  
  
#### <a name="to-create-a-snapshot-or-transactional-publication"></a><span data-ttu-id="104a2-212">Pour créer une publication d'instantané ou une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="104a2-212">To create a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="104a2-213">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="104a2-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="104a2-214">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> pour la base de données de publication, affectez à la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> l'instance de <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée à l'étape 1, puis appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="104a2-215">Si <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> retourne `false`, vérifiez que la base de données existe.</span><span class="sxs-lookup"><span data-stu-id="104a2-215">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="104a2-216">Si la <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> propriété a la `false` valeur, affectez-lui la valeur `true` .</span><span class="sxs-lookup"><span data-stu-id="104a2-216">If the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledTransPublishing%2A> property is `false`, set it to `true`.</span></span>  
  
4.  <span data-ttu-id="104a2-217">Pour une publication transactionnelle, vérifiez la valeur de la propriété <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-217">For a transactional publication, check the value of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentExists%2A> property.</span></span> <span data-ttu-id="104a2-218">Si elle a la valeur `true`, un travail de l'Agent de lecture du journal existe déjà pour cette base de données.</span><span class="sxs-lookup"><span data-stu-id="104a2-218">If this property is `true`, a Log Read Agent job already exists for this database.</span></span> <span data-ttu-id="104a2-219">Si elle a la valeur `false`, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="104a2-219">If this property is `false`, do the following:</span></span>  
  
    -   <span data-ttu-id="104a2-220">Définissez les champs <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> et <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> afin de fournir les informations d'identification pour le compte [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows sous lequel l'Agent de lecture du journal s'exécute.</span><span class="sxs-lookup"><span data-stu-id="104a2-220">Set the <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Windows account under which the Log Reader Agent runs.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="104a2-221">Il n'est pas nécessaire de définir <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> lorsque la publication est créée par un membre du rôle serveur fixe `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="104a2-221">Setting <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="104a2-222">Dans ce cas, l'Agent va emprunter l'identité du compte de l'Agent SQL Server.</span><span class="sxs-lookup"><span data-stu-id="104a2-222">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="104a2-223">Pour plus d’informations, voir [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-223">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="104a2-224">(Facultatif) Définissez les champs <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> et <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> lorsque vous utilisez l'authentification SQL Server pour vous connecter au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-224">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.LogReaderAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="104a2-225">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> pour créer le travail de l'Agent de lecture du journal pour la base de données.</span><span class="sxs-lookup"><span data-stu-id="104a2-225">Call the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.CreateLogReaderAgent%2A> method to create the Log Reader Agent job for the database.</span></span>  
  
5.  <span data-ttu-id="104a2-226">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransPublication> et définissez les propriétés suivantes pour cet objet :</span><span class="sxs-lookup"><span data-stu-id="104a2-226">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="104a2-227">La classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée à l'étape 1 pour la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-227">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-228">Le nom de la base de données publiée pour <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-228">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-229">Le nom de la publication pour <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-229">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-230"><xref:Microsoft.SqlServer.Replication.PublicationType> ayant pour valeur <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> ou <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span><span class="sxs-lookup"><span data-stu-id="104a2-230">A <xref:Microsoft.SqlServer.Replication.PublicationType> of either <xref:Microsoft.SqlServer.Replication.PublicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.PublicationType.Snapshot>.</span></span>  
  
    -   <span data-ttu-id="104a2-231">Les champs <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> et <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> pour fournir les informations d'identification pour le compte Windows sous lequel le travail de l'Agent d'instantané s'exécute.</span><span class="sxs-lookup"><span data-stu-id="104a2-231">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="104a2-232">Ce compte est également utilisé lorsque l'Agent d'instantané établit des connexions au serveur de distribution local et pour toute connexion distante lors de l'utilisation de l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="104a2-232">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="104a2-233">Il n'est pas nécessaire de définir <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> lorsque la publication est créée par un membre du rôle serveur fixe `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="104a2-233">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="104a2-234">Dans ce cas, l'Agent va emprunter l'identité du compte de l'Agent SQL Server.</span><span class="sxs-lookup"><span data-stu-id="104a2-234">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="104a2-235">Pour plus d’informations, voir [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-235">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="104a2-236">(Facultatif) Les champs <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> et <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> lorsque vous utilisez l'authentification SQL Server pour vous connecter au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-236">(Optional) The <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentPublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
    -   <span data-ttu-id="104a2-237">(Facultatif) Utilisez l'opérateur OR logique inclusif (`|` en Visual C# et `Or` en Visual Basic) et l'opérateur OR logique exclusif (`^` en Visual C# et `Xor` en Visual Basic) pour définir les valeurs <xref:Microsoft.SqlServer.Replication.PublicationAttributes> de la propriété <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-237">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
    -   <span data-ttu-id="104a2-238">(Facultatif) Nom du serveur de publication pour <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> lorsqu'il s'agit d'un serveur non-SQL Server.</span><span class="sxs-lookup"><span data-stu-id="104a2-238">(Optional) The name of the Publisher for <xref:Microsoft.SqlServer.Replication.TransPublication.PublisherName%2A> when the Publisher is a non-SQL Server Publisher.</span></span>  
  
6.  <span data-ttu-id="104a2-239">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> pour créer la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-239">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="104a2-240">Lors de la configuration d'un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour toutes les propriétés, y compris <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, sont envoyées sous forme de texte brut au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="104a2-240">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="104a2-241">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'appeler la méthode <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-241">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="104a2-242">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-242">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
7.  <span data-ttu-id="104a2-243">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> pour créer le travail de l'Agent d'instantané pour le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-243">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
#### <a name="to-create-a-merge-publication"></a><span data-ttu-id="104a2-244">Pour créer une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="104a2-244">To create a merge publication</span></span>  
  
1.  <span data-ttu-id="104a2-245">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="104a2-245">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="104a2-246">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> pour la base de données de publication, affectez à la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> l'instance de <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée à l'étape 1, puis appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-246">Create an instance of the <xref:Microsoft.SqlServer.Replication.ReplicationDatabase> class for the publication database, set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the instance of <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1, and call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="104a2-247">Si <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> retourne `false`, vérifiez que la base de données existe.</span><span class="sxs-lookup"><span data-stu-id="104a2-247">If <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> returns `false`, verify that the database exists.</span></span>  
  
3.  <span data-ttu-id="104a2-248">Si la <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> propriété a la `false` valeur, affectez-lui la valeur `true` et appelez <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-248">If <xref:Microsoft.SqlServer.Replication.ReplicationDatabase.EnabledMergePublishing%2A> Property is `false`, set it to `true`, and call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A>.</span></span>  
  
4.  <span data-ttu-id="104a2-249">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePublication> et définissez les propriétés suivantes pour cet objet :</span><span class="sxs-lookup"><span data-stu-id="104a2-249">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class, and set the following properties for this object:</span></span>  
  
    -   <span data-ttu-id="104a2-250">La classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée à l'étape 1 pour la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-250">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> from step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-251">Le nom de la base de données publiée pour <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-251">The name of the published database for <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-252">Le nom de la publication pour <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-252">A name for the publication for <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>.</span></span>  
  
    -   <span data-ttu-id="104a2-253">Les champs <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> et <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> de <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> pour fournir les informations d'identification pour le compte Windows sous lequel le travail de l'Agent d'instantané s'exécute.</span><span class="sxs-lookup"><span data-stu-id="104a2-253">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> fields of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> to provide the credentials for the Windows account under which the Snapshot Agent runs.</span></span> <span data-ttu-id="104a2-254">Ce compte est également utilisé lorsque l'Agent d'instantané établit des connexions au serveur de distribution local et pour toute connexion distante lors de l'utilisation de l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="104a2-254">This account is also used when the Snapshot Agent makes connections to the local Distributor and for any remote connections when using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="104a2-255">Il n'est pas nécessaire de définir <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> lorsque la publication est créée par un membre du rôle serveur fixe `sysadmin`.</span><span class="sxs-lookup"><span data-stu-id="104a2-255">Setting <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A> is not required when the publication is created by a member of the `sysadmin` fixed server role.</span></span> <span data-ttu-id="104a2-256">Pour plus d’informations, voir [Replication Agent Security Model](../security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-256">For more information, see [Replication Agent Security Model](../security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="104a2-257">(Facultatif) Utilisez l'opérateur OR logique inclusif (`|` en Visual C# et `Or` en Visual Basic) et l'opérateur OR logique exclusif (`^` en Visual C# et `Xor` en Visual Basic) pour définir les valeurs <xref:Microsoft.SqlServer.Replication.PublicationAttributes> de la propriété <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>.</span><span class="sxs-lookup"><span data-stu-id="104a2-257">(Optional) Use the inclusive logical OR operator (`|` in Visual C# and `Or` in Visual Basic) and the exclusive logical OR operator (`^` in Visual C# and `Xor` in Visual Basic) to set the <xref:Microsoft.SqlServer.Replication.PublicationAttributes> values for the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property.</span></span>  
  
5.  <span data-ttu-id="104a2-258">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> pour créer la publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-258">Call the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method to create the publication.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="104a2-259">Lors de la configuration d'un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour toutes les propriétés, y compris <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, sont envoyées sous forme de texte brut au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="104a2-259">When configuring a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Publication.SnapshotGenerationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="104a2-260">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'appeler la méthode <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="104a2-260">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Publication.Create%2A> method.</span></span> <span data-ttu-id="104a2-261">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-261">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
6.  <span data-ttu-id="104a2-262">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> pour créer le travail de l'Agent d'instantané pour le serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-262">Call the <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> method to create the Snapshot Agent job for the publication.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="104a2-263">Exemples (RMO)</span><span class="sxs-lookup"><span data-stu-id="104a2-263">Examples (RMO)</span></span>  
 <span data-ttu-id="104a2-264">Cet exemple active la base de données AdventureWorks pour une publication transactionnelle, définit un travail de l'Agent de lecture du journal et crée la publication AdvWorksProductTran.</span><span class="sxs-lookup"><span data-stu-id="104a2-264">This example enables the AdventureWorks database for transactional publishing, defines a Log Reader Agent job, and creates the AdvWorksProductTran publication.</span></span> <span data-ttu-id="104a2-265">Un article doit être défini pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-265">An article must be defined for this publication.</span></span> <span data-ttu-id="104a2-266">Les informations d'identification du compte Windows nécessaires pour créer le travail de l'Agent de lecture du journal et de l'Agent d'instantané sont passées au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="104a2-266">The Windows account credentials that are needed to create the Log Reader Agent job and the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="104a2-267">Pour savoir comment utiliser des objets RMO pour définir des articles d'instantané et des articles transactionnels, consultez [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-267">To learn how to use RMO to define snapshot and transactional articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpub)]  
  
 <span data-ttu-id="104a2-268">Cet exemple active la base de données AdventureWorks pour la publication de fusion et crée la publication AdvWorksSalesOrdersMerge.</span><span class="sxs-lookup"><span data-stu-id="104a2-268">This example enables the AdventureWorks database for merge publishing and creates the AdvWorksSalesOrdersMerge publication.</span></span> <span data-ttu-id="104a2-269">Des articles doivent encore être définis pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="104a2-269">Articles must still be defined for this publication.</span></span> <span data-ttu-id="104a2-270">Les informations d'identification du compte Windows nécessaires pour créer le travail de l'Agent d'instantané sont passées au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="104a2-270">The Windows account credentials that are needed to create the Snapshot Agent job are passed at runtime.</span></span> <span data-ttu-id="104a2-271">Pour savoir comment utiliser des objets RMO pour définir des articles de fusion, consultez [Define an Article](define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="104a2-271">To learn how to use RMO to define merge articles, see [Define an Article](define-an-article.md).</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePub](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePub](../../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepub)]  
  
## <a name="see-also"></a><span data-ttu-id="104a2-272">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="104a2-272">See Also</span></span>  
 <span data-ttu-id="104a2-273">[Utiliser sqlcmd avec des variables de script](../../scripting/sqlcmd-use-with-scripting-variables.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-273">[Use sqlcmd with Scripting Variables](../../scripting/sqlcmd-use-with-scripting-variables.md) </span></span>  
 <span data-ttu-id="104a2-274">[Publier des données et des objets de base de données](publish-data-and-database-objects.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-274">[Publish Data and Database Objects](publish-data-and-database-objects.md) </span></span>  
 <span data-ttu-id="104a2-275">[Concepts liés à RMO (Replication Management Objects)](../concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-275">[Replication Management Objects Concepts](../concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="104a2-276">[Define an Article](define-an-article.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-276">[Define an Article](define-an-article.md) </span></span>  
 <span data-ttu-id="104a2-277">[Afficher et modifier les propriétés d’une publication](view-and-modify-publication-properties.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-277">[View and Modify Publication Properties](view-and-modify-publication-properties.md) </span></span>  
 <span data-ttu-id="104a2-278">[Configurer la distribution](../configure-distribution.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-278">[Configure Distribution](../configure-distribution.md) </span></span>  
 <span data-ttu-id="104a2-279">[Protéger le serveur de distribution](../security/secure-the-distributor.md) </span><span class="sxs-lookup"><span data-stu-id="104a2-279">[Secure the Distributor](../security/secure-the-distributor.md) </span></span>  
 [<span data-ttu-id="104a2-280">Sécuriser le serveur de publication</span><span class="sxs-lookup"><span data-stu-id="104a2-280">Secure the Publisher</span></span>](../security/secure-the-publisher.md)  
  
  
