---
title: Gérer les partitions d’une publication de fusion avec des filtres paramétrables | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- partitions [SQL Server replication]
- merge replication partitions [SQL Server replication], SQL Server Management Studio
- parameterized filters [SQL Server replication], partition management
ms.assetid: fb5566fe-58c5-48f7-8464-814ea78e6221
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 983b02865c0564919259f896bf09d8bdb0cd969f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600784"
---
# <a name="manage-partitions-for-a-merge-publication-with-parameterized-filters"></a><span data-ttu-id="3912e-102">Gérer les partitions d'une publication de fusion avec des filtres paramétrables</span><span class="sxs-lookup"><span data-stu-id="3912e-102">Manage Partitions for a Merge Publication with Parameterized Filters</span></span>
  <span data-ttu-id="3912e-103">Cette rubrique explique comment gérer des partitions pour une publication de fusion avec des filtres paramétrables dans [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], de [!INCLUDE[tsql](../../../includes/tsql-md.md)]ou d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="3912e-103">This topic describes how to manage partitions for a merge publication with parameterized filters in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="3912e-104">Les filtres de lignes paramétrables peuvent être utilisés pour générer des partitions qui ne se chevauchent pas.</span><span class="sxs-lookup"><span data-stu-id="3912e-104">Parameterized row filters can be used to generate nonoverlapping partitions.</span></span> <span data-ttu-id="3912e-105">Ces partitions peuvent être restreintes afin qu'un seul abonnement puisse recevoir une partition donnée.</span><span class="sxs-lookup"><span data-stu-id="3912e-105">These partitions can be restricted so that only one subscription receives a given partition.</span></span> <span data-ttu-id="3912e-106">Dans ces cas, un grand nombre d'abonnés se traduit par un nombre élevé de partitions, ce qui requiert ensuite un nombre égal d'instantanés partitionnés.</span><span class="sxs-lookup"><span data-stu-id="3912e-106">In these cases, a large number of subscribers will result in a large number of partitions, which in turn requires an equal number of partitioned snapshots.</span></span> <span data-ttu-id="3912e-107">Pour plus d'informations, voir [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-107">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span>  
  
 <span data-ttu-id="3912e-108">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="3912e-108">**In This Topic**</span></span>  
  
-   <span data-ttu-id="3912e-109">**Avant de commencer :**</span><span class="sxs-lookup"><span data-stu-id="3912e-109">**Before you begin:**</span></span>  
  
     [<span data-ttu-id="3912e-110">Recommandations</span><span class="sxs-lookup"><span data-stu-id="3912e-110">Recommendations</span></span>](#Recommendations)  
  
-   <span data-ttu-id="3912e-111">**Pour gérer les partitions d'une publication de fusion avec les filtres paramétrables à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="3912e-111">**To manage partitions for a merge publication with parameterized filters, using:**</span></span>  
  
     [<span data-ttu-id="3912e-112">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="3912e-112">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="3912e-113">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3912e-113">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="3912e-114">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="3912e-114">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="before-you-begin"></a><a name="BeforeYouBegin"></a> <span data-ttu-id="3912e-115">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="3912e-115">Before You Begin</span></span>  
  
###  <a name="recommendations"></a><a name="Recommendations"></a> <span data-ttu-id="3912e-116">Recommandations</span><span class="sxs-lookup"><span data-stu-id="3912e-116">Recommendations</span></span>  
  
-   <span data-ttu-id="3912e-117">Si vous créez un script de la topologie de réplication (ce qui est recommandé), les scripts de publication contiennent les appels de procédures stockées pour créer des partitions de données.</span><span class="sxs-lookup"><span data-stu-id="3912e-117">If you script a replication topology, which is recommended, publication scripts contain the stored procedure calls to create data partitions.</span></span> <span data-ttu-id="3912e-118">Le script fournit une référence pour les partitions créées et un moyen permettant de recréer si nécessaire une ou plusieurs partitions.</span><span class="sxs-lookup"><span data-stu-id="3912e-118">The script provides a reference for the partitions created and a way in which to re-create one or more partitions if necessary.</span></span> <span data-ttu-id="3912e-119">Pour plus d'informations, voir [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-119">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
-   <span data-ttu-id="3912e-120">Lorsqu'une publication a paramétré des filtres qui génèrent des abonnements avec des partitions ne se chevauchant pas, et si un abonnement particulier est perdu et doit être recréé, vous devez effectuer les opérations suivantes : supprimez la partition à laquelle s'abonner, recréez l'abonnement, puis recréez la partition.</span><span class="sxs-lookup"><span data-stu-id="3912e-120">When a publication has parameterized filters that yield subscriptions with nonoverlapping partitions, and if a particular subscription is lost and needs to be re-created, you must do the following: remove the partition that was subscribed to, re-create the subscription, and then re-create the partition.</span></span> <span data-ttu-id="3912e-121">Pour plus d'informations, voir [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-121">For more information, see [Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md).</span></span> <span data-ttu-id="3912e-122">La réplication génère des scripts de création pour les partitions d'Abonné existantes lors de la génération d'un script de création de publication.</span><span class="sxs-lookup"><span data-stu-id="3912e-122">Replication generates creation scripts for existing Subscriber partitions when a publication creation script is generated.</span></span> <span data-ttu-id="3912e-123">Pour plus d'informations, voir [Scripting Replication](../scripting-replication.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-123">For more information, see [Scripting Replication](../scripting-replication.md).</span></span>  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="3912e-124">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="3912e-124">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="3912e-125">Gérez des partitions dans la page **Partitions de données** de la boîte de dialogue **Propriétés de la publication - \<Publication>** .</span><span class="sxs-lookup"><span data-stu-id="3912e-125">Manage partitions on the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box.</span></span> <span data-ttu-id="3912e-126">Pour plus d'informations sur l'accès à cette boîte de dialogue, consultez [Afficher et modifier les propriétés d’un serveur de publication](view-and-modify-publication-properties.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-126">For more information about accessing this dialog box, see [View and Modify Publication Properties](view-and-modify-publication-properties.md).</span></span> <span data-ttu-id="3912e-127">Sur cette page, vous pouvez : créer et supprimer des partitions, autoriser des Abonnés à initier la génération et la remise d'instantanés, générer des instantanés pour une ou plusieurs partitions et nettoyer des instantanés.</span><span class="sxs-lookup"><span data-stu-id="3912e-127">On this page you can: create and delete partitions; allow Subscribers to initiate snapshot generation and delivery; generate snapshots for one or more partitions; and clean up snapshots.</span></span>  
  
#### <a name="to-create-a-partition"></a><span data-ttu-id="3912e-128">Pour créer une partition</span><span class="sxs-lookup"><span data-stu-id="3912e-128">To create a partition</span></span>  
  
1.  <span data-ttu-id="3912e-129">Dans la page **Partitions de données** de la boîte de dialogue **Propriétés de la publication - \<Publication>** , cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="3912e-129">On the **Data Partitions** page of the **Publication Properties - \<Publication>** dialog box, click **Add**.</span></span>  
  
2.  <span data-ttu-id="3912e-130">Dans la boîte de dialogue **Ajouter une partition de données** , entrez une valeur pour la valeur **HOST_NAME()** et/ou **SUSER_SNAME()** associée à la valeur que vous voulez créer.</span><span class="sxs-lookup"><span data-stu-id="3912e-130">In the **Add Data Partition** dialog box, enter a value for the **HOST_NAME()** and/or **SUSER_SNAME()** value associated with the partition you want to create.</span></span>  
  
3.  <span data-ttu-id="3912e-131">En option, spécifiez une planification pour l'actualisation des instantanés :</span><span class="sxs-lookup"><span data-stu-id="3912e-131">Optionally specify a schedule for refreshing snapshots:</span></span>  
  
    1.  <span data-ttu-id="3912e-132">Sélectionnez **Planifier l'Agent d'instantané pour l'exécution de cette partition à l'heure ou aux heures suivantes**.</span><span class="sxs-lookup"><span data-stu-id="3912e-132">Select **Schedule the Snapshot Agent for this partition to run at the following time(s)**</span></span>  
  
    2.  <span data-ttu-id="3912e-133">Acceptez la planification par défaut pour l'actualisation des instantanés, ou cliquez sur **Modifier** pour spécifier une autre planification.</span><span class="sxs-lookup"><span data-stu-id="3912e-133">Accept the default schedule for refreshing snapshots, or click **Change** to specify a different schedule.</span></span>  
  
4.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="3912e-134">Pour supprimer une partition</span><span class="sxs-lookup"><span data-stu-id="3912e-134">To delete a partition</span></span>  
  
1.  <span data-ttu-id="3912e-135">Sur la page **Partitions de données** , sélectionnez une partition dans la grille.</span><span class="sxs-lookup"><span data-stu-id="3912e-135">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="3912e-136">Cliquez sur **Supprimer**.</span><span class="sxs-lookup"><span data-stu-id="3912e-136">Click **Delete**.</span></span>  
  
#### <a name="to-allow-subscribers-to-initiate-snapshot-generation-and-delivery"></a><span data-ttu-id="3912e-137">Pour permettre aux Abonnés d'initier la génération et la remise d'instantanés</span><span class="sxs-lookup"><span data-stu-id="3912e-137">To allow Subscribers to initiate snapshot generation and delivery</span></span>  
  
1.  <span data-ttu-id="3912e-138">Sur la page **Partitions de données** , sélectionnez **Définir automatiquement une partition et générer un instantané si nécessaire lorsqu'un nouvel abonné essaie de se synchroniser**.</span><span class="sxs-lookup"><span data-stu-id="3912e-138">On the **Data Partitions** page, select **Automatically define a partition and generate a snapshot if needed when a new Subscriber tries to synchronize**.</span></span>  
  
2.  [!INCLUDE[clickOK](../../../includes/clickok-md.md)]  
  
#### <a name="to-generate-a-snapshot-for-a-partition"></a><span data-ttu-id="3912e-139">Pour générer un instantané pour une partition</span><span class="sxs-lookup"><span data-stu-id="3912e-139">To generate a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="3912e-140">Sur la page **Partitions de données** , sélectionnez une partition dans la grille.</span><span class="sxs-lookup"><span data-stu-id="3912e-140">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="3912e-141">Cliquez sur **Générer les instantanés sélectionnés maintenant**.</span><span class="sxs-lookup"><span data-stu-id="3912e-141">Click **Generate the selected snapshots now**.</span></span>  
  
#### <a name="to-clean-up-a-snapshot-for-a-partition"></a><span data-ttu-id="3912e-142">Pour nettoyer un instantané pour une partition</span><span class="sxs-lookup"><span data-stu-id="3912e-142">To clean up a snapshot for a partition</span></span>  
  
1.  <span data-ttu-id="3912e-143">Sur la page **Partitions de données** , sélectionnez une partition dans la grille.</span><span class="sxs-lookup"><span data-stu-id="3912e-143">On the **Data Partitions** page, select a partition in the grid.</span></span>  
  
2.  <span data-ttu-id="3912e-144">Cliquez sur **Nettoyer les instantanés existants**.</span><span class="sxs-lookup"><span data-stu-id="3912e-144">Click **Clean up the existing snapshots**.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="3912e-145">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="3912e-145">Using Transact-SQL</span></span>  
 <span data-ttu-id="3912e-146">Pour mieux gérer une publication avec des filtres paramétrables, vous pouvez énumérer par programmation les partitions existantes à l'aide de procédures stockées de réplication.</span><span class="sxs-lookup"><span data-stu-id="3912e-146">To better manage a publication with parameterized filters, you can programmatically enumerate the existing partitions using replication stored procedures.</span></span> <span data-ttu-id="3912e-147">Vous pouvez également créer et supprimer des partitions existantes.</span><span class="sxs-lookup"><span data-stu-id="3912e-147">You can also create and delete existing partitions.</span></span> <span data-ttu-id="3912e-148">Vous pouvez obtenir les informations suivantes sur les partitions existantes :</span><span class="sxs-lookup"><span data-stu-id="3912e-148">The following information on existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="3912e-149">Comment une partition est filtrée (à l’aide de [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) ou de [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span><span class="sxs-lookup"><span data-stu-id="3912e-149">How a partition is filtered (using [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql) or [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql)).</span></span>  
  
-   <span data-ttu-id="3912e-150">Le nom du travail qui génère un instantané partitionné.</span><span class="sxs-lookup"><span data-stu-id="3912e-150">The name of the job that generates a partitioned snapshot.</span></span>  
  
-   <span data-ttu-id="3912e-151">La dernière fois qu'un travail d'instantané partitionné a été exécuté.</span><span class="sxs-lookup"><span data-stu-id="3912e-151">The last time that a partitioned snapshot job ran.</span></span>  
  
 <span data-ttu-id="3912e-152">Tandis que la deuxième partie de l'instantané bipartite peut être généré à la demande lors de l'initialisation d'un nouvel abonnement, les procédures suivantes permettent de contrôler comment cet instantané est généré et de le prégénérer dans les cas les plus pratiques.</span><span class="sxs-lookup"><span data-stu-id="3912e-152">While the second part of the two-part snapshot can be generated on-demand when a new subscription is initialized, the procedures below enable you to control how this snapshot is generated and to pre-generate this snapshot when it is most convenient.</span></span> <span data-ttu-id="3912e-153">Pour plus d'informations, voir [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-153">For more information, see [Snapshots for Merge Publications with Parameterized Filters](../snapshots-for-merge-publications-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="3912e-154">Pour consulter les informations sur les partitions existantes</span><span class="sxs-lookup"><span data-stu-id="3912e-154">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="3912e-155">Dans la base de données de publication sur le serveur de publication, exécutez [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-155">At the Publisher on the publication database, execute [sp_helpmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-helpmergepartition-transact-sql).</span></span> <span data-ttu-id="3912e-156">Spécifiez le nom de la publication pour la \*\* \@ publication\*\*.</span><span class="sxs-lookup"><span data-stu-id="3912e-156">Specify the name of the publication for **\@publication**.</span></span> <span data-ttu-id="3912e-157">Facultatif Spécifiez \*\* \@ suser_sname\*\* ou \*\* \@ HOST_NAME\*\* pour retourner uniquement les informations basées sur un critère de filtrage unique.</span><span class="sxs-lookup"><span data-stu-id="3912e-157">(Optional) Specify **\@suser_sname** or **\@host_name** to return only information based on a single filtering criterion.</span></span>  
  
#### <a name="to-define-a-new-partition-and-generate-a-new-partitioned-snapshot"></a><span data-ttu-id="3912e-158">Pour définir une nouvelle partition et générer un nouvel instantané partitionné</span><span class="sxs-lookup"><span data-stu-id="3912e-158">To define a new partition and generate a new partitioned snapshot</span></span>  
  
1.  <span data-ttu-id="3912e-159">Dans la base de données de publication sur le serveur de publication, exécutez [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-159">At the Publisher on the publication database, execute [sp_addmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergepartition-transact-sql).</span></span> <span data-ttu-id="3912e-160">Spécifiez le nom de la publication pour la \*\* \@ publication\*\*et la valeur paramétrable qui définit la partition pour l’un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="3912e-160">Specify the name of the publication for **\@publication**, and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="3912e-161">\*\* \@ SUSER_SNAME\*\* -lorsque le filtre paramétrable est défini par la valeur retournée par [SUSER_SNAME &#40;&#41;Transact-SQL ](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-161">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="3912e-162">\*\* \@ HOST_NAME\*\* -lorsque le filtre paramétrable est défini par la valeur retournée par [HOST_NAME &#40;&#41;Transact-SQL ](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-162">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
2.  <span data-ttu-id="3912e-163">Créez et initialisez l'instantané paramétrable de cette nouvelle partition.</span><span class="sxs-lookup"><span data-stu-id="3912e-163">Create and initialize the parameterized snapshot for this new partition.</span></span> <span data-ttu-id="3912e-164">Pour plus d'informations, voir [Créer un instantané d’une publication de fusion avec des filtres paramétrés](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-164">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
#### <a name="to-delete-a-partition"></a><span data-ttu-id="3912e-165">Pour supprimer une partition</span><span class="sxs-lookup"><span data-stu-id="3912e-165">To delete a partition</span></span>  
  
1.  <span data-ttu-id="3912e-166">Dans la base de données de publication sur le serveur de publication, exécutez [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-166">At the Publisher on the publication database, execute [sp_dropmergepartition &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-dropmergepartition-transact-sql).</span></span> <span data-ttu-id="3912e-167">Spécifiez le nom de la publication pour la \*\* \@ publication\*\* et la valeur paramétrable qui définit la partition pour l’un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="3912e-167">Specify the name of the publication for **\@publication** and the parameterized value that defines the partition for one of the following:</span></span>  
  
    -   <span data-ttu-id="3912e-168">\*\* \@ SUSER_SNAME\*\* -lorsque le filtre paramétrable est défini par la valeur retournée par [SUSER_SNAME &#40;&#41;Transact-SQL ](/sql/t-sql/functions/suser-sname-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-168">**\@suser_sname** - when the parameterized filter is defined by the value returned by [SUSER_SNAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/suser-sname-transact-sql).</span></span>  
  
    -   <span data-ttu-id="3912e-169">\*\* \@ HOST_NAME\*\* -lorsque le filtre paramétrable est défini par la valeur retournée par [HOST_NAME &#40;&#41;Transact-SQL ](/sql/t-sql/functions/host-name-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="3912e-169">**\@host_name** - when the parameterized filter is defined by the value returned by [HOST_NAME &#40;Transact-SQL&#41;](/sql/t-sql/functions/host-name-transact-sql).</span></span>  
  
     <span data-ttu-id="3912e-170">Le travail d'instantané et les fichiers d'instantané de la partition sont également supprimés.</span><span class="sxs-lookup"><span data-stu-id="3912e-170">This also removes the snapshot job and any snapshot files for the partition.</span></span>  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="3912e-171">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="3912e-171">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="3912e-172">Pour mieux gérer une publication avec les filtres paramétrables, vous pouvez par programmation créer, énumérer ou supprimer les partitions d'Abonné, en utilisant les objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="3912e-172">To better manage a publication with parameterized filters, you can programmatically create new Subscriber partitions, enumerate the existing Subscriber partitions, and delete Subscriber partitions by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="3912e-173">Pour plus d'informations sur la création de partitions d'Abonné, consultez [Créer un instantané d’une publication de fusion avec des filtres paramétrés](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="3912e-173">For information about how to create Subscriber partitions, see [Create a Snapshot for a Merge Publication with Parameterized Filters](../create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span> <span data-ttu-id="3912e-174">Vous pouvez obtenir les informations suivantes sur les partitions existantes :</span><span class="sxs-lookup"><span data-stu-id="3912e-174">The following information about existing partitions can be obtained:</span></span>  
  
-   <span data-ttu-id="3912e-175">la valeur et la fonction de filtrage sur lesquelles la partition est basée ;</span><span class="sxs-lookup"><span data-stu-id="3912e-175">The value and filtering function upon which the partition is based.</span></span>  
  
-   <span data-ttu-id="3912e-176">le nom du travail qui génère un instantané paramétrable pour l'Abonné ;</span><span class="sxs-lookup"><span data-stu-id="3912e-176">The name of the job that generates a parameterized snapshot for the Subscriber.</span></span>  
  
-   <span data-ttu-id="3912e-177">la dernière fois qu'un travail d'instantané paramétrable a été exécuté ;</span><span class="sxs-lookup"><span data-stu-id="3912e-177">The last time that a parameterized snapshot job ran.</span></span>  
  
#### <a name="to-view-information-on-existing-partitions"></a><span data-ttu-id="3912e-178">Pour consulter les informations sur les partitions existantes</span><span class="sxs-lookup"><span data-stu-id="3912e-178">To view information on existing partitions</span></span>  
  
1.  <span data-ttu-id="3912e-179">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="3912e-179">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="3912e-180">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="3912e-180">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="3912e-181">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> et <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> de la publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec la valeur <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="3912e-181">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="3912e-182">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="3912e-182">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="3912e-183">Si cette méthode retourne `false`, soit les propriétés de la publication ont été définies de manière incorrecte à l'étape 2, soit la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="3912e-183">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="3912e-184">Appelez la méthode <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> et passez le résultat à un tableau d'objets <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="3912e-184">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="3912e-185">Pour chaque objet <xref:Microsoft.SqlServer.Replication.MergePartition> du tableau, récupérez les propriétés dignes d'intérêt.</span><span class="sxs-lookup"><span data-stu-id="3912e-185">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, get any properties of interest.</span></span>  
  
#### <a name="to-delete-existing-partitions"></a><span data-ttu-id="3912e-186">Pour supprimer les partitions existantes</span><span class="sxs-lookup"><span data-stu-id="3912e-186">To delete existing partitions</span></span>  
  
1.  <span data-ttu-id="3912e-187">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="3912e-187">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="3912e-188">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="3912e-188">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="3912e-189">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> et <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> de la publication et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec la valeur <xref:Microsoft.SqlServer.Management.Common.ServerConnection> créée au cours de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="3912e-189">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> created in step 1.</span></span>  
  
3.  <span data-ttu-id="3912e-190">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés de l'objet.</span><span class="sxs-lookup"><span data-stu-id="3912e-190">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to get the properties of the object.</span></span> <span data-ttu-id="3912e-191">Si cette méthode retourne `false`, soit les propriétés de la publication ont été définies de manière incorrecte à l'étape 2, soit la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="3912e-191">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="3912e-192">Appelez la méthode <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> et passez le résultat à un tableau d'objets <xref:Microsoft.SqlServer.Replication.MergePartition> .</span><span class="sxs-lookup"><span data-stu-id="3912e-192">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.EnumMergePartitions%2A> method, and pass the result to an array of <xref:Microsoft.SqlServer.Replication.MergePartition> objects.</span></span>  
  
5.  <span data-ttu-id="3912e-193">Pour chaque objet <xref:Microsoft.SqlServer.Replication.MergePartition> du tableau, déterminez si la partition doit être supprimée.</span><span class="sxs-lookup"><span data-stu-id="3912e-193">For each <xref:Microsoft.SqlServer.Replication.MergePartition> object in the array, determine whether the partition should be deleted.</span></span> <span data-ttu-id="3912e-194">Cette décision repose habituellement sur la valeur de la propriété <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> ou de la propriété <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> .</span><span class="sxs-lookup"><span data-stu-id="3912e-194">This decision is usually based on the value of the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterLogin%2A> property or the <xref:Microsoft.SqlServer.Replication.MergePartition.DynamicFilterHostName%2A> property.</span></span>  
  
6.  <span data-ttu-id="3912e-195">Appelez la méthode <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> sur l'objet <xref:Microsoft.SqlServer.Replication.MergePublication> à partir de l'étape 2.</span><span class="sxs-lookup"><span data-stu-id="3912e-195">Call the <xref:Microsoft.SqlServer.Replication.MergePublication.RemoveMergePartition%2A> method on the <xref:Microsoft.SqlServer.Replication.MergePublication> object from step 2.</span></span> <span data-ttu-id="3912e-196">Passez l'objet <xref:Microsoft.SqlServer.Replication.MergePartition> créé à l'étape 5.</span><span class="sxs-lookup"><span data-stu-id="3912e-196">Pass the <xref:Microsoft.SqlServer.Replication.MergePartition> object from step 5.</span></span>  
  
7.  <span data-ttu-id="3912e-197">Répétez l'étape 6 pour chaque partition supprimée.</span><span class="sxs-lookup"><span data-stu-id="3912e-197">Repeat step 6 for each partition that is deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3912e-198">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3912e-198">See Also</span></span>  
 <span data-ttu-id="3912e-199">[Filtres de lignes paramétrés](../merge/parameterized-filters-parameterized-row-filters.md) </span><span class="sxs-lookup"><span data-stu-id="3912e-199">[Parameterized Row Filters](../merge/parameterized-filters-parameterized-row-filters.md) </span></span>  
 [<span data-ttu-id="3912e-200">Instantanés des publications de fusion avec des filtres paramétrés</span><span class="sxs-lookup"><span data-stu-id="3912e-200">Snapshots for Merge Publications with Parameterized Filters</span></span>](../snapshots-for-merge-publications-with-parameterized-filters.md)  
  
  
