---
title: Configurer IIS pour la synchronisation web | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- IIS server configuration [SQL Server replication]
- websync.log
- Web synchronization, IIS servers
ms.assetid: d651186e-c9ca-4864-a444-2cd6943b8e35
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 523c4fc30151acd3ee4df21f2fdaa2187e702870
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87603395"
---
# <a name="configure-iis-for-web-synchronization"></a><span data-ttu-id="b399a-102">Configurer IIS pour la synchronisation Web</span><span class="sxs-lookup"><span data-stu-id="b399a-102">Configure IIS for Web Synchronization</span></span>
  <span data-ttu-id="b399a-103">Les procédures de cette rubrique constituent la deuxième étape de la configuration de la synchronisation Web pour la réplication de fusion.</span><span class="sxs-lookup"><span data-stu-id="b399a-103">The procedures in this topic make up the second step in configuring Web synchronization for merge replication.</span></span> <span data-ttu-id="b399a-104">Cette étape est réalisée après l'activation d'une publication pour la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-104">You perform this step after you enable a publication for Web synchronization.</span></span> <span data-ttu-id="b399a-105">Le processus de configuration est présenté dans [Configurer la synchronisation Web](configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="b399a-105">For an overview of the configuration process, see [Configure Web Synchronization](configure-web-synchronization.md).</span></span> <span data-ttu-id="b399a-106">Après avoir terminé les procédures de cette rubrique, poursuivez par la troisième étape, qui est la configuration d'un abonnement pour qu'il utilise la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-106">After you complete the procedures in this topic, continue to the third step, configuring a subscription to use Web synchronization.</span></span> <span data-ttu-id="b399a-107">Cette troisième étape est décrite dans les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="b399a-107">This third step is described in the following topics:</span></span>  
  
-   [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] <span data-ttu-id="b399a-108">: [Guide pratique pour configurer un abonnement qui utilise la synchronisation web \(SQL Server Management Studio\)](https://msdn.microsoft.com/library/ms345214.aspx)</span><span class="sxs-lookup"><span data-stu-id="b399a-108">: [How to: Configure a Subscription to Use Web Synchronization \(SQL Server Management Studio\)](https://msdn.microsoft.com/library/ms345214.aspx)</span></span>  
  
-   <span data-ttu-id="b399a-109">Programmation [!INCLUDE[tsql](../../includes/tsql-md.md)] de réplication. [Procédure : configurer un abonnement pour utiliser la synchronisation Web (programmation Transact-SQL de la réplication)](https://msdn.microsoft.com/library/ms345206.aspx)</span><span class="sxs-lookup"><span data-stu-id="b399a-109">Replication [!INCLUDE[tsql](../../includes/tsql-md.md)] programming: [How to: Configure a Subscription to Use Web Synchronization (Replication Transact-SQL Programming)](https://msdn.microsoft.com/library/ms345206.aspx)</span></span>  
  
-   <span data-ttu-id="b399a-110">Objets RMO. [Procédure : configurer un abonnement pour utiliser la synchronisation Web (programmation RMO)](https://msdn.microsoft.com/library/ms345207.aspx)</span><span class="sxs-lookup"><span data-stu-id="b399a-110">RMO: [How to: Configure a Subscription to Use Web Synchronization (RMO Programming)](https://msdn.microsoft.com/library/ms345207.aspx)</span></span>  
  
 <span data-ttu-id="b399a-111">La synchronisation Web utilise un ordinateur exécutant [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Information Services (IIS) pour synchroniser des abonnements par extraction de données (pull) avec des publications de fusion.</span><span class="sxs-lookup"><span data-stu-id="b399a-111">Web synchronization uses a computer that is running [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Information Services (IIS) to synchronize pull subscriptions to merge publications.</span></span> <span data-ttu-id="b399a-112">IIS version 5.0, IIS version 6.0 et IIS version 7.0 sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b399a-112">IIS version 5.0, IIS version 6.0, and IIS version 7.0 are supported.</span></span> <span data-ttu-id="b399a-113">L'Assistant Configuration de la synchronisation Web n'est pas pris en charge sur IIS version 7.0.</span><span class="sxs-lookup"><span data-stu-id="b399a-113">The Configure Web Synchronization Wizard is not supported on IIS version 7.0.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="b399a-114">Assurez-vous que votre application utilise uniquement [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] ou une version ultérieure et qu'aucune version antérieure de [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] n'est installée sur le serveur IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-114">Make sure that your application uses only [!INCLUDE[dnprdnlong](../../includes/dnprdnlong-md.md)] or later versions, and that earlier versions of the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] are not installed on the IIS server.</span></span> <span data-ttu-id="b399a-115">Les versions antérieures de [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] peuvent provoquer des erreurs.</span><span class="sxs-lookup"><span data-stu-id="b399a-115">Earlier versions of the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] can cause errors.</span></span> <span data-ttu-id="b399a-116">Il peut s'agir de l'erreur suivante : « Le format d'un message pendant la synchronisation Web n'était pas valide.</span><span class="sxs-lookup"><span data-stu-id="b399a-116">These include the following: "The format of a message during Web synchronization was invalid.</span></span> <span data-ttu-id="b399a-117">Vérifiez que les composants de réplication sont correctement configurés sur le serveur Web. »</span><span class="sxs-lookup"><span data-stu-id="b399a-117">Ensure that replication components are properly configured at the Web server".</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="b399a-118">N'utilisez pas WebSync et d'autres emplacements de dossier d'instantanés à la fois.</span><span class="sxs-lookup"><span data-stu-id="b399a-118">Do not use both WebSync and alternate snapshot folder locations at the same time.</span></span>  
  
 <span data-ttu-id="b399a-119">Pour utiliser la synchronisation Web, vous devez configurer IIS en effectuant les étapes ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="b399a-119">To use Web synchronization, you must configure IIS by completing the following steps.</span></span> <span data-ttu-id="b399a-120">Chaque étape est détaillée dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="b399a-120">Each step is described in detail in this topic.</span></span>  
  
1.  <span data-ttu-id="b399a-121">Configurer SSL (Secure Sockets Layer).</span><span class="sxs-lookup"><span data-stu-id="b399a-121">Configure Secure Sockets Layer (SSL).</span></span> <span data-ttu-id="b399a-122">SSL est requis pour les communications entre IIS et tous les Abonnés.</span><span class="sxs-lookup"><span data-stu-id="b399a-122">SSL is required for communication between IIS and all Subscribers.</span></span>  
  
2.  <span data-ttu-id="b399a-123">Installez [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] les composants de connectivité sur l’ordinateur qui exécute IIS à l’aide de l' [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Assistant Installation de.</span><span class="sxs-lookup"><span data-stu-id="b399a-123">Install [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connectivity components on the computer that is running IIS by using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Installation Wizard.</span></span> <span data-ttu-id="b399a-124">Si vous envisagez d'utiliser l'Assistant Configuration de la synchronisation Web mentionné dans l'étape 3, vous devez également installer [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] sur l'ordinateur exécutant IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-124">If you plan to use the Configure Web Synchronization Wizard that is mentioned in step 3, you must also install [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] on the computer that is running IIS.</span></span>  
  
3.  <span data-ttu-id="b399a-125">Configurez l'ordinateur exécutant IIS pour la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-125">Configure the computer that is running IIS for Web synchronization.</span></span> <span data-ttu-id="b399a-126">Vous pouvez configurer l'ordinateur manuellement ou utiliser l'Assistant Configuration de la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-126">You can configure the computer manually or use the Configure Web Synchronization Wizard.</span></span> <span data-ttu-id="b399a-127">Nous vous recommandons d'utiliser l'Assistant.</span><span class="sxs-lookup"><span data-stu-id="b399a-127">We recommend that you use the wizard.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b399a-128">Si l'ordinateur qui exécute IIS utilise une version 64 bits de Windows, vous devez exécuter la commande suivante pour vous assurer que le serveur est correctement configuré pour exécuter des applications ISAPI (Internet Server API).</span><span class="sxs-lookup"><span data-stu-id="b399a-128">If the computer that is running IIS is running on a 64-bit version of Windows, you must run following command to make sure that the server is properly configured to run Internet Server API (ISAPI) applications.</span></span> <span data-ttu-id="b399a-129">Pour plus d'informations, consultez la documentation relative à IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-129">For more information, see the IIS documentation.</span></span>  
  
    ```  
    cscript %SystemDrive%\inetpub\AdminScripts\adsutil.vbs set w3svc/AppPools/Enable32bitAppOnWin64 1  
    ```  
  
4.  <span data-ttu-id="b399a-130">Définissez les autorisations appropriées pour l'écouteur de réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b399a-130">Set the appropriate permissions for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener.</span></span>  
  
5.  <span data-ttu-id="b399a-131">Exécutez la synchronisation Web en mode de diagnostic pour tester la connexion à l'ordinateur exécutant IIS et pour vérifier que le certificat SSL est correctement installé.</span><span class="sxs-lookup"><span data-stu-id="b399a-131">Run Web synchronization in diagnostic mode to test the connection to the computer that is running IIS and to make sure that the SSL certificate is properly installed.</span></span>  
  
## <a name="configuring-secure-sockets-layer"></a><span data-ttu-id="b399a-132">Configuration de SSL (Secure Sockets Layer)</span><span class="sxs-lookup"><span data-stu-id="b399a-132">Configuring Secure Sockets Layer</span></span>  
 <span data-ttu-id="b399a-133">Pour configurer SSL, spécifiez un certificat que l'ordinateur exécutant IIS va utiliser.</span><span class="sxs-lookup"><span data-stu-id="b399a-133">To configure SSL, specify a certificate for the computer that is running IIS to use.</span></span> <span data-ttu-id="b399a-134">La synchronisation Web pour la réplication de fusion prend en charge l'utilisation des certificats de serveur, mais pas celle des certificats clients.</span><span class="sxs-lookup"><span data-stu-id="b399a-134">Web synchronization for merge replication supports using server certificates but not client certificates.</span></span> <span data-ttu-id="b399a-135">Pour configurer IIS pour le déploiement, vous devez d'abord obtenir un certificat auprès d'une Autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="b399a-135">To configure IIS for deployment, you must first obtain a certificate from a certification authority (CA).</span></span> <span data-ttu-id="b399a-136">Une Autorité de certification est une entité chargée d'établir et de se porter garante de l'authenticité des clés publiques de chiffrement appartenant à des utilisateurs, à des ordinateurs ou à d'autres Autorités de certification.</span><span class="sxs-lookup"><span data-stu-id="b399a-136">A certificate authority is an entity that is responsible for establishing and vouching for the authenticity of public encryption keys that belong to users, computers, or other certification authorities.</span></span> <span data-ttu-id="b399a-137">Pour plus d'informations sur les certificats, consultez la documentation de IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-137">For more information about certificates, see the IIS documentation.</span></span> <span data-ttu-id="b399a-138">Après avoir installé le certificat, vous devez l'associer au site Web utilisé par la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-138">After you install the certificate, you must associate the certificate with the Web site that is used by Web synchronization.</span></span>  
  
#### <a name="to-specify-a-certificate-for-deployment"></a><span data-ttu-id="b399a-139">Pour spécifier un certificat pour un déploiement</span><span class="sxs-lookup"><span data-stu-id="b399a-139">To specify a certificate for deployment</span></span>  
  
1.  <span data-ttu-id="b399a-140">Connectez-vous à l'ordinateur exécutant IIS en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="b399a-140">Log on to the computer that is running IIS as an administrator.</span></span>  
  
2.  <span data-ttu-id="b399a-141">Démarrez le **Gestionnaire des services Internet (IIS)**:</span><span class="sxs-lookup"><span data-stu-id="b399a-141">Start **Internet Information Services (IIS) Manager**:</span></span>  
  
    1.  <span data-ttu-id="b399a-142">Cliquez sur **Démarrer**, puis sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-142">Click **Start**, and then click **Run**.</span></span>  
  
    2.  <span data-ttu-id="b399a-143">Dans la zone **ouvrir** , tapez `inetmgr` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-143">In the **Open** box, type `inetmgr`, and then click **OK**.</span></span>  
  
3.  <span data-ttu-id="b399a-144">Exécutez l'Assistant Certificat d'IIS :</span><span class="sxs-lookup"><span data-stu-id="b399a-144">Run the IIS Certificate Wizard:</span></span>  
  
    1.  <span data-ttu-id="b399a-145">Dans **Gestionnaire des services Internet (IIS)**, développez le nœud **ordinateur local** , puis développez **Sites Web** .</span><span class="sxs-lookup"><span data-stu-id="b399a-145">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand the **Web Sites** folder.</span></span>  
  
    2.  <span data-ttu-id="b399a-146">Cliquez avec le bouton droit sur **Site Web par défaut**, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="b399a-146">Right-click **Default Web Site**, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="b399a-147">Dans la boîte de dialogue **Propriétés du site Web par défaut** , sur l'onglet **Sécurité de répertoire** , cliquez sur **Certificat de serveur**.</span><span class="sxs-lookup"><span data-stu-id="b399a-147">In the **Default Web Site Properties** dialog box, on the **Directory Security** tab, click **Server Certificate**.</span></span>  
  
    4.  <span data-ttu-id="b399a-148">Terminez l'Assistant Certificat de serveur Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-148">Complete the Web Server Certificate Wizard.</span></span>  
  
4.  <span data-ttu-id="b399a-149">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-149">Click **OK**.</span></span>  
  
 <span data-ttu-id="b399a-150">Si vous ne pouvez pas obtenir de certificat de serveur auprès d'une Autorité de certification, vous pouvez spécifier un certificat de test.</span><span class="sxs-lookup"><span data-stu-id="b399a-150">If you cannot obtain a server certificate from a CA, you can specify a certificate for testing.</span></span> <span data-ttu-id="b399a-151">Pour configurer IIS 6.0 à des fins de test, installez un certificat à l'aide de l'utilitaire SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-151">To configure IIS 6.0 for testing, install a certificate by using the SelfSSL utility.</span></span> <span data-ttu-id="b399a-152">Cet utilitaire est présent dans le Kit de ressources techniques IIS 6.0.</span><span class="sxs-lookup"><span data-stu-id="b399a-152">This utility is available in the IIS 6.0 Resource Kit.</span></span> <span data-ttu-id="b399a-153">Vous pouvez télécharger les outils à partir du [Centre de téléchargement Microsoft](https://www.microsoft.com/download/details.aspx?id=5135).</span><span class="sxs-lookup"><span data-stu-id="b399a-153">You can download the tools from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=5135).</span></span> <span data-ttu-id="b399a-154">Pour IIS 5.0, visitez le site [Aide et Support Microsoft](https://go.microsoft.com/fwlink/?LinkId=46229).</span><span class="sxs-lookup"><span data-stu-id="b399a-154">For IIS 5.0, go to [Microsoft Help and Support](https://go.microsoft.com/fwlink/?LinkId=46229).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b399a-155">Un certificat doit être associé à un site Web avant que ce dernier puisse utiliser SSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-155">A certificate must be associated with a Web site before that Web site can use SSL.</span></span> <span data-ttu-id="b399a-156">SelfSSL associe automatiquement le certificat au site Web par défaut.</span><span class="sxs-lookup"><span data-stu-id="b399a-156">SelfSSL automatically associates the certificate with the default Web site.</span></span> <span data-ttu-id="b399a-157">Si vous avez déjà un certificat ou si vous installez plus tard un certificat d'une Autorité de certification, vous devez explicitement associer ce certificat au site Web utilisé par la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-157">If you already have a certificate or later install a certificate from a CA, you must explicitly associate that certificate with the Web site that is used by Web synchronization.</span></span> <span data-ttu-id="b399a-158">Vérifiez qu'un seul certificat est associé au site Web utilisé pour synchroniser les abonnements.</span><span class="sxs-lookup"><span data-stu-id="b399a-158">Make sure there is only one certificate associated with the Web site that is used to synchronize subscriptions.</span></span> <span data-ttu-id="b399a-159">S'il y a plusieurs certificats, l'Abonné utilisera le premier site Web disponible.</span><span class="sxs-lookup"><span data-stu-id="b399a-159">If there are multiple certificates, the Subscriber will use the first available Web site.</span></span>  
  
#### <a name="to-specify-a-certificate-for-testing-in-iis-60"></a><span data-ttu-id="b399a-160">Pour spécifier un certificat pour des tests dans IIS 6.0</span><span class="sxs-lookup"><span data-stu-id="b399a-160">To specify a certificate for testing in IIS 6.0</span></span>  
  
1.  <span data-ttu-id="b399a-161">Connectez-vous à l'ordinateur exécutant IIS en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="b399a-161">Log on to the computer that is running IIS as an administrator.</span></span>  
  
2.  <span data-ttu-id="b399a-162">Téléchargez et installez SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-162">Download and install SelfSSL.</span></span> <span data-ttu-id="b399a-163">Par défaut, l’application est installée dans \<*drive*> : \Program Files\IIS Resources\SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-163">By default, the application is installed to \<*drive*>:\Program Files\IIS Resources\SelfSSL.</span></span> <span data-ttu-id="b399a-164">Les raccourcis vers les applications et la documentation sont copiés vers \<*drive*> : \Documents and Settings\All Users\Menu \ vers Resources\SelfSSL. Resources\SelfSSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-164">Application and documentation shortcuts are copied to \<*drive*>:\Documents and Settings\All Users\Start Menu\Programs\IIS Resources\SelfSSL.</span></span>  
  
3.  <span data-ttu-id="b399a-165">Exécutez SelfSSL :</span><span class="sxs-lookup"><span data-stu-id="b399a-165">Run SelfSSL:</span></span>  
  
    -   <span data-ttu-id="b399a-166">Pour exécuter SelfSSL avec les valeurs par défaut pour tous les paramètres, recherchez le répertoire d'installation de l'application, puis double-cliquez sur SelfSSL.exe.</span><span class="sxs-lookup"><span data-stu-id="b399a-166">To run SelfSSL with default values for all parameters, locate the installation directory for the application, and then double-click SelfSSL.exe.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="b399a-167">Par défaut, le certificat installé par SelfSSL est valide pour sept jours.</span><span class="sxs-lookup"><span data-stu-id="b399a-167">By default, the certificate that is installed by SelfSSL is valid for seven days.</span></span>  
  
    -   <span data-ttu-id="b399a-168">Pour spécifier des valeurs pour un ou plusieurs paramètres : cliquez sur **Démarrer**, puis cliquez sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-168">To specify values for one or more parameters: click **Start**, and then click **Run**.</span></span> <span data-ttu-id="b399a-169">Dans la zone **ouvrir** , entrez `cmd` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-169">In the **Open** box, enter `cmd`, and then click **OK**.</span></span> <span data-ttu-id="b399a-170">Recherchez le répertoire d'installation de SelfSSL, tapez `SelfSSL`, puis spécifiez les valeurs d'un ou plusieurs paramètres.</span><span class="sxs-lookup"><span data-stu-id="b399a-170">Locate the SelfSSL installation directory, type `SelfSSL`, and then specify values for one or more parameters.</span></span> <span data-ttu-id="b399a-171">Pour obtenir la liste des paramètres, tapez `SelfSSL -?`.</span><span class="sxs-lookup"><span data-stu-id="b399a-171">For a list of parameters, type `SelfSSL -?`.</span></span>  
  
## <a name="installing-connectivity-components-and-sql-server-management-studio"></a><span data-ttu-id="b399a-172">Installation des composants de connectivité et de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b399a-172">Installing Connectivity Components and SQL Server Management Studio</span></span>  
  
#### <a name="to-install-sql-server-connectivity-components-and-sql-server-management-studio"></a><span data-ttu-id="b399a-173">Pour installer les composants de connectivité de SQL Server et SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="b399a-173">To install SQL Server connectivity components and SQL Server Management Studio</span></span>  
  
1.  <span data-ttu-id="b399a-174">Connectez-vous en tant qu'administrateur à l'ordinateur exécutant IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-174">Log on as an administrator to the computer that is running IIS.</span></span>  
  
2.  <span data-ttu-id="b399a-175">Démarrez l'Assistant Installation de [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] à partir du disque d'installation de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b399a-175">From the [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] installation disk, start the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Installation Wizard.</span></span> <span data-ttu-id="b399a-176">Pour plus d’informations sur l’utilisation de cet Assistant, voir [installer SQL Server 2014 à partir de l’Assistant installation &#40;&#41;d' ](../../database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup.md)installation.</span><span class="sxs-lookup"><span data-stu-id="b399a-176">For more information about using this wizard, see [Install SQL Server 2014 from the Installation Wizard &#40;Setup&#41;](../../database-engine/install-windows/install-sql-server-from-the-installation-wizard-setup.md).</span></span>  
  
3.  <span data-ttu-id="b399a-177">Dans la page **Sélection de composant** , sélectionnez **Connectivité des outils clients**.</span><span class="sxs-lookup"><span data-stu-id="b399a-177">On the **Feature Selection** page, select **Client Tools Connectivity**.</span></span>  
  
4.  <span data-ttu-id="b399a-178">Si vous projetez d'utiliser l'Assistant Configuration de la synchronisation Web, sélectionnez **Outils de gestion - De base**.</span><span class="sxs-lookup"><span data-stu-id="b399a-178">If you plan to use the Configure Web Synchronization Wizard, select **Management Tools - Basic**.</span></span>  
  
5.  <span data-ttu-id="b399a-179">Terminez l'Assistant puis redémarrez l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b399a-179">Complete the wizard, and then restart the computer.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b399a-180">Vous pouvez installer d'autres composants, mais seuls les composants de connectivité sont nécessaires pour la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-180">You can install additional components, but only the connectivity components are required for Web synchronization.</span></span>  
  
## <a name="configuring-the-computer-that-is-running-iis-by-using-the-configure-web-synchronization-wizard"></a><span data-ttu-id="b399a-181">Configuration de l'ordinateur exécutant IIS à l'aide de l'Assistant Configuration de la synchronisation Web</span><span class="sxs-lookup"><span data-stu-id="b399a-181">Configuring the Computer That Is Running IIS by Using the Configure Web Synchronization Wizard</span></span>  
 <span data-ttu-id="b399a-182">Configurez le serveur IIS à l'aide de l'Assistant Configuration de la synchronisation Web ou manuellement.</span><span class="sxs-lookup"><span data-stu-id="b399a-182">Configure the IIS server by using the Configure Web Synchronization Wizard or manually.</span></span> <span data-ttu-id="b399a-183">Il est recommandé d'utiliser l'Assistant ; la section suivante présente néanmoins les étapes de configuration manuelle.</span><span class="sxs-lookup"><span data-stu-id="b399a-183">We recommend using the wizard, but we also provide steps for manual configuration in the next section.</span></span> <span data-ttu-id="b399a-184">L'Assistant Synchronisation Web qui est disponible avec [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] peut être utilisé uniquement pour les publications créées sur un serveur de publication qui exécute [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]ou sur un serveur de publication qui a été mis à niveau vers [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b399a-184">The Web Synchronization Wizard that is available with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] can be used only for publications that were created on a Publisher that is running [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], or a Publisher that was upgraded to [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)].</span></span> <span data-ttu-id="b399a-185">L'Assistant ne peut pas être utilisé pour les publications dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b399a-185">The wizard cannot be used for publications on [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="b399a-186">L'Assistant peut être utilisé avec les abonnements dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] et les versions ultérieures, ainsi que dans [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 et les versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="b399a-186">The wizard can be used with subscriptions on [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and later versions, and [!INCLUDE[ssEWnoversion](../../includes/ssewnoversion-md.md)] 3.0 and later versions.</span></span>  
  
 <span data-ttu-id="b399a-187">La configuration présente les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="b399a-187">The configuration has the following characteristics:</span></span>  
  
-   <span data-ttu-id="b399a-188">utilise le site Web par défaut dans IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-188">Uses the default Web site in IIS.</span></span> <span data-ttu-id="b399a-189">Vous pouvez toutefois utiliser un autre site Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-189">However, you can use another Web site.</span></span> <span data-ttu-id="b399a-190">Pour plus d'informations sur la création de sites Web, consultez la documentation de IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-190">For more information about how to create Web sites, see the IIS documentation.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b399a-191">Le site Web que vous spécifiez donne accès aux composants utilisés par la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-191">The Web site that you specify provides access to the components that are used by Web synchronization.</span></span> <span data-ttu-id="b399a-192">Il ne donne pas accès à d'autres données ou à d'autres pages Web, sauf si vous configurez le site dans ce sens.</span><span class="sxs-lookup"><span data-stu-id="b399a-192">The Web site does not provide access to other data or Web pages unless you configure the site to do so.</span></span>  
  
-   <span data-ttu-id="b399a-193">crée un répertoire virtuel et ses alias associés.</span><span class="sxs-lookup"><span data-stu-id="b399a-193">Creates a virtual directory and its associated alias.</span></span> <span data-ttu-id="b399a-194">L'alias est utilisé lors de l'accès aux composants de la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="b399a-194">The alias is used when accessing the Web synchronization components.</span></span> <span data-ttu-id="b399a-195">Par exemple, si l’adresse du serveur IIS est `https://*server.domain.com*` et si vous spécifiez l’alias « websync1 », l’adresse permettant d’accéder au composant replisapi.dll est `https://*server.domain.com*/websync1/replisapi.dll`.</span><span class="sxs-lookup"><span data-stu-id="b399a-195">For example, if the IIS address is `https://*server.domain.com*` and you specify an alias of 'websync1', the address to access the replisapi.dll component is `https://*server.domain.com*/websync1/replisapi.dll`.</span></span>  
  
-   <span data-ttu-id="b399a-196">Utilise l'authentification de base.</span><span class="sxs-lookup"><span data-stu-id="b399a-196">Uses Basic Authentication.</span></span> <span data-ttu-id="b399a-197">Il est recommandé d'utiliser l'authentification de base car elle vous permet d'exécuter IIS et le serveur de publication/distribution [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sur des ordinateurs distincts (c'est la configuration recommandée) sans recourir à la délégation Kerberos.</span><span class="sxs-lookup"><span data-stu-id="b399a-197">We recommend using Basic Authentication because Basic Authentication enables you to run IIS and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Publisher/Distributor on separate computers (the recommended configuration) without requiring Kerberos delegation.</span></span> <span data-ttu-id="b399a-198">L'utilisation de SSL avec l'authentification de base garantit que les connexions, les mots de passe et toutes les données sont chiffrés lors du transit.</span><span class="sxs-lookup"><span data-stu-id="b399a-198">Using SSL with Basic Authentication makes sure that logins, passwords, and all data are encrypted in transit.</span></span> <span data-ttu-id="b399a-199">(SSL est obligatoire, quel que soit le type d’authentification utilisé.) Pour plus d’informations sur les meilleures pratiques pour la synchronisation Web, consultez la section « meilleures pratiques de sécurité pour la synchronisation Web » dans [configurer la synchronisation Web](configure-web-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="b399a-199">(SSL is required, regardless of the type of authentication that is used.) For more information about best practices for Web synchronization, see the section "Security Best Practices for Web Synchronization" in [Configure Web Synchronization](configure-web-synchronization.md).</span></span>  
  
#### <a name="to-configure-the-computer-that-is-running-iis-by-using-the-configure-web-synchronization-wizard"></a><span data-ttu-id="b399a-200">Pour configurer l'ordinateur exécutant IIS à l'aide de l'Assistant Configuration de la synchronisation Web</span><span class="sxs-lookup"><span data-stu-id="b399a-200">To configure the computer that is running IIS by using the Configure Web Synchronization Wizard</span></span>  
  
1.  <span data-ttu-id="b399a-201">Sur l'ordinateur exécutant IIS, démarrez [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b399a-201">On the computer that is running IIS, start [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span>  
  
2.  <span data-ttu-id="b399a-202">Connectez-vous au serveur de publication, puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="b399a-202">Connect to the Publisher, and then expand the server node.</span></span>  
  
3.  <span data-ttu-id="b399a-203">Développez le dossier **Publications locales** , cliquez avec le bouton droit sur la publication, puis cliquez sur **Configurer la synchronisation Web**.</span><span class="sxs-lookup"><span data-stu-id="b399a-203">Expand the **Local Publications** folder, right-click the publication, and then click **Configure Web Synchronization**.</span></span>  
  
4.  <span data-ttu-id="b399a-204">Dans l'Assistant Configuration de la synchronisation Web, sur la page **Type d'Abonné** , sélectionnez **SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="b399a-204">In the Configure Web Synchronization Wizard, on the **Subscriber Type** page, select **SQL Server**.</span></span>  
  
5.  <span data-ttu-id="b399a-205">Sur la page **Serveur Web** :</span><span class="sxs-lookup"><span data-stu-id="b399a-205">On the **Web Server** page:</span></span>  
  
    1.  <span data-ttu-id="b399a-206">Sélectionnez l'instance de IIS qui va synchroniser les abonnements.</span><span class="sxs-lookup"><span data-stu-id="b399a-206">Select the instance of IIS that will synchronize subscriptions.</span></span>  
  
    2.  <span data-ttu-id="b399a-207">Sélectionnez **Créer un nouveau répertoire virtuel**.</span><span class="sxs-lookup"><span data-stu-id="b399a-207">Select **Create a new virtual directory**.</span></span>  
  
    3.  <span data-ttu-id="b399a-208">Dans le volet inférieur de la page, développez l'instance de IIS, développez **Sites Web**, puis cliquez sur **Site Web par défaut**.</span><span class="sxs-lookup"><span data-stu-id="b399a-208">In the lower pane of the page, expand the instance of IIS, expand **Web Sites**, and then click **Default Web Site**.</span></span>  
  
6.  <span data-ttu-id="b399a-209">Sur la page **Informations sur le répertoire virtuel** :</span><span class="sxs-lookup"><span data-stu-id="b399a-209">On the **Virtual Directory Information** page:</span></span>  
  
    1.  <span data-ttu-id="b399a-210">Dans la zone **Alias** , entrez un alias pour le répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="b399a-210">In the **Alias** box, enter an alias for the virtual directory.</span></span>  
  
    2.  <span data-ttu-id="b399a-211">Dans la zone **Chemin d'accès** , entrez un chemin d'accès au répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="b399a-211">In the **Path** box, enter a path of the virtual directory.</span></span> <span data-ttu-id="b399a-212">Par exemple, si vous avez entré `websync1` dans la zone **alias** , entrez `C:\Inetpub\wwwroot\websync1` dans la zone **chemin d’accès** .</span><span class="sxs-lookup"><span data-stu-id="b399a-212">For example, if you entered `websync1` in the **Alias** box, enter `C:\Inetpub\wwwroot\websync1` in the **Path** box.</span></span> <span data-ttu-id="b399a-213">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="b399a-213">Click **Next**.</span></span>  
  
    3.  <span data-ttu-id="b399a-214">Dans les deux boîtes de dialogue, cliquez sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="b399a-214">On both dialog boxes, click **Yes**.</span></span> <span data-ttu-id="b399a-215">Ceci indique que vous souhaitez créer un nouveau dossier et copier la DLL [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ISAPI (Internet Server API).</span><span class="sxs-lookup"><span data-stu-id="b399a-215">This specifies that you want to create a new folder and that you want to copy the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Internet Server API (ISAPI) DLL.</span></span> <span data-ttu-id="b399a-216">.</span><span class="sxs-lookup"><span data-stu-id="b399a-216">.</span></span>  
  
7.  <span data-ttu-id="b399a-217">Sur la page **Accès authentifié** :</span><span class="sxs-lookup"><span data-stu-id="b399a-217">On the **Authenticated Access** page:</span></span>  
  
    1.  <span data-ttu-id="b399a-218">Vérifiez que les options **Authentification Windows intégrée** et **Authentification Digest pour les serveurs de domaine Windows** sont désactivées.</span><span class="sxs-lookup"><span data-stu-id="b399a-218">Make sure that **Integrated Windows authentication** and **Digest authentication for Windows domain servers** are cleared.</span></span>  
  
    2.  <span data-ttu-id="b399a-219">Sélectionnez **Authentification de base**.</span><span class="sxs-lookup"><span data-stu-id="b399a-219">Select **Basic Authentication**.</span></span>  
  
    3.  <span data-ttu-id="b399a-220">Dans les zones **Domaine par défaut** et **Domaine** , entrez le domaine de l'ordinateur exécutant IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-220">In the **Default Domain** and **Realm** boxes, enter the domain of the computer that is running IIS.</span></span>  
  
8.  <span data-ttu-id="b399a-221">Sur la page **Accès à l'annuaire** :</span><span class="sxs-lookup"><span data-stu-id="b399a-221">On the **Directory Access** page:</span></span>  
  
    1.  <span data-ttu-id="b399a-222">Cliquez sur **Ajouter**puis, dans la boîte de dialogue **Sélectionner des utilisateurs ou des groupes** , ajoutez les comptes sous lesquels les Abonnés établiront des connexions à IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-222">Click **Add**, and then in the **Select Users or Groups** dialog box, add the accounts under which Subscribers will make connections to IIS.</span></span> <span data-ttu-id="b399a-223">Il s’agit des comptes que vous spécifiez dans la page **Informations sur le serveur Web** de l’Assistant Nouvel abonnement ou via le paramètre [de](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)*@internet_login* .</span><span class="sxs-lookup"><span data-stu-id="b399a-223">These are the accounts that you will specify on the **Web Server Information** page of the New Subscription Wizard or as the value for the [sp_addmergepullsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepullsubscription-agent-transact-sql)*@internet_login* parameter.</span></span>  
  
9. <span data-ttu-id="b399a-224">Sur la page **Accès au partage de fichiers d'instantanés** , entrez le partage d'instantané.</span><span class="sxs-lookup"><span data-stu-id="b399a-224">On the **Snapshot Share Access** page, enter the snapshot share.</span></span> <span data-ttu-id="b399a-225">Les autorisations appropriées sont définies sur ce partage pour que les Abonnés puissent accéder aux fichiers d'instantanés.</span><span class="sxs-lookup"><span data-stu-id="b399a-225">The appropriate permissions are set on this share so that Subscribers can access the snapshot files.</span></span> <span data-ttu-id="b399a-226">Pour plus d’informations sur les autorisations pour le partage, consultez [Sécuriser le dossier d’instantanés](security/secure-the-snapshot-folder.md).</span><span class="sxs-lookup"><span data-stu-id="b399a-226">For more information about permissions for the share, see [Secure the Snapshot Folder](security/secure-the-snapshot-folder.md).</span></span>  
  
10. <span data-ttu-id="b399a-227">Sur la page **Fin de l'Assistant** , cliquez sur **Terminer**.</span><span class="sxs-lookup"><span data-stu-id="b399a-227">On the **Completing the Wizard** page, click **Finish**.</span></span>  
  
     <span data-ttu-id="b399a-228">Si une défaillance se produit, telle qu'une erreur réseau lors de la configuration d'un ordinateur distant exécutant IIS, toutes les actions terminées sont restaurées et toutes les actions restantes sont annulées.</span><span class="sxs-lookup"><span data-stu-id="b399a-228">If a failure occurs, such as a network error while trying to configure a remote computer that is running IIS, all completed actions are rolled back and all remaining actions are canceled.</span></span> <span data-ttu-id="b399a-229">Si une action  terminée ne peut pas être annulée, l'état indiqué dans la page finale de l'Assistant affiche **Succès** et les actions terminées restent validées.</span><span class="sxs-lookup"><span data-stu-id="b399a-229">If a completed action cannot be rolled back, the status in the final page of the wizard displays **Success** and the completed actions remain committed.</span></span>  
  
11. <span data-ttu-id="b399a-230">Si l'ordinateur exécutant IIS utilise une version 64 bits de Windows, replisapi.dll doit être copié dans le répertoire approprié :</span><span class="sxs-lookup"><span data-stu-id="b399a-230">If the computer that is running IIS is running on a 64-bit version of Windows, replisapi.dll must be copied to the appropriate directory:</span></span>  
  
    1.  <span data-ttu-id="b399a-231">Cliquez sur **Démarrer**, puis sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-231">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="b399a-232">Dans la zone **ouvrir** , entrez `iisreset` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-232">In the **Open** box, enter `iisreset`, and then click **OK**.</span></span>  
  
    2.  <span data-ttu-id="b399a-233">Après l'arrêt et le redémarrage d'IIS, copiez replisapi.dll à partir du dossier [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi vers le répertoire spécifié à l'étape 6b.</span><span class="sxs-lookup"><span data-stu-id="b399a-233">After IIS stops and restarts, copy replisapi.dll from [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]COM\replisapi to the directory that is specified in step 6b.</span></span>  
  
    3.  <span data-ttu-id="b399a-234">Cliquez sur **Démarrer**, puis sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-234">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="b399a-235">Dans la zone **ouvrir** , entrez `cmd` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-235">In the **Open** box, enter `cmd`, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="b399a-236">Dans le répertoire spécifié à l'étape 6b, exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="b399a-236">In the directory that you specified in step 6b, execute the following command:</span></span>  
  
         `regsvr32 replisapi.dll`  
  
## <a name="manually-configuring-the-computer-that-is-running-iis"></a><span data-ttu-id="b399a-237">Configuration manuelle de l'ordinateur exécutant IIS</span><span class="sxs-lookup"><span data-stu-id="b399a-237">Manually Configuring the Computer That Is Running IIS</span></span>  
 <span data-ttu-id="b399a-238">Pour configurer manuellement l'ordinateur exécutant IIS, vous devez installer et configurer l'écouteur de réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , puis configurer l'autorisation pour les Abonnés qui vont se connecter à IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-238">To configure the computer that is running IIS manually, you must install and configure the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener, and then configure authorization for Subscribers that will connect to IIS.</span></span>  
  
#### <a name="to-install-and-configure-the-sql-server-replication-listener"></a><span data-ttu-id="b399a-239">Pour installer et configurer l'écouteur de réplication SQL Server</span><span class="sxs-lookup"><span data-stu-id="b399a-239">To install and configure the SQL Server Replication Listener</span></span>  
  
1.  <span data-ttu-id="b399a-240">Créez un répertoire de fichiers sur l'ordinateur exécutant IIS pour y placer le fichier replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="b399a-240">Create a file directory on the computer that is running IIS to contain replisapi.dll.</span></span> <span data-ttu-id="b399a-241">Vous pouvez créer le répertoire où vous le souhaitez, mais il est recommandé de le créer sous le répertoire \<*drive*>:\Inetpub.</span><span class="sxs-lookup"><span data-stu-id="b399a-241">You can create the directory wherever you want, but we recommend that you create the directory under the \<*drive*>:\Inetpub directory.</span></span> <span data-ttu-id="b399a-242">Par exemple, créez le répertoire \<*drive*>:\Inetpub\SQLReplication\\.</span><span class="sxs-lookup"><span data-stu-id="b399a-242">For example, create the directory \<*drive*>:\Inetpub\SQLReplication\\.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="b399a-243">Il est vivement recommandé de créer ce répertoire sur une partition de système de fichiers NTFS plutôt que FAT.</span><span class="sxs-lookup"><span data-stu-id="b399a-243">We strongly recommend that you create this directory on an NTFS file system partition instead of a FAT file system.</span></span> <span data-ttu-id="b399a-244">Quand vous utilisez le système de fichiers NTFS, vous pouvez vous servir des autorisations du système de fichiers NTFS pour contrôler avec précision les utilisateurs en mesure d'accéder à la réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b399a-244">When you use the NTFS file system, you can use NTFS file system permissions to control precisely the users that can access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span>  
  
2.  <span data-ttu-id="b399a-245">Copiez replisapi.dll à partir du répertoire [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ vers le répertoire de fichiers que vous avez créé à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="b399a-245">Copy replisapi.dll from the directory [!INCLUDE[ssInstallPathVar](../../includes/ssinstallpathvar-md.md)]com\ to the file directory that you created in step 1.</span></span>  
  
3.  <span data-ttu-id="b399a-246">Inscrivez replisapi.dll :</span><span class="sxs-lookup"><span data-stu-id="b399a-246">Register replisapi.dll:</span></span>  
  
    1.  <span data-ttu-id="b399a-247">Cliquez sur **Démarrer**, puis sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-247">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="b399a-248">Dans la zone **ouvrir** , entrez `cmd` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-248">In the **Open** box, enter `cmd`, and then click **OK**.</span></span>  
  
    2.  <span data-ttu-id="b399a-249">Dans le répertoire créé à l'étape 1, exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="b399a-249">In the directory that you created in step 1, execute the following command:</span></span>  
  
         `regsvr32 replisapi.dll`  
  
4.  <span data-ttu-id="b399a-250">Créez un nouveau site Web pour la réplication ou bien utilisez un site Web existant.</span><span class="sxs-lookup"><span data-stu-id="b399a-250">Create a new Web site for replication, or use an existing site.</span></span> <span data-ttu-id="b399a-251">Les composants de la réplication accèdent au site Web au cours de la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="b399a-251">The Web site will be accessed by replication components during synchronization.</span></span> <span data-ttu-id="b399a-252">Pour plus d'informations sur la création de sites Web, consultez la documentation de IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-252">For more information about how to create Web sites, see the IIS documentation.</span></span>  
  
5.  <span data-ttu-id="b399a-253">Créez un répertoire virtuel dans IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-253">Create a virtual directory in IIS.</span></span> <span data-ttu-id="b399a-254">Le répertoire virtuel doit être créé sous le site Web créé à l'étape 4 et doit être mappé au répertoire créé à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="b399a-254">The virtual directory should be created under the Web site that was created in step 4, and should be mapped to the directory that was created in step 1.</span></span> <span data-ttu-id="b399a-255">Pour plus d'informations sur la création de répertoires virtuels, consultez la documentation IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-255">For more information about how to create virtual directories, see the IIS documentation.</span></span> <span data-ttu-id="b399a-256">Il est recommandé d'être aussi restrictif que possible lors de l'attribution des autorisations sur ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="b399a-256">We recommend that you be as restrictive as possible when you assign permissions to this directory.</span></span> <span data-ttu-id="b399a-257">Vous devez sélectionner les autorisations **Lire** et **Exécuter** , mais vous pouvez désactiver les autorisations **Exécuter les scripts**, **Écrire**et **Parcourir** .</span><span class="sxs-lookup"><span data-stu-id="b399a-257">You must select **Read** and **Execute** permissions, but you can clear **Run scripts**, **Write**, and **Browse** permissions.</span></span>  
  
6.  <span data-ttu-id="b399a-258">Configurez IIS pour permettre à replisapi.dll de s'exécuter.</span><span class="sxs-lookup"><span data-stu-id="b399a-258">Configure IIS to enable replisapi.dll to execute.</span></span> <span data-ttu-id="b399a-259">Les autorisations attribuées à l'étape 4 sont suffisantes pour les versions antérieures de IIS, mais IIS 6.0 requiert l'activation des extensions ISAPI (Internet Server API).</span><span class="sxs-lookup"><span data-stu-id="b399a-259">The permissions that are assigned in step 4 are sufficient for earlier versions of IIS; however, IIS version 6.0 requires Internet Server API (ISAPI) extensions to be enabled.</span></span> <span data-ttu-id="b399a-260">Pour plus d'informations, consultez « Configuring ISAPI Extensions » et « Enabling and Disabling Dynamic Content » dans la documentation de IIS 6.0.</span><span class="sxs-lookup"><span data-stu-id="b399a-260">For more information, see "Configuring ISAPI Extensions" and "Enabling and Disabling Dynamic Content" in the IIS 6.0 documentation.</span></span>  
  
#### <a name="to-configure-iis-authentication"></a><span data-ttu-id="b399a-261">Pour configurer l'authentification IIS</span><span class="sxs-lookup"><span data-stu-id="b399a-261">To configure IIS authentication</span></span>  
  
-   <span data-ttu-id="b399a-262">Quand des Abonnés se connectent à IIS, IIS doit les authentifier avant qu'ils puissent accéder aux ressources et aux processus.</span><span class="sxs-lookup"><span data-stu-id="b399a-262">When Subscribers connect to IIS, IIS must authenticate the Subscribers before they can access resources and processes.</span></span> <span data-ttu-id="b399a-263">IIS offre trois types d'authentification : anonyme, de base et intégrée.</span><span class="sxs-lookup"><span data-stu-id="b399a-263">IIS offers three types of authentication: Anonymous, Basic, and Integrated.</span></span> <span data-ttu-id="b399a-264">L'authentification peut être appliquée au site Web tout entier ou au répertoire virtuel que vous avez créé.</span><span class="sxs-lookup"><span data-stu-id="b399a-264">Authentication can be applied to the whole Web site or to the virtual directory that you created.</span></span>  
  
     <span data-ttu-id="b399a-265">Nous vous recommandons d'utiliser l'authentification de base avec SSL.</span><span class="sxs-lookup"><span data-stu-id="b399a-265">We recommend that you use Basic Authentication with SSL.</span></span> <span data-ttu-id="b399a-266">SSL est nécessaire quel que soit le type d'authentification utilisé.</span><span class="sxs-lookup"><span data-stu-id="b399a-266">SSL is required, regardless of the type of authentication that is used.</span></span> <span data-ttu-id="b399a-267">Pour plus d'informations sur la configuration de l'authentification, consultez la documentation de IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-267">For more information about how to configure authentication, see the IIS documentation.</span></span>  
  
## <a name="setting-permissions-for-the-sql-server-replication-listener"></a><span data-ttu-id="b399a-268">Définition des autorisations pour l'écouteur de réplication SQL Server</span><span class="sxs-lookup"><span data-stu-id="b399a-268">Setting Permissions for the SQL Server Replication Listener</span></span>  
 <span data-ttu-id="b399a-269">Lorsqu'un Abonné se connecte à l'ordinateur exécutant IIS, il est authentifié à l'aide du type d'authentification spécifié lors de la configuration de IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-269">When a Subscriber connects to the computer that is running IIS, the Subscriber is authenticated by using the type of authentication that was specified when you configured IIS.</span></span> <span data-ttu-id="b399a-270">Après avoir authentifié l'Abonné, IIS vérifie que l'Abonné est autorisé à appeler la réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b399a-270">After IIS authenticates the Subscriber, IIS checks whether the Subscriber is authorized to invoke [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="b399a-271">Vous contrôlez les utilisateurs en mesure d'appeler la réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en définissant des autorisations pour replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="b399a-271">You control the users that can invoke [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication by setting permissions for replisapi.dll.</span></span> <span data-ttu-id="b399a-272">La configuration correcte des autorisations est cruciale pour empêcher les accès non autorisés à la réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b399a-272">Properly configuring permissions is necessary to prevent unauthorized access to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] replication.</span></span>  
  
 <span data-ttu-id="b399a-273">Pour configurer les autorisations minimales du compte sous lequel est exécuté l'écouteur de réplication [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , suivez la procédure ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="b399a-273">To configure the minimum permissions for the account under which the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Replication Listener runs, complete the following procedure.</span></span> <span data-ttu-id="b399a-274">Les étapes de la procédure s’appliquent à l' [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] exécution d’IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="b399a-274">The steps in the procedure apply to [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[winxpsvr](../../includes/winxpsvr-md.md)] running IIS 6.0.</span></span>  
  
 <span data-ttu-id="b399a-275">En plus de suivre les étapes ci-dessous, vérifiez que les noms de connexion requis se trouvent dans la liste d'accès à la publication (PAL, Publication Access List).</span><span class="sxs-lookup"><span data-stu-id="b399a-275">In addition to performing the following steps, make sure that the required logins are in the publication access list (PAL).</span></span> <span data-ttu-id="b399a-276">Pour plus d’informations sur la liste d’accès à la publication, consultez [Sécuriser le serveur de publication](security/secure-the-publisher.md).</span><span class="sxs-lookup"><span data-stu-id="b399a-276">For more information about the PAL, see [Secure the Publisher](security/secure-the-publisher.md).</span></span>  
  
#### <a name="to-configure-the-account-and-permissions"></a><span data-ttu-id="b399a-277">Pour configurer le compte et les autorisations</span><span class="sxs-lookup"><span data-stu-id="b399a-277">To configure the account and permissions</span></span>  
  
1.  <span data-ttu-id="b399a-278">Créez un compte local sur l'ordinateur exécutant IIS :</span><span class="sxs-lookup"><span data-stu-id="b399a-278">Create a local account on the computer that is running IIS:</span></span>  
  
    1.  <span data-ttu-id="b399a-279">Cliquez avec le bouton droit sur **Poste de travail** et cliquez sur **Gérer**.</span><span class="sxs-lookup"><span data-stu-id="b399a-279">Right-click **My Computer**, and then click **Manage**.</span></span>  
  
    2.  <span data-ttu-id="b399a-280">Dans **Gestion de l'ordinateur**, développez **Utilisateurs et groupes locaux**.</span><span class="sxs-lookup"><span data-stu-id="b399a-280">In **Computer Management**, expand **Local Users and Groups**.</span></span>  
  
    3.  <span data-ttu-id="b399a-281">Cliquez avec le bouton droit sur **Utilisateurs**, puis cliquez sur **Nouvel utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="b399a-281">Right-click **Users**, and then click **New User**.</span></span>  
  
    4.  <span data-ttu-id="b399a-282">Entrez un nom d'utilisateur et un mot de passe fort.</span><span class="sxs-lookup"><span data-stu-id="b399a-282">Enter a user name and a strong password.</span></span>  
  
    5.  <span data-ttu-id="b399a-283">Cliquez sur **Créer**, puis sur **Fermer**.</span><span class="sxs-lookup"><span data-stu-id="b399a-283">Click **Create**, and then click **Close**.</span></span>  
  
2.  <span data-ttu-id="b399a-284">Ajoutez le compte au groupe IIS_WPG :</span><span class="sxs-lookup"><span data-stu-id="b399a-284">Add the account to the IIS_WPG group:</span></span>  
  
    1.  <span data-ttu-id="b399a-285">Dans **Gestion de l'ordinateur**, développez **Utilisateurs et groupes locaux**puis cliquez sur **Groupes**.</span><span class="sxs-lookup"><span data-stu-id="b399a-285">In **Computer Management**, expand **Local Users and Groups**, and then click **Groups**.</span></span>  
  
    2.  <span data-ttu-id="b399a-286">Cliquez avec le bouton droit sur **IIS_WPG**, puis cliquez sur **Ajouter au groupe**.</span><span class="sxs-lookup"><span data-stu-id="b399a-286">Right-click **IIS_WPG**, and then click **Add to Group**.</span></span>  
  
    3.  <span data-ttu-id="b399a-287">Dans la boîte de dialogue **Propriétés de IIS_WPG** , cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-287">In the **IIS_WPG Properties** dialog box, click **Add**.</span></span>  
  
    4.  <span data-ttu-id="b399a-288">Dans la boîte de dialogue **Choisir des utilisateurs, des ordinateurs ou des groupes** , ajoutez le compte créé à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="b399a-288">In the **Select Users, Computers, or Groups** dialog box, add the account created in step 1.</span></span>  
  
    5.  <span data-ttu-id="b399a-289">Vérifiez que le nom figurant dans le champ **À partir de cet emplacement** est celui de l'ordinateur local et non pas un nom de domaine.</span><span class="sxs-lookup"><span data-stu-id="b399a-289">Make sure that the name in the **From this location** field is the name of the local computer instead of a domain.</span></span> <span data-ttu-id="b399a-290">Si le nom n'est pas un ordinateur local, cliquez sur **Emplacements**.</span><span class="sxs-lookup"><span data-stu-id="b399a-290">If the name is not a local computer, click **Locations**.</span></span> <span data-ttu-id="b399a-291">Dans la boîte de dialogue **Emplacements** , choisissez l'ordinateur local, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-291">In the **Locations** dialog box, elect the local computer, and then click **OK**.</span></span>  
  
    6.  <span data-ttu-id="b399a-292">Dans les boîtes de dialogue **Choisir des utilisateurs** et **Propriétés de IIS_WPG** , cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-292">In the **Select Users** dialog box and the **IIS_WPG Properties** dialog box, click **OK**.</span></span>  
  
3.  <span data-ttu-id="b399a-293">Attribuez au compte les autorisations minimales sur le dossier qui contient replisapi.dll :</span><span class="sxs-lookup"><span data-stu-id="b399a-293">Grant the minimum permissions on the folder that contains replisapi.dll to the account :</span></span>  
  
    1.  <span data-ttu-id="b399a-294">Recherchez le dossier créé pour replisapi.dll, cliquez avec le bouton droit sur le dossier, puis cliquez sur **Partage et sécurité**.</span><span class="sxs-lookup"><span data-stu-id="b399a-294">Locate the folder that you created for replisapi.dll, right-click the folder, and then click **Sharing and Security**.</span></span>  
  
    2.  <span data-ttu-id="b399a-295">Sous l’onglet **Sécurité**, cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-295">On the **Security** tab, click **Add**.</span></span>  
  
    3.  <span data-ttu-id="b399a-296">Dans la boîte de dialogue **Choisir des utilisateurs, des ordinateurs ou des groupes** , ajoutez le compte créé à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="b399a-296">In the **Select Users, Computers, or Groups** dialog box, add the account that you created in step 1.</span></span>  
  
    4.  <span data-ttu-id="b399a-297">Vérifiez que le nom figurant dans le champ **À partir de cet emplacement** est celui de l'ordinateur local et non pas un nom de domaine.</span><span class="sxs-lookup"><span data-stu-id="b399a-297">Make sure that the name in the **From this location** field is the name of the local computer instead of a domain.</span></span> <span data-ttu-id="b399a-298">Si le nom n'est pas un ordinateur local, cliquez sur **Emplacements**.</span><span class="sxs-lookup"><span data-stu-id="b399a-298">If the name is not a local computer, click **Locations**.</span></span> <span data-ttu-id="b399a-299">Dans la boîte de dialogue **Emplacements** , choisissez l'ordinateur local, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-299">In the **Locations** dialog box, select the local computer, and then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="b399a-300">Vérifiez que le compte a seulement les autorisations suivantes : **Lecture**, **Lecture et exécution** et **Affichage du contenu du dossier**.</span><span class="sxs-lookup"><span data-stu-id="b399a-300">Make sure that the account is granted only **Read**, **Read & Execute**, and **List Folder Contents** permissions.</span></span>  
  
    6.  <span data-ttu-id="b399a-301">Sélectionnez tous les utilisateurs ou groupes qui ne requièrent pas l'accès au répertoire, puis cliquez sur **Supprimer**.</span><span class="sxs-lookup"><span data-stu-id="b399a-301">Select any users or groups that do not require access to the directory, and then click **Remove**.</span></span>  
  
    7.  <span data-ttu-id="b399a-302">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-302">Click **OK**.</span></span>  
  
4.  <span data-ttu-id="b399a-303">Créez un pool d'applications dans **Gestionnaire des services Internet (IIS)** :</span><span class="sxs-lookup"><span data-stu-id="b399a-303">Create an application pool in **Internet Information Services (IIS) Manager**:</span></span>  
  
    1.  <span data-ttu-id="b399a-304">Cliquez sur **Démarrer**, puis sur **Exécuter**.</span><span class="sxs-lookup"><span data-stu-id="b399a-304">Click **Start**, and then click **Run**.</span></span>  
  
    2.  <span data-ttu-id="b399a-305">Dans la zone **ouvrir** , tapez `inetmgr` , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-305">In the **Open** box, type `inetmgr`, and then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="b399a-306">Dans **Gestionnaire des services Internet (IIS)**, développez le nœud **ordinateur local** .</span><span class="sxs-lookup"><span data-stu-id="b399a-306">In **Internet Information Services (IIS) Manager**, expand the **local computer** node.</span></span>  
  
    4.  <span data-ttu-id="b399a-307">Cliquez avec le bouton droit sur **Pools d'applications**, pointez sur **Nouveau** puis cliquez sur **Pool d'applications**.</span><span class="sxs-lookup"><span data-stu-id="b399a-307">Right-click **Application Pools**, point to **New** and then click **Application Pool**.</span></span>  
  
    5.  <span data-ttu-id="b399a-308">Entrez le nom du pool dans le champ **ID du pool d'applications** , puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-308">Enter a name for the pool in the **Application pool ID** field, and then click **OK**.</span></span>  
  
5.  <span data-ttu-id="b399a-309">Associez le compte au pool d'applications :</span><span class="sxs-lookup"><span data-stu-id="b399a-309">Associate the account with the application pool:</span></span>  
  
    1.  <span data-ttu-id="b399a-310">Dans **Gestionnaire des services Internet (IIS)**, développez le nœud **ordinateur local** , puis développez **Pools d'applications**.</span><span class="sxs-lookup"><span data-stu-id="b399a-310">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand **Application Pools**.</span></span>  
  
    2.  <span data-ttu-id="b399a-311">Cliquez avec le bouton droit sur le pool d'applications que vous avez créé, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="b399a-311">Right-click the application pool that you created, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="b399a-312">Dans la boîte de dialogue \*\* \<ApplicationPoolName> Propriétés\*\* , sous l’onglet **identité** , cliquez sur **configurable**.</span><span class="sxs-lookup"><span data-stu-id="b399a-312">In the **\<ApplicationPoolName> Properties** dialog box, on the **Identity** tab, click **Configurable**.</span></span>  
  
    4.  <span data-ttu-id="b399a-313">Dans les champs **Nom d'utilisateur** et **Mot de passe** , entrez le compte et le mot de passe créés à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="b399a-313">In the **User name** and **password** fields, enter the account and password that were created in step 1.</span></span>  
  
    5.  <span data-ttu-id="b399a-314">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-314">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="b399a-315">Associez le pool d'applications au répertoire virtuel utilisé pour la synchronisation Web :</span><span class="sxs-lookup"><span data-stu-id="b399a-315">Associate the application pool with the virtual directory that is used for Web synchronization:</span></span>  
  
    1.  <span data-ttu-id="b399a-316">Dans **Gestionnaire des services Internet (IIS)**, développez le nœud **ordinateur local** , puis développez **Sites Web**.</span><span class="sxs-lookup"><span data-stu-id="b399a-316">In **Internet Information Services (IIS) Manager**, expand the **local computer** node, and then expand **Web Sites**.</span></span>  
  
    2.  <span data-ttu-id="b399a-317">Développez le site Web que vous utilisez pour la synchronisation Web, cliquez avec le bouton droit sur le répertoire virtuel que vous avez créé pour la synchronisation Web, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="b399a-317">Expand the Web site that you are using for Web synchronization, right-click the virtual directory that you created for Web synchronization, and then click **Properties**.</span></span>  
  
    3.  <span data-ttu-id="b399a-318">Sous l’onglet **répertoire virtuel** de la boîte de dialogue \*\* \<VirtualDirectoryName> Propriétés\*\* , dans la liste déroulante **pool d’applications** , sélectionnez le pool d’applications créé à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="b399a-318">On the **Virtual Directory** tab of the **\<VirtualDirectoryName> Properties** dialog box, from the **Application pool** drop-down list, select the application pool that was created in step 5.</span></span>  
  
    4.  <span data-ttu-id="b399a-319">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-319">Click **OK**.</span></span>  
  
## <a name="testing-the-connection-to-replisapidll"></a><span data-ttu-id="b399a-320">Test de la connexion à replisapi.dll</span><span class="sxs-lookup"><span data-stu-id="b399a-320">Testing the Connection to replisapi.dll</span></span>  
 <span data-ttu-id="b399a-321">Exécutez la synchronisation Web en mode de diagnostic pour tester la connexion à l'ordinateur exécutant IIS et pour vérifier que le certificat SSL (Secure Sockets Layer) est correctement installé.</span><span class="sxs-lookup"><span data-stu-id="b399a-321">Run Web synchronization in diagnostic mode to test the connection to the computer that is running IIS and to make sure that the Secure Sockets Layer (SSL) certificate is properly installed.</span></span> <span data-ttu-id="b399a-322">Pour exécuter la synchronisation Web en mode de diagnostic, vous devez avoir la qualité d'administrateur sur l'ordinateur qui exécute les services Internet (IIS).</span><span class="sxs-lookup"><span data-stu-id="b399a-322">To run Web synchronization in diagnostic mode, you must be an administrator on the computer running IIS.</span></span>  
  
#### <a name="to-test-the-connection-to-replisapidll"></a><span data-ttu-id="b399a-323">Pour tester la connexion à replisapi.dll</span><span class="sxs-lookup"><span data-stu-id="b399a-323">To test the connection to replisapi.dll</span></span>  
  
1.  <span data-ttu-id="b399a-324">Vérifiez que les paramètres du réseau local (LAN) sur l'Abonné sont corrects :</span><span class="sxs-lookup"><span data-stu-id="b399a-324">Make sure that local area network (LAN) settings at the Subscriber are correct:</span></span>  
  
    1.  <span data-ttu-id="b399a-325">Dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer, dans le menu **Outils** , cliquez sur **Options Internet**.</span><span class="sxs-lookup"><span data-stu-id="b399a-325">In [!INCLUDE[msCoName](../../includes/msconame-md.md)] Internet Explorer, on the **Tools** menu, click **Internet Options**.</span></span>  
  
    2.  <span data-ttu-id="b399a-326">Sur l'onglet **Connexions** , cliquez sur **Paramètres LAN**.</span><span class="sxs-lookup"><span data-stu-id="b399a-326">On the **Connections** tab, click **LAN Settings**.</span></span>  
  
    3.  <span data-ttu-id="b399a-327">S'il n'y a pas de serveur proxy utilisé sur le réseau local, désactivez **Détecter automatiquement les paramètres de connexion** et **Utiliser un serveur proxy pour votre réseau local**.</span><span class="sxs-lookup"><span data-stu-id="b399a-327">If a proxy server is not used on the LAN, clear **Automatically Detect Settings** and **Use a proxy server for your LAN**.</span></span>  
  
    4.  <span data-ttu-id="b399a-328">Si un serveur proxy est utilisé, activez **Utiliser un serveur proxy pour votre réseau local** et **Ne pas utiliser de serveur proxy pour les adresses locales**.</span><span class="sxs-lookup"><span data-stu-id="b399a-328">If a proxy server is used, select **Use a proxy server for your LAN** and **Bypass proxy server for local addresses**.</span></span>  
  
    5.  <span data-ttu-id="b399a-329">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-329">Click **OK**.</span></span>  
  
2.  <span data-ttu-id="b399a-330">Sur l'Abonné, dans Internet Explorer, connectez-vous au serveur en mode de diagnostic en ajoutant `?diag` à l'adresse pour le fichier replisapi.dll.</span><span class="sxs-lookup"><span data-stu-id="b399a-330">At the Subscriber, in Internet Explorer, connect to the server in diagnostic mode by appending `?diag` to the address for the replisapi.dll.</span></span> <span data-ttu-id="b399a-331">Par exemple : `https://server.domain.com/directory/replisapi.dll?diag`.</span><span class="sxs-lookup"><span data-stu-id="b399a-331">For example: `https://server.domain.com/directory/replisapi.dll?diag`.</span></span>  
  
3.  <span data-ttu-id="b399a-332">Si le certificat spécifié pour IIS n'est pas reconnu par le système d'exploitation Windows, la boîte de dialogue **Alerte de sécurité** s'affiche.</span><span class="sxs-lookup"><span data-stu-id="b399a-332">If the certificate that you specified for IIS is not recognized by the Windows operating system, the **Security Alert** dialog box appears.</span></span> <span data-ttu-id="b399a-333">Cette alerte peut se produire si le certificat est un certificat de test ou si le certificat a été émis par une Autorité de certification non reconnue par Windows.</span><span class="sxs-lookup"><span data-stu-id="b399a-333">This alert might occur because the certificate is a test certificate or the certificate was issued by a certification authority (CA) that Windows does not recognize.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b399a-334">Si cette boîte de dialogue ne s'affiche pas, vérifiez que le certificat pour le serveur auquel vous accédez a été ajouté au magasin de certificats sur l'Abonné en tant que certificat approuvé.</span><span class="sxs-lookup"><span data-stu-id="b399a-334">If this dialog box does not appear, make sure that the certificate for the server that you are accessing has been added to the certificate store at the Subscriber as a trusted certificate.</span></span> <span data-ttu-id="b399a-335">Pour plus d'informations sur l'exportation de certificats, consultez la documentation d'IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-335">For more information about exporting certificates, see the IIS documentation.</span></span>  
  
    1.  <span data-ttu-id="b399a-336">Dans la boîte de dialogue **Alerte de sécurité** , cliquez sur **Afficher le certificat**.</span><span class="sxs-lookup"><span data-stu-id="b399a-336">In the **Security Alert** dialog box, click **View Certificate**.</span></span>  
  
    2.  <span data-ttu-id="b399a-337">Dans la boîte de dialogue **Certificat** , sur l'onglet **Général** , cliquez sur **Installer le certificat**.</span><span class="sxs-lookup"><span data-stu-id="b399a-337">In the **Certificate** dialog box, on the **General** tab, click **Install Certificate**.</span></span>  
  
    3.  <span data-ttu-id="b399a-338">Terminez l'Assistant Importation de certificat, en acceptant les valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="b399a-338">Complete the Certificate Import Wizard, accepting the defaults.</span></span>  
  
    4.  <span data-ttu-id="b399a-339">Dans la boîte de dialogue **Avertissement de sécurité** , cliquez sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="b399a-339">In the **Security Warning** dialog box, click **Yes**.</span></span>  
  
    5.  <span data-ttu-id="b399a-340">Dans la boîte de dialogue de confirmation de l'Assistant Importation de certificat, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="b399a-340">In the Certificate Import Wizard confirmation dialog box, click **OK**.</span></span>  
  
    6.  <span data-ttu-id="b399a-341">Fermez la boîte de dialogue **Certificat** .</span><span class="sxs-lookup"><span data-stu-id="b399a-341">Close the **Certificate** dialog box.</span></span>  
  
    7.  <span data-ttu-id="b399a-342">Dans la boîte de dialogue **Alerte de sécurité** , cliquez sur **Oui**.</span><span class="sxs-lookup"><span data-stu-id="b399a-342">In the **Security Alert** dialog box, click **Yes**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b399a-343">Les certificats sont installés pour les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="b399a-343">Certificates are installed for users.</span></span> <span data-ttu-id="b399a-344">Ce processus doit être effectué pour chaque utilisateur qui réalisera des synchronisations avec IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-344">This process must be performed for each user that will synchronize with IIS.</span></span>  
  
4.  <span data-ttu-id="b399a-345">Dans la boîte de dialogue **Se connecter à\<ServerName>** , spécifiez la connexion et le mot de passe que l’'Agent de fusion va utiliser pour se connecter à IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-345">In the **Connect to \<ServerName>** dialog box, specify the login and password that the Merge Agent will use to connect to IIS.</span></span> <span data-ttu-id="b399a-346">Ces informations d'identification seront aussi spécifiées dans l'Assistant Nouvel abonnement.</span><span class="sxs-lookup"><span data-stu-id="b399a-346">These credentials will also be specified in the New Subscription Wizard.</span></span>  
  
5.  <span data-ttu-id="b399a-347">Dans la fenêtre Internet Explorer relative aux **informations de diagnostic SQL Websync**, vérifiez que la valeur de chaque colonne **État** de la page est **RÉUSSITE**.</span><span class="sxs-lookup"><span data-stu-id="b399a-347">In the Internet Explorer window called **SQL Websync diagnostic information**, verify that the value in each **Status** column on the page is **SUCCESS**.</span></span>  
  
6.  <span data-ttu-id="b399a-348">Vérifiez que le certificat est installé correctement sur l'Abonné :</span><span class="sxs-lookup"><span data-stu-id="b399a-348">Make sure that the certificate is installed correctly on the Subscriber:</span></span>  
  
    1.  <span data-ttu-id="b399a-349">Fermez, puis rouvrez Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="b399a-349">Close and then reopen Internet Explorer.</span></span>  
  
    2.  <span data-ttu-id="b399a-350">Connectez-vous au serveur en mode de diagnostic.</span><span class="sxs-lookup"><span data-stu-id="b399a-350">Connect to the server in diagnostic mode.</span></span> <span data-ttu-id="b399a-351">Si le certificat est installé correctement, la boîte de dialogue **Alerte de sécurité** ne s'affiche pas.</span><span class="sxs-lookup"><span data-stu-id="b399a-351">If the certificate is installed properly, the **Security Alert** dialog box will not appear.</span></span> <span data-ttu-id="b399a-352">Si cette boîte de dialogue s'affiche, l'Agent de fusion échoue quand il tente de se connecter à l'ordinateur exécutant IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-352">If the dialog box appears, the Merge Agent will fail when it tries to connect to the computer that is running IIS.</span></span> <span data-ttu-id="b399a-353">Vous devez vérifier que le certificat pour le serveur auquel vous accédez a été ajouté au magasin de certificats sur l'Abonné en tant que certificat approuvé.</span><span class="sxs-lookup"><span data-stu-id="b399a-353">You must make sure that the certificate for the server that you are accessing has been added to the certificate store at the Subscriber as a trusted certificate.</span></span> <span data-ttu-id="b399a-354">Pour plus d'informations sur l'exportation de certificats, consultez la documentation d'IIS.</span><span class="sxs-lookup"><span data-stu-id="b399a-354">For more information about exporting certificates, see the IIS documentation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b399a-355">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b399a-355">See Also</span></span>  
 [<span data-ttu-id="b399a-356">Configurer la synchronisation web</span><span class="sxs-lookup"><span data-stu-id="b399a-356">Configure Web Synchronization</span></span>](configure-web-synchronization.md)  
  
  
