---
title: Implémenter un outil personnalisé de résolution des conflits pour un article de fusion | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
dev_langs:
- TSQL
helpviewer_keywords:
- merge replication conflict resolution [SQL Server replication], stored procedure-based resolvers
- articles [SQL Server replication], conflict resolution
- conflict resolution [SQL Server replication], merge replication
ms.assetid: 76bd8524-ebc1-4d80-b5a2-4169944d6ac0
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 23e684213114f3c9bb2f1ad56de06fcfc89b819a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87601333"
---
# <a name="implement-a-custom-conflict-resolver-for-a-merge-article"></a><span data-ttu-id="14c26-102">Implémenter un outil personnalisé de résolution des conflits pour un article de fusion</span><span class="sxs-lookup"><span data-stu-id="14c26-102">Implement a Custom Conflict Resolver for a Merge Article</span></span>
  <span data-ttu-id="14c26-103"> Cette rubrique décrit comment implémenter l’outil personnalisé de résolution des conflits pour un article de fusion dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] à l’aide de [!INCLUDE[tsql](../../includes/tsql-md.md)] ou du [programme de résolution personnalisé COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span><span class="sxs-lookup"><span data-stu-id="14c26-103">This topic describes how to implement custom conflict resolver for a merge article in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[tsql](../../includes/tsql-md.md)] or a [COM-based custom resolver](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md).</span></span>  
  
 <span data-ttu-id="14c26-104">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="14c26-104">**In This Topic**</span></span>  
  
-   <span data-ttu-id="14c26-105">**Pour implémenter l'outil personnalisé de résolution des conflits pour un article de fusion à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="14c26-105">**To implement custom conflict resolver for a merge article, using:**</span></span>  
  
     [<span data-ttu-id="14c26-106">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="14c26-106">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="14c26-107">Programme de résolution s'appuyant sur l'architecture COM.</span><span class="sxs-lookup"><span data-stu-id="14c26-107">COM-based Resolver</span></span>](#COM)  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="14c26-108">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="14c26-108">Using Transact-SQL</span></span>  
 <span data-ttu-id="14c26-109">Vous pouvez écrire votre propre outil personnalisé de résolution des conflits sous forme de procédure stockée [!INCLUDE[tsql](../../includes/tsql-md.md)] au niveau de chaque serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="14c26-109">You can write your own custom conflict resolver as a [!INCLUDE[tsql](../../includes/tsql-md.md)] stored procedure at each Publisher.</span></span> <span data-ttu-id="14c26-110">Au cours de la synchronisation, cette procédure stockée est appelée en cas de conflits dans un article pour lequel ce programme de résolution a été enregistré, et les informations sur la ligne en conflit sont passées par l'Agent de fusion aux paramètres requis de la procédure.</span><span class="sxs-lookup"><span data-stu-id="14c26-110">During synchronization, this stored procedure is invoked when conflicts are encountered in an article to which the resolver was registered, and information on the conflict row is passed by the Merge Agent to the required parameters of the procedure.</span></span> <span data-ttu-id="14c26-111">Les outils personnalisés de résolution des conflits s'appuyant sur des procédures stockées sont toujours créés au niveau du serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="14c26-111">Stored procedure-based custom conflict resolvers are always created at the Publisher.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[msCoName](../../includes/msconame-md.md)]<span data-ttu-id="14c26-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]les programmes de résolution de procédures stockées sont appelés uniquement pour gérer les conflits de changement de ligne.</span><span class="sxs-lookup"><span data-stu-id="14c26-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] stored procedure resolvers are only invoked to handle row change-based conflicts.</span></span> <span data-ttu-id="14c26-113">Ils ne peuvent pas être utilisés pour gérer d'autres types de conflits, comme les échecs d'insertion en raison de violations de clés primaires ou de violations de contraintes d'index unique.</span><span class="sxs-lookup"><span data-stu-id="14c26-113">They cannot be used to handle other types of conflicts such as insert failures due to PRIMARY KEY violations or unique index constraint violations.</span></span>  
  
#### <a name="to-create-a-stored-procedure-based-custom-conflict-resolver"></a><span data-ttu-id="14c26-114">Pour créer un outil personnalisé de résolution des conflits s'appuyant sur des procédures stockées</span><span class="sxs-lookup"><span data-stu-id="14c26-114">To create a stored procedure-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="14c26-115">Dans la base de données de publication ou la base de données **msdb** sur le serveur de publication, créez une procédure stockée système qui implémente les paramètres requis suivants :</span><span class="sxs-lookup"><span data-stu-id="14c26-115">At the Publisher in either the publication or **msdb** database, create a new system stored procedure that implements the following required parameters:</span></span>  
  
    |<span data-ttu-id="14c26-116">Paramètre</span><span class="sxs-lookup"><span data-stu-id="14c26-116">Parameter</span></span>|<span data-ttu-id="14c26-117">Type de données</span><span class="sxs-lookup"><span data-stu-id="14c26-117">Data type</span></span>|<span data-ttu-id="14c26-118">Description</span><span class="sxs-lookup"><span data-stu-id="14c26-118">Description</span></span>|  
    |---------------|---------------|-----------------|  
    |**@tableowner**|`sysname`|<span data-ttu-id="14c26-119">Nom du propriétaire de la table pour laquelle un conflit est résolu.</span><span class="sxs-lookup"><span data-stu-id="14c26-119">Name of the owner of the table for which a conflict is being resolved.</span></span> <span data-ttu-id="14c26-120">Il s'agit du propriétaire de la table dans la base de données de publication.</span><span class="sxs-lookup"><span data-stu-id="14c26-120">This is the owner for the table in the publication database.</span></span>|  
    |**@tablename**|`sysname`|<span data-ttu-id="14c26-121">Nom de la table pour laquelle un conflit est résolu.</span><span class="sxs-lookup"><span data-stu-id="14c26-121">Name of the table for which a conflict is being resolved.</span></span>|  
    |**@rowguid**|`uniqueidentifier`|<span data-ttu-id="14c26-122">Identificateur unique de la ligne en conflit.</span><span class="sxs-lookup"><span data-stu-id="14c26-122">Unique identifier for the row having the conflict.</span></span>|  
    |**@subscriber**|`sysname`|<span data-ttu-id="14c26-123">Nom du serveur depuis lequel une modification en conflit est propagée.</span><span class="sxs-lookup"><span data-stu-id="14c26-123">Name of the server from where a conflicting change is being propagated.</span></span>|  
    |**@subscriber_db**|`sysname`|<span data-ttu-id="14c26-124">Nom de la base de données depuis laquelle la modification en conflit est propagée.</span><span class="sxs-lookup"><span data-stu-id="14c26-124">Name of the database from where conflicting change is being propagated.</span></span>|  
    |<span data-ttu-id="14c26-125">**@log_conflictSORTIE**</span><span class="sxs-lookup"><span data-stu-id="14c26-125">**@log_conflict OUTPUT**</span></span>|`int`|<span data-ttu-id="14c26-126">Indique si le processus de fusion doit enregistrer un conflit en vue de le résoudre ultérieurement :</span><span class="sxs-lookup"><span data-stu-id="14c26-126">Whether the merge process should log a conflict for later resolution:</span></span><br /><br /> <span data-ttu-id="14c26-127">**0** = ne pas enregistrer le conflit.</span><span class="sxs-lookup"><span data-stu-id="14c26-127">**0** = Do not log the conflict.</span></span><br /><br /> <span data-ttu-id="14c26-128">**1** = l'Abonné est le perdant du conflit.</span><span class="sxs-lookup"><span data-stu-id="14c26-128">**1** = Subscriber is the conflict loser.</span></span><br /><br /> <span data-ttu-id="14c26-129">**2** = le serveur de publication est le perdant du conflit.</span><span class="sxs-lookup"><span data-stu-id="14c26-129">**2** = Publisher is the conflict loser.</span></span>|  
    |<span data-ttu-id="14c26-130">**@conflict_messageSORTIE**</span><span class="sxs-lookup"><span data-stu-id="14c26-130">**@conflict_message OUTPUT**</span></span>|`nvarchar(512)`|<span data-ttu-id="14c26-131">Message accompagnant la résolution si le conflit est enregistré.</span><span class="sxs-lookup"><span data-stu-id="14c26-131">Message to be given about the resolution if the conflict is logged.</span></span>|  
    |**@destowner**|`sysname`|<span data-ttu-id="14c26-132">Propriétaire de la table publiée créée sur l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="14c26-132">The owner of the published table at the Subscriber.</span></span>|  
  
     <span data-ttu-id="14c26-133">Cette procédure stockée utilise les valeurs passées par l'Agent de fusion à ces paramètres pour implémenter votre logique de résolution des conflits personnalisée. Elle doit retourner un jeu de résultats d'une seule ligne dont la structure est identique à la table de base et qui contient les valeurs de données pour la version gagnante de la ligne.</span><span class="sxs-lookup"><span data-stu-id="14c26-133">This stored procedure uses the values passed by the Merge Agent to these parameters to implement your custom conflict resolution logic; it must return a single row result set that is identical in structure to the base table and contains the data values for the winning version of the row.</span></span>  
  
2.  <span data-ttu-id="14c26-134">Accordez les autorisations EXECUTE sur la procédure stockée à toutes connexions utilisées par les Abonnés pour se connecter au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="14c26-134">Grant EXECUTE permissions on the stored procedure to any logins used by Subscribers to connect to the Publisher.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="14c26-135">Pour utiliser un outil de résolution des conflits personnalisé avec un nouvel article de table</span><span class="sxs-lookup"><span data-stu-id="14c26-135">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="14c26-136">Exécutez [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) pour définir un article, en affectant la valeur du **programme de résolution des procédures stockées Microsoft SQL** **Server** au paramètre **@article_resolver** et le nom de la procédure stockée qui implémente la logique de l'outil de résolution des conflits au paramètre **@resolver_info** .</span><span class="sxs-lookup"><span data-stu-id="14c26-136">Execute [sp_addmergearticle](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article, specifying a value of **MicrosoftSQL** **Server Stored Procedure Resolver** for the **@article_resolver** parameter and the name of the stored procedure that implements the conflict resolver logic for the **@resolver_info** parameter.</span></span> <span data-ttu-id="14c26-137">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="14c26-137">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="14c26-138">Pour utiliser un outil de résolution des conflits personnalisé avec un article de table existant</span><span class="sxs-lookup"><span data-stu-id="14c26-138">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="14c26-139">Exécutez [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), en spécifiant **@publication** , **@article** , une valeur de **article_resolver** pour **@property** et une valeur de **en affectant** **Server stocked ProcedureResolver** pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="14c26-139">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and a value of **MicrosoftSQL** **Server Stored ProcedureResolver** for **@value**.</span></span>  
  
2.  <span data-ttu-id="14c26-140">Exécutez [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), en spécifiant **@publication** , **@article** , la valeur **resolver_info** pour **@property** et le nom de la procédure stockée qui implémente la logique de l’outil de résolution des conflits pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="14c26-140">Execute [sp_changemergearticle](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **resolver_info** for **@property**, and the name of the stored procedure that implements the conflict resolver logic for **@value**.</span></span>  
  
##  <a name="using-a-com-based-custom-resolver"></a><a name="COM"></a><span data-ttu-id="14c26-141">Utilisation d’un programme de résolution personnalisé basé sur COM</span><span class="sxs-lookup"><span data-stu-id="14c26-141">Using a COM-based Custom Resolver</span></span>  
 <span data-ttu-id="14c26-142">L'espace de noms <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> implémente une interface qui vous permet d'écrire une logique métier complexe afin de gérer les événements et de résoudre les conflits qui se produisent au cours du processus de synchronisation de la réplication de fusion.</span><span class="sxs-lookup"><span data-stu-id="14c26-142">The <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace implements an interface that enables you to write complex business logic to handle events and resolve conflicts that occur during the merge replication synchronization process.</span></span> <span data-ttu-id="14c26-143">Pour plus d’informations, voir [Implémenter un gestionnaire de logique métier pour un article de fusion](implement-a-business-logic-handler-for-a-merge-article.md).</span><span class="sxs-lookup"><span data-stu-id="14c26-143">For more information, see [Implement a Business Logic Handler for a Merge Article](implement-a-business-logic-handler-for-a-merge-article.md).</span></span> <span data-ttu-id="14c26-144">Vous pouvez également écrire votre propre logique métier personnalisée en code natif pour résoudre ces conflits.</span><span class="sxs-lookup"><span data-stu-id="14c26-144">You can also write your own native code-based custom business logic to resolve conflicts.</span></span> <span data-ttu-id="14c26-145">Cette logique est construite sous la forme d'un composant COM et compilée dans des bibliothèques de liens dynamiques (DLL) à l'aide de produits tels que [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="14c26-145">This logic is built as a COM component and compiled into dynamic-link libraries (DLL), using products such as [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="14c26-146">Un outil de résolution de conflits personnalisé basé sur COM doit implémenter l’interface **ICustomResolver** , qui est conçue spécifiquement pour la résolution des conflits.</span><span class="sxs-lookup"><span data-stu-id="14c26-146">Such a COM-based custom conflict resolver must implement the **ICustomResolver** interface, which is designed specifically for conflict resolution.</span></span>  
  
#### <a name="to-create-and-register-a-com-based-custom-conflict-resolver"></a><span data-ttu-id="14c26-147">Pour créer et enregistrer un outil de résolution des conflits personnalisé  basé sur COM</span><span class="sxs-lookup"><span data-stu-id="14c26-147">To create and register a COM-based custom conflict resolver</span></span>  
  
1.  <span data-ttu-id="14c26-148">Dans un environnement de création compatible COM, ajoutez des références à la bibliothèque de l'outil de résolution des conflits personnalisé.</span><span class="sxs-lookup"><span data-stu-id="14c26-148">In a COM-compatible authoring environment, add references to the Custom Conflict Resolver library.</span></span>  
  
2.  <span data-ttu-id="14c26-149">Pour un projet Visual C++, utilisez la directive #import pour importer cette bibliothèque dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="14c26-149">For a Visual C++ project, use the #import directive to import this library into your project.</span></span>  
  
3.  <span data-ttu-id="14c26-150">Créez une classe qui implémente l'interface **ICustomResolver** .</span><span class="sxs-lookup"><span data-stu-id="14c26-150">Create a class that implements the **ICustomResolver** interface.</span></span>  
  
4.  <span data-ttu-id="14c26-151">Implémentez certaines méthodes et propriétés.</span><span class="sxs-lookup"><span data-stu-id="14c26-151">Implement certain methods and properties.</span></span>  
  
5.  <span data-ttu-id="14c26-152">Générez le projet de manière à créer le fichier bibliothèque de l'outil de résolution des conflits personnalisé.</span><span class="sxs-lookup"><span data-stu-id="14c26-152">Build the project to create the custom conflict resolver library file.</span></span>  
  
6.  <span data-ttu-id="14c26-153">Déployez la bibliothèque dans le répertoire contenant l'exécutable de l'agent de fusion (généralement \Microsoft SQL Server\100\COM).</span><span class="sxs-lookup"><span data-stu-id="14c26-153">Deploy the library in the directory containing the merge agent executable (usually \Microsoft SQL Server\100\COM).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="14c26-154">Un outil de résolution des conflits personnalisé doit être déployé sur l'Abonné pour un abonnement par extraction, sur le serveur de distribution pour un abonnement par émission de données ou sur le serveur Web utilisé avec la synchronisation Web.</span><span class="sxs-lookup"><span data-stu-id="14c26-154">A custom conflict resolver must be deployed at the Subscriber for a pull subscription, at the Distributor for a push subscription, or at the Web server used with Web synchronization.</span></span>  
  
7.  <span data-ttu-id="14c26-155">Enregistrez la bibliothèque de l'outil de résolution des conflits personnalisé à l'aide de regsvr32.exe à partir du répertoire de déploiement, comme suit :</span><span class="sxs-lookup"><span data-stu-id="14c26-155">Register the custom conflict resolver library using regsvr32.exe from the deployment directory as follows:</span></span>  
  
    ```  
    regsvr32.exe mycustomresolver.dll  
    ```  
  
8.  <span data-ttu-id="14c26-156">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) pour vérifier que la bibliothèque n’est pas enregistrée en tant qu’outil de résolution des conflits personnalisé.</span><span class="sxs-lookup"><span data-stu-id="14c26-156">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) to verify that the library is not already registered as a custom conflict resolver.</span></span>  
  
9. <span data-ttu-id="14c26-157">Pour enregistrer la bibliothèque en tant qu’outil de résolution des conflits personnalisé, exécutez [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql) au niveau du serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="14c26-157">To register the library as a custom conflict resolver, execute [sp_registercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-registercustomresolver-transact-sql), at the Distributor.</span></span> <span data-ttu-id="14c26-158">Spécifiez le nom convivial de l’objet COM pour **@article_resolver** , l’ID de la bibliothèque (CLSID) pour **@resolver_clsid** et la valeur `false` pour **@is_dotnet_assembly** .</span><span class="sxs-lookup"><span data-stu-id="14c26-158">Specify the friendly name of the COM object for **@article_resolver**, the library's ID (CLSID) for **@resolver_clsid**, and a value of `false` for **@is_dotnet_assembly**.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="14c26-159">Quand vous n’en avez plus besoin, vous pouvez annuler l’enregistrement d’un outil de résolution des conflits personnalisé à l’aide de [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="14c26-159">When no longer needed, a custom conflict resolver can be unregistered using [sp_unregistercustomresolver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-unregistercustomresolver-transact-sql).</span></span>  
  
10. <span data-ttu-id="14c26-160">(Facultatif) Sur un cluster, répétez les étapes 5 à 8 pour enregistrer le programme de résolution personnalisé sur tous les nœuds du cluster.</span><span class="sxs-lookup"><span data-stu-id="14c26-160">(Optional) On a cluster, repeat steps 5-8 to register the custom resolver on all nodes of the cluster.</span></span> <span data-ttu-id="14c26-161">Cette procédure est nécessaire pour garantir que le programme de résolution personnalisé sera en mesure de charger correctement le réconciliateur suite à un basculement.</span><span class="sxs-lookup"><span data-stu-id="14c26-161">This is required to ensure that the custom resolver will be able to properly load the reconciler following a failover.</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-a-new-table-article"></a><span data-ttu-id="14c26-162">Pour utiliser un outil de résolution des conflits personnalisé avec un nouvel article de table</span><span class="sxs-lookup"><span data-stu-id="14c26-162">To use a custom conflict resolver with a new table article</span></span>  
  
1.  <span data-ttu-id="14c26-163">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) et notez le nom convivial du programme de résolution souhaité.</span><span class="sxs-lookup"><span data-stu-id="14c26-163">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="14c26-164">Dans la base de données de publication sur le serveur de publication, exécutez [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) pour définir un article.</span><span class="sxs-lookup"><span data-stu-id="14c26-164">At the Publisher on the publication database, execute [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql) to define an article.</span></span> <span data-ttu-id="14c26-165">Spécifiez le nom convivial du programme de résolution d’Articles de l’étape 1 pour **@article_resolver** .</span><span class="sxs-lookup"><span data-stu-id="14c26-165">Specify the friendly name of the article resolver from step 1 for **@article_resolver**.</span></span> <span data-ttu-id="14c26-166">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="14c26-166">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
#### <a name="to-use-a-custom-conflict-resolver-with-an-existing-table-article"></a><span data-ttu-id="14c26-167">Pour utiliser un outil de résolution des conflits personnalisé avec un article de table existant</span><span class="sxs-lookup"><span data-stu-id="14c26-167">To use a custom conflict resolver with an existing table article</span></span>  
  
1.  <span data-ttu-id="14c26-168">Sur le serveur de publication, exécutez [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) et notez le nom convivial du programme de résolution souhaité.</span><span class="sxs-lookup"><span data-stu-id="14c26-168">At the Publisher, execute [sp_enumcustomresolvers &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql) and note the friendly name of the desired resolver.</span></span>  
  
2.  <span data-ttu-id="14c26-169">Exécutez [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), en spécifiant **@publication** , **@article** , une valeur de **article_resolver** pour **@property** et le nom convivial du programme de résolution d’Articles de l’étape 1 pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="14c26-169">Execute [sp_changemergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql), specifying **@publication**, **@article**, a value of **article_resolver** for **@property**, and the friendly name of the article resolver from step 1 for **@value**.</span></span>  
  
#### <a name="viewing-a-sample-custom-resolver"></a><span data-ttu-id="14c26-170">Affichage d'un exemple de programme de résolution personnalisé</span><span class="sxs-lookup"><span data-stu-id="14c26-170">Viewing a Sample Custom Resolver</span></span>  
  
1.  <span data-ttu-id="14c26-171">Un exemple est disponible dans les fichiers d'exemple de SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="14c26-171">A sample is available in the SQL Server 2000 sample files.</span></span> <span data-ttu-id="14c26-172">Téléchargez le [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span><span class="sxs-lookup"><span data-stu-id="14c26-172">Download the [**sql2000samples.zip**](https://github.com/Microsoft/sql-server-samples/blob/master/samples/tutorials/Miscellaneous/sql2000samples.zip).</span></span> <span data-ttu-id="14c26-173">Cela permet de télécharger 3 fichiers dont la taille est de 6,9 Mo.</span><span class="sxs-lookup"><span data-stu-id="14c26-173">This downloads 3 files amounting to 6.9 MB.</span></span>  
  
2.  <span data-ttu-id="14c26-174">Extrayez les fichiers du fichier .cab compressé téléchargé.</span><span class="sxs-lookup"><span data-stu-id="14c26-174">Extract the files from downloaded compressed .cab file.</span></span>  
  
3.  <span data-ttu-id="14c26-175">Exécuter **setup.exe**</span><span class="sxs-lookup"><span data-stu-id="14c26-175">Run **setup.exe**</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="14c26-176">Lorsque vous choisissez les options d'installation, il est uniquement nécessaire d'installer les exemples de **Réplication** .</span><span class="sxs-lookup"><span data-stu-id="14c26-176">When choosing the installation options, it is only necessary to install the **Replication** samples.</span></span> <span data-ttu-id="14c26-177">(Le chemin d’installation par défaut est **C:\Program Files (x86) \microsoft SQL Server \\ 2000 Samples\1033**)</span><span class="sxs-lookup"><span data-stu-id="14c26-177">(The default installation path is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\\**)</span></span>  
  
4.  <span data-ttu-id="14c26-178">Accédez au dossier d'installation.</span><span class="sxs-lookup"><span data-stu-id="14c26-178">Go to installation folder.</span></span> <span data-ttu-id="14c26-179">(Le dossier par défaut est le suivant : **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span><span class="sxs-lookup"><span data-stu-id="14c26-179">(The default folder is **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\unzip_sqlreplSP3.exe**)</span></span>  
  
5.  <span data-ttu-id="14c26-180">Exécutez le programme **unzip_sqlreplSP3.exe** .</span><span class="sxs-lookup"><span data-stu-id="14c26-180">Run the **unzip_sqlreplSP3.exe** program.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="14c26-181">L’exemple de programme de résolution COM s’installe (par défaut) dans le dossier suivant : **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** .</span><span class="sxs-lookup"><span data-stu-id="14c26-181">The sample com resolver will install (by default) to the **C:\Program Files (x86)\Microsoft SQL Server 2000 Samples\1033\sqlrepl\resolver\subspres** folder.</span></span>  
  
6.  <span data-ttu-id="14c26-182">Dans le dossier **subspres** , recherchez toutes les occurrences de l’élément **#include sqlres.h** dans l’ensemble des fichiers sources, et remplacez-les par **#import "replrec.dll" no_namespace, raw_interfaces_only**.</span><span class="sxs-lookup"><span data-stu-id="14c26-182">In the **subspres** folder, find all occurrences of **#include sqlres.h** in all of the source files and replace them with **#import "replrec.dll" no_namespace, raw_interfaces_only**</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="14c26-183">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="14c26-183">See Also</span></span>  
 <span data-ttu-id="14c26-184">[Détection et résolution des conflits de réplication de fusion avancée](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span><span class="sxs-lookup"><span data-stu-id="14c26-184">[Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md) </span></span>  
 <span data-ttu-id="14c26-185">[Programmes de résolution personnalisés COM](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span><span class="sxs-lookup"><span data-stu-id="14c26-185">[COM-Based Custom Resolvers](merge/advanced-merge-replication-conflict-com-based-custom-resolvers.md) </span></span>  
 [<span data-ttu-id="14c26-186">Bonnes pratiques en matière de sécurité de la réplication</span><span class="sxs-lookup"><span data-stu-id="14c26-186">Replication Security Best Practices</span></span>](security/replication-security-best-practices.md)  
  
  
