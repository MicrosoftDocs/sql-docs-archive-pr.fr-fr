---
title: Concepts liés à Replication Management Objects | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: reference
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- replication [SQL Server], RMO
- programming interfaces [SQL Server replication]
- replication [SQL Server], how-to topics
- RMO [SQL Server]
- Replication Management Objects
- programming [SQL Server replication], RMO
ms.assetid: 37476d50-fb47-49e3-9504-3b163ac381d8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 0dc41416e0fb585db376c6b72f28f7c30cfff052
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605369"
---
# <a name="replication-management-objects-concepts"></a><span data-ttu-id="2cc51-102">Concepts liés à Replication Management Objects</span><span class="sxs-lookup"><span data-stu-id="2cc51-102">Replication Management Objects Concepts</span></span>
  <span data-ttu-id="2cc51-103">RMO (Replication Management Objects) est un assembly de code managé qui encapsule les fonctionnalités de réplication pour [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2cc51-103">Replication Management Objects (RMO) is a managed code assembly that encapsulates replication functionalities for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="2cc51-104">RMO est implémenté par l'espace de noms <xref:Microsoft.SqlServer.Replication>.</span><span class="sxs-lookup"><span data-stu-id="2cc51-104">RMO is implemented by the <xref:Microsoft.SqlServer.Replication> namespace.</span></span>  
  
 <span data-ttu-id="2cc51-105">Les rubriques des sections suivantes indiquent comment utiliser RMO pour contrôler par programme les tâches de réplication :</span><span class="sxs-lookup"><span data-stu-id="2cc51-105">The topics in the following sections describe how you can use RMO to programmatically control replication tasks:</span></span>  
  
 [<span data-ttu-id="2cc51-106">Configurer la distribution</span><span class="sxs-lookup"><span data-stu-id="2cc51-106">Configure Distribution</span></span>](../configure-distribution.md)  
 <span data-ttu-id="2cc51-107">Les rubriques de cette section indiquent comment utiliser RMO pour configurer la publication et la distribution.</span><span class="sxs-lookup"><span data-stu-id="2cc51-107">Topics in this section show how to use RMO to configure publishing and distribution.</span></span>  
  
 [<span data-ttu-id="2cc51-108">Créer une publication</span><span class="sxs-lookup"><span data-stu-id="2cc51-108">Create a Publication</span></span>](../publish/create-a-publication.md)  
 <span data-ttu-id="2cc51-109">Les rubriques de cette section indiquent comment utiliser RMO pour créer, supprimer et modifier des publications et des articles.</span><span class="sxs-lookup"><span data-stu-id="2cc51-109">Topics in this section show how to use RMO to create, delete, and modify publications and articles.</span></span>  
  
 [<span data-ttu-id="2cc51-110">S'abonner à des publications</span><span class="sxs-lookup"><span data-stu-id="2cc51-110">Subscribe to Publications</span></span>](../subscribe-to-publications.md)  
 <span data-ttu-id="2cc51-111">Les rubriques de cette section indiquent comment utiliser RMO pour créer, supprimer et modifier des abonnements.</span><span class="sxs-lookup"><span data-stu-id="2cc51-111">Topics in this section show how to use RMO to create, delete, and modify subscriptions.</span></span>  
  
 [<span data-ttu-id="2cc51-112">Sécuriser une topologie de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-112">Secure a Replication Topology</span></span>](../security/view-and-modify-replication-security-settings.md)  
 <span data-ttu-id="2cc51-113">Les rubriques de cette section indiquent comment utiliser RMO pour afficher et modifier des paramètres de sécurité.</span><span class="sxs-lookup"><span data-stu-id="2cc51-113">Topics in this section show how to use RMO to view and modify security settings.</span></span>  
  
 [<span data-ttu-id="2cc51-114">Synchroniser des abonnements &#40;réplication&#41;</span><span class="sxs-lookup"><span data-stu-id="2cc51-114">Synchronize Subscriptions &#40;Replication&#41;</span></span>](../synchronize-data.md)  
 <span data-ttu-id="2cc51-115">Les rubriques de cette section indiquent comment synchroniser des abonnements.</span><span class="sxs-lookup"><span data-stu-id="2cc51-115">Topics in this section show how to synchronize subscriptions.</span></span>  
  
 [<span data-ttu-id="2cc51-116">Surveillance de la réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-116">Monitoring Replication</span></span>](../monitoring-replication.md)  
 <span data-ttu-id="2cc51-117">Les rubriques de cette section indiquent comment analyser par programme une topologie de réplication.</span><span class="sxs-lookup"><span data-stu-id="2cc51-117">Topics in this section show how to programmatically monitor a replication topology.</span></span>  
  
## <a name="introduction-to-rmo-programming"></a><span data-ttu-id="2cc51-118">Présentation de la programmation RMO</span><span class="sxs-lookup"><span data-stu-id="2cc51-118">Introduction to RMO Programming</span></span>  
 <span data-ttu-id="2cc51-119">RMO est conçu pour la programmation de tous les aspects de la réplication [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2cc51-119">RMO is designed for programming all aspects of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] replication.</span></span> <span data-ttu-id="2cc51-120">L'espace de noms RMO est <xref:Microsoft.SqlServer.Replication>, et il est implémenté par le fichier Microsoft.SqlServer.Rmo.dll, qui est un assembly [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2cc51-120">The RMO namespace is <xref:Microsoft.SqlServer.Replication>, and it is implemented by the Microsoft.SqlServer.Rmo.dll, which is a [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework assembly.</span></span> <span data-ttu-id="2cc51-121">L'assembly Microsoft.SqlServer.Replication.dll, qui appartient également à l'espace de noms <xref:Microsoft.SqlServer.Replication>, implémente une interface de code managé pour la programmation des différents agents de réplication (Agent d'instantané, Agent de distribution et Agent de fusion).</span><span class="sxs-lookup"><span data-stu-id="2cc51-121">The Microsoft.SqlServer.Replication.dll assembly, which also belongs to the <xref:Microsoft.SqlServer.Replication> namespace, implements a managed code interface for programming the various replication agents (Snapshot Agent, Distribution Agent, and Merge Agent).</span></span> <span data-ttu-id="2cc51-122">Ses classes sont accessibles à partir de RMO pour synchroniser des abonnements.</span><span class="sxs-lookup"><span data-stu-id="2cc51-122">Its classes can be accessed from RMO to synchronize subscriptions.</span></span> <span data-ttu-id="2cc51-123">Les classes de l'espace de noms <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport>, implémenté par l'assembly Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, sont utilisées pour créer la logique métier personnalisée pour la réplication de fusion.</span><span class="sxs-lookup"><span data-stu-id="2cc51-123">Classes in the <xref:Microsoft.SqlServer.Replication.BusinessLogicSupport> namespace, implemented by the Microsoft.SqlServer.Replication.BusinessLogicSupport.dll assembly, are used to create custom business logic for merge replication.</span></span> <span data-ttu-id="2cc51-124">Cet assembly est indépendant de RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-124">This assembly is independent from RMO.</span></span>  
  
## <a name="deploying-applications-based-on-rmo"></a><span data-ttu-id="2cc51-125">Déploiement d'applications basées sur RMO</span><span class="sxs-lookup"><span data-stu-id="2cc51-125">Deploying Applications Based on RMO</span></span>  
 <span data-ttu-id="2cc51-126">RMO dépend des composants de réplication et des composants de connectivité client qui sont inclus dans toutes les versions de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sauf SQL Server Compact.</span><span class="sxs-lookup"><span data-stu-id="2cc51-126">RMO depends on the replication components and client connectivity components that are included with all versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] except SQL Server Compact.</span></span> <span data-ttu-id="2cc51-127">Pour déployer une application basée sur RMO, vous devez installer une version de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] incluant les composants de réplication et les composants de connectivité client sur l’ordinateur sur lequel l’application s’exécutera.</span><span class="sxs-lookup"><span data-stu-id="2cc51-127">To deploy an application based on RMO, you must install a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] that includes replication components and client connectivity components on the computer on which the application will run.</span></span>  
  
## <a name="getting-started-with-rmo"></a><span data-ttu-id="2cc51-128">Mise en route avec RMO</span><span class="sxs-lookup"><span data-stu-id="2cc51-128">Getting Started with RMO</span></span>  
 <span data-ttu-id="2cc51-129">Cette section décrit comment démarrer un projet RMO simple à l'aide de [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2cc51-129">This section describes how to start a simple RMO project using [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Studio.</span></span>  
  
#### <a name="to-create-a-new-microsoft-visual-c-project"></a><span data-ttu-id="2cc51-130">Pour créer un projet Microsoft Visual C#</span><span class="sxs-lookup"><span data-stu-id="2cc51-130">To create a new Microsoft Visual C# project</span></span>  
  
1.  <span data-ttu-id="2cc51-131">Démarrez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2cc51-131">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="2cc51-132">Dans le menu **Fichier**, cliquez sur **Nouveau projet**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-132">On the **File** menu, click **NewProject.**</span></span> <span data-ttu-id="2cc51-133">La boîte de dialogue **Nouveau projet** apparaît.</span><span class="sxs-lookup"><span data-stu-id="2cc51-133">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="2cc51-134">Dans la boîte de dialogue **Types de projets**, sélectionnez **Projets Visual C#** .</span><span class="sxs-lookup"><span data-stu-id="2cc51-134">In the **Project Types** dialog box, select **Visual C# Projects**.</span></span> <span data-ttu-id="2cc51-135">Dans le volet **Modèles**, sélectionnez **Application Windows**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-135">In the **Templates** pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="2cc51-136">(Facultatif) Dans la zone **Nom**, tapez le nom de la nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="2cc51-136">(Optional) In **Name**, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="2cc51-137">Cliquez sur **OK** pour charger le modèle Windows Visual C#.</span><span class="sxs-lookup"><span data-stu-id="2cc51-137">Click **OK** to load the Visual C# Windows template.</span></span>  
  
6.  <span data-ttu-id="2cc51-138">Dans le menu **Projet**, sélectionnez l’élément **Ajouter une référence**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-138">On the **Project** menu, select **Add Reference** item.</span></span> <span data-ttu-id="2cc51-139">La boîte de dialogue **Ajouter une référence** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="2cc51-139">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="2cc51-140">Sélectionnez les assemblys suivants dans la liste de l’onglet **.NET**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-140">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="2cc51-141">Interface de programmation .NET Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="2cc51-141">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="2cc51-142">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="2cc51-142">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="2cc51-143">Bibliothèque de l'Agent de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-143">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2cc51-144">Utilisez la touche CTRL pour sélectionner plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="2cc51-144">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="2cc51-145">(Facultatif) Répétez l'étape 6.</span><span class="sxs-lookup"><span data-stu-id="2cc51-145">(Optional) Repeat step 6.</span></span> <span data-ttu-id="2cc51-146">Cliquez sur l’onglet **Parcourir**, accédez à [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, sélectionnez Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-146">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="2cc51-147">Dans le menu **Affichage** , cliquez sur **Code**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-147">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="2cc51-148">Dans le code, avant l'instruction d'espace de noms, tapez les instructions `using` suivantes pour qualifier les types dans les espaces de noms RMO :</span><span class="sxs-lookup"><span data-stu-id="2cc51-148">In the code, before the namespace statement, type the following `using` statements to qualify the types in the RMO namespaces:</span></span>  
  
    ```  
    // These namespaces are required.  
    using Microsoft.SqlServer.Replication;  
    using Microsoft.SqlServer.Management.Common;  
    // This namespace is only used when creating custom business  
    // logic for merge replication.  
    using Microsoft.SqlServer.Replication.BusinessLogicSupport;   
    ```  
  
#### <a name="to-create-a-new-microsoft-visual-basic-net-project"></a><span data-ttu-id="2cc51-149">Pour créer un projet Microsoft Visual Basic .NET</span><span class="sxs-lookup"><span data-stu-id="2cc51-149">To create a new Microsoft Visual Basic .NET project</span></span>  
  
1.  <span data-ttu-id="2cc51-150">Démarrez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2cc51-150">Start Visual Studio.</span></span>  
  
2.  <span data-ttu-id="2cc51-151">Dans le menu **Fichier**, sélectionnez **Nouveau projet**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-151">On the **File** menu, select **New Project**.</span></span> <span data-ttu-id="2cc51-152">La boîte de dialogue **Nouveau projet** apparaît.</span><span class="sxs-lookup"><span data-stu-id="2cc51-152">The **New Project** dialog box appears.</span></span>  
  
3.  <span data-ttu-id="2cc51-153">Dans le volet Types de projets, sélectionnez **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-153">In the Project Types pane, select **Visual Basic**.</span></span> <span data-ttu-id="2cc51-154">Dans le volet Modèles, sélectionnez **Application Windows**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-154">In the Templates pane, select **Windows Application**.</span></span>  
  
4.  <span data-ttu-id="2cc51-155">(Facultatif) Dans la zone **Nom**, tapez le nom de la nouvelle application.</span><span class="sxs-lookup"><span data-stu-id="2cc51-155">(Optional) In the **Name** box, type the name of the new application.</span></span>  
  
5.  <span data-ttu-id="2cc51-156">Cliquez sur **OK** pour charger le modèle Windows Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2cc51-156">Click **OK** to load the Visual Basic Windows template.</span></span>  
  
6.  <span data-ttu-id="2cc51-157">Dans le menu **Projet**, sélectionnez **Ajouter une référence**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-157">On the **Project** menu, select **Add Reference**.</span></span> <span data-ttu-id="2cc51-158">La boîte de dialogue **Ajouter une référence** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="2cc51-158">The **Add Reference** dialog box appears.</span></span>  
  
7.  <span data-ttu-id="2cc51-159">Sélectionnez les assemblys suivants dans la liste de l’onglet **.NET**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-159">Select the following assemblies from the list on the **.NET** tab, and then click **OK**.</span></span>  
  
    -   <span data-ttu-id="2cc51-160">Interface de programmation .NET Microsoft.SqlServer.Replication</span><span class="sxs-lookup"><span data-stu-id="2cc51-160">Microsoft.SqlServer.Replication .NET Programming Interface</span></span>  
  
    -   <span data-ttu-id="2cc51-161">Microsoft.SqlServer.ConnectionInfo</span><span class="sxs-lookup"><span data-stu-id="2cc51-161">Microsoft.SqlServer.ConnectionInfo</span></span>  
  
    -   <span data-ttu-id="2cc51-162">Bibliothèque de l'Agent de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-162">Replication Agent Library</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="2cc51-163">Utilisez la touche CTRL pour sélectionner plusieurs fichiers.</span><span class="sxs-lookup"><span data-stu-id="2cc51-163">Use the CTRL key to select more than one file.</span></span>  
  
8.  <span data-ttu-id="2cc51-164">(Facultatif) Répétez l'étape 6.</span><span class="sxs-lookup"><span data-stu-id="2cc51-164">(Optional) Repeat step 6.</span></span> <span data-ttu-id="2cc51-165">Cliquez sur l’onglet **Parcourir**, accédez à [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, sélectionnez Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-165">Click the **Browse** tab, navigate to [!INCLUDE[ssInstallPath](../../../includes/ssinstallpath-md.md)]COM, select Microsoft.SqlServer.Replication.BusinessLogicSupport.dll, and then click **OK**.</span></span>  
  
9. <span data-ttu-id="2cc51-166">Dans le menu **Affichage** , cliquez sur **Code**.</span><span class="sxs-lookup"><span data-stu-id="2cc51-166">On the **View** menu, click **Code**.</span></span>  
  
10. <span data-ttu-id="2cc51-167">Dans le code, avant les déclarations, tapez les instructions `Imports` suivantes pour qualifier les types dans les espaces de noms RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-167">In the code, before any declarations, type the following `Imports` statements to qualify the types in the RMO namespaces.</span></span>  
  
    ```  
    ' These namespaces are required.  
    Imports Microsoft.SqlServer.Replication  
    Imports Microsoft.SqlServer.Management.Common  
    ' This namespace is only used when creating custom business  
    ' logic for merge replication.  
    Imports Microsoft.SqlServer.Replication.BusinessLogicSupport   
    ```  
  
## <a name="connecting-to-a-replication-server"></a><span data-ttu-id="2cc51-168">Connexion à un serveur de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-168">Connecting to a Replication Server</span></span>  
 <span data-ttu-id="2cc51-169">Pour les objets de programmation RMO, il est nécessaire qu'une connexion à une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] soit établie en utilisant une instance de la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="2cc51-169">RMO programming objects require that a connection to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is made by using an instance of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span> <span data-ttu-id="2cc51-170">Cette connexion au serveur est établie indépendamment des objets de programmation RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-170">This connection to the server is made independently of any RMO programming objects.</span></span> <span data-ttu-id="2cc51-171">Elle est ensuite transmise à l'objet RMO lors de la création de l'instance ou par assignation à la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> de l'objet.</span><span class="sxs-lookup"><span data-stu-id="2cc51-171">It is then passed to the RMO object either during instance creation or by assignment to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the object.</span></span> <span data-ttu-id="2cc51-172">De cette manière, un objet de programmation RMO et les instances d'objet de connexion peuvent être créés et gérés séparément, et un objet de connexion peut être réutilisé avec plusieurs objets de programmation RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-172">In this manner, an RMO programming object and the connection object instances can be created and managed separately, and a single connection object can be reused with multiple RMO programming objects.</span></span> <span data-ttu-id="2cc51-173">Les règles suivantes s'appliquent aux connexions à un serveur de réplication :</span><span class="sxs-lookup"><span data-stu-id="2cc51-173">The following rules apply for connections to a replication server:</span></span>  
  
-   <span data-ttu-id="2cc51-174">Toutes les propriétés de la connexion sont définies pour un objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> donné.</span><span class="sxs-lookup"><span data-stu-id="2cc51-174">All properties for the connection are defined for a given <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="2cc51-175">Une connexion à chaque instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] doit comporter son propre objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="2cc51-175">A connection to each instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] must have its own <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="2cc51-176">L'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> est assigné à la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> de l'objet de programmation RMO créé ou faisant l'objet d'un accès sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-176">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object is assigned to the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property of the RMO programming object being created or accessed on the server.</span></span>  
  
-   <span data-ttu-id="2cc51-177">La méthode <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> établit la connexion au serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-177">The <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Connect%2A> method opens the connection to the server.</span></span> <span data-ttu-id="2cc51-178">Vous devez appeler cette méthode avant d'appeler une méthode qui accède au serveur sur un objet de programmation RMO à l'aide de la connexion.</span><span class="sxs-lookup"><span data-stu-id="2cc51-178">This method must be called before calling any methods that access the server on any RMO programming objects using the connection.</span></span>  
  
-   <span data-ttu-id="2cc51-179">Dans la mesure où RMO et [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) utilisent tous deux la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> pour les connexions à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les objets RMO et SMO peuvent utiliser la même connexion.</span><span class="sxs-lookup"><span data-stu-id="2cc51-179">Because RMO and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Management Objects (SMO) both use the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class for connections to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the same connection can be used by both RMO and SMO objects.</span></span> <span data-ttu-id="2cc51-180">Pour plus d’informations, consultez [Connexion à une instance de SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="2cc51-180">For more information, see [Connecting to an Instance of SQL Server](../../server-management-objects-smo/create-program/connecting-to-an-instance-of-sql-server.md).</span></span>  
  
-   <span data-ttu-id="2cc51-181">Toutes les informations d'authentification nécessaires pour l'établissement de la connexion et l'ouverture d'une session sur le serveur sont fournies dans l'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection>.</span><span class="sxs-lookup"><span data-stu-id="2cc51-181">All authentication information to make the connection and successfully log on to the server is supplied in the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object.</span></span>  
  
-   <span data-ttu-id="2cc51-182">La méthode par défaut est l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="2cc51-182">Windows Authentication is the default.</span></span> <span data-ttu-id="2cc51-183">Si vous utilisez l'authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], la propriété <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> doit avoir la valeur `false`, et un nom de connexion et un mot de passe [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] valides doivent être définis pour les propriétés <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> et <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A>.</span><span class="sxs-lookup"><span data-stu-id="2cc51-183">To use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.LoginSecure%2A> must be set to `false` and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Login%2A> and <xref:Microsoft.SqlServer.Management.Common.ConnectionSettings.Password%2A> must be set to a valid [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] logon and password.</span></span> <span data-ttu-id="2cc51-184">Les informations d'identification de sécurité doivent toujours être stockées et gérées de manière sécurisée, et elles doivent être fournies au moment de l'exécution chaque fois que cela est possible.</span><span class="sxs-lookup"><span data-stu-id="2cc51-184">Security credentials must always be stored and handled securely, and supplied at run-time whenever possible.</span></span>  
  
-   <span data-ttu-id="2cc51-185">Pour les applications multithread, un objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> distinct doit être utilisé dans chaque thread.</span><span class="sxs-lookup"><span data-stu-id="2cc51-185">For multithreaded applications, a separate <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object should be used in each thread.</span></span>  
  
 <span data-ttu-id="2cc51-186">Appelez la méthode <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> sur l'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> pour fermer les connexions au serveur actives utilisées par les objets RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-186">Call the <xref:Microsoft.SqlServer.Management.Common.ConnectionManager.Disconnect%2A> method on the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object to close active server connections used by RMO objects.</span></span>  
  
## <a name="setting-rmo-properties"></a><span data-ttu-id="2cc51-187">Définition des propriétés RMO</span><span class="sxs-lookup"><span data-stu-id="2cc51-187">Setting RMO Properties</span></span>  
 <span data-ttu-id="2cc51-188">Les propriétés d'objets de programmation RMO représentent les propriétés de ces objets de réplication sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-188">The properties of RMO programming objects represent the properties of these replication objects at the server.</span></span> <span data-ttu-id="2cc51-189">Lorsque des objets de réplication sont créés sur le serveur, les propriétés RMO sont utilisées pour définir ces objets.</span><span class="sxs-lookup"><span data-stu-id="2cc51-189">When creating new replication objects at the server, RMO properties are used to define these objects.</span></span> <span data-ttu-id="2cc51-190">Pour les objets existants, les propriétés RMO représentent les propriétés de l'objet existant, qui peuvent être modifiées uniquement pour les propriétés accessibles en écriture ou définissables.</span><span class="sxs-lookup"><span data-stu-id="2cc51-190">For existing objects, the RMO properties represent the existing object's properties, which can be modified only for properties that are writable or settable.</span></span> <span data-ttu-id="2cc51-191">Les propriétés peuvent être définies sur les nouveaux objets ou les objets existants.</span><span class="sxs-lookup"><span data-stu-id="2cc51-191">Properties can be set on new objects or existing objects.</span></span>  
  
### <a name="setting-properties-for-new-replication-objects"></a><span data-ttu-id="2cc51-192">Définition des propriétés des nouveaux objets de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-192">Setting Properties for New Replication Objects</span></span>  
 <span data-ttu-id="2cc51-193">Lorsque vous créez un objet de réplication sur le serveur, vous devez spécifier toutes les propriétés requises avant d'appeler la méthode `Create` de l'objet.</span><span class="sxs-lookup"><span data-stu-id="2cc51-193">When creating a new replication object at the server, you must specify all required properties before calling the `Create` method of the object.</span></span> <span data-ttu-id="2cc51-194">Pour plus d’informations sur la définition des propriétés d’un nouvel objet de réplication, consultez [Configurer la publication et la distribution](../configure-publishing-and-distribution.md).</span><span class="sxs-lookup"><span data-stu-id="2cc51-194">For more information about setting properties for a new replication object, see [Configure Publishing and Distribution](../configure-publishing-and-distribution.md).</span></span>  
  
### <a name="setting-properties-for-existing-replication-objects"></a><span data-ttu-id="2cc51-195">Définition des propriétés des objets de réplication existants</span><span class="sxs-lookup"><span data-stu-id="2cc51-195">Setting Properties for Existing Replication Objects</span></span>  
 <span data-ttu-id="2cc51-196">Pour un objet de réplication qui réside sur le serveur, en fonction de l'objet, RMO peut être en mesure de modifier certaines de ses propriétés ou toutes ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="2cc51-196">For replication objects that exist at the server, depending on the object, RMO might support the ability to change some or all of its properties.</span></span> <span data-ttu-id="2cc51-197">Seules les propriétés accessibles en écriture ou définissables peuvent être modifiées.</span><span class="sxs-lookup"><span data-stu-id="2cc51-197">Only writable or settable properties can be changed.</span></span> <span data-ttu-id="2cc51-198">Avant de modifier les propriétés, vous devez appeler `Load` ou la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour obtenir les propriétés actuelles auprès du serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-198">Before properties can be changed, either the `Load` or the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method must be called to get the current properties from the server.</span></span> <span data-ttu-id="2cc51-199">L'appel de ces méthodes indique qu'un objet existant fait l'objet d'une modification.</span><span class="sxs-lookup"><span data-stu-id="2cc51-199">Calling these methods indicates that an existing object is being modified.</span></span>  
  
 <span data-ttu-id="2cc51-200">Par défaut, lors de la modification des propriétés d'un objet, RMO valide ces modifications sur le serveur selon le mode d'exécution de l'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> utilisé.</span><span class="sxs-lookup"><span data-stu-id="2cc51-200">By default, when changing object properties, RMO commits these changes to the server based on the execution mode of the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> being used.</span></span> <span data-ttu-id="2cc51-201">La propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> peut être utilisée pour vérifier qu'un objet existe sur le serveur avant la tentative d'extraction ou de modification de ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="2cc51-201">The <xref:Microsoft.SqlServer.Replication.ReplicationObject.IsExistingObject%2A> method can be used to verify that an object exists at the server before attempting to retrieve or change its properties.</span></span> <span data-ttu-id="2cc51-202">Pour plus d’informations sur la modification des propriétés d’un objet de réplication, consultez [Afficher et modifier les propriétés d’un serveur de distribution ou d’un serveur de publication](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="2cc51-202">For more information about changing the properties of a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2cc51-203">Lorsque plusieurs clients RMO ou plusieurs instances d'un objet de programmation RMO accèdent au même objet de réplication sur le serveur, la méthode `Refresh` de l'objet RMO peut être appelée pour mettre à jour les propriétés en fonction de l'état actuel de l'objet sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-203">When multiple RMO clients or multiple instances of an RMO programming object are accessing the same replication object at the server, the `Refresh` method of the RMO object can be called to update the properties based on the current state of the object at the server.</span></span>  
  
### <a name="caching-property-changes"></a><span data-ttu-id="2cc51-204">Mise en cache de modifications de propriété</span><span class="sxs-lookup"><span data-stu-id="2cc51-204">Caching Property Changes</span></span>  
 <span data-ttu-id="2cc51-205">Lorsque la propriété <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> a la valeur <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql>, toutes les instructions [!INCLUDE[tsql](../../../includes/tsql-md.md)] générées par RMO sont capturées afin qu'elles puissent être exécutées manuellement dans un lot unique au moyen de l'une des méthodes d'exécution.</span><span class="sxs-lookup"><span data-stu-id="2cc51-205">When the <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes> property is set to <xref:Microsoft.SqlServer.Management.Common.SqlExecutionModes.CaptureSql> all [!INCLUDE[tsql](../../../includes/tsql-md.md)] statements generated by RMO are captured so that they can be executed manually in a single batch by using one of the execution methods.</span></span> <span data-ttu-id="2cc51-206">RMO vous permet de mettre en cache les modifications de propriété et de les valider globalement dans un lot unique au moyen de la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> de l'objet.</span><span class="sxs-lookup"><span data-stu-id="2cc51-206">RMO lets you cache property changes and commit them together in a single batch by using the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> method of the object.</span></span> <span data-ttu-id="2cc51-207">Pour la mise en cache des modifications de propriété, la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> de l'objet doit avoir la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="2cc51-207">To cache property changes, the <xref:Microsoft.SqlServer.Replication.ReplicationObject.CachePropertyChanges%2A> property of the object must be set to `true`.</span></span> <span data-ttu-id="2cc51-208">Lors de la mise en cache des modifications de propriété dans RMO, l'objet <xref:Microsoft.SqlServer.Management.Common.ServerConnection> détermine toujours le moment auquel les modifications sont envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-208">When caching property changes in RMO, the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> object still controls when changes are sent to the server.</span></span> <span data-ttu-id="2cc51-209">Pour plus d’informations sur la mise en cache des modifications de propriété pour un objet de réplication, consultez [Afficher et modifier les propriétés d’un serveur de distribution ou d’un serveur de publication](../view-and-modify-distributor-and-publisher-properties.md).</span><span class="sxs-lookup"><span data-stu-id="2cc51-209">For more information about caching property changes for a replication object, see [View and Modify Distributor and Publisher Properties](../view-and-modify-distributor-and-publisher-properties.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="2cc51-210">Bien que la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> prenne en charge la déclaration de transactions explicites lors de la définition des propriétés, ces transactions peuvent interférer avec les transactions de réplication internes et produire des résultats inattendus. Par conséquent, elles ne doivent pas être utilisées avec RMO.</span><span class="sxs-lookup"><span data-stu-id="2cc51-210">Although the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class supports declaring explicit transactions when setting properties, such transactions may interfere with internal replication transactions, can produce unanticipated results, and should not be used with RMO.</span></span>  
  
## <a name="example"></a><span data-ttu-id="2cc51-211">Exemple</span><span class="sxs-lookup"><span data-stu-id="2cc51-211">Example</span></span>  
 <span data-ttu-id="2cc51-212">Cet exemple illustre la mise en cache des modifications de propriété.</span><span class="sxs-lookup"><span data-stu-id="2cc51-212">This example demonstrates the caching of property changes.</span></span> <span data-ttu-id="2cc51-213">Les modifications apportées aux attributs d'une publication transactionnelle sont mises en cache tant qu'elles n'ont pas été envoyées explicitement au serveur.</span><span class="sxs-lookup"><span data-stu-id="2cc51-213">Changes made to the attributes of a transactional publication are cached until they are explicitly sent to the server.</span></span>  
  
 [!code-csharp[HowTo#rmo_ChangeTranPub_cached](../../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_ChangeTranPub_cached)]  
  
## <a name="see-also"></a><span data-ttu-id="2cc51-214">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2cc51-214">See Also</span></span>  
 <span data-ttu-id="2cc51-215">[Concepts liés aux procédures stockées système de réplication](replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="2cc51-215">[Replication System Stored Procedures Concepts](replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="2cc51-216">Concepts de programmation en matière de réplication</span><span class="sxs-lookup"><span data-stu-id="2cc51-216">Replication Programming Concepts</span></span>](replication-programming-concepts.md)  
  
  
