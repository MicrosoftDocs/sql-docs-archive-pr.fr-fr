---
title: Créer et appliquer l’instantané initial | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], creating
- snapshot replication [SQL Server], initial snapshots
ms.assetid: 742727a1-5189-44ec-b3ae-6fd7aa1f5347
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b7ac008fe139adf55376bb50fbf60dddcd6b9ae5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87601391"
---
# <a name="create-and-apply-the-initial-snapshot"></a><span data-ttu-id="71e1f-102">Créer et appliquer l'instantané initial</span><span class="sxs-lookup"><span data-stu-id="71e1f-102">Create and Apply the Initial Snapshot</span></span>
  <span data-ttu-id="71e1f-103">Cette rubrique explique comment créer et appliquer l'instantané initial dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], de [!INCLUDE[tsql](../../includes/tsql-md.md)]ou des objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="71e1f-103">This topic describes how to create and apply the initial snapshot in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="71e1f-104">Les publications de fusion qui utilisent des filtres paramétrés nécessitent un instantané en deux parties.</span><span class="sxs-lookup"><span data-stu-id="71e1f-104">Merge publications that use parameterized filters require a two-part snapshot.</span></span> <span data-ttu-id="71e1f-105">Pour plus d'informations, voir [Créer un instantané d’une publication de fusion avec des filtres paramétrés](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-105">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
 <span data-ttu-id="71e1f-106">**Dans cette rubrique**</span><span class="sxs-lookup"><span data-stu-id="71e1f-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="71e1f-107">**Pour créer et appliquer l'instantané initial à l'aide de :**</span><span class="sxs-lookup"><span data-stu-id="71e1f-107">**To create and apply the initial snapshot, using:**</span></span>  
  
     [<span data-ttu-id="71e1f-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="71e1f-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="71e1f-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="71e1f-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="71e1f-110">Objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="71e1f-110">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="71e1f-111">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="71e1f-111">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="71e1f-112">Par défaut, si l'Agent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est en cours d'exécution, un instantané est généré par l'Agent d'instantané immédiatement après la création d'une publication par l'Assistant Nouvelle publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-112">By default, if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is running, a snapshot is generated by the Snapshot Agent immediately after a publication is created with the New Publication Wizard.</span></span> <span data-ttu-id="71e1f-113">Il est ensuite appliqué par défaut par l'Agent de distribution (pour la réplication d'instantané et transactionnelle) ou l'Agent de fusion (pour les abonnements de fusion) pour tous les abonnements.</span><span class="sxs-lookup"><span data-stu-id="71e1f-113">By default, it is then applied by the Distribution Agent (for snapshot and transactional replication) or Merge Agent (for merge subscriptions) for all subscriptions.</span></span> <span data-ttu-id="71e1f-114">Il est également possible de générer un instantané à l'aide de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] et du Moniteur de réplication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-114">A snapshot can also be generated using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and Replication Monitor.</span></span> <span data-ttu-id="71e1f-115">Pour plus d’informations sur le démarrage du Moniteur de réplication, consultez [Démarrer le Moniteur de réplication](monitor/start-the-replication-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-create-a-snapshot-in-management-studio"></a><span data-ttu-id="71e1f-116">Pour créer un instantané dans Management Studio</span><span class="sxs-lookup"><span data-stu-id="71e1f-116">To create a snapshot in Management Studio</span></span>  
  
1.  <span data-ttu-id="71e1f-117">Connectez-vous au serveur de publication dans [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="71e1f-117">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="71e1f-118">Développez le dossier **Réplication** , puis développez le dossier **Publications locales** .</span><span class="sxs-lookup"><span data-stu-id="71e1f-118">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="71e1f-119">Cliquez avec le bouton droit sur la réplication pour laquelle vous souhaitez créer un instantané, puis cliquez sur **Afficher l'état de l'Agent d'instantané**.</span><span class="sxs-lookup"><span data-stu-id="71e1f-119">Right-click the publication for which you want to create a snapshot, and then click **View Snapshot Agent Status**.</span></span>  
  
4.  <span data-ttu-id="71e1f-120">Dans la boîte de dialogue **Afficher l’état de l’Agent d’instantané - \<Publication>** , cliquez sur **Démarrer**.</span><span class="sxs-lookup"><span data-stu-id="71e1f-120">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="71e1f-121">Lorsque l'Agent d'instantané termine la génération de l'instantané, un message comme celui-ci s'affiche : « [100 %] Un instantané de 17 article(s) a été généré ».</span><span class="sxs-lookup"><span data-stu-id="71e1f-121">When the Snapshot Agent finishes generating the snapshot, a message will be displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
#### <a name="to-create-a-snapshot-in-replication-monitor"></a><span data-ttu-id="71e1f-122">Pour créer un instantané dans le Moniteur de réplication</span><span class="sxs-lookup"><span data-stu-id="71e1f-122">To create a snapshot in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="71e1f-123">Dans le moniteur de réplication, développez un groupe de serveurs de publication dans le volet gauche, puis développez un serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-123">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="71e1f-124">Cliquez avec le bouton droit sur la réplication pour laquelle vous souhaitez créer un instantané, puis cliquez sur **Générer l'instantané**.</span><span class="sxs-lookup"><span data-stu-id="71e1f-124">Right-click the publication for which you want to generate a snapshot, and then click **Generate Snapshot**.</span></span>  
  
3.  <span data-ttu-id="71e1f-125">Pour afficher le statut de l'Agent d'instantané, cliquez sur l'onglet **Agents** . Pour des informations plus détaillées, cliquez avec le bouton droit sur l'Agent d'instantané dans la grille, puis cliquez sur **Afficher les détails**.</span><span class="sxs-lookup"><span data-stu-id="71e1f-125">To view the status of the Snapshot Agent, click the **Agents** tab. For more detailed information, right-click the Snapshot Agent in the grid, and then click **View Details**.</span></span>  
  
#### <a name="to-apply-a-snapshot"></a><span data-ttu-id="71e1f-126">Pour appliquer un instantané</span><span class="sxs-lookup"><span data-stu-id="71e1f-126">To apply a snapshot</span></span>  
  
1.  <span data-ttu-id="71e1f-127">Une fois que l'instantané est généré, il est appliqué en synchronisant l'abonnement avec l'Agent de distribution ou l'Agent de fusion :</span><span class="sxs-lookup"><span data-stu-id="71e1f-127">After the snapshot is generated, it is applied by synchronizing the subscription with the Distribution Agent or the Merge Agent:</span></span>  
  
    -   <span data-ttu-id="71e1f-128">Si l'Agent est paramétré pour une exécution en continu (par défaut pour la réplication transactionnelle); l'instantané est appliqué automatiquement après avoir été généré.</span><span class="sxs-lookup"><span data-stu-id="71e1f-128">If the agent is set to run continuously (the default for transactional replication), the snapshot is automatically applied after it is generated.</span></span>  
  
    -   <span data-ttu-id="71e1f-129">Si l'Agent est paramétré pour une exécution planifiée, l'instantané est appliqué à la prochaine exécution planifiée de l'Agent.</span><span class="sxs-lookup"><span data-stu-id="71e1f-129">If the agent is set to run on a schedule, the snapshot is applied the next time the agent is scheduled to run.</span></span>  
  
    -   <span data-ttu-id="71e1f-130">Si l'Agent est paramétré pour une exécution à la demande, l'instantané est appliqué la prochaine fois que vous exécutez l'Agent.</span><span class="sxs-lookup"><span data-stu-id="71e1f-130">If the agent is set to run on demand, it is applied the next time you run the agent.</span></span>  
  
     <span data-ttu-id="71e1f-131">Pour plus d'informations sur la synchronisation des abonnements, consultez [Synchronize a Push Subscription](synchronize-a-push-subscription.md) et [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="71e1f-132">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="71e1f-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="71e1f-133">Les instantanés initiaux peuvent être créés par programme en créant et exécutant un travail de l'Agent d'instantané ou en exécutant le fichier exécutable de l'Agent d'instantané à partir d'un fichier de commandes.</span><span class="sxs-lookup"><span data-stu-id="71e1f-133">Initial snapshots can be programmatically created either by creating and running a Snapshot Agent job or by running the Snapshot Agent executable file from a batch file.</span></span> <span data-ttu-id="71e1f-134">Une fois qu'un instantané initial a été généré, il est transféré et appliqué sur l'Abonné lorsque l'abonnement est synchronisé pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="71e1f-134">After an initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="71e1f-135">Si vous exécutez l'Agent d'instantané à partir d'une invite de commandes ou d'un fichier de commandes, vous devrez exécuter de nouveau l'agent chaque fois que l'instantané existant deviendra non valide.</span><span class="sxs-lookup"><span data-stu-id="71e1f-135">If you run the Snapshot Agent from a command prompt or a batch file, you will need to rerun the agent whenever the existing snapshot becomes invalid.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="71e1f-136">Lorsque c'est possible, demande aux utilisateurs de fournir les informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-136">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="71e1f-137">Si vous devez enregistrer les informations d'identification dans un fichier de script, vous devez sécuriser le fichier pour empêcher un accès non autorisé.</span><span class="sxs-lookup"><span data-stu-id="71e1f-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-and-run-a-snapshot-agent-job-to-generate-the-initial-snapshot"></a><span data-ttu-id="71e1f-138">Pour créer et exécuter un travail de l'Agent d'instantané pour générer l'instantané initial</span><span class="sxs-lookup"><span data-stu-id="71e1f-138">To create and run a Snapshot Agent job to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="71e1f-139">Créez une publication d'instantané, transactionnelle ou de fusion.</span><span class="sxs-lookup"><span data-stu-id="71e1f-139">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="71e1f-140">Pour plus d’informations, voir [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-140">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="71e1f-141">Exécutez [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="71e1f-141">Execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="71e1f-142">Spécifiez **@publication** et les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="71e1f-142">Specify **@publication** and the following parameters:</span></span>  
  
    -   <span data-ttu-id="71e1f-143">**@job_login, qui spécifie** les informations d’identification de l’authentification Windows qu’utilise l’Agent d’instantané pour s’exécuter sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-143">**The @job_login, which specifies** the Windows Authentication credentials under which the Snapshot Agent runs at the Distributor.</span></span>  
  
    -   <span data-ttu-id="71e1f-144">**@job_password**, qui correspond au mot de passe pour les informations d’identification Windows fournies.</span><span class="sxs-lookup"><span data-stu-id="71e1f-144">**The @job_password**, which is the password for the supplied Windows credentials.</span></span>  
  
    -   <span data-ttu-id="71e1f-145">(Facultatif) La valeur **0** pour **@publisher_security_mode** si l'agent utilisera l'authentification SQL Server lors de la connexion au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-145">(Optional) A value of **0** for **@publisher_security_mode** if the agent will use SQL Server Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="71e1f-146">Dans ce cas, vous devez également spécifier les informations de connexion d’authentification SQL Server pour **@publisher_login** et **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="71e1f-146">In this case, you must also specify the SQL Server Authentication login information for **@publisher_login** and **@publisher_password**.</span></span>  
  
    -   <span data-ttu-id="71e1f-147">(Facultatif) Une planification de synchronisation pour le travail de l'Agent d'instantané.</span><span class="sxs-lookup"><span data-stu-id="71e1f-147">(Optional) A synchronization schedule for the Snapshot Agent job.</span></span> <span data-ttu-id="71e1f-148">Pour plus d’informations, consultez [Spécifier des planifications de synchronisation](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-148">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="71e1f-149">Lors de la configuration d'un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour tous les paramètres, y compris *job_login* et *job_password*, sont envoyées en texte brut au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-149">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="71e1f-150">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'exécuter cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-150">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="71e1f-151">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-151">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
3.  <span data-ttu-id="71e1f-152">Ajoutez des articles à la publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-152">Add articles to the publication.</span></span> <span data-ttu-id="71e1f-153">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
4.  <span data-ttu-id="71e1f-154">Dans la base de données de publication sur le serveur de publication, exécutez [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql), en spécifiant la valeur **@publication** créée à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="71e1f-154">At the Publisher on the publication database, execute [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql), specifying the value of **@publication** from step 1.</span></span>  
  
#### <a name="to-run-the-snapshot-agent-to-generate-the-initial-snapshot"></a><span data-ttu-id="71e1f-155">Pour exécuter l'Agent d'instantané afin de générer l'instantané initial</span><span class="sxs-lookup"><span data-stu-id="71e1f-155">To run the Snapshot Agent to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="71e1f-156">Créez une publication d'instantané, transactionnelle ou de fusion.</span><span class="sxs-lookup"><span data-stu-id="71e1f-156">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="71e1f-157">Pour plus d’informations, voir [Create a Publication](publish/create-a-publication.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-157">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="71e1f-158">Ajoutez des articles à la publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-158">Add articles to the publication.</span></span> <span data-ttu-id="71e1f-159">Pour plus d’informations, consultez [définir un Article](publish/define-an-article.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-159">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
3.  <span data-ttu-id="71e1f-160">À partir de l'invite de commandes ou d'un fichier de commandes, démarrez l' [Replication Snapshot Agent](agents/replication-snapshot-agent.md) en exécutant **snapshot.exe**, en spécifiant les arguments de ligne de commande suivants :</span><span class="sxs-lookup"><span data-stu-id="71e1f-160">From the command prompt or in a batch file, start the [Replication Snapshot Agent](agents/replication-snapshot-agent.md) by running **snapshot.exe**, specifying the following command-line arguments:</span></span>  
  
    -   <span data-ttu-id="71e1f-161">**-Publication**</span><span class="sxs-lookup"><span data-stu-id="71e1f-161">**-Publication**</span></span>  
  
    -   <span data-ttu-id="71e1f-162">**-Publisher**</span><span class="sxs-lookup"><span data-stu-id="71e1f-162">**-Publisher**</span></span>  
  
    -   <span data-ttu-id="71e1f-163">**-Distributor**</span><span class="sxs-lookup"><span data-stu-id="71e1f-163">**-Distributor**</span></span>  
  
    -   <span data-ttu-id="71e1f-164">**-PublisherDB**</span><span class="sxs-lookup"><span data-stu-id="71e1f-164">**-PublisherDB**</span></span>  
  
    -   <span data-ttu-id="71e1f-165">**-ReplicationType**</span><span class="sxs-lookup"><span data-stu-id="71e1f-165">**-ReplicationType**</span></span>  
  
     <span data-ttu-id="71e1f-166">Si vous utilisez l'authentification SQL Server, vous devez également spécifier les arguments suivants :</span><span class="sxs-lookup"><span data-stu-id="71e1f-166">If you are using SQL Server Authentication, you must also specify the following arguments:</span></span>  
  
    -   <span data-ttu-id="71e1f-167">**-DistributorLogin**</span><span class="sxs-lookup"><span data-stu-id="71e1f-167">**-DistributorLogin**</span></span>  
  
    -   <span data-ttu-id="71e1f-168">**-DistributorPassword**</span><span class="sxs-lookup"><span data-stu-id="71e1f-168">**-DistributorPassword**</span></span>  
  
    -   <span data-ttu-id="71e1f-169">**-DistributorSecurityMode** = **0**</span><span class="sxs-lookup"><span data-stu-id="71e1f-169">**-DistributorSecurityMode** = **0**</span></span>  
  
    -   <span data-ttu-id="71e1f-170">**-PublisherLogin**</span><span class="sxs-lookup"><span data-stu-id="71e1f-170">**-PublisherLogin**</span></span>  
  
    -   <span data-ttu-id="71e1f-171">**-PublisherPassword**</span><span class="sxs-lookup"><span data-stu-id="71e1f-171">**-PublisherPassword**</span></span>  
  
    -   <span data-ttu-id="71e1f-172">**-PublisherSecurityMode** = **0**</span><span class="sxs-lookup"><span data-stu-id="71e1f-172">**-PublisherSecurityMode** = **0**</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="71e1f-173">Exemples (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="71e1f-173">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="71e1f-174">Cet exemple montre comment créer une publication transactionnelle et ajouter un travail de l'Agent d'instantané pour la nouvelle publication (à l'aide des variables de script **sqlcmd** ).</span><span class="sxs-lookup"><span data-stu-id="71e1f-174">This example shows how to create a transactional publication and add a Snapshot Agent job for the new publication (using **sqlcmd** scripting variables).</span></span> <span data-ttu-id="71e1f-175">L'exemple démarre également le travail.</span><span class="sxs-lookup"><span data-stu-id="71e1f-175">The example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_trangenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpubinitialsnapshot.sql#sp_trangenerate_snapshot)]  
  
 <span data-ttu-id="71e1f-176">Cet exemple crée une publication de fusion et ajoute un travail de l'Agent d'instantané (à l'aide des variables **sqlcmd** ) pour la publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-176">This example creates a merge publication and adds a Snapshot Agent job (using **sqlcmd** variables) for the publication.</span></span> <span data-ttu-id="71e1f-177">Cet exemple démarre également le travail.</span><span class="sxs-lookup"><span data-stu-id="71e1f-177">This example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_mergegenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepubinitialsnapshot.sql#sp_mergegenerate_snapshot)]  
  
 <span data-ttu-id="71e1f-178">Les arguments de ligne de commande suivants démarrent l'Agent d'instantané pour générer l'instantané pour une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="71e1f-178">The following command-line arguments start the Snapshot Agent to generate the snapshot for a merge publication.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="71e1f-179">Des sauts de ligne ont été ajoutés pour améliorer la lisibilité.</span><span class="sxs-lookup"><span data-stu-id="71e1f-179">Line breaks were added to improve readability.</span></span> <span data-ttu-id="71e1f-180">Dans un fichier de commandes, les commandes doivent figurer sur une seule ligne.</span><span class="sxs-lookup"><span data-stu-id="71e1f-180">In a batch file, commands must be made in a single line.</span></span>  
  
 [!code-sql[HowTo#startmergesnapshot_10](../../snippets/tsql/SQL15/replication/howto/tsql/createmergesnapshot_10.bat)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="71e1f-181">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="71e1f-181">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="71e1f-182">L'Agent d'instantané génère des instantanés après qu'une publication a été créée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-182">The Snapshot Agent generates snapshots after a publication is created.</span></span> <span data-ttu-id="71e1f-183">Vous pouvez générer ces instantanés par programme en utilisant les Replication Management Objects et l'accès direct par code managé aux fonctionnalités de l'Agent de réplication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-183">You can generate these snapshots programmatically by using Replication Management Objects (RMO) and direct managed code access to replication agent functionalities.</span></span> <span data-ttu-id="71e1f-184">Les objets à utiliser dépendent du type de réplication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-184">The objects you use depend on the type of replication.</span></span> <span data-ttu-id="71e1f-185">L'Agent d'instantané peut être démarré de façon synchrone à l'aide de l'objet <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> ou de façon asynchrone à l'aide du travail de l'agent.</span><span class="sxs-lookup"><span data-stu-id="71e1f-185">The Snapshot Agent can be started synchronously using the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> object or asynchronously using the agent job.</span></span> <span data-ttu-id="71e1f-186">Une fois l'instantané initial généré, il est transféré et appliqué sur l'Abonné lorsque l'abonnement est synchronisé pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="71e1f-186">After the initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="71e1f-187">Vous devrez exécuter de nouveau l'agent chaque fois que l'instantané existant ne contiendra plus de données valides à jour.</span><span class="sxs-lookup"><span data-stu-id="71e1f-187">You will need to rerun the agent whenever the existing snapshot no longer contains valid, up-to-date data.</span></span> <span data-ttu-id="71e1f-188">Pour plus d’informations, consultez [Gestion des publications](publish/maintain-publications.md).</span><span class="sxs-lookup"><span data-stu-id="71e1f-188">For more information, see [Maintain Publications](publish/maintain-publications.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="71e1f-189">Lorsque c'est possible, demande aux utilisateurs de fournir les informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-189">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="71e1f-190">Si vous devez stocker des informations d'identification, utilisez les [Services de chiffrement](https://go.microsoft.com/fwlink/?LinkId=34733) fournis par [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="71e1f-190">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="71e1f-191">Pour générer l'instantané initial pour une publication transactionnelle ou d'instantané en démarrant le travail de l'Agent d'instantané (asynchrone)</span><span class="sxs-lookup"><span data-stu-id="71e1f-191">To generate the initial snapshot for a snapshot or transactional publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="71e1f-192">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="71e1f-192">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="71e1f-193">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransPublication>.</span><span class="sxs-lookup"><span data-stu-id="71e1f-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span> <span data-ttu-id="71e1f-194">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> et <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> de la publication, et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec la connexion créée à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="71e1f-194">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="71e1f-195">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour charger les propriétés restantes de l'objet.</span><span class="sxs-lookup"><span data-stu-id="71e1f-195">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="71e1f-196">Si cette méthode retourne `false`, soit les propriétés de la publication ont été définies de manière incorrecte à l'étape 2, soit la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="71e1f-196">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="71e1f-197">Si <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> a la valeur `false`, appelez <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> pour créer le travail de l'Agent d'instantané pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-197">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="71e1f-198">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> pour démarrer le travail de l'agent qui génère l'instantané pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-198">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="71e1f-199">(Facultatif) Lorsque <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> a la valeur `true`, l'instantané est à la disposition des Abonnés.</span><span class="sxs-lookup"><span data-stu-id="71e1f-199">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="71e1f-200">Pour générer l'instantané initial pour une publication transactionnelle ou d'instantané en exécutant l'Agent d'instantané (synchrone)</span><span class="sxs-lookup"><span data-stu-id="71e1f-200">To generate the initial snapshot for a snapshot or transactional publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="71e1f-201">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> et définissez les propriétés requises suivantes :</span><span class="sxs-lookup"><span data-stu-id="71e1f-201">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="71e1f-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> – nom du serveur de publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="71e1f-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> – nom de la base de données de publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="71e1f-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> – nom de la publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="71e1f-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> – nom du serveur de distribution</span><span class="sxs-lookup"><span data-stu-id="71e1f-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="71e1f-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> – valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> pour utiliser l'authentification Windows lors de la connexion au serveur de publication ou valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> et valeurs pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> et <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> pour utiliser l'authentification [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lors de la connexion au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="71e1f-207">L'authentification Windows est recommandée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-207">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="71e1f-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> – valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> pour utiliser l'authentification Windows lors de la connexion au serveur de distribution ou valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> et valeurs pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> et <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> pour utiliser l'authentification [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lors de la connexion au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="71e1f-209">L'authentification Windows est recommandée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-209">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="71e1f-210">Spécifiez la valeur <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> ou <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span><span class="sxs-lookup"><span data-stu-id="71e1f-210">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="71e1f-211">Appelez la méthode <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> .</span><span class="sxs-lookup"><span data-stu-id="71e1f-211">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="71e1f-212">Pour générer l'instantané initial pour une publication de fusion en démarrant le travail de l'Agent d'instantané (asynchrone)</span><span class="sxs-lookup"><span data-stu-id="71e1f-212">To generate the initial snapshot for a merge publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="71e1f-213">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="71e1f-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="71e1f-214">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePublication>.</span><span class="sxs-lookup"><span data-stu-id="71e1f-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="71e1f-215">Définissez les propriétés <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> et <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> de la publication, et définissez la propriété <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> avec la connexion créée à l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="71e1f-215">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="71e1f-216">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> pour charger les propriétés restantes de l'objet.</span><span class="sxs-lookup"><span data-stu-id="71e1f-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="71e1f-217">Si cette méthode retourne `false`, soit les propriétés de la publication ont été définies de manière incorrecte à l'étape 2, soit la publication n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="71e1f-217">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="71e1f-218">Si <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> a la valeur `false`, appelez <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> pour créer le travail de l'Agent d'instantané pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-218">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="71e1f-219">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> pour démarrer le travail de l'agent qui génère l'instantané pour cette publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-219">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="71e1f-220">(Facultatif) Lorsque <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> a la valeur `true`, l'instantané est à la disposition des Abonnés.</span><span class="sxs-lookup"><span data-stu-id="71e1f-220">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="71e1f-221">Pour générer l'instantané initial pour une publication de fusion en exécutant l'Agent d'instantané (synchrone)</span><span class="sxs-lookup"><span data-stu-id="71e1f-221">To generate the initial snapshot for a merge publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="71e1f-222">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> et définissez les propriétés requises suivantes :</span><span class="sxs-lookup"><span data-stu-id="71e1f-222">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="71e1f-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> – nom du serveur de publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="71e1f-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> – nom de la base de données de publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="71e1f-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> – nom de la publication</span><span class="sxs-lookup"><span data-stu-id="71e1f-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="71e1f-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> – nom du serveur de distribution</span><span class="sxs-lookup"><span data-stu-id="71e1f-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="71e1f-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> – valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> pour utiliser l'authentification Windows lors de la connexion au serveur de publication ou valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> et valeurs pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> et <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> pour utiliser l'authentification [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lors de la connexion au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="71e1f-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="71e1f-228">L'authentification Windows est recommandée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-228">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="71e1f-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> – valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> pour utiliser l'authentification Windows lors de la connexion au serveur de distribution ou valeur <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> et valeurs pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> et <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> pour utiliser l'authentification [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lors de la connexion au serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="71e1f-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="71e1f-230">L'authentification Windows est recommandée.</span><span class="sxs-lookup"><span data-stu-id="71e1f-230">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="71e1f-231">Spécifiez la valeur <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> pour <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span><span class="sxs-lookup"><span data-stu-id="71e1f-231">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="71e1f-232">Appelez la méthode <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> .</span><span class="sxs-lookup"><span data-stu-id="71e1f-232">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="71e1f-233">Exemples (RMO)</span><span class="sxs-lookup"><span data-stu-id="71e1f-233">Examples (RMO)</span></span>  
 <span data-ttu-id="71e1f-234">Cet exemple exécute de façon synchrone l'Agent d'instantané pour générer l'instantané initial pour une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="71e1f-234">This example synchronously runs the Snapshot Agent to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot)]  
  
 <span data-ttu-id="71e1f-235">Cet exemple démarre de façon asynchrone le travail de l'agent pour générer l'instantané initial pour une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="71e1f-235">This example asynchronously starts the agent job to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot_WithJob](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot_withjob)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot_WithJob](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot_withjob)]  
  
## <a name="see-also"></a><span data-ttu-id="71e1f-236">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="71e1f-236">See Also</span></span>  
 <span data-ttu-id="71e1f-237">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-237">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="71e1f-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="71e1f-239">[Create a Push Subscription](create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-239">[Create a Push Subscription](create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="71e1f-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span></span>  
 <span data-ttu-id="71e1f-241">[Créer et appliquer l’instantané](create-and-apply-the-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-241">[Create and Apply the Snapshot](create-and-apply-the-snapshot.md) </span></span>  
 <span data-ttu-id="71e1f-242">[Initialiser un abonnement avec un instantané](initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-242">[Initialize a Subscription with a Snapshot](initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="71e1f-243">[Concepts liés à RMO (Replication Management Objects)](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="71e1f-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="71e1f-245">[Concepts liés aux procédures stockées système de réplication](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="71e1f-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="71e1f-246">Utiliser sqlcmd avec des variables de script</span><span class="sxs-lookup"><span data-stu-id="71e1f-246">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
