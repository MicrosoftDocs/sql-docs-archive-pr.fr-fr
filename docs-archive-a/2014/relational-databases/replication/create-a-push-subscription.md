---
title: Créer un abonnement par émission de données | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- push subscriptions [SQL Server replication], creating
- merge replication subscribing [SQL Server replication], push subscriptions
- subscriptions [SQL Server replication], push
- snapshot replication [SQL Server], subscribing
- transactional replication, subscribing
ms.assetid: adfbbc61-58d1-4330-9ad6-b14ab1142e2b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2195d96f4337cc60ba213deb5e3cc2831d27da76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87615126"
---
# <a name="create-a-push-subscription"></a><span data-ttu-id="eb40f-102">Créer un abonnement par émission (push)</span><span class="sxs-lookup"><span data-stu-id="eb40f-102">Create a Push Subscription</span></span>
  <span data-ttu-id="eb40f-103">Cette rubrique explique comment créer un abonnement par émission de données (push) dans [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] à l'aide de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], de [!INCLUDE[tsql](../../includes/tsql-md.md)]ou d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="eb40f-103">This topic describes how to create a push subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="eb40f-104">Pour plus d’informations sur la création d’un abonnement par émission de données pour un abonné non- [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , consultez [créer un abonnement pour un abonné non-SQL Server](create-a-subscription-for-a-non-sql-server-subscriber.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-104">For information about creating a push subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber, see [Create a Subscription for a Non-SQL Server Subscriber](create-a-subscription-for-a-non-sql-server-subscriber.md).</span></span>  
  
  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="eb40f-105">Utilisation de SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="eb40f-105">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="eb40f-106">Créez un abonnement envoyé sur le serveur de publication ou l'Abonné à l'aide de l'Assistant Nouvel abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-106">Create a push subscription at the Publisher or the Subscriber using the New Subscription Wizard.</span></span> <span data-ttu-id="eb40f-107">Exécutez les étapes de l'Assistant pour :</span><span class="sxs-lookup"><span data-stu-id="eb40f-107">Follow the pages in the wizard to:</span></span>  
  
-   <span data-ttu-id="eb40f-108">Spécifier le serveur de publication et la publication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-108">Specify the Publisher and publication.</span></span>  
  
-   <span data-ttu-id="eb40f-109">Sélectionner l'emplacement d'exécution des Agents de réplication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-109">Select where replication agents will run.</span></span> <span data-ttu-id="eb40f-110">Pour un abonnement envoyé, sélectionnez **Exécuter tous les agents sur le serveur de distribution (abonnements par envoi de données (push))** dans la page **Emplacement de l'Agent de distribution** ou la page **Emplacement de l'Agent de fusion** selon le type de publication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-110">For a push subscription, select **Run all agents at the Distributor (push subscriptions)** on the **Distribution Agent Location** page or **Merge Agent Location** page, depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="eb40f-111">Spécifiez des Abonnés et des bases de données d'abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-111">Specify Subscribers and subscription databases.</span></span>  
  
-   <span data-ttu-id="eb40f-112">Spécifiez les noms de connexion et mots de passe utilisés pour les connexions établies par les Agents de réplication :</span><span class="sxs-lookup"><span data-stu-id="eb40f-112">Specify the logins and passwords used for connections made by replication agents:</span></span>  
  
    -   <span data-ttu-id="eb40f-113">Pour les abonnements aux publications d'instantané et transactionnelles, spécifiez les informations d'identification dans la page **Sécurité de l'Agent de distribution** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-113">For subscriptions to snapshot and transactional publications, specify credentials on the **Distribution Agent Security** page.</span></span>  
  
    -   <span data-ttu-id="eb40f-114">Pour les abonnements aux publications de fusion, spécifiez les informations d'identification dans la page **Sécurité de l'Agent de fusion** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-114">For subscriptions to merge publications, specify credentials on the **Merge Agent Security** page.</span></span>  
  
     <span data-ttu-id="eb40f-115">Pour plus d’informations sur les autorisations requises par chaque agent, consultez [Modèle de sécurité de l’Agent de réplication](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-115">For information about the permissions required by each agent, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="eb40f-116">Spécifiez une planification de la synchronisation et le moment choisi pour initialiser l'Abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-116">Specify a synchronization schedule and when the Subscriber should be initialized.</span></span>  
  
-   <span data-ttu-id="eb40f-117">Spécifiez les autres options pour les publications de fusion : type d'abonnement et valeurs pour le filtrage paramétré.</span><span class="sxs-lookup"><span data-stu-id="eb40f-117">Specify additional options for merge publications: subscription type; and values for parameterized filtering.</span></span>  
  
-   <span data-ttu-id="eb40f-118">Spécifiez les autres options pour les publications transactionnelles qui autorisent la mise à jour des abonnements : si les Abonnés doivent valider immédiatement les modifications sur le serveur de publication ou les écrire dans une file d'attente ou encore les informations d'identification utilisées pour la connexion de l'Abonné au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-118">Specify additional options for transactional publications that allow updating subscriptions: whether Subscribers should commit changes at the Publisher immediately or write them to a queue; credentials used to connect from the Subscriber to the Publisher.</span></span>  
  
-   <span data-ttu-id="eb40f-119">Créez éventuellement un script pour l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-119">Optionally script the subscription.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-publisher"></a><span data-ttu-id="eb40f-120">Pour créer un abonnement envoyé à partir du serveur de publication</span><span class="sxs-lookup"><span data-stu-id="eb40f-120">To create a push subscription from the Publisher</span></span>  
  
1.  <span data-ttu-id="eb40f-121">Connectez-vous au serveur de publication dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="eb40f-121">Connect to the Publisher in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="eb40f-122">Développez le dossier **Réplication** , puis développez le dossier **Publications locales** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-122">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="eb40f-123">Cliquez avec le bouton droit sur la publication pour laquelle vous souhaitez créer un ou plusieurs abonnements puis cliquez sur **Nouveaux abonnements**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-123">Right-click the publication for which you want to create one or more subscriptions, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="eb40f-124">Exécutez les étapes de l'Assistant Nouvel abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-124">Complete the pages in the New Subscription Wizard.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-subscriber"></a><span data-ttu-id="eb40f-125">Pour créer un abonnement envoyé à partir de l'Abonné</span><span class="sxs-lookup"><span data-stu-id="eb40f-125">To create a push subscription from the Subscriber</span></span>  
  
1.  <span data-ttu-id="eb40f-126">Connectez-vous à l'Abonné dans [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], puis développez le nœud du serveur.</span><span class="sxs-lookup"><span data-stu-id="eb40f-126">Connect to the Subscriber in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="eb40f-127">Développez le dossier **Réplication** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-127">Expand the **Replication** folder.</span></span>  
  
3.  <span data-ttu-id="eb40f-128">Cliquez avec le bouton droit sur le dossier **Abonnements locaux** , puis cliquez sur **Nouveaux abonnements**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-128">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="eb40f-129">Dans la page **Publication** de l’Assistant Nouvel abonnement, sélectionnez **\<Find SQL Server Publisher>** ou **\<Find Oracle Publisher>** dans la liste déroulante **Serveur de publication**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-129">On the **Publication** page of the New Subscription Wizard, select **\<Find SQL Server Publisher>** or **\<Find Oracle Publisher>** from the **Publisher** drop-down list.</span></span>  
  
5.  <span data-ttu-id="eb40f-130">Connectez-vous au serveur de publication dans la boîte de dialogue **Se connecter au serveur** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-130">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>  
  
6.  <span data-ttu-id="eb40f-131">Sélectionnez une publication dans la page **Publication** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-131">Select a publication on the **Publication** page.</span></span>  
  
7.  <span data-ttu-id="eb40f-132">Exécutez les étapes de l'Assistant Nouvel abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-132">Complete the pages in the New Subscription Wizard.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="eb40f-133">Utilisation de Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="eb40f-133">Using Transact-SQL</span></span>  
 <span data-ttu-id="eb40f-134">Les abonnements par envoi de données peuvent être créés par programmation en utilisant des procédures stockées de réplication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-134">Push subscriptions can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="eb40f-135">Les procédures stockées utilisées dépendent du type de publication auquel l'abonnement appartient.</span><span class="sxs-lookup"><span data-stu-id="eb40f-135">The stored procedures used will depend on the type of publication to which the subscription belongs.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="eb40f-136">Lorsque cela est possible, invitez les utilisateurs à saisir leurs informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-136">When possible, prompt users to enter security credentials at run time.</span></span> <span data-ttu-id="eb40f-137">Si vous devez enregistrer les informations d'identification dans un fichier de script, vous devez sécuriser le fichier pour empêcher un accès non autorisé.</span><span class="sxs-lookup"><span data-stu-id="eb40f-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="eb40f-138">Pour créer un abonnement par envoi de données vers un instantané ou une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="eb40f-138">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="eb40f-139">Au niveau du serveur de publication sur la base de données de publication, vérifiez que la publication prend en charge les abonnements par envoi de données en exécutant [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="eb40f-139">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="eb40f-140">Si la valeur de **allow_push** est **1**, les abonnements par envoi de données sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="eb40f-140">If the value of **allow_push** is **1**, push subscriptions are supported.</span></span>  
  
    -   <span data-ttu-id="eb40f-141">Si la valeur de **allow_push** est **0**, exécutez [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), en spécifiant **allow_push** pour **@property** et `true` pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-141">If the value of **allow_push** is **0**, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="eb40f-142">Au niveau du serveur de publication sur la base de données de publication, exécutez [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="eb40f-142">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="eb40f-143">Spécifiez **@publication** , **@subscriber** et **@destination_db** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-143">Specify **@publication**, **@subscriber** and **@destination_db**.</span></span> <span data-ttu-id="eb40f-144">Spécifiez la valeur **push** pour **@subscription_type**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-144">Specify a value of **push** for **@subscription_type**.</span></span> <span data-ttu-id="eb40f-145">Pour plus d’informations sur la mise à jour des abonnements, consultez [créer un abonnement pouvant être mis à jour pour une publication transactionnelle](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span><span class="sxs-lookup"><span data-stu-id="eb40f-145">For information about how to update subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
3.  <span data-ttu-id="eb40f-146">Au niveau du serveur de publication sur la base de données de publication, exécutez [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="eb40f-146">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="eb40f-147">Spécifiez les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="eb40f-147">Specify the following:</span></span>  
  
    -   <span data-ttu-id="eb40f-148">**@subscriber**Paramètres, **@subscriber_db** et **@publication** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-148">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="eb40f-149">Les [!INCLUDE[msCoName](../../includes/msconame-md.md)] informations d’identification Windows sous lesquelles le agent de distribution sur le serveur de distribution s’exécute pour **@job_login** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-149">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="eb40f-150">Les connexions effectuées à l’aide de l’authentification intégrée Windows utilisent toujours les informations d’identification Windows spécifiées par **@job_login** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-150">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="eb40f-151">L'Agent de distribution crée toujours la connexion locale au serveur de distribution à l'aide de l'authentification intégrée Windows.</span><span class="sxs-lookup"><span data-stu-id="eb40f-151">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="eb40f-152">Par défaut, l'agent se connecte à l'Abonné à l'aide de ces informations.</span><span class="sxs-lookup"><span data-stu-id="eb40f-152">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="eb40f-153">(Facultatif) La valeur **0** pour **@subscriber_security_mode** et les informations de connexion [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour **@subscriber_login** et **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-153">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="eb40f-154">Spécifiez ces paramètres si vous devez utiliser l'authentification SQL Server lors de la connexion à l'abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-154">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="eb40f-155">Planification du travail de l'Agent de distribution pour cet abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-155">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="eb40f-156">Pour plus d’informations, consultez [Spécifier des planifications de synchronisation](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-156">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="eb40f-157">Lors de la création d'un abonnement par émission de données sur un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour tous les paramètres, y compris *job_login* et *job_password*, sont envoyées au serveur de distribution en texte brut.</span><span class="sxs-lookup"><span data-stu-id="eb40f-157">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="eb40f-158">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'exécuter cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="eb40f-158">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="eb40f-159">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-159">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="eb40f-160">Pour créer un abonnement par envoi de données vers une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="eb40f-160">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="eb40f-161">Au niveau du serveur de publication sur la base de données de publication, vérifiez que la publication prend en charge les abonnements par envoi de données en exécutant [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="eb40f-161">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="eb40f-162">Si la valeur de **allow_push** est **1**, la publication prend en charge les abonnements par envoi de données.</span><span class="sxs-lookup"><span data-stu-id="eb40f-162">If the value of **allow_push** is **1**, the publication supports push subscriptions.</span></span>  
  
    -   <span data-ttu-id="eb40f-163">Si la valeur de **allow_push** n’est pas **1**, exécutez [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), en spécifiant **allow_push** pour **@property** et `true` pour **@value** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-163">If the value of **allow_push** is not **1**, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="eb40f-164">Sur la base de données de publication du serveur de publication, exécutez [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), en spécifiant les paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="eb40f-164">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="eb40f-165">**@publication**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-165">**@publication**.</span></span> <span data-ttu-id="eb40f-166">Il s'agit du nom de la publication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-166">This is the name of the publication.</span></span>  
  
    -   <span data-ttu-id="eb40f-167">**@subscriber_type**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-167">**@subscriber_type**.</span></span> <span data-ttu-id="eb40f-168">Pour un abonnement client, spécifiez **local** , et, pour un abonnement serveur, spécifiez **global**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-168">For a client subscription, specify **local** and for a server subscription, specify **global**.</span></span>  
  
    -   <span data-ttu-id="eb40f-169">**@subscription_priority**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-169">**@subscription_priority**.</span></span> <span data-ttu-id="eb40f-170">Pour un abonnement serveur, spécifiez la priorité de l'abonnement (de**0.00** à **99.99**).</span><span class="sxs-lookup"><span data-stu-id="eb40f-170">For a server subscription, specify a priority for the subscription (**0.00** to **99.99**).</span></span>  
  
         <span data-ttu-id="eb40f-171">Pour plus d’informations, consultez [Détection et résolution avancées des conflits de réplication de fusion](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-171">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
3.  <span data-ttu-id="eb40f-172">Sur la base de données de publication du serveur de publication, exécutez [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="eb40f-172">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="eb40f-173">Spécifiez les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="eb40f-173">Specify the following:</span></span>  
  
    -   <span data-ttu-id="eb40f-174">**@subscriber**Paramètres, **@subscriber_db** et **@publication** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-174">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="eb40f-175">Les informations d’identification Windows sous lesquelles le Agent de fusion sur le serveur de distribution s’exécute pour **@job_login** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-175">The Windows credentials under which the Merge Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="eb40f-176">Les connexions effectuées à l’aide de l’authentification intégrée Windows utilisent toujours les informations d’identification Windows spécifiées par **@job_login** et **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-176">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="eb40f-177">L'Agent de fusion crée toujours la connexion locale au serveur de distribution à l'aide de l'authentification intégrée Windows.</span><span class="sxs-lookup"><span data-stu-id="eb40f-177">The Merge Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="eb40f-178">Par défaut, l'agent se connecte à l'Abonné à l'aide de ces informations.</span><span class="sxs-lookup"><span data-stu-id="eb40f-178">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="eb40f-179">(Facultatif) La valeur **0** pour **@subscriber_security_mode** et les informations de connexion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour **@subscriber_login** et **@subscriber_password**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-179">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="eb40f-180">Spécifiez ces paramètres si vous devez utiliser l'authentification SQL Server lors de la connexion à l'abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-180">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="eb40f-181">(Facultatif) La valeur **0** pour **@publisher_security_mode** et les informations de connexion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour **@publisher_login** et **@publisher_password**.</span><span class="sxs-lookup"><span data-stu-id="eb40f-181">(Optional) A value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="eb40f-182">Spécifiez ces valeurs si vous devez utiliser l'authentification SQL Server lors de la connexion à l'abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-182">Specify these values if you need to use SQL Server Authentication when connecting to the Publisher.</span></span>  
  
    -   <span data-ttu-id="eb40f-183">Une planification du travail de l'Agent de fusion pour cet abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-183">A schedule for the Merge Agent job for this subscription.</span></span> <span data-ttu-id="eb40f-184">Pour plus d’informations, consultez [Spécifier des planifications de synchronisation](specify-synchronization-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-184">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="eb40f-185">Lors de la création d'un abonnement par émission de données sur un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour tous les paramètres, y compris *job_login* et *job_password*, sont envoyées au serveur de distribution en texte brut.</span><span class="sxs-lookup"><span data-stu-id="eb40f-185">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="eb40f-186">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'exécuter cette procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="eb40f-186">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="eb40f-187">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-187">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="eb40f-188">Exemples (Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="eb40f-188">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="eb40f-189">L'exemple suivant crée un abonnement par envoi de données vers une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="eb40f-189">The following example creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="eb40f-190">Les valeurs de connexion et de mot de passe sont fournies lors de l’exécution à l’aide des variables de script **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-190">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addtranpushsubscription_agent](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpushsub.sql#sp_addtranpushsubscription_agent)]  
  
 <span data-ttu-id="eb40f-191">L'exemple suivant crée un abonnement par envoi de données vers une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="eb40f-191">The following example creates a push subscription to a merge publication.</span></span> <span data-ttu-id="eb40f-192">Les valeurs de connexion et de mot de passe sont fournies lors de l’exécution à l’aide des variables de script **sqlcmd** .</span><span class="sxs-lookup"><span data-stu-id="eb40f-192">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addmergepushsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepushsub.sql#sp_addmergepushsubscriptionagent)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="eb40f-193">Utilisation d'objets RMO (Replication Management Objects)</span><span class="sxs-lookup"><span data-stu-id="eb40f-193">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="eb40f-194">Vous pouvez créer par programme des abonnements par émission de données (push) à l'aide d'objets RMO (Replication Management Objects).</span><span class="sxs-lookup"><span data-stu-id="eb40f-194">You can create push subscriptions programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="eb40f-195">Les classes RMO que vous utilisez pour créer un abonnement par envoi de données dépendent du type de publication sur laquelle l'abonnement a été créé.</span><span class="sxs-lookup"><span data-stu-id="eb40f-195">The RMO classes you use to create a push subscription depend on the type of publication to which the subscription is created.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="eb40f-196">Lorsque c'est possible, demande aux utilisateurs de fournir les informations d'identification au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-196">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="eb40f-197">Si vous devez stocker des informations d'identification, utilisez les [Services de chiffrement](https://go.microsoft.com/fwlink/?LinkId=34733) fournis par [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="eb40f-197">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="eb40f-198">Pour créer un abonnement par envoi de données vers un instantané ou une publication transactionnelle</span><span class="sxs-lookup"><span data-stu-id="eb40f-198">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="eb40f-199">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-199">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="eb40f-200">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransPublication> en utilisant la connexion au serveur de publication de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="eb40f-200">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="eb40f-201">Spécifiez <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>et <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-201">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="eb40f-202">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-202">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="eb40f-203">Si elle retourne la valeur `false`, les propriétés spécifiées à l'étape 2 sont incorrectes, ou la publication n'existe pas sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="eb40f-203">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="eb40f-204">Effectuez une opération AND logique au niveau du bit (`&` dans Visual C# et `And` dans Visual Basic) entre la propriété <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> et <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-204">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="eb40f-205">Si le résultat est <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, appliquez à<xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> le résutat d'une opération OR logique au niveau du bit (`|` dans Visual C# et `Or` dans Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> et <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-205">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="eb40f-206">Appelez ensuite <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> pour activer les abonnements par envoi de données.</span><span class="sxs-lookup"><span data-stu-id="eb40f-206">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="eb40f-207">Si la base de données d'abonnements n'existe pas, créez-la en utilisant la classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-207">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="eb40f-208">Pour plus d’informations, consultez [Création, modification et suppression de bases de données](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-208">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="eb40f-209">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.TransSubscription>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-209">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
7.  <span data-ttu-id="eb40f-210">Définissez les propriétés suivantes des abonnements :</span><span class="sxs-lookup"><span data-stu-id="eb40f-210">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="eb40f-211"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> sur l'Agent de publication créé à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-211">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-212">Nom de la base de données d'abonnements pour <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-212">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-213">Nom de l'abonné pour <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-213">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-214">Nom de la base de données de publication pour <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-214">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-215">Nom de la publication pour <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-215">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-216">Champs <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> et <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> pour fournir les informations d'identification pour le compte [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows sous lequel l'Agent de distribution fonctionne sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-216">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Distribution Agent runs at the Distributor.</span></span> <span data-ttu-id="eb40f-217">Ce compte permet de créer des connexions locales avec le serveur de distribution et des connexions distantes à l'aide de l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="eb40f-217">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="eb40f-218">La configuration de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> lorsqu'un abonnement est créé par un membre du rôle serveur fixe `sysadmin` n'est pas nécessaire, mais elle est néanmoins recommandée.</span><span class="sxs-lookup"><span data-stu-id="eb40f-218">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="eb40f-219">Dans ce cas, l'Agent va emprunter l'identité du compte de l'Agent SQL Server.</span><span class="sxs-lookup"><span data-stu-id="eb40f-219">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="eb40f-220">Pour plus d’informations, voir [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-220">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="eb40f-221">(Facultatif) Valeur `true` (par défaut) de <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> pour créer un travail de l'Agent qui permet de synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-221">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="eb40f-222">Si vous spécifiez `false`, l'abonnement peut uniquement être synchronisé par programme.</span><span class="sxs-lookup"><span data-stu-id="eb40f-222">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="eb40f-223">(Facultatif) Définissez les champs <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> et <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> lorsque vous utilisez l'authentification SQL Server pour vous connecter à l'abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-223">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
8.  <span data-ttu-id="eb40f-224">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-224">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="eb40f-225">Lors de la création d'un abonnement par émission de données sur un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour toutes les propriétés, y compris <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, sont envoyées au serveur de distribution en texte brut.</span><span class="sxs-lookup"><span data-stu-id="eb40f-225">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="eb40f-226">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'appeler la méthode <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-226">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="eb40f-227">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-227">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="eb40f-228">Pour créer un abonnement par envoi de données vers une publication de fusion</span><span class="sxs-lookup"><span data-stu-id="eb40f-228">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="eb40f-229">Créez une connexion au serveur de publication en utilisant la classe <xref:Microsoft.SqlServer.Management.Common.ServerConnection> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-229">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="eb40f-230">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergePublication> en utilisant la connexion au serveur de publication de l'étape 1.</span><span class="sxs-lookup"><span data-stu-id="eb40f-230">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="eb40f-231">Spécifiez <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>et <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-231">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="eb40f-232">Appelez la méthode <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-232">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="eb40f-233">Si elle retourne la valeur `false`, les propriétés spécifiées à l'étape 2 sont incorrectes, ou la publication n'existe pas sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="eb40f-233">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="eb40f-234">Effectuez une opération AND logique au niveau du bit (`&` dans Visual C# et `And` dans Visual Basic) entre la propriété <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> et <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-234">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="eb40f-235">Si le résultat est <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, appliquez à<xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> le résutat d'une opération OR logique au niveau du bit (`|` dans Visual C# et `Or` dans Visual Basic) entre <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> et <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-235">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="eb40f-236">Appelez ensuite <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> pour activer les abonnements par envoi de données.</span><span class="sxs-lookup"><span data-stu-id="eb40f-236">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="eb40f-237">Si la base de données d'abonnements n'existe pas, créez-la en utilisant la classe <xref:Microsoft.SqlServer.Management.Smo.Database> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-237">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="eb40f-238">Pour plus d’informations, consultez [Création, modification et suppression de bases de données](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-238">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="eb40f-239">Créez une instance de la classe <xref:Microsoft.SqlServer.Replication.MergeSubscription>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-239">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
7.  <span data-ttu-id="eb40f-240">Définissez les propriétés suivantes des abonnements :</span><span class="sxs-lookup"><span data-stu-id="eb40f-240">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="eb40f-241"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> sur l'Agent de publication créé à l'étape 1 pour <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-241">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-242">Nom de la base de données d'abonnements pour <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-242">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-243">Nom de l'abonné pour <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-243">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-244">Nom de la base de données de publication pour <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-244">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-245">Nom de la publication pour <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span><span class="sxs-lookup"><span data-stu-id="eb40f-245">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="eb40f-246">Champs <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> et <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> ou <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> pour fournir les informations d'identification pour le compte [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows sous lequel l'Agent de fusion fonctionne sur le serveur de distribution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-246">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Merge Agent runs at the Distributor.</span></span> <span data-ttu-id="eb40f-247">Ce compte permet de créer des connexions locales avec le serveur de distribution et des connexions distantes à l'aide de l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="eb40f-247">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="eb40f-248">La configuration de <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> lorsqu'un abonnement est créé par un membre du rôle serveur fixe `sysadmin` n'est pas nécessaire, mais elle est néanmoins recommandée.</span><span class="sxs-lookup"><span data-stu-id="eb40f-248">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="eb40f-249">Dans ce cas, l'Agent va emprunter l'identité du compte de l'Agent SQL Server.</span><span class="sxs-lookup"><span data-stu-id="eb40f-249">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="eb40f-250">Pour plus d’informations, voir [Replication Agent Security Model](security/replication-agent-security-model.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-250">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="eb40f-251">(Facultatif) Valeur `true` (par défaut) de <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> pour créer un travail de l'Agent qui permet de synchroniser l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="eb40f-251">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="eb40f-252">Si vous spécifiez `false`, l'abonnement peut uniquement être synchronisé par programme.</span><span class="sxs-lookup"><span data-stu-id="eb40f-252">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="eb40f-253">(Facultatif) Définissez les champs <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> et <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> lorsque vous utilisez l'authentification SQL Server pour vous connecter à l'abonné.</span><span class="sxs-lookup"><span data-stu-id="eb40f-253">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="eb40f-254">(Facultatif) Définissez les champs <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> et <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> ou <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> de <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> lorsque vous utilisez l'authentification SQL Server pour vous connecter au serveur de publication.</span><span class="sxs-lookup"><span data-stu-id="eb40f-254">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
8.  <span data-ttu-id="eb40f-255">Appelez la méthode <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-255">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="eb40f-256">Lors de la création d'un abonnement par émission de données sur un serveur de publication avec un serveur de distribution distant, les valeurs fournies pour toutes les propriétés, y compris <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, sont envoyées au serveur de distribution en texte brut.</span><span class="sxs-lookup"><span data-stu-id="eb40f-256">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="eb40f-257">Vous devez chiffrer la connexion entre le serveur de publication et son serveur de distribution distant avant d'appeler la méthode <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> .</span><span class="sxs-lookup"><span data-stu-id="eb40f-257">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="eb40f-258">Pour plus d’informations, consultez [Activer des connexions chiffrées dans le moteur de base de données &#40;Gestionnaire de configuration SQL Server&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span><span class="sxs-lookup"><span data-stu-id="eb40f-258">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="eb40f-259">Exemples (RMO)</span><span class="sxs-lookup"><span data-stu-id="eb40f-259">Examples (RMO)</span></span>  
 <span data-ttu-id="eb40f-260">Cet exemple crée un nouvel abonnement par envoi de données vers une publication transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="eb40f-260">This example creates a new push subscription to a transactional publication.</span></span> <span data-ttu-id="eb40f-261">Les informations d'identification du compte Windows que vous utilisez pour exécuter le travail de l'Agent de distribution sont transmises lors de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-261">The Windows account credentials you use to run the Distribution Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpushsub)]  
  
 <span data-ttu-id="eb40f-262">Cet exemple crée un nouvel abonnement par envoi de données vers une publication de fusion.</span><span class="sxs-lookup"><span data-stu-id="eb40f-262">This example creates a new push subscription to a merge publication.</span></span> <span data-ttu-id="eb40f-263">Les informations d'identification du compte Windows que vous utilisez pour exécuter le travail de l'Agent de fusion sont transmises lors de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="eb40f-263">The Windows account credentials you use to run the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepushsub)]  
  
## <a name="see-also"></a><span data-ttu-id="eb40f-264">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="eb40f-264">See Also</span></span>  
 <span data-ttu-id="eb40f-265">[Afficher et modifier les propriétés d’un abonnement par émission de données](view-and-modify-push-subscription-properties.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-265">[View and Modify Push Subscription Properties](view-and-modify-push-subscription-properties.md) </span></span>  
 <span data-ttu-id="eb40f-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="eb40f-267">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-267">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="eb40f-268">[Concepts liés à RMO (Replication Management Objects)](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="eb40f-269">[Synchroniser un abonnement par émission de données](synchronize-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-269">[Synchronize a Push Subscription](synchronize-a-push-subscription.md) </span></span>  
 <span data-ttu-id="eb40f-270">[S’abonner aux Publications](subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="eb40f-270">[Subscribe to Publications](subscribe-to-publications.md) </span></span>  
 [<span data-ttu-id="eb40f-271">Utiliser sqlcmd avec des variables de script</span><span class="sxs-lookup"><span data-stu-id="eb40f-271">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
