---
title: SQL Server et clés de chiffrement de base de données (moteur de base de données) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
helpviewer_keywords:
- keys [SQL Server], database encryption
ms.assetid: 15c0a5e8-9177-484c-ae75-8c552dc0dac0
author: jaszymas
ms.author: jaszymas
ms.openlocfilehash: f846e74e0afd89c6bb10a4aa9a23a6420b6a613a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87710515"
---
# <a name="sql-server-and-database-encryption-keys-database-engine"></a><span data-ttu-id="e8c39-102">SQL Server et clés de chiffrement de base de données (moteur de base de données)</span><span class="sxs-lookup"><span data-stu-id="e8c39-102">SQL Server and Database Encryption Keys (Database Engine)</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e8c39-103">utilise des clés de chiffrement pour mieux sécuriser les données, les informations d’identification et les informations de connexion qui sont stockées dans une base de données du serveur.</span><span class="sxs-lookup"><span data-stu-id="e8c39-103">uses encryption keys to help secure data, credentials, and connection information that is stored in a server database.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e8c39-104">a deux types de clés : des clés *symétriques* et *asymétriques*.</span><span class="sxs-lookup"><span data-stu-id="e8c39-104">has two kinds of keys: *symmetric* and *asymmetric*.</span></span> <span data-ttu-id="e8c39-105">Les clés symétriques utilisent le même mot de passe pour chiffrer et déchiffrer des données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-105">Symmetric keys use the same password to encrypt and decrypt data.</span></span> <span data-ttu-id="e8c39-106">Les clés asymétriques utilisent un premier mot de passe pour chiffrer des données (appelé clé *publique* ) et un second mot de passe pour déchiffrer les données (appelé clé *privée* ).</span><span class="sxs-lookup"><span data-stu-id="e8c39-106">Asymmetric keys use one password to encrypt data (called the *public* key) and another to decrypt data (called the *private* key).</span></span>  
  
 <span data-ttu-id="e8c39-107">Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les clés de chiffrement incluent une combinaison d'une clé publique, d'une clé privée et d'une clé symétrique, dont le but est de protéger les données sensibles.</span><span class="sxs-lookup"><span data-stu-id="e8c39-107">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], encryption keys include a combination of public, private, and symmetric keys that are used to protect sensitive data.</span></span> <span data-ttu-id="e8c39-108">La clé symétrique est créée pendant l'initialisation de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , lorsque vous démarrez pour la première fois l'instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="e8c39-108">The symmetric key is created during [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] initialization when you first start the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="e8c39-109">Cette clé est utilisée par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour chiffrer les données sensibles stockées dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8c39-109">The key is used by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to encrypt sensitive data that is stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="e8c39-110">Les clés publique et privée sont créées par le système d'exploitation et servent à protéger la clé symétrique.</span><span class="sxs-lookup"><span data-stu-id="e8c39-110">Public and private keys are created by the operating system and they are used to protect the symmetric key.</span></span> <span data-ttu-id="e8c39-111">Une paire de clés privée et publique est créée pour chaque instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui stocke des données sensibles dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-111">A public and private key pair is created for each [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance that stores sensitive data in a database.</span></span>  
  
## <a name="applications-for-sql-server-and-database-keys"></a><span data-ttu-id="e8c39-112">Applications pour les clés SQL Server et de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-112">Applications for SQL Server and Database Keys</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="e8c39-113">a deux applications principales pour les clés : une *clé principale de service* (SMK) générée sur et pour une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , et une *clé principale de base de données* (DMK) utilisée pour une base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-113">has two primary applications for keys: a *service master key* (SMK) generated on and for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance, and a *database master key* (DMK) used for a database.</span></span>  
  
 <span data-ttu-id="e8c39-114">La clé SMK est générée automatiquement la première fois que l’instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] est démarrée et utilisée pour chiffrer un mot de passe de serveur lié, des informations d’identification et la clé principale de base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-114">The SMK is automatically generated the first time the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance is started and is used to encrypt a linked server password, credentials, and the database master key.</span></span> <span data-ttu-id="e8c39-115">La clé SMK est chiffrée en utilisant la clé de l'ordinateur local à l'aide de l'API de protection des données Windows (DPAPI).</span><span class="sxs-lookup"><span data-stu-id="e8c39-115">The SMK is encrypted by using the local computer key using the Windows Data Protection API (DPAPI).</span></span> <span data-ttu-id="e8c39-116">L’interface DPAPI utilise une clé dérivée des informations d’identification Windows du compte de service [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et des informations d’identification de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e8c39-116">The DPAPI uses a key that is derived from the Windows credentials of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service account and the computer's credentials.</span></span> <span data-ttu-id="e8c39-117">La clé principale de service peut être déchiffrée uniquement par le compte de service sous lequel elle a été créée ou par un principal qui a accès aux informations d'identification de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="e8c39-117">The service master key can only be decrypted by the service account under which it was created or by a principal that has access to the machine's credentials.</span></span>  
  
 <span data-ttu-id="e8c39-118">La clé principale de base de données est une clé symétrique qui permet de protéger les clés privées des certificats et des clés asymétriques présentes dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-118">The database master key is a symmetric key that is used to protect the private keys of certificates and asymmetric keys that are present in the database.</span></span> <span data-ttu-id="e8c39-119">Elle peut également être utilisée pour chiffrer des données, mais elle présente des limitations de longueur qui la rendent moins pratique pour les données que l'utilisation d'une clé symétrique.</span><span class="sxs-lookup"><span data-stu-id="e8c39-119">It can also be used to encrypt data, but it has length limitations that make it less practical for data than using a symmetric key.</span></span>  
  
 <span data-ttu-id="e8c39-120">Lors de sa création, la clé principale est chiffrée à l'aide de l'algorithme Triple DES et d'un mot de passe fourni par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="e8c39-120">When it is created, the master key is encrypted by using the Triple DES algorithm and a user-supplied password.</span></span> <span data-ttu-id="e8c39-121">Pour activer le déchiffrement automatique de la clé principale, une copie de la clé est chiffrée au moyen de la clé SMK.</span><span class="sxs-lookup"><span data-stu-id="e8c39-121">To enable the automatic decryption of the master key, a copy of the key is encrypted by using the SMK.</span></span> <span data-ttu-id="e8c39-122">Elle est stockée à la fois dans la base de données où elle est utilisée et dans la base de données système `master`.</span><span class="sxs-lookup"><span data-stu-id="e8c39-122">It is stored in both the database where it is used and in the `master` system database.</span></span>  
  
 <span data-ttu-id="e8c39-123">La copie de la clé DMK stockée dans la base de données système `master` est mise à jour silencieusement chaque fois que la clé DMK est modifiée.</span><span class="sxs-lookup"><span data-stu-id="e8c39-123">The copy of the DMK stored in the `master` system database is silently updated whenever the DMK is changed.</span></span> <span data-ttu-id="e8c39-124">Toutefois, cette valeur par défaut peut être modifiée en utilisant l'option `DROP ENCRYPTION BY SERVICE MASTER KEY` de l'instruction `ALTER MASTER KEY`.</span><span class="sxs-lookup"><span data-stu-id="e8c39-124">However, this default can be changed by using the `DROP ENCRYPTION BY SERVICE MASTER KEY` option of the `ALTER MASTER KEY` statement.</span></span> <span data-ttu-id="e8c39-125">Une clé DMK qui n'est pas chiffrée par la clé principale de service doit être ouverte à l'aide de l'instruction `OPEN MASTER KEY` et d'un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="e8c39-125">A DMK that is not encrypted by the service master key must be opened by using the `OPEN MASTER KEY` statement and a password.</span></span>  
  
## <a name="managing-sql-server-and-database-keys"></a><span data-ttu-id="e8c39-126">Gestion des clés SQL Server et de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-126">Managing SQL Server and Database Keys</span></span>  
 <span data-ttu-id="e8c39-127">La gestion des clés de chiffrement consiste à créer de nouvelles clés de base de données, à créer une sauvegarde des clés de serveur et de base de données et à savoir quand et comment restaurer, supprimer et modifier les clés.</span><span class="sxs-lookup"><span data-stu-id="e8c39-127">Managing encryption keys consists of creating new database keys, creating a backup of the server and database keys, and knowing when and how to restore, delete, or change the keys.</span></span>  
  
 <span data-ttu-id="e8c39-128">Pour gérer des clés symétriques, vous pouvez utiliser les outils inclus dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="e8c39-128">To manage symmetric keys, you can use the tools included in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to do the following:</span></span>  
  
-   <span data-ttu-id="e8c39-129">Sauvegarde d'une copie des clés de serveur et de base de données permettant de les utiliser pour récupérer une installation de serveur ou dans le cadre d'une migration planifiée.</span><span class="sxs-lookup"><span data-stu-id="e8c39-129">Back up a copy of the server and database keys so that you can use them to recover a server installation, or as part of a planned migration.</span></span>  
  
-   <span data-ttu-id="e8c39-130">Restauration d'une clé précédemment enregistrée dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-130">Restore a previously saved key to a database.</span></span> <span data-ttu-id="e8c39-131">Cela permet à une nouvelle instance de serveur d'accéder aux données existantes qu'elle n'a pas chiffrées à l'origine.</span><span class="sxs-lookup"><span data-stu-id="e8c39-131">This enables a new server instance to access existing data that it did not originally encrypt.</span></span>  
  
-   <span data-ttu-id="e8c39-132">Suppression des données chiffrées d'une base de données au cas improbable où l'accès à ces données chiffrées se révélerait impossible.</span><span class="sxs-lookup"><span data-stu-id="e8c39-132">Delete the encrypted data in a database in the unlikely event that you can no longer access encrypted data.</span></span>  
  
-   <span data-ttu-id="e8c39-133">Recréation de clés et nouveau chiffrement des données dans le cas improbable où la sécurité de la clé serait compromise.</span><span class="sxs-lookup"><span data-stu-id="e8c39-133">Re-create keys and re-encrypt data in the unlikely event that the key is compromised.</span></span> <span data-ttu-id="e8c39-134">Comme meilleure pratique de sécurité, vous devez recréer les clés périodiquement (par exemple, tous les deux ou trois mois) pour protéger le serveur contre des attaques visant à déchiffrer les clés.</span><span class="sxs-lookup"><span data-stu-id="e8c39-134">As a security best practice, you should re-create the keys periodically (for example, every few months) to protect the server from attacks that try to decipher the keys.</span></span>  
  
-   <span data-ttu-id="e8c39-135">Ajout ou suppression d'une instance de serveur à partir d'un déploiement évolutif de serveur dans lequel plusieurs serveurs partagent une base de données unique et la clé qui fournit un chiffrement réversible pour cette base de données.</span><span class="sxs-lookup"><span data-stu-id="e8c39-135">Add or remove a server instance from a server scale-out deployment where multiple servers share both a single database and the key that provides reversible encryption for that database.</span></span>  
  
## <a name="important-security-information"></a><span data-ttu-id="e8c39-136">Informations de sécurité importantes</span><span class="sxs-lookup"><span data-stu-id="e8c39-136">Important Security Information</span></span>  
 <span data-ttu-id="e8c39-137">L'accès aux objets sécurisés par la clé principale du service requiert le compte de service [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui a permis de créer la clé ou le compte d'ordinateur (machine).</span><span class="sxs-lookup"><span data-stu-id="e8c39-137">Accessing objects secured by the service master key requires either the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service account that was used to create the key or the computer (machine) account.</span></span> <span data-ttu-id="e8c39-138">Autrement dit, l'ordinateur est attaché au système dans lequel la clé a été créée.</span><span class="sxs-lookup"><span data-stu-id="e8c39-138">That is, the computer is tied to the system where the key was created.</span></span> <span data-ttu-id="e8c39-139">Vous pouvez modifier le compte de service [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]*ou* le compte d’ordinateur sans perdre l’accès à la clé.</span><span class="sxs-lookup"><span data-stu-id="e8c39-139">You can change the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Service account *or* the computer account without losing access to the key.</span></span> <span data-ttu-id="e8c39-140">Toutefois, si vous modifiez les deux, vous perdrez l'accès à la clé principale de service.</span><span class="sxs-lookup"><span data-stu-id="e8c39-140">However, if you change both, you will lose access to the service master key.</span></span> <span data-ttu-id="e8c39-141">Si vous perdez l’accès à la clé principale de service sans un de ces deux éléments, vous ne pouvez pas déchiffrer les données et les objets chiffrés en utilisant la clé d’origine.</span><span class="sxs-lookup"><span data-stu-id="e8c39-141">If you lose access to the service master key without one of these two elements, you be unable to decrypt data and objects encrypted by using the original key.</span></span>  
  
 <span data-ttu-id="e8c39-142">Les connexions sécurisées avec la clé principale de service ne peuvent pas être restaurées sans la clé principale de service.</span><span class="sxs-lookup"><span data-stu-id="e8c39-142">Connections secured with the service master key cannot be restored without the service master key.</span></span>  
  
 <span data-ttu-id="e8c39-143">L'accès à des objets et données sécurisés avec la clé principale de base de données requiert uniquement le mot de passe utilisé pour sécuriser la clé.</span><span class="sxs-lookup"><span data-stu-id="e8c39-143">Access to objects and data secured with the database master key require only the password that is used to help secure the key.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="e8c39-144">Si vous perdez tout accès aux clés décrites précédemment, vous perdez l'accès aux objets, connexions et données sécurisés par ces clés.</span><span class="sxs-lookup"><span data-stu-id="e8c39-144">If you lose all access to the keys described earlier, you will lose access to the objects, connections, and data secured by those keys.</span></span> <span data-ttu-id="e8c39-145">Vous pouvez restaurer la clé principale de service, comme décrit dans les liens répertoriés ici, ou vous pouvez revenir au système de chiffrement d'origine pour récupérer l'accès.</span><span class="sxs-lookup"><span data-stu-id="e8c39-145">You can restore the service master key, as described in the links that are shown here, or you can go back to the original encrypting system to recover the access.</span></span> <span data-ttu-id="e8c39-146">Il n'existe aucune « porte dérobée » pour récupérer l'accès.</span><span class="sxs-lookup"><span data-stu-id="e8c39-146">There is no "back-door" to recover the access.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="e8c39-147">Dans cette section</span><span class="sxs-lookup"><span data-stu-id="e8c39-147">In This Section</span></span>  
 [<span data-ttu-id="e8c39-148">Clé principale du service</span><span class="sxs-lookup"><span data-stu-id="e8c39-148">Service Master Key</span></span>](service-master-key.md)  
 <span data-ttu-id="e8c39-149">Fournit une brève explication pour la clé principale de service et les meilleures pratiques associées.</span><span class="sxs-lookup"><span data-stu-id="e8c39-149">Provides a brief explanation for the service master key and its best practices.</span></span>  
  
 [<span data-ttu-id="e8c39-150">Gestion de clés extensible &#40;EKM&#41;</span><span class="sxs-lookup"><span data-stu-id="e8c39-150">Extensible Key Management &#40;EKM&#41;</span></span>](extensible-key-management-ekm.md)  
 <span data-ttu-id="e8c39-151">Explique comment utiliser des systèmes de gestion de clés tiers avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e8c39-151">Explains how to use third-party key management systems with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="e8c39-152">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="e8c39-152">Related Tasks</span></span>  
 [<span data-ttu-id="e8c39-153">Sauvegarder la clé principale du service</span><span class="sxs-lookup"><span data-stu-id="e8c39-153">Back Up the Service Master Key</span></span>](back-up-the-service-master-key.md)  
  
 [<span data-ttu-id="e8c39-154">Restaurer la clé principale du service</span><span class="sxs-lookup"><span data-stu-id="e8c39-154">Restore the Service Master Key</span></span>](restore-the-service-master-key.md)  
  
 [<span data-ttu-id="e8c39-155">Créer une clé principale de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-155">Create a Database Master Key</span></span>](create-a-database-master-key.md)  
  
 [<span data-ttu-id="e8c39-156">Sauvegarder une clé primaire de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-156">Back Up a Database Master Key</span></span>](back-up-a-database-master-key.md)  
  
 [<span data-ttu-id="e8c39-157">Restaurer une clé principale de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-157">Restore a Database Master Key</span></span>](restore-a-database-master-key.md)  
  
 [<span data-ttu-id="e8c39-158">Créer des clés symétriques identiques sur deux serveurs</span><span class="sxs-lookup"><span data-stu-id="e8c39-158">Create Identical Symmetric Keys on Two Servers</span></span>](create-identical-symmetric-keys-on-two-servers.md)  
  
 [<span data-ttu-id="e8c39-159">Gestion de clés extensible à l’aide d’Azure Key Vault &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="e8c39-159">Extensible Key Management Using Azure Key Vault &#40;SQL Server&#41;</span></span>](extensible-key-management-using-azure-key-vault-sql-server.md)  
  
 [<span data-ttu-id="e8c39-160">Activer TDE à l’aide de EKM</span><span class="sxs-lookup"><span data-stu-id="e8c39-160">Enable TDE Using EKM</span></span>](enable-tde-on-sql-server-using-ekm.md)  
  
## <a name="related-content"></a><span data-ttu-id="e8c39-161">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="e8c39-161">Related Content</span></span>  
 [<span data-ttu-id="e8c39-162">CREATE MASTER KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e8c39-162">CREATE MASTER KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-master-key-transact-sql)  
  
 [<span data-ttu-id="e8c39-163">ALTER SERVICE MASTER KEY &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="e8c39-163">ALTER SERVICE MASTER KEY &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-service-master-key-transact-sql)  
  
 [<span data-ttu-id="e8c39-164">Restaurer une clé principale de base de données</span><span class="sxs-lookup"><span data-stu-id="e8c39-164">Restore a Database Master Key</span></span>](restore-a-database-master-key.md)  
  
## <a name="see-also"></a><span data-ttu-id="e8c39-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e8c39-165">See Also</span></span>  
 <span data-ttu-id="e8c39-166">[Sauvegarder et restaurer les clés de chiffrement Reporting Services](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="e8c39-166">[Back Up and Restore Reporting Services Encryption Keys](../../../reporting-services/install-windows/ssrs-encryption-keys-back-up-and-restore-encryption-keys.md) </span></span>  
 <span data-ttu-id="e8c39-167">[Supprimer et recréer des clés de chiffrement &#40;Gestionnaire de configuration de SSRS&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span><span class="sxs-lookup"><span data-stu-id="e8c39-167">[Delete and Re-create Encryption Keys  &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/ssrs-encryption-keys-delete-and-re-create-encryption-keys.md) </span></span>  
 <span data-ttu-id="e8c39-168">[Ajouter et supprimer des clés de chiffrement pour un déploiement évolutif &#40;Gestionnaire de configuration de SSRS&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span><span class="sxs-lookup"><span data-stu-id="e8c39-168">[Add and Remove Encryption Keys for Scale-Out Deployment &#40;SSRS Configuration Manager&#41;](../../../reporting-services/install-windows/add-and-remove-encryption-keys-for-scale-out-deployment.md) </span></span>  
 [<span data-ttu-id="e8c39-169">Chiffrement transparent des données &#40;TDE&#41;</span><span class="sxs-lookup"><span data-stu-id="e8c39-169">Transparent Data Encryption &#40;TDE&#41;</span></span>](transparent-data-encryption.md)  
  
  
