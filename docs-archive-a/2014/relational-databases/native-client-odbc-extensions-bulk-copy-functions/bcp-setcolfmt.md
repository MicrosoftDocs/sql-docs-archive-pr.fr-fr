---
title: bcp_setcolfmt | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- bcp_setcolfmt
api_location:
- sqlncli11.dll
topic_type:
- apiref
helpviewer_keywords:
- bcp_setcolfmt function
ms.assetid: afb47987-39e7-4079-ad66-e0abf4d4c72b
author: rothja
ms.author: jroth
ms.openlocfilehash: bb3b1da62ab4e98ed4497dd11fcc20163025058b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611054"
---
# <a name="bcp_setcolfmt"></a><span data-ttu-id="f6762-102">bcp_setcolfmt</span><span class="sxs-lookup"><span data-stu-id="f6762-102">bcp_setcolfmt</span></span>
  <span data-ttu-id="f6762-103">La fonction **bcp_setcolfmt** remplace la [bcp_colfmt](bcp-colfmt.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-103">The **bcp_setcolfmt** function supersedes the [bcp_colfmt](bcp-colfmt.md).</span></span> <span data-ttu-id="f6762-104">En spécifiant le classement des colonnes, vous devez utiliser la fonction **bcp_setcolfmt** .</span><span class="sxs-lookup"><span data-stu-id="f6762-104">In specifying the column collation, the **bcp_setcolfmt** function must be used.</span></span> <span data-ttu-id="f6762-105">[bcp_setbulkmode](bcp-setbulkmode.md) peut être utilisé pour spécifier plusieurs formats de colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-105">[bcp_setbulkmode](bcp-setbulkmode.md) can be used to specify more than one column format.</span></span>  
  
 <span data-ttu-id="f6762-106">Cette fonction propose une approche souple pour la définition du format des colonnes dans le cadre d'une opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="f6762-106">This function provides a flexible approach to specifying the column format in a bulk copy operation.</span></span> <span data-ttu-id="f6762-107">Elle est employée pour définir des attributs de format de colonne individuels.</span><span class="sxs-lookup"><span data-stu-id="f6762-107">It is used to set individual column format attributes.</span></span> <span data-ttu-id="f6762-108">Chaque appel à **bcp_setcolfmt** définit un attribut de format de colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-108">Each call to **bcp_setcolfmt** sets one column format attribute.</span></span>  
  
 <span data-ttu-id="f6762-109">La fonction **bcp_setcolfmt** spécifie le format de la source ou de la cible des données dans un fichier utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6762-109">The **bcp_setcolfmt** function specifies the source or target format of the data in a user file.</span></span> <span data-ttu-id="f6762-110">Lorsqu’il est utilisé comme format source, **bcp_setcolfmt** spécifie le format d’un fichier de données existant utilisé comme source de données de données dans une copie en bloc dans une table dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f6762-110">When used as a source format, **bcp_setcolfmt** specifies the format of an existing data file used as a data source of data in a bulk copy to a table in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="f6762-111">Lorsqu’il est utilisé comme format cible, le fichier de données est créé à l’aide des formats de colonne spécifiés avec **bcp_setcolfmt**.</span><span class="sxs-lookup"><span data-stu-id="f6762-111">When used as a target format, the data file is created using the column formats specified with **bcp_setcolfmt**.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="f6762-112">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="f6762-112">Syntax</span></span>  
  
```  
  
RETCODE bcp_setcolfmt (  
HDBC   
hdbc  
,  
INT   
field  
,  
INT   
property  
,  
void*   
pValue  
,  
INT   
cbValue  
);  
  
```  
  
## <a name="arguments"></a><span data-ttu-id="f6762-113">Arguments</span><span class="sxs-lookup"><span data-stu-id="f6762-113">Arguments</span></span>  
 <span data-ttu-id="f6762-114">*hdbc*</span><span class="sxs-lookup"><span data-stu-id="f6762-114">*hdbc*</span></span>  
 <span data-ttu-id="f6762-115">Handle de connexion ODBC compatible avec la copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="f6762-115">Is the bulk copy-enabled ODBC connection handle.</span></span>  
  
 <span data-ttu-id="f6762-116">*case*</span><span class="sxs-lookup"><span data-stu-id="f6762-116">*field*</span></span>  
 <span data-ttu-id="f6762-117">Numéro de colonne ordinal pour lequel la propriété est définie.</span><span class="sxs-lookup"><span data-stu-id="f6762-117">Is the ordinal column number for which the property is being set.</span></span>  
  
 <span data-ttu-id="f6762-118">*property*</span><span class="sxs-lookup"><span data-stu-id="f6762-118">*property*</span></span>  
 <span data-ttu-id="f6762-119">L'une des constantes de propriété.</span><span class="sxs-lookup"><span data-stu-id="f6762-119">Is one of the property constants.</span></span> <span data-ttu-id="f6762-120">Les constantes de propriété sont définies dans le tableau qui suit.</span><span class="sxs-lookup"><span data-stu-id="f6762-120">Property constants are defined in this table.</span></span>  
  
|<span data-ttu-id="f6762-121">Propriété</span><span class="sxs-lookup"><span data-stu-id="f6762-121">Property</span></span>|<span data-ttu-id="f6762-122">Valeur</span><span class="sxs-lookup"><span data-stu-id="f6762-122">Value</span></span>|<span data-ttu-id="f6762-123">Description</span><span class="sxs-lookup"><span data-stu-id="f6762-123">Description</span></span>|  
|--------------|-----------|-----------------|  
|<span data-ttu-id="f6762-124">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="f6762-124">BCP_FMT_TYPE</span></span>|<span data-ttu-id="f6762-125">BYTE</span><span class="sxs-lookup"><span data-stu-id="f6762-125">BYTE</span></span>|<span data-ttu-id="f6762-126">Type de données de la colonne dans le fichier utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6762-126">Is the data type of this column in the user file.</span></span> <span data-ttu-id="f6762-127">Si le type de données est différent de celui de la colonne correspondante dans la table de base de données, la copie en bloc convertit, si possible, les données.</span><span class="sxs-lookup"><span data-stu-id="f6762-127">If different from the data type of the corresponding column in the database table, bulk copy converts the data if possible.</span></span><br /><br /> <span data-ttu-id="f6762-128">Le paramètre BCP_FMT_TYPE est énuméré par les jetons de type de données SQL Server dans sqlncli.h, et non par les énumérateurs de type de données C ODBC.</span><span class="sxs-lookup"><span data-stu-id="f6762-128">The BCP_FMT_TYPE parameter is enumerated by the SQL Server data type tokens in sqlncli.h, rather than the ODBC C data type enumerators.</span></span> <span data-ttu-id="f6762-129">Par exemple, vous pouvez spécifier une chaîne de caractères (type de données ODBC SQL_C_CHAR) à l'aide du type SQLCHARACTER propre à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f6762-129">For example, you can specify a character string, ODBC type SQL_C_CHAR, using the SQLCHARACTER type specific to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="f6762-130">Pour spécifier la représentation des données par défaut pour le type de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , attribuez la valeur 0 à ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="f6762-130">To specify the default data representation for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type, set this parameter to 0.</span></span><br /><br /> <span data-ttu-id="f6762-131">Pour une copie en bloc dans un fichier hors SQL Server, lorsque BCP_FMT_TYPE est SQLDECIMAL ou SQLNUMERIC :</span><span class="sxs-lookup"><span data-stu-id="f6762-131">For a bulk copy out of SQL Server into a file, when BCP_FMT_TYPE is SQLDECIMAL or SQLNUMERIC:</span></span><br /><br /> <span data-ttu-id="f6762-132">-Si la colonne source n’est pas **décimale** ou **numérique**, la précision et l’échelle par défaut sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="f6762-132">-   If the source column is not **decimal** or **numeric**, the default precision and scale are used.</span></span><br /><span data-ttu-id="f6762-133">-Si la colonne source est **décimale** ou **numérique**, la précision et l’échelle de la colonne source sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="f6762-133">-   If the source column is **decimal** or **numeric**, the precision and scale of the source column are used.</span></span>|  
|<span data-ttu-id="f6762-134">BCP_FMT_INDICATOR_LEN</span><span class="sxs-lookup"><span data-stu-id="f6762-134">BCP_FMT_INDICATOR_LEN</span></span>|<span data-ttu-id="f6762-135">INT</span><span class="sxs-lookup"><span data-stu-id="f6762-135">INT</span></span>|<span data-ttu-id="f6762-136">Longueur, en octets, de l'indicateur (préfixe).</span><span class="sxs-lookup"><span data-stu-id="f6762-136">Is the length in bytes of the indicator (prefix).</span></span><br /><br /> <span data-ttu-id="f6762-137">Longueur, en octets, d'un indicateur de longueur/null au sein des données de la colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-137">It is the length, in bytes, of a length/null indicator within the column data.</span></span> <span data-ttu-id="f6762-138">Les valeurs de longueur d'indicateur valides sont 0 (quand aucun indicateur n'est utilisé), 1, 2, 4 ou 8.</span><span class="sxs-lookup"><span data-stu-id="f6762-138">Valid indicator length values are 0 (when using no indicator), 1, 2, or 4.</span></span><br /><br /> <span data-ttu-id="f6762-139">Pour spécifier l'utilisation d'un indicateur de copie en bloc par défaut, définissez ce paramètre sur SQL_VARLEN_DATA.</span><span class="sxs-lookup"><span data-stu-id="f6762-139">To specify default bulk copy indicator usage, set this parameter to SQL_VARLEN_DATA.</span></span><br /><br /> <span data-ttu-id="f6762-140">Les indicateurs apparaissent directement en mémoire avant les autres données et, dans le fichier de données, juste avant les données auxquelles ils s'appliquent.</span><span class="sxs-lookup"><span data-stu-id="f6762-140">Indicators appear in memory directly before any data, and in the data file directly before the data to which they apply.</span></span><br /><br /> <span data-ttu-id="f6762-141">Si plusieurs méthodes de spécification de la longueur de colonne d'un fichier de données sont utilisées (par exemple, un indicateur et une longueur de colonne maximale, ou un indicateur et une séquence de terminaison), la copie en bloc choisit celle qui implique la quantité de données à copier la moins élevée.</span><span class="sxs-lookup"><span data-stu-id="f6762-141">If more than one means of specifying a data file column length is used (such as an indicator and a maximum column length, or an indicator and a terminator sequence), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="f6762-142">Les fichiers de données générés par la copie en bloc lorsqu'aucune intervention de l'utilisateur n'ajuste le format des données contiennent des indicateurs si la longueur des données de la colonne est variable ou si la colonne peut accepter la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="f6762-142">Data files generated by bulk copy when no user intervention adjusts the format of the data contain indicators when the column data can vary in length or the column can accept NULL as a value.</span></span>|  
|<span data-ttu-id="f6762-143">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="f6762-143">BCP_FMT_DATA_LEN</span></span>|<span data-ttu-id="f6762-144">DBINT</span><span class="sxs-lookup"><span data-stu-id="f6762-144">DBINT</span></span>|<span data-ttu-id="f6762-145">Longueur, en octets, des données (longueur de colonne).</span><span class="sxs-lookup"><span data-stu-id="f6762-145">Is the length in bytes of the data (column length)</span></span><br /><br /> <span data-ttu-id="f6762-146">Longueur maximale, en octets, des données de cette colonne dans le fichier utilisateur, hormis la longueur d'un indicateur de longueur ou d'un terminateur.</span><span class="sxs-lookup"><span data-stu-id="f6762-146">It is the maximum length, in bytes, of this column's data in the user file, not including the length of any length indicator or terminator.</span></span><br /><br /> <span data-ttu-id="f6762-147">La définition de BCP_FMT_DATA_LEN sur SQL_NULL_DATA indique que toutes les valeurs de la colonne du fichier de données ont ou doivent avoir la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="f6762-147">Setting BCP_FMT_DATA_LEN to SQL_NULL_DATA indicates that all values in the data file column are, or should be set to, NULL.</span></span><br /><br /> <span data-ttu-id="f6762-148">La définition de BCP_FMT_DATA_LEN sur SQL_VARLEN_DATA indique que le système doit déterminer la longueur des données dans chaque colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-148">Setting BCP_FMT_DATA_LEN to SQL_VARLEN_DATA indicates that the system should determine the length of data in each column.</span></span> <span data-ttu-id="f6762-149">Pour certaines colonnes, cela peut signifier qu'un indicateur de longueur/null est généré pour précéder les données dans une copie à partir de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]ou que l'indicateur est attendu dans les données copiées vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f6762-149">For some columns, this could mean that a length/null indicator is generated to precede data on a copy from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], or that the indicator is expected in data copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span><br /><br /> <span data-ttu-id="f6762-150">Pour les types de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character et binary, BCP_FMT_DATA_LEN peut avoir comme valeur SQL_VARLEN_DATA, SQL_NULL_DATA, 0 ou une valeur positive quelconque.</span><span class="sxs-lookup"><span data-stu-id="f6762-150">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character and binary data types, BCP_FMT_DATA_LEN can be SQL_VARLEN_DATA, SQL_NULL_DATA, 0, or some positive value.</span></span> <span data-ttu-id="f6762-151">Si BCP_FMT_DATA_LEN a la valeur SQL_VARLEN_DATA, le système utilise l'indicateur de longueur (si disponible) ou une séquence de terminaison afin de déterminer la longueur des données.</span><span class="sxs-lookup"><span data-stu-id="f6762-151">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the system uses either the length indicator, if present, or a terminator sequence to determine the length of the data.</span></span> <span data-ttu-id="f6762-152">Si un indicateur de longueur et une séquence de terminaison sont fournis, la copie en bloc utilise celui qui implique le volume de données à copier le plus faible.</span><span class="sxs-lookup"><span data-stu-id="f6762-152">If both a length indicator and a terminator sequence are supplied, bulk copy uses the one that results in the least amount of data being copied.</span></span> <span data-ttu-id="f6762-153">Si BCP_FMT_DATA_LEN a la valeur SQL_VARLEN_DATA, si le type de données est un type [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character ou binary et si aucun indicateur de longueur ou séquence de terminaison n'est spécifié, le système retourne un message d'erreur.</span><span class="sxs-lookup"><span data-stu-id="f6762-153">If BCP_FMT_DATA_LEN is SQL_VARLEN_DATA, the data type is an [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character or binary type, and neither a length indicator nor a terminator sequence is specified, the system returns an error message.</span></span><br /><br /> <span data-ttu-id="f6762-154">Si BCP_FMT_DATA_LEN affiche une valeur égale à 0 ou une valeur positive, le système utilise BCP_FMT_DATA_LEN comme longueur de données maximale.</span><span class="sxs-lookup"><span data-stu-id="f6762-154">If BCP_FMT_DATA_LEN is 0 or a positive value, the system uses BCP_FMT_DATA_LEN as the maximum data length.</span></span> <span data-ttu-id="f6762-155">Toutefois, si un indicateur de longueur ou une séquence de terminaison est fourni en plus d'une valeur BCP_FMT_DATA_LEN positive, le système détermine la longueur de données en utilisant la méthode qui implique le moins de données à copier.</span><span class="sxs-lookup"><span data-stu-id="f6762-155">However, if, in addition to a positive BCP_FMT_DATA_LEN, a length indicator or terminator sequence is provided, the system determines the data length by using the method that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="f6762-156">La valeur BCP_FMT_DATA_LEN représente le nombre d'octets de données.</span><span class="sxs-lookup"><span data-stu-id="f6762-156">The BCP_FMT_DATA_LEN value represents the count of bytes of data.</span></span> <span data-ttu-id="f6762-157">Si des données de caractères sont représentées par des caractères Unicode larges, une valeur de paramètre BCP_FMT_DATA_LEN positive représente le nombre de caractères multiplié par la taille, en octets, de chacun des caractères.</span><span class="sxs-lookup"><span data-stu-id="f6762-157">If character data is represented by Unicode wide characters, then a positive BCP_FMT_DATA_LEN parameter value represents the number of characters multiplied by the size, in bytes, of each character.</span></span>|  
|<span data-ttu-id="f6762-158">BCP_FMT_TERMINATOR</span><span class="sxs-lookup"><span data-stu-id="f6762-158">BCP_FMT_TERMINATOR</span></span>|<span data-ttu-id="f6762-159">LPCBYTE</span><span class="sxs-lookup"><span data-stu-id="f6762-159">LPCBYTE</span></span>|<span data-ttu-id="f6762-160">Pointeur vers la séquence de terminaison (ANSI ou Unicode, selon les besoins) à utiliser pour cette colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-160">Pointer to the terminator sequence (either ANSI or Unicode as appropriate) to be used for this column.</span></span> <span data-ttu-id="f6762-161">Ce paramètre est utile surtout pour les types de données de caractères puisque tous les autres types sont de longueur fixe ou, dans le cas des données binaires, nécessitent un indicateur de longueur pour enregistrer avec précision le nombre d'octets présents.</span><span class="sxs-lookup"><span data-stu-id="f6762-161">This parameter is useful mainly for character data types because all other types are of fixed length or, in the case of binary data, require an indicator of length to accurately record the number of bytes present.</span></span><br /><br /> <span data-ttu-id="f6762-162">Pour éviter de terminer des données extraites ou pour indiquer que les données dans un fichier utilisateur ne sont pas terminées, attribuez la valeur NULL à ce paramètre.</span><span class="sxs-lookup"><span data-stu-id="f6762-162">To avoid terminating extracted data, or to indicate that data in a user file is not terminated, set this parameter to NULL.</span></span><br /><br /> <span data-ttu-id="f6762-163">Si plusieurs méthodes sont employées pour définir la longueur des colonnes du fichier utilisateur (par exemple, un terminateur et un indicateur de longueur, ou un terminateur et une longueur de colonne maximale), la copie en bloc choisit celle qui implique le volume de données à copier le moins élevé.</span><span class="sxs-lookup"><span data-stu-id="f6762-163">If more than one means of specifying a user-file column length is used (such as a terminator and a length indicator, or a terminator and a maximum column length), bulk copy chooses the one that results in the least amount of data being copied.</span></span><br /><br /> <span data-ttu-id="f6762-164">L'interface de programmation d'applications (API) de la copie en bloc procède à la conversion des caractères Unicode vers MBCS en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="f6762-164">The bulk copy API performs Unicode-to-MBCS character conversion as required.</span></span> <span data-ttu-id="f6762-165">Prenez soin de définir comme il se doit la chaîne d'octets de terminaison et la longueur de cette même chaîne.</span><span class="sxs-lookup"><span data-stu-id="f6762-165">Care must be taken to ensure that both the terminator byte string and the length of the byte string are set correctly.</span></span>|  
|<span data-ttu-id="f6762-166">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="f6762-166">BCP_FMT_SERVER_COL</span></span>|<span data-ttu-id="f6762-167">INT</span><span class="sxs-lookup"><span data-stu-id="f6762-167">INT</span></span>|<span data-ttu-id="f6762-168">Position ordinale de la colonne dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="f6762-168">Ordinal position of the column in the database</span></span>|  
|<span data-ttu-id="f6762-169">BCP_FMT_COLLATION</span><span class="sxs-lookup"><span data-stu-id="f6762-169">BCP_FMT_COLLATION</span></span>|<span data-ttu-id="f6762-170">LPCSTR</span><span class="sxs-lookup"><span data-stu-id="f6762-170">LPCSTR</span></span>|<span data-ttu-id="f6762-171">Nom du classement.</span><span class="sxs-lookup"><span data-stu-id="f6762-171">Collation name.</span></span>|  
  
 <span data-ttu-id="f6762-172">*pValue*</span><span class="sxs-lookup"><span data-stu-id="f6762-172">*pValue*</span></span>  
 <span data-ttu-id="f6762-173">Pointeur vers la valeur à associer à la *propriété*.</span><span class="sxs-lookup"><span data-stu-id="f6762-173">Is the pointer to the value to associate to the *property*.</span></span> <span data-ttu-id="f6762-174">Il permet de définir individuellement chaque propriété de format de colonne.</span><span class="sxs-lookup"><span data-stu-id="f6762-174">It allows each column format property to be set individually.</span></span>  
  
 <span data-ttu-id="f6762-175">*cbvalue*</span><span class="sxs-lookup"><span data-stu-id="f6762-175">*cbvalue*</span></span>  
 <span data-ttu-id="f6762-176">Taille de la mémoire tampon de propriété, en octets.</span><span class="sxs-lookup"><span data-stu-id="f6762-176">Is the length of the property buffer in bytes.</span></span>  
  
## <a name="returns"></a><span data-ttu-id="f6762-177">Retours</span><span class="sxs-lookup"><span data-stu-id="f6762-177">Returns</span></span>  
 <span data-ttu-id="f6762-178">SUCCEED ou FAIL.</span><span class="sxs-lookup"><span data-stu-id="f6762-178">SUCCEED or FAIL.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="f6762-179">Notes</span><span class="sxs-lookup"><span data-stu-id="f6762-179">Remarks</span></span>  
 <span data-ttu-id="f6762-180">Cette fonction remplace la fonction **bcp_colfmt** .</span><span class="sxs-lookup"><span data-stu-id="f6762-180">This function supersedes the **bcp_colfmt** function.</span></span> <span data-ttu-id="f6762-181">Toutes les fonctionnalités de **bcp_colfmt** sont fournies dans **bcp_setcolfmt** fonction.</span><span class="sxs-lookup"><span data-stu-id="f6762-181">All the functionality of **bcp_colfmt** is provided in **bcp_setcolfmt** function.</span></span> <span data-ttu-id="f6762-182">Le classement des colonnes est également pris en charge.</span><span class="sxs-lookup"><span data-stu-id="f6762-182">In addition, support for column collation is also provided.</span></span> <span data-ttu-id="f6762-183">Il est préférable de définir les attributs de format de colonne suivants dans l'ordre précisé ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="f6762-183">It is recommended that the following column format attributes be set in the order given below:</span></span>  
  
 <span data-ttu-id="f6762-184">BCP_FMT_SERVER_COL</span><span class="sxs-lookup"><span data-stu-id="f6762-184">BCP_FMT_SERVER_COL</span></span>  
  
 <span data-ttu-id="f6762-185">BCP_FMT_DATA_LEN</span><span class="sxs-lookup"><span data-stu-id="f6762-185">BCP_FMT_DATA_LEN</span></span>  
  
 <span data-ttu-id="f6762-186">BCP_FMT_TYPE</span><span class="sxs-lookup"><span data-stu-id="f6762-186">BCP_FMT_TYPE</span></span>  
  
 <span data-ttu-id="f6762-187">La fonction **bcp_setcolfmt** vous permet de spécifier le format de fichier utilisateur pour les copies en bloc.</span><span class="sxs-lookup"><span data-stu-id="f6762-187">The **bcp_setcolfmt** function allows you to specify the user-file format for bulk copies.</span></span> <span data-ttu-id="f6762-188">Pour la copie en bloc, un format se compose des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="f6762-188">For bulk copy, a format contains the following parts:</span></span>  
  
-   <span data-ttu-id="f6762-189">Mappage des colonnes du fichier utilisateur avec les colonnes de la base de données</span><span class="sxs-lookup"><span data-stu-id="f6762-189">A mapping from user-file columns to database columns.</span></span>  
  
-   <span data-ttu-id="f6762-190">Type de données de chaque colonne du fichier utilisateur</span><span class="sxs-lookup"><span data-stu-id="f6762-190">The data type of each user-file column.</span></span>  
  
-   <span data-ttu-id="f6762-191">Longueur de l'indicateur facultatif pour chaque colonne</span><span class="sxs-lookup"><span data-stu-id="f6762-191">The length of the optional indicator for each column.</span></span>  
  
-   <span data-ttu-id="f6762-192">Longueur maximale des données par colonne du fichier utilisateur</span><span class="sxs-lookup"><span data-stu-id="f6762-192">The maximum length of data per user-file column.</span></span>  
  
-   <span data-ttu-id="f6762-193">Séquence d'octets de fin facultative pour chaque colonne</span><span class="sxs-lookup"><span data-stu-id="f6762-193">The optional terminating byte sequence for each column.</span></span>  
  
-   <span data-ttu-id="f6762-194">Longueur de la séquence d'octets de fin facultative</span><span class="sxs-lookup"><span data-stu-id="f6762-194">The length of the optional terminating byte sequence.</span></span>  
  
 <span data-ttu-id="f6762-195">Chaque appel à **bcp_setcolfmt** spécifie le format pour une colonne de fichier utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6762-195">Each call to **bcp_setcolfmt** specifies the format for one user-file column.</span></span> <span data-ttu-id="f6762-196">Par exemple, pour modifier les paramètres par défaut de trois colonnes dans un fichier de données utilisateur de cinq colonnes, appelez d’abord [bcp_columns](bcp-columns.md)**(5)**, puis appelez **bcp_setcolfmt** cinq fois, avec trois de ces appels définissant votre format personnalisé.</span><span class="sxs-lookup"><span data-stu-id="f6762-196">For example, to change the default settings for three columns in a five-column user data file, first call [bcp_columns](bcp-columns.md)**(5)**, and then call **bcp_setcolfmt** five times, with three of those calls setting your custom format.</span></span> <span data-ttu-id="f6762-197">Pour les deux appels restants, affectez à BCP_FMT_TYPE la valeur 0 et à BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN et *cbValue* respectivement la valeur 0, SQL_VARLEN_DATA et 0.</span><span class="sxs-lookup"><span data-stu-id="f6762-197">For the remaining two calls, set BCP_FMT_TYPE to 0, and set BCP_FMT_INDICATOR_LENGTH, BCP_FMT_DATA_LEN, and *cbValue* to 0, SQL_VARLEN_DATA, and 0 respectively.</span></span> <span data-ttu-id="f6762-198">Cette procédure copie les cinq colonnes, trois avec votre format personnalisé et deux avec le format par défaut.</span><span class="sxs-lookup"><span data-stu-id="f6762-198">This procedure copies all five columns, three with your customized format and two with the default format.</span></span>  
  
 <span data-ttu-id="f6762-199">La fonction **bcp_columns** doit être appelée avant d’appeler **bcp_setcolfmt**.</span><span class="sxs-lookup"><span data-stu-id="f6762-199">The **bcp_columns** function must be called before calling **bcp_setcolfmt**.</span></span>  
  
 <span data-ttu-id="f6762-200">Vous devez appeler **bcp_setcolfmt** une fois pour chaque propriété de chaque colonne dans le fichier utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f6762-200">You must call **bcp_setcolfmt** once for each property of each column in the user file.</span></span>  
  
 <span data-ttu-id="f6762-201">Vous n'avez pas besoin de copier toutes les données d'un fichier utilisateur dans la table SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f6762-201">You do not need to copy all data in a user file to the SQL Server table.</span></span> <span data-ttu-id="f6762-202">Pour ignorer une colonne, spécifiez le format des données de la colonne en attribuant la valeur 0 au paramètre BCP_FMT_SERVER_COL.</span><span class="sxs-lookup"><span data-stu-id="f6762-202">To skip a column, specify the format of the data for the column, setting the BCP_FMT_SERVER_COL parameter to 0.</span></span> <span data-ttu-id="f6762-203">Pour ignorer une colonne, vous devez spécifier son type.</span><span class="sxs-lookup"><span data-stu-id="f6762-203">If you want to skip a column, you must specify its type.</span></span>  
  
 <span data-ttu-id="f6762-204">La fonction [bcp_writefmt](bcp-writefmt.md) peut être utilisée pour garantir la persistance du format spécifié.</span><span class="sxs-lookup"><span data-stu-id="f6762-204">The [bcp_writefmt](bcp-writefmt.md) function can be used to persist the format specification.</span></span>  
  
## <a name="bcp_setcolfmt-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="f6762-205">Prise en charge de la fonction bcp_setcolfmt pour les fonctionnalités de date et heure améliorées</span><span class="sxs-lookup"><span data-stu-id="f6762-205">bcp_setcolfmt Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="f6762-206">Les types utilisés avec la propriété BCP_FMT_TYPE pour les types date/heure sont les mêmes que ceux spécifiés dans les [modifications de copie en bloc pour les types de date et d’heure améliorés &#40;OLE DB et ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-206">The types used with the BCP_FMT_TYPE property for date/time types are as specified in [Bulk Copy Changes for Enhanced Date and Time Types &#40;OLE DB and ODBC&#41;](../native-client-odbc-date-time/bulk-copy-changes-for-enhanced-date-and-time-types-ole-db-and-odbc.md).</span></span>  
  
 <span data-ttu-id="f6762-207">Pour plus d’informations, consultez améliorations de la [date et de l’heure &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-207">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f6762-208">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f6762-208">See Also</span></span>  
 [<span data-ttu-id="f6762-209">Bulk Copy Functions</span><span class="sxs-lookup"><span data-stu-id="f6762-209">Bulk Copy Functions</span></span>](sql-server-driver-extensions-bulk-copy-functions.md)  
  
  
