---
title: Environnement hébergé du CLR | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- type-safe code [CLR integration]
- UNSAFE permission set
- run-time environments [CLR integration]
- common language runtime [SQL Server], about CLR integration
- application domains [CLR integration]
- host protection attributes [CLR integration]
- managed code [SQL Server], common language runtime
- permission sets [CLR integration]
- reliability [CLR integration]
- SAFE permission set
- code access security [CLR integration]
- EXTERNAL_ACCESS permission set
- verifying type safety
- scalability [CLR integration]
- hosted environments [CLR integration]
- HPAs [CLR integration]
ms.assetid: d280d359-08f0-47b5-a07e-67dd2a58ad73
author: rothja
ms.author: jroth
ms.openlocfilehash: bd04536d1dfb8a4657fbe116cdfd38a6639a6327
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704159"
---
# <a name="clr-hosted-environment"></a><span data-ttu-id="cc2ac-102">Environnement hébergé CLR</span><span class="sxs-lookup"><span data-stu-id="cc2ac-102">CLR Hosted Environment</span></span>
  <span data-ttu-id="cc2ac-103">Le CLR (Common Language Runtime) [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework est un environnement qui exécute de nombreux langages de programmation modernes, y compris [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic et [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-103">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] .NET Framework common language runtime (CLR) is an environment that executes many modern programming languages, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C#, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic, and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C++.</span></span> <span data-ttu-id="cc2ac-104">Le CLR propose une mémoire récupérée par le garbage collector, un threading préemptif, des services de métadonnées (réflexion de type), la vérifiabilité du code et la sécurité d'accès du code.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-104">The CLR features garbage-collected memory, pre-emptive threading, metadata services (type reflection), code verifiability, and code access security.</span></span> <span data-ttu-id="cc2ac-105">Le CLR utilise les métadonnées pour rechercher et charger des classes, placer des instances en mémoire, résoudre des appels de méthode, générer un code natif, appliquer la sécurité et définir les limites du contexte d'exécution.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-105">The CLR uses metadata to locate and load classes, lay out instances in memory, resolve method invocations, generate native code, enforce security, and set run-time context boundaries.</span></span>  
  
 <span data-ttu-id="cc2ac-106">Le CLR et [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] diffèrent comme environnements d'exécution dans leur façon de gérer la mémoire, les threads et la synchronisation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-106">The CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] differ as run-time environments in the way they handle memory, threads, and synchronization.</span></span> <span data-ttu-id="cc2ac-107">Cette rubrique décrit la manière dont ces deux runtimes sont intégrés afin que toutes les ressources système soient gérées uniformément.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-107">This topic describes the way in which these two run times are integrated so that all system resources are managed uniformly.</span></span> <span data-ttu-id="cc2ac-108">Cette rubrique couvre également la manière dont la sécurité d'accès du code CLR et la sécurité [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sont intégrées pour fournir un environnement d'exécution fiable et sécurisé pour le code utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-108">This topic also covers the way in which CLR code access security (CAS) and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] security are integrated to provide a reliable and secure execution environment for user code.</span></span>  
  
## <a name="basic-concepts-of-clr-architecture"></a><span data-ttu-id="cc2ac-109">Concepts de base de l'architecture du CLR</span><span class="sxs-lookup"><span data-stu-id="cc2ac-109">Basic Concepts of CLR Architecture</span></span>  
 <span data-ttu-id="cc2ac-110">Dans le .NET Framework, un programmeur écrit dans un langage de haut niveau qui implémente une classe définissant sa structure (par exemple, les champs ou les propriétés de la classe) et ses méthodes.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-110">In the .NET Framework, a programmer writes in a high-level language that implements a class defining its structure (for example, the fields or properties of the class) and methods.</span></span> <span data-ttu-id="cc2ac-111">Certaines de ces méthodes peuvent être des fonctions statiques.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-111">Some of these methods can be static functions.</span></span> <span data-ttu-id="cc2ac-112">La compilation du programme produit un fichier appelé assembly qui contient le code compilé en langage MSIL ([!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language), ainsi qu'un manifeste qui contient toutes les références aux assemblys dépendants.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-112">The compilation of the program produces a file called an assembly that contains the compiled code in the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] intermediate language (MSIL), and a manifest that contains all references to dependent assemblies.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="cc2ac-113">Les assemblys sont un élément essentiel dans l'architecture du CLR.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-113">Assemblies are a vital element in the architecture of the CLR.</span></span> <span data-ttu-id="cc2ac-114">Ils représentent les unités d'empaquetage, de déploiement et de contrôle de version du code d'application dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-114">They are the units of packaging, deployment, and versioning of application code in the .NET Framework.</span></span> <span data-ttu-id="cc2ac-115">Grâce aux assemblys, vous pouvez déployer le code d'application au sein de la base de données et fournir une méthode uniforme pour administrer, sauvegarder et restaurer des applications de base de données complètes.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-115">Using assemblies, you can deploy application code inside the database and provide a uniform way to administer, back up, and restore complete database applications.</span></span>  
  
 <span data-ttu-id="cc2ac-116">Le manifeste d'assembly contient les métadonnées sur l'assembly, décrivant toutes les structures, les champs, les propriétés, les classes, les relations d'héritage, les fonctions et les méthodes définis dans le programme.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-116">The assembly manifest contains metadata about the assembly, describing all of the structures, fields, properties, classes, inheritance relationships, functions, and methods defined in the program.</span></span> <span data-ttu-id="cc2ac-117">Le manifeste établit l'identité de l'assembly, spécifie les fichiers constituant l'implémentation de l'assembly, spécifie les types et les ressources de l'assembly, détaille les dépendances lors de la compilation par rapport aux autres assemblys et précise l'ensemble des autorisations requises pour que l'assembly fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-117">The manifest establishes the assembly identity, specifies the files that make up the assembly implementation, specifies the types and resources that make up the assembly, itemizes the compile-time dependencies on other assemblies, and specifies the set of permissions required for the assembly to run properly.</span></span> <span data-ttu-id="cc2ac-118">Ces informations sont utilisées au moment de l'exécution pour résoudre les références, appliquer la stratégie de liaison des versions et valider l'intégrité des assemblys chargés.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-118">This information is used at run time to resolve references, enforce version binding policy, and validate the integrity of loaded assemblies.</span></span>  
  
 <span data-ttu-id="cc2ac-119">Le .NET Framework prend en charge les attributs personnalisés pour annoter les classes, les propriétés, les fonctions et les méthodes avec des informations supplémentaires que l'application peut capturer dans les métadonnées.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-119">The .NET Framework supports custom attributes for annotating classes, properties, functions, and methods with additional information the application may capture in metadata.</span></span> <span data-ttu-id="cc2ac-120">Tous les compilateurs .NET Framework consomment ces annotations sans interprétation et les stockent comme des métadonnées d'assembly.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-120">All .NET Framework compilers consume these annotations without interpretation and store them as assembly metadata.</span></span> <span data-ttu-id="cc2ac-121">Ces annotations peuvent être examinées de la même façon que d'autres métadonnées quelconques.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-121">These annotations can be examined in the same way as any other metadata.</span></span>  
  
 <span data-ttu-id="cc2ac-122">Le code managé correspond à du langage MSIL exécuté dans le CLR, plutôt que directement par le système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-122">Managed code is MSIL executed in the CLR, rather than directly by the operating system.</span></span> <span data-ttu-id="cc2ac-123">Les applications de code managé acquièrent les services CLR, tels que le garbage collection automatique, la vérification des types au moment de l'exécution et la prise en charge de la sécurité.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-123">Managed code applications acquire CLR services, such as automatic garbage collection, run-time type checking, and security support.</span></span> <span data-ttu-id="cc2ac-124">Grâce à ces services, les applications de code managé ont un comportement uniforme, indépendant de la plateforme et du langage.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-124">These services help provide uniform platform- and language-independent behavior of managed code applications.</span></span>  
  
## <a name="design-goals-of-clr-integration"></a><span data-ttu-id="cc2ac-125">Objectifs de conception de l'intégration du CLR</span><span class="sxs-lookup"><span data-stu-id="cc2ac-125">Design Goals of CLR Integration</span></span>  
 <span data-ttu-id="cc2ac-126">Lorsque le code utilisateur s'exécute au sein de l'environnement hébergé CLR dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (appelé intégration du CLR), les objectifs de conception suivants s'appliquent :</span><span class="sxs-lookup"><span data-stu-id="cc2ac-126">When user code runs inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (called CLR integration), the following design goals apply:</span></span>  
  
###### <a name="reliability-safety"></a><span data-ttu-id="cc2ac-127">Fiabilité (sécurité)</span><span class="sxs-lookup"><span data-stu-id="cc2ac-127">Reliability (Safety)</span></span>  
 <span data-ttu-id="cc2ac-128">Le code utilisateur ne doit pas être autorisé à effectuer des opérations qui compromettent l'intégrité du processus du moteur de base de données, telles que l'affichage d'une boîte de message demandant une réponse de l'utilisateur ou la sortie du processus.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-128">User code should not be allowed to perform operations that compromise the integrity of the Database Engine process, such as popping a message box requesting a user response or exiting the process.</span></span> <span data-ttu-id="cc2ac-129">Le code utilisateur ne doit pas être en mesure de remplacer les mémoires tampons ou les structures de données internes du moteur de base de données.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-129">User code should not be able to overwrite Database Engine memory buffers or internal data structures.</span></span>  
  
###### <a name="scalability"></a><span data-ttu-id="cc2ac-130">Extensibilité</span><span class="sxs-lookup"><span data-stu-id="cc2ac-130">Scalability</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-131">et le CLR ont des modèles internes différents de planification et de gestion de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-131">and the CLR have different internal models for scheduling and memory management.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-132">prend en charge un modèle de thread coopératif et non préemptif, dans lequel les threads suspendent volontairement leur exécution périodiquement, ou lorsqu'ils attendent des verrous ou des E/S.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-132">supports a cooperative, non-preemptive threading model in which the threads voluntarily yield execution periodically, or when they are waiting on locks or I/O.</span></span> <span data-ttu-id="cc2ac-133">Le CLR prend en charge un modèle de thread préemptif.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-133">The CLR supports a preemptive threading model.</span></span> <span data-ttu-id="cc2ac-134">Si le code utilisateur qui s'exécute au sein de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut appeler directement les primitives de thread du système d'exploitation, il ne s'intègre pas correctement dans le planificateur de tâches [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et peut dégrader l'évolutivité du système.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-134">If user code running inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can directly call the operating system threading primitives, then it does not integrate well into the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] task scheduler and can degrade the scalability of the system.</span></span> <span data-ttu-id="cc2ac-135">Le CLR ne distingue pas la mémoire virtuelle de la mémoire physique, mais [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] gère directement la mémoire physique et doit utiliser la mémoire physique dans une limite configurable.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-135">The CLR does not distinguish between virtual and physical memory, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] directly manages physical memory and is required to use physical memory within a configurable limit.</span></span>  
  
 <span data-ttu-id="cc2ac-136">Les modèles différents de threading, de planification et de gestion de la mémoire présentent une difficulté d'intégration pour un système de gestion de base de données relationnelle (SGBDR) qui évolue pour prendre en charge des milliers de sessions utilisateur simultanées.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-136">The different models for threading, scheduling, and memory management present an integration challenge for a relational database management system (RDBMS) that scales to support thousands of concurrent user sessions.</span></span> <span data-ttu-id="cc2ac-137">L'architecture doit garantir que l'évolutivité du système n'est pas compromise lorsque le code d'utilisateur appelle des interfaces de programmation d'applications (API) directement pour des primitives de thread, de mémoire et de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-137">The architecture should ensure that the scalability of the system is not compromised by user code calling application programming interfaces (APIs) for threading, memory, and synchronization primitives directly.</span></span>  
  
###### <a name="security"></a><span data-ttu-id="cc2ac-138">Sécurité</span><span class="sxs-lookup"><span data-stu-id="cc2ac-138">Security</span></span>  
 <span data-ttu-id="cc2ac-139">Le code utilisateur qui s'exécute dans la base de données doit suivre les règles d'authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et d'autorisation lors de l'accès à des objets de base de données tels que les tables et les colonnes.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-139">User code running in the database must follow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] authentication and authorization rules when accessing database objects such as tables and columns.</span></span> <span data-ttu-id="cc2ac-140">De plus, les administrateurs de base de données doivent être en mesure de contrôler l'accès aux ressources du système d'exploitation, tel que l'accès aux fichiers et au réseau, à partir du code utilisateur qui s'exécute dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-140">In addition, database administrators should be able to control access to operating system resources, such as files and network access, from user code running in the database.</span></span> <span data-ttu-id="cc2ac-141">Cela devient important alors que les langages de programmation managés (contrairement aux langages non managés tels que Transact-SQL) fournissent des API pour accéder à ces ressources.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-141">This becomes important as managed programming languages (unlike non-managed languages such as Transact-SQL) provide APIs to access such resources.</span></span> <span data-ttu-id="cc2ac-142">Le système doit fournir une méthode sécurisée pour que le code utilisateur accède aux ressources d'ordinateur à l'extérieur du processus du [!INCLUDE[ssDE](../../../includes/ssde-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-142">The system must provide a secure way for user code to access machine resources outside the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] process.</span></span> <span data-ttu-id="cc2ac-143">Pour plus d’informations, consultez [Sécurité de l’intégration du CLR](security/clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-143">For more information, see [CLR Integration Security](security/clr-integration-security.md).</span></span>  
  
###### <a name="performance"></a><span data-ttu-id="cc2ac-144">Performances</span><span class="sxs-lookup"><span data-stu-id="cc2ac-144">Performance</span></span>  
 <span data-ttu-id="cc2ac-145">Le code utilisateur managé qui s'exécute dans le [!INCLUDE[ssDE](../../../includes/ssde-md.md)] doit avoir des performances de calcul comparables au même code exécuté hors du serveur.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-145">Managed user code running in the [!INCLUDE[ssDE](../../../includes/ssde-md.md)] should have computational performance comparable to the same code run outside the server.</span></span> <span data-ttu-id="cc2ac-146">L'accès à la base de données à partir du code utilisateur managé n'est pas aussi rapide que pour [!INCLUDE[tsql](../../../includes/tsql-md.md)] natif.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-146">Database access from managed user code is not as fast as native [!INCLUDE[tsql](../../../includes/tsql-md.md)].</span></span> <span data-ttu-id="cc2ac-147">Pour plus d’informations, consultez [performances de l’intégration du CLR](clr-integration-architecture-performance.md).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-147">For more information, see [Performance of CLR Integration](clr-integration-architecture-performance.md).</span></span>  
  
## <a name="clr-services"></a><span data-ttu-id="cc2ac-148">Services CLR</span><span class="sxs-lookup"><span data-stu-id="cc2ac-148">CLR Services</span></span>  
 <span data-ttu-id="cc2ac-149">Le CLR fournit plusieurs services pour atteindre les objectifs de conception de l'intégration du CLR avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-149">The CLR provides a number of services to help achieve the design goals of CLR integration with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
###### <a name="type-safety-verification"></a><span data-ttu-id="cc2ac-150">Vérification de la cohérence des types</span><span class="sxs-lookup"><span data-stu-id="cc2ac-150">Type safety verification</span></span>  
 <span data-ttu-id="cc2ac-151">Un code de type sécurisé est un code qui accède aux structures de mémoire uniquement de façons bien définies.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-151">Type-safe code is code that accesses memory structures only in well-defined ways.</span></span> <span data-ttu-id="cc2ac-152">Prenons par exemple une référence d'objet valide, le code de type sécurisé peut accéder à la mémoire à des offsets fixes correspondant aux membres de champ réels.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-152">For example, given a valid object reference, type-safe code can access memory at fixed offsets corresponding to actual field members.</span></span> <span data-ttu-id="cc2ac-153">Cependant, si le code accède à la mémoire à des offsets arbitraires dans ou hors de la plage de mémoire qui appartient à l'objet, il n'est pas de type sécurisé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-153">However, if the code accesses memory at arbitrary offsets inside or outside the range of memory that belongs to the object, then it is not type-safe.</span></span> <span data-ttu-id="cc2ac-154">Lorsque des assemblys sont chargés dans le CLR, avant que le langage MSIL soit compilé à l'aide de la compilation juste-à-temps (JIT), le runtime effectue une phase de vérification qui examine le code pour déterminer s'il est de type sécurisé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-154">When assemblies are loaded in the CLR, prior to the MSIL being compiled using just-in-time (JIT) compilation, the runtime performs a verification phase that examines code to determine its type-safety.</span></span> <span data-ttu-id="cc2ac-155">Le code qui réussit cette vérification est appelé code de type sécurisé vérifié.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-155">Code that successfully passes this verification is called verifiably type-safe code.</span></span>  
  
###### <a name="application-domains"></a><span data-ttu-id="cc2ac-156">Domaines d'application</span><span class="sxs-lookup"><span data-stu-id="cc2ac-156">Application domains</span></span>  
 <span data-ttu-id="cc2ac-157">Le CLR prend en charge la notion de domaines d'application comme des zones d'exécution au sein d'un processus hôte dans lesquelles des assemblys de code managé peuvent être chargés et exécutés.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-157">The CLR supports the notion of application domains as execution zones within a host process where managed code assemblies can be loaded and executed.</span></span> <span data-ttu-id="cc2ac-158">La limite du domaine d'application assure l'isolement entre les assemblys.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-158">The application domain boundary provides isolation between assemblies.</span></span> <span data-ttu-id="cc2ac-159">Les assemblys sont isolés quant à la visibilité des variables statiques et des membres de données et à la capacité d'appeler dynamiquement le code.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-159">The assemblies are isolated in terms of visibility of static variables and data members and the ability to call code dynamically.</span></span> <span data-ttu-id="cc2ac-160">Les domaines d'application correspondent également au mécanisme de chargement et de déchargement du code.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-160">Application domains are also the mechanism for loading and unloading code.</span></span> <span data-ttu-id="cc2ac-161">Le code peut être déchargé à partir de la mémoire seulement en déchargeant le domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-161">Code can be unloaded from memory only by unloading the application domain.</span></span> <span data-ttu-id="cc2ac-162">Pour plus d’informations, consultez [domaines d’application et sécurité de l’intégration du CLR](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-162">For more information, see [Application Domains and CLR Integration Security](../../database-engine/dev-guide/application-domains-and-clr-integration-security.md).</span></span>  
  
###### <a name="code-access-security-cas"></a><span data-ttu-id="cc2ac-163">Sécurité d'accès du code</span><span class="sxs-lookup"><span data-stu-id="cc2ac-163">Code Access Security (CAS)</span></span>  
 <span data-ttu-id="cc2ac-164">Le système de sécurité du CLR offre un moyen pour à contrôler quels types d'opérations le code managé peut effectuer en assignant des autorisations au code.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-164">The CLR security system provides a way to control what kinds of operations managed code can perform by assigning permissions to code.</span></span> <span data-ttu-id="cc2ac-165">Les autorisations d'accès au code sont assignées en fonction de l'identité du code (par exemple, la signature de l'assembly ou l'origine du code).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-165">Code access permissions are assigned based on code identity (for example, the signature of the assembly or the origin of the code).</span></span>  
  
 <span data-ttu-id="cc2ac-166">Le CLR prévoit une stratégie de l'ordinateur qui peut être définie par l'administrateur de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-166">The CLR provides for a computer-wide policy that can be set by the computer administrator.</span></span> <span data-ttu-id="cc2ac-167">Cette stratégie définit les attributions d'autorisations pour tout code managé qui s'exécute sur l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-167">This policy defines the permission grants for any managed code running on the machine.</span></span> <span data-ttu-id="cc2ac-168">De plus, il existe une stratégie de sécurité au niveau de l'hôte qui peut être utilisée par les hôtes tels que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour spécifier des restrictions supplémentaires sur le code managé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-168">In addition, there is a host-level security policy that can be used by hosts such as [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to specify additional restrictions on managed code.</span></span>  
  
 <span data-ttu-id="cc2ac-169">Si une API managée dans le .NET Framework expose des opérations sur les ressources protégées par une autorisation d'accès au code, l'API demandera cette autorisation avant d'accéder à la ressource.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-169">If a managed API in the .NET Framework exposes operations on resources that are protected by a code access permission, the API will demand that permission before accessing the resource.</span></span> <span data-ttu-id="cc2ac-170">Cette demande conduit le système de sécurité du CLR à déclencher une vérification complète de chaque unité de code (assembly) dans la pile d'appels.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-170">This demand causes the CLR security system to trigger a comprehensive check of every unit of code (assembly) in the call stack.</span></span> <span data-ttu-id="cc2ac-171">L'accès à la ressource est accordé seulement si la chaîne d'appel entière a l'autorisation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-171">Only if the entire call chain has permission will access to the resource be granted.</span></span>  
  
 <span data-ttu-id="cc2ac-172">Notez que la capacité à générer dynamiquement du code managé, à l'aide de l'API Reflection.Emit, n'est pas prise en charge au sein de l'environnement hébergé CLR dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-172">Note that the ability to generate managed code dynamically, using the Reflection.Emit API, is not supported inside the CLR-hosted environment in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cc2ac-173">Un tel code n'aurait pas les autorisations de sécurité d'accès du code pour s'exécuter et échouerait par conséquent au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-173">Such code would not have the CAS permissions to run and would therefore fail at run time.</span></span> <span data-ttu-id="cc2ac-174">Pour plus d’informations, consultez [sécurité d’accès du code d’intégration du CLR](security/clr-integration-code-access-security.md).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-174">For more information, see [CLR Integration Code Access Security](security/clr-integration-code-access-security.md).</span></span>  
  
###### <a name="host-protection-attributes-hpas"></a><span data-ttu-id="cc2ac-175">Attributs de protection de l'hôte (HPA)</span><span class="sxs-lookup"><span data-stu-id="cc2ac-175">Host Protection Attributes (HPAs)</span></span>  
 <span data-ttu-id="cc2ac-176">Le CLR fournit un mécanisme pour annoter les API managées qui font partie du .NET Framework avec certains attributs qui peuvent avoir un intérêt pour un hôte du CLR.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-176">The CLR provides a mechanism to annotate managed APIs that are part of the .NET Framework with certain attributes that may be of interest to a host of the CLR.</span></span> <span data-ttu-id="cc2ac-177">Voici des exemples de tels attributs :</span><span class="sxs-lookup"><span data-stu-id="cc2ac-177">Examples of such attributes include:</span></span>  
  
-   <span data-ttu-id="cc2ac-178">SharedState, qui indique si l'API expose la capacité à créer ou gérer l'état partagé (par exemple, champs de classe statique).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-178">SharedState, which indicates whether the API exposes the ability to create or manage shared state (for example, static class fields).</span></span>  
  
-   <span data-ttu-id="cc2ac-179">Synchronization, qui indique si l'API expose la capacité à réaliser la synchronisation entre des threads.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-179">Synchronization, which indicates whether the API exposes the ability to perform synchronization between threads.</span></span>  
  
-   <span data-ttu-id="cc2ac-180">ExternalProcessMgmt, qui indique si l'API expose une méthode pour contrôler le processus hôte.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-180">ExternalProcessMgmt, which indicates whether the API exposes a way to control the host process.</span></span>  
  
 <span data-ttu-id="cc2ac-181">Étant donné ces attributs, l'hôte peut spécifier une liste de HPA, tels que l'attribut SharedState, qui doivent être rejetés dans l'environnement hébergé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-181">Given these attributes, the host can specify a list of HPAs, such as the SharedState attribute, that should be disallowed in the hosted environment.</span></span> <span data-ttu-id="cc2ac-182">Dans ce cas, le CLR refuse les tentatives d'appel par code utilisateur des API annotées par les HPA dans la liste interdite.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-182">In this case, the CLR denies attempts by user code to call APIs that are annotated by the HPAs in the prohibited list.</span></span> <span data-ttu-id="cc2ac-183">Pour plus d’informations, consultez [attributs de protection de l’hôte et programmation de l’intégration du CLR](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-183">For more information, see [Host Protection Attributes and CLR Integration Programming](../clr-integration-security-host-protection-attributes/host-protection-attributes-and-clr-integration-programming.md).</span></span>  
  
## <a name="how-sql-server-and-the-clr-work-together"></a><span data-ttu-id="cc2ac-184">Comment SQL Server et le CLR fonctionnent-ils ensemble ?</span><span class="sxs-lookup"><span data-stu-id="cc2ac-184">How SQL Server and the CLR Work Together</span></span>  
 <span data-ttu-id="cc2ac-185">Cette section explique comment [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] intègre le threading, la planification, la synchronisation et les modèles de gestion de la mémoire de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et du CLR.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-185">This section discusses how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] integrates the threading, scheduling, synchronization, and memory management models of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR.</span></span> <span data-ttu-id="cc2ac-186">En particulier, cette section examine l'intégration du point de vue de l'évolutivité, de la fiabilité et des objectifs en matière de sécurité.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-186">In particular, this section examines the integration in light of scalability, reliability, and security goals.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-187">agit essentiellement comme un système d'exploitation pour le CLR lorsque celui-ci est hébergé au sein de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-187">essentially acts as the operating system for the CLR when it is hosted inside [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cc2ac-188">Le CLR appelle les routines de bas niveau implémentées par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour le threading, la planification, la synchronisation et la gestion de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-188">The CLR calls low-level routines implemented by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] for threading, scheduling, synchronization, and memory management.</span></span> <span data-ttu-id="cc2ac-189">Ce sont les mêmes primitives que le reste du moteur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] utilise.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-189">These are the same primitives that the rest of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] engine uses.</span></span> <span data-ttu-id="cc2ac-190">Cette approche fournit plusieurs avantages en termes d'évolutivité, de fiabilité et de sécurité.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-190">This approach provides several scalability, reliability, and security benefits.</span></span>  
  
###### <a name="scalability-common-threading-scheduling-and-synchronization"></a><span data-ttu-id="cc2ac-191">Évolutivité : threading, planification et synchronisation courants</span><span class="sxs-lookup"><span data-stu-id="cc2ac-191">Scalability: Common threading, scheduling, and synchronization</span></span>  
 <span data-ttu-id="cc2ac-192">Le CLR appelle des API [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour créer des threads, à la fois pour exécuter le code utilisateur et pour sa propre utilisation interne.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-192">CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] APIs for creating threads, both for running user code and for its own internal use.</span></span> <span data-ttu-id="cc2ac-193">Afin de synchroniser plusieurs threads, le CLR appelle des objets de synchronisation [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-193">In order to synchronize between multiple threads, the CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] synchronization objects.</span></span> <span data-ttu-id="cc2ac-194">Cela permet au planificateur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de planifier d'autres tâches lorsqu'un thread attend un objet de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-194">This allows the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler to schedule other tasks when a thread is waiting on a synchronization object.</span></span> <span data-ttu-id="cc2ac-195">Par exemple, lorsque le CLR lance le garbage collection, tous ses threads attendent que le garbage collection se termine.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-195">For example, when the CLR initiates garbage collection, all of its threads wait for garbage collection to finish.</span></span> <span data-ttu-id="cc2ac-196">Comme les threads du CLR et les objets de synchronisation qu'ils attendent sont connus du planificateur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut planifier des threads qui exécutent d'autres tâches de base de données n'impliquant pas le CLR.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-196">Because the CLR threads and the synchronization objects they are waiting on are known to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can schedule threads that are running other database tasks not involving the CLR.</span></span> <span data-ttu-id="cc2ac-197">Cela permet également à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] de détecter les blocages qui impliquent des verrous pris par les objets de synchronisation du CLR et d'employer des techniques traditionnelles de suppression des blocages.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-197">This also enables [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to detect deadlocks that involve locks taken by CLR synchronization objects and employ traditional techniques for deadlock removal.</span></span>  
  
 <span data-ttu-id="cc2ac-198">Le code managé s'exécute de façon préemptive dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-198">Managed code runs preemptively in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cc2ac-199">Le planificateur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] a la capacité de détecter et d'arrêter les threads qui n'ont pas été soumis pendant une période significative.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-199">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler has the ability to detect and stop threads that have not yielded for a significant amount of time.</span></span> <span data-ttu-id="cc2ac-200">La capacité à accrocher des threads du CLR aux threads [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implique que le planificateur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut identifier des threads « fugitifs » dans le CLR et gérer leur priorité.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-200">The ability to hook CLR threads to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] threads implies that the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] scheduler can identify "runaway" threads in the CLR and manage their priority.</span></span> <span data-ttu-id="cc2ac-201">De tels threads fugitifs sont suspendus et placés en arrière dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-201">Such runaway threads are suspended and put back in the queue.</span></span> <span data-ttu-id="cc2ac-202">Les threads identifiés à plusieurs reprises comme des threads fugitifs ne sont pas autorisés à s'exécuter pendant un intervalle de temps donné afin que les autres travaux en cours puissent s'exécuter.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-202">Threads that are repeatedly identified as runaway threads are not allowed to run for a given period of time so that other executing workers can run.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="cc2ac-203">Le code managé de longue durée qui accède aux données ou alloue suffisamment de mémoire pour déclencher le garbage collection sera soumis automatiquement.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-203">Long-running managed code that accesses data or allocates enough memory to trigger garbage collection will yield automatically.</span></span> <span data-ttu-id="cc2ac-204">Un code managé de longue durée qui n'accède pas aux données ou n'alloue pas suffisamment de mémoire managée pour déclencher le garbage collection doit être soumis explicitement en appelant la fonction System.Thread.Sleep() du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-204">Long-running managed code that does not access data or allocate enough managed memory to trigger garbage collection should explicitly yield by calling the System.Thread.Sleep() function of the .NET Framework.</span></span>  
  
###### <a name="scalability-common-memory-management"></a><span data-ttu-id="cc2ac-205">Évolutivité : gestion de la mémoire courante</span><span class="sxs-lookup"><span data-stu-id="cc2ac-205">Scalability: Common memory management</span></span>  
 <span data-ttu-id="cc2ac-206">Le CLR appelle des primitives [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour allouer et libérer sa mémoire.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-206">The CLR calls [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] primitives for allocating and de-allocating its memory.</span></span> <span data-ttu-id="cc2ac-207">Comme la mémoire utilisée par le CLR est comptabilisée dans l'utilisation de la mémoire totale du système, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut rester dans ses limites de mémoire configurées et garantir que le CLR et [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ne rivalisent pas l'un avec l'autre pour la mémoire.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-207">Because the memory used by the CLR is accounted for in the total memory usage of the system, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can stay within its configured memory limits and ensure the CLR and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] are not competing with each other for memory.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-208">peut également rejeter les demandes de mémoire CLR lorsque la mémoire système est contrainte, et demander au CLR de réduire son utilisation de la mémoire lorsque d'autres tâches ont besoin de mémoire.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-208">can also reject CLR memory requests when system memory is constrained, and ask CLR to reduce its memory use when other tasks need memory.</span></span>  
  
###### <a name="reliability-application-domains-and-unrecoverable-exceptions"></a><span data-ttu-id="cc2ac-209">Fiabilité : domaines d'application et exceptions irrécupérables</span><span class="sxs-lookup"><span data-stu-id="cc2ac-209">Reliability: Application domains and unrecoverable exceptions</span></span>  
 <span data-ttu-id="cc2ac-210">Lorsqu'un code managé dans les API du .NET Framework rencontre des exceptions critiques, telles qu'une mémoire insuffisante ou un dépassement de capacité de la pile, il n'est pas toujours possible de récupérer après de tels échecs et de garantir une sémantique cohérente et correcte pour leur implémentation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-210">When managed code in the .NET Framework APIs encounters critical exceptions, such as out-of-memory or stack overflow, it is not always possible to recover from such failures and ensure consistent and correct semantics for their implementation.</span></span> <span data-ttu-id="cc2ac-211">Ces API déclenchent une exception d'abandon de thread en réponse à ces échecs.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-211">These APIs raise a thread abort exception in response to these failures.</span></span>  
  
 <span data-ttu-id="cc2ac-212">En cas d'hébergement dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], de tels abandons de thread sont gérés comme suit : le CLR détecte tout état partagé dans le domaine d'application dans lequel l'abandon de thread se produit.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-212">When hosted in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], such thread aborts are handled as follows: the CLR detects any shared state in the application domain in which the thread abort occurs.</span></span> <span data-ttu-id="cc2ac-213">Le CLR accomplit cela en vérifiant la présence d'objets de synchronisation.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-213">The CLR does this by checking for the presence of synchronization objects.</span></span> <span data-ttu-id="cc2ac-214">S'il existe un état partagé dans le domaine d'application, le domaine d'application lui-même est déchargé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-214">If there is shared state in the application domain, then the application domain itself is unloaded.</span></span> <span data-ttu-id="cc2ac-215">Le déchargement du domaine d'application arrête les transactions de base de données qui sont actuellement en cours d'exécution dans ce domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-215">The unloading of the application domain stops database transactions that are currently running in that application domain.</span></span> <span data-ttu-id="cc2ac-216">Comme la présence d'un état partagé peut élargir l'impact de telles exceptions critiques aux sessions utilisateur autres que celle qui déclenche l'exception, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et le CLR ont pris des mesures pour réduire la probabilité d'un état partagé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-216">Because the presence of shared state can widen the impact of such critical exceptions to user sessions other than the one triggering the exception, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and the CLR have taken steps to reduce the likelihood of shared state.</span></span> <span data-ttu-id="cc2ac-217">Pour plus d'informations, consultez la documentation sur le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-217">For more information, see the .NET Framework documentation.</span></span>  
  
###### <a name="security-permission-sets"></a><span data-ttu-id="cc2ac-218">Sécurité : jeux d'autorisations</span><span class="sxs-lookup"><span data-stu-id="cc2ac-218">Security: Permission sets</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-219">permet aux utilisateurs de spécifier les exigences de fiabilité et de sécurité du code déployé dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-219">allows users to specify the reliability and security requirements for code deployed into the database.</span></span> <span data-ttu-id="cc2ac-220">Lorsque les assemblys sont téléchargés dans la base de données, l'auteur de l'assembly peut spécifier trois jeux d'autorisations au choix pour cet assembly : SAFE, EXTERNAL_ACCESS ou UNSAFE.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-220">When assemblies are uploaded into the database, the author of the assembly can specify one of three permission sets for that assembly: SAFE, EXTERNAL_ACCESS and UNSAFE.</span></span>  
  
|||||  
|-|-|-|-|  
|<span data-ttu-id="cc2ac-221">Jeu d'autorisations</span><span class="sxs-lookup"><span data-stu-id="cc2ac-221">Permission set</span></span>|<span data-ttu-id="cc2ac-222">SAFE</span><span class="sxs-lookup"><span data-stu-id="cc2ac-222">SAFE</span></span>|<span data-ttu-id="cc2ac-223">EXTERNAL_ACCESS</span><span class="sxs-lookup"><span data-stu-id="cc2ac-223">EXTERNAL_ACCESS</span></span>|<span data-ttu-id="cc2ac-224">UNSAFE</span><span class="sxs-lookup"><span data-stu-id="cc2ac-224">UNSAFE</span></span>|  
|<span data-ttu-id="cc2ac-225">Sécurité d'accès du code</span><span class="sxs-lookup"><span data-stu-id="cc2ac-225">Code Access Security</span></span>|<span data-ttu-id="cc2ac-226">Exécution uniquement</span><span class="sxs-lookup"><span data-stu-id="cc2ac-226">Execute only</span></span>|<span data-ttu-id="cc2ac-227">Exécution + accès aux ressources externes</span><span class="sxs-lookup"><span data-stu-id="cc2ac-227">Execute + access to external resources</span></span>|<span data-ttu-id="cc2ac-228">Non restreint</span><span class="sxs-lookup"><span data-stu-id="cc2ac-228">Unrestricted</span></span>|  
|<span data-ttu-id="cc2ac-229">Restrictions du modèle de programmation</span><span class="sxs-lookup"><span data-stu-id="cc2ac-229">Programming model restrictions</span></span>|<span data-ttu-id="cc2ac-230">Oui</span><span class="sxs-lookup"><span data-stu-id="cc2ac-230">Yes</span></span>|<span data-ttu-id="cc2ac-231">Oui</span><span class="sxs-lookup"><span data-stu-id="cc2ac-231">Yes</span></span>|<span data-ttu-id="cc2ac-232">Sans restriction</span><span class="sxs-lookup"><span data-stu-id="cc2ac-232">No restrictions</span></span>|  
|<span data-ttu-id="cc2ac-233">Vérifiabilité requise</span><span class="sxs-lookup"><span data-stu-id="cc2ac-233">Verifiability requirement</span></span>|<span data-ttu-id="cc2ac-234">Oui</span><span class="sxs-lookup"><span data-stu-id="cc2ac-234">Yes</span></span>|<span data-ttu-id="cc2ac-235">Oui</span><span class="sxs-lookup"><span data-stu-id="cc2ac-235">Yes</span></span>|<span data-ttu-id="cc2ac-236">Non</span><span class="sxs-lookup"><span data-stu-id="cc2ac-236">No</span></span>|  
|<span data-ttu-id="cc2ac-237">Possibilité d'appeler du code natif</span><span class="sxs-lookup"><span data-stu-id="cc2ac-237">Ability to call native code</span></span>|<span data-ttu-id="cc2ac-238">Non</span><span class="sxs-lookup"><span data-stu-id="cc2ac-238">No</span></span>|<span data-ttu-id="cc2ac-239">Non</span><span class="sxs-lookup"><span data-stu-id="cc2ac-239">No</span></span>|<span data-ttu-id="cc2ac-240">Oui</span><span class="sxs-lookup"><span data-stu-id="cc2ac-240">Yes</span></span>|  
  
 <span data-ttu-id="cc2ac-241">SAFE est le mode le plus fiable et sécurisé avec des restrictions associées quant au modèle de programmation autorisé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-241">SAFE is the most reliable and secure mode with associated restrictions in terms of the allowed programming model.</span></span> <span data-ttu-id="cc2ac-242">Les assemblys SAFE bénéficient d'autorisations suffisantes pour s'exécuter, effectuer des calculs et avoir accès à la base de données locale.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-242">SAFE assemblies are given enough permission to run, perform computations, and have access to the local database.</span></span> <span data-ttu-id="cc2ac-243">Les assemblys SAFE doivent être de type sécurisé vérifié et ne sont pas autorisés à appeler du code non managé.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-243">SAFE assemblies need to be verifiably type safe and are not allowed to call unmanaged code.</span></span>  
  
 <span data-ttu-id="cc2ac-244">UNSAFE est réservé à du code hautement approuvé qui peut être créé uniquement par les administrateurs de base de données.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-244">UNSAFE is for highly trusted code that can only be created by database administrators.</span></span> <span data-ttu-id="cc2ac-245">Ce code approuvé n'a pas de restrictions de sécurité d'accès du code et il peut appeler du code non managé (natif).</span><span class="sxs-lookup"><span data-stu-id="cc2ac-245">This trusted code has no code access security restrictions, and it can call unmanaged (native) code.</span></span>  
  
 <span data-ttu-id="cc2ac-246">EXTERNAL_ACCESS fournit une option de sécurité intermédiaire. Il permet au code d'accéder à des ressources externes à la base de données, mais possède néanmoins les garanties de fiabilité de SAFE.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-246">EXTERNAL_ACCESS provides an intermediate security option, allowing code to access resources external to the database but still having the reliability guarantees of SAFE.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-247">utilise la couche de stratégie de sécurité d'accès du code de niveau hôte pour définir une stratégie hôte qui accorde l'un des trois jeux d'autorisations en fonction du jeu d'autorisations stocké dans les catalogues [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-247">uses the host-level CAS policy layer to set up a host policy that grants one of the three sets of permissions based on the permission set stored in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] catalogs.</span></span> <span data-ttu-id="cc2ac-248">Le code managé qui s'exécute au sein de la base de données obtient toujours l'un de ces jeux d'autorisations d'accès du code.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-248">Managed code running inside the database always gets one of these code access permission sets.</span></span>  
  
### <a name="programming-model-restrictions"></a><span data-ttu-id="cc2ac-249">Restrictions du modèle de programmation</span><span class="sxs-lookup"><span data-stu-id="cc2ac-249">Programming Model Restrictions</span></span>  
 <span data-ttu-id="cc2ac-250">Le modèle de programmation du code managé dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implique l'écriture de fonctions, de procédures et de types qui ne nécessitent généralement pas l'utilisation d'un état maintenu d'un appel à un autre ni le partage de l'état sur plusieurs sessions utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-250">The programming model for managed code in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] involves writing functions, procedures, and types which typically do not require the use of state held across multiple invocations or the sharing of state across multiple user sessions.</span></span> <span data-ttu-id="cc2ac-251">Par ailleurs, comme décrit précédemment, la présence d'un état partagé peut provoquer des exceptions critiques qui affectent l'évolutivité et la fiabilité de l'application.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-251">Further, as described earlier, the presence of shared state can cause critical exceptions that impact the scalability and the reliability of the application.</span></span>  
  
 <span data-ttu-id="cc2ac-252">Dans de telles considérations, nous déconseillons d'utiliser des variables statiques et des membres de données statiques de classes utilisées dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-252">Given these considerations, we discourage the use of static variables and static data members of classes used in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="cc2ac-253">Pour les assemblys SAFE et EXTERNAL_ACCESS, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examine les métadonnées de l'assembly au moment de la création de l'assembly et échoue dans la création de tels assemblys s'il détecte l'utilisation de membres de données et de variables statiques.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-253">For SAFE and EXTERNAL_ACCESS assemblies, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] examines the metadata of the assembly at CREATE ASSEMBLY time and fails the creation of such assemblies if it finds the use of static data members and variables.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="cc2ac-254">refuse également les appels aux API .NET Framework qui sont annotés avec les attributs de protection de l'hôte `SharedState`, `Synchronization` et `ExternalProcessMgmt`.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-254">also disallows calls to .NET Framework APIs that are annotated with the `SharedState`, `Synchronization` and `ExternalProcessMgmt` host protection attributes.</span></span> <span data-ttu-id="cc2ac-255">Cela empêche les assemblys SAFE et EXTERNAL_ACCESS d'appeler des API qui activent l'état de partage, d'effectuer une synchronisation et d'affecter l'intégrité du processus [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="cc2ac-255">This prevents SAFE and EXTERNAL_ACCESS assemblies from calling any APIs that enable sharing state, performing synchronization, and affecting the integrity of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] process.</span></span> <span data-ttu-id="cc2ac-256">Pour plus d’informations, consultez [restrictions du modèle de programmation](database-objects/clr-integration-programming-model-restrictions.md)de l’intégration du CLR.</span><span class="sxs-lookup"><span data-stu-id="cc2ac-256">For more information, see [CLR Integration Programming Model Restrictions](database-objects/clr-integration-programming-model-restrictions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cc2ac-257">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cc2ac-257">See Also</span></span>  
 <span data-ttu-id="cc2ac-258">[Sécurité de l’intégration du CLR](security/clr-integration-security.md) </span><span class="sxs-lookup"><span data-stu-id="cc2ac-258">[CLR Integration Security](security/clr-integration-security.md) </span></span>  
 [<span data-ttu-id="cc2ac-259">Performances de l'intégration du CLR</span><span class="sxs-lookup"><span data-stu-id="cc2ac-259">Performance of CLR Integration</span></span>](clr-integration-architecture-performance.md)  
  
  
