---
title: Exigences relatives au type défini par l’utilisateur | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- UDTs [CLR integration], requirements
- serialization
- Native serialization format [CLR integration]
- attributes [CLR integration]
- XML serialization [CLR integration]
- user-defined types [CLR integration], requirements
- user-defined serialization [CLR integration]
- user-defined types [CLR integration], Native serialization
- UDTs [CLR integration], Native serialization
ms.assetid: bedc3372-50eb-40f2-bcf2-d6db6a63b7e6
author: rothja
ms.author: jroth
ms.openlocfilehash: d4e692a4523829713cd95daf62374f84a74b6584
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602166"
---
# <a name="user-defined-type-requirements"></a><span data-ttu-id="d00af-102">Configuration requise pour les types définis par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="d00af-102">User-Defined Type Requirements</span></span>
  <span data-ttu-id="d00af-103">Vous devez prendre plusieurs décisions importantes en matière de conception lors de la création d’un type défini par l’utilisateur (UDT) à installer dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d00af-103">You must make several important design decisions when creating a user-defined type (UDT) to be installed in [!INCLUDE[msCoName](../../includes/msconame-md.md)][!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d00af-104">Pour la plupart des types définis par l'utilisateur, il est recommandé de créer un type défini par l'utilisateur sous forme de structure mais il est également possible de le créer sous forme de classe.</span><span class="sxs-lookup"><span data-stu-id="d00af-104">For most UDTs, creating the UDT as a structure is recommended, although creating it as a class is also an option.</span></span> <span data-ttu-id="d00af-105">La définition de l'UDT doit être conforme aux spécifications de création d'UDT afin de pouvoir l'enregistrer avec [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d00af-105">The UDT definition must conform to the specifications for creating UDTs in order for it to be registered with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="requirements-for-implementing-udts"></a><span data-ttu-id="d00af-106">Configuration requise pour l'implémentation des types définis par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="d00af-106">Requirements for Implementing UDTs</span></span>  
 <span data-ttu-id="d00af-107">Pour s'exécuter dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], votre UDT doit implémenter les éléments requis suivants dans sa définition :</span><span class="sxs-lookup"><span data-stu-id="d00af-107">To run in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], your UDT must implement the following requirements in the UDT definition:</span></span>  
  
 <span data-ttu-id="d00af-108">L'UDT doit spécifier l'attribut `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span><span class="sxs-lookup"><span data-stu-id="d00af-108">The UDT must specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span> <span data-ttu-id="d00af-109">Le recours à l'attribut `System.SerializableAttribute` est facultative mais recommandé.</span><span class="sxs-lookup"><span data-stu-id="d00af-109">The use of the `System.SerializableAttribute` is optional, but recommended.</span></span>  
  
-   <span data-ttu-id="d00af-110">L'UDT doit implémenter l'interface `System.Data.SqlTypes.INullable` dans la classe ou la structure en créant une méthode publique `static` (`Shared` dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic) `Null`.</span><span class="sxs-lookup"><span data-stu-id="d00af-110">The UDT must implement the `System.Data.SqlTypes.INullable` interface in the class or structure by creating a public `static` (`Shared` in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic) `Null` method.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d00af-111">est par défaut compatible avec la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="d00af-111">is null-aware by default.</span></span> <span data-ttu-id="d00af-112">Ceci est nécessaire pour que le code exécuté dans l'UDT puisse être en mesure de reconnaître une valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="d00af-112">This is necessary for code executing in the UDT to be able to recognize a null value.</span></span>  
  
-   <span data-ttu-id="d00af-113">L'UDT doit contenir une méthode publique `static` (ou `Shared`) `Parse` qui prend en charge l'analyse, ainsi qu'une méthode publique `ToString` pour convertir l'objet en une représentation sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="d00af-113">The UDT must contain a public `static` (or `Shared`) `Parse` method that supports parsing from, and a public `ToString` method for converting to a string representation of the object.</span></span>  
  
-   <span data-ttu-id="d00af-114">Un UDT doté d'un format de sérialisation défini par l'utilisateur doit implémenter l'interface `System.Data.IBinarySerialize` et fournir une méthode `Read` et une méthode `Write`.</span><span class="sxs-lookup"><span data-stu-id="d00af-114">A UDT with a user-defined serialization format must implement the `System.Data.IBinarySerialize` interface and provide a `Read` and a `Write` method.</span></span>  
  
-   <span data-ttu-id="d00af-115">L'UDT doit implémenter `System.Xml.Serialization.IXmlSerializable` ou tous les champs et les propriétés publics doivent être de types qui autorisent la sérialisation XML ou munis de l'attribut `XmlIgnore` si une substitution de la sérialisation standard est requise.</span><span class="sxs-lookup"><span data-stu-id="d00af-115">The UDT must implement `System.Xml.Serialization.IXmlSerializable`, or all public fields and properties must be of types that are XML serializable or decorated with the `XmlIgnore` attribute if overriding standard serialization is required.</span></span>  
  
-   <span data-ttu-id="d00af-116">Chaque objet UDT doit être soumis à une seule sérialisation.</span><span class="sxs-lookup"><span data-stu-id="d00af-116">There must be only one serialization of a UDT object.</span></span> <span data-ttu-id="d00af-117">La validation échoue si les routines de sérialisation ou désérialisation reconnaissent plusieurs représentations d'un objet en particulier.</span><span class="sxs-lookup"><span data-stu-id="d00af-117">Validation fails if the serialize or deserialize routines recognize more than one representation of a particular object.</span></span>  
  
-   <span data-ttu-id="d00af-118">`SqlUserDefinedTypeAttribute.IsByteOrdered` doit avoir la valeur `true` pour comparer des données dans la marque d'ordre d'octets.</span><span class="sxs-lookup"><span data-stu-id="d00af-118">`SqlUserDefinedTypeAttribute.IsByteOrdered` must be `true` to compare data in byte order.</span></span> <span data-ttu-id="d00af-119">Si l'interface IComparable n'est pas implémentée et que `SqlUserDefinedTypeAttribute.IsByteOrdered` a la valeur `false`, les comparaisons de marque d'ordre d'octets échoueront.</span><span class="sxs-lookup"><span data-stu-id="d00af-119">If the IComparable interface is not implemented and `SqlUserDefinedTypeAttribute.IsByteOrdered` is `false`, byte order comparisons will fail.</span></span>  
  
-   <span data-ttu-id="d00af-120">Un UDT défini dans une classe doit disposer d'un constructeur public qui n'accepte aucun argument.</span><span class="sxs-lookup"><span data-stu-id="d00af-120">A UDT defined in a class must have a public constructor that takes no arguments.</span></span> <span data-ttu-id="d00af-121">Vous pouvez éventuellement créer des constructeurs de classe surchargés supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="d00af-121">You can optionally create additional overloaded class constructors.</span></span>  
  
-   <span data-ttu-id="d00af-122">L'UDT doit dévoiler les éléments de données sous forme de champs publics ou de procédures de propriété.</span><span class="sxs-lookup"><span data-stu-id="d00af-122">The UDT must expose data elements as public fields or property procedures.</span></span>  
  
-   <span data-ttu-id="d00af-123">Les noms publics ne peuvent pas dépasser 128 caractères et doivent être conformes aux [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] règles d’affectation de noms pour les identificateurs définis dans les [identificateurs de base de données](../databases/database-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="d00af-123">Public names cannot be longer than 128 characters, and must conform to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] naming rules for identifiers as defined in [Database Identifiers](../databases/database-identifiers.md).</span></span>  
  
-   <span data-ttu-id="d00af-124">Les colonnes `sql_variant` ne peuvent pas contenir les instances d'un UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-124">`sql_variant` columns cannot contain instances of a UDT.</span></span>  
  
-   <span data-ttu-id="d00af-125">Les membres hérités ne sont pas accessibles depuis [!INCLUDE[tsql](../../includes/tsql-md.md)] puisque le système de type [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] n'est pas compatible avec la hiérarchie d'héritage entre UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-125">Inherited members are not accessible from [!INCLUDE[tsql](../../includes/tsql-md.md)] because the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] type system is not aware of the inheritance hierarchy among UDTs.</span></span> <span data-ttu-id="d00af-126">Toutefois, vous pouvez recourir à la fonction d'héritage au moment de structurer vos classes et pouvez appeler ces méthodes dans l'implémentation du code managé du type.</span><span class="sxs-lookup"><span data-stu-id="d00af-126">However, you can use inheritance when you structure your classes and you can call such methods in the managed code implementation of the type.</span></span>  
  
-   <span data-ttu-id="d00af-127">Hormis le constructeur de classe, les membres ne peuvent pas être surchargés.</span><span class="sxs-lookup"><span data-stu-id="d00af-127">Members cannot be overloaded, except for the class constructor.</span></span> <span data-ttu-id="d00af-128">Si vous créez une méthode surchargée, aucune erreur ne se produit au moment d'inscrire l'assembly ou de créer le type dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d00af-128">If you do create an overloaded method, no error is raised when you register the assembly or create the type in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d00af-129">La détection de la méthode surchargée a lieu au moment de l'exécution et non lors de la création du type.</span><span class="sxs-lookup"><span data-stu-id="d00af-129">Detection of the overloaded method occurs at run time, not when the type is created.</span></span> <span data-ttu-id="d00af-130">Les méthodes surchargées peuvent exister dans la classe tant qu'elles ne sont jamais appelées.</span><span class="sxs-lookup"><span data-stu-id="d00af-130">Overloaded methods can exist in the class as long as they are never invoked.</span></span> <span data-ttu-id="d00af-131">Une erreur est générée dès que vous appelez la méthode surchargée.</span><span class="sxs-lookup"><span data-stu-id="d00af-131">Once you invoke the overloaded method, an error is raised.</span></span>  
  
-   <span data-ttu-id="d00af-132">Tous les membres `static` (ou `Shared`) doivent être déclarés en tant que constantes ou en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="d00af-132">Any `static` (or `Shared`) members must be declared as constants or as read-only.</span></span> <span data-ttu-id="d00af-133">Les membres statiques ne peuvent pas être mutables.</span><span class="sxs-lookup"><span data-stu-id="d00af-133">Static members cannot be mutable.</span></span>  
  
-   <span data-ttu-id="d00af-134">Si le champ `SqlUserDefinedTypeAttribute.MaxByteSize` est défini sur -1, l'UDT sérialisé peut être aussi volumineux que la taille limite de l'objet LOB (actuellement 2 Go).</span><span class="sxs-lookup"><span data-stu-id="d00af-134">If the `SqlUserDefinedTypeAttribute.MaxByteSize` field is set to -1, the serialized UDT can be as large as the large object (LOB) size limit (currently 2 GB).</span></span> <span data-ttu-id="d00af-135">La taille de l'UDT ne peut pas dépasser la valeur spécifiée dans le champ `MaxByteSized`.</span><span class="sxs-lookup"><span data-stu-id="d00af-135">The size of the UDT cannot exceed the value specified in the `MaxByteSized` field.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d00af-136">Bien qu'elle ne soit pas utilisée par le serveur pour effectuer des comparaisons, vous pouvez implémenter l'interface `System.IComparable` si vous le souhaitez. Cette interface propose une seule et unique méthode, `CompareTo`.</span><span class="sxs-lookup"><span data-stu-id="d00af-136">Although it is not used by the server for performing comparisons, you can optionally implement the `System.IComparable` interface, which exposes a single method, `CompareTo`.</span></span> <span data-ttu-id="d00af-137">Elle intervient côté client dans des situations où il est préférable de comparer ou de classer avec précision des valeurs de type défini par l'utilisateur (UDT).</span><span class="sxs-lookup"><span data-stu-id="d00af-137">This is used on the client side in situations in which it is desirable to accurately compare or order UDT values.</span></span>  
  
## <a name="native-serialization"></a><span data-ttu-id="d00af-138">Sérialisation native</span><span class="sxs-lookup"><span data-stu-id="d00af-138">Native Serialization</span></span>  
 <span data-ttu-id="d00af-139">Le choix du bon attribut de sérialisation pour votre UDT dépend du type d'UDT que vous essayez de créer.</span><span class="sxs-lookup"><span data-stu-id="d00af-139">Choosing the right serialization attributes for your UDT depends on the type of UDT you are trying to create.</span></span> <span data-ttu-id="d00af-140">Le format de sérialisation `Native` utilise une structure très simple qui permet à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de stocker une représentation native efficace du type défini par l'utilisateur sur le disque.</span><span class="sxs-lookup"><span data-stu-id="d00af-140">The `Native` serialization format utilizes a very simple structure that enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to store an efficient native representation of the UDT on disk.</span></span> <span data-ttu-id="d00af-141">Le format `Native` est recommandé si l'UDT est simple et contient uniquement des champs des types suivants :</span><span class="sxs-lookup"><span data-stu-id="d00af-141">The `Native` format is recommended if the UDT is simple and only contains fields of the following types:</span></span>  
  
 <span data-ttu-id="d00af-142">**bool**, **byte**, **sbyte**, **short**, **ushort**, **int**, **uint**, **long**, **ulong**, **float**, **double**, **SqlByte**, **SqlInt16**, **SqlInt32**, **SqlInt64**, **SqlDateTime**, **SqlSingle**, **SqlDouble**, **SqlMoney**, **SqlBoolean**</span><span class="sxs-lookup"><span data-stu-id="d00af-142">**bool**, **byte**, **sbyte**, **short**, **ushort**, **int**, **uint**, **long**, **ulong**, **float**, **double**, **SqlByte**, **SqlInt16**, **SqlInt32**, **SqlInt64**, **SqlDateTime**, **SqlSingle**, **SqlDouble**, **SqlMoney**, **SqlBoolean**</span></span>  
  
 <span data-ttu-id="d00af-143">Les types de valeur qui sont composés de champs des types ci-dessus sont de bons candidats pour le `Native` format, tels que `structs` dans Visual C#, (ou `Structures` tels qu’ils sont connus dans Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="d00af-143">Value types that are composed of fields of the above types are good candidates for `Native` format, such as `structs` in Visual C#, (or `Structures` as they are known in Visual Basic).</span></span> <span data-ttu-id="d00af-144">Par exemple, un UDT spécifié avec le format de sérialisation `Native` peut contenir un champ d'un autre UDT également spécifié avec le format `Native`.</span><span class="sxs-lookup"><span data-stu-id="d00af-144">For example, a UDT specified with the `Native` serialization format may contain a field of another UDT that was also specified with the `Native` format.</span></span> <span data-ttu-id="d00af-145">Si la définition de l'UDT est plus complexe et contient des types de données non inscrits dans la liste ci-dessus, vous devez spécifier à la place le format de sérialisation `UserDefined`.</span><span class="sxs-lookup"><span data-stu-id="d00af-145">If the UDT definition is more complex and contains data types not on the above list, you must specify the `UserDefined` serialization format instead.</span></span>  
  
 <span data-ttu-id="d00af-146">Le format `Native` pose les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="d00af-146">The `Native` format has the following requirements:</span></span>  
  
-   <span data-ttu-id="d00af-147">Le type ne doit spécifier aucune valeur pour `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize`.</span><span class="sxs-lookup"><span data-stu-id="d00af-147">The type must not specify a value for `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.MaxByteSize`.</span></span>  
  
-   <span data-ttu-id="d00af-148">Tous les champs doivent être sérialisables.</span><span class="sxs-lookup"><span data-stu-id="d00af-148">All fields must be serializable.</span></span>  
  
-   <span data-ttu-id="d00af-149">L'attribut `System.Runtime.InteropServices.StructLayoutAttribute` doit être spécifié en tant que `StructLayout.LayoutKindSequential` si le type défini par l'utilisateur (UDT) est défini dans une classe et non une structure.</span><span class="sxs-lookup"><span data-stu-id="d00af-149">The `System.Runtime.InteropServices.StructLayoutAttribute` must be specified as `StructLayout.LayoutKindSequential` if the UDT is defined in a class and not a structure.</span></span> <span data-ttu-id="d00af-150">Cet attribut contrôle la disposition physique des champs de données et est utilisé pour contraindre les membres à se placer dans l'ordre dans lequel ils apparaissent.</span><span class="sxs-lookup"><span data-stu-id="d00af-150">This attribute controls the physical layout of the data fields and is used to force the members to be laid out in the order in which they appear.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="d00af-151">utilise cet attribut pour déterminer l'ordre des champs des UDT au moyen de plusieurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="d00af-151">uses this attribute to determine the field order for UDTs with multiple values.</span></span>  
  
 <span data-ttu-id="d00af-152">Pour obtenir un exemple d’UDT défini avec `Native` la sérialisation, consultez le point défini par l' [utilisateur dans codage des types définis par l’utilisateur](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="d00af-152">For an example of a UDT defined with `Native` serialization, see the Point UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="userdefined-serialization"></a><span data-ttu-id="d00af-153">Sérialisation UserDefined</span><span class="sxs-lookup"><span data-stu-id="d00af-153">UserDefined Serialization</span></span>  
 <span data-ttu-id="d00af-154">Le paramètre de mise en forme `UserDefined` de l'attribut `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` permet au développeur de maîtriser entièrement le format binaire.</span><span class="sxs-lookup"><span data-stu-id="d00af-154">The `UserDefined` format setting for the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute gives the developer full control over the binary format.</span></span> <span data-ttu-id="d00af-155">Lorsque vous spécifiez la propriété d'attribut `Format` en tant que `UserDefined`, vous devez effectuer les opérations suivantes dans votre code :</span><span class="sxs-lookup"><span data-stu-id="d00af-155">When specifying the `Format` attribute property as `UserDefined`, you must do the following in your code:</span></span>  
  
-   <span data-ttu-id="d00af-156">Spécifiez la propriété d'attribut `IsByteOrdered` facultative.</span><span class="sxs-lookup"><span data-stu-id="d00af-156">Specify the optional `IsByteOrdered` attribute property.</span></span> <span data-ttu-id="d00af-157">La valeur par défaut est `false`.</span><span class="sxs-lookup"><span data-stu-id="d00af-157">The default value is `false`.</span></span>  
  
-   <span data-ttu-id="d00af-158">Spécifiez la propriété `MaxByteSize` de `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span><span class="sxs-lookup"><span data-stu-id="d00af-158">Specify the `MaxByteSize` property of the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute`.</span></span>  
  
-   <span data-ttu-id="d00af-159">Écrivez du code pour implémenter les méthodes `Read` et `Write` pour l'UDT en implémentant l'interface `System.Data.Sql.IBinarySerialize`.</span><span class="sxs-lookup"><span data-stu-id="d00af-159">Write code to implement `Read` and `Write` methods for the UDT by implementing the `System.Data.Sql.IBinarySerialize` interface.</span></span>  
  
 <span data-ttu-id="d00af-160">Pour obtenir un exemple d’UDT défini avec `UserDefined` la sérialisation, consultez l’UDT Currency dans [codage des types définis par l’utilisateur](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="d00af-160">For an example of a UDT defined with `UserDefined` serialization, see the Currency UDT in [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d00af-161">Les champs UDT doivent utiliser la sérialisation native ou être persistants pour pouvoir être indexés.</span><span class="sxs-lookup"><span data-stu-id="d00af-161">UDT fields must use native serialization or be persisted in order to be indexed.</span></span>  
  
## <a name="serialization-attributes"></a><span data-ttu-id="d00af-162">Attributs de sérialisation</span><span class="sxs-lookup"><span data-stu-id="d00af-162">Serialization Attributes</span></span>  
 <span data-ttu-id="d00af-163">Les attributs déterminent la façon dont la sérialisation est utilisée pour construire la représentation de stockage des types définis par l'utilisateur et pour transmettre des types définis par l'utilisateur par valeur au client.</span><span class="sxs-lookup"><span data-stu-id="d00af-163">Attributes determine how serialization is used to construct the storage representation of UDTs and to transmit UDTs by value to the client.</span></span> <span data-ttu-id="d00af-164">Vous devez spécifier l'attribut `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` au moment de créer l'UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-164">You are required to specify the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` when creating the UDT.</span></span> <span data-ttu-id="d00af-165">L'attribut `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` indique que la classe est un UDT et précise le stockage de cet UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-165">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` attribute indicates that the class is a UDT and specifies the storage for the UDT.</span></span> <span data-ttu-id="d00af-166">Bien que [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne l'exige pas, si vous le souhaitez, vous pouvez spécifier l'attribut `Serializable`.</span><span class="sxs-lookup"><span data-stu-id="d00af-166">You can optionally specify the `Serializable` attribute, although [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] does not require this.</span></span>  
  
 <span data-ttu-id="d00af-167">L'attribut `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` présente les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="d00af-167">The `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute` has the following properties.</span></span>  
  
 `Format`  
 <span data-ttu-id="d00af-168">Spécifie le format de sérialisation qui peut être `Native` ou `UserDefined` en fonction des types de données de l'UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-168">Specifies the serialization format, which can be `Native` or `UserDefined`, depending on the data types of the UDT.</span></span>  
  
 `IsByteOrdered`  
 <span data-ttu-id="d00af-169">Valeur `Boolean` qui détermine comment [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] effectue des comparaisons binaires sur le type défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d00af-169">A `Boolean` value that determines how [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] performs binary comparisons on the UDT.</span></span>  
  
 `IsFixedLength`  
 <span data-ttu-id="d00af-170">Indique si toutes les instances de cet UDT ont la même longueur.</span><span class="sxs-lookup"><span data-stu-id="d00af-170">Indicates whether all instances of this UDT are the same length.</span></span>  
  
 `MaxByteSize`  
 <span data-ttu-id="d00af-171">Taille maximale de l'instance, en octets.</span><span class="sxs-lookup"><span data-stu-id="d00af-171">The maximum size of the instance, in bytes.</span></span> <span data-ttu-id="d00af-172">Vous devez spécifier `MaxByteSize` avec le format de sérialisation `UserDefined`.</span><span class="sxs-lookup"><span data-stu-id="d00af-172">You must specify `MaxByteSize` with the `UserDefined` serialization format.</span></span> <span data-ttu-id="d00af-173">Pour un type défini par l'utilisateur assorti d'une sérialisation définie par l'utilisateur, `MaxByteSize` fait référence à la taille totale du type défini par l'utilisateur dans sa forme sérialisée, telle que définie par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d00af-173">For a UDT with user-defined serialization specified, `MaxByteSize` refers to the total size of the UDT in its serialized form as defined by the user.</span></span> <span data-ttu-id="d00af-174">La valeur de `MaxByteSize` doit figurer dans une plage de 1 à 8 000 ou être définie sur -1 pour indiquer que la taille de l'UDT est supérieure à 8 000 octets (la taille totale ne peut pas dépasser la taille d'objet LOB maximale).</span><span class="sxs-lookup"><span data-stu-id="d00af-174">The value of `MaxByteSize` must be in the range of 1 to 8000, or set to -1 to indicate that the UDT is greater than 8000 bytes (the total size cannot exceed the maximum LOB size).</span></span> <span data-ttu-id="d00af-175">Imaginez un type défini par l'utilisateur assorti d'une propriété d'une chaîne de 10 caractères (`System.Char`).</span><span class="sxs-lookup"><span data-stu-id="d00af-175">Consider a UDT with a property of a string of 10 characters (`System.Char`).</span></span> <span data-ttu-id="d00af-176">Lorsque l'UDT est sérialisé à l'aide de BinaryWriter, la taille totale de la chaîne sérialisée est de 22 octets : 2 octets par caractère Unicode UTF-16, multipliés par le nombre maximal de caractères, plus 2 octets de contrôle de la charge mémoire générée par la sérialisation d'un flux binaire.</span><span class="sxs-lookup"><span data-stu-id="d00af-176">When the UDT is serialized by using a BinaryWriter, the total size of the serialized string is 22 bytes: 2 bytes per Unicode UTF-16 character, multiplied by the maximum number of characters, plus 2 control bytes of overhead incurred from serializing a binary stream.</span></span> <span data-ttu-id="d00af-177">Ainsi, pour déterminer la valeur de `MaxByteSize`, il convient de prendre en compte la taille totale du type défini par l'utilisateur (UDT) sérialisé : la taille des données sérialisées sous forme binaire, plus la charge mémoire générée par la sérialisation.</span><span class="sxs-lookup"><span data-stu-id="d00af-177">Therefore, when determining the value of `MaxByteSize`, the total size of the serialized UDT must be considered: the size of the data serialized in binary form plus the overhead incurred by serialization.</span></span>  
  
 `ValidationMethodName`  
 <span data-ttu-id="d00af-178">Nom de la méthode utilisée pour valider des instances du type défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d00af-178">The name of the method used to validate instances of the UDT.</span></span>  
  
### <a name="setting-isbyteordered"></a><span data-ttu-id="d00af-179">Définition de la propriété IsByteOrdered</span><span class="sxs-lookup"><span data-stu-id="d00af-179">Setting IsByteOrdered</span></span>  
 <span data-ttu-id="d00af-180">En attribuant la valeur `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` à la propriété `true`, vous garantissez que les données binaires sérialisées peuvent être utilisées pour un classement sémantique des informations.</span><span class="sxs-lookup"><span data-stu-id="d00af-180">When the `Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute.IsByteOrdered` property is set to `true`, you are in effect guaranteeing that the serialized binary data can be used for semantic ordering of the information.</span></span> <span data-ttu-id="d00af-181">Par conséquent, chaque instance d'un objet UDT ordonné par octet peut avoir une seule représentation sérialisée.</span><span class="sxs-lookup"><span data-stu-id="d00af-181">Thus, each instance of a byte-ordered UDT object can only have one serialized representation.</span></span> <span data-ttu-id="d00af-182">Lorsque vous soumettez les octets sérialisés à une comparaison dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], les résultats doivent être les mêmes que si vous réalisiez cette opération de comparaison dans le code managé.</span><span class="sxs-lookup"><span data-stu-id="d00af-182">When a comparison operation is performed in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the serialized bytes, its results should be the same as if the same comparison operation had taken place in managed code.</span></span> <span data-ttu-id="d00af-183">Les fonctionnalités suivantes sont également prises en charge lorsque `IsByteOrdered` a la valeur `true` :</span><span class="sxs-lookup"><span data-stu-id="d00af-183">The following features are also supported when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="d00af-184">Possibilité de créer des index dans les colonnes de ce type.</span><span class="sxs-lookup"><span data-stu-id="d00af-184">The ability to create indexes on columns of this type.</span></span>  
  
-   <span data-ttu-id="d00af-185">Possibilité de créer des clés primaires et étrangères ainsi que des contraintes CHECK et UNIQUE dans les colonnes de ce type.</span><span class="sxs-lookup"><span data-stu-id="d00af-185">The ability to create primary and foreign keys as well as CHECK and UNIQUE constraints on columns of this type.</span></span>  
  
-   <span data-ttu-id="d00af-186">Possibilité d'utiliser les clauses ORDER BY, GROUP BY et PARTITION BY de [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d00af-186">The ability to use [!INCLUDE[tsql](../../includes/tsql-md.md)] ORDER BY, GROUP BY, and PARTITION BY clauses.</span></span> <span data-ttu-id="d00af-187">Dans ces cas, la représentation binaire du type est utilisée pour déterminer l'ordre.</span><span class="sxs-lookup"><span data-stu-id="d00af-187">In these cases, the binary representation of the type is used to determine the order.</span></span>  
  
-   <span data-ttu-id="d00af-188">Possibilité d'utiliser des opérateurs de comparaison dans des instructions [!INCLUDE[tsql](../../includes/tsql-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d00af-188">The ability to use comparison operators in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
-   <span data-ttu-id="d00af-189">Possibilité de rendre persistantes des colonnes calculées de ce type.</span><span class="sxs-lookup"><span data-stu-id="d00af-189">The ability to persist computed columns of this type.</span></span>  
  
 <span data-ttu-id="d00af-190">Notez que les formats de sérialisation `Native` et `UserDefined` prennent tous les deux en charge les opérateurs de comparaison suivants lorsque `IsByteOrdered` a la valeur `true` :</span><span class="sxs-lookup"><span data-stu-id="d00af-190">Note that both the `Native` and `UserDefined` serialization formats support the following comparison operators when `IsByteOrdered` is set to `true`:</span></span>  
  
-   <span data-ttu-id="d00af-191">Égal à (=)</span><span class="sxs-lookup"><span data-stu-id="d00af-191">Equal to (=)</span></span>  
  
-   <span data-ttu-id="d00af-192">Différent de (!=)</span><span class="sxs-lookup"><span data-stu-id="d00af-192">Not equal to (!=)</span></span>  
  
-   <span data-ttu-id="d00af-193">Supérieur à (>)</span><span class="sxs-lookup"><span data-stu-id="d00af-193">Greater than (>)</span></span>  
  
-   <span data-ttu-id="d00af-194">Inférieur à (\<)</span><span class="sxs-lookup"><span data-stu-id="d00af-194">Less than (\<)</span></span>  
  
-   <span data-ttu-id="d00af-195">Supérieur ou égal à (>=)</span><span class="sxs-lookup"><span data-stu-id="d00af-195">Greater than or equal to (>=)</span></span>  
  
-   <span data-ttu-id="d00af-196">Less than or equal to (&lt;=)</span><span class="sxs-lookup"><span data-stu-id="d00af-196">Less than or equal to (<=)</span></span>  
  
### <a name="implementing-nullability"></a><span data-ttu-id="d00af-197">Implémentation de la possibilité de valeur NULL</span><span class="sxs-lookup"><span data-stu-id="d00af-197">Implementing Nullability</span></span>  
 <span data-ttu-id="d00af-198">En plus de spécifier correctement les attributs de vos assemblys, votre classe doit également prendre en charge la possibilité de valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="d00af-198">In addition to specifying the attributes for your assemblies correctly, your class must also support nullability.</span></span> <span data-ttu-id="d00af-199">Les types définis par l'utilisateur (UDT) chargés dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sont compatibles avec la valeur NULL mais, pour que l'UDT puisse reconnaître une valeur NULL, la classe doit implémenter l'interface `INullable`.</span><span class="sxs-lookup"><span data-stu-id="d00af-199">UDTs loaded into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are null-aware, but in order for the UDT to recognize a null value, the class must implement the `INullable` interface.</span></span> <span data-ttu-id="d00af-200">Pour plus d’informations et pour obtenir un exemple d’implémentation de la possibilité de valeur null dans un type défini par l’utilisateur, consultez [codage de types définis par l’utilisateur](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="d00af-200">For more information and an example of how to implement nullability in a UDT, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
### <a name="string-conversions"></a><span data-ttu-id="d00af-201">Conversions de chaînes</span><span class="sxs-lookup"><span data-stu-id="d00af-201">String Conversions</span></span>  
 <span data-ttu-id="d00af-202">Pour prendre en charge la conversion de chaînes vers et depuis l'UDT, vous devez préciser une méthode `Parse` et une méthode `ToString` dans votre classe.</span><span class="sxs-lookup"><span data-stu-id="d00af-202">To support string conversion to and from the UDT, you must provide a `Parse` method and a `ToString` method in your class.</span></span> <span data-ttu-id="d00af-203">La méthode `Parse` permet de convertir une chaîne en un type défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="d00af-203">The `Parse` method allows a string to be converted into a UDT.</span></span> <span data-ttu-id="d00af-204">Elle doit être déclarée comme `static` (ou `Shared` dans Visual Basic) et accepter un paramètre de type `System.Data.SqlTypes.SqlString`.</span><span class="sxs-lookup"><span data-stu-id="d00af-204">It must be declared as `static` (or `Shared` in Visual Basic), and take a parameter of type `System.Data.SqlTypes.SqlString`.</span></span> <span data-ttu-id="d00af-205">Pour plus d’informations et pour obtenir un exemple d’implémentation `Parse` des `ToString` méthodes et, consultez [codage de types définis par l’utilisateur](creating-user-defined-types-coding.md).</span><span class="sxs-lookup"><span data-stu-id="d00af-205">For more information and an example of how to implement the `Parse` and `ToString` methods, see [Coding User-Defined Types](creating-user-defined-types-coding.md).</span></span>  
  
## <a name="xml-serialization"></a><span data-ttu-id="d00af-206">Sérialisation XML</span><span class="sxs-lookup"><span data-stu-id="d00af-206">XML Serialization</span></span>  
 <span data-ttu-id="d00af-207">Les UDT doivent prendre en charge la conversion vers et depuis le type de données `xml` en tenant compte des exigences de la sérialisation XML.</span><span class="sxs-lookup"><span data-stu-id="d00af-207">UDTs must support conversion to and from the `xml` data type by conforming to the contract for XML serialization.</span></span> <span data-ttu-id="d00af-208">L'espace de noms `System.Xml.Serialization` contient des classes servant à sérialiser des objets en documents au format XML ou en flux.</span><span class="sxs-lookup"><span data-stu-id="d00af-208">The `System.Xml.Serialization` namespace contains classes that are used to serialize objects into XML format documents or streams.</span></span> <span data-ttu-id="d00af-209">Vous pouvez choisir d'implémenter la sérialisation `xml` par le biais de l'interface `IXmlSerializable` qui offre un format personnalisé pour la sérialisation et la désérialisation XML.</span><span class="sxs-lookup"><span data-stu-id="d00af-209">You can choose to implement `xml` serialization by using the `IXmlSerializable` interface, which provides custom formatting for XML serialization and deserialization.</span></span>  
  
 <span data-ttu-id="d00af-210">Outre les conversions explicites entre les UDT et `xml`, la sérialisation XML vous offre les possibilités suivantes :</span><span class="sxs-lookup"><span data-stu-id="d00af-210">In addition to performing explicit conversions from UDT to `xml`, XML serialization enables you to:</span></span>  
  
-   <span data-ttu-id="d00af-211">Utiliser `Xquery` sur les valeurs d'instances d'UDT après conversion en type de données `xml`.</span><span class="sxs-lookup"><span data-stu-id="d00af-211">Use `Xquery` over values of UDT instances after conversion to the `xml` data type.</span></span>  
  
-   <span data-ttu-id="d00af-212">Utiliser des UDT dans des requêtes paramétrables et des méthodes Web à l'aide des services Web XML natifs dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="d00af-212">Use UDTs in parameterized queries and Web methods with Native XML Web Services in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="d00af-213">Utiliser des UDT pour recevoir un chargement en masse de données XML.</span><span class="sxs-lookup"><span data-stu-id="d00af-213">Use UDTs to receive a bulk load of XML data.</span></span>  
  
-   <span data-ttu-id="d00af-214">Sérialiser des datasets contenant des tables avec des colonnes UDT.</span><span class="sxs-lookup"><span data-stu-id="d00af-214">Serialize DataSets that contain tables with UDT columns.</span></span>  
  
 <span data-ttu-id="d00af-215">Les UDT ne sont pas sérialisés dans les requêtes FOR XML.</span><span class="sxs-lookup"><span data-stu-id="d00af-215">UDTs are not serialized in FOR XML queries.</span></span> <span data-ttu-id="d00af-216">Pour exécuter une requête FOR XML qui affiche la sérialisation XML des UDT, convertissez explicitement chaque colonne UDT en type de données `xml` dans l'instruction SELECT.</span><span class="sxs-lookup"><span data-stu-id="d00af-216">To execute a FOR XML query that displays the XML serialization of UDTs, explicitly convert each UDT column to the `xml` data type in the SELECT statement.</span></span> <span data-ttu-id="d00af-217">Vous pouvez aussi convertir explicitement les colonnes en types `varbinary`, `varchar` ou `nvarchar`.</span><span class="sxs-lookup"><span data-stu-id="d00af-217">You can also explicitly convert the columns to `varbinary`, `varchar`, or `nvarchar`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d00af-218">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d00af-218">See Also</span></span>  
 [<span data-ttu-id="d00af-219">Création d’un type défini par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="d00af-219">Creating a User-Defined Type</span></span>](creating-user-defined-types.md)  
  
  
