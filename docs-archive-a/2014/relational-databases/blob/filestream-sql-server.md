---
title: FILESTREAM (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: filestream
ms.topic: conceptual
helpviewer_keywords:
- FILESTREAM [SQL Server]
- FILESTREAM [SQL Server], about
- FILESTREAM [SQL Server], overview
ms.assetid: 9a5a8166-bcbe-4680-916c-26276253eafa
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 971f45fd69f381a8997bb2f8f08444f4d9c107c4
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707623"
---
# <a name="filestream-sql-server"></a><span data-ttu-id="ca26f-102">FILESTREAM (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ca26f-102">FILESTREAM (SQL Server)</span></span>
  <span data-ttu-id="ca26f-103">FILESTREAM permet aux applications [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]de stocker des données non structurées, telles que des documents et des images, dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-103">FILESTREAM enables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-based applications to store unstructured data, such as documents and images, on the file system.</span></span> <span data-ttu-id="ca26f-104">Les applications peuvent tirer parti des API de diffusion et des performances du système de fichiers, et en même temps maintenir la cohérence transactionnelle entre les données non structurées et les données structurées correspondantes.</span><span class="sxs-lookup"><span data-stu-id="ca26f-104">Applications can leverage the rich streaming APIs and performance of the file system and at the same time maintain transactional consistency between the unstructured data and corresponding structured data.</span></span>  
  
 <span data-ttu-id="ca26f-105">FILESTREAM intègre le [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] avec un système de fichiers NTFS en stockant les `varbinary(max)` données BLOB (Binary Large Object) en tant que fichiers sur le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-105">FILESTREAM integrates the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] with an NTFS file system by storing `varbinary(max)` binary large object (BLOB) data as files on the file system.</span></span> <span data-ttu-id="ca26f-106">Les instructions [!INCLUDE[tsql](../../includes/tsql-md.md)] peuvent insérer, mettre à jour, interroger, rechercher et sauvegarder des données FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-106">[!INCLUDE[tsql](../../includes/tsql-md.md)] statements can insert, update, query, search, and back up FILESTREAM data.</span></span> <span data-ttu-id="ca26f-107">Les interfaces de système de fichiers Win32 fournissent l'accès de diffusion en continu aux données.</span><span class="sxs-lookup"><span data-stu-id="ca26f-107">Win32 file system interfaces provide streaming access to the data.</span></span>  
  
 <span data-ttu-id="ca26f-108">FILESTREAM utilise le cache système NT pour mettre en cache les données de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-108">FILESTREAM uses the NT system cache for caching file data.</span></span> <span data-ttu-id="ca26f-109">Cela aide à réduire tout effet que les données FILESTREAM peuvent avoir sur les performances du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ca26f-109">This helps reduce any effect that FILESTREAM data might have on [!INCLUDE[ssDE](../../includes/ssde-md.md)] performance.</span></span> <span data-ttu-id="ca26f-110">Le pool de mémoires tampons [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] n'est pas utilisé ; par conséquent, cette mémoire est disponible pour le traitement de requête.</span><span class="sxs-lookup"><span data-stu-id="ca26f-110">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] buffer pool is not used; therefore, this memory is available for query processing.</span></span>  
  
 <span data-ttu-id="ca26f-111">FILESTREAM n'est pas activé automatiquement lorsque vous installez ou mettez à niveau [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ca26f-111">FILESTREAM is not automatically enabled when you install or upgrade [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="ca26f-112">Vous devez activer FILESTREAM à l’aide du Gestionnaire de configuration SQL Server et de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ca26f-112">You must enable FILESTREAM by using SQL Server Configuration Manager and [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="ca26f-113">Pour utiliser FILESTREAM, vous devez créer ou modifier une base de données de sorte qu'elle contienne un type spécial de groupe de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-113">To use FILESTREAM, you must create or modify a database to contain a special type of filegroup.</span></span> <span data-ttu-id="ca26f-114">Ensuite, créez ou modifiez une table afin qu'elle contienne une colonne `varbinary(max)` avec l'attribut FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-114">Then, create or modify a table so that it contains a `varbinary(max)` column with the FILESTREAM attribute.</span></span> <span data-ttu-id="ca26f-115">Après avoir effectué ces tâches, vous pouvez utiliser [!INCLUDE[tsql](../../includes/tsql-md.md)] et Win32 pour gérer les données FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-115">After you complete these tasks, you can use [!INCLUDE[tsql](../../includes/tsql-md.md)] and Win32 to manage the FILESTREAM data.</span></span>  
  
 <span data-ttu-id="ca26f-116">Pour plus d’informations sur l’installation et l’utilisation de FILESTREAM, consultez la liste des [tâches associées](#reltasks).</span><span class="sxs-lookup"><span data-stu-id="ca26f-116">For more information about installing and using FILESTREAM, see the list of [Related Tasks](#reltasks).</span></span>  
  
##  <a name="when-to-use-filestream"></a><a name="whentouse"></a><span data-ttu-id="ca26f-117">Quand utiliser FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-117">When to Use FILESTREAM</span></span>  
 <span data-ttu-id="ca26f-118">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], les objets blob peuvent être des données `varbinary(max)` standard qui stockent les données dans des tables, ou des objets `varbinary(max)` FILESTREAM qui stockent les données dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-118">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], BLOBs can be standard `varbinary(max)` data that stores the data in tables, or FILESTREAM `varbinary(max)` objects that store the data in the file system.</span></span> <span data-ttu-id="ca26f-119">La taille et l'utilisation des données déterminent si vous devez utiliser du stockage de base de données ou du stockage de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-119">The size and use of the data determines whether you should use database storage or file system storage.</span></span> <span data-ttu-id="ca26f-120">Si les conditions suivantes sont remplies, vous devez envisager d'utiliser FILESTREAM :</span><span class="sxs-lookup"><span data-stu-id="ca26f-120">If the following conditions are true, you should consider using FILESTREAM:</span></span>  
  
-   <span data-ttu-id="ca26f-121">La taille des objets stockés est, en moyenne, supérieure à 1 Mo.</span><span class="sxs-lookup"><span data-stu-id="ca26f-121">Objects that are being stored are, on average, larger than 1 MB.</span></span>  
  
-   <span data-ttu-id="ca26f-122">L'accès en lecture rapide est important.</span><span class="sxs-lookup"><span data-stu-id="ca26f-122">Fast read access is important.</span></span>  
  
-   <span data-ttu-id="ca26f-123">Vous développez des applications qui utilisent une couche intermédiaire pour la logique d'application.</span><span class="sxs-lookup"><span data-stu-id="ca26f-123">You are developing applications that use a middle tier for application logic.</span></span>  
  
 <span data-ttu-id="ca26f-124">Pour les plus petits objets, le stockage des objets blob `varbinary(max)` dans la base de données procure souvent de meilleures performances de diffusion en continu.</span><span class="sxs-lookup"><span data-stu-id="ca26f-124">For smaller objects, storing `varbinary(max)` BLOBs in the database often provides better streaming performance.</span></span>  
  
  
##  <a name="filestream-storage"></a><a name="storage"></a><span data-ttu-id="ca26f-125">Stockage FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-125">FILESTREAM Storage</span></span>  
 <span data-ttu-id="ca26f-126">Le stockage FILESTREAM est implémenté en tant que colonne `varbinary(max)` dans laquelle les données sont stockées comme objet blob dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-126">FILESTREAM storage is implemented as a `varbinary(max)` column in which the data is stored as BLOBs in the file system.</span></span> <span data-ttu-id="ca26f-127">Les tailles des objets blob sont limitées uniquement par la taille de volume du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-127">The sizes of the BLOBs are limited only by the volume size of the file system.</span></span> <span data-ttu-id="ca26f-128">La limitation `varbinary(max)` standard de tailles de fichiers de 2 Go ne s'applique pas aux objets blob stockés dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-128">The standard `varbinary(max)` limitation of 2-GB file sizes does not apply to BLOBs that are stored in the file system.</span></span>  
  
 <span data-ttu-id="ca26f-129">Pour spécifier qu'une colonne doit stocker des données dans le système de fichiers, spécifiez l'attribut FILESTREAM sur une colonne `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="ca26f-129">To specify that a column should store data on the file system, specify the FILESTREAM attribute on a `varbinary(max)` column.</span></span> <span data-ttu-id="ca26f-130">Le [!INCLUDE[ssDE](../../includes/ssde-md.md)] stocke alors toutes les données pour cette colonne dans le système de fichiers, mais pas dans le fichier de base de données.</span><span class="sxs-lookup"><span data-stu-id="ca26f-130">This causes the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to store all data for that column on the file system, but not in the database file.</span></span>  
  
 <span data-ttu-id="ca26f-131">Les données FILESTREAM doivent être stockées dans des groupes de fichiers FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-131">FILESTREAM data must be stored in FILESTREAM filegroups.</span></span> <span data-ttu-id="ca26f-132">Un groupe de fichiers FILESTREAM est un groupe de fichiers spécial qui contient des répertoires de système de fichiers au lieu des fichiers eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="ca26f-132">A FILESTREAM filegroup is a special filegroup that contains file system directories instead of the files themselves.</span></span> <span data-ttu-id="ca26f-133">Ces répertoires de système de fichiers portent le nom de *conteneurs de données*.</span><span class="sxs-lookup"><span data-stu-id="ca26f-133">These file system directories are called *data containers*.</span></span> <span data-ttu-id="ca26f-134">Les conteneurs de données sont l’interface entre le stockage du [!INCLUDE[ssDE](../../includes/ssde-md.md)] et le stockage du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-134">Data containers are the interface between [!INCLUDE[ssDE](../../includes/ssde-md.md)] storage and file system storage.</span></span>  
  
 <span data-ttu-id="ca26f-135">Lorsque vous utilisez le stockage FILESTREAM, considérez les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="ca26f-135">When you use FILESTREAM storage, consider the following:</span></span>  
  
-   <span data-ttu-id="ca26f-136">Lorsqu'une table contient une colonne FILESTREAM, chaque ligne doit avoir un ID de ligne unique n'acceptant pas la valeur Null.</span><span class="sxs-lookup"><span data-stu-id="ca26f-136">When a table contains a FILESTREAM column, each row must have a nonnull unique row ID.</span></span>  
  
-   <span data-ttu-id="ca26f-137">Plusieurs conteneurs de données peuvent être ajoutés à un groupe de fichiers FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-137">Multiple data containers can be added to a FILESTREAM filegroup.</span></span>  
  
-   <span data-ttu-id="ca26f-138">Les conteneurs de données FILESTREAM ne peuvent pas être imbriqués.</span><span class="sxs-lookup"><span data-stu-id="ca26f-138">FILESTREAM data containers cannot be nested.</span></span>  
  
-   <span data-ttu-id="ca26f-139">Lorsque vous utilisez le clustering de basculement, les groupes de fichiers FILESTREAM doivent être sur des ressources de disque partagées.</span><span class="sxs-lookup"><span data-stu-id="ca26f-139">When you are using failover clustering, the FILESTREAM filegroups must be on shared disk resources.</span></span>  
  
-   <span data-ttu-id="ca26f-140">Les groupes de fichiers FILESTREAM peuvent être sur des volumes compressés.</span><span class="sxs-lookup"><span data-stu-id="ca26f-140">FILESTREAM filegroups can be on compressed volumes.</span></span>  
  
### <a name="integrated-management"></a><span data-ttu-id="ca26f-141">Gestion intégrée</span><span class="sxs-lookup"><span data-stu-id="ca26f-141">Integrated Management</span></span>  
 <span data-ttu-id="ca26f-142">FILESTREAM étant implémenté en tant que colonne `varbinary(max)` et intégré directement dans le [!INCLUDE[ssDE](../../includes/ssde-md.md)], la plupart des fonctions et outils d'administration [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fonctionnent sans changement pour les données FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-142">Because FILESTREAM is implemented as a `varbinary(max)` column and integrated directly into the [!INCLUDE[ssDE](../../includes/ssde-md.md)], most [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management tools and functions work without modification for FILESTREAM data.</span></span> <span data-ttu-id="ca26f-143">Par exemple, vous pouvez utiliser tous les modes de récupération et de sauvegarde avec les données FILESTREAM, et les données FILESTREAM sont sauvegardées avec les données structurées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="ca26f-143">For example, you can use all backup and recovery models with FILESTREAM data, and the FILESTREAM data is backed up with the structured data in the database.</span></span> <span data-ttu-id="ca26f-144">Si vous ne souhaitez pas sauvegarder les données FILESTREAM avec les données relationnelles, vous pouvez utiliser une sauvegarde partielle pour exclure les groupes de fichiers FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-144">If you do not want to back up FILESTREAM data with relational data, you can use a partial backup to exclude FILESTREAM filegroups.</span></span>  

  
### <a name="integrated-security"></a><span data-ttu-id="ca26f-145">Sécurité intégrée</span><span class="sxs-lookup"><span data-stu-id="ca26f-145">Integrated Security</span></span>  
 <span data-ttu-id="ca26f-146">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], les données FILESTREAM sont sécurisées tout comme les autres données : en accordant des autorisations au niveau des tables ou des colonnes.</span><span class="sxs-lookup"><span data-stu-id="ca26f-146">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], FILESTREAM data is secured just like other data is secured: by granting permissions at the table or column levels.</span></span> <span data-ttu-id="ca26f-147">Si un utilisateur dispose de l'autorisation pour la colonne FILESTREAM dans une table, il peut ouvrir les fichiers associés.</span><span class="sxs-lookup"><span data-stu-id="ca26f-147">If a user has permission to the FILESTREAM column in a table, the user can open the associated files.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca26f-148">Le chiffrement n'est pas pris en charge sur les données FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-148">Encryption is not supported on FILESTREAM data.</span></span>  
  
 <span data-ttu-id="ca26f-149">Seul le compte sous lequel le compte de service [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] s'exécute dispose des autorisations NTFS sur le conteneur FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-149">Only the account under which the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] service account runs is granted NTFS permissions to the FILESTREAM container.</span></span> <span data-ttu-id="ca26f-150">Nous recommandons de n'accorder des autorisations sur le conteneur de données à aucun autre compte.</span><span class="sxs-lookup"><span data-stu-id="ca26f-150">We recommend that no other account be granted permissions on the data container.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ca26f-151">Les connexions SQL ne fonctionnent pas avec les conteneurs FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-151">SQL logins will not work with FILESTREAM containers.</span></span> <span data-ttu-id="ca26f-152">Seule l'authentification NTFS fonctionne avec les conteneurs FILESTREAM.</span><span class="sxs-lookup"><span data-stu-id="ca26f-152">Only NTFS authentication will work with FILESTREAM containers.</span></span>  
  
##  <a name="accessing-blob-data-with-transact-sql-and-file-system-streaming-access"></a><a name="dual"></a> <span data-ttu-id="ca26f-153">Accès aux données BLOB avec Transact-SQL et accès en continu au système de fichiers</span><span class="sxs-lookup"><span data-stu-id="ca26f-153">Accessing BLOB Data with Transact-SQL and File System Streaming Access</span></span>  
 <span data-ttu-id="ca26f-154">Après avoir stocké des données dans une colonne FILESTREAM, vous pouvez accéder aux fichiers en utilisant des transactions [!INCLUDE[tsql](../../includes/tsql-md.md)] ou en utilisant des API Win32.</span><span class="sxs-lookup"><span data-stu-id="ca26f-154">After you store data in a FILESTREAM column, you can access the files by using [!INCLUDE[tsql](../../includes/tsql-md.md)] transactions or by using Win32 APIs.</span></span>  
  
### <a name="transact-sql-access"></a><span data-ttu-id="ca26f-155">Accès Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ca26f-155">Transact-SQL Access</span></span>  
 <span data-ttu-id="ca26f-156">Grâce à [!INCLUDE[tsql](../../includes/tsql-md.md)], vous pouvez insérer, mettre à jour et supprimer des données FILESTREAM :</span><span class="sxs-lookup"><span data-stu-id="ca26f-156">By using [!INCLUDE[tsql](../../includes/tsql-md.md)], you can insert, update, and delete FILESTREAM data:</span></span>  
  
-   <span data-ttu-id="ca26f-157">Vous pouvez utiliser une opération d'insertion pour préremplir un champ FILESTREAM avec une valeur NULL, une valeur vide ou des données inline relativement courtes.</span><span class="sxs-lookup"><span data-stu-id="ca26f-157">You can use an insert operation to prepopulate a FILESTREAM field with a null value, empty value, or relatively short inline data.</span></span> <span data-ttu-id="ca26f-158">Toutefois, une grande quantité de données est diffusée en continu plus efficacement dans un fichier qui utilise des interfaces Win32.</span><span class="sxs-lookup"><span data-stu-id="ca26f-158">However, a large amount of data is more efficiently streamed into a file that uses Win32 interfaces.</span></span>  
  
-   <span data-ttu-id="ca26f-159">Lorsque vous mettez à jour un champ FILESTREAM, vous modifiez les données d'objet blob sous-jacentes dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-159">When you update a FILESTREAM field, you modify the underlying BLOB data in the file system.</span></span> <span data-ttu-id="ca26f-160">Lorsqu'un champ FILESTREAM a la valeur NULL, les données d'objet blob associées au champ sont supprimées.</span><span class="sxs-lookup"><span data-stu-id="ca26f-160">When a FILESTREAM field is set to NULL, the BLOB data associated with the field is deleted.</span></span> <span data-ttu-id="ca26f-161">Vous ne pouvez pas utiliser une mise à jour segmentée [!INCLUDE[tsql](../../includes/tsql-md.md)] , implémentée comme UPDATE **.** Write(), pour effectuer des mises à jour partielles des données.</span><span class="sxs-lookup"><span data-stu-id="ca26f-161">You cannot use a [!INCLUDE[tsql](../../includes/tsql-md.md)] chunked update, implemented as UPDATE **.** Write(), to perform partial updates to the data.</span></span>  
  
-   <span data-ttu-id="ca26f-162">Lorsque vous supprimez une ligne ou supprimez ou tronquez une table qui contient des données FILESTREAM, vous supprimez les données d'objet blob sous-jacentes dans le système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-162">When you delete a row or delete or truncate a table that contains FILESTREAM data, you delete the underlying BLOB data in the file system.</span></span>  
  
### <a name="file-system-streaming-access"></a><span data-ttu-id="ca26f-163">Accès de diffusion en continu au système de fichiers</span><span class="sxs-lookup"><span data-stu-id="ca26f-163">File System Streaming Access</span></span>  
 <span data-ttu-id="ca26f-164">La prise en charge de diffusion en continu Win32 fonctionne dans le contexte d'une transaction [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ca26f-164">The Win32 streaming support works in the context of a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] transaction.</span></span> <span data-ttu-id="ca26f-165">Dans une transaction, vous pouvez utiliser des fonctions FILESTREAM pour obtenir un chemin d'accès de système de fichiers UNC logique d'un fichier.</span><span class="sxs-lookup"><span data-stu-id="ca26f-165">Within a transaction, you can use FILESTREAM functions to obtain a logical UNC file system path of a file.</span></span> <span data-ttu-id="ca26f-166">Vous utilisez ensuite l’API OpenSqlFilestream pour obtenir un descripteur de fichier.</span><span class="sxs-lookup"><span data-stu-id="ca26f-166">You then use the OpenSqlFilestream API to obtain a file handle.</span></span> <span data-ttu-id="ca26f-167">Ce descripteur peut ensuite être utilisé par des interfaces de diffusion de fichiers en continu Win32, telles que ReadFile() et WriteFile(), afin d’accéder au fichier et de le mettre à jour par le biais du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-167">This handle can then be used by Win32 file streaming interfaces, such as ReadFile() and WriteFile(), to access and update the file by way of the file system.</span></span>  
  
 <span data-ttu-id="ca26f-168">Les opérations de fichiers étant transactionnelles, vous ne pouvez pas supprimer ou renommer des fichiers FILESTREAM par le biais du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-168">Because file operations are transactional, you cannot delete or rename FILESTREAM files through the file system.</span></span>  
  
 <span data-ttu-id="ca26f-169">**Modèle d'instruction**</span><span class="sxs-lookup"><span data-stu-id="ca26f-169">**Statement Model**</span></span>  
  
 <span data-ttu-id="ca26f-170">L'accès au système de fichiers FILESTREAM modèle une instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] en utilisant l'ouverture et la fermeture de fichier.</span><span class="sxs-lookup"><span data-stu-id="ca26f-170">The FILESTREAM file system access models a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement by using file open and close.</span></span> <span data-ttu-id="ca26f-171">L'instruction démarre lorsqu'un descripteur de fichier est ouvert et se termine lorsque le descripteur est fermé.</span><span class="sxs-lookup"><span data-stu-id="ca26f-171">The statement starts when a file handle is opened and ends when the handle is closed.</span></span> <span data-ttu-id="ca26f-172">Par exemple, lorsqu'un descripteur d'écriture est fermé, tout déclencheur AFTER possible enregistré sur la table est activé comme si une instruction UPDATE était effectuée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-172">For example, when a write handle is closed, any possible AFTER trigger that is registered on the table fires as if an UPDATE statement is completed.</span></span>  
  
 <span data-ttu-id="ca26f-173">**Espace de noms de stockage**</span><span class="sxs-lookup"><span data-stu-id="ca26f-173">**Storage Namespace**</span></span>  
  
 <span data-ttu-id="ca26f-174">Dans FILESTREAM, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] contrôle l'espace de noms du système de fichiers physique d'objet blob.</span><span class="sxs-lookup"><span data-stu-id="ca26f-174">In FILESTREAM, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] controls the BLOB physical file system namespace.</span></span> <span data-ttu-id="ca26f-175">Une nouvelle fonction intrinsèque, [PathName](/sql/relational-databases/system-functions/pathname-transact-sql), fournit le chemin UNC logique de l’objet blob qui correspond à chaque cellule FILESTREAM dans la table.</span><span class="sxs-lookup"><span data-stu-id="ca26f-175">A new intrinsic function, [PathName](/sql/relational-databases/system-functions/pathname-transact-sql), provides the logical UNC path of the BLOB that corresponds to each FILESTREAM cell in the table.</span></span> <span data-ttu-id="ca26f-176">L’application utilise ce chemin logique pour obtenir le descripteur Win32 et opérer sur les données d’objet blob en utilisant des interfaces de système de fichiers Win32 ordinaires.</span><span class="sxs-lookup"><span data-stu-id="ca26f-176">The application uses this logical path to obtain the Win32 handle and operate on the BLOB data by using regular Win32 file system interfaces.</span></span> <span data-ttu-id="ca26f-177">La fonction retourne NULL si la valeur de la colonne FILESTREAM est NULL.</span><span class="sxs-lookup"><span data-stu-id="ca26f-177">The function returns NULL if the value of the FILESTREAM column is NULL.</span></span>  
  
 <span data-ttu-id="ca26f-178">**Accès au système de fichiers traité**</span><span class="sxs-lookup"><span data-stu-id="ca26f-178">**Transacted File System Access**</span></span>  
  
 <span data-ttu-id="ca26f-179">Une nouvelle fonction intrinsèque, [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql), fournit le jeton qui représente la transaction actuelle à laquelle la session est associée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-179">A new intrinsic function, [GET_FILESTREAM_TRANSACTION_CONTEXT()](/sql/t-sql/functions/get-filestream-transaction-context-transact-sql), provides the token that represents the current transaction that the session is associated with.</span></span> <span data-ttu-id="ca26f-180">La transaction doit avoir été démarrée mais pas encore abandonnée ou validée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-180">The transaction must have been started and not yet aborted or committed.</span></span> <span data-ttu-id="ca26f-181">En obtenant un jeton, l'application lie les opérations de diffusion en continu de système de fichiers FILESTREAM avec une transaction commencée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-181">By obtaining a token, the application binds the FILESTREAM file system streaming operations with a started transaction.</span></span> <span data-ttu-id="ca26f-182">La fonction retourne NULL si aucune transaction n'est explicitement commencée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-182">The function returns NULL in case of no explicitly started transaction.</span></span>  
  
 <span data-ttu-id="ca26f-183">Tous les descripteurs de fichiers doivent être fermés avant que la transaction ne soit validée ou abandonnée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-183">All file handles must be closed before the transaction commits or aborts.</span></span> <span data-ttu-id="ca26f-184">Si un descripteur est laissé ouvert au-delà de l'étendue de transaction, les lectures supplémentaires contre le descripteur provoqueront un échec ; les écritures supplémentaires contre le descripteur réussiront, mais les données effectives ne seront pas écrites sur le disque.</span><span class="sxs-lookup"><span data-stu-id="ca26f-184">If a handle is left open beyond the transaction scope, additional reads against the handle will cause a failure; additional writes against the handle will succeed, but the actual data will not be written to disk.</span></span> <span data-ttu-id="ca26f-185">De même, si la base de données ou l'instance du [!INCLUDE[ssDE](../../includes/ssde-md.md)] s'arrête, tous les descripteurs ouverts sont invalidés.</span><span class="sxs-lookup"><span data-stu-id="ca26f-185">Similarly, if the database or instance of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] shuts down, all open handles are invalidated.</span></span>  
  
 <span data-ttu-id="ca26f-186">**Durabilité transactionnelle**</span><span class="sxs-lookup"><span data-stu-id="ca26f-186">**Transactional Durability**</span></span>  
  
 <span data-ttu-id="ca26f-187">Avec FILESTREAM, lors de la validation des transactions, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] garantit la durabilité des transactions pour les données d'objet blob FILESTREAM modifiées à partir de l'accès en continu au système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-187">With FILESTREAM, upon transaction commit, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] ensures transaction durability for FILESTREAM BLOB data that is modified from the file system streaming access.</span></span>  
  
 <span data-ttu-id="ca26f-188">**Sémantique d'isolation**</span><span class="sxs-lookup"><span data-stu-id="ca26f-188">**Isolation Semantics**</span></span>  
  
 <span data-ttu-id="ca26f-189">La sémantique d'isolation est gouvernée par les niveaux d'isolation des transactions du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ca26f-189">The isolation semantics are governed by [!INCLUDE[ssDE](../../includes/ssde-md.md)] transaction isolation levels.</span></span> <span data-ttu-id="ca26f-190">Le niveau d'isolation de lecture validée est pris en charge pour l'accès [!INCLUDE[tsql](../../includes/tsql-md.md)] et au système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="ca26f-190">Read-committed isolation level is supported for [!INCLUDE[tsql](../../includes/tsql-md.md)] and file system access.</span></span> <span data-ttu-id="ca26f-191">Les opérations de lecture renouvelables, ainsi que les isolements de capture instantanée sérialisables, sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="ca26f-191">Repeatable read operations, and also serializable and snapshot isolations, are supported.</span></span> <span data-ttu-id="ca26f-192">La lecture erronée n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="ca26f-192">Dirty read is not supported.</span></span>  
  
 <span data-ttu-id="ca26f-193">Les opérations d'ouverture d'accès au système de fichiers n'attendent pas de verrous.</span><span class="sxs-lookup"><span data-stu-id="ca26f-193">The file system access open operations do not wait for any locks.</span></span> <span data-ttu-id="ca26f-194">Au lieu de cela, les opérations d'ouverture échouent immédiatement si elles ne peuvent pas accéder aux données à cause de l'isolation des transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-194">Instead, the open operations fail immediately if they cannot access the data because of transaction isolation.</span></span> <span data-ttu-id="ca26f-195">Les appels API de diffusion en continu échouent avec ERROR_SHARING_VIOLATION si l'opération d'ouverture ne peut se poursuivre à cause de la violation d'isolation.</span><span class="sxs-lookup"><span data-stu-id="ca26f-195">The streaming API calls fail with ERROR_SHARING_VIOLATION if the open operation cannot continue because of isolation violation.</span></span>  
  
 <span data-ttu-id="ca26f-196">Pour permettre les mises à jour partielles, l'application peut publier un contrôle FS de périphérique (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT) afin d'extraire l'ancien contenu dans le fichier auquel le descripteur ouvert fait référence.</span><span class="sxs-lookup"><span data-stu-id="ca26f-196">To allow for partial updates to be made, the application can issue a device FS control (FSCTL_SQL_FILESTREAM_FETCH_OLD_CONTENT) to fetch the old content into the file that the opened handle references.</span></span> <span data-ttu-id="ca26f-197">Cela déclenchera une copie de l'ancien contenu côté serveur.</span><span class="sxs-lookup"><span data-stu-id="ca26f-197">This will trigger a server-side old content copy.</span></span> <span data-ttu-id="ca26f-198">Pour de meilleures performances d'application et afin d'éviter des dépassements de délais d'attente potentiels lorsque vous travaillez avec de très grands fichiers, nous vous recommandons d'utiliser des E/S asynchrones.</span><span class="sxs-lookup"><span data-stu-id="ca26f-198">For better application performance and to avoid running into potential time-outs when you are working with very large files, we recommend that you use asynchronous I/O.</span></span>  
  
 <span data-ttu-id="ca26f-199">Si le FSCTL est publié après l'écriture dans le descripteur, la dernière opération d'écriture persistera et les écritures antérieures effectuées dans le descripteur seront perdues.</span><span class="sxs-lookup"><span data-stu-id="ca26f-199">If the FSCTL is issued after the handle has been written to, the last write operation will persist, and prior writes that were made to the handle are lost.</span></span>  
  
 <span data-ttu-id="ca26f-200">**API du système de fichiers et niveaux d'isolation pris en charge**</span><span class="sxs-lookup"><span data-stu-id="ca26f-200">**File System APIs and Supported Isolation Levels**</span></span>  
  
 <span data-ttu-id="ca26f-201">Lorsqu'une API du système de fichiers ne parvient pas à ouvrir un fichier en raison d'une violation d'isolation, une exception ERROR_SHARING_VIOLATION est retournée.</span><span class="sxs-lookup"><span data-stu-id="ca26f-201">When a file system API cannot open a file because of an isolation violation, an ERROR_SHARING_VIOLATION exception is returned.</span></span> <span data-ttu-id="ca26f-202">Cette violation d'isolation se produit lorsque deux transactions essaient d'accéder au même fichier.</span><span class="sxs-lookup"><span data-stu-id="ca26f-202">This isolation violation occurs when two transactions try to access the same file.</span></span> <span data-ttu-id="ca26f-203">Le résultat de l'opération d'accès dépend du mode dans lequel le fichier a été ouvert et de la version de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sur laquelle la transaction s'exécute.</span><span class="sxs-lookup"><span data-stu-id="ca26f-203">The outcome of the access operation depends on the mode the file was opened in and the version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that the transaction is running on.</span></span> <span data-ttu-id="ca26f-204">Le tableau suivant décrit les résultats possibles pour les deux transactions qui accèdent au même fichier.</span><span class="sxs-lookup"><span data-stu-id="ca26f-204">The following table outlines the possibly outcomes for two transactions that are accessing the same file.</span></span>  
  
|<span data-ttu-id="ca26f-205">Transaction 1</span><span class="sxs-lookup"><span data-stu-id="ca26f-205">Transaction 1</span></span>|<span data-ttu-id="ca26f-206">Transaction 2</span><span class="sxs-lookup"><span data-stu-id="ca26f-206">Transaction 2</span></span>|<span data-ttu-id="ca26f-207">Résultat sur SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="ca26f-207">Outcome on SQL Server 2008</span></span>|<span data-ttu-id="ca26f-208">Résultat sur SQL Server 2008 R2 et les versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="ca26f-208">Outcome on SQL Server 2008 R2 and later versions</span></span>|  
|-------------------|-------------------|--------------------------------|------------------------------------------------------|  
|<span data-ttu-id="ca26f-209">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-209">Open for read.</span></span>|<span data-ttu-id="ca26f-210">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-210">Open for read.</span></span>|<span data-ttu-id="ca26f-211">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-211">Both succeed.</span></span>|<span data-ttu-id="ca26f-212">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-212">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-213">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-213">Open for read.</span></span>|<span data-ttu-id="ca26f-214">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-214">Open for write.</span></span>|<span data-ttu-id="ca26f-215">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-215">Both succeed.</span></span> <span data-ttu-id="ca26f-216">Les opérations d'écriture sous la transaction 2 n'affectent pas les opérations de lecture effectuées dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-216">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="ca26f-217">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-217">Both succeed.</span></span> <span data-ttu-id="ca26f-218">Les opérations d'écriture sous la transaction 2 n'affectent pas les opérations de lecture effectuées dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-218">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="ca26f-219">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-219">Open for write.</span></span>|<span data-ttu-id="ca26f-220">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-220">Open for read.</span></span>|<span data-ttu-id="ca26f-221">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-221">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="ca26f-222">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-222">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-223">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-223">Open for write.</span></span>|<span data-ttu-id="ca26f-224">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-224">Open for write.</span></span>|<span data-ttu-id="ca26f-225">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-225">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="ca26f-226">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-226">Open for transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="ca26f-227">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-227">Open for read.</span></span>|<span data-ttu-id="ca26f-228">Ouvert pour SELECT.</span><span class="sxs-lookup"><span data-stu-id="ca26f-228">Open for SELECT.</span></span>|<span data-ttu-id="ca26f-229">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-229">Both succeed.</span></span>|<span data-ttu-id="ca26f-230">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-230">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-231">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-231">Open for read.</span></span>|<span data-ttu-id="ca26f-232">Ouvert pour UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="ca26f-232">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="ca26f-233">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-233">Both succeed.</span></span> <span data-ttu-id="ca26f-234">Les opérations d'écriture sous la transaction 2 n'affectent pas les opérations de lecture effectuées dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-234">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|<span data-ttu-id="ca26f-235">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-235">Both succeed.</span></span> <span data-ttu-id="ca26f-236">Les opérations d'écriture sous la transaction 2 n'affectent pas les opérations de lecture effectuées dans la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-236">Write operations under transaction 2 do not affect read operations performed in transaction 1.</span></span>|  
|<span data-ttu-id="ca26f-237">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-237">Open for write.</span></span>|<span data-ttu-id="ca26f-238">Ouvert pour SELECT.</span><span class="sxs-lookup"><span data-stu-id="ca26f-238">open for SELECT.</span></span>|<span data-ttu-id="ca26f-239">La transaction 2 se bloque jusqu'à ce que la transaction 1 valide ou termine la transaction, ou l'opération d'obtention d'un verrou pour la transaction se solde par une erreur de délai d'attente.</span><span class="sxs-lookup"><span data-stu-id="ca26f-239">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="ca26f-240">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-240">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-241">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-241">Open for write.</span></span>|<span data-ttu-id="ca26f-242">Ouvert pour UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="ca26f-242">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="ca26f-243">La transaction 2 se bloque jusqu'à ce que la transaction 1 valide ou termine la transaction, ou l'opération d'obtention d'un verrou pour la transaction se solde par une erreur de délai d'attente.</span><span class="sxs-lookup"><span data-stu-id="ca26f-243">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|<span data-ttu-id="ca26f-244">La transaction 2 se bloque jusqu'à ce que la transaction 1 valide ou termine la transaction, ou l'opération d'obtention d'un verrou pour la transaction se solde par une erreur de délai d'attente.</span><span class="sxs-lookup"><span data-stu-id="ca26f-244">Transaction 2 blocks until transaction 1 commits or ends the transaction, or the transaction lock times out.</span></span>|  
|<span data-ttu-id="ca26f-245">Ouvert pour SELECT.</span><span class="sxs-lookup"><span data-stu-id="ca26f-245">Open for SELECT.</span></span>|<span data-ttu-id="ca26f-246">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-246">Open for read.</span></span>|<span data-ttu-id="ca26f-247">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-247">Both succeed.</span></span>|<span data-ttu-id="ca26f-248">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-248">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-249">Ouvert pour SELECT.</span><span class="sxs-lookup"><span data-stu-id="ca26f-249">Open for SELECT.</span></span>|<span data-ttu-id="ca26f-250">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-250">Open for write.</span></span>|<span data-ttu-id="ca26f-251">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-251">Both succeed.</span></span> <span data-ttu-id="ca26f-252">Les opérations d'écriture sous la transaction 2 n'affectent pas la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-252">Write operations under transaction 2 do not affect transaction 1.</span></span>|<span data-ttu-id="ca26f-253">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-253">Both succeed.</span></span> <span data-ttu-id="ca26f-254">Les opérations d'écriture sous la transaction 2 n'affectent pas la transaction 1.</span><span class="sxs-lookup"><span data-stu-id="ca26f-254">Write operations under transaction 2 do not affect transaction 1.</span></span>|  
|<span data-ttu-id="ca26f-255">Ouvert pour UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="ca26f-255">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="ca26f-256">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-256">Open for read.</span></span>|<span data-ttu-id="ca26f-257">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-257">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="ca26f-258">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-258">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-259">Ouvert pour UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="ca26f-259">Open for UPDATE or DELETE.</span></span>|<span data-ttu-id="ca26f-260">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-260">Open for write.</span></span>|<span data-ttu-id="ca26f-261">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-261">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="ca26f-262">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-262">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
|<span data-ttu-id="ca26f-263">Ouvert pour SELECT avec lecture renouvelable.</span><span class="sxs-lookup"><span data-stu-id="ca26f-263">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="ca26f-264">Ouvert pour la lecture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-264">Open for read.</span></span>|<span data-ttu-id="ca26f-265">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-265">Both succeed.</span></span>|<span data-ttu-id="ca26f-266">Réussite des deux transactions.</span><span class="sxs-lookup"><span data-stu-id="ca26f-266">Both succeed.</span></span>|  
|<span data-ttu-id="ca26f-267">Ouvert pour SELECT avec lecture renouvelable.</span><span class="sxs-lookup"><span data-stu-id="ca26f-267">Open for SELECT with repeatable read.</span></span>|<span data-ttu-id="ca26f-268">Ouvert pour l'écriture.</span><span class="sxs-lookup"><span data-stu-id="ca26f-268">Open for write.</span></span>|<span data-ttu-id="ca26f-269">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-269">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|<span data-ttu-id="ca26f-270">L'opération d'ouverture sur la transaction 2 échoue avec une exception ERROR_SHARING_VIOLATION.</span><span class="sxs-lookup"><span data-stu-id="ca26f-270">The open operation on transaction 2 fails with an ERROR_SHARING_VIOLATION exception.</span></span>|  
  
 <span data-ttu-id="ca26f-271">**Double écriture à partir de clients distants**</span><span class="sxs-lookup"><span data-stu-id="ca26f-271">**Write-Through from Remote Clients**</span></span>  
  
 <span data-ttu-id="ca26f-272">L'accès de système de fichiers distant aux données FILESTREAM est activé sur le protocole SMB (Block Server Message).</span><span class="sxs-lookup"><span data-stu-id="ca26f-272">Remote file system access to FILESTREAM data is enabled over the Server Message Block (SMB) protocol.</span></span> <span data-ttu-id="ca26f-273">Si le client est distant, aucune opération d'écriture n'est mise en cache par le côté client.</span><span class="sxs-lookup"><span data-stu-id="ca26f-273">If the client is remote, no write operations are cached by the client side.</span></span> <span data-ttu-id="ca26f-274">Les opérations d'écriture seront toujours envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="ca26f-274">The write operations will always be sent to the server.</span></span> <span data-ttu-id="ca26f-275">Les données peuvent être mises en cache du côté serveur.</span><span class="sxs-lookup"><span data-stu-id="ca26f-275">The data can be cached on the server side.</span></span> <span data-ttu-id="ca26f-276">Nous recommandons que les applications qui s'exécutent sur des clients distants consolident les petites opérations d'écriture afin d'effectuer moins d'opérations d'écriture avec une taille de données supérieure.</span><span class="sxs-lookup"><span data-stu-id="ca26f-276">We recommend that applications that are running on remote clients consolidate small write operations to make fewer write operations using larger data size.</span></span>  
  
 <span data-ttu-id="ca26f-277">La création de vues mappées en mémoire (E/S mappées en mémoire) à l'aide d'un descripteur FILESTREAM n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="ca26f-277">Creating memory mapped views (memory mapped I/O) by using a FILESTREAM handle is not supported.</span></span> <span data-ttu-id="ca26f-278">Si le mappage mémoire est utilisé pour les données FILESTREAM, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] ne peut pas garantir la cohérence et la durabilité des données, ni l’intégrité de la base de données.</span><span class="sxs-lookup"><span data-stu-id="ca26f-278">If memory mapping is used for FILESTREAM data, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] cannot guarantee consistency and durability of the data or the integrity of the database.</span></span>  
  
##  <a name="related-tasks"></a><a name="reltasks"></a> <span data-ttu-id="ca26f-279">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="ca26f-279">Related Tasks</span></span>  
 [<span data-ttu-id="ca26f-280">Activer et configurer FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-280">Enable and Configure FILESTREAM</span></span>](enable-and-configure-filestream.md)  
  [<span data-ttu-id="ca26f-281">Créer une base de données compatible FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-281">Create a FILESTREAM-Enabled Database</span></span>](create-a-filestream-enabled-database.md)  
  [<span data-ttu-id="ca26f-282">Créer une table pour le stockage de données FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-282">Create a Table for Storing FILESTREAM Data</span></span>](create-a-table-for-storing-filestream-data.md)  
  [<span data-ttu-id="ca26f-283">Accéder aux données FILESTREAM avec Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="ca26f-283">Access FILESTREAM Data with Transact-SQL</span></span>](access-filestream-data-with-transact-sql.md)  
  [<span data-ttu-id="ca26f-284">Créer des applications clientes pour les données FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-284">Create Client Applications for FILESTREAM Data</span></span>](create-client-applications-for-filestream-data.md)  
  [<span data-ttu-id="ca26f-285">Accéder à des données FILESTREAM avec OpenSqlFilestream</span><span class="sxs-lookup"><span data-stu-id="ca26f-285">Access FILESTREAM Data with OpenSqlFilestream</span></span>](access-filestream-data-with-opensqlfilestream.md)  
  [<span data-ttu-id="ca26f-286">Effectuer des mises à jour partielles de données FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-286">Make Partial Updates to FILESTREAM Data</span></span>](make-partial-updates-to-filestream-data.md)  
  [<span data-ttu-id="ca26f-287">Éviter les conflits avec les opérations de base de données dans les applications FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-287">Avoid Conflicts with Database Operations in FILESTREAM Applications</span></span>](avoid-conflicts-with-database-operations-in-filestream-applications.md)  
  [<span data-ttu-id="ca26f-288">Déplacer une base de données compatible FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-288">Move a FILESTREAM-Enabled Database</span></span>](move-a-filestream-enabled-database.md)  
  [<span data-ttu-id="ca26f-289">Configurer FILESTREAM sur un cluster de basculement</span><span class="sxs-lookup"><span data-stu-id="ca26f-289">Set Up FILESTREAM on a Failover Cluster</span></span>](set-up-filestream-on-a-failover-cluster.md)  
  [<span data-ttu-id="ca26f-290">Configurer un pare-feu pour l’accès FILESTREAM</span><span class="sxs-lookup"><span data-stu-id="ca26f-290">Configure a Firewall for FILESTREAM Access</span></span>](configure-a-firewall-for-filestream-access.md)  
  
##  <a name="related-content"></a><a name="relcontent"></a> <span data-ttu-id="ca26f-291">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="ca26f-291">Related Content</span></span>  
 [<span data-ttu-id="ca26f-292">Compatibilité de FILESTREAM avec d’autres fonctionnalités SQL Server</span><span class="sxs-lookup"><span data-stu-id="ca26f-292">FILESTREAM Compatibility with Other SQL Server Features</span></span>](filestream-compatibility-with-other-sql-server-features.md)  
  
