---
title: Utilisation du fournisseur WMI pour les événements de serveur | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- event notifications [WMI]
- permissions [WMI]
- connection strings [WMI]
- security [WMI]
- Service Broker [WMI]
- WMI Provider for Server Events, connection strings
- WMI Provider for Server Events, Service Broker
- notifications [WMI]
- WMI Provider for Server Events, security
ms.assetid: cd974b3b-2309-4a20-b9be-7cfc93fc4389
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: 79ee9c4402971807263284d10e31db702abeee86
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87697627"
---
# <a name="working-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="0f464-102">Utilisation du fournisseur WMI pour les événements de serveur</span><span class="sxs-lookup"><span data-stu-id="0f464-102">Working with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="0f464-103">Cette rubrique fournit des indications que vous devez prendre en compte avant de programmer à l'aide du fournisseur WMI pour les événements de serveur.</span><span class="sxs-lookup"><span data-stu-id="0f464-103">This topic provides guidelines you should consider before you program using the WMI Provider for Server Events.</span></span>  
  
## <a name="enabling-service-broker"></a><span data-ttu-id="0f464-104">Activation de Service Broker</span><span class="sxs-lookup"><span data-stu-id="0f464-104">Enabling Service Broker</span></span>  
 <span data-ttu-id="0f464-105">Le fournisseur WMI pour les événements de serveur fonctionne en traduisant les requêtes WQL pour les événements en notifications d'événements dans la base de données que vous ciblez.</span><span class="sxs-lookup"><span data-stu-id="0f464-105">The WMI Provider for Server Events works by translating WQL queries for events into event notifications in the database that you target.</span></span> <span data-ttu-id="0f464-106">Il peut être utile de comprendre comment les notifications d'événements fonctionnent lorsque vous programmez en fonction du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0f464-106">An understanding of how event notifications work can be useful to you when programming against the provider.</span></span> <span data-ttu-id="0f464-107">Pour plus d’informations, consultez [Fournisseur WMI pour les concepts des événements de serveur](https://technet.microsoft.com/library/ms180560.aspx).</span><span class="sxs-lookup"><span data-stu-id="0f464-107">For more information, see [WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx).</span></span>  
  
 <span data-ttu-id="0f464-108">En particulier, comme les notifications d'événements créées par le fournisseur WMI utilisent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour envoyer des messages sur les événements de serveur, ce service doit être activé partout où les événements sont générés.</span><span class="sxs-lookup"><span data-stu-id="0f464-108">In particular, because the event notifications created by the WMI Provider use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to send messages about server events, this service must be enabled wherever the events are generated.</span></span> <span data-ttu-id="0f464-109">Si votre programme interroge des événements sur une instance de serveur, le [!INCLUDE[ssSB](../../includes/sssb-md.md)] dans msdb de cette instance doit être activé, car ceci est l'emplacement du service [!INCLUDE[ssSB](../../includes/sssb-md.md)] cible (nommé SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) qui est créé par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0f464-109">If your program queries events on a server instance, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in msdb of that instance must be enabled, because that is the location of the target [!INCLUDE[ssSB](../../includes/sssb-md.md)] service (named SQL/Notifications/ProcessWMIEventProviderNotification/v1.0) that is created by the provider.</span></span> <span data-ttu-id="0f464-110">Si votre programme interroge des événements dans une base de données ou sur un objet de base de données particulier, le [!INCLUDE[ssSB](../../includes/sssb-md.md)] dans cette base de données cible doit être activé.</span><span class="sxs-lookup"><span data-stu-id="0f464-110">If your program queries events in a database or on a particular database object, the [!INCLUDE[ssSB](../../includes/sssb-md.md)] in that target database must be enabled.</span></span> <span data-ttu-id="0f464-111">Si le [!INCLUDE[ssSB](../../includes/sssb-md.md)] correspondant n'est pas activé après le déploiement de votre application, tous les événements générés par la notification d'événements sous-jacente sont envoyés à la file d'attente du service utilisé par la notification d'événements, mais ils ne sont pas retournés à votre application de gestion WMI tant que le [!INCLUDE[ssSB](../../includes/sssb-md.md)] n'est pas activé.</span><span class="sxs-lookup"><span data-stu-id="0f464-111">If the corresponding [!INCLUDE[ssSB](../../includes/sssb-md.md)] is not enabled after your application is deployed, any events generated by the underlying event notification are sent to the queue of the service used by the event notification, but are not returned to your WMI management application until [!INCLUDE[ssSB](../../includes/sssb-md.md)] is enabled.</span></span>  
  
 <span data-ttu-id="0f464-112">La requête suivante détermine quelles instances Service Broker sont activées sur une instance de serveur, ainsi que le GUID des instances Service Broker :</span><span class="sxs-lookup"><span data-stu-id="0f464-112">The following query determines which service brokers are enabled on a server instance, and the broker instance GUID:</span></span>  
  
```  
SELECT name, is_broker_enabled, service_broker_guid FROM sys.databases;  
```  
  
 <span data-ttu-id="0f464-113">Le GUID du Service Broker de msdb présente un intérêt particulier car il s'agit de l'emplacement du service cible du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0f464-113">The service broker GUID of msdb is of particular interest because that is the location of the target service of the provider.</span></span>  
  
 <span data-ttu-id="0f464-114">Pour activer [!INCLUDE[ssSB](../../includes/sssb-md.md)] dans une base de données, utilisez l’option SET ENABLE_BROKER de l’instruction [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="0f464-114">To enable [!INCLUDE[ssSB](../../includes/sssb-md.md)] in a database, use the ENABLE_BROKER SET option of the [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql) statement.</span></span>  
  
## <a name="specifying-a-connection-string"></a><span data-ttu-id="0f464-115">Spécification d'une chaîne de connexion</span><span class="sxs-lookup"><span data-stu-id="0f464-115">Specifying a Connection String</span></span>  
 <span data-ttu-id="0f464-116">Les applications dirigent le fournisseur WMI pour les événements de serveur vers une instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en se connectant à un espace de noms WMI défini par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="0f464-116">Applications direct the WMI Provider for Server Events to an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by connecting to a WMI namespace defined by the provider.</span></span> <span data-ttu-id="0f464-117">Le service WMI de Windows mappe cet espace de noms à la DLL de fournisseur, Sqlwep.dll, puis la charge en mémoire.</span><span class="sxs-lookup"><span data-stu-id="0f464-117">The Windows WMI service maps this namespace to the provider DLL, Sqlwep.dll, and loads it into memory.</span></span> <span data-ttu-id="0f464-118">Chaque instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] possède son propre espace de noms WMI, qui a comme valeur par défaut : \\ \\ . \\ *root* \\ *instance_name*racine \Microsoft\SqlServer\ServerEvents.</span><span class="sxs-lookup"><span data-stu-id="0f464-118">Each instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] has its own WMI namespace, which defaults to: \\\\.\\*root*\Microsoft\SqlServer\ServerEvents\\*instance_name*.</span></span> <span data-ttu-id="0f464-119">*instance_name* a pour valeur par défaut MSSQLServer dans une installation par défaut de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0f464-119">*instance_name* defaults to MSSQLSERVER in a default installation of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="permissions-and-server-authentication"></a><span data-ttu-id="0f464-120">Autorisations et authentification serveur</span><span class="sxs-lookup"><span data-stu-id="0f464-120">Permissions and Server Authentication</span></span>  
 <span data-ttu-id="0f464-121">Pour accéder au fournisseur WMI pour les événements de serveur, le client d'où provient une application de gestion WMI doit correspondre à une connexion authentifiée Windows ou à un groupe dans l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] spécifiée dans la chaîne de connexion de l'application.</span><span class="sxs-lookup"><span data-stu-id="0f464-121">To access the WMI Provider for Server Events, the client on which a WMI management application originates must correspond to Windows authenticated login or group in the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specified in the application's connection string of the application.</span></span>  
  
## <a name="permissions-and-event-notification-scope"></a><span data-ttu-id="0f464-122">Autorisations et étendue des notifications d'événements</span><span class="sxs-lookup"><span data-stu-id="0f464-122">Permissions and Event Notification Scope</span></span>  
 <span data-ttu-id="0f464-123">Le fournisseur WMI pour les événements de serveur traduit des requêtes WQL en notifications d'événements dans la base de données cible.</span><span class="sxs-lookup"><span data-stu-id="0f464-123">The WMI Provider for Server Events translates WQL queries into event notifications in the target database.</span></span> <span data-ttu-id="0f464-124">Pour cette raison, l'application appelante doit avoir non seulement les autorisations minimales requises pour accéder au fournisseur, mais aussi les autorisations correctes dans la base de données pour créer les notifications d'événements requises.</span><span class="sxs-lookup"><span data-stu-id="0f464-124">Because of this, the calling application must have not only the required minimum permissions to access the provider, but must also have the correct permissions in the database to create the required event notifications.</span></span> <span data-ttu-id="0f464-125">Les autorisations sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="0f464-125">The following are the permissions:</span></span>  
  
-   <span data-ttu-id="0f464-126">Pour créer une notification d'événements dont l'étendue correspond à la base de données, au minimum, l'autorisation CREATE DATABASE DDL EVENT NOTIFICATION est requise sur la base de données actuelle.</span><span class="sxs-lookup"><span data-stu-id="0f464-126">To create an event notification that is scoped to the database, at a minimum, CREATE DATABASE DDL EVENT NOTIFICATION permission in the current database is required.</span></span>  
  
-   <span data-ttu-id="0f464-127">Pour créer une notification d'événements sur une instruction DDL dont l'étendue correspond au serveur, au minimum, l'autorisation CREATE DDL EVENT NOTIFICATION est requise sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="0f464-127">To create an event notification on a DDL statement that is scoped to the server, at a minimum, CREATE DDL EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="0f464-128">Pour créer une notification d'événements sur un événement de trace, au minimum, l'autorisation CREATE TRACE EVENT NOTIFICATION est requise sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="0f464-128">To create an event notification on a trace event, at a minimum, CREATE TRACE EVENT NOTIFICATION permission in the server is required.</span></span>  
  
-   <span data-ttu-id="0f464-129">Pour créer une notification d'événements dont l'étendue correspond à une file d'attente, au minimum, l'autorisation ALTER est requise sur la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="0f464-129">To create an event notification that is scoped to a queue, at a minimum, ALTER permission on the queue is required.</span></span>  
  
 <span data-ttu-id="0f464-130">Pour plus d’informations sur l’étendue des requêtes WQL, consultez [utilisation de WQL avec le fournisseur WMI pour les événements de serveur](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="0f464-130">For information about how WQL queries are scoped, see [Using WQL with the WMI Provider for Server Events](https://technet.microsoft.com/library/ms180524\(v=sql.105\).aspx).</span></span>  
  
 <span data-ttu-id="0f464-131">Pour illustrer l'étendue, considérez une application de fournisseur WMI qui inclut la requête WQL suivante :</span><span class="sxs-lookup"><span data-stu-id="0f464-131">To illustrate scope, consider a WMI Provider application that includes the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE  
WHERE DatabaseName = "AdventureWorks2012"   
    AND SchemaName = "Person"  
    AND ObjectName = "Person"  
    AND ObjectType = "TABLE";  
```  
  
 <span data-ttu-id="0f464-132">Le fournisseur WMI traduit cette requête en une notification d'événements créée dans la base de données [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0f464-132">The WMI provider translates this query into an event notification that is created in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="0f464-133">Cela signifie que l'appelant doit avoir les autorisations requises pour créer une telle notification d'événements, notamment l'autorisation CREATE DATABASE DDL EVENT NOTIFICATION dans la base de données [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0f464-133">This means that the caller must have the required permissions to create such an event notification, specifically CREATE DATABASE DDL EVENT NOTIFICATION permission in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span>  
  
 <span data-ttu-id="0f464-134">Si une requête WQL spécifie une notification d'événements dont l'étendue correspond au niveau serveur, par exemple en émettant la requête SELECT \* FROM ALTER_TABLE, l'application appelante doit avoir l'autorisation CREATE DDL EVENT NOTIFICATION au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="0f464-134">If a WQL query specifies an event notification scoped at the server level, for example by issuing the query SELECT \* FROM ALTER_TABLE, the calling application must have the server-level CREATE DDL EVENT NOTIFICATION permission.</span></span> <span data-ttu-id="0f464-135">Notez que les notifications d'événements dont l'étendue est le serveur sont stockées dans la base de données master.</span><span class="sxs-lookup"><span data-stu-id="0f464-135">Note that server-scoped event notifications are stored in the master database.</span></span> <span data-ttu-id="0f464-136">Vous pouvez utiliser l’affichage catalogue [sys. server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) pour afficher leurs métadonnées.</span><span class="sxs-lookup"><span data-stu-id="0f464-136">You can use the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view to see their metadata.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0f464-137">L'étendue de la notification d'événements qui est créée par le fournisseur WMI (serveur, base de données ou objet) dépend finalement du résultat du processus de vérification des autorisations qui est utilisé par le fournisseur WMI.</span><span class="sxs-lookup"><span data-stu-id="0f464-137">The scope of the event notification that is created by the WMI Provider (server, database, or object) ultimately depends on the outcome of the permissions verification process that is used by the WMI provider.</span></span> <span data-ttu-id="0f464-138">Cela est affecté par le jeu d'autorisations de l'utilisateur qui appelle le fournisseur et sur la vérification de la base de données interrogée.</span><span class="sxs-lookup"><span data-stu-id="0f464-138">This is affected by the permission set of the user that is calling the provider and on the verification of the database that is being queried.</span></span>  
>   
>  <span data-ttu-id="0f464-139">Dans l'exemple précédent, le fournisseur commence par essayer de créer une notification d'événements dont l'étendue est la base de données (`ON DATABASE`).</span><span class="sxs-lookup"><span data-stu-id="0f464-139">In the previous example, the provider first tries to create an event notification scoped to the database (`ON DATABASE`).</span></span> <span data-ttu-id="0f464-140">Si le fournisseur vérifie que la base de données existe et que l'appelant possède les autorisations requises pour créer une notification d'événements dessus, l'inscription réussit.</span><span class="sxs-lookup"><span data-stu-id="0f464-140">If the provider verifies that the database exists and that the caller has the required permissions to create an event notification on it, the registration is successful.</span></span> <span data-ttu-id="0f464-141">Si l'inscription ne réussit pas, le fournisseur essaie de créer une notification d'événements sur le serveur (`ON SERVER`).</span><span class="sxs-lookup"><span data-stu-id="0f464-141">If it is not successful, the provider tries to create an event notification on the server (`ON SERVER`).</span></span> <span data-ttu-id="0f464-142">En supposant que cette tentative réussit, tous les événements `ALTER_TABLE` qui se produisent sur le serveur sont envoyés du processus [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] au processus du service WMI.</span><span class="sxs-lookup"><span data-stu-id="0f464-142">Assuming that this attempt is successful, all `ALTER_TABLE` events that occur on the server are sent from the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process to the WMI Service process.</span></span> <span data-ttu-id="0f464-143">Toutefois, le fournisseur élimine par filtrage tous les événements qui ne s'appliquent pas à la base de données `AdventureWorks`.</span><span class="sxs-lookup"><span data-stu-id="0f464-143">However, the provider filters out any events that do not apply to the `AdventureWorks` database.</span></span> <span data-ttu-id="0f464-144">Bien que ce processus augmente potentiellement la quantité de trafic réseau nécessaire pour l'étendue de l'événement, il vous apporte également la souplesse d'enregistrer des requêtes WQL sur les bases de données avant qu'elles soient créées, puis de recevoir les données d'événement après la création de la base de données et le démarrage de l'activité DDL sur cette dernière.</span><span class="sxs-lookup"><span data-stu-id="0f464-144">Although this process potentially increases the amount of network traffic necessary for the scope of the event, this process also enables you with the flexibility to register WQL queries on databases before they are created, and then receive event data after the database is created and DDL activity starts on it.</span></span>  
  
## <a name="permissions-and-message-verification"></a><span data-ttu-id="0f464-145">Autorisations et vérification de message</span><span class="sxs-lookup"><span data-stu-id="0f464-145">Permissions and Message Verification</span></span>  
 <span data-ttu-id="0f464-146">Le fournisseur WMI n'envoie pas de messages pour les notifications d'événements si les deux conditions suivantes sont vraies :</span><span class="sxs-lookup"><span data-stu-id="0f464-146">The WMI Provider does not send messages for event notifications if both of the following conditions are true:</span></span>  
  
-   <span data-ttu-id="0f464-147">L'utilisateur qui a créé la notification d'événements par le biais du fournisseur WMI n'existe plus dans la base de données ou ne possède plus l'autorisation requise pour créer une notification d'événements semblable.</span><span class="sxs-lookup"><span data-stu-id="0f464-147">The user that created the event notification through the WMI Provider no longer exists in the database, or no longer has the required permission to create a similar event notification.</span></span>  
  
-   <span data-ttu-id="0f464-148">Les notifications d'événements sont créées sur les événements suivants :</span><span class="sxs-lookup"><span data-stu-id="0f464-148">The event notifications are created on the following events:</span></span>  
  
    -   <span data-ttu-id="0f464-149">DROP_LOGIN</span><span class="sxs-lookup"><span data-stu-id="0f464-149">DROP_LOGIN</span></span>  
  
    -   <span data-ttu-id="0f464-150">ALTER_LOGIN</span><span class="sxs-lookup"><span data-stu-id="0f464-150">ALTER_LOGIN</span></span>  
  
    -   <span data-ttu-id="0f464-151">DROP_USER</span><span class="sxs-lookup"><span data-stu-id="0f464-151">DROP_USER</span></span>  
  
    -   <span data-ttu-id="0f464-152">ALTER_USER</span><span class="sxs-lookup"><span data-stu-id="0f464-152">ALTER_USER</span></span>  
  
    -   <span data-ttu-id="0f464-153">ADD_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="0f464-153">ADD_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="0f464-154">DROP_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="0f464-154">DROP_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="0f464-155">ADD_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="0f464-155">ADD_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="0f464-156">DROP_SERVER_ROLE_MEMBER</span><span class="sxs-lookup"><span data-stu-id="0f464-156">DROP_SERVER_ROLE_MEMBER</span></span>  
  
    -   <span data-ttu-id="0f464-157">DENY ou REVOKE (S'applique uniquement aux autorisations ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION ou CREATE TRACE EVENT NOTIFICATION.)</span><span class="sxs-lookup"><span data-stu-id="0f464-157">DENY or REVOKE (Applies only to ALTER DATABASE, ALTER ANY DATABASE EVENT NOTIFICATION, CREATE DATABASE DDL EVENT NOTIFICATION, CONTROL SERVER, ALTER ANY EVENT NOTIFICATION, CREATE DDL EVENT NOTIFICATION, OR CREATE TRACE EVENT NOTIFICATION permissions.)</span></span>  
  
## <a name="working-with-event-data-on-the-client-side"></a><span data-ttu-id="0f464-158">Utilisation de données d'événements côté client</span><span class="sxs-lookup"><span data-stu-id="0f464-158">Working with Event Data on the Client Side</span></span>  
 <span data-ttu-id="0f464-159">Une fois que le fournisseur WMI pour les événements de serveur a créé la notification d’événements requise dans la base de données cible, la notification d’événements envoie les données d’événement au service cible dans msdb, nommé **SQL/Notifications/ProcessWMIEventProviderNotification/v 1.0**.</span><span class="sxs-lookup"><span data-stu-id="0f464-159">After the WMI Provider for Server Events creates the required event notification in the target database, the event notification sends event data to the target service in msdb that is named **SQL/Notifications/ProcessWMIEventProviderNotification/v1.0**.</span></span> <span data-ttu-id="0f464-160">Le service cible place l’événement dans une file d’attente `msdb` nommée **WMIEventProviderNotificationQueue**.</span><span class="sxs-lookup"><span data-stu-id="0f464-160">The target service puts the event into a queue in `msdb` that is named **WMIEventProviderNotificationQueue**.</span></span> <span data-ttu-id="0f464-161">(Le service et la file d’attente sont créés dynamiquement par le fournisseur lorsqu’il se connecte pour la première fois à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .) Le fournisseur lit ensuite les données d’événement XML de cette file d’attente et les transforme en MOF (Managed Object Format) avant de les retourner à l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="0f464-161">(Both the service and the queue are dynamically created by the provider when it first connects to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].) The provider then reads the XML event data from this queue and transforms it into managed object format (MOF) before returning it to the client application.</span></span> <span data-ttu-id="0f464-162">Les données MOF sont composées des propriétés de l'événement demandé par la requête WQL comme une définition de classe CIM (Common Information Model).</span><span class="sxs-lookup"><span data-stu-id="0f464-162">The MOF data is made up of the properties of the event that is requested by the WQL query as a Common Information Model (CIM) class definition.</span></span> <span data-ttu-id="0f464-163">Chaque propriété a un type CIM correspondant.</span><span class="sxs-lookup"><span data-stu-id="0f464-163">Each property has a corresponding CIM type.</span></span> <span data-ttu-id="0f464-164">Par exemple, la propriété `SPID` est retournée sous forme de type CIM `Sint32`.</span><span class="sxs-lookup"><span data-stu-id="0f464-164">For example, the `SPID` property is returned as CIM type `Sint32`.</span></span> <span data-ttu-id="0f464-165">Les types CIM pour chaque propriété sont répertoriés sous chaque classe d’événements du [fournisseur WMI pour les classes et propriétés d’événements de serveur](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span><span class="sxs-lookup"><span data-stu-id="0f464-165">The CIM types for each property are listed under each event class in [WMI Provider for Server Events Classes and Properties](../../relational-databases/wmi-provider-server-events/wmi-provider-for-server-events-classes-and-properties.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0f464-166">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0f464-166">See Also</span></span>  
 [<span data-ttu-id="0f464-167">Fournisseur WMI pour les concepts des événements de serveur</span><span class="sxs-lookup"><span data-stu-id="0f464-167">WMI Provider for Server Events Concepts</span></span>](https://technet.microsoft.com/library/ms180560.aspx)  
  
  
