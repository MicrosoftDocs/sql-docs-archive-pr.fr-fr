---
title: Utilisation de WQL avec le fournisseur WMI pour les événements de serveur | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: wmi
ms.topic: reference
helpviewer_keywords:
- queries [WMI]
- query language [WMI]
- WMI Query Language [WMI]
- WQL [WMI]
- WMI Provider for Server Events, WQL
ms.assetid: 58b67426-1e66-4445-8e2c-03182e94c4be
author: CarlRabeler
ms.author: carlrab
ms.openlocfilehash: df2bbf5c6031781494695f95116441fde34bf4f5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605288"
---
# <a name="using-wql-with-the-wmi-provider-for-server-events"></a><span data-ttu-id="8d19c-102">Utilisation de WQL avec le fournisseur WMI pour les événements de serveur</span><span class="sxs-lookup"><span data-stu-id="8d19c-102">Using WQL with the WMI Provider for Server Events</span></span>
  <span data-ttu-id="8d19c-103">Les applications de gestion accèdent aux événements [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] via le fournisseur WMI pour les événements serveur en émettant des instructions WQL (WMI Query Language).</span><span class="sxs-lookup"><span data-stu-id="8d19c-103">Management applications access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] events using the WMI Provider for Server Events by issuing WMI Query Language (WQL) statements.</span></span> <span data-ttu-id="8d19c-104">Le langage WQL est un sous-ensemble simplifié du langage SQL, avec quelques extensions spécifiques à WMI.</span><span class="sxs-lookup"><span data-stu-id="8d19c-104">WQL is a simplified subset of structured query language (SQL), with some WMI-specific extensions.</span></span> <span data-ttu-id="8d19c-105">Pour utiliser le WQL, une application extrait un type d'événement sur une instance spécifique de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], une base de données ou un objet de base de données (le seul objet pris en charge actuellement est la file d'attente).</span><span class="sxs-lookup"><span data-stu-id="8d19c-105">In using WQL, an application retrieves an event type against a specific instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], a database, or a database object (the only object currently supported is queue).</span></span> <span data-ttu-id="8d19c-106">Le fournisseur WMI pour les événements serveur traduit la requête en une notification d’événement qui est créée dans la base de données cible pour les notifications d’événements étendues à la base de données ou à l’étendue de l’objet, ou dans la base de données **Master** pour les notifications d’événements d’étendue de serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-106">The WMI Provider for Server Events translates the query into an event notification that is created in the target database for database-scoped or object-scoped event notifications, or in the **master** database for server-scoped event notifications.</span></span>  
  
 <span data-ttu-id="8d19c-107">Examinons, par exemple, la requête WQL suivante :</span><span class="sxs-lookup"><span data-stu-id="8d19c-107">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM DDL_DATABASE_LEVEL_EVENTS WHERE DatabaseName = 'AdventureWorks'  
```  
  
 <span data-ttu-id="8d19c-108">À partir de cette requête, le fournisseur WMI tente de produire l'équivalent de cette notification d'événements sur le serveur cible :</span><span class="sxs-lookup"><span data-stu-id="8d19c-108">From this query, the WMI Provider tries to produce the equivalent of this event notification on the target server:</span></span>  
  
```  
USE AdventureWorks ;  
GO  
  
CREATE EVENT NOTIFICATION SQLWEP_76CF38C1_18BB_42DD_A7DC_C8820155B0E9  
    ON DATABASE  
    WITH FAN_IN  
    FOR DDL_DATABASE_LEVEL_EVENTS  
    TO SERVICE   
        'SQL/Notifications/ProcessWMIEventProviderNotification/v1.0',  
        'A7E5521A-1CA6-4741-865D-826F804E5135';  
GO  
```  
  
 <span data-ttu-id="8d19c-109">L'argument de la clause `FROM` de la requête WQL (`DDL_DATABASE_LEVEL_EVENTS`) peut être n'importe quel événement valide sur lequel il est possible de créer une notification d'événements.</span><span class="sxs-lookup"><span data-stu-id="8d19c-109">The argument in the `FROM` clause of the WQL query (`DDL_DATABASE_LEVEL_EVENTS`) can be any valid event upon which an event notification can be created.</span></span> <span data-ttu-id="8d19c-110">Les arguments des clauses `SELECT` et `WHERE` peuvent spécifier n'importe quelle propriété d'événement associée à un événement ou à son événement parent.</span><span class="sxs-lookup"><span data-stu-id="8d19c-110">The arguments in the `SELECT` and `WHERE` clauses can specify any event property associated with an event or its parent event.</span></span> <span data-ttu-id="8d19c-111">Pour obtenir la liste des événements et des propriétés d’événement valides, consultez [notifications d’événements (moteur de base de données)](https://technet.microsoft.com/library/ms182602.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d19c-111">For a list of valid events and event properties, see [Event Notifications (Database Engine)](https://technet.microsoft.com/library/ms182602.aspx).</span></span>  
  
 <span data-ttu-id="8d19c-112">La syntaxe WQL suivante est prise en charge explicitement par le fournisseur WMI pour les événements serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-112">The following WQL syntax is supported explicitly by the WMI Provider for Server Events.</span></span> <span data-ttu-id="8d19c-113">Une syntaxe WQL additionnelle peut être spécifiée, mais elle n'est pas spécifique à ce fournisseur et est analysée à la place par le service hôte WMI.</span><span class="sxs-lookup"><span data-stu-id="8d19c-113">Additional WQL syntax may be specified, but it is not specific to this provider and is parsed instead by the WMI host service.</span></span> <span data-ttu-id="8d19c-114">Pour plus d'informations sur le langage de requêtes WMI (WQL), consultez la documentation WQL sur MSDN (Microsoft Developer Network).</span><span class="sxs-lookup"><span data-stu-id="8d19c-114">For more information about the WMI Query Language, see the WQL documentation on the Microsoft Developer Network (MSDN).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="8d19c-115">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="8d19c-115">Syntax</span></span>  
  
```  
  
SELECT { event_property [ ,...n ] | * }  
FROM event_type   
WHERE where_condition  
```  
  
## <a name="arguments"></a><span data-ttu-id="8d19c-116">Arguments</span><span class="sxs-lookup"><span data-stu-id="8d19c-116">Arguments</span></span>  
 <span data-ttu-id="8d19c-117">*event_property*</span><span class="sxs-lookup"><span data-stu-id="8d19c-117">*event_property*</span></span>  
 <span data-ttu-id="8d19c-118">Est la propriété d'un événement.</span><span class="sxs-lookup"><span data-stu-id="8d19c-118">Is a property of an event.</span></span> <span data-ttu-id="8d19c-119">`PostTime`, `SPID` et `LoginName` en sont des exemples.</span><span class="sxs-lookup"><span data-stu-id="8d19c-119">Examples include `PostTime`, `SPID`, and `LoginName`.</span></span> <span data-ttu-id="8d19c-120">Recherchez chaque événement listé dans [fournisseur WMI pour les classes et propriétés d’événements de serveur](wmi-provider-for-server-events-classes-and-properties.md) afin de déterminer les propriétés qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="8d19c-120">Look up each event listed in [WMI Provider for Server Events Classes and Properties](wmi-provider-for-server-events-classes-and-properties.md) to determine which properties it holds.</span></span> <span data-ttu-id="8d19c-121">Par exemple, l'événement DDL_DATABASE_LEVEL_EVENTS contient les propriétés `DatabaseName` et `UserName`.</span><span class="sxs-lookup"><span data-stu-id="8d19c-121">For example, the DDL_DATABASE_LEVEL_EVENTS event holds the `DatabaseName` and `UserName` properties.</span></span> <span data-ttu-id="8d19c-122">Il hérite également des propriétés `SQLInstance`, `LoginName`, `PostTime`, `SPID` et `ComputerName` de ses événements parents.</span><span class="sxs-lookup"><span data-stu-id="8d19c-122">It also inherits the `SQLInstance`, `LoginName`, `PostTime`, `SPID`, and `ComputerName` properties from its parent events.</span></span>  
  
 <span data-ttu-id="8d19c-123">**,** *... n*</span><span class="sxs-lookup"><span data-stu-id="8d19c-123">**,** *...n*</span></span>  
 <span data-ttu-id="8d19c-124">Indique que les *event_property* peuvent être interrogées plusieurs fois, séparées par des virgules.</span><span class="sxs-lookup"><span data-stu-id="8d19c-124">Indicates that *event_property* can be queried multiple times, separated by commas.</span></span>  
  
 \*  
 <span data-ttu-id="8d19c-125">Spécifie que toutes les propriétés associées à un événement sont interrogées.</span><span class="sxs-lookup"><span data-stu-id="8d19c-125">Specifies that all properties associated with an event are queried.</span></span>  
  
 <span data-ttu-id="8d19c-126">*event_type*</span><span class="sxs-lookup"><span data-stu-id="8d19c-126">*event_type*</span></span>  
 <span data-ttu-id="8d19c-127">Est un événement sur lequel une notification d'événements peut être créée.</span><span class="sxs-lookup"><span data-stu-id="8d19c-127">Is any event against which an event notification can be created.</span></span> <span data-ttu-id="8d19c-128">Pour obtenir la liste des événements disponibles, consultez [fournisseur WMI pour les classes et propriétés d’événements de serveur](https://technet.microsoft.com/library/ms186449.aspx).</span><span class="sxs-lookup"><span data-stu-id="8d19c-128">For a list of available events, see [WMI Provider for Server Events Classes and Properties](https://technet.microsoft.com/library/ms186449.aspx).</span></span> <span data-ttu-id="8d19c-129">Notez que les noms de *type d’événement* correspondent aux mêmes *event_type*  |  *event_group* qui peuvent être spécifiés quand vous créez manuellement une notification d’événement à l’aide de l’événement créer une notification d’événements.</span><span class="sxs-lookup"><span data-stu-id="8d19c-129">Note that *event type* names correspond to the same *event_type* | *event_group* that can be specified when you manually create an event notification by using CREATE EVENT NOTIFICATION.</span></span> <span data-ttu-id="8d19c-130">CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS et TRC_DATABASE sont des exemples de *type d’événement* .</span><span class="sxs-lookup"><span data-stu-id="8d19c-130">Examples of *event type* include CREATE_TABLE, LOCK_DEADLOCK, DDL_USER_EVENTS, and TRC_DATABASE.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8d19c-131">Certaines procédures stockées système qui exécutent des opérations de type DDL peuvent également déclencher des notifications d'événements.</span><span class="sxs-lookup"><span data-stu-id="8d19c-131">Certain system stored procedures that perform DDL-like operations can also fire event notifications.</span></span> <span data-ttu-id="8d19c-132">Testez vos notifications d'événements pour déterminer leur réponse aux procédures stockées du système qui sont exécutées.</span><span class="sxs-lookup"><span data-stu-id="8d19c-132">Test your event notifications to determine their responses to system stored procedures that are run.</span></span> <span data-ttu-id="8d19c-133">Par exemple, l’instruction CREATe TYPE et la procédure stockée **sp_addtype** déclenchent toutes deux une notification d’événement qui est créée sur un événement CREATE_TYPE.</span><span class="sxs-lookup"><span data-stu-id="8d19c-133">For example, the CREATE TYPE statement and **sp_addtype** stored procedure will both fire an event notification that is created on a CREATE_TYPE event.</span></span> <span data-ttu-id="8d19c-134">Toutefois, la procédure stockée **sp_rename** ne déclenche pas de notifications d’événements.</span><span class="sxs-lookup"><span data-stu-id="8d19c-134">However, the **sp_rename** stored procedure does not fire any event notifications.</span></span> <span data-ttu-id="8d19c-135">Pour plus d’informations, consultez[événements DDL](../triggers/ddl-events.md).</span><span class="sxs-lookup"><span data-stu-id="8d19c-135">For more information, see[DDL Events](../triggers/ddl-events.md).</span></span>  
  
 <span data-ttu-id="8d19c-136">*where_condition*</span><span class="sxs-lookup"><span data-stu-id="8d19c-136">*where_condition*</span></span>  
 <span data-ttu-id="8d19c-137">Est un prédicat de requête de la clause WHERE constitué de noms de *event_property* et d’opérateurs logiques et de comparaison.</span><span class="sxs-lookup"><span data-stu-id="8d19c-137">Is a WHERE clause query predicate made up of *event_property* names and logical and comparison operators.</span></span> <span data-ttu-id="8d19c-138">Le *where_condition* détermine l’étendue dans laquelle la notification d’événements correspondante est inscrite dans la base de données cible.</span><span class="sxs-lookup"><span data-stu-id="8d19c-138">The *where_condition* determines the scope in which the corresponding event notification is registered in the target database.</span></span> <span data-ttu-id="8d19c-139">Il peut également servir de filtre pour cibler un schéma ou un objet particulier à partir duquel interroger *event_type.*</span><span class="sxs-lookup"><span data-stu-id="8d19c-139">It can also act as a filter to target a particular schema or object from which to query *event_type.*</span></span> <span data-ttu-id="8d19c-140">Pour plus d'informations, consultez la section « Notes » plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="8d19c-140">For more information, see the Remarks section later in this topic.</span></span>  
  
 <span data-ttu-id="8d19c-141">Seul l'opérande `=` peut être utilisé avec `DatabaseName`, `SchemaName` et `ObjectName`.</span><span class="sxs-lookup"><span data-stu-id="8d19c-141">Only the `=` operand can be used together with `DatabaseName`, `SchemaName`, and `ObjectName`.</span></span> <span data-ttu-id="8d19c-142">D'autres expressions ne peuvent pas être utilisées avec ces propriétés d'événement.</span><span class="sxs-lookup"><span data-stu-id="8d19c-142">Other expressions cannot be used with these event properties.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="8d19c-143">Notes</span><span class="sxs-lookup"><span data-stu-id="8d19c-143">Remarks</span></span>  
 <span data-ttu-id="8d19c-144">La *where_condition* de la syntaxe du fournisseur WMI pour les événements de serveur détermine les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="8d19c-144">The *where_condition* of the WMI Provider for Server Events syntax determines the following:</span></span>  
  
-   <span data-ttu-id="8d19c-145">Portée par laquelle le fournisseur tente de récupérer les *event_type*spécifiées : le niveau serveur, le niveau base de données ou le niveau objet (le seul objet pris en charge actuellement est la file d’attente).</span><span class="sxs-lookup"><span data-stu-id="8d19c-145">The scope by which the provider tries to retrieve the specified *event_type*: the server level, database level, or object level (the only object currently supported is queue).</span></span> <span data-ttu-id="8d19c-146">En dernier ressort, cette étendue détermine le type de notification d'événements créé dans la base de données cible.</span><span class="sxs-lookup"><span data-stu-id="8d19c-146">Ultimately, this scope determines the type of event notification created in the target database.</span></span> <span data-ttu-id="8d19c-147">Ce processus est appelé inscription de notification d'événements.</span><span class="sxs-lookup"><span data-stu-id="8d19c-147">This process called event notification registration.</span></span>  
  
-   <span data-ttu-id="8d19c-148">La base de données, le schéma et l'objet, le cas échéant, sur lequel s'effectue l'inscription.</span><span class="sxs-lookup"><span data-stu-id="8d19c-148">The database, schema, and object, where appropriate, on which to register.</span></span>  
  
 <span data-ttu-id="8d19c-149">Le fournisseur WMI pour les événements serveur utilise un algorithme ascendant pour produire l'étendue la plus étroite possible pour l'EVENT NOTIFICATION sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="8d19c-149">The WMI Provider for Server Events uses a bottom-up, first-fit algorithm to produce the narrowest possible scope for the underlying EVENT NOTIFICATION.</span></span> <span data-ttu-id="8d19c-150">L'algorithme essaie de réduire l'activité interne sur le serveur, ainsi que le trafic réseau entre l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le processus hôte de WMI.</span><span class="sxs-lookup"><span data-stu-id="8d19c-150">The algorithm tries to minimize internal activity on the server and network traffic between the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] and the WMI host process.</span></span> <span data-ttu-id="8d19c-151">Le fournisseur examine les *event_type* spécifiées dans la clause from et les conditions de la clause WHERE, puis tente d’enregistrer la notification d’événement sous-jacente avec l’étendue la plus étroite possible.</span><span class="sxs-lookup"><span data-stu-id="8d19c-151">The provider examines the *event_type* specified in the FROM clause and the conditions in the WHERE clause, and tries to register the underlying EVENT NOTIFICATION with the narrowest possible scope.</span></span> <span data-ttu-id="8d19c-152">Si le fournisseur ne peut pas effectuer l'inscription avec l'étendue la plus étroite, il essaie de s'inscrire successivement à des étendues supérieures jusqu'à ce qu'une inscription réussisse enfin.</span><span class="sxs-lookup"><span data-stu-id="8d19c-152">If the provider cannot register at the narrowest scope, it tries to register at successively higher scopes until a registration finally succeeds.</span></span> <span data-ttu-id="8d19c-153">S'il atteint l'étendue la plus élevée (niveau serveur) et échoue, il retourne une erreur au consommateur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-153">If it reaches the highest scope the server-level) and fails, it returns an error to the consumer.</span></span>  
  
 <span data-ttu-id="8d19c-154">Par exemple, si DatabaseName =**'** AdventureWorks **'** est spécifié dans la clause WHERE, le fournisseur essaie d’inscrire une notification d’événement dans la [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] base de données.</span><span class="sxs-lookup"><span data-stu-id="8d19c-154">For example, if DatabaseName=**'** AdventureWorks **'** is specified in the WHERE clause, the provider tries to register an event notification in the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database.</span></span> <span data-ttu-id="8d19c-155">Si la base de données [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] existe et que le client appelant a les autorisations requises pour créer une notification d'événements dans [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], l'inscription est réussie.</span><span class="sxs-lookup"><span data-stu-id="8d19c-155">If the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database exists and the calling client has the required permissions to create an event notification in [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)], the registration is successful.</span></span> <span data-ttu-id="8d19c-156">Sinon, une tentative a lieu pour enregistrer la notification d'événements au niveau serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-156">Otherwise, an attempt is made to register the event notification at the server level.</span></span> <span data-ttu-id="8d19c-157">L'inscription réussit si le client WMI a les autorisations requises.</span><span class="sxs-lookup"><span data-stu-id="8d19c-157">The registration succeeds if the WMI client has the required permissions.</span></span> <span data-ttu-id="8d19c-158">Toutefois, dans ce scénario, les événements ne sont pas retournés au client tant que la base de données [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] n'a pas été créée.</span><span class="sxs-lookup"><span data-stu-id="8d19c-158">However, under this scenario, events are not returned to the client until the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] database has been created.</span></span>  
  
 <span data-ttu-id="8d19c-159">La *where_condition* peut également servir de filtre pour limiter en outre la requête à une base de données, un schéma ou un objet spécifique.</span><span class="sxs-lookup"><span data-stu-id="8d19c-159">The *where_condition* can also act as a filter to additionally limit the query to a specific database, schema, or object.</span></span> <span data-ttu-id="8d19c-160">Examinons, par exemple, la requête WQL suivante :</span><span class="sxs-lookup"><span data-stu-id="8d19c-160">For example, consider the following WQL query:</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
 <span data-ttu-id="8d19c-161">Selon le résultat de la procédure d'inscription, cette requête WQL peut être inscrite au niveau base de données ou au niveau serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-161">Depending on the outcome of the registration process, this WQL query may be registered either at the database or server level.</span></span> <span data-ttu-id="8d19c-162">Toutefois, même si elle est inscrite au niveau serveur, le fournisseur filtre en fin de compte tous les événements `ALTER_TABLE` qui ne s'appliquent pas à la table `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="8d19c-162">However, even if it is registered at the server level, the provider ultimately filters any `ALTER_TABLE` events that do not apply to the `AdventureWorks.Sales.SalesOrderDetail` table.</span></span> <span data-ttu-id="8d19c-163">En d'autres termes, le fournisseur ne retourne que les propriétés des événements `ALTER_TABLE` qui se produisent sur cette table spécifique.</span><span class="sxs-lookup"><span data-stu-id="8d19c-163">In other words, the provider returns only the properties of the `ALTER_TABLE` events that occur on that specific table.</span></span>  
  
 <span data-ttu-id="8d19c-164">Si une expression composée telle que `DatabaseName='AW1'` OR `DatabaseName='AW2'` est spécifiée, une tentative a lieu pour inscrire une seule notification d'événements dans l'étendue du serveur au lieu de deux notifications d'événements distinctes.</span><span class="sxs-lookup"><span data-stu-id="8d19c-164">If a compound expression such as `DatabaseName='AW1'` OR `DatabaseName='AW2'` is specified, an attempt is made to register a single event notification at the server scope instead of two separate event notifications.</span></span> <span data-ttu-id="8d19c-165">L'inscription réussit si le client appelant a les autorisations requises.</span><span class="sxs-lookup"><span data-stu-id="8d19c-165">The registration succeeds if the calling client has permissions.</span></span>  
  
 <span data-ttu-id="8d19c-166">Si `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` tous les sont spécifiés dans la `WHERE` clause, une tentative d’enregistrement de la notification d’événement directement sur l’objet dans le schéma est effectuée `Z` `X` .</span><span class="sxs-lookup"><span data-stu-id="8d19c-166">If `SchemaName='X' AND ObjectType='Y' AND ObjectName='Z'` are all specified in the `WHERE` clause, an attempt is made to register the event notification directly on object `Z` in schema `X`.</span></span> <span data-ttu-id="8d19c-167">L'inscription réussit si le client a les autorisations requises.</span><span class="sxs-lookup"><span data-stu-id="8d19c-167">The registration succeeds if the client has permissions.</span></span> <span data-ttu-id="8d19c-168">Notez que, actuellement, les événements de niveau objet sont pris en charge uniquement sur les files d’attente et uniquement pour le *event_type*QUEUE_ACTIVATION.</span><span class="sxs-lookup"><span data-stu-id="8d19c-168">Note that currently, object-level events are supported only on queues, and only for the QUEUE_ACTIVATION *event_type*.</span></span>  
  
 <span data-ttu-id="8d19c-169">Notez que certains événements ne peuvent pas être interrogés dans quelque étendue que ce soit.</span><span class="sxs-lookup"><span data-stu-id="8d19c-169">Note that not all events can be queried at any particular scope.</span></span> <span data-ttu-id="8d19c-170">Par exemple, une requête WQL sur un événement de trace tel que Lock_Deadlock ou un groupe d'événements de trace tel que TRC_LOCKS ne peut être inscrite qu'au niveau serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-170">For example, a WQL query on a trace event such as Lock_Deadlock, or a trace event group such as TRC_LOCKS, can only be registered at the server level.</span></span> <span data-ttu-id="8d19c-171">De même, l'événement CREATE_ENDPOINT et le groupe d'événements DDL_ENDPOINT_EVENTS ne peuvent également être inscrits qu'au niveau serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-171">Similarly, the CREATE_ENDPOINT event and the DDL_ENDPOINT_EVENTS event group can also be registered only at the server level.</span></span> <span data-ttu-id="8d19c-172">Pour plus d’informations sur l’étendue appropriée pour l’inscription des événements, consultez [conception de notifications d’événements](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span><span class="sxs-lookup"><span data-stu-id="8d19c-172">For more information about the appropriate scope for registering events, see [Designing Event Notifications](https://technet.microsoft.com/library/ms175854\(v=sql.105\).aspx).</span></span> <span data-ttu-id="8d19c-173">Une tentative d’inscription d’une requête WQL dont les *event_type* peuvent uniquement être inscrits au niveau du serveur est toujours effectuée au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="8d19c-173">An attempt to register a WQL query whose *event_type* can only be registered at the server level is always made at the server level.</span></span> <span data-ttu-id="8d19c-174">L'inscription réussit si le client WMI a les autorisations requises.</span><span class="sxs-lookup"><span data-stu-id="8d19c-174">Registration succeeds if the WMI client has permissions.</span></span> <span data-ttu-id="8d19c-175">Sinon, une erreur est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="8d19c-175">Otherwise, an error is returned to the client.</span></span> <span data-ttu-id="8d19c-176">Dans certains cas, cependant, vous pouvez encore utiliser la clause WHERE comme filtre pour les événements de niveau serveur en fonction des propriétés qui correspondent à l'événement.</span><span class="sxs-lookup"><span data-stu-id="8d19c-176">In some cases, however, you can still use the WHERE clause as a filter for server-level events based on the properties that correspond to the event.</span></span> <span data-ttu-id="8d19c-177">Par exemple, de nombreux événements de trace ont une propriété `DatabaseName` qui peut être utilisée dans la clause WHERE comme filtre.</span><span class="sxs-lookup"><span data-stu-id="8d19c-177">For example, many trace events have a `DatabaseName` property that can be used in the WHERE clause as a filter.</span></span>  
  
 <span data-ttu-id="8d19c-178">Les notifications d’événements d’étendue de serveur sont créées dans la base de données **Master** et peuvent être interrogées pour les métadonnées à l’aide de l’affichage catalogue [sys. server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="8d19c-178">Server-scoped event notifications are created in the **master** database and can be queried for metadata by using the [sys.server_event_notifications](/sql/relational-databases/system-catalog-views/sys-server-event-notifications-transact-sql) catalog view.</span></span>  
  
 <span data-ttu-id="8d19c-179">Les notifications d’événements au niveau de la base de données ou de l’étendue objet sont créées dans la base de données spécifiée et peuvent être interrogées pour les métadonnées à l’aide de l’affichage catalogue [sys. event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="8d19c-179">Database-scoped or object-scoped event notifications are created in the specified database and can be queried for metadata by using the [sys.event_notifications](/sql/relational-databases/system-catalog-views/sys-event-notifications-transact-sql) catalog view.</span></span> <span data-ttu-id="8d19c-180">(Vous devez préfixer l'affichage catalogue avec le nom correspondant de la base de données.)</span><span class="sxs-lookup"><span data-stu-id="8d19c-180">(You must prefix the catalog view with the corresponding database name.)</span></span>  
  
## <a name="examples"></a><span data-ttu-id="8d19c-181">Exemples</span><span class="sxs-lookup"><span data-stu-id="8d19c-181">Examples</span></span>  
  
### <a name="a-querying-for-events-at-the-server-scope"></a><span data-ttu-id="8d19c-182">R.</span><span class="sxs-lookup"><span data-stu-id="8d19c-182">A.</span></span> <span data-ttu-id="8d19c-183">Interrogation des événements dans l'étendue du serveur</span><span class="sxs-lookup"><span data-stu-id="8d19c-183">Querying for events at the server scope</span></span>  
 <span data-ttu-id="8d19c-184">La requête WQL suivante extrait toutes les propriétés d'événement pour tout événement de trace `SERVER_MEMORY_CHANGE` qui se produit sur l'instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8d19c-184">The following WQL query retrieves all event properties for any `SERVER_MEMORY_CHANGE` trace event that occurs on the instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
```  
SELECT * FROM SERVER_MEMORY_CHANGE  
```  
  
### <a name="b-querying-for-events-at-the-database-scope"></a><span data-ttu-id="8d19c-185">B.</span><span class="sxs-lookup"><span data-stu-id="8d19c-185">B.</span></span> <span data-ttu-id="8d19c-186">Interrogation des événements dans l'étendue de la base de données</span><span class="sxs-lookup"><span data-stu-id="8d19c-186">Querying for events at the database scope</span></span>  
 <span data-ttu-id="8d19c-187">La requête WQL suivante extrait les propriétés d'événement spécifiques pour tout événement qui se produit dans la base de données `AdventureWorks` et qui existe sous le groupe d'événements `DDL_DATABASE_LEVEL_EVENTS`.</span><span class="sxs-lookup"><span data-stu-id="8d19c-187">The following WQL query retrieves specific event properties for any event that occurs in the `AdventureWorks` database and exists under the `DDL_DATABASE_LEVEL_EVENTS` event group.</span></span>  
  
```  
SELECT SPID, SQLInstance, DatabaseName FROM DDL_DATABASE_LEVEL_EVENTS   
WHERE DatabaseName = 'AdventureWorks'   
```  
  
### <a name="c-querying-for-events-at-the-database-scope-filtering-by-schema-and-object"></a><span data-ttu-id="8d19c-188">C.</span><span class="sxs-lookup"><span data-stu-id="8d19c-188">C.</span></span> <span data-ttu-id="8d19c-189">Interrogation des événements dans l'étendue de la base de données, avec un filtre par schéma et par objet</span><span class="sxs-lookup"><span data-stu-id="8d19c-189">Querying for events at the database scope, filtering by schema and object</span></span>  
 <span data-ttu-id="8d19c-190">La requête suivante extrait toutes les propriétés d'événement pour tout événement `ALTER_TABLE` qui se produit sur la table `AdventureWorks.Sales.SalesOrderDetail`.</span><span class="sxs-lookup"><span data-stu-id="8d19c-190">The following query retrieves all event properties for any `ALTER_TABLE` event that occurs on table `AdventureWorks.Sales.SalesOrderDetail`.</span></span>  
  
```  
SELECT * FROM ALTER_TABLE   
WHERE DatabaseName = 'AdventureWorks' AND SchemaName = 'Sales'   
    AND ObjectType='Table' AND ObjectName = 'SalesOrderDetail'  
```  
  
## <a name="see-also"></a><span data-ttu-id="8d19c-191">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8d19c-191">See Also</span></span>  
 <span data-ttu-id="8d19c-192">[Fournisseur WMI pour les concepts des événements de serveur](https://technet.microsoft.com/library/ms180560.aspx) </span><span class="sxs-lookup"><span data-stu-id="8d19c-192">[WMI Provider for Server Events Concepts](https://technet.microsoft.com/library/ms180560.aspx) </span></span>  
 [<span data-ttu-id="8d19c-193">Notifications d'événements (moteur de base de données)</span><span class="sxs-lookup"><span data-stu-id="8d19c-193">Event Notifications (Database Engine)</span></span>](https://technet.microsoft.com/library/ms182602.aspx)  
  
  
