---
title: Option SORT_IN_TEMPDB pour les index | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- SORT_IN_TEMPDB option
- disk space [SQL Server], indexes
- space [SQL Server], indexes
- tempdb database [SQL Server], indexes
- indexes [SQL Server], tempdb database
- index creation [SQL Server], tempdb database
ms.assetid: 754a003f-fe51-4d10-975a-f6b8c04ebd35
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 8feccc5b1d29617193f481569e10648c6ed77242
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707532"
---
# <a name="sort_in_tempdb-option-for-indexes"></a><span data-ttu-id="ebefc-102">Option SORT_IN_TEMPDB pour les index</span><span class="sxs-lookup"><span data-stu-id="ebefc-102">SORT_IN_TEMPDB Option For Indexes</span></span>
  <span data-ttu-id="ebefc-103">Quand vous créez ou reconstruisez un index, vous pouvez, en affectant la valeur ON à l’option SORT_IN_TEMPDB, demander au [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] d’utiliser la base de données **tempdb** pour stocker les résultats de tri intermédiaires qui sont utilisés pour générer l’index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-103">When you create or rebuild an index, by setting the SORT_IN_TEMPDB option to ON you can direct the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to use **tempdb** to store the intermediate sort results that are used to build the index.</span></span> <span data-ttu-id="ebefc-104">Bien que cette option augmente la quantité d’espace disque temporaire utilisé pour la création d’un index, elle peut réduire le temps nécessaire à la création ou à la reconstruction d’un index lorsque la base de données **tempdb** ne se trouve pas sur le même ensemble de disques que la base de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ebefc-104">Although this option increases the amount of temporary disk space that is used to create an index, the option could reduce the time that is required to create or rebuild an index when **tempdb** is on a set of disks different from that of the user database.</span></span> <span data-ttu-id="ebefc-105">Pour plus d’informations sur **tempdb**, consultez [Configurer l’option de configuration Création d’index en mémoire](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span><span class="sxs-lookup"><span data-stu-id="ebefc-105">For more information about **tempdb**, see [Configure the index create memory Server Configuration Option](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md).</span></span>  
  
## <a name="phases-of-index-building"></a><span data-ttu-id="ebefc-106">Phases de la construction d'un index</span><span class="sxs-lookup"><span data-stu-id="ebefc-106">Phases of Index Building</span></span>  
 <span data-ttu-id="ebefc-107">La construction d'un index par le [!INCLUDE[ssDE](../../includes/ssde-md.md)] comprend les phases suivantes :</span><span class="sxs-lookup"><span data-stu-id="ebefc-107">As the [!INCLUDE[ssDE](../../includes/ssde-md.md)] builds an index, it goes through the following phases:</span></span>  
  
-   <span data-ttu-id="ebefc-108">Tout d'abord, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] analyse les pages de données de la table de base pour récupérer les valeurs des clés et construire une ligne d'index de niveau feuille pour chaque ligne de données.</span><span class="sxs-lookup"><span data-stu-id="ebefc-108">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] first scans the data pages of the base table to retrieve key values and builds an index leaf row for each data row.</span></span> <span data-ttu-id="ebefc-109">Lorsque les tampons de tri internes ont été remplis avec des entrées d'index de niveau feuille, les entrées sont triées et écrites sur le disque sous forme d'exécution triée intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="ebefc-109">When the internal sort buffers have been filled with leaf index entries, the entries are sorted and written to disk as an intermediate sort run.</span></span> <span data-ttu-id="ebefc-110">Le [!INCLUDE[ssDE](../../includes/ssde-md.md)] reprend ensuite l'analyse des pages de données jusqu'à ce que les tampons de tri soient de nouveau remplis.</span><span class="sxs-lookup"><span data-stu-id="ebefc-110">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] then resumes the data page scan until the sort buffers are again filled.</span></span> <span data-ttu-id="ebefc-111">Ce modèle d'analyse de plusieurs pages de données, suivi d'un tri et d'une écriture d'exécution triée, se poursuit jusqu'à ce que toutes les lignes de la table de base de données aient été traitées.</span><span class="sxs-lookup"><span data-stu-id="ebefc-111">This pattern of scanning multiple data pages followed by sorting and writing a sort run continues until all the rows of the base table have been processed.</span></span>  
  
     <span data-ttu-id="ebefc-112">Dans un index cluster, les lignes du niveau feuille de l'index sont les lignes de données de la table, c'est pourquoi les tris intermédiaires contiennent toutes les lignes de données.</span><span class="sxs-lookup"><span data-stu-id="ebefc-112">In a clustered index, the leaf rows of the index are the data rows of the table; therefore, the intermediate sort runs contain all the data rows.</span></span> <span data-ttu-id="ebefc-113">Dans un index non-cluster, les lignes de niveau feuille peuvent contenir des colonnes non-clés, mais sont généralement plus petites que dans un index cluster.</span><span class="sxs-lookup"><span data-stu-id="ebefc-113">In a nonclustered index, the leaf rows may contain nonkey columns, but are generally smaller than a clustered index.</span></span> <span data-ttu-id="ebefc-114">Si les clés d'index sont longues, ou si l'index contient plusieurs colonnes non-clés, un tri non-cluster peut retourner beaucoup de lignes.</span><span class="sxs-lookup"><span data-stu-id="ebefc-114">If the index keys are large, or there are several nonkey columns included in the index, a nonclustered sort run can be large.</span></span> <span data-ttu-id="ebefc-115">Pour plus d’informations sur l’inclusion de colonnes non-clés, consultez [Créer des index avec colonnes incluses](create-indexes-with-included-columns.md).</span><span class="sxs-lookup"><span data-stu-id="ebefc-115">For more information about including nonkey columns, see [Create Indexes with Included Columns](create-indexes-with-included-columns.md).</span></span>  
  
-   <span data-ttu-id="ebefc-116">Le [!INCLUDE[ssDE](../../includes/ssde-md.md)] fusionne les tris des lignes du niveau feuille de l'index en un flux unique trié.</span><span class="sxs-lookup"><span data-stu-id="ebefc-116">The [!INCLUDE[ssDE](../../includes/ssde-md.md)] merges the sorted runs of index leaf rows into a single, sorted stream.</span></span> <span data-ttu-id="ebefc-117">Le composant de fusion et tri du [!INCLUDE[ssDE](../../includes/ssde-md.md)] commence par la première page de chaque tri, recherche la clé la plus faible dans toutes les pages et passe cette ligne feuille au composant de création d'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-117">The sort merge component of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] starts with the first page of each sort run, finds the lowest key in all the pages, and passes that leaf row to the index create component.</span></span> <span data-ttu-id="ebefc-118">La clé la plus faible suivante est ensuite traitée, puis la suivante et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="ebefc-118">The next lowest key is processed, and then the next, and so on.</span></span> <span data-ttu-id="ebefc-119">Lorsque la dernière ligne feuille de l'index est extraite d'une page d'exécution triée, le processus passe à la page suivante à partir de cette exécution triée.</span><span class="sxs-lookup"><span data-stu-id="ebefc-119">When the last leaf index row is extracted from a sort run page, the process shifts to the next page from that sort run.</span></span> <span data-ttu-id="ebefc-120">Lorsque toutes les pages d'une extension à exécution triée ont été traitées, l'extension est libérée.</span><span class="sxs-lookup"><span data-stu-id="ebefc-120">When all the pages in a sort run extent have been processed, the extent is freed.</span></span> <span data-ttu-id="ebefc-121">Lorsque chaque ligne feuille de l'index est passée au composant de création d'index, elle est placée dans une page feuille de l'index dans le tampon.</span><span class="sxs-lookup"><span data-stu-id="ebefc-121">As each leaf index row is passed to the index create component, it is included in a leaf index page in the buffer.</span></span> <span data-ttu-id="ebefc-122">Chaque page feuille est écrite au moment de son remplissage.</span><span class="sxs-lookup"><span data-stu-id="ebefc-122">Each leaf page is written as it is filled.</span></span> <span data-ttu-id="ebefc-123">Lors de l'écriture des pages de niveau feuille, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] construit également les niveaux supérieurs de l'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-123">As leaf pages are written, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] also builds the upper levels of the index.</span></span> <span data-ttu-id="ebefc-124">Chaque page d'index de niveau supérieur est écrite lorsqu'elle est remplie.</span><span class="sxs-lookup"><span data-stu-id="ebefc-124">Each upper level index page is written when it is filled.</span></span>  
  
## <a name="sort_in_tempdb-option"></a><span data-ttu-id="ebefc-125">option SORT_IN_TEMPDB</span><span class="sxs-lookup"><span data-stu-id="ebefc-125">SORT_IN_TEMPDB Option</span></span>  
 <span data-ttu-id="ebefc-126">Lorsque l'option SORT_IN_TEMPDB est désactivée, ce qui constitue l'option par défaut, les tris sont stockés dans le groupe de fichiers de destination.</span><span class="sxs-lookup"><span data-stu-id="ebefc-126">When SORT_IN_TEMPDB is set to OFF, the default, the sort runs are stored in the destination filegroup.</span></span> <span data-ttu-id="ebefc-127">Pendant la première phase de création de l'index, les lectures des pages de la table de base et les écritures des exécutions triées déplacent les têtes de lecture-écriture du disque d'une zone du disque à l'autre.</span><span class="sxs-lookup"><span data-stu-id="ebefc-127">During the first phase of creating the index, the alternating reads of the base table pages and writes of the sort runs move the disk read/write heads from one area of the disk to another.</span></span> <span data-ttu-id="ebefc-128">Les têtes se trouvent dans la zone de la page de données lors de l'analyse des pages de données.</span><span class="sxs-lookup"><span data-stu-id="ebefc-128">The heads are in the data page area as the data pages are scanned.</span></span> <span data-ttu-id="ebefc-129">Elles passent dans une zone d'espace libre lorsque les tampons de tri se remplissent et que le tri en cours doit être écrit sur le disque, puis reviennent sur la zone de la page de données lorsque l'analyse des pages de la table reprend.</span><span class="sxs-lookup"><span data-stu-id="ebefc-129">They move to an area of free space when the sort buffers fill and the current sort run has to be written to disk, and then move back to the data page area as the table page scan is resumed.</span></span> <span data-ttu-id="ebefc-130">Le mouvement de la tête de lecture-écriture est plus important dans la deuxième phase.</span><span class="sxs-lookup"><span data-stu-id="ebefc-130">The read/write head movement is greater in the second phase.</span></span> <span data-ttu-id="ebefc-131">À ce stade, le processus de tri alterne généralement les lectures de chaque zone d'exécution triée.</span><span class="sxs-lookup"><span data-stu-id="ebefc-131">At that time the sort process is typically alternating reads from each sort run area.</span></span> <span data-ttu-id="ebefc-132">Les exécutions triées et les nouvelles pages d'index sont construites dans le groupe de fichiers de destination.</span><span class="sxs-lookup"><span data-stu-id="ebefc-132">Both the sort runs and the new index pages are built in the destination filegroup.</span></span> <span data-ttu-id="ebefc-133">Ainsi, lorsque le [!INCLUDE[ssDE](../../includes/ssde-md.md)] répartit les lectures entre les différents tris, il doit en même temps accéder périodiquement aux extensions d'index pour écrire les nouvelles pages d'index à mesure qu'elles sont remplies.</span><span class="sxs-lookup"><span data-stu-id="ebefc-133">This means that at the same time the [!INCLUDE[ssDE](../../includes/ssde-md.md)] is spreading reads across the sort runs, it has to periodically jump to the index extents to write new index pages as they are filled.</span></span>  
  
 <span data-ttu-id="ebefc-134">Si l’option SORT_IN_TEMPDB est activée et que **tempdb** ne se trouve pas dans le même ensemble de disques que le groupe de fichiers de destination, les lectures des pages de données pendant la première phase ne sont pas effectuées sur le même disque que les écritures dans la zone de travail de tri dans **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="ebefc-134">If the SORT_IN_TEMPDB option is set to ON and **tempdb** is on a separate set of disks from the destination filegroup, during the first phase, the reads of the data pages occur on a different disk from the writes to the sort work area in **tempdb**.</span></span> <span data-ttu-id="ebefc-135">Cela signifie que les lectures des clés de données se poursuivent davantage en série sur le disque, tout comme les écritures sur le disque **tempdb** et les écritures qui construisent l’index final.</span><span class="sxs-lookup"><span data-stu-id="ebefc-135">This means the disk reads of the data keys generally continue more serially across the disk, and the writes to the **tempdb** disk also are generally serial, as do the writes to build the final index.</span></span> <span data-ttu-id="ebefc-136">Même si d'autres utilisateurs utilisent la base de données et accèdent à des adresses de disque séparées, le modèle global de lecture et d'écriture est plus efficace lorsque SORT_IN_TEMPDB est spécifié que lorsqu'il ne l'est pas.</span><span class="sxs-lookup"><span data-stu-id="ebefc-136">Even if other users are using the database and accessing separate disk addresses, the overall pattern of reads and writes are more efficient when SORT_IN_TEMPDB is specified than when it is not.</span></span>  
  
 <span data-ttu-id="ebefc-137">L'option SORT_IN_TEMPDB peut améliorer la contiguïté des extensions d'index, surtout si l'opération CREATE INDEX n'est pas traitée en parallèle.</span><span class="sxs-lookup"><span data-stu-id="ebefc-137">The SORT_IN_TEMPDB option may improve the contiguity of index extents, especially if the CREATE INDEX operation is not being processed in parallel.</span></span> <span data-ttu-id="ebefc-138">Les extensions de la zone de travail de tri sont libérées de façon quelque peu aléatoire par rapport à leur emplacement dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="ebefc-138">The sort work area extents are freed on a somewhat random basis with regard to their location in the database.</span></span> <span data-ttu-id="ebefc-139">Si les zones de travail de tri sont contenues dans le groupe de fichiers de destination, les extensions qui se libèrent peuvent être acquises par les demandes d'extensions pour le stockage de la structure de l'index pendant sa construction.</span><span class="sxs-lookup"><span data-stu-id="ebefc-139">If the sort work areas are contained in the destination filegroup, as the sort work extents are freed, they can be acquired by the requests for extents to hold the index structure as it is built.</span></span> <span data-ttu-id="ebefc-140">Ceci peut rendre les emplacements des extensions d'index aléatoires jusqu'à un certain point.</span><span class="sxs-lookup"><span data-stu-id="ebefc-140">This can randomize the locations of the index extents to a degree.</span></span> <span data-ttu-id="ebefc-141">Si les extensions de tri sont contenues séparément dans **tempdb**, la séquence selon laquelle elles sont libérées n’a aucune incidence sur l’emplacement des extensions d’index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-141">If the sort extents are held separately in **tempdb**, the sequence in which they are freed has no effect on the location of the index extents.</span></span> <span data-ttu-id="ebefc-142">En outre, lorsque les tris intermédiaires sont stockés dans **tempdb** et pas dans le groupe de fichiers de destination, l’espace disponible dans ce dernier est plus important.</span><span class="sxs-lookup"><span data-stu-id="ebefc-142">Also, when the intermediate sort runs are stored in **tempdb** instead of the destination filegroup, there is more space available in the destination filegroup.</span></span> <span data-ttu-id="ebefc-143">Cela augmente les chances de contiguïté des extensions d'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-143">This increases the chances that index extents will be contiguous.</span></span>  
  
 <span data-ttu-id="ebefc-144">L'option SORT_IN_TEMPDB affecte uniquement l'instruction en cours.</span><span class="sxs-lookup"><span data-stu-id="ebefc-144">The SORT_IN_TEMPDB option affects only the current statement.</span></span> <span data-ttu-id="ebefc-145">Aucune métadonnée n’enregistre le fait que l’index a ou n’a pas été trié dans **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="ebefc-145">No metadata records that the index was or was not sorted in **tempdb**.</span></span> <span data-ttu-id="ebefc-146">Par exemple, si vous créez un index non-cluster avec l'option SORT_IN_TEMPDB et que, par la suite, vous créez un index cluster sans cette option, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] n'utilise pas l'option lorsqu'il recrée l'index cluster.</span><span class="sxs-lookup"><span data-stu-id="ebefc-146">For example, if you create a nonclustered index using the SORT_IN_TEMPDB option, and at a later time create a clustered index without specifying the option, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] does not use the option when it re-creates the nonclustered index.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="ebefc-147">Si l'opération de tri n'est pas nécessaire ou peut avoir lieu dans la mémoire, l'option SORT_IN_TEMPDB est ignorée.</span><span class="sxs-lookup"><span data-stu-id="ebefc-147">If a sort operation is not required or if the sort can be performed in memory, the SORT_IN_TEMPDB option is ignored.</span></span>  
  
## <a name="disk-space-requirements"></a><span data-ttu-id="ebefc-148">Espace disque nécessaire</span><span class="sxs-lookup"><span data-stu-id="ebefc-148">Disk Space Requirements</span></span>  
 <span data-ttu-id="ebefc-149">Lorsque l’option SORT_IN_TEMPDB est activée, vous devez avoir suffisamment d’espace libre dans **tempdb** pour contenir les tris intermédiaires, et suffisamment d’espace libre dans le groupe de fichiers de destination pour contenir le nouvel index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-149">When you set the SORT_IN_TEMPDB option to ON, you must have sufficient free disk space available in **tempdb** to hold the intermediate sort runs, and enough free disk space in the destination filegroup to hold the new index.</span></span> <span data-ttu-id="ebefc-150">L'instruction CREATE INDEX échoue s'il n'y a pas suffisamment d'espace libre et si, pour une raison quelconque, les bases de données ne peuvent pas croître automatiquement pour acquérir plus d'espace (notamment s'il n'y a pas d'espace sur le disque ou si la fonction de croissance automatique est désactivée).</span><span class="sxs-lookup"><span data-stu-id="ebefc-150">The CREATE INDEX statement fails if there is insufficient free space and there is some reason the databases cannot autogrow to acquire more space, such as no space on the disk or autogrow is set to off.</span></span>  
  
 <span data-ttu-id="ebefc-151">Si l'option SORT_IN_TEMPDB n'est pas activée, l'espace libre disponible dans le groupe de fichiers de destination doit correspondre environ à la taille de l'index final.</span><span class="sxs-lookup"><span data-stu-id="ebefc-151">If SORT_IN_TEMPDB is set to OFF, the available free disk space in the destination filegroup must be roughly the size of the final index.</span></span> <span data-ttu-id="ebefc-152">Pendant la première phase, les exécutions triées sont construites et nécessitent environ la même quantité d'espace que l'index final.</span><span class="sxs-lookup"><span data-stu-id="ebefc-152">During the first phase, the sort runs are built and require about the same amount of space as the final index.</span></span> <span data-ttu-id="ebefc-153">Pendant la deuxième phase, chaque extension comportant une exécution triée est libérée après avoir été traitée.</span><span class="sxs-lookup"><span data-stu-id="ebefc-153">During the second phase, each sort run extent is freed after it has been processed.</span></span> <span data-ttu-id="ebefc-154">Cela signifie que les extensions de tri sont libérées à peu près à la même vitesse que des extensions sont acquises pour le stockage des pages de l'index final et, de ce fait, l'espace nécessaire global ne dépasse pas beaucoup la taille de l'index final.</span><span class="sxs-lookup"><span data-stu-id="ebefc-154">This means that sort run extents are freed at about the same rate at which extents are acquired to hold the final index pages; therefore, the overall space requirements do not greatly exceed the size of the final index.</span></span> <span data-ttu-id="ebefc-155">Ceci présente toutefois l'inconvénient suivant : si la quantité d'espace libre est très proche de la taille de l'index final, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] tend à réutiliser les extensions de tri très rapidement après leur libération.</span><span class="sxs-lookup"><span data-stu-id="ebefc-155">One side effect of this is that if the amount of free space is very close to the size of the final index, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] will generally reuse the sort run extents very quickly after they are freed.</span></span> <span data-ttu-id="ebefc-156">Puisque ces dernières sont libérées d'une façon quelque peu aléatoire, la continuité des extensions d'index dans ce scénario est réduite.</span><span class="sxs-lookup"><span data-stu-id="ebefc-156">Because the sort run extents are freed in a somewhat random manner, this reduces the continuity of the index extents in this scenario.</span></span> <span data-ttu-id="ebefc-157">Lorsque l'option SORT_IN_TEMPDB est désactivée, la continuité des extensions d'index est améliorée s'il y a, dans le groupe de fichiers de destination, suffisamment d'espace libre pour permettre l'allocation des extensions d'index à partir d'un pool contigu et non à partir des extensions de tri qui viennent d'être libérées.</span><span class="sxs-lookup"><span data-stu-id="ebefc-157">If SORT_IN_TEMPDB is set to OFF, the continuity of the index extents is improved if there is sufficient free space available in the destination filegroup that the index extents can be allocated from a contiguous pool instead of from the freshly deallocated sort run extents.</span></span>  
  
 <span data-ttu-id="ebefc-158">Lorsque vous créez un index non-cluster, vous devez respecter les règles suivantes en matière d'espace libre :</span><span class="sxs-lookup"><span data-stu-id="ebefc-158">When you create a nonclustered index, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="ebefc-159">Si l’option SORT_IN_TEMPDB est activée, il doit y avoir suffisamment d’espace libre dans **tempdb** pour stocker les tris, et suffisamment d’espace dans le groupe de fichiers de destination pour stocker la structure finale de l’index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-159">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs, and sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="ebefc-160">Les exécutions triées contiennent les lignes feuilles de l'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-160">The sort runs contain the leaf rows of the index.</span></span>  
  
-   <span data-ttu-id="ebefc-161">Si l'option SORT_IN_TEMPDB n'est pas activée, l'espace libre dans le groupe de fichiers de destination doit être suffisamment grand pour stocker la structure finale de l'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-161">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final index structure.</span></span> <span data-ttu-id="ebefc-162">La continuité des extensions d'index peut être améliorée lorsque l'espace libre est important.</span><span class="sxs-lookup"><span data-stu-id="ebefc-162">The continuity of the index extends may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="ebefc-163">Lorsque vous créez un index cluster sur une table qui n'a pas d'index non-cluster, vous devez respecter les règles suivantes en matière d'espace libre :</span><span class="sxs-lookup"><span data-stu-id="ebefc-163">When you create a clustered index on a table that does not have nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="ebefc-164">Si l’option SORT_IN_TEMPDB est activée, il doit y avoir suffisamment d’espace libre dans **tempdb** pour stocker les tris.</span><span class="sxs-lookup"><span data-stu-id="ebefc-164">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the sort runs.</span></span> <span data-ttu-id="ebefc-165">Ceux-ci comprennent les lignes de données de la table.</span><span class="sxs-lookup"><span data-stu-id="ebefc-165">These include the data rows of the table.</span></span> <span data-ttu-id="ebefc-166">Il doit y avoir suffisamment d'espace libre dans le groupe de fichiers de destination pour stocker la structure de l'index final.</span><span class="sxs-lookup"><span data-stu-id="ebefc-166">There must be sufficient free space in the destination filegroup to store the final index structure.</span></span> <span data-ttu-id="ebefc-167">Ceci comprend les lignes de données de la table et l'arborescence binaire de l'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-167">This includes the data rows of the table and the index B-tree.</span></span> <span data-ttu-id="ebefc-168">Il se peut que vous deviez ajuster l'estimation en fonction de facteurs tels que le fait d'avoir une taille de clé élevée ou un faible taux de remplissage.</span><span class="sxs-lookup"><span data-stu-id="ebefc-168">You may have to adjust the estimate for factors such as having a large key size or a fill factor with a low value.</span></span>  
  
-   <span data-ttu-id="ebefc-169">Si l'option SORT_IN_TEMPDB n'est pas activée, l'espace libre dans le groupe de fichiers de destination doit être suffisamment grand pour stocker la table finale.</span><span class="sxs-lookup"><span data-stu-id="ebefc-169">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="ebefc-170">Ceci comprend la structure de l'index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-170">This includes the index structure.</span></span> <span data-ttu-id="ebefc-171">La continuité de la table et des extensions d'index peut être améliorée si l'espace libre disponible est plus important.</span><span class="sxs-lookup"><span data-stu-id="ebefc-171">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
 <span data-ttu-id="ebefc-172">Lorsque vous créez un index cluster sur une table qui a des index non-cluster, vous devez respecter les règles suivantes en matière d'espace libre :</span><span class="sxs-lookup"><span data-stu-id="ebefc-172">When you create a clustered index on a table that has nonclustered indexes, you must have available as free space:</span></span>  
  
-   <span data-ttu-id="ebefc-173">Si l’option SORT_IN_TEMPDB est activée, il doit y avoir suffisamment d’espace libre dans **tempdb** pour stocker la collection de tris pour le plus grand index, généralement l’index cluster, et suffisamment d’espace dans le groupe de fichiers de destination pour stocker les structures finales de tous les index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-173">If SORT_IN_TEMPDB is set to ON, there must be sufficient free space in **tempdb** to store the collection of sort runs for the largest index, typically the clustered index, and sufficient free space in the destination filegroup to store the final structures of all the indexes.</span></span> <span data-ttu-id="ebefc-174">Ceci comprend l'index cluster qui contient les lignes de données de la table.</span><span class="sxs-lookup"><span data-stu-id="ebefc-174">This includes the clustered index that contains the data rows of the table.</span></span>  
  
-   <span data-ttu-id="ebefc-175">Si l'option SORT_IN_TEMPDB n'est pas activée, l'espace libre dans le groupe de fichiers de destination doit être suffisamment grand pour stocker la table finale.</span><span class="sxs-lookup"><span data-stu-id="ebefc-175">If SORT_IN_TEMPDB is set to OFF, the free space in the destination filegroup must be large enough to store the final table.</span></span> <span data-ttu-id="ebefc-176">Ceci comprend les structures de tous les index.</span><span class="sxs-lookup"><span data-stu-id="ebefc-176">This includes the structures of all the indexes.</span></span> <span data-ttu-id="ebefc-177">La continuité de la table et des extensions d'index peut être améliorée si l'espace libre disponible est plus important.</span><span class="sxs-lookup"><span data-stu-id="ebefc-177">The continuity of the table and index extents may be improved if more free space is available.</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="ebefc-178">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="ebefc-178">Related Tasks</span></span>  
 [<span data-ttu-id="ebefc-179">CREATE INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="ebefc-179">CREATE INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/create-index-transact-sql)  
  
 [<span data-ttu-id="ebefc-180">Réorganiser et reconstruire des index</span><span class="sxs-lookup"><span data-stu-id="ebefc-180">Reorganize and Rebuild Indexes</span></span>](indexes.md)  
  
## <a name="related-content"></a><span data-ttu-id="ebefc-181">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="ebefc-181">Related Content</span></span>  
 [<span data-ttu-id="ebefc-182">ALTER INDEX &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="ebefc-182">ALTER INDEX &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/alter-index-transact-sql)  
  
 [<span data-ttu-id="ebefc-183">Configurer l’option de configuration Création d’index en mémoire.</span><span class="sxs-lookup"><span data-stu-id="ebefc-183">Configure the index create memory Server Configuration Option</span></span>](../../database-engine/configure-windows/configure-the-index-create-memory-server-configuration-option.md)  
  
 [<span data-ttu-id="ebefc-184">Espace disque nécessaire pour les opérations DDL d’index</span><span class="sxs-lookup"><span data-stu-id="ebefc-184">Disk Space Requirements for Index DDL Operations</span></span>](disk-space-requirements-for-index-ddl-operations.md)  
  
  
