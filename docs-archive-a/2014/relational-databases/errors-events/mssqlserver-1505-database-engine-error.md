---
title: MSSQLSERVER_1505 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- 1505 (Database Engine error)
ms.assetid: ef4df75d-0f36-4c8b-b36c-e427f65f91ca
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 74c152404cf2d3710bbe98b29da7a96d86f58859
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698279"
---
# <a name="mssqlserver_1505"></a><span data-ttu-id="8716c-102">MSSQLSERVER_1505</span><span class="sxs-lookup"><span data-stu-id="8716c-102">MSSQLSERVER_1505</span></span>
    
## <a name="details"></a><span data-ttu-id="8716c-103">Détails</span><span class="sxs-lookup"><span data-stu-id="8716c-103">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="8716c-104">Nom du produit</span><span class="sxs-lookup"><span data-stu-id="8716c-104">Product Name</span></span>|<span data-ttu-id="8716c-105">SQL Server</span><span class="sxs-lookup"><span data-stu-id="8716c-105">SQL Server</span></span>|  
|<span data-ttu-id="8716c-106">ID de l’événement</span><span class="sxs-lookup"><span data-stu-id="8716c-106">Event ID</span></span>|<span data-ttu-id="8716c-107">1505</span><span class="sxs-lookup"><span data-stu-id="8716c-107">1505</span></span>|  
|<span data-ttu-id="8716c-108">Source de l’événement</span><span class="sxs-lookup"><span data-stu-id="8716c-108">Event Source</span></span>|<span data-ttu-id="8716c-109">MSSQLSERVER</span><span class="sxs-lookup"><span data-stu-id="8716c-109">MSSQLSERVER</span></span>|  
|<span data-ttu-id="8716c-110">Composant</span><span class="sxs-lookup"><span data-stu-id="8716c-110">Component</span></span>|<span data-ttu-id="8716c-111">SQLEngine</span><span class="sxs-lookup"><span data-stu-id="8716c-111">SQLEngine</span></span>|  
|<span data-ttu-id="8716c-112">Nom symbolique</span><span class="sxs-lookup"><span data-stu-id="8716c-112">Symbolic Name</span></span>|<span data-ttu-id="8716c-113">DUP_KEY</span><span class="sxs-lookup"><span data-stu-id="8716c-113">DUP_KEY</span></span>|  
|<span data-ttu-id="8716c-114">Texte du message</span><span class="sxs-lookup"><span data-stu-id="8716c-114">Message Text</span></span>|<span data-ttu-id="8716c-115">L’instruction CREATE UNIQUE INDEX a été interrompue, car une clé dupliquée a été trouvée pour l’objet '%.\*ls' et l’index '%.\*ls'.</span><span class="sxs-lookup"><span data-stu-id="8716c-115">CREATE UNIQUE INDEX terminated because a duplicate key was found for object name '%.\*ls' and index name '%.\*ls'.</span></span>  <span data-ttu-id="8716c-116">Valeur de clé dupliquée : %ls.</span><span class="sxs-lookup"><span data-stu-id="8716c-116">The duplicate key value is %ls.</span></span>|  
  
## <a name="explanation"></a><span data-ttu-id="8716c-117">Explication</span><span class="sxs-lookup"><span data-stu-id="8716c-117">Explanation</span></span>  
 <span data-ttu-id="8716c-118">Cette erreur se produit lorsque vous essayez de créer un index unique et que plusieurs lignes de la table contiennent la valeur dupliquée spécifiée.</span><span class="sxs-lookup"><span data-stu-id="8716c-118">This error occurs when you attempt to create a unique index and more than one row in the table contains the specified duplicate value.</span></span> <span data-ttu-id="8716c-119">Un index unique est créé lorsque vous créez un index et spécifiez le mot clé UNIQUE ou lorsque vous créez une contrainte UNIQUE.</span><span class="sxs-lookup"><span data-stu-id="8716c-119">A unique index is created when you create an index and specify the UNIQUE keyword, or when you create a UNIQUE constraint.</span></span> <span data-ttu-id="8716c-120">La table ne peut pas contenir de lignes qui présentent des valeurs dupliquées dans les colonnes définies dans l'index ou la contrainte.</span><span class="sxs-lookup"><span data-stu-id="8716c-120">The table cannot contain any rows that have duplicate values in the columns defined in the index or constraint.</span></span>  
  
 <span data-ttu-id="8716c-121">Considérez les données de la table **Employee** suivante :</span><span class="sxs-lookup"><span data-stu-id="8716c-121">Consider the data in the following **Employee** table:</span></span>  
  
|<span data-ttu-id="8716c-122">LastName</span><span class="sxs-lookup"><span data-stu-id="8716c-122">LastName</span></span>|<span data-ttu-id="8716c-123">FirstName</span><span class="sxs-lookup"><span data-stu-id="8716c-123">FirstName</span></span>|<span data-ttu-id="8716c-124">JobTitle</span><span class="sxs-lookup"><span data-stu-id="8716c-124">JobTitle</span></span>|<span data-ttu-id="8716c-125">HireDate</span><span class="sxs-lookup"><span data-stu-id="8716c-125">HireDate</span></span>|  
|--------------|---------------|--------------|--------------|  
|<span data-ttu-id="8716c-126">Walters</span><span class="sxs-lookup"><span data-stu-id="8716c-126">Walters</span></span>|<span data-ttu-id="8716c-127">Rob</span><span class="sxs-lookup"><span data-stu-id="8716c-127">Rob</span></span>|<span data-ttu-id="8716c-128">Senior Tool Designer</span><span class="sxs-lookup"><span data-stu-id="8716c-128">Senior Tool Designer</span></span>|<span data-ttu-id="8716c-129">2004-11-19</span><span class="sxs-lookup"><span data-stu-id="8716c-129">2004-11-19</span></span>|  
|<span data-ttu-id="8716c-130">Brown</span><span class="sxs-lookup"><span data-stu-id="8716c-130">Brown</span></span>|<span data-ttu-id="8716c-131">Kevin</span><span class="sxs-lookup"><span data-stu-id="8716c-131">Kevin</span></span>|<span data-ttu-id="8716c-132">Marketing Assistant</span><span class="sxs-lookup"><span data-stu-id="8716c-132">Marketing Assistant</span></span>|<span data-ttu-id="8716c-133">NULL</span><span class="sxs-lookup"><span data-stu-id="8716c-133">NULL</span></span>|  
|<span data-ttu-id="8716c-134">Brown</span><span class="sxs-lookup"><span data-stu-id="8716c-134">Brown</span></span>|<span data-ttu-id="8716c-135">Jo</span><span class="sxs-lookup"><span data-stu-id="8716c-135">Jo</span></span>|<span data-ttu-id="8716c-136">Design Engineer</span><span class="sxs-lookup"><span data-stu-id="8716c-136">Design Engineer</span></span>|<span data-ttu-id="8716c-137">NULL</span><span class="sxs-lookup"><span data-stu-id="8716c-137">NULL</span></span>|  
|<span data-ttu-id="8716c-138">Walters</span><span class="sxs-lookup"><span data-stu-id="8716c-138">Walters</span></span>|<span data-ttu-id="8716c-139">Rob</span><span class="sxs-lookup"><span data-stu-id="8716c-139">Rob</span></span>|<span data-ttu-id="8716c-140">Tool Designer</span><span class="sxs-lookup"><span data-stu-id="8716c-140">Tool Designer</span></span>|<span data-ttu-id="8716c-141">2001-08-09</span><span class="sxs-lookup"><span data-stu-id="8716c-141">2001-08-09</span></span>|  
  
 <span data-ttu-id="8716c-142">Un index unique ne peut pas être créé sur les combinaisons de colonnes **LastName** ou **LastName** et **FirstName** en raison de la présence de valeurs dupliquées dans les lignes.</span><span class="sxs-lookup"><span data-stu-id="8716c-142">A unique index can not be created on the column combinations **LastName** or **LastName**, **FirstName** because of duplicate values in the rows.</span></span>  
  
 <span data-ttu-id="8716c-143">La possibilité de violation d’unicité dans la colonne **HireDate** est moins évidente.</span><span class="sxs-lookup"><span data-stu-id="8716c-143">Less obvious is the potential for a uniqueness violation in the **HireDate** column.</span></span> <span data-ttu-id="8716c-144">À des fins d'indexation, les valeurs NULL sont comparées sur un pied d'égalité.</span><span class="sxs-lookup"><span data-stu-id="8716c-144">For indexing purposes, NULL values compare as equal.</span></span> <span data-ttu-id="8716c-145">Il est par conséquent impossible de créer un index ou une contrainte unique lorsque les valeurs de clés sont des valeurs NULL dans plusieurs lignes.</span><span class="sxs-lookup"><span data-stu-id="8716c-145">Therefore, you cannot create a unique index or constraint if the key values are NULL in more than one row.</span></span> <span data-ttu-id="8716c-146">Sur la base des informations fournies ci-dessus, un index unique ne peut pas être créé sur les combinaisons de colonnes **HireDate** ou **LastName** et **HireDate**.</span><span class="sxs-lookup"><span data-stu-id="8716c-146">Given the data above, a unique index cannot be created on the column combinations **HireDate** or **LastName**, **HireDate**.</span></span>  
  
 <span data-ttu-id="8716c-147">Le message d'erreur 1505 retourne la première ligne qui enfreint la contrainte d'unicité.</span><span class="sxs-lookup"><span data-stu-id="8716c-147">Error message 1505 returns the first row that violates the uniqueness constraint.</span></span> <span data-ttu-id="8716c-148">La table peut contenir d'autres lignes dupliquées.</span><span class="sxs-lookup"><span data-stu-id="8716c-148">There may be other duplicate rows in the table.</span></span> <span data-ttu-id="8716c-149">Pour les trouver toutes, interrogez la table spécifiée et utilisez les clauses GROUP BY et HAVING pour signaler les lignes dupliquées.</span><span class="sxs-lookup"><span data-stu-id="8716c-149">To find all duplicate rows, query the specified table and use the GROUP BY and HAVING clauses to report the duplicate rows.</span></span> <span data-ttu-id="8716c-150">Par exemple, la requête suivante retourne les lignes de la table **Employee** qui présentent des noms (LastName) et prénoms (FirstName) en double.</span><span class="sxs-lookup"><span data-stu-id="8716c-150">For example, the following query returns the rows in the **Employee** table that have duplicate first and last names.</span></span>  
  
 <span data-ttu-id="8716c-151">Sélectionnez LastName, FirstName, Count ( \* ) dans dbo. Employee GROUP BY LastName, FirstName ayant Count ( \* ) > 1 ;</span><span class="sxs-lookup"><span data-stu-id="8716c-151">SELECT LastName, FirstName, count(\*) FROM dbo.Employee GROUP BY LastName, FirstName HAVING count(\*) > 1;</span></span>  
  
## <a name="user-action"></a><span data-ttu-id="8716c-152">Action de l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="8716c-152">User Action</span></span>  
 <span data-ttu-id="8716c-153">Réfléchissez aux solutions ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="8716c-153">Consider the following solutions.</span></span>  
  
-   <span data-ttu-id="8716c-154">Ajoutez ou supprimez des colonnes de la définition de l'index ou de la contrainte afin de créer un composite unique.</span><span class="sxs-lookup"><span data-stu-id="8716c-154">Add or remove columns in the index or constraint definition to create a unique composite.</span></span> <span data-ttu-id="8716c-155">Dans l’exemple précédent, l’ajout d’une colonne **MiddleName** à la définition de l’index ou de la contrainte pourrait résoudre le problème des valeurs dupliquées.</span><span class="sxs-lookup"><span data-stu-id="8716c-155">In the previous example, adding a **MiddleName** column to the index or constraint definition might resolve the duplication problem.</span></span>  
  
-   <span data-ttu-id="8716c-156">Lors de la sélection des colonnes d'un index unique ou d'une contrainte unique, sélectionnez donc les colonnes qui n'acceptent pas par définition les valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="8716c-156">Select columns that are defined as NOT NULL when you choose columns for a unique index or constraint.</span></span> <span data-ttu-id="8716c-157">La possibilité d'une violation d'unicité provoquée lorsque plusieurs lignes contiennent NULL dans les valeurs de clés est ainsi écartée.</span><span class="sxs-lookup"><span data-stu-id="8716c-157">This eliminates the possibility of a uniqueness violation caused when more than one row contains NULL in the key values.</span></span>  
  
-   <span data-ttu-id="8716c-158">Lorsque les valeurs dupliquées sont issues d'erreurs de saisie des données, corrigez manuellement les données, puis créez l'index ou la contrainte.</span><span class="sxs-lookup"><span data-stu-id="8716c-158">If the duplicate values are the result of data entry errors, manually correct the data and then create the index or constraint.</span></span> <span data-ttu-id="8716c-159">Pour plus d’informations sur la suppression de lignes en double d’une table, consultez l’article 139444 de la Base de connaissances : [Comment faire pour supprimer des lignes en double d’une table dans SQL Server](https://support.microsoft.com/kb/139444).</span><span class="sxs-lookup"><span data-stu-id="8716c-159">For information about removing duplicate rows in a table, see Knowledge Base article 139444: [How to remove duplicate rows from a table in SQL Server](https://support.microsoft.com/kb/139444).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8716c-160">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8716c-160">See Also</span></span>  
 <span data-ttu-id="8716c-161">[CREATE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-index-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="8716c-161">[CREATE INDEX &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-index-transact-sql) </span></span>  
 <span data-ttu-id="8716c-162">[Créer des index uniques](../indexes/indexes.md) </span><span class="sxs-lookup"><span data-stu-id="8716c-162">[Create Unique Indexes](../indexes/indexes.md) </span></span>  
 [<span data-ttu-id="8716c-163">Créer des contraintes uniques</span><span class="sxs-lookup"><span data-stu-id="8716c-163">Create Unique Constraints</span></span>](../tables/create-unique-constraints.md)  
  
  
