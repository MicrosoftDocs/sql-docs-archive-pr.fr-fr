---
title: Planifier et exécuter des séquences de restauration (mode de récupération complète) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
helpviewer_keywords:
- restore sequences [SQL Server], planning for
- full recovery model [SQL Server], planning restore sequences
ms.assetid: 9cbefaf8-d2b6-41c9-83fc-b3807a841fe2
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 85558c0a6361837b5645b9fc38ad040254265d72
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612432"
---
# <a name="plan-and-perform-restore-sequences-full-recovery-model"></a><span data-ttu-id="37b43-102">Planifier et exécuter des séquences de restauration (mode de récupération complète)</span><span class="sxs-lookup"><span data-stu-id="37b43-102">Plan and Perform Restore Sequences (Full Recovery Model)</span></span>
  <span data-ttu-id="37b43-103">Cette rubrique explique comment planifier et effectuer une séquence de restauration pour les bases de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] qui utilisent habituellement le mode de restauration complète.</span><span class="sxs-lookup"><span data-stu-id="37b43-103">This topic explains how to plan and perform a restore sequence for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] databases that ordinarily uses the full recovery model.</span></span> <span data-ttu-id="37b43-104">Une *séquence de restauration* est une séquence contenant une ou plusieurs instructions [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="37b43-104">A *restore sequence* is a sequence of one or more [RESTORE](/sql/t-sql/statements/restore-statements-transact-sql) statements.</span></span> <span data-ttu-id="37b43-105">En règle générale, une séquence de restauration initialise le contenu de la base de données, des fichiers et/ou des pages en cours de restauration (phase de copie des données), restaure les transactions journalisées (phase de restauration par progression) et annule les transactions non validées (phase de restauration).</span><span class="sxs-lookup"><span data-stu-id="37b43-105">Typically, a restore sequences initializes the contents of the database, files, and/or pages being restored (the data-copy phase), rolls forward logged transactions (the redo phase), and rolls back uncommitted transactions (the undo phase).</span></span>  
  
 <span data-ttu-id="37b43-106">Dans les cas simples, une séquence de restauration nécessite uniquement une sauvegarde complète de base de données, une sauvegarde différentielle de base de données et les sauvegardes du journal réalisées ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="37b43-106">In simple cases, a restore sequence requires only a full database backup, a differential database backup, and the subsequent log backups.</span></span> <span data-ttu-id="37b43-107">Dans ces cas, la construction d'une séquence de restauration correcte est facile.</span><span class="sxs-lookup"><span data-stu-id="37b43-107">In these cases, constructing a correct restore sequence is easy.</span></span> <span data-ttu-id="37b43-108">Par exemple, pour restaurer une base de données dans son ensemble jusqu’au moment de la défaillance, commencez par sauvegarder le journal des transactions actives (la *fin* du journal).</span><span class="sxs-lookup"><span data-stu-id="37b43-108">For example, to restore a whole database to the point of a failure, start by backing up the active transaction log (the *tail* of the log).</span></span> <span data-ttu-id="37b43-109">Puis, restaurez la sauvegarde complète de base de données la plus récente, la sauvegarde différentielle la plus récente (si elle existe) et toutes les sauvegardes du journal réalisées ultérieurement dans l'ordre dans lequel elles ont été effectuées.</span><span class="sxs-lookup"><span data-stu-id="37b43-109">Then, restore the most recent full database backup, the most recent differential backup (if any), and all subsequent log backups in the order in which they were taken.</span></span>  
  
 <span data-ttu-id="37b43-110">Dans les cas plus complexes, la construction d'une séquence de restauration correcte peut constituer un processus complexe.</span><span class="sxs-lookup"><span data-stu-id="37b43-110">In more complex cases, constructing a correct restore sequence can be a complex process.</span></span> <span data-ttu-id="37b43-111">Par exemple, une séquence de restauration peut nécessiter plusieurs sauvegardes de fichiers ou la restauration de données à un point dans le temps spécifique.</span><span class="sxs-lookup"><span data-stu-id="37b43-111">For example, a restore sequence might require multiple file backups or restoring data to a specific point in time.</span></span> <span data-ttu-id="37b43-112">Dans les cas très complexes, vous serez peut-être obligé de traverser un chemin de récupération ramifié comportant un ou plusieurs branchements de récupération.</span><span class="sxs-lookup"><span data-stu-id="37b43-112">In very complex cases, you might even have to traverse a forked recovery path that spans one or more recovery forks.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="37b43-113">Un *chemin de récupération* correspond à la séquence de sauvegardes de données et de fichiers journaux qui a amené une base de données à un point particulier dans le temps (appelé point de récupération).</span><span class="sxs-lookup"><span data-stu-id="37b43-113">A *recovery path* is the sequence of data and log backups that have brought a database to a particular point in time (known as a recovery point).</span></span> <span data-ttu-id="37b43-114">Un chemin de récupération est un jeu spécifique de transformations qui ont fait évoluer la base de données au cours du temps, tout en maintenant sa cohérence.</span><span class="sxs-lookup"><span data-stu-id="37b43-114">A recovery path is a specific set of transformations that have evolved the database over time, yet have maintained the consistency of the database.</span></span> <span data-ttu-id="37b43-115">Un chemin de récupération décrit une plage de NSE entre un point de départ (NSE,GUID) et un point final (NSE,GUID).</span><span class="sxs-lookup"><span data-stu-id="37b43-115">A recovery path describes a range of LSNs from a start point (LSN,GUID) to an end point (LSN,GUID).</span></span> <span data-ttu-id="37b43-116">Le jeu de NSE d'un chemin de récupération peut traverser une ou plusieurs branches de récupération entre le début et la fin.</span><span class="sxs-lookup"><span data-stu-id="37b43-116">The range of LSNs in a recovery path can traverse one or more recovery branches from start to end.</span></span>  
  
## <a name="to-plan-a-restore-sequence"></a><span data-ttu-id="37b43-117">Pour planifier une séquence de restauration</span><span class="sxs-lookup"><span data-stu-id="37b43-117">To Plan a Restore Sequence</span></span>  
 <span data-ttu-id="37b43-118">Avant de démarrer une séquence de restauration, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="37b43-118">Before you start a restore sequence, follow these steps:</span></span>  
  
1.  <span data-ttu-id="37b43-119">Créez une sauvegarde de la fin du journal de la base de données, si possible.</span><span class="sxs-lookup"><span data-stu-id="37b43-119">Create a tail-log backup of the database, if you can.</span></span> <span data-ttu-id="37b43-120">Pour plus d’informations, consultez [Sauvegardes de la fin du journal &#40;SQL Server&#41;](tail-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-120">For more information, see [Tail-Log Backups &#40;SQL Server&#41;](tail-log-backups-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="37b43-121">Déterminez le point de récupération cible.</span><span class="sxs-lookup"><span data-stu-id="37b43-121">Determine the target recovery point.</span></span>  
  
     <span data-ttu-id="37b43-122">Il peut s'agir de n'importe quel point dans le temps ou d'une marque au sein d’une sauvegarde du journal des transactions.</span><span class="sxs-lookup"><span data-stu-id="37b43-122">The target recovery point can be any point in time or mark within a transaction log backup.</span></span> <span data-ttu-id="37b43-123">Pour plus d’informations, consultez [Restaurer une base de données SQL Server jusqu’à une limite dans le temps &#40;Mode de récupération complète&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) ou [Utiliser les transactions marquées pour récupérer des bases de données associées uniformément &#40;mode de récupération complète&#41;](use-marked-transactions-to-recover-related-databases-consistently.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-123">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md) or [Use Marked Transactions to Recover Related Databases Consistently &#40;Full Recovery Model&#41;](use-marked-transactions-to-recover-related-databases-consistently.md).</span></span>  
  
3.  <span data-ttu-id="37b43-124">Déterminez le type de restauration à effectuer.</span><span class="sxs-lookup"><span data-stu-id="37b43-124">Determine the type of restore you want to perform.</span></span> <span data-ttu-id="37b43-125">Pour plus d’informations, consultez [Vue d’ensemble de la restauration et de la récupération &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-125">For more information, see [Restore and Recovery Overview &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md).</span></span>  
  
4.  <span data-ttu-id="37b43-126">Identifiez les sauvegardes dont vous avez besoin et vérifiez que les jeux de supports de sauvegarde et unités de sauvegarde nécessaires sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="37b43-126">Identify which backups you require and make sure that the necessary media sets and backup devices are available.</span></span> <span data-ttu-id="37b43-127">Pour plus d’informations, consultez [Unités de sauvegarde &#40;SQL Server&#41;](backup-devices-sql-server.md) et [Jeux de supports, familles de supports et jeux de sauvegarde &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-127">For more information, see [Backup Devices &#40;SQL Server&#41;](backup-devices-sql-server.md) and [Media Sets, Media Families, and Backup Sets &#40;SQL Server&#41;](media-sets-media-families-and-backup-sets-sql-server.md).</span></span>  
  
## <a name="to-perform-a-restore-sequence"></a><span data-ttu-id="37b43-128">Pour exécuter une séquence de restauration</span><span class="sxs-lookup"><span data-stu-id="37b43-128">To Perform a Restore Sequence</span></span>  
 <span data-ttu-id="37b43-129">Pour exécuter une séquence de restauration, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="37b43-129">To perform a restore sequence, follow these steps:</span></span>  
  
1.  <span data-ttu-id="37b43-130">Pour commencer la séquence, restaurez une ou plusieurs sauvegardes de données, telles que : une sauvegarde de base de données, une sauvegarde partielle, une ou plusieurs sauvegardes de fichiers.</span><span class="sxs-lookup"><span data-stu-id="37b43-130">To start the sequence, restore a one or more data backups, such as: a database backup, a partial backup, one or more file backups.</span></span>  
  
2.  <span data-ttu-id="37b43-131">Restaurez éventuellement les dernières sauvegardes différentielles qui sont basées sur ces sauvegardes complètes.</span><span class="sxs-lookup"><span data-stu-id="37b43-131">Optionally, restore the latest differential backups that are based on these full backups.</span></span>  
  
     <span data-ttu-id="37b43-132">Pour chaque sauvegarde complète que vous envisagez de restaurer, déterminez si elle est la base d'une sauvegarde différentielle.</span><span class="sxs-lookup"><span data-stu-id="37b43-132">For each full backup that you plan to restore, determine whether it is the base for any differential backups.</span></span> <span data-ttu-id="37b43-133">Si tel est le cas, restaurez la sauvegarde différentielle la plus récente, si possible.</span><span class="sxs-lookup"><span data-stu-id="37b43-133">If so, restore most recent differential backup, if you can.</span></span> <span data-ttu-id="37b43-134">Pour plus d’informations, consultez [Sauvegardes différentielles &#40;SQL Server&#41;](differential-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-134">For more information, see [Differential Backups &#40;SQL Server&#41;](differential-backups-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="37b43-135">Restaurez la base de données par progression en restaurant les sauvegardes de journal de transactions en séquence, en terminant par la sauvegarde contenant le point de récupération.</span><span class="sxs-lookup"><span data-stu-id="37b43-135">Roll forward the database by restoring log backups in sequence, finishing with the backup that contains the recovery point.</span></span> <span data-ttu-id="37b43-136">L'application ou non de toutes les sauvegardes du journal dépend de la sauvegarde du journal qui contient le point de récupération cible, comme suit :</span><span class="sxs-lookup"><span data-stu-id="37b43-136">Whether you have to apply all the log backups depends on what log backup contains the target recovery point, as follows:</span></span>  
  
    -   <span data-ttu-id="37b43-137">Si ce point correspond au point de défaillance, vous devez restaurer chaque sauvegarde du journal ayant été créée depuis la dernière sauvegarde de données (complète ou différentielle) que vous avez restaurée.</span><span class="sxs-lookup"><span data-stu-id="37b43-137">If the recovery point is the point of a failure, you must restore every log backup that was created since the last data (full or differential) backup you restored.</span></span> <span data-ttu-id="37b43-138">Pour plus d’informations, consultez [Appliquer les sauvegardes du journal de transactions &#40;SQL Server&#41;](transaction-log-backups-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-138">For more information, see [Apply Transaction Log Backups &#40;SQL Server&#41;](transaction-log-backups-sql-server.md).</span></span>  
  
    -   <span data-ttu-id="37b43-139">Pour une restauration limitée dans le temps, vous n'aurez sans doute pas besoin des sauvegardes du journal les plus récentes.</span><span class="sxs-lookup"><span data-stu-id="37b43-139">For a point-in-time restore, you might not require the most recent log backups.</span></span> <span data-ttu-id="37b43-140">Si vous utilisez [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], l'Assistant Récupération de base de données garantit que seules les sauvegardes requises pour la restauration de votre limite dans le temps spécifique sont sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="37b43-140">If you use [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], the Database Recovery Advisor ensures that only backups that are required to restore to your specified point in time are selected.</span></span> <span data-ttu-id="37b43-141">Ces sauvegardes constituent le plan de restauration recommandé pour votre limite de restauration dans le temps.</span><span class="sxs-lookup"><span data-stu-id="37b43-141">These backups make up the recommended restore plan for your point-in-time restore.</span></span> <span data-ttu-id="37b43-142">Pour plus d’informations, consultez [Restaurer une base de données SQL Server jusqu’à une limite dans le temps &#40;mode de récupération complète&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span><span class="sxs-lookup"><span data-stu-id="37b43-142">For more information, see [Restore a SQL Server Database to a Point in Time &#40;Full Recovery Model&#41;](restore-a-sql-server-database-to-a-point-in-time-full-recovery-model.md).</span></span>  
  
## <a name="restarting-a-restore-sequence"></a><span data-ttu-id="37b43-143">Redémarrage d'une séquence de restauration</span><span class="sxs-lookup"><span data-stu-id="37b43-143">Restarting a Restore Sequence</span></span>  
 <span data-ttu-id="37b43-144">Si vous rencontrez un problème avec le résultat d'une séquence de restauration, vous pouvez l'arrêter et la redémarrer à partir du début.</span><span class="sxs-lookup"><span data-stu-id="37b43-144">If you encounter a problem with the outcome of a restore sequence, you can quit it and restart the restore sequence over from the start.</span></span> <span data-ttu-id="37b43-145">Par exemple, si vous restaurez accidentellement un trop grand nombre de sauvegardes de journal et allez au-delà du point de récupération souhaité, vous devez redémarrer la séquence de restauration jusqu'à la sauvegarde du journal qui contient le point de récupération cible.</span><span class="sxs-lookup"><span data-stu-id="37b43-145">For example, if you accidentally restore too many log backups and overshoot the intended recovery point, you must restart the restore sequence up to log backup that contains the target recovery point.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="37b43-146"> Voir aussi</span><span class="sxs-lookup"><span data-stu-id="37b43-146">See Also</span></span>  
 <span data-ttu-id="37b43-147">[Vue d’ensemble de la sauvegarde &#40;SQL Server&#41;](backup-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-147">[Backup Overview &#40;SQL Server&#41;](backup-overview-sql-server.md) </span></span>  
 <span data-ttu-id="37b43-148">[Vue d’ensemble de la restauration et de la récupération &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-148">[Restore and Recovery Overview &#40;SQL Server&#41;](restore-and-recovery-overview-sql-server.md) </span></span>  
 <span data-ttu-id="37b43-149">[Restaurations complètes de bases de données &#40;mode de récupération complète&#41;](complete-database-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-149">[Complete Database Restores &#40;Full Recovery Model&#41;](complete-database-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="37b43-150">[Restauration en ligne &#40;SQL Server&#41;](online-restore-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-150">[Online Restore &#40;SQL Server&#41;](online-restore-sql-server.md) </span></span>  
 <span data-ttu-id="37b43-151">[Restaurations de fichiers &#40;mode de récupération complète&#41;](file-restores-full-recovery-model.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-151">[File Restores &#40;Full Recovery Model&#41;](file-restores-full-recovery-model.md) </span></span>  
 <span data-ttu-id="37b43-152">[Restaurer des pages &#40;SQL Server&#41;](restore-pages-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="37b43-152">[Restore Pages &#40;SQL Server&#41;](restore-pages-sql-server.md) </span></span>  
 [<span data-ttu-id="37b43-153">Restaurations fragmentaires &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="37b43-153">Piecemeal Restores &#40;SQL Server&#41;</span></span>](piecemeal-restores-sql-server.md)  
  
  
