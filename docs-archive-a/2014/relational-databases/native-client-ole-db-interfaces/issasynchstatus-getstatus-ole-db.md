---
title: ISSAsynchStatus::GetStatus (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- ISSAsynchStatus::GetStatus (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- GetStatus method
ms.assetid: 354b6ee4-b5a1-48f6-9403-da3bdc911067
author: rothja
ms.author: jroth
ms.openlocfilehash: 14c20ae5d9a5cd31139db74aeedabb2d017f6ce6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602120"
---
# <a name="issasynchstatusgetstatus-ole-db"></a><span data-ttu-id="6b4e2-102">ISSAsynchStatus::GetStatus (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="6b4e2-102">ISSAsynchStatus::GetStatus (OLE DB)</span></span>
  <span data-ttu-id="6b4e2-103">Retourne l'état d'une opération s'exécutant de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-103">Returns the status of an asynchronously executing operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="6b4e2-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="6b4e2-104">Syntax</span></span>  
  
```  
  
HRESULT GetStatus(  
  HCHAPTER hChapter,  
  DBASYNCHOP eOperation,  
  DBCOUNTITEM *pulProgress,  
  DBCOUNTITEM *pulProgressMax,  
  DBASYNCHPHASE *peAsynchPhase,  
  LPOLESTR *ppwszStatusText);  
```  
  
## <a name="arguments"></a><span data-ttu-id="6b4e2-105">Arguments</span><span class="sxs-lookup"><span data-stu-id="6b4e2-105">Arguments</span></span>  
 <span data-ttu-id="6b4e2-106">*hChapter*[in]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-106">*hChapter*[in]</span></span>  
 <span data-ttu-id="6b4e2-107">Handle du chapitre.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-107">The chapter handle.</span></span> <span data-ttu-id="6b4e2-108">Lorsque l'objet interrogé n'est pas un objet rowset ou que l'opération ne s'applique pas à un chapitre, vous devez attribuer au handle la valeur DB_NULL_HCHAPTER, celle-ci étant ignorée par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-108">If the object being polled is not a rowset object or the operation does not apply to a chapter, this should be set to DB_NULL_HCHAPTER, which is ignored by the provider.</span></span>  
  
 <span data-ttu-id="6b4e2-109">*eOperation*[in]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-109">*eOperation*[in]</span></span>  
 <span data-ttu-id="6b4e2-110">L'opération pour laquelle l'état asynchrone est demandé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-110">The operation for which the asynchronous status is being requested.</span></span> <span data-ttu-id="6b4e2-111">Elle doit avoir la valeur suivante :</span><span class="sxs-lookup"><span data-stu-id="6b4e2-111">This should be the following value:</span></span>  
  
 <span data-ttu-id="6b4e2-112">DBASYNCHOP_OPEN : le consommateur demande des informations sur l'ouverture ou le remplissage asynchrone d'un ensemble de lignes ou sur l'initialisation asynchrone d'un objet source de données.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-112">DBASYNCHOP_OPEN-The consumer requests information about the asynchronous opening or population of a rowset or about the asynchronous initialization of a data source object.</span></span> <span data-ttu-id="6b4e2-113">Si le fournisseur est un fournisseur conforme à OLE DB 2.5 qui prend en charge la liaison d'URL directe, le consommateur demande des informations sur l'initialisation ou le remplissage asynchrone d'une source de données, d'un ensemble de lignes, d'une ligne ou d'un objet de flux.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-113">If the provider is an OLE DB 2.5-compliant provider that supports direct URL binding, the consumer requests information about the asynchronous initialization or population of a data source, rowset, row, or stream object.</span></span>  
  
 <span data-ttu-id="6b4e2-114">*pulProgress*[out]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-114">*pulProgress*[out]</span></span>  
 <span data-ttu-id="6b4e2-115">Pointeur vers la mémoire dans lequel la progression actuelle de l'opération asynchrone relative à la valeur maximale attendue indiquée dans le paramètre *pulProgressMax* est retournée.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-115">A pointer to memory in which to return the current progress of the asynchronous operation relative to the expected maximum indicated in the *pulProgressMax* parameter.</span></span> <span data-ttu-id="6b4e2-116">Pour plus d'informations sur la signification de *pulProgress*, consultez la description de *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-116">For more information about the meaning of *pulProgress*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="6b4e2-117">Si *pulProgress* est un pointeur null, aucune progression n'est retournée.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-117">If *pulProgress* is a null pointer, no progress is returned.</span></span>  
  
 <span data-ttu-id="6b4e2-118">*pulProgressMax*[out]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-118">*pulProgressMax*[out]</span></span>  
 <span data-ttu-id="6b4e2-119">Pointeur vers la mémoire dans lequel la valeur maximale attendue du paramètre *pulProgress* est retournée.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-119">A pointer to memory in which to return the expected maximum value of the *pulProgress* parameter.</span></span> <span data-ttu-id="6b4e2-120">Cette valeur peut varier selon les appels à cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-120">This value may change across calls to this method.</span></span> <span data-ttu-id="6b4e2-121">Pour plus d'informations sur la signification de *pulProgressMax*, consultez la description de *peAsynchPhase*.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-121">For more information about the meaning of *pulProgressMax*, see the description of *peAsynchPhase*.</span></span>  
  
 <span data-ttu-id="6b4e2-122">Si *pulProgressMax* est un pointeur null, aucune valeur maximale attendue n'est retournée.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-122">If *pulProgressMax* is a null pointer, no expected maximum value is returned.</span></span>  
  
 <span data-ttu-id="6b4e2-123">*peAsynchPhase*[out]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-123">*peAsynchPhase*[out]</span></span>  
 <span data-ttu-id="6b4e2-124">Pointeur vers la mémoire dans lequel des informations supplémentaires concernant la progression de l'opération asynchrone sont retournées.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-124">A pointer to memory in which to return additional information regarding the progress of the asynchronous operation.</span></span> <span data-ttu-id="6b4e2-125">Les valeurs valides sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="6b4e2-125">Valid values include:</span></span>  
  
 <span data-ttu-id="6b4e2-126">DBASYNCHPHASE_INITIALIZATION : l'objet est dans une phase d'initialisation.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-126">DBASYNCHPHASE_INITIALIZATION-The object is in an initialization phase.</span></span> <span data-ttu-id="6b4e2-127">Les arguments *pulProgress* et *pulProgressMax* indiquent un taux d'achèvement estimé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-127">The arguments *pulProgress* and *pulProgressMax* indicate an estimated ratio of completion.</span></span> <span data-ttu-id="6b4e2-128">L'objet n'est pas encore entièrement matérialisé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-128">The object is not yet fully materialized.</span></span> <span data-ttu-id="6b4e2-129">Toute tentative d'appel d'autres interfaces peut échouer, et le jeu complet d'interfaces peut ne pas être disponible sur l'objet.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-129">Attempting to call any other interfaces may fail, and the full set of interfaces may not be available on the object.</span></span> <span data-ttu-id="6b4e2-130">Si l'opération asynchrone est le résultat de l'appel à **ICommand::Execute** pour une commande qui met à jour, supprime ou insère des lignes, et que *cParamSets* est supérieur à 1, *pulProgress* et *pulProgressMax* peuvent indiquer la progression pour un jeu unique de paramètres ou pour le tableau complet de jeux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-130">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows and if *cParamSets* is greater than 1, *pulProgress* and *pulProgressMax* may indicate the progress for a single set of parameters or for the full array of parameter sets.</span></span>  
  
 <span data-ttu-id="6b4e2-131">DBASYNCHPHASE_POPULATION : l'objet est dans une phase de remplissage.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-131">DBASYNCHPHASE_POPULATION-The object is in a population phase.</span></span> <span data-ttu-id="6b4e2-132">Bien que l'ensemble de lignes soit entièrement initialisé et que la plage complète d'interfaces soit disponible sur l'objet, d'autres lignes peuvent ne pas être encore remplies dans l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-132">Although the rowset is fully initialized and the full range of interfaces is available on the object, there may be additional rows not yet populated into the rowset.</span></span> <span data-ttu-id="6b4e2-133">Même si *pulProgress* et *pulProgressMax* peuvent être basés sur le nombre de lignes remplies, ils sont en général basés sur la durée ou l'effort requis pour remplir l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-133">While *pulProgress* and *pulProgressMax* can be based on the number of rows populated, they are generally based on the time or effort required to populate the rowset.</span></span> <span data-ttu-id="6b4e2-134">Un appelant doit par conséquent utiliser ces informations comme une estimation approximative de la durée du processus, et non comme le nombre de lignes éventuel.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-134">A caller should therefore use this information as a rough estimate of how long the process might take, not the eventual row count.</span></span> <span data-ttu-id="6b4e2-135">Cette phase est uniquement retournée lors du remplissage d'un ensemble de lignes ; elle n'est jamais retournée lors de l'initialisation d'un objet source de données ou par l'exécution d'une commande qui met à jour, supprime ou insère des lignes.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-135">This phase is returned only during population of a rowset; it is never returned in the initialization of a data source object or by the execution of a command that updates, deletes, or inserts rows.</span></span>  
  
 <span data-ttu-id="6b4e2-136">DBASYNCHPHASE_COMPLETE : l'ensemble du traitement asynchrone ayant été réalisé par l'objet.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-136">DBASYNCHPHASE_COMPLETE-All asynchronous processing of the object has completed.</span></span> <span data-ttu-id="6b4e2-137">**ISSAsynchStatus::GetStatus** retourne un HRESULT qui indique le résultat de l'opération.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-137">**ISSAsynchStatus::GetStatus** returns an HRESULT indicating the outcome of the operation.</span></span> <span data-ttu-id="6b4e2-138">En général, il s'agit du HRESULT qui aurait été retourné si l'opération avait été appelée de manière synchrone.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-138">Typically, this will be the HRESULT that would have been returned had the operation been called synchronously.</span></span> <span data-ttu-id="6b4e2-139">Si l'opération asynchrone est le résultat de l'appel à **ICommand::Execute** pour une commande qui met à jour, supprime ou insère des lignes, *pulProgress* et *pulProgressMax* sont égaux au nombre total de lignes affectées par la commande.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-139">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* and *pulProgressMax* are equal to the total number of rows affected by the command.</span></span> <span data-ttu-id="6b4e2-140">Si *cParamSets* est supérieur à 1, il s'agit du nombre total de lignes affectées par tous les jeux de paramètres spécifiés dans l'exécution.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-140">If *cParamSets* is greater than 1, this is the total number of rows affected by all of the sets of parameters specified in the execution.</span></span> <span data-ttu-id="6b4e2-141">Si *peAsynchPhase* est un pointeur null, aucun code d'état n'est retourné.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-141">If *peAsynchPhase* is a null pointer, no status code is returned.</span></span>  
  
 <span data-ttu-id="6b4e2-142">DBASYNCHPHASE_CANCELED : le traitement asynchrone de l'objet a été abandonné.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-142">DBASYNCHPHASE_CANCELED-Asynchronous processing of the object was aborted.</span></span> <span data-ttu-id="6b4e2-143">**ISSAsynchStatus::GetStatus** retourne DB_E_CANCELED.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-143">**ISSAsynchStatus::GetStatus** returns DB_E_CANCELED.</span></span> <span data-ttu-id="6b4e2-144">Si l'opération asynchrone est le résultat de l'appel à **ICommand::Execute** pour une commande qui met à jour, supprime ou insère des lignes, *pulProgress* est égal au nombre total de lignes, pour tous les paramètres définis, affectées par la commande avant l'annulation.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-144">If the asynchronous operation was a result of calling **ICommand::Execute** for a command that updates, deletes, or inserts rows, *pulProgress* is equal to the total number of rows, for all parameter sets, affected by the command prior to cancellation.</span></span>  
  
 <span data-ttu-id="6b4e2-145">*ppwszStatusText*[in/out]</span><span class="sxs-lookup"><span data-stu-id="6b4e2-145">*ppwszStatusText*[in/out]</span></span>  
 <span data-ttu-id="6b4e2-146">Pointeur vers la mémoire contenant des informations supplémentaires sur l'opération.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-146">A pointer to memory containing additional information about the operation.</span></span> <span data-ttu-id="6b4e2-147">Un fournisseur peut utiliser cette valeur pour faire la différence entre des éléments d'une opération, par exemple les différentes ressources en cours d'accès.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-147">A provider may use this value to distinguish between different elements of an operation-for example, different resources being accessed.</span></span> <span data-ttu-id="6b4e2-148">Cette chaîne est localisée selon la propriété DBPROP_INIT_LCID sur l'objet source de données.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-148">This string is localized according to the DBPROP_INIT_LCID property on the data source object.</span></span>  
  
 <span data-ttu-id="6b4e2-149">Si *ppwszStatusText* n'a pas la valeur Null en entrée, le fournisseur retourne l'état associé à l'élément particulier identifié par *ppwszStatusText*.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-149">If *ppwszStatusText* is non-null on input, the provider returns status associated with the particular element identified by *ppwszStatusText*.</span></span> <span data-ttu-id="6b4e2-150">Si *ppwszStatusText* n'indique pas un élément d' *eOperation*, le fournisseur retourne S_OK avec la même valeur attribuée à *pulProgress* et à *pulProgressMax* .</span><span class="sxs-lookup"><span data-stu-id="6b4e2-150">If *ppwszStatusText* does not indicate an element of *eOperation*, the provider returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="6b4e2-151">Si le fournisseur ne fait pas la différence entre des éléments basés sur un identificateur textuel, il attribue la valeur Null à *ppwszStatusText* et retourne des informations sur l'opération dans son ensemble ; sinon, si *ppwszStatusText* n'a pas la valeur Null en entrée, le fournisseur laisse *ppwszStatusText* inchangé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-151">If the provider does not distinguish between elements based on a textual identifier, it sets *ppwszStatusText* to NULL and returns information about the operation as a whole; otherwise, if *ppwszStatusText* is non-null on input, the provider leaves *ppwszStatusText* untouched.</span></span>  
  
 <span data-ttu-id="6b4e2-152">Si *ppwszStatusText* a la valeur Null en entrée, le fournisseur attribue à *ppwszStatusText* une valeur qui indique plus d'informations sur l'opération, ou une valeur Null si aucune information n'est disponible ou si **ISSAsynchStatus::GetStatus** retourne une erreur.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-152">If *ppwszStatusText* is null on input, the provider sets *ppwszStatusText* to a value indicating more information about the operation, or to NULL if no such information is available or if **ISSAsynchStatus::GetStatus** returns an error.</span></span> <span data-ttu-id="6b4e2-153">Lorsque *ppwszStatusText* a la valeur Null en entrée, le fournisseur alloue de la mémoire pour la chaîne d'état et retourne l'adresse à cette mémoire.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-153">When *ppwszStatusText* is null on input, the provider allocates memory for the status string and returns the address to this memory.</span></span> <span data-ttu-id="6b4e2-154">Le consommateur libère cette mémoire avec **IMalloc::Free** lorsqu'il n'a plus besoin de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-154">The consumer releases this memory with **IMalloc::Free** when it no longer needs the string.</span></span>  
  
 <span data-ttu-id="6b4e2-155">Si *ppwszStatusText* a la valeur Null en entrée, aucune chaîne d'état n'est retournée et le fournisseur retourne des informations sur n'importe quel élément de l'opération ou sur l'opération en général.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-155">If *ppwszStatusText* is NULL on input, no status string is returned and the provider returns information about any element of the operation or about the operation in general.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="6b4e2-156">Codet de retour</span><span class="sxs-lookup"><span data-stu-id="6b4e2-156">Return Code Values</span></span>  
 <span data-ttu-id="6b4e2-157">S_OK</span><span class="sxs-lookup"><span data-stu-id="6b4e2-157">S_OK</span></span>  
 <span data-ttu-id="6b4e2-158">Retour réussi de la méthode.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-158">The method returned successfully.</span></span>  
  
-   <span data-ttu-id="6b4e2-159">Si *peAsynchPhase* est égal à DBASYNCHPHASE_INITIALIZATION, l'objet n'est pas encore entièrement initialisé ; toute tentative d'appel à d'autres interfaces peut échouer, et le jeu complet d'interfaces peut ne pas être disponible sur l'objet.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-159">If *peAsynchPhase* is equal to DBASYNCHPHASE_INITIALIZATION, the object is not yet fully initialized; attempting to call any other interfaces might fail, and the full set of interfaces might not be available on the object.</span></span>  
  
-   <span data-ttu-id="6b4e2-160">Si *peAsynchPhase* est égal à DBASYNCHPHASE_POPULATION, l'ensemble de lignes est entièrement initialisé et la plage complète d'interfaces est disponible sur l'objet ; toutefois, d'autres lignes peuvent ne pas être encore remplies dans l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-160">If *peAsynchPhase* is equal to DBASYNCHPHASE_POPULATION, the rowset is fully initialized and the full range of interfaces is available on the object; however, there might be additional rows not yet populated into the rowset.</span></span>  
  
-   <span data-ttu-id="6b4e2-161">Si *peAsynchPhase* est égal à DBASYNCHPHASE_COMPLETE, le traitement asynchrone de l'objet est entièrement terminé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-161">If *peAsynchPhase* is equal to DBASYNCHPHASE_COMPLETE, all asynchronous processing of the object has completed.</span></span> <span data-ttu-id="6b4e2-162">L'objet est entièrement initialisé et rempli.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-162">The object is fully initialized and populated.</span></span>  
  
 <span data-ttu-id="6b4e2-163">DB_E_CANCELED</span><span class="sxs-lookup"><span data-stu-id="6b4e2-163">DB_E_CANCELED</span></span>  
 <span data-ttu-id="6b4e2-164">Le traitement asynchrone a été annulé pendant le remplissage de l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-164">Asynchronous processing was canceled during rowset population.</span></span> <span data-ttu-id="6b4e2-165">Le remplissage s'arrête, mais l'ensemble de lignes reste valide pour les lignes déjà remplies.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-165">Population stops, but the rowset remains valid for the rows already populated.</span></span>  
  
 <span data-ttu-id="6b4e2-166">Le traitement asynchrone a été annulé pendant l'initialisation de l'objet source de données.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-166">Asynchronous processing was canceled during data source object initialization.</span></span> <span data-ttu-id="6b4e2-167">L'objet source de données se trouve dans un état non initialisé.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-167">The data source object is in an uninitialized state.</span></span>  
  
 <span data-ttu-id="6b4e2-168">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="6b4e2-168">E_INVALIDARG</span></span>  
 <span data-ttu-id="6b4e2-169">Le paramètre *hChapter* est incorrect.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-169">The *hChapter* parameter is incorrect.</span></span>  
  
 <span data-ttu-id="6b4e2-170">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="6b4e2-170">E_UNEXPECTED</span></span>  
 <span data-ttu-id="6b4e2-171">**ISSAsynchStatus::GetStatus** a été appelé sur un objet source de données, et **IDBInitialize::Initialize** n'a pas été appelé sur l'objet source de données.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-171">**ISSAsynchStatus::GetStatus** was called on a data source object, and **IDBInitialize::Initialize** has not been called on the data source object.</span></span>  
  
 <span data-ttu-id="6b4e2-172">**ISSAsynchStatus::GetStatus** a été appelé sur un ensemble de lignes, **ITransaction::Commit** ou **ITransaction::Abort** a été appelé, et l'objet se trouve dans un état zombie.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-172">**ISSAsynchStatus::GetStatus** was called on a rowset, **ITransaction::Commit** or **ITransaction::Abort** was called, and the object is in a zombie state.</span></span>  
  
 <span data-ttu-id="6b4e2-173">**ISSAsynchStatus::GetStatus** a été appelé sur un ensemble de lignes qui a été annulé de manière asynchrone dans sa phase d'initialisation.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-173">**ISSAsynchStatus::GetStatus** was called on a rowset that was asynchronously canceled in its initialization phase.</span></span> <span data-ttu-id="6b4e2-174">L'ensemble de lignes se trouve dans un état zombie.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-174">The rowset is in a zombie state.</span></span>  
  
 <span data-ttu-id="6b4e2-175">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="6b4e2-175">E_FAIL</span></span>  
 <span data-ttu-id="6b4e2-176">Une erreur spécifique au fournisseur s'est produite.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-176">A provider-specific error occurred.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="6b4e2-177">Notes</span><span class="sxs-lookup"><span data-stu-id="6b4e2-177">Remarks</span></span>  
 <span data-ttu-id="6b4e2-178">La méthode **ISSAsynchStatus::GetStatus** se comporte exactement comme la méthode **IDBAsynchStatus::GetStatus**, à la différence près que si l’initialisation d’un objet source de données est abandonnée, E_UNEXPECTED est retourné au lieu de DB_E_CANCELED (pourtant, [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) retourne DB_E_CANCELED).</span><span class="sxs-lookup"><span data-stu-id="6b4e2-178">The **ISSAsynchStatus::GetStatus** method behaves exactly as the **IDBAsynchStatus::GetStatus** method except that if initialization of a data source object is aborted, E_UNEXPECTED is returned rather than DB_E_CANCELED (although [ISSAsynchStatus::WaitForAsynchCompletion](issasynchstatus-waitforasynchcompletion-ole-db.md) will return DB_E_CANCELED).</span></span> <span data-ttu-id="6b4e2-179">Cela est dû au fait que l'objet source de données ne reste pas dans l'état zombie habituel après un abandon, et ce pour autoriser d'autres tentatives d'initialisation.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-179">This is because the data source object is not left in the usual zombie state following an abort, in order that further initialization operations may be attempted.</span></span>  
  
 <span data-ttu-id="6b4e2-180">Si l'ensemble de lignes est initialisé ou rempli de manière asynchrone, il doit prendre en charge cette méthode.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-180">If the rowset is initialized or populated asynchronously, it must support this method.</span></span>  
  
 <span data-ttu-id="6b4e2-181">En plus des valeurs de retour répertoriées, **ISSAsynchStatus::GetStatus** peut retourner tout HRESULT qui aurait été retourné par la méthode ayant initialisé l'opération asynchrone, indiquant la réussite ou l'échec de l'opération.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-181">In addition to the return values listed, **ISSAsynchStatus::GetStatus** can return any HRESULT that would have been returned by the method that initiated the asynchronous operation, indicating the success or failure of the operation.</span></span>  
  
 <span data-ttu-id="6b4e2-182">Certaines opérations asynchrones peuvent uniquement être en mesure de retourner des états « fini » et « non fini ».</span><span class="sxs-lookup"><span data-stu-id="6b4e2-182">Some asynchronous operations might not be able to return any states other than "finished" and "not finished".</span></span> <span data-ttu-id="6b4e2-183">Elles doivent attribuer la valeur 1 à *pulProgressMax* pour indiquer la granularité de leur estimation (tout ou rien). Leurs réponses sont donc 0/1 ou 1/1.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-183">They should set *pulProgressMax* to a value of 1, indicating the all-or-nothing granularity of their estimate, so their answers would be either 0/1 or 1/1.</span></span>  
  
 <span data-ttu-id="6b4e2-184">Un fournisseur peut modifier *pulProgressMax* dans des appels consécutifs, et même retourner un taux inférieur à celui indiqué précédemment, si cela reflète une meilleure estimation du degré d'achèvement de la tâche.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-184">A provider may change *pulProgressMax* in successive calls and even return a smaller ratio than previously, if this reflects an improving estimate of the degree of completion of the task.</span></span>  
  
 <span data-ttu-id="6b4e2-185">Le fournisseur n'est pas obligé de garantir davantage de précision, mais il y est encouragé dans les cas des estimations d'achèvement raisonnables peuvent être faites.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-185">The provider is not obliged to guarantee any further accuracy but is encouraged to do so in cases where reasonable estimates of completion are possible.</span></span> <span data-ttu-id="6b4e2-186">L'utilisation principale de cette fonction étant vraisemblablement de donner les commentaires de progression à l'utilisateur, de tels efforts améliorent la qualité de l'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-186">Such efforts will improve user-interface quality because the main use of this function is likely to be to give progress feedback to the user.</span></span> <span data-ttu-id="6b4e2-187">La satisfaction de l'utilisateur augmente avec la qualité des commentaires sur une tâche invisible de longue durée.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-187">User satisfaction increases with the quality of feedback on an invisible, long-running task.</span></span>  
  
 <span data-ttu-id="6b4e2-188">Le fait d'appeler **ISSAsynchStatus::GetStatus** sur un objet source de données initialisé ou un ensemble de lignes rempli, ou de passer une valeur pour *eOperation* autre que DBASYNCHOP_OPEN, retourne S_OK avec la même valeur attribuée à *pulProgress* et à *pulProgressMax* .</span><span class="sxs-lookup"><span data-stu-id="6b4e2-188">Calling **ISSAsynchStatus::GetStatus** on an initialized data source object or a populated rowset, or passing a value for *eOperation* other than DBASYNCHOP_OPEN, returns S_OK with *pulProgress* and *pulProgressMax* set to the same value.</span></span> <span data-ttu-id="6b4e2-189">Si **ISSAsynchStatus::GetStatus** est appelé sur un objet créé à partir de l'exécution d'une commande qui met à jour, supprime ou insère des lignes, *pulProgress* et *pulProgressMax* indiquent le nombre total de lignes affectées par la commande.</span><span class="sxs-lookup"><span data-stu-id="6b4e2-189">If **ISSAsynchStatus::GetStatus** is called on an object created from the execution of a command that updates, deletes, or inserts rows, both *pulProgress* and *pulProgressMax* indicate the total number of rows affected by the command.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6b4e2-190">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6b4e2-190">See Also</span></span>  
 <span data-ttu-id="6b4e2-191">[Exécution d’opérations asynchrones](../native-client/features/performing-asynchronous-operations.md) </span><span class="sxs-lookup"><span data-stu-id="6b4e2-191">[Performing Asynchronous Operations](../native-client/features/performing-asynchronous-operations.md) </span></span>  
 [<span data-ttu-id="6b4e2-192">ISSAsynchStatus &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="6b4e2-192">ISSAsynchStatus &#40;OLE DB&#41;</span></span>](issasynchstatus-ole-db.md)  
  
  
