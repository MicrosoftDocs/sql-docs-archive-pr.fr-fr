---
title: IBCPSession::BCPControl (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPControl (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPControl method
ms.assetid: d58f3fe1-45e3-4e46-8e9c-000971829d99
author: rothja
ms.author: jroth
ms.openlocfilehash: a3de4d0a942d29f18752374b4020fbfd19aa15ec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87707455"
---
# <a name="ibcpsessionbcpcontrol-ole-db"></a><span data-ttu-id="384d4-102">IBCPSession::BCPControl (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="384d4-102">IBCPSession::BCPControl (OLE DB)</span></span>
  <span data-ttu-id="384d4-103">Définit les options d'une opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="384d4-103">Sets the options for a bulk-copy operation.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="384d4-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="384d4-104">Syntax</span></span>  
  
```  
  
HRESULT BCPControl(   
inteOption,  
void *iValue);  
```  
  
## <a name="remarks"></a><span data-ttu-id="384d4-105">Notes</span><span class="sxs-lookup"><span data-stu-id="384d4-105">Remarks</span></span>  
 <span data-ttu-id="384d4-106">La méthode **BCPControl** définit différents paramètres de contrôle pour les opérations de copie en bloc, y compris le nombre d'erreurs autorisées avant l'annulation de la copie en bloc, les numéros des première et dernière lignes à copier à partir d'un fichier de données, et la taille du lot.</span><span class="sxs-lookup"><span data-stu-id="384d4-106">The **BCPControl** method sets various control parameters for bulk-copy operations including the number of errors allowed before canceling a bulk copy, the numbers of the first and last rows to copy from a data file, and the batch size.</span></span>  
  
 <span data-ttu-id="384d4-107">Cette méthode est également utilisée pour spécifier l'instruction SELECT à utiliser lors de la copie en bloc de données à partir de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="384d4-107">This method is also used to specify the SELECT statement to use when bulk copying data out from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="384d4-108">Vous pouvez définir l' `eOption` argument sur BCP_OPTION_HINTS et l' `iValue` argument pour qu’il ait un pointeur vers une chaîne de caractères larges contenant l’instruction SELECT.</span><span class="sxs-lookup"><span data-stu-id="384d4-108">You can set the `eOption` argument to BCP_OPTION_HINTS and `iValue` argument to have a pointer to a wide character string containing the SELECT statement.</span></span>  
  
 <span data-ttu-id="384d4-109">Les valeurs possibles pour *eOption* sont :</span><span class="sxs-lookup"><span data-stu-id="384d4-109">Possible values for *eOption* are:</span></span>  
  
|<span data-ttu-id="384d4-110">Option</span><span class="sxs-lookup"><span data-stu-id="384d4-110">Option</span></span>|<span data-ttu-id="384d4-111">Description</span><span class="sxs-lookup"><span data-stu-id="384d4-111">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="384d4-112">BCP_OPTION_ABORT</span><span class="sxs-lookup"><span data-stu-id="384d4-112">BCP_OPTION_ABORT</span></span>|<span data-ttu-id="384d4-113">Arrête une opération de copie en bloc déjà en cours.</span><span class="sxs-lookup"><span data-stu-id="384d4-113">Stops a bulk-copy operation that is already in progress.</span></span> <span data-ttu-id="384d4-114">Vous pouvez appeler la méthode **BCPControl** avec un argument *eOption* de valeur BCP_OPTION_ABORT à partir d'un autre thread pour arrêter une opération de copie en bloc en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="384d4-114">You can call the **BCPControl** method with an *eOption* argument of BCP_OPTION_ABORT from another thread to stop a running bulk-copy operation.</span></span> <span data-ttu-id="384d4-115">L'argument *iValue* est ignoré.</span><span class="sxs-lookup"><span data-stu-id="384d4-115">The *iValue* argument is ignored.</span></span>|  
|<span data-ttu-id="384d4-116">BCP_OPTION_BATCH</span><span class="sxs-lookup"><span data-stu-id="384d4-116">BCP_OPTION_BATCH</span></span>|<span data-ttu-id="384d4-117">Nombre de lignes traitées par lot.</span><span class="sxs-lookup"><span data-stu-id="384d4-117">The number of rows per batch.</span></span> <span data-ttu-id="384d4-118">La valeur par défaut est 0, ce qui indique toutes les lignes d'une table lorsque les données sont extraites, ou toutes les lignes dans le fichier de données utilisateur lorsque les données sont copiées vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="384d4-118">The default is 0, which indicates all rows in a table when data is being extracted, or all rows in the user data file when data is being copied to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="384d4-119">Une valeur inférieure à 1 rétablit la valeur par défaut de BCP_OPTION_BATCH.</span><span class="sxs-lookup"><span data-stu-id="384d4-119">A value less than 1 resets BCP_OPTION_BATCH to the default.</span></span>|  
|<span data-ttu-id="384d4-120">BCP_OPTION_DELAYREADFMT</span><span class="sxs-lookup"><span data-stu-id="384d4-120">BCP_OPTION_DELAYREADFMT</span></span>|<span data-ttu-id="384d4-121">Une valeur booléenne définie sur true entraîne la lecture d’[IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="384d4-121">A Boolean, if set to true, will cause [IBCPSession::BCPReadFmt](ibcpsession-bcpreadfmt-ole-db.md) to read at execution.</span></span> <span data-ttu-id="384d4-122">Si la valeur False est définie (valeur par défaut), IBCPSession::BCPReadFmt lira immédiatement le fichier de format.</span><span class="sxs-lookup"><span data-stu-id="384d4-122">If false (the default), IBCPSession::BCPReadFmt will immediately read the format file.</span></span> <span data-ttu-id="384d4-123">Une erreur de séquence se produit si `BCP_OPTION_DELAYREADFMT` a la valeur true et que vous appelez IBCPSession :: BCPColumns ou IBCPSession :: BCPColFmt.</span><span class="sxs-lookup"><span data-stu-id="384d4-123">A sequence error will occur if `BCP_OPTION_DELAYREADFMT` is true and you call IBCPSession::BCPColumns or IBCPSession::BCPColFmt.</span></span><br /><br /> <span data-ttu-id="384d4-124">Une erreur de séquence se produira également si vous appelez `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` après avoir appelé `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` et IBCPSession::BCPWriteFmt.</span><span class="sxs-lookup"><span data-stu-id="384d4-124">A sequence error will also occur if you call `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)FALSE))` after calling `IBCPSession::BCPControl(BCPDELAYREADFMT, (void *)TRUE)` and IBCPSession::BCPWriteFmt.</span></span><br /><br /> <span data-ttu-id="384d4-125">Pour plus d’informations, consultez [Découverte des métadonnées](../native-client/features/metadata-discovery.md).</span><span class="sxs-lookup"><span data-stu-id="384d4-125">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>|  
|<span data-ttu-id="384d4-126">BCP_OPTION_FILECP</span><span class="sxs-lookup"><span data-stu-id="384d4-126">BCP_OPTION_FILECP</span></span>|<span data-ttu-id="384d4-127">L'argument *iValue* contient le numéro de la page de codes pour le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-127">The *iValue* argument contains the number of the code page for the data file.</span></span> <span data-ttu-id="384d4-128">Vous pouvez spécifier le numéro de la page de codes, tel que 1252 ou 850, ou l'une des valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="384d4-128">You can specify the number of the code page, such as 1252 or 850, or one of the following values:</span></span><br /><br /> <span data-ttu-id="384d4-129">-BCP_FILECP_ACP : les données du fichier se trouvent dans le fichier Microsoft Windows ?</span><span class="sxs-lookup"><span data-stu-id="384d4-129">-   BCP_FILECP_ACP: data in the file is in the Microsoft Windows??</span></span> <span data-ttu-id="384d4-130">page de codes du client.</span><span class="sxs-lookup"><span data-stu-id="384d4-130">code page of the client.</span></span><br /><span data-ttu-id="384d4-131">-BCP_FILECP_OEMCP : les données du fichier se trouvent dans la page de codes OEM du client (par défaut).</span><span class="sxs-lookup"><span data-stu-id="384d4-131">-   BCP_FILECP_OEMCP: data in the file is in the OEM code page of the client (default).</span></span><br /><span data-ttu-id="384d4-132">-BCP_FILECP_RAW : les données du fichier se trouvent dans la page de codes de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="384d4-132">-   BCP_FILECP_RAW: data in the file is in the code page of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="384d4-133">BCP_OPTION_FILEFMT</span><span class="sxs-lookup"><span data-stu-id="384d4-133">BCP_OPTION_FILEFMT</span></span>|<span data-ttu-id="384d4-134">Numéro de version du format de fichier de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-134">The version number of the data file format.</span></span> <span data-ttu-id="384d4-135">Il peut s'agir de 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] ou [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), de 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]) ou 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="384d4-135">This can be 80 ([!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]), 90 ([!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]), 100 ([!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or [!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]), 110 ([!INCLUDE[ssSQL11](../../includes/sssql11-md.md)]), or 120 ([!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].</span></span> <span data-ttu-id="384d4-136">120 est la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="384d4-136">120 is the default.</span></span> <span data-ttu-id="384d4-137">Cela s'avère utile pour exporter et importer des données dans des formats pris en charge par une version antérieure du serveur.</span><span class="sxs-lookup"><span data-stu-id="384d4-137">This is useful for exporting and importing data in formats that were supported by earlier version of the server.</span></span>  <span data-ttu-id="384d4-138">Par exemple, pour importer des données obtenues à partir d’une colonne de texte sur un serveur [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] dans une colonne **varchar(max)** sur un serveur [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] ou version ultérieure, vous devez spécifier 80.</span><span class="sxs-lookup"><span data-stu-id="384d4-138">For example, to import data obtained from a text column in a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server into a **varchar(max)** column in a [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] or later server, you should specify 80.</span></span> <span data-ttu-id="384d4-139">De la même façon, si vous spécifiez 80 quand vous exportez des données à partir d’une colonne **varchar(max)** , celles-ci sont enregistrées de la même façon que les colonnes de texte (au format [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)]) et peuvent être importées dans une colonne de texte d’un serveur [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].</span><span class="sxs-lookup"><span data-stu-id="384d4-139">Similarly, if you specify 80 while exporting data from a **varchar(max)** column, it will be saved just like text columns are saved in the [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] format, and can be imported into a text column of a [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] server.</span></span>|  
|<span data-ttu-id="384d4-140">BCP_OPTION_FIRST</span><span class="sxs-lookup"><span data-stu-id="384d4-140">BCP_OPTION_FIRST</span></span>|<span data-ttu-id="384d4-141">Première ligne de données du fichier ou de la table à copier.</span><span class="sxs-lookup"><span data-stu-id="384d4-141">The first row of data of the file or table to copy.</span></span> <span data-ttu-id="384d4-142">La valeur par défaut est 1 ; une valeur inférieure à 1 rétablit la valeur par défaut de cette option.</span><span class="sxs-lookup"><span data-stu-id="384d4-142">The default is 1; a value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="384d4-143">BCP_OPTION_FIRSTEX</span><span class="sxs-lookup"><span data-stu-id="384d4-143">BCP_OPTION_FIRSTEX</span></span>|<span data-ttu-id="384d4-144">Pour les opérations bcp out, spécifie la première ligne de la table de base de données à copier dans le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-144">For BCP out operations, specifies the first row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="384d4-145">Pour les opérations bcp in, spécifie la première ligne du fichier de données à copier dans la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-145">For BCP in operations, specifies the first row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="384d4-146">Le paramètre *iValue* est supposé être l'adresse d'un entier 64 bits signé contenant la valeur.</span><span class="sxs-lookup"><span data-stu-id="384d4-146">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="384d4-147">La valeur maximale qui peut être passée à BCPFIRSTEX est 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="384d4-147">The maximum value that can be passed to BCPFIRSTEX 2^63-1.</span></span>|  
|<span data-ttu-id="384d4-148">BCP_OPTION_FMTXML</span><span class="sxs-lookup"><span data-stu-id="384d4-148">BCP_OPTION_FMTXML</span></span>|<span data-ttu-id="384d4-149">Permet de spécifier que le fichier de format généré doit être au format XML.</span><span class="sxs-lookup"><span data-stu-id="384d4-149">Used to specify that the format file generated should be in an XML format.</span></span> <span data-ttu-id="384d4-150">Par défaut, cette option est désactivée et les fichiers de format sont enregistrés en tant que fichiers texte.</span><span class="sxs-lookup"><span data-stu-id="384d4-150">It is off by default and by default the format files are saved as text files.</span></span> <span data-ttu-id="384d4-151">Le fichier de format XML fournit une plus grande souplesse, mais aussi quelques contraintes supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="384d4-151">The XML format file provides greater flexibility but with some added constraints.</span></span> <span data-ttu-id="384d4-152">Par exemple, vous ne pouvez pas spécifier simultanément le préfixe et la terminaison d'un champ, ce qui est possible dans les fichiers de format plus anciens.</span><span class="sxs-lookup"><span data-stu-id="384d4-152">For example, you can not specify the prefix and terminator for a field simultaneously which is possible in older format files.</span></span> <span data-ttu-id="384d4-153">**Remarque :**  Les fichiers de format XML ne sont pris en charge que lorsque les [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] outils sont installés avec [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="384d4-153">**Note:**  XML format files are only supported when [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tools are installed along with [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client.</span></span>|  
|<span data-ttu-id="384d4-154">BCP_OPTION_HINTS</span><span class="sxs-lookup"><span data-stu-id="384d4-154">BCP_OPTION_HINTS</span></span>|<span data-ttu-id="384d4-155">L'argument *iValue* contient un pointeur de chaîne de caractères larges.</span><span class="sxs-lookup"><span data-stu-id="384d4-155">The *iValue* argument contains a wide character string pointer.</span></span> <span data-ttu-id="384d4-156">La chaîne adressée spécifie des indicateurs de traitement de copie en bloc [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ou une instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] qui retourne un jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="384d4-156">The string addressed specifies either [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-copy processing hints or a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that returns a result set.</span></span> <span data-ttu-id="384d4-157">Si une instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] est spécifiée qui retourne plusieurs jeux de résultats, tous les jeux de résultats après le premier sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="384d4-157">If a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement is specified that returns more than one result set, all result sets after the first are ignored.</span></span>|  
|<span data-ttu-id="384d4-158">BCP_OPTION_KEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="384d4-158">BCP_OPTION_KEEPIDENTITY</span></span>|<span data-ttu-id="384d4-159">Quand l’argument *iValue* a la valeur true, cette option spécifie que les méthodes de copie en bloc insèrent des valeurs de données fournies pour les colonnes [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] définies avec une contrainte d’identité.</span><span class="sxs-lookup"><span data-stu-id="384d4-159">When the *iValue* argument is set to TRUE, this option specifies that the bulk copy methods insert data values supplied for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] columns defined with an identity constraint.</span></span> <span data-ttu-id="384d4-160">Le fichier d'entrée doit fournir des valeurs pour les colonnes d'identité.</span><span class="sxs-lookup"><span data-stu-id="384d4-160">The input file must supply values for the identity columns.</span></span> <span data-ttu-id="384d4-161">Si cela n'est pas défini, de nouvelles valeurs d'identités sont générées pour les lignes insérées.</span><span class="sxs-lookup"><span data-stu-id="384d4-161">If this is not set, new identity values are generated for the inserted rows.</span></span> <span data-ttu-id="384d4-162">Toutes les données présentes dans le fichier pour les colonnes d'identité sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="384d4-162">Any data present in the file for the identity columns is ignored.</span></span>|  
|<span data-ttu-id="384d4-163">BCP_OPTION_KEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="384d4-163">BCP_OPTION_KEEPNULLS</span></span>|<span data-ttu-id="384d4-164">Spécifie si les valeurs de données vides dans le fichier sont converties en valeurs NULL dans la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="384d4-164">Specifies whether empty data values in the file will be converted to NULL values in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="384d4-165">Quand l’argument *iValue* a la valeur TRUE, les valeurs vides sont converties en valeurs NULL dans la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="384d4-165">When the *iValue* argument is set to TRUE, empty values will be converted to NULL in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="384d4-166">L'option par défaut consiste à convertir les valeurs vides en une valeur par défaut pour la colonne dans la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] si une valeur par défaut existe.</span><span class="sxs-lookup"><span data-stu-id="384d4-166">The default is for empty values to be converted to a default value for the column in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table if a default exists.</span></span>|  
|<span data-ttu-id="384d4-167">BCP_OPTION_LAST</span><span class="sxs-lookup"><span data-stu-id="384d4-167">BCP_OPTION_LAST</span></span>|<span data-ttu-id="384d4-168">Dernière ligne à copier.</span><span class="sxs-lookup"><span data-stu-id="384d4-168">The last row to copy.</span></span> <span data-ttu-id="384d4-169">La valeur par défaut indique de copier toutes les lignes.</span><span class="sxs-lookup"><span data-stu-id="384d4-169">The default is to copy all rows.</span></span> <span data-ttu-id="384d4-170">Une valeur inférieure à 1 rétablit la valeur par défaut de cette option.</span><span class="sxs-lookup"><span data-stu-id="384d4-170">A value less than 1 resets this option to its default.</span></span>|  
|<span data-ttu-id="384d4-171">BCP_OPTION_LASTEX</span><span class="sxs-lookup"><span data-stu-id="384d4-171">BCP_OPTION_LASTEX</span></span>|<span data-ttu-id="384d4-172">Pour les opérations bcp out, spécifie la dernière ligne de la table de base de données à copier dans le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-172">For BCP out operations, specifies the last row of the database table to copy into the data file.</span></span><br /><br /> <span data-ttu-id="384d4-173">Pour les opérations bcp in, spécifie la dernière ligne du fichier de données à copier dans la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-173">For BCP in operations, specifies the last row of the data file to copy into the database table.</span></span><br /><br /> <span data-ttu-id="384d4-174">Le paramètre *iValue* est supposé être l'adresse d'un entier 64 bits signé contenant la valeur.</span><span class="sxs-lookup"><span data-stu-id="384d4-174">The *iValue* parameter is expected to be the address of a signed 64-bit integer that contains the value.</span></span> <span data-ttu-id="384d4-175">La valeur maximale qui peut être passée à BCPLASTEX est 2^63-1.</span><span class="sxs-lookup"><span data-stu-id="384d4-175">The maximum value that can be passed to BCPLASTEX is 2^63-1.</span></span>|  
|<span data-ttu-id="384d4-176">BCP_OPTION_MAXERRS</span><span class="sxs-lookup"><span data-stu-id="384d4-176">BCP_OPTION_MAXERRS</span></span>|<span data-ttu-id="384d4-177">Nombre d'erreurs autorisées avant l'échec de l'opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="384d4-177">The number of errors allowed before the bulk copy operation fails.</span></span> <span data-ttu-id="384d4-178">La valeur par défaut est de 10.</span><span class="sxs-lookup"><span data-stu-id="384d4-178">The default is 10.</span></span> <span data-ttu-id="384d4-179">Une valeur inférieure à 1 rétablit la valeur par défaut de cette option.</span><span class="sxs-lookup"><span data-stu-id="384d4-179">A value less than 1 resets this option to its default.</span></span> <span data-ttu-id="384d4-180">La copie en bloc impose 65 535 erreurs au maximum.</span><span class="sxs-lookup"><span data-stu-id="384d4-180">Bulk copy imposes a maximum of 65,535 errors.</span></span> <span data-ttu-id="384d4-181">Toute tentative d'attribution d'une valeur supérieure à 65 535 à cette option entraîne l'attribution de la valeur 65 535 à l'option.</span><span class="sxs-lookup"><span data-stu-id="384d4-181">An attempt to set this option to a value larger than 65,535 results in the option being set to 65,535.</span></span>|  
|<span data-ttu-id="384d4-182">BCP_OPTION_ROWCOUNT</span><span class="sxs-lookup"><span data-stu-id="384d4-182">BCP_OPTION_ROWCOUNT</span></span>|<span data-ttu-id="384d4-183">Retourne le nombre de lignes affectées par l'opération BCP en cours (ou la dernière).</span><span class="sxs-lookup"><span data-stu-id="384d4-183">Returns the number of rows affected by the current (or last) BCP operation.</span></span>|  
|<span data-ttu-id="384d4-184">BCP_OPTION_TEXTFILE</span><span class="sxs-lookup"><span data-stu-id="384d4-184">BCP_OPTION_TEXTFILE</span></span>|<span data-ttu-id="384d4-185">Le fichier de données n'est pas un fichier binaire, mais un fichier texte.</span><span class="sxs-lookup"><span data-stu-id="384d4-185">The data file is not a binary file, but is a text file.</span></span> <span data-ttu-id="384d4-186">BCP détecte si le fichier texte est un fichier Unicode ou non en vérifiant le marqueur d'octet Unicode dans les 2 premiers octets du fichier de données.</span><span class="sxs-lookup"><span data-stu-id="384d4-186">BCP does the detection whether the text file is Unicode or not by checking the Unicode byte marker in the first 2 bytes of the data file.</span></span>|  
|<span data-ttu-id="384d4-187">BCP_OPTION_UNICODEFILE</span><span class="sxs-lookup"><span data-stu-id="384d4-187">BCP_OPTION_UNICODEFILE</span></span>|<span data-ttu-id="384d4-188">Lorsque cette option a pour valeur TRUE, elle spécifie que le fichier d'entrée est un format de fichier Unicode.</span><span class="sxs-lookup"><span data-stu-id="384d4-188">When set to TRUE, this option specifies that the input file is a Unicode file format.</span></span>|  
  
## <a name="arguments"></a><span data-ttu-id="384d4-189">Arguments</span><span class="sxs-lookup"><span data-stu-id="384d4-189">Arguments</span></span>  
 <span data-ttu-id="384d4-190">*eOption*[in]</span><span class="sxs-lookup"><span data-stu-id="384d4-190">*eOption*[in]</span></span>  
 <span data-ttu-id="384d4-191">Spécifiez l'une des options répertoriées dans la section Notes ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="384d4-191">Set to one of the options listed in the remarks section above.</span></span>  
  
 <span data-ttu-id="384d4-192">*iValue*[in]</span><span class="sxs-lookup"><span data-stu-id="384d4-192">*iValue*[in]</span></span>  
 <span data-ttu-id="384d4-193">Valeur pour le paramètre *eOption*spécifié.</span><span class="sxs-lookup"><span data-stu-id="384d4-193">The value for the specified *eOption*.</span></span> <span data-ttu-id="384d4-194">L'argument *iValue* est un cast de valeur entière à un pointeur void permettant d'autoriser l'expansion future vers des valeurs 64 bits.</span><span class="sxs-lookup"><span data-stu-id="384d4-194">The *iValue* argument is an integer value cast to a void pointer to allow for future expansion to 64 bit values.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="384d4-195">Codet de retour</span><span class="sxs-lookup"><span data-stu-id="384d4-195">Return Code Values</span></span>  
 <span data-ttu-id="384d4-196">S_OK</span><span class="sxs-lookup"><span data-stu-id="384d4-196">S_OK</span></span>  
 <span data-ttu-id="384d4-197">S_OK</span><span class="sxs-lookup"><span data-stu-id="384d4-197">The method succeeded.</span></span>  
  
 <span data-ttu-id="384d4-198">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="384d4-198">E_FAIL</span></span>  
 <span data-ttu-id="384d4-199">Une erreur spécifique au fournisseur s’est produite. Pour obtenir des informations détaillées, utilisez l’interface [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="384d4-199">A provider-specific error occurred; for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="384d4-200">E_UNEXPECTED</span><span class="sxs-lookup"><span data-stu-id="384d4-200">E_UNEXPECTED</span></span>  
 <span data-ttu-id="384d4-201">L'appel à la méthode était inattendu.</span><span class="sxs-lookup"><span data-stu-id="384d4-201">The call to the method was unexpected.</span></span> <span data-ttu-id="384d4-202">Par exemple, la méthode [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) n’a pas été appelée avant l’appel de cette fonction.</span><span class="sxs-lookup"><span data-stu-id="384d4-202">For example, the [IBCPSession::BCPInit](ibcpsession-bcpinit-ole-db.md) method was not called before calling this function.</span></span>  
  
 <span data-ttu-id="384d4-203">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="384d4-203">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="384d4-204">Erreur de mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="384d4-204">Out-of-memory error.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="384d4-205">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="384d4-205">See Also</span></span>  
 <span data-ttu-id="384d4-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="384d4-206">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="384d4-207">Exécution d'opérations de copie en bloc</span><span class="sxs-lookup"><span data-stu-id="384d4-207">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
