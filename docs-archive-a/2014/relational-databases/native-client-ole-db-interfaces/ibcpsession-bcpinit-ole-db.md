---
title: IBCPSession::BCPInit (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
api_name:
- IBCPSession::BCPInit (OLE DB)
topic_type:
- apiref
helpviewer_keywords:
- BCPInit method
ms.assetid: 583096d7-da34-49be-87fd-31210aac81aa
author: rothja
ms.author: jroth
ms.openlocfilehash: 25a01c71811de9d47ce01714402460bb53d4c70e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698136"
---
# <a name="ibcpsessionbcpinit-ole-db"></a><span data-ttu-id="6ccb0-102">IBCPSession::BCPInit (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="6ccb0-102">IBCPSession::BCPInit (OLE DB)</span></span>
  <span data-ttu-id="6ccb0-103">Initialise la structure de copie en bloc, effectue une vérification des erreurs, vérifie que les données et les noms de fichiers de format sont corrects, puis les ouvre.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-103">Initializes the bulk copy structure, performs some error checking, verifies that the data and format file names are correct, and then opens them.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="6ccb0-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="6ccb0-104">Syntax</span></span>  
  
```  
  
HRESULT BCPInit(   
const wchar_t *pwszTable,  
const wchar_t *pwszDataFile,  
const wchar_t *pwszErrorFile,  
inteDirection);  
```  
  
## <a name="remarks"></a><span data-ttu-id="6ccb0-105">Notes</span><span class="sxs-lookup"><span data-stu-id="6ccb0-105">Remarks</span></span>  
 <span data-ttu-id="6ccb0-106">La méthode **BCPInit** doit être appelée avant toute autre méthode de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-106">The **BCPInit** method should be called before any other bulk-copy method.</span></span> <span data-ttu-id="6ccb0-107">La méthode **BCPInit** effectue les initialisations nécessaires pour une copie en bloc de données entre la station de travail et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6ccb0-107">The **BCPInit** method performs the necessary initializations for a bulk copy of data between the workstation and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="6ccb0-108">La méthode **BCPInit** examine la structure de la source de base de données ou de la table cible, et non le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-108">The **BCPInit** method examines the structure of the database source or target table, not the data file.</span></span> <span data-ttu-id="6ccb0-109">Elle spécifie des valeurs de format de données pour le fichier de données en fonction de chaque colonne dans la table de base de données, la vue ou le jeu de résultats SELECT.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-109">It specifies data format values for the data file based on each column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="6ccb0-110">Cette spécification inclut le type de données de chaque colonne, la présence ou l'absence d'un indicateur de longueur ou null et des chaînes d'octet de terminateur dans les données, et la largeur des types de données de longueur fixe.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-110">This specification includes the data type of each column, the presence or absence of a length or null indicator and terminator byte strings in the data, and the width of fixed-length data types.</span></span> <span data-ttu-id="6ccb0-111">La méthode **BCPInit** définit ces valeurs de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="6ccb0-111">The **BCPInit** method sets these values as follows:</span></span>  
  
-   <span data-ttu-id="6ccb0-112">Le type de données spécifié est le type de données de la colonne dans la table de base de données, la vue ou le jeu de résultats SELECT.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-112">The data type specified is the data type of the column in the database table, view, or SELECT result set.</span></span> <span data-ttu-id="6ccb0-113">Le type de données est énuméré par les [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] types de données natifs spécifiés dans le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fichier d’en-tête Native Client (sqlncli. h).</span><span class="sxs-lookup"><span data-stu-id="6ccb0-113">The data type is enumerated by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types specified in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client header file (sqlncli.h).</span></span> <span data-ttu-id="6ccb0-114">Leurs valeurs suivent le modèle BCP_TYPE_XXX.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-114">Their values are in the pattern of BCP_TYPE_XXX.</span></span> <span data-ttu-id="6ccb0-115">Les données sont représentées dans leur forme informatique.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-115">The data is represented in its computer form.</span></span> <span data-ttu-id="6ccb0-116">Autrement dit, les données d'une colonne de type de données integer sont représentées par une séquence de quatre octets de poids fort ou de poids faible selon l'ordinateur qui a créé le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-116">That is, data from a column of integer data type is represented by a four-byte sequence that is big-or little-endian based on the computer that created the data file.</span></span>  
  
-   <span data-ttu-id="6ccb0-117">Si un type de données de base de données est de longueur fixe, les données du fichier de données sont également de longueur fixe.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-117">If a database data type is fixed in length, the data file data is also fixed in length.</span></span> <span data-ttu-id="6ccb0-118">Les méthodes de copie en bloc qui traitent les données (par exemple, [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) analysent les lignes de données en prévoyant que la longueur des données du fichier de données sera identique à la longueur des données de la table de base de données, de la vue ou de la liste de colonnes SELECT.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-118">Bulk-copy methods that process data (for example, [IBCPSession::BCPExec](ibcpsession-bcpexec-ole-db.md)) parse data rows expecting the length of the data in the data file to be identical to the length of the data specified in the database table, view, or SELECT column list.</span></span> <span data-ttu-id="6ccb0-119">Par exemple, les données d'une colonne de base de données définie comme `char(13)` doivent être représentées par 13 caractères pour chaque ligne de données du fichier.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-119">For example, data for a database column defined as `char(13)` must be represented by 13 characters for each row of data in the file.</span></span> <span data-ttu-id="6ccb0-120">Les données de longueur fixe peuvent être préfixées avec un indicateur null si la colonne de base de données autorise les valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-120">Fixed-length data can be prefixed with a null indicator if the database column allows null values.</span></span>  
  
-   <span data-ttu-id="6ccb0-121">Lors de la copie de données vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], le fichier de données doit avoir les données de chaque colonne de la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-121">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the data file must have data for each column in the database table.</span></span> <span data-ttu-id="6ccb0-122">Lors de la copie de données depuis [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], les données de toutes les colonnes de la table de base de données, de la vue ou du jeu de résultats SELECT, sont copiées vers le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-122">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], data from all columns in the database table, view, or SELECT result set are copied to the data file.</span></span>  
  
-   <span data-ttu-id="6ccb0-123">Lors de la copie de données vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la position ordinale d'une colonne du fichier de données doit être identique à la position ordinale de la colonne de la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-123">When copying data to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the ordinal position of a column in the data file must be identical to the ordinal position of the column in the database table.</span></span> <span data-ttu-id="6ccb0-124">Lors de la copie de données à partir de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la méthode **BCPExec** place les données selon la position ordinale de la colonne dans la table de base de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-124">When copying data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the **BCPExec** method places data based on the ordinal position of the column in the database table.</span></span>  
  
-   <span data-ttu-id="6ccb0-125">Si un type de données de base de données est variable en longueur (par exemple, `varbinary(22)`) ou si une colonne de base de données peut contenir des valeurs NULL, les données du fichier de données sont préfixées par un indicateur de longueur/null.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-125">If a database data type is variable in length (for example, `varbinary(22)`) or if a database column can contain null values, data in the data file is prefixed by a length/null indicator.</span></span> <span data-ttu-id="6ccb0-126">La largeur de l'indicateur varie selon le type de données et la version de la copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-126">The width of the indicator varies based on the data type and version of bulk copy.</span></span> <span data-ttu-id="6ccb0-127">L’option BCP_OPTION_FILEFMT de la méthode [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md) fournit la compatibilité entre les fichiers de données des copies en bloc antérieurs et les serveurs exécutant des versions ultérieures de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en signalant lorsque la largeur des indicateurs des données est plus étroite que prévu.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-127">The [IBCPSession::BCPControl](ibcpsession-bcpcontrol-ole-db.md) method option BCP_OPTION_FILEFMT provides compatibility between earlier bulk-copy data files and servers running later versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] by indicating when the width of indicators in the data is narrower than expected.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6ccb0-128">Pour modifier les valeurs de format de données spécifiées pour un fichier de données, utilisez les méthodes [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) et [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="6ccb0-128">To change the data format values specified for a data file, use the [IBCPSession::BCPColumns](ibcpsession-bcpcolumns-ole-db.md) and [IBCPSession::BCPColFmt](ibcpsession-bcpcolfmt-ole-db.md) methods.</span></span>  
  
 <span data-ttu-id="6ccb0-129">Les copies en bloc vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peuvent être optimisées pour les tables qui ne contiennent pas d’index en définissant l’option de base de données **select into/bulkcopy**.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-129">Bulk copies to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can be optimized for tables that do not contain indexes by setting the database option **select into/bulkcopy**.</span></span>  
  
## <a name="arguments"></a><span data-ttu-id="6ccb0-130">Arguments</span><span class="sxs-lookup"><span data-stu-id="6ccb0-130">Arguments</span></span>  
 <span data-ttu-id="6ccb0-131">*pwszTable*[in]</span><span class="sxs-lookup"><span data-stu-id="6ccb0-131">*pwszTable*[in]</span></span>  
 <span data-ttu-id="6ccb0-132">Nom de la table de base de données depuis ou vers laquelle s’effectue la copie.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-132">The name of the database table to be copied into or out of.</span></span> <span data-ttu-id="6ccb0-133">Le nom peut inclure le nom de la base de données ou le nom du propriétaire.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-133">The name can include the database name or the owner name.</span></span> <span data-ttu-id="6ccb0-134">Par exemple, « pubs.username.titles », « pubs..titles », « username.titles ».</span><span class="sxs-lookup"><span data-stu-id="6ccb0-134">For example, "pubs.username.titles", "pubs..titles", "username.titles".</span></span>  
  
 <span data-ttu-id="6ccb0-135">Si l'argument eDirection a la valeur BCP_DIRECTION_OUT, l'argument pwszTable peut être le nom d'une vue de base de données.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-135">If the eDirection argument is set to BCP_DIRECTION_OUT, the pwszTable argument can be the name of a database view.</span></span>  
  
 <span data-ttu-id="6ccb0-136">Si l’argument eDirection a la valeur BCP_DIRECTION_OUT et qu’une instruction SELECT est spécifiée à l’aide de la méthode **BCPControl** avant l’appel de la méthode **BCPExec**, l’argument *pwszTable* doit avoir la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-136">If the eDirection argument is set to BCP_DIRECTION_OUT and a SELECT statement is specified using the **BCPControl** method before the **BCPExec** method is called, the *pwszTable* argument must be set to NULL.</span></span>  
  
 <span data-ttu-id="6ccb0-137">*pwszDataFile*[in]</span><span class="sxs-lookup"><span data-stu-id="6ccb0-137">*pwszDataFile*[in]</span></span>  
 <span data-ttu-id="6ccb0-138">Nom du fichier utilisateur depuis ou vers lequel s’effectue la copie.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-138">The name of the user file to be copied into or out of.</span></span>  
  
 <span data-ttu-id="6ccb0-139">*pwszErrorFile*[in]</span><span class="sxs-lookup"><span data-stu-id="6ccb0-139">*pwszErrorFile*[in]</span></span>  
 <span data-ttu-id="6ccb0-140">Nom du fichier d'erreurs à remplir avec les messages de progression, les messages d'erreur et les copies des lignes qui n'ont pas pu être copiées d'un fichier utilisateur vers une table.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-140">The name of the error file to be filled with progress messages, error messages, and copies of any rows that could not be copied from a user file to a table.</span></span> <span data-ttu-id="6ccb0-141">Si l'argument *pwszErrorFile* a la valeur NULL, aucun fichier d'erreurs n'est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-141">If the *pwszErrorFile* argument is set to NULL, no error file is used.</span></span>  
  
 <span data-ttu-id="6ccb0-142">*eDirection*[in]</span><span class="sxs-lookup"><span data-stu-id="6ccb0-142">*eDirection*[in]</span></span>  
 <span data-ttu-id="6ccb0-143">Direction de l'opération de copie, BCP_DIRECTION_IN ou _OUT BCP_DIRECTION.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-143">The direction of the copy operation, either BCP_DIRECTION_IN or BCP_DIRECTION _OUT.</span></span> <span data-ttu-id="6ccb0-144">BCP_DIRECTION_IN indique une copie d'un fichier utilisateur vers une table de base de données ; BCP_DIRECTION_OUT indique une copie d'une table de base de données vers un fichier utilisateur.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-144">BCP_DIRECTION _IN indicates a copy from a user file to a database table; BCP_DIRECTION _OUT indicates a copy from a database table to a user file.</span></span>  
  
## <a name="return-code-values"></a><span data-ttu-id="6ccb0-145">Codet de retour</span><span class="sxs-lookup"><span data-stu-id="6ccb0-145">Return Code Values</span></span>  
 <span data-ttu-id="6ccb0-146">S_OK</span><span class="sxs-lookup"><span data-stu-id="6ccb0-146">S_OK</span></span>  
 <span data-ttu-id="6ccb0-147">S_OK</span><span class="sxs-lookup"><span data-stu-id="6ccb0-147">The method succeeded.</span></span>  
  
 <span data-ttu-id="6ccb0-148">E_FAIL</span><span class="sxs-lookup"><span data-stu-id="6ccb0-148">E_FAIL</span></span>  
 <span data-ttu-id="6ccb0-149">Une erreur spécifique au fournisseur s’est produite. pour obtenir des informations détaillées, utilisez l’interface [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) .</span><span class="sxs-lookup"><span data-stu-id="6ccb0-149">A provider specific error occurred' for detailed information, use the [ISQLServerErrorInfo](../../database-engine/dev-guide/isqlservererrorinfo-ole-db.md) interface.</span></span>  
  
 <span data-ttu-id="6ccb0-150">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="6ccb0-150">E_OUTOFMEMORY</span></span>  
 <span data-ttu-id="6ccb0-151">Erreur de mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-151">Out-of-memory error.</span></span>  
  
 <span data-ttu-id="6ccb0-152">E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="6ccb0-152">E_INVALIDARG</span></span>  
 <span data-ttu-id="6ccb0-153">Au moins un des arguments n'a pas été spécifié correctement.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-153">One or more of the arguments was not correctly specified.</span></span> <span data-ttu-id="6ccb0-154">Par exemple, un nom de fichier non valide a été donné.</span><span class="sxs-lookup"><span data-stu-id="6ccb0-154">For example, an invalid file name was given.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6ccb0-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6ccb0-155">See Also</span></span>  
 <span data-ttu-id="6ccb0-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="6ccb0-156">[IBCPSession &#40;OLE DB&#41;](ibcpsession-ole-db.md) </span></span>  
 [<span data-ttu-id="6ccb0-157">Exécution d'opérations de copie en bloc</span><span class="sxs-lookup"><span data-stu-id="6ccb0-157">Performing Bulk Copy Operations</span></span>](../native-client/features/performing-bulk-copy-operations.md)  
  
  
