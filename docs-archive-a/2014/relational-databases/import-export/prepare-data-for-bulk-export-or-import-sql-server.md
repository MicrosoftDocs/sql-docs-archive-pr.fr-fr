---
title: Préparer des données en vue d’une exportation ou d’une importation en bloc (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-movement
ms.topic: conceptual
helpviewer_keywords:
- bulk importing [SQL Server], planning
- bulk importing [SQL Server], from a CSV file
- data formats [SQL Server], planning operations
- CSV files [SQL Server]
- quoted fields in CSV files [SQL Server]
ms.assetid: 783fd581-2e5f-496b-b79c-d4de1e09ea30
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 4f2780a4eadfc27ed2db15881d676965fca81e35
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706532"
---
# <a name="prepare-data-for-bulk-export-or-import-sql-server"></a><span data-ttu-id="fc093-102">Préparer des données en vue d'une exportation ou d'une importation en bloc (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="fc093-102">Prepare Data for Bulk Export or Import (SQL Server)</span></span>
  <span data-ttu-id="fc093-103">Cette section présente les points à prendre en considération lors de la planification d'opérations d'exportation en bloc et les contraintes liées aux opérations d'importation en bloc.</span><span class="sxs-lookup"><span data-stu-id="fc093-103">This section discusses the considerations involved in planning for bulk-export operations and the requirements for bulk-import operations.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fc093-104">Si vous n'êtes pas certain de savoir mettre en forme un fichier de données pour une importation en bloc, utilisez l'utilitaire **bcp** pour exporter des données de la table dans un fichier de données.</span><span class="sxs-lookup"><span data-stu-id="fc093-104">If you are uncertain about how to format a data file for bulk importing, you can use the **bcp** utility to export data from the table into a data file.</span></span> <span data-ttu-id="fc093-105">La mise en forme de chaque champ de données dans ce fichier indique la mise en forme nécessaire pour importer des données en bloc dans la colonne de table correspondante.</span><span class="sxs-lookup"><span data-stu-id="fc093-105">The formatting of each data field in this file shows the formatting required to bulk import data into the corresponding table column.</span></span> <span data-ttu-id="fc093-106">Utilisez la même mise en forme des données pour les champs de votre fichier de données.</span><span class="sxs-lookup"><span data-stu-id="fc093-106">Use the same data formatting for fields of your data file.</span></span>  
  
## <a name="data-file-format-considerations-for-bulk-export"></a><span data-ttu-id="fc093-107">Considérations sur le format du fichier de données pour l'exportation en bloc</span><span class="sxs-lookup"><span data-stu-id="fc093-107">Data-File Format Considerations for Bulk Export</span></span>  
 <span data-ttu-id="fc093-108">Avant de réaliser une opération d’exportation en bloc à l’aide de la commande **bcp** , prenez en considération les points suivants :</span><span class="sxs-lookup"><span data-stu-id="fc093-108">Before you perform a bulk-export operation by using the **bcp** command, consider the following:</span></span>  
  
-   <span data-ttu-id="fc093-109">Lorsque des données sont exportées vers un fichier, la commande **bcp** crée automatiquement le fichier de données en utilisant le nom de fichier spécifié.</span><span class="sxs-lookup"><span data-stu-id="fc093-109">When data is exported to a file, the **bcp** command creates the data file automatically by using the specified file name.</span></span> <span data-ttu-id="fc093-110">Si ce nom de fichier est déjà utilisé, les données en cours de copie en bloc dans le fichier de données remplacent le contenu existant de ce fichier.</span><span class="sxs-lookup"><span data-stu-id="fc093-110">If that file name is already in use, the data that is being bulk copied to the data file overwrites the existing contents of the file.</span></span>  
  
-   <span data-ttu-id="fc093-111">L'exportation en bloc depuis une table ou une vue vers un fichier de données requiert l'existence d'une autorisation SELECT sur la table ou la vue qui fait l'objet d'une copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="fc093-111">Bulk export from a table or view to a data file requires SELECT permission on the table or view that is being bulk copied.</span></span>  
  
-   [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="fc093-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peut utiliser des analyses parallèles pour récupérer les données.</span><span class="sxs-lookup"><span data-stu-id="fc093-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can use parallel scans to retrieve data.</span></span> <span data-ttu-id="fc093-113">Par conséquent, il est possible que les lignes de la table exportées en bloc depuis une instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] n'apparaissent pas dans un ordre spécifique dans le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="fc093-113">Therefore, the table rows that are bulk exported in from an instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] are not ordinarily guaranteed to be in any specific order in the data file.</span></span> <span data-ttu-id="fc093-114">Pour que les lignes de la table exportées en bloc apparaissent dans un ordre spécifique dans le fichier de données, utilisez l'option **queryout** pour effectuer une exportation en bloc depuis une requête et spécifiez une clause ORDER BY.</span><span class="sxs-lookup"><span data-stu-id="fc093-114">To make sure that bulk-exported table rows appear in a specific order in the data file, use the **queryout** option to bulk export from a query, and specify an ORDER BY clause.</span></span>  
  
## <a name="data-file-format-requirements-for-bulk-import"></a><span data-ttu-id="fc093-115">Contraintes liées au format du fichier de données pour l'importation en bloc</span><span class="sxs-lookup"><span data-stu-id="fc093-115">Data-File Format Requirements for Bulk Import</span></span>  
 <span data-ttu-id="fc093-116">Pour que les données puissent être importées depuis un fichier de données, celui-ci doit satisfaire aux conditions de base suivantes :</span><span class="sxs-lookup"><span data-stu-id="fc093-116">To import data from a data file, the file must meet the following basic requirements:</span></span>  
  
-   <span data-ttu-id="fc093-117">Les données doivent être organisées en lignes et en colonnes.</span><span class="sxs-lookup"><span data-stu-id="fc093-117">The data must be in row and column format.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fc093-118">La structure du fichier de données n'a pas besoin d'être identique à la structure de la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , car les colonnes peuvent être ignorées ou réorganisées lors de l'importation en bloc.</span><span class="sxs-lookup"><span data-stu-id="fc093-118">The structure of the data file does not need to be identical to the structure of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table because columns can be skipped or reordered during the bulk-import process.</span></span>  
  
-   <span data-ttu-id="fc093-119">Le format des données du fichier de données doit être un format pris en charge, par exemple le format caractère ou le format natif.</span><span class="sxs-lookup"><span data-stu-id="fc093-119">The data in the data file must be in a supported format such as character or native format.</span></span>  
  
-   <span data-ttu-id="fc093-120">Le format des données peut être le format binaire natif ou caractère, notamment le format Unicode.</span><span class="sxs-lookup"><span data-stu-id="fc093-120">The data can be in character or native binary format including Unicode.</span></span>  
  
-   <span data-ttu-id="fc093-121">Pour que vous puissiez importer des données à l’aide d’une commande **bcp** d’une instruction BULK INSERT ou d’une instruction INSERT... SELECT \* FROM OPENROWSET(BULK...), la table de destination doit déjà exister.</span><span class="sxs-lookup"><span data-stu-id="fc093-121">To import data by using a **bcp** command, BULK INSERT statement, or INSERT ... SELECT \* FROM OPENROWSET(BULK...) statement, the destination table must already exist.</span></span>  
  
-   <span data-ttu-id="fc093-122">Chaque champ du fichier de données doit être compatible avec la colonne correspondante de la table cible.</span><span class="sxs-lookup"><span data-stu-id="fc093-122">Each field in the data file must be compatible with the corresponding column in the target table.</span></span> <span data-ttu-id="fc093-123">Par exemple, un champ `int` ne peut pas être chargé dans une colonne `datetime`.</span><span class="sxs-lookup"><span data-stu-id="fc093-123">For example, an `int` field cannot be loaded into a `datetime` column.</span></span> <span data-ttu-id="fc093-124">Pour plus d’informations, consultez [Formats de données pour l’importation ou l’exportation en bloc &#40;SQL Server&#41;](data-formats-for-bulk-import-or-bulk-export-sql-server.md) et [Spécifier des formats de données pour la compatibilité lors de l’utilisation de bcp &#40;SQL Server&#41;](specify-data-formats-for-compatibility-when-using-bcp-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="fc093-124">For more information, see [Data Formats for Bulk Import or Bulk Export &#40;SQL Server&#41;](data-formats-for-bulk-import-or-bulk-export-sql-server.md) and [Specify Data Formats for Compatibility when Using bcp &#40;SQL Server&#41;](specify-data-formats-for-compatibility-when-using-bcp-sql-server.md).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="fc093-125">Pour spécifier un sous-ensemble de lignes d’un fichier de données à importer au lieu du fichier tout entier, vous pouvez utiliser une commande **bcp** avec le commutateur **-F** *first_row* et/ou le commutateur **-L** *last_row*.</span><span class="sxs-lookup"><span data-stu-id="fc093-125">To specify a subset of rows to import from a data file rather than the entire file, you can use a **bcp** command with the **-F** *first_row* switch and/or **-L** *last_row* switch.</span></span> <span data-ttu-id="fc093-126">Pour plus d’informations, consultez [bcp Utility](../../tools/bcp-utility.md).</span><span class="sxs-lookup"><span data-stu-id="fc093-126">For more information, see [bcp Utility](../../tools/bcp-utility.md).</span></span>  
  
-   <span data-ttu-id="fc093-127">Pour importer des données à partir de fichiers de données contenant des champs de longueur fixe ou de largeur fixe, utilisez un fichier de format.</span><span class="sxs-lookup"><span data-stu-id="fc093-127">To import data from data files with fixed-length or fixed-width fields, you must use a format file.</span></span> <span data-ttu-id="fc093-128">Pour plus d’informations, consultez [Fichiers de format XML &#40;SQL Server&#41;](xml-format-files-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="fc093-128">For more information, see [XML Format Files &#40;SQL Server&#41;](xml-format-files-sql-server.md).</span></span>  
  
-   <span data-ttu-id="fc093-129">Les fichiers de valeurs séparées par des virgules (CSV, Comma-Separated Value) ne sont pas pris en charge par les opérations d'importation en bloc [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fc093-129">Comma-separated value (CSV) files are not supported by [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-import operations.</span></span> <span data-ttu-id="fc093-130">Toutefois, dans certains cas, un fichier CSV peut être utilisé comme fichier de données pour une importation en bloc de données dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fc093-130">However, in some cases, a CSV file can be used as the data file for a bulk import of data into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="fc093-131">Notez que la marque de fin de champ d'un fichier CSV n'est pas nécessairement une virgule.</span><span class="sxs-lookup"><span data-stu-id="fc093-131">Note that the field terminator of a CSV file does not have to be a comma.</span></span> <span data-ttu-id="fc093-132">Pour être utilisable comme fichier de données pour une importation en bloc, un fichier CSV doit être conforme aux restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="fc093-132">To be usable as a data file for bulk import, a CSV file must comply with the following restrictions:</span></span>  
  
    -   <span data-ttu-id="fc093-133">Les champs de données ne contiennent jamais la marque de fin de champ.</span><span class="sxs-lookup"><span data-stu-id="fc093-133">Data fields never contain the field terminator.</span></span>  
  
    -   <span data-ttu-id="fc093-134">Soit toutes les valeurs d'un champ de données sont placées entre guillemets (""), soit aucune de ces valeurs n'est placée entre guillemets.</span><span class="sxs-lookup"><span data-stu-id="fc093-134">Either none or all of the values in a data field are enclosed in quotation marks ("").</span></span>  
  
     <span data-ttu-id="fc093-135">Pour effectuer une importation en bloc des données d'un fichier de table [!INCLUDE[msCoName](../../includes/msconame-md.md)] FoxPro ou Visual FoxPro (.dbf) ou d'un fichier de feuille de calcul [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] (.xls), vous devez convertir les données en un fichier CSV conforme aux limitations décrites précédemment.</span><span class="sxs-lookup"><span data-stu-id="fc093-135">To bulk import data from a [!INCLUDE[msCoName](../../includes/msconame-md.md)] FoxPro or Visual FoxPro table (.dbf) file or a [!INCLUDE[ofprexcel](../../includes/ofprexcel-md.md)] worksheet (.xls) file, you would need to convert the data into a CSV file that complies to the preceding restrictions.</span></span> <span data-ttu-id="fc093-136">L'extension de fichier est en général .csv.</span><span class="sxs-lookup"><span data-stu-id="fc093-136">The file extension will typically be .csv.</span></span> <span data-ttu-id="fc093-137">Vous pouvez alors utiliser ce fichier .csv comme fichier de données dans une opération d'importation en bloc [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="fc093-137">You can then use the .csv file as a data file in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] bulk-import operation.</span></span>  
  
     <span data-ttu-id="fc093-138">Sur les systèmes 32 bits, il est possible d’importer des données CSV dans une table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sans optimisation de l’importation en bloc en utilisant [OPENROWSET](/sql/t-sql/functions/openrowset-transact-sql) avec le fournisseur OLE DB pour Jet.</span><span class="sxs-lookup"><span data-stu-id="fc093-138">On 32-bit systems, it is possible to import CSV data into a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table without bulk-import optimizations by using [OPENROWSET](/sql/t-sql/functions/openrowset-transact-sql) with the OLE DB Provider for Jet.</span></span> <span data-ttu-id="fc093-139">Jet traite les fichiers texte comme des tables, à l'aide du schéma défini par un fichier schema.ini situé dans le même répertoire que la source de données.</span><span class="sxs-lookup"><span data-stu-id="fc093-139">Jet treats text files as tables, with the schema defined by a schema.ini file that is located in the same directory as the data source.</span></span>  <span data-ttu-id="fc093-140">Pour des données CSV, l'un des paramètres du fichier schema.ini doit être « FORMAT=CSVDelimited ».</span><span class="sxs-lookup"><span data-stu-id="fc093-140">For a CSV data, one of the parameters in the schema.ini file would be "FORMAT=CSVDelimited".</span></span> <span data-ttu-id="fc093-141">Pour utiliser cette solution, vous devez comprendre le fonctionnement de Jet Text IISAM (syntaxe de sa chaîne de connexion, utilisation de schema.ini, options de configuration du Registre, etc.).</span><span class="sxs-lookup"><span data-stu-id="fc093-141">To use this solution, you would need to understand how the Jet Test IISAMm operations-its connection string syntax, schema.ini usage, registry setting options, and so on).</span></span>  <span data-ttu-id="fc093-142">Les meilleures sources d'informations sont l'Aide de Microsoft Access et les articles de la Base de connaissances.</span><span class="sxs-lookup"><span data-stu-id="fc093-142">The best sources of this information are Microsoft Access Help and Knowledge Base (KB) articles.</span></span> <span data-ttu-id="fc093-143">Pour plus d’informations, consultez [Initialisation du pilote de source de données texte](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/initializing-the-text-data-source-driver), [Comment utiliser une requête distribuée de SQL Server 7.0 avec un serveur lié aux bases de données Access sécurisés](https://go.microsoft.com/fwlink/?LinkId=128504), [Procédure : utiliser le fournisseur Jet OLE DB 4.0 pour se connecter aux bases de données ISAM](https://go.microsoft.com/fwlink/?LinkId=128505), et [Comment ouvrir des fichiers texte délimités à l’aide de Text IIsam du fournisseur Jet](https://go.microsoft.com/fwlink/?LinkId=128501).</span><span class="sxs-lookup"><span data-stu-id="fc093-143">For more information, see [Initializing the Text Data Source Driver](https://docs.microsoft.com/office/client-developer/access/desktop-database-reference/initializing-the-text-data-source-driver), [How To Use a SQL Server 7.0 Distributed Query with a Linked Server to Secured Access Databases](https://go.microsoft.com/fwlink/?LinkId=128504), [HOW TO: Use Jet OLE DB Provider 4.0 to Connect to ISAM Databases](https://go.microsoft.com/fwlink/?LinkId=128505), and [How To Open Delimited Text Files Using the Jet Provider's Text IIsam](https://go.microsoft.com/fwlink/?LinkId=128501).</span></span>  
  
 <span data-ttu-id="fc093-144">En outre, l'importation en bloc de données depuis un fichier de données vers une table requiert le respect des points suivants :</span><span class="sxs-lookup"><span data-stu-id="fc093-144">In addition, the bulk import of data from a data file into a table requires the following:</span></span>  
  
-   <span data-ttu-id="fc093-145">Les utilisateurs doivent disposer des autorisations INSERT et SELECT sur la table.</span><span class="sxs-lookup"><span data-stu-id="fc093-145">Users must have INSERT and SELECT permissions on the table.</span></span> <span data-ttu-id="fc093-146">Les utilisateurs ont également besoin de l'autorisation ALTER TABLE lorsqu'ils utilisent des options qui impliquent des opérations DDL (Data Definition Language), par exemple la désactivation de contraintes.</span><span class="sxs-lookup"><span data-stu-id="fc093-146">Users also need ALTER TABLE permission when they use options that require data definition language (DDL) operations, such as disabling constraints.</span></span>  
  
-   <span data-ttu-id="fc093-147">Lorsque vous importez en bloc des données à l'aide de l'instruction BULK INSERT ou INSERT ... SELECT \* FROM OPENROWSET(BULK...), le fichier de données doit être accessible pour les opérations de lecture par le profil de sécurité du processus [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (si l’utilisateur se connecte à l’aide de la connexion fournie par [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]) ou de la connexion [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows utilisée dans le cadre d’une sécurité déléguée.</span><span class="sxs-lookup"><span data-stu-id="fc093-147">When you bulk import data by using BULK INSERT or INSERT ... SELECT \* FROM OPENROWSET(BULK...), the data file must be accessible for read operations by either the security profile of the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] process (if the user logs in using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provided login) or by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows login that is used under delegated security.</span></span> <span data-ttu-id="fc093-148">En outre, l'utilisateur doit disposer de l'autorisation ADMINISTER BULK OPERATIONS pour lire le fichier.</span><span class="sxs-lookup"><span data-stu-id="fc093-148">Additionally, the user must have ADMINISTER BULK OPERATIONS permission to read the file.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fc093-149">L'importation en bloc dans une vue partitionnée n'est pas prise en charge et toute tentative en ce sens est vouée à l'échec.</span><span class="sxs-lookup"><span data-stu-id="fc093-149">Bulk importing into a partitioned view is unsupported, and attempts to bulk import data into a partitioned view fail.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="fc093-150">Ressources externes</span><span class="sxs-lookup"><span data-stu-id="fc093-150">External Resources</span></span>  
 [<span data-ttu-id="fc093-151">Comment importer des données d'Excel vers SQL Server</span><span class="sxs-lookup"><span data-stu-id="fc093-151">How to import data from Excel to SQL Server</span></span>](https://support.microsoft.com/kb/321686)  
  
## <a name="change-history"></a><span data-ttu-id="fc093-152">Historique des modifications</span><span class="sxs-lookup"><span data-stu-id="fc093-152">Change History</span></span>  
  
|<span data-ttu-id="fc093-153">Mise à jour du contenu</span><span class="sxs-lookup"><span data-stu-id="fc093-153">Updated content</span></span>|  
|---------------------|  
|<span data-ttu-id="fc093-154">Ajout d'informations sur l'utilisation du fournisseur OLE DB pour Jet afin d'importer des données CSV.</span><span class="sxs-lookup"><span data-stu-id="fc093-154">Added information about using the OLE DB Provider for Jet to import CSV data.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="fc093-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fc093-155">See Also</span></span>  
 <span data-ttu-id="fc093-156">[Utilitaire bcp](../../tools/bcp-utility.md) </span><span class="sxs-lookup"><span data-stu-id="fc093-156">[bcp Utility](../../tools/bcp-utility.md) </span></span>  
 <span data-ttu-id="fc093-157">[BULK INSERT &#40;Transact-SQL&#41;](/sql/t-sql/statements/bulk-insert-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="fc093-157">[BULK INSERT &#40;Transact-SQL&#41;](/sql/t-sql/statements/bulk-insert-transact-sql) </span></span>  
 <span data-ttu-id="fc093-158">[Types de données &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="fc093-158">[Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) </span></span>  
 <span data-ttu-id="fc093-159">[Utiliser le format caractère pour importer ou exporter des données &#40;SQL Server&#41;](use-character-format-to-import-or-export-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="fc093-159">[Use Character Format to Import or Export Data &#40;SQL Server&#41;](use-character-format-to-import-or-export-data-sql-server.md) </span></span>  
 [<span data-ttu-id="fc093-160">Utiliser le format natif pour importer ou exporter des données &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="fc093-160">Use Native Format to Import or Export Data &#40;SQL Server&#41;</span></span>](use-native-format-to-import-or-export-data-sql-server.md)  
  
  
