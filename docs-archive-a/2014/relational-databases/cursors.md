---
title: Curseurs | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- results [SQL Server], cursors
- Transact-SQL cursors, about cursors
- cursors [SQL Server]
- data access [SQL Server], cursors
- result sets [SQL Server], cursors
- requesting cursors
- cursors [SQL Server], about cursors
ms.assetid: e668b40c-bd4d-4415-850d-20fc4872ee72
author: rothja
ms.author: jroth
ms.openlocfilehash: 055482a8cf64527f58ed983b449121a99960f566
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87614638"
---
# <a name="cursors"></a><span data-ttu-id="19681-102">Curseurs</span><span class="sxs-lookup"><span data-stu-id="19681-102">Cursors</span></span>
  <span data-ttu-id="19681-103">Les opérations réalisées dans une base de données relationnelle s'exécutent sur un ensemble complet de lignes.</span><span class="sxs-lookup"><span data-stu-id="19681-103">Operations in a relational database act on a complete set of rows.</span></span> <span data-ttu-id="19681-104">Par exemple, l'ensemble de lignes retourné par une instruction SELECT contient toutes les lignes satisfaisant aux conditions de la clause WHERE de l'instruction.</span><span class="sxs-lookup"><span data-stu-id="19681-104">For example, the set of rows returned by a SELECT statement consists of all the rows that satisfy the conditions in the WHERE clause of the statement.</span></span> <span data-ttu-id="19681-105">Cet ensemble complet de lignes retournées par l'instruction est appelé ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-105">This complete set of rows returned by the statement is known as the result set.</span></span> <span data-ttu-id="19681-106">Les applications, en particulier les applications interactives en ligne, peuvent ne pas toujours fonctionner efficacement si l'ensemble de résultats est traité comme une unité.</span><span class="sxs-lookup"><span data-stu-id="19681-106">Applications, especially interactive online applications, cannot always work effectively with the entire result set as a unit.</span></span> <span data-ttu-id="19681-107">Ces applications ont besoin d'un mécanisme leur permettant de travailler avec une seule ligne ou avec un petit bloc de lignes à la fois.</span><span class="sxs-lookup"><span data-stu-id="19681-107">These applications need a mechanism to work with one row or a small block of rows at a time.</span></span> <span data-ttu-id="19681-108">Les curseurs sont une extension des ensembles de résultats et fournissent ce mécanisme.</span><span class="sxs-lookup"><span data-stu-id="19681-108">Cursors are an extension to result sets that provide that mechanism.</span></span>  
  
 <span data-ttu-id="19681-109">Les curseurs permettent l'extension du traitement des résultats en procédant aux opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="19681-109">Cursors extend result processing by:</span></span>  
  
-   <span data-ttu-id="19681-110">Ils permettent de vous positionner sur des lignes spécifiques de l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-110">Allowing positioning at specific rows of the result set.</span></span>  
  
-   <span data-ttu-id="19681-111">Ils extraient une ligne ou un bloc de lignes à partir de la position actuelle dans l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-111">Retrieving one row or block of rows from the current position in the result set.</span></span>  
  
-   <span data-ttu-id="19681-112">Ils prennent en charge les modifications de données apportées aux lignes à la position actuelle dans l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-112">Supporting data modifications to the rows at the current position in the result set.</span></span>  
  
-   <span data-ttu-id="19681-113">Ils prennent en charge différents niveaux de visibilité des modifications apportées par d'autres utilisateurs aux données de la base de données qui figurent dans l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-113">Supporting different levels of visibility to changes made by other users to the database data that is presented in the result set.</span></span>  
  
-   <span data-ttu-id="19681-114">Ils permettent aux instructions [!INCLUDE[tsql](../includes/tsql-md.md)] figurant dans les scripts, les procédures stockées et les déclencheurs d'accéder aux données d'un ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-114">Providing [!INCLUDE[tsql](../includes/tsql-md.md)] statements in scripts, stored procedures, and triggers access to the data in a result set.</span></span>  
  
## <a name="concepts"></a><span data-ttu-id="19681-115">Concepts</span><span class="sxs-lookup"><span data-stu-id="19681-115">Concepts</span></span>  
 <span data-ttu-id="19681-116">Implémentations des curseurs</span><span class="sxs-lookup"><span data-stu-id="19681-116">Cursor Implementations</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="19681-117">prend en charge trois implémentations de curseurs.</span><span class="sxs-lookup"><span data-stu-id="19681-117">supports three cursor implementations.</span></span>  
  
 <span data-ttu-id="19681-118">curseurs Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="19681-118">Transact-SQL cursors</span></span>  
 <span data-ttu-id="19681-119">Ces curseurs basés sur la syntaxe DECLARE CURSOR sont utilisés principalement dans les déclencheurs, les procédures stockées et les scripts [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19681-119">Are based on the DECLARE CURSOR syntax and are used mainly in [!INCLUDE[tsql](../includes/tsql-md.md)] scripts, stored procedures, and triggers.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="19681-120">Les curseurs sont implémentés sur le serveur et sont gérés par des instructions [!INCLUDE[tsql](../includes/tsql-md.md)] envoyées du client au serveur.</span><span class="sxs-lookup"><span data-stu-id="19681-120">cursors are implemented on the server and are managed by [!INCLUDE[tsql](../includes/tsql-md.md)] statements sent from the client to the server.</span></span> <span data-ttu-id="19681-121">Ils peuvent également être contenus dans des traitements, des procédures stockées ou des déclencheurs.</span><span class="sxs-lookup"><span data-stu-id="19681-121">They may also be contained in batches, stored procedures, or triggers.</span></span>  
  
 <span data-ttu-id="19681-122">Curseurs de serveur d'API (Application Programming Interface)</span><span class="sxs-lookup"><span data-stu-id="19681-122">Application programming interface (API) server cursors</span></span>  
 <span data-ttu-id="19681-123">Ces curseurs prennent en charge les fonctions de curseur d'API comme OLE DB et ODBC.</span><span class="sxs-lookup"><span data-stu-id="19681-123">Support the API cursor functions in OLE DB and ODBC.</span></span> <span data-ttu-id="19681-124">Les curseurs de serveur d'API sont implémentés sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="19681-124">API server cursors are implemented on the server.</span></span> <span data-ttu-id="19681-125">Chaque fois qu’une application cliente appelle une fonction de curseur d’API, le fournisseur OLE DB de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ou le pilote ODBC transmet la demande au serveur afin d’appliquer une action au curseur côté serveur d’API.</span><span class="sxs-lookup"><span data-stu-id="19681-125">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client OLE DB provider or ODBC driver transmits the request to the server for action against the API server cursor.</span></span>  
  
 <span data-ttu-id="19681-126">Curseurs clients</span><span class="sxs-lookup"><span data-stu-id="19681-126">Client cursors</span></span>  
 <span data-ttu-id="19681-127">Ces curseurs sont implémentés en interne par le pilote ODBC [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client et par la DLL qui implémente l’API ADO.</span><span class="sxs-lookup"><span data-stu-id="19681-127">Are implemented internally by the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver and by the DLL that implements the ADO API.</span></span> <span data-ttu-id="19681-128">Les curseurs clients sont implémentés par la mise en mémoire cache sur le client de toutes les lignes de l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-128">Client cursors are implemented by caching all the result set rows on the client.</span></span> <span data-ttu-id="19681-129">Chaque fois qu’une application cliente appelle une fonction de curseur d’API, le pilote ODBC de [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ou la DLL ADO exécute l’opération de curseur sur les lignes du jeu de résultats mises en cache sur le client.</span><span class="sxs-lookup"><span data-stu-id="19681-129">Each time a client application calls an API cursor function, the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] Native Client ODBC driver or the ADO DLL performs the cursor operation on the result set rows cached on the client.</span></span>  
  
 <span data-ttu-id="19681-130">Type de curseur</span><span class="sxs-lookup"><span data-stu-id="19681-130">Type of Cursors</span></span>  
 <span data-ttu-id="19681-131">Curseur avant uniquement</span><span class="sxs-lookup"><span data-stu-id="19681-131">Forward-only</span></span>  
 <span data-ttu-id="19681-132">Un curseur avant uniquement ne prend pas en charge le défilement mais seulement l'extraction de lignes en séquence à partir du début jusqu'à la fin du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-132">A forward-only cursor does not support scrolling; it supports only fetching the rows serially from the start to the end of the cursor.</span></span> <span data-ttu-id="19681-133">Les lignes ne sont pas sorties de la base de données tant qu'elles n'ont pas été extraites.</span><span class="sxs-lookup"><span data-stu-id="19681-133">The rows are not retrieved from the database until they are fetched.</span></span> <span data-ttu-id="19681-134">Les effets de toutes les instructions INSERT, UPDATE et DELETE émises par l'utilisateur actuel ou validées par d'autres utilisateurs et ayant une incidence sur les lignes du jeu de résultats sont visibles au fur et à mesure que les lignes sont extraites du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-134">The effects of all INSERT, UPDATE, and DELETE statements made by the current user or committed by other users that affect rows in the result set are visible as the rows are fetched from the cursor.</span></span>  
  
 <span data-ttu-id="19681-135">Étant donné que le curseur ne permet pas le défilement arrière, la plupart des modifications apportées aux lignes de la base de données après l'extraction d'une ligne ne sont pas visibles par le biais du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-135">Because the cursor cannot be scrolled backward, most changes made to rows in the database after the row was fetched are not visible through the cursor.</span></span> <span data-ttu-id="19681-136">En revanche, si une valeur utilisée pour déterminer l'emplacement de la ligne dans le jeu de résultats est modifiée, par exemple dans le cas de la mise à jour d'une colonne couverte par un index cluster, la valeur modifiée est visible à l'aide du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-136">In cases where a value used to determine the location of the row within the result set is modified, such as updating a column covered by a clustered index, the modified value is visible through the cursor.</span></span>  
  
 <span data-ttu-id="19681-137">Les modèles de curseur d'API de base de données considèrent un curseur avant uniquement comme un type distinct de curseur, contrairement à [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19681-137">Although the database API cursor models consider a forward-only cursor to be a distinct type of cursor, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] does not.</span></span> [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="19681-138">prend en compte les curseurs avant uniquement et de défilement en tant qu’options pouvant être appliquées aux curseurs statiques, de jeu de clés et dynamiques.</span><span class="sxs-lookup"><span data-stu-id="19681-138">considers both forward-only and scroll as options that can be applied to static, keyset-driven, and dynamic cursors.</span></span> [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="19681-139">Les curseurs prennent en charge les curseurs avant uniquement, statiques, de jeu de clés et dynamiques.</span><span class="sxs-lookup"><span data-stu-id="19681-139">cursors support forward-only static, keyset-driven, and dynamic cursors.</span></span> <span data-ttu-id="19681-140">Les modèles de curseurs d'API de bases de données supposent que les curseurs statiques, de jeux de clés et dynamiques permettent toujours le défilement.</span><span class="sxs-lookup"><span data-stu-id="19681-140">The database API cursor models assume that static, keyset-driven, and dynamic cursors are always scrollable.</span></span> <span data-ttu-id="19681-141">Lorsqu'un attribut ou une propriété de curseur d'API de bases de données est défini comme étant de type avant uniquement, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implémente ce curseur en tant que curseur dynamique avant uniquement.</span><span class="sxs-lookup"><span data-stu-id="19681-141">When a database API cursor attribute or property is set to forward-only, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] implements this as a forward-only dynamic cursor.</span></span>  
  
 <span data-ttu-id="19681-142">statique</span><span class="sxs-lookup"><span data-stu-id="19681-142">Static</span></span>  
 <span data-ttu-id="19681-143">Le jeu de résultats complet d’un curseur statique est créé dans **tempdb** à l’ouverture du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-143">The complete result set of a static cursor is built in **tempdb** when the cursor is opened.</span></span> <span data-ttu-id="19681-144">Un curseur statique affiche toujours l'ensemble de résultats tel qu'il était au moment où le curseur a été ouvert.</span><span class="sxs-lookup"><span data-stu-id="19681-144">A static cursor always displays the result set as it was when the cursor was opened.</span></span> <span data-ttu-id="19681-145">Les curseurs statiques détectent peu ou pas de modifications, mais consomment relativement peu de ressources pendant le défilement.</span><span class="sxs-lookup"><span data-stu-id="19681-145">Static cursors detect few or no changes, but consume relatively few resources while scrolling.</span></span>  
  
 <span data-ttu-id="19681-146">Le curseur ne reflète pas les modifications de la base de données qui concernent soit l'appartenance de l'ensemble de résultats, soit les modifications apportées aux valeurs des colonnes des lignes constituant l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-146">The cursor does not reflect any changes made in the database that affect either the membership of the result set or changes to the values in the columns of the rows that make up the result set.</span></span> <span data-ttu-id="19681-147">Après son ouverture, un curseur statique n'affiche pas les nouvelles lignes insérées dans la base de données, même si celles-ci correspondent aux conditions de recherche de l'instruction SELECT du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-147">A static cursor does not display new rows inserted in the database after the cursor was opened, even if they match the search conditions of the cursor SELECT statement.</span></span> <span data-ttu-id="19681-148">Si certaines lignes constituant l'ensemble de résultats sont mises à jour par d'autres utilisateurs, les nouvelles valeurs des données ne sont pas affichées dans le curseur statique.</span><span class="sxs-lookup"><span data-stu-id="19681-148">If rows making up the result set are updated by other users, the new data values are not displayed in the static cursor.</span></span> <span data-ttu-id="19681-149">Le curseur statique affiche les lignes supprimées de la base de données après l'ouverture du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-149">The static cursor displays rows deleted from the database after the cursor was opened.</span></span> <span data-ttu-id="19681-150">Aucune opération UPDATE, INSERT ou DELETE n'est reflétée dans un curseur statique (à moins qu'il ne soit fermé, puis rouvert), ni aucune modification effectuée à l'aide de la même connexion ayant permis l'ouverture du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-150">No UPDATE, INSERT, or DELETE operations are reflected in a static cursor (unless the cursor is closed and reopened), not even modifications made using the same connection that opened the cursor.</span></span>  
  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="19681-151">Les curseurs statiques sont toujours en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="19681-151">static cursors are always read-only.</span></span>  
  
 <span data-ttu-id="19681-152">Étant donné que l’ensemble de résultats d’un curseur statique est stocké dans une table de travail de la base de données **tempdb**, la taille des lignes de l’ensemble de résultats ne peut pas dépasser la taille des lignes maximale d’une table [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19681-152">Because the result set of a static cursor is stored in a work table in **tempdb**, the size of the rows in the result set cannot exceed the maximum row size for a [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] table.</span></span>  
  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="19681-153">utilise le terme INSENSITIVE pour désigner les curseurs statiques.</span><span class="sxs-lookup"><span data-stu-id="19681-153">uses the term insensitive for static cursors.</span></span> <span data-ttu-id="19681-154">Certaines API de bases de données les appellent curseurs d'instantané.</span><span class="sxs-lookup"><span data-stu-id="19681-154">Some database APIs identify them as snapshot cursors.</span></span>  
  
 <span data-ttu-id="19681-155">Keyset</span><span class="sxs-lookup"><span data-stu-id="19681-155">Keyset</span></span>  
 <span data-ttu-id="19681-156">L'appartenance et l'ordre des lignes d'un curseur de jeu de clés sont fixés au moment de l'ouverture du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-156">The membership and order of rows in a keyset-driven cursor are fixed when the cursor is opened.</span></span> <span data-ttu-id="19681-157">Les curseurs de jeux de clés sont gérés par un ensemble d'identificateurs uniques (clés) appelé jeu de clés.</span><span class="sxs-lookup"><span data-stu-id="19681-157">Keyset-driven cursors are controlled by a set of unique identifiers, keys, known as the keyset.</span></span> <span data-ttu-id="19681-158">Les clés sont créées à partir d'un ensemble de colonnes qui identifient uniquement les lignes de l'ensemble de résultats.</span><span class="sxs-lookup"><span data-stu-id="19681-158">The keys are built from a set of columns that uniquely identify the rows in the result set.</span></span> <span data-ttu-id="19681-159">Le jeu de clés est l'ensemble des valeurs des clés de toutes les lignes remplissant les conditions requises par l'instruction SELECT au moment où le curseur a été ouvert.</span><span class="sxs-lookup"><span data-stu-id="19681-159">The keyset is the set of the key values from all the rows that qualified for the SELECT statement at the time the cursor was opened.</span></span> <span data-ttu-id="19681-160">Le jeu de clés d’un curseur de jeux de clés est créé dans **tempdb** au moment de l’ouverture du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-160">The keyset for a keyset-driven cursor is built in **tempdb** when the cursor is opened.</span></span>  
  
 <span data-ttu-id="19681-161">Dynamique</span><span class="sxs-lookup"><span data-stu-id="19681-161">Dynamic</span></span>  
 <span data-ttu-id="19681-162">Les curseurs dynamiques sont le contraire des curseurs statiques.</span><span class="sxs-lookup"><span data-stu-id="19681-162">Dynamic cursors are the opposite of static cursors.</span></span> <span data-ttu-id="19681-163">Les curseurs dynamiques reflètent toutes les modifications apportées aux lignes de leur jeu de résultats lorsque vous les parcourez.</span><span class="sxs-lookup"><span data-stu-id="19681-163">Dynamic cursors reflect all changes made to the rows in their result set when scrolling through the cursor.</span></span> <span data-ttu-id="19681-164">Les valeurs des données, l'ordre et l'appartenance des lignes du jeu de résultats peuvent changer à chaque extraction.</span><span class="sxs-lookup"><span data-stu-id="19681-164">The data values, order, and membership of the rows in the result set can change on each fetch.</span></span> <span data-ttu-id="19681-165">Toutes les instructions UPDATE, INSERT et DELETE émises par l'ensemble des utilisateurs sont visibles à l'aide du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-165">All UPDATE, INSERT, and DELETE statements made by all users are visible through the cursor.</span></span> <span data-ttu-id="19681-166">Les mises à jour sont visibles immédiatement si elles ont été effectuées à l’aide du curseur, soit au moyen d’une fonction API telle que **SQLSetPos** , soit au moyen de la clause WHERE CURRENT OF [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19681-166">Updates are visible immediately if they are made through the cursor using either an API function such as **SQLSetPos** or the [!INCLUDE[tsql](../includes/tsql-md.md)] WHERE CURRENT OF clause.</span></span> <span data-ttu-id="19681-167">Les mises à jour effectuées en dehors du curseur ne sont pas visibles tant qu'elles n'ont pas été validées, à moins que le niveau d'isolement d'une transaction de curseur soit paramétré pour permettre la lecture des données non validées.</span><span class="sxs-lookup"><span data-stu-id="19681-167">Updates made outside the cursor are not visible until they are committed, unless the cursor transaction isolation level is set to read uncommitted.</span></span> <span data-ttu-id="19681-168">Les plans de curseur dynamique n'utilisent jamais d'index spatiaux.</span><span class="sxs-lookup"><span data-stu-id="19681-168">Dynamic cursor plans never use spatial indexes.</span></span>  
  
## <a name="requesting-a-cursor"></a><span data-ttu-id="19681-169">Demande de curseur</span><span class="sxs-lookup"><span data-stu-id="19681-169">Requesting a Cursor</span></span>  
 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="19681-170">prend en charge deux méthodes de demande de curseur :</span><span class="sxs-lookup"><span data-stu-id="19681-170">supports two methods for requesting a cursor:</span></span>  
  
-   [!INCLUDE[tsql](../includes/tsql-md.md)]  
  
     <span data-ttu-id="19681-171">Le langage [!INCLUDE[tsql](../includes/tsql-md.md)] prend en charge une syntaxe permettant l'utilisation de curseurs modélisés d'après la syntaxe de curseur ISO.</span><span class="sxs-lookup"><span data-stu-id="19681-171">The [!INCLUDE[tsql](../includes/tsql-md.md)] language supports a syntax for using cursors modeled after the ISO cursor syntax.</span></span>  
  
-   <span data-ttu-id="19681-172">Fonctions de curseur de l'interface de programmation d'application (API) de bases de données</span><span class="sxs-lookup"><span data-stu-id="19681-172">Database application programming interface (API) cursor functions</span></span>  
  
     [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] <span data-ttu-id="19681-173">prend en charge la fonctionnalité de curseur des API des bases de données suivantes :</span><span class="sxs-lookup"><span data-stu-id="19681-173">supports the cursor functionality of these database APIs:</span></span>  
  
    -   <span data-ttu-id="19681-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span><span class="sxs-lookup"><span data-stu-id="19681-174">ADO ([!INCLUDE[msCoName](../includes/msconame-md.md)] ActiveX Data Object)</span></span>  
  
    -   <span data-ttu-id="19681-175">OLE DB</span><span class="sxs-lookup"><span data-stu-id="19681-175">OLE DB</span></span>  
  
    -   <span data-ttu-id="19681-176">ODBC (Open Database Connectivity)</span><span class="sxs-lookup"><span data-stu-id="19681-176">ODBC (Open Database Connectivity)</span></span>  
  
 <span data-ttu-id="19681-177">Une application ne doit jamais combiner ces deux méthodes de demande de curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-177">An application should never mix these two methods of requesting a cursor.</span></span> <span data-ttu-id="19681-178">Une application ayant utilisé l'API pour spécifier des comportements de curseur ne doit pas ensuite exécuter une instruction [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR pour demander aussi un curseur [!INCLUDE[tsql](../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="19681-178">An application that has used the API to specify cursor behaviors should not then execute a [!INCLUDE[tsql](../includes/tsql-md.md)] DECLARE CURSOR statement to also request a [!INCLUDE[tsql](../includes/tsql-md.md)] cursor.</span></span> <span data-ttu-id="19681-179">Une application ne doit exécuter une instruction DECLARE CURSOR que si elle a ramené tous les attributs de curseur de l'API à leurs valeurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="19681-179">An application should only execute DECLARE CURSOR if it has set all the API cursor attributes back to their defaults.</span></span>  
  
 <span data-ttu-id="19681-180">Dans le cas où ni un curseur [!INCLUDE[tsql](../includes/tsql-md.md)] , ni un curseur d'API n'a été demandé, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] retourne par défaut à l'application un ensemble de résultats complet, appelé ensemble de résultats par défaut.</span><span class="sxs-lookup"><span data-stu-id="19681-180">If neither a [!INCLUDE[tsql](../includes/tsql-md.md)] nor API cursor has been requested, [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] defaults to returning a complete result set, known as a default result set, to the application.</span></span>  
  
## <a name="cursor-process"></a><span data-ttu-id="19681-181">Processus des curseurs</span><span class="sxs-lookup"><span data-stu-id="19681-181">Cursor Process</span></span>  
 [!INCLUDE[tsql](../includes/tsql-md.md)] <span data-ttu-id="19681-182">Les curseurs et les curseurs d’API ont une syntaxe différente, mais le processus général suivant est utilisé avec tous les curseurs [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="19681-182">cursors and API cursors have different syntax, but the following general process is used with all [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] cursors:</span></span>  
  
1.  <span data-ttu-id="19681-183">Associez un curseur à l'ensemble de résultats d'une instruction [!INCLUDE[tsql](../includes/tsql-md.md)] et définissez les caractéristiques du curseur, en indiquant par exemple si les lignes contenues dans le curseur peuvent être mises à jour.</span><span class="sxs-lookup"><span data-stu-id="19681-183">Associate a cursor with the result set of a [!INCLUDE[tsql](../includes/tsql-md.md)] statement, and define characteristics of the cursor, such as whether the rows in the cursor can be updated.</span></span>  
  
2.  <span data-ttu-id="19681-184">Exécutez l'instruction [!INCLUDE[tsql](../includes/tsql-md.md)] pour remplir le curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-184">Execute the [!INCLUDE[tsql](../includes/tsql-md.md)] statement to populate the cursor.</span></span>  
  
3.  <span data-ttu-id="19681-185">Dans le curseur que vous voulez afficher, extrayez les lignes.</span><span class="sxs-lookup"><span data-stu-id="19681-185">Retrieve the rows in the cursor you want to see.</span></span> <span data-ttu-id="19681-186">L'opération consistant à récupérer une ligne ou un bloc de lignes à partir d'un curseur est appelée une extraction.</span><span class="sxs-lookup"><span data-stu-id="19681-186">The operation to retrieve one row or one block of rows from a cursor is called a fetch.</span></span> <span data-ttu-id="19681-187">Le défilement est l'opération consistant à effectuer une série d'extractions afin d'extraire des lignes vers l'avant ou vers l'arrière.</span><span class="sxs-lookup"><span data-stu-id="19681-187">Performing a series of fetches to retrieve rows in either a forward or backward direction is called scrolling.</span></span>  
  
4.  <span data-ttu-id="19681-188">Vous pouvez, si vous le souhaitez, effectuer des opérations de modification (mise à jour ou suppression) sur la ligne à la position actuelle du curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-188">Optionally, perform modification operations (update or delete) on the row at the current position in the cursor.</span></span>  
  
5.  <span data-ttu-id="19681-189">Fermez le curseur.</span><span class="sxs-lookup"><span data-stu-id="19681-189">Close the cursor.</span></span>  
  
## <a name="related-content"></a><span data-ttu-id="19681-190">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="19681-190">Related Content</span></span>  
 <span data-ttu-id="19681-191">[Comportement des curseurs](native-client-odbc-cursors/cursor-behaviors.md) [Comment les curseurs sont implémentés](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span><span class="sxs-lookup"><span data-stu-id="19681-191">[Cursor Behaviors](native-client-odbc-cursors/cursor-behaviors.md) [How Cursors Are Implemented](native-client-odbc-cursors/implementation/how-cursors-are-implemented.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="19681-192">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="19681-192">See Also</span></span>  
 <span data-ttu-id="19681-193">[DÉCLARER un curseur &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="19681-193">[DECLARE CURSOR &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/declare-cursor-transact-sql) </span></span>  
 <span data-ttu-id="19681-194">[Curseurs &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="19681-194">[Cursors &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/cursors-transact-sql) </span></span>  
 <span data-ttu-id="19681-195">[Fonctions de curseur &#40;&#41;Transact-SQL](/sql/t-sql/functions/cursor-functions-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="19681-195">[Cursor Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/cursor-functions-transact-sql) </span></span>  
 [<span data-ttu-id="19681-196">Procédures stockées de curseur &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="19681-196">Cursor Stored Procedures &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/cursor-stored-procedures-transact-sql)  
  
  
