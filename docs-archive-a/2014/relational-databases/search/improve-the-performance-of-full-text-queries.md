---
title: Améliorer les performances des requêtes de texte intégral | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: search
ms.topic: conceptual
ms.assetid: 0658dc74-25eb-4486-bbd6-e85c1f92c272
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: a1437f710725df5c87d31f6a80939a5d7869b412
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87702635"
---
# <a name="improve-the-performance-of-full-text-queries"></a><span data-ttu-id="d7afe-102">Améliorer les performances des requêtes de texte intégral</span><span class="sxs-lookup"><span data-stu-id="d7afe-102">Improve the Performance of Full-Text Queries</span></span>
  <span data-ttu-id="d7afe-103">La liste suivante comprend des recommandations destinées à améliorer les performances des requêtes de texte intégral.</span><span class="sxs-lookup"><span data-stu-id="d7afe-103">The following is a list of recommendations that will help to improve the performance of full-text queries.</span></span>  
  
 <span data-ttu-id="d7afe-104">Les performances des requêtes de texte intégral sont également influencées par les ressources matérielles telles que la mémoire, la vitesse du disque et du processeur, ainsi que par l'architecture de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="d7afe-104">The performance of full-text queries is also influenced by hardware resources, such as memory, disk speed, CPU speed, and machine architecture.</span></span>  
  
-   <span data-ttu-id="d7afe-105">Défragmentez l’index de la table de base à l’aide de [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d7afe-105">Defragment the index of the base table by using [ALTER INDEX REORGANIZE](/sql/t-sql/statements/alter-index-transact-sql).</span></span>  
  
-   <span data-ttu-id="d7afe-106">Réorganisez le catalogue de texte intégral à l’aide de [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d7afe-106">Reorganize the full-text catalog by using [ALTER FULLTEXT CATALOG REORGANIZE](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql).</span></span> <span data-ttu-id="d7afe-107">Assurez-vous d'effectuer ces opérations avant de tester les performances car l'exécution de cette instruction entraîne une fusion principale des index de texte intégral dans ce catalogue.</span><span class="sxs-lookup"><span data-stu-id="d7afe-107">Make sure that you do this before performance testing because running this statement causes a master merge of the full-text indexes in that catalog.</span></span>  
  
-   <span data-ttu-id="d7afe-108">Limitez le choix de vos colonnes clés de texte intégral à une petite colonne.</span><span class="sxs-lookup"><span data-stu-id="d7afe-108">Restrict your choice of full-text key columns to a small column.</span></span> <span data-ttu-id="d7afe-109">Même si une colonne de 900 octets est prise en charge, il est recommandé d'utiliser une colonne clé inférieure à cette taille dans un index de recherche en texte intégral.</span><span class="sxs-lookup"><span data-stu-id="d7afe-109">Although a 900-byte column is supported, we recommend using a smaller key column in a full-text index.</span></span> <span data-ttu-id="d7afe-110">`int` et `bigint` offrent les meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="d7afe-110">`int` and `bigint` provide the best performance.</span></span>  
  
-   <span data-ttu-id="d7afe-111">L’utilisation d’une clé de texte intégral de type entier évite une jointure avec la table de mappage **docid** .</span><span class="sxs-lookup"><span data-stu-id="d7afe-111">Using an integer full-text key avoids a join with the **docid** mapping table.</span></span> <span data-ttu-id="d7afe-112">Par conséquent, une clé de texte intégral de type entier améliore considérablement les performances des requêtes et renforce les performances d'analyse.</span><span class="sxs-lookup"><span data-stu-id="d7afe-112">Therefore, an integer full-text key improves query performance by an order of magnitude and improves crawl performance.</span></span> <span data-ttu-id="d7afe-113">Des avantages en matière de performances supplémentaires peuvent résulter si la clé de texte intégral est également une clé d'index cluster.</span><span class="sxs-lookup"><span data-stu-id="d7afe-113">Additional performance benefits might result if the full-text key is also the clustered index key.</span></span>  
  
-   <span data-ttu-id="d7afe-114">Regroupez plusieurs prédicats [CONTAINS](/sql/t-sql/queries/contains-transact-sql) dans un seul prédicat CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="d7afe-114">Combine multiple [CONTAINS](/sql/t-sql/queries/contains-transact-sql) predicates into one CONTAINS predicate.</span></span> <span data-ttu-id="d7afe-115">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , vous pouvez spécifier une liste de colonnes dans la requête CONTAINS.</span><span class="sxs-lookup"><span data-stu-id="d7afe-115">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can specify a list of columns in the CONTAINS query.</span></span>  
  
-   <span data-ttu-id="d7afe-116">Utilisez [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) ou [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) au lieu de CONTAINS ou FREETEXT respectivement, si vous n’avez besoin que d’informations sur la clé de texte intégral ou le rang.</span><span class="sxs-lookup"><span data-stu-id="d7afe-116">If you only require full-text key or rank information, use [CONTAINSTABLE](/sql/relational-databases/system-functions/containstable-transact-sql) or [FREETEXTTABLE](/sql/relational-databases/system-functions/freetexttable-transact-sql) instead of CONTAINS or FREETEXT, respectively.</span></span>  
  
-   <span data-ttu-id="d7afe-117">Pour limiter les résultats et augmenter les performances, utilisez le paramètre *top_n_by_rank* des fonctions FREETEXTTABLE et CONTAINSTABLE.</span><span class="sxs-lookup"><span data-stu-id="d7afe-117">To limit results and increase performance, use the *top_n_by_rank* parameter of the FREETEXTTABLE and CONTAINSTABLE functions.</span></span> <span data-ttu-id="d7afe-118">*top_n_by_rank* vous permet de rappeler uniquement les accès les plus pertinents.</span><span class="sxs-lookup"><span data-stu-id="d7afe-118">*top_n_by_rank* allows you to recall only the most relevant hits.</span></span> <span data-ttu-id="d7afe-119">Utilisez ce paramètre uniquement si votre scénario d’entreprise ne nécessite pas de rappeler tous les accès possibles (autrement dit, s’il ne nécessite pas un *rappel total*).</span><span class="sxs-lookup"><span data-stu-id="d7afe-119">Use this parameter only if your business scenario does not require recalling all possible hits (that is, it does not require *total recall*).</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="d7afe-120">Le rappel total est généralement requis pour les scénarios juridiques, mais il peut être moins important que les performances pour les scénarios d'entreprise tels qu'un e-business.</span><span class="sxs-lookup"><span data-stu-id="d7afe-120">Total recall is typically necessary for legal scenarios but might be less important than performance for business scenarios such as an e-business.</span></span>  
  
-   <span data-ttu-id="d7afe-121">Vérifiez le plan de requête de texte intégral pour vous assurer que le plan de jointure adéquat a été sélectionné.</span><span class="sxs-lookup"><span data-stu-id="d7afe-121">Check the full-text query plan to make sure that the appropriate join plan is chosen.</span></span> <span data-ttu-id="d7afe-122">Utilisez un indicateur de jointure ou un indicateur de requête si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="d7afe-122">Use a join hint or query hint if you have to.</span></span> <span data-ttu-id="d7afe-123">Si un paramètre est utilisé dans la requête de texte intégral, la valeur initiale du paramètre détermine le plan de requête.</span><span class="sxs-lookup"><span data-stu-id="d7afe-123">If a parameter is used in the full-text query, the first-time value of the parameter determines the query plan.</span></span> <span data-ttu-id="d7afe-124">Vous pouvez utiliser l’ [indicateur de requête](/sql/t-sql/queries/hints-transact-sql-query) OPTIMIZE FOR pour forcer la requête à une compilation avec la valeur souhaitée.</span><span class="sxs-lookup"><span data-stu-id="d7afe-124">You can use the OPTIMIZE FOR [query hint](/sql/t-sql/queries/hints-transact-sql-query) to force the query to compile with the value you want.</span></span> <span data-ttu-id="d7afe-125">Il est ainsi possible d'obtenir un plan de requête déterministe et de meilleures performances.</span><span class="sxs-lookup"><span data-stu-id="d7afe-125">This helps achieve a deterministic query plan and better performance.</span></span>  
  
-   <span data-ttu-id="d7afe-126">Trop de fragments d'index de recherche en texte intégral dans l'index de texte intégral peut conduire à une dégradation substantielle dans les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="d7afe-126">Too many full-text index fragments in the full-text index, can lead to substantial degradation in query performance.</span></span> <span data-ttu-id="d7afe-127">Pour réduire le nombre de fragments, réorganisez le catalogue de texte intégral en utilisant l’option REORGANIZE de l’instruction [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)[!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d7afe-127">To reduce the number of fragments, reorganize the full-text catalog by using the REORGANIZE option of the [ALTER FULLTEXT CATALOG](/sql/t-sql/statements/alter-fulltext-catalog-transact-sql)[!INCLUDE[tsql](../../includes/tsql-md.md)] statement.</span></span> <span data-ttu-id="d7afe-128">Cette instruction fusionne essentiellement tous les fragments en un plus grand fragment unique et supprime toutes les entrées obsolètes de l'index de recherche en texte intégral.</span><span class="sxs-lookup"><span data-stu-id="d7afe-128">This statement essentially merges all the fragments into a single larger fragment and removes all obsolete entries from the full-text index.</span></span>  
  
-   <span data-ttu-id="d7afe-129">Dans la recherche en texte intégral , les opérateurs logiques spécifiés dans CONTAINSTABLE (AND, OR) peuvent être implémentés en tant que jointures SQL ou bien dans des fonctions table de diffusion d'exécution de texte intégral (STVF).</span><span class="sxs-lookup"><span data-stu-id="d7afe-129">In  full-text search, logical operators specified in CONTAINSTABLE (AND, OR) can be implemented either as SQL joins or inside the full-text execution streaming table-valued functions (STVF).</span></span> <span data-ttu-id="d7afe-130">En général, les requêtes avec un seul type d'opérateur logique sont implémentées exclusivement par l'exécution de texte intégral, alors que les requêtes qui combinent des opérateurs logiques possèdent également des jointures SQL.</span><span class="sxs-lookup"><span data-stu-id="d7afe-130">Typically, queries with only one type of logical operators are implemented purely by full-text execution, whereas queries that mix logical operators also possess SQL joins.</span></span> <span data-ttu-id="d7afe-131">L'implémentation d'un opérateur logique dans la fonction table multi-diffusion d'exécution de texte intégral utilise quelques propriétés d'index spéciales qui la rendent beaucoup plus rapide que les jointures SQL.</span><span class="sxs-lookup"><span data-stu-id="d7afe-131">Implementation of a logical operator inside the full-text execution STVF uses some special index properties that make it much faster than SQL joins.</span></span> <span data-ttu-id="d7afe-132">Pour cette raison, nous recommandons que, dans toute la mesure du possible, vous encadrez des requêtes en utilisant seulement un type unique d'opérateur logique.</span><span class="sxs-lookup"><span data-stu-id="d7afe-132">For this reason, we recommend that, where possible, you frame queries using only a single type of logical operator.</span></span>  
  
-   <span data-ttu-id="d7afe-133">Pour les applications qui contiennent des prédications de relation sélectives, les requêtes qui utilisent des prédicats relationnels sélectifs et des prédicats de texte intégral non sélectifs peuvent s'exécuter de manière optimale lorsqu'elles sont écrites pour utiliser l'optimiseur de requête.</span><span class="sxs-lookup"><span data-stu-id="d7afe-133">For applications that contain selective-relation predications, queries that use selective relational predicates and unselective full-text predicates might perform best when they are written to use the query optimizer.</span></span> <span data-ttu-id="d7afe-134">Cela permet à l'optimiseur de requête de déterminer s'il peut exploiter le prédicat ou le menu déroulant de plage pour produire un plan de requête effectif.</span><span class="sxs-lookup"><span data-stu-id="d7afe-134">This allows the query optimizer to decide whether it can exploit predicate or range pushdown to produce an effective query plan.</span></span> <span data-ttu-id="d7afe-135">Cette approche est plus simple et souvent plus efficace que l'indexation des données relationnelles comme données de texte intégral.</span><span class="sxs-lookup"><span data-stu-id="d7afe-135">This approach is simpler and often more efficient than indexing relational data as full-text data.</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="d7afe-136">Ressources associées</span><span class="sxs-lookup"><span data-stu-id="d7afe-136">Related Resources</span></span>  
 [<span data-ttu-id="d7afe-137">SQL Server 2008 Full-Text Search: Internals and Enhancements (en anglais)</span><span class="sxs-lookup"><span data-stu-id="d7afe-137">SQL Server 2008 Full-Text Search: Internals and Enhancements</span></span>](https://go.microsoft.com/fwlink/?LinkId=129544)  
  
## <a name="see-also"></a><span data-ttu-id="d7afe-138">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d7afe-138">See Also</span></span>  
 <span data-ttu-id="d7afe-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="d7afe-139">[sys.dm_fts_memory_buffers &#40;Transact-SQL&#41;](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-buffers-transact-sql) </span></span>  
 [<span data-ttu-id="d7afe-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="d7afe-140">sys.dm_fts_memory_pools &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-dynamic-management-views/sys-dm-fts-memory-pools-transact-sql)  
  
  
