---
title: Contraintes de clé primaire et de clé étrangère | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: table-view-index
ms.topic: conceptual
helpviewer_keywords:
- foreign keys [SQL Server], cascading referential integrity
- FOREIGN KEY constraints
- foreign keys [SQL Server]
- foreign keys [SQL Server], about foreign key constraints
ms.assetid: 31fbcc9f-2dc5-4bf9-aa50-ed70ec7b5bcd
author: stevestein
ms.author: sstein
ms.openlocfilehash: b6e7b88de880348fabb00cb46d3028716441bc2b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612716"
---
# <a name="primary-and-foreign-key-constraints"></a><span data-ttu-id="7393e-102">Contraintes de clé primaire et de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7393e-102">Primary and Foreign Key Constraints</span></span>
  <span data-ttu-id="7393e-103">Les clés primaires et les clés étrangères sont deux types de contraintes qui peuvent être utilisées pour appliquer l'intégrité des données dans des tables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="7393e-103">Primary keys and foreign keys are two types of constraints that can be used to enforce data integrity in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="7393e-104">Ce sont des objets de base de données importants.</span><span class="sxs-lookup"><span data-stu-id="7393e-104">These are important database objects.</span></span>

 <span data-ttu-id="7393e-105">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="7393e-105">This topic contains the following sections.</span></span>

 [<span data-ttu-id="7393e-106">Contraintes de clé primaire</span><span class="sxs-lookup"><span data-stu-id="7393e-106">Primary Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#PKeys)

 [<span data-ttu-id="7393e-107">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="7393e-107">Foreign Key Constraints</span></span>](../tables/primary-and-foreign-key-constraints.md#FKeys)

 [<span data-ttu-id="7393e-108">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="7393e-108">Related Tasks</span></span>](../tables/primary-and-foreign-key-constraints.md#Tasks)

##  <a name="primary-key-constraints"></a><a name="PKeys"></a> <span data-ttu-id="7393e-109">Contraintes de clé primaire</span><span class="sxs-lookup"><span data-stu-id="7393e-109">Primary Key Constraints</span></span>
 <span data-ttu-id="7393e-110">Une table contient généralement une colonne ou une combinaison de colonnes dont les valeurs identifient de façon unique chaque ligne dans la table.</span><span class="sxs-lookup"><span data-stu-id="7393e-110">A table typically has a column or combination of columns that contain values that uniquely identify each row in the table.</span></span> <span data-ttu-id="7393e-111">Cette colonne (ou ces colonnes), appelée clé primaire (PK, Primary Key), assure l'intégrité de l'entité de la table.</span><span class="sxs-lookup"><span data-stu-id="7393e-111">This column, or columns, is called the primary key (PK) of the table and enforces the entity integrity of the table.</span></span> <span data-ttu-id="7393e-112">Les contraintes de clé primaire garantissent des données uniques, c'est pourquoi elles sont souvent définies pour une colonne d'identité.</span><span class="sxs-lookup"><span data-stu-id="7393e-112">Because primary key constraints guarantee unique data, they are frequently defined on an identity column.</span></span>

 <span data-ttu-id="7393e-113">Lorsque vous spécifiez une contrainte de clé primaire pour une table, le [!INCLUDE[ssDE](../../includes/ssde-md.md)] garantit l'unicité des données en créant automatiquement un index unique pour les colonnes de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-113">When you specify a primary key constraint for a table, the [!INCLUDE[ssDE](../../includes/ssde-md.md)] enforces data uniqueness by automatically creating a unique index for the primary key columns.</span></span> <span data-ttu-id="7393e-114">Cet index permet également l'accès rapide aux données lorsque la clé primaire est utilisée dans des requêtes.</span><span class="sxs-lookup"><span data-stu-id="7393e-114">This index also permits fast access to data when the primary key is used in queries.</span></span> <span data-ttu-id="7393e-115">Si une contrainte de clé primaire est définie sur plusieurs colonnes, des valeurs peuvent apparaître en double dans une colonne, mais chaque combinaison de valeurs issues de toutes les colonnes de la définition de contrainte de clé primaire doit être unique.</span><span class="sxs-lookup"><span data-stu-id="7393e-115">If a primary key constraint is defined on more than one column, values may be duplicated within one column, but each combination of values from all the columns in the primary key constraint definition must be unique.</span></span>

 <span data-ttu-id="7393e-116">Comme illustré ci-dessous, les colonnes **ProductID** et **VendorID** de la table **Purchasing.ProductVendor** constituent une contrainte de clé primaire composite pour cette table.</span><span class="sxs-lookup"><span data-stu-id="7393e-116">As shown in the following illustration, the **ProductID** and **VendorID** columns in the **Purchasing.ProductVendor** table form a composite primary key constraint for this table.</span></span> <span data-ttu-id="7393e-117">Cela garantit que chaque ligne dans la table **ProductVendor** possède une combinaison unique de **ProductID** et **VendorID**.</span><span class="sxs-lookup"><span data-stu-id="7393e-117">This makes sure that every row in the **ProductVendor** table has a unique combination of **ProductID** and **VendorID**.</span></span> <span data-ttu-id="7393e-118">Cela empêche l'insertion de lignes en double.</span><span class="sxs-lookup"><span data-stu-id="7393e-118">This prevents the insertion of duplicate rows.</span></span>

 <span data-ttu-id="7393e-119">![Contrainte PRIMARY KEY composite](../../database-engine/media/fund04.gif "Contrainte PRIMARY KEY composite")</span><span class="sxs-lookup"><span data-stu-id="7393e-119">![Composite PRIMARY KEY constraint](../../database-engine/media/fund04.gif "Composite PRIMARY KEY constraint")</span></span>

-   <span data-ttu-id="7393e-120">Une table ne peut contenir qu'une seule contrainte de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-120">A table can contain only one primary key constraint.</span></span>

-   <span data-ttu-id="7393e-121">Une clé primaire ne peut pas dépasser 16 colonnes et une longueur de clé totale de 900 octets.</span><span class="sxs-lookup"><span data-stu-id="7393e-121">A primary key cannot exceed 16 columns and a total key length of 900 bytes.</span></span>

-   <span data-ttu-id="7393e-122">L'index généré par une contrainte de clé primaire ne peut avoir pour conséquence une augmentation du nombre d'index dans la table à plus de 999 index non cluster et un index cluster.</span><span class="sxs-lookup"><span data-stu-id="7393e-122">The index generated by a primary key constraint cannot cause the number of indexes on the table to exceed 999 nonclustered indexes and 1 clustered index.</span></span>

-   <span data-ttu-id="7393e-123">Si vous ne spécifiez pas cluster ni non cluster pour une contrainte de clé primaire, cluster est utilisé s'il n'y a pas d'index cluster sur la table.</span><span class="sxs-lookup"><span data-stu-id="7393e-123">If clustered or nonclustered is not specified for a primary key constraint, clustered is used if there no clustered index on the table.</span></span>

-   <span data-ttu-id="7393e-124">Toutes les colonnes définies dans une contrainte de clé primaire doivent avoir une valeur autre que Null.</span><span class="sxs-lookup"><span data-stu-id="7393e-124">All columns defined within a primary key constraint must be defined as not null.</span></span> <span data-ttu-id="7393e-125">Si vous ne spécifiez pas la possibilité de valeur NULL, toutes les colonnes participant à une contrainte de clé primaire ont des valeurs autres que Null.</span><span class="sxs-lookup"><span data-stu-id="7393e-125">If nullability is not specified, all columns participating in a primary key constraint have their nullability set to not null.</span></span>

-   <span data-ttu-id="7393e-126">Si une clé primaire est définie sur une colonne avec le type de données CLR défini par l'utilisateur, l'implémentation du type doit prendre en charge le tri binaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-126">If a primary key is defined on a CLR user-defined type column, the implementation of the type must support binary ordering.</span></span>

##  <a name="foreign-key-constraints"></a><a name="FKeys"></a> <span data-ttu-id="7393e-127">Foreign Key Constraints</span><span class="sxs-lookup"><span data-stu-id="7393e-127">Foreign Key Constraints</span></span>
 <span data-ttu-id="7393e-128">On appelle « clé étrangère » une colonne ou une combinaison de colonnes utilisée pour établir et conserver une liaison entre les données de deux tables pour contrôler les données qui peuvent être stockées dans la table de clés étrangères.</span><span class="sxs-lookup"><span data-stu-id="7393e-128">A foreign key (FK) is a column or combination of columns that is used to establish and enforce a link between the data in two tables to control the data that can be stored in the foreign key table.</span></span> <span data-ttu-id="7393e-129">Dans une référence de clé étrangère, la création d'une liaison entre deux tables s'effectue lors du référencement de la ou des colonnes contenant les valeurs de clé primaire d'une table dans la ou les colonnes de l'autre table.</span><span class="sxs-lookup"><span data-stu-id="7393e-129">In a foreign key reference, a link is created between two tables when the column or columns that hold the primary key value for one table are referenced by the column or columns in another table.</span></span> <span data-ttu-id="7393e-130">Cette colonne devient alors une clé étrangère dans la seconde table.</span><span class="sxs-lookup"><span data-stu-id="7393e-130">This column becomes a foreign key in the second table.</span></span>

 <span data-ttu-id="7393e-131">Par exemple, la table **Sales.SalesOrderHeader** possède une liaison de clé étrangère avec la table **Sales.SalesPerson** car il existe une relation logique entre les commandes et les vendeurs.</span><span class="sxs-lookup"><span data-stu-id="7393e-131">For example, the **Sales.SalesOrderHeader** table has a foreign key link to the **Sales.SalesPerson** table because there is a logical relationship between sales orders and salespeople.</span></span> <span data-ttu-id="7393e-132">La colonne **SalesPersonID** de la table **SalesOrderHeader** correspond à la colonne clé primaire de la table **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="7393e-132">The **SalesPersonID** column in the **SalesOrderHeader** table matches the primary key column of the **SalesPerson** table.</span></span> <span data-ttu-id="7393e-133">La colonne **SalesPersonID** de la table **SalesOrderHeader** est donc la clé étrangère de la table **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="7393e-133">The **SalesPersonID** column in the **SalesOrderHeader** table is the foreign key to the **SalesPerson** table.</span></span> <span data-ttu-id="7393e-134">Lors de la création de cette relation de clé étrangère, une valeur pour **SalesPersonID** ne peut pas être insérée dans la table **SalesOrderHeader** si elle n'existe pas déjà dans la table **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="7393e-134">By creating this foreign key relationship, a value for **SalesPersonID** cannot be inserted into the **SalesOrderHeader** table if it does not already exist in the **SalesPerson** table.</span></span>

### <a name="indexes-on-foreign-key-constraints"></a><span data-ttu-id="7393e-135">Index de contraintes de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7393e-135">Indexes on Foreign Key Constraints</span></span>
 <span data-ttu-id="7393e-136">Contrairement aux contraintes de clé primaire, la création d'une contrainte de clé étrangère ne crée pas automatiquement un index correspondant.</span><span class="sxs-lookup"><span data-stu-id="7393e-136">Unlike primary key constraints, creating a foreign key constraint does not automatically create a corresponding index.</span></span> <span data-ttu-id="7393e-137">Toutefois, la création manuelle d'un index pour une clé étrangère s'avère souvent utile pour les raisons suivantes :</span><span class="sxs-lookup"><span data-stu-id="7393e-137">However, manually creating an index on a foreign key is often useful for the following reasons:</span></span>

-   <span data-ttu-id="7393e-138">Les colonnes de clé étrangère sont souvent employées dans les critères de jointure lorsque les données de tables associées sont combinées dans des requêtes grâce à la correspondance de la ou des colonnes de la contrainte de clé étrangère d'une table avec la ou les colonnes de clé primaire ou unique de l'autre table.</span><span class="sxs-lookup"><span data-stu-id="7393e-138">Foreign key columns are frequently used in join criteria when the data from related tables is combined in queries by matching the column or columns in the foreign key constraint of one table with the primary or unique key column or columns in the other table.</span></span> <span data-ttu-id="7393e-139">L'index permet au [!INCLUDE[ssDE](../../includes/ssde-md.md)] de rechercher rapidement des données associées dans la table de clés étrangères.</span><span class="sxs-lookup"><span data-stu-id="7393e-139">An index enables the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to quickly find related data in the foreign key table.</span></span> <span data-ttu-id="7393e-140">La création de cet index n'est toutefois pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="7393e-140">However, creating this index is not required.</span></span> <span data-ttu-id="7393e-141">Les données des deux tables associées peuvent être combinées même si aucune contrainte de clé primaire ou étrangère n'est définie entre les tables. La présence d'une relation de clé étrangère entre deux tables indique que toutes deux ont été optimisées en vue de leur combinaison dans une requête utilisant les clés comme critères.</span><span class="sxs-lookup"><span data-stu-id="7393e-141">Data from two related tables can be combined even if no primary key or foreign key constraints are defined between the tables, but a foreign key relationship between two tables indicates that the two tables have been optimized to be combined in a query that uses the keys as its criteria.</span></span>

-   <span data-ttu-id="7393e-142">Les modifications apportées aux contraintes de clé primaire sont vérifiées parallèlement aux contraintes de clé étrangère des tables associées.</span><span class="sxs-lookup"><span data-stu-id="7393e-142">Changes to primary key constraints are checked with foreign key constraints in related tables.</span></span>

### <a name="referential-integrity"></a><span data-ttu-id="7393e-143">Intégrité référentielle</span><span class="sxs-lookup"><span data-stu-id="7393e-143">Referential Integrity</span></span>
 <span data-ttu-id="7393e-144">Bien que la principale utilité d'une contrainte de clé étrangère consiste à contrôler les données qui peuvent être stockées dans la table de clés étrangères, elle contrôle également les modifications apportées aux données de la table de clés primaires.</span><span class="sxs-lookup"><span data-stu-id="7393e-144">Although the main purpose of a foreign key constraint is to control the data that can be stored in the foreign key table, it also controls changes to data in the primary key table.</span></span> <span data-ttu-id="7393e-145">Par exemple, si la ligne d'un vendeur est supprimée de la table **Sales.SalesPerson** et que l'ID de ce vendeur est utilisé pour les commandes de la table **Sales.SalesOrderHeader** , l'intégrité relationnelle entre les deux tables est rompue. Les commandes du vendeur supprimé deviennent des enregistrements orphelins dans la table **SalesOrderHeader** dépourvus de tout lien vers des données de la table **SalesPerson** .</span><span class="sxs-lookup"><span data-stu-id="7393e-145">For example, if the row for a salesperson is deleted from the **Sales.SalesPerson** table, and the salesperson's ID is used for sales orders in the **Sales.SalesOrderHeader** table, the relational integrity between the two tables is broken; the deleted salesperson's sales orders are orphaned in the **SalesOrderHeader** table without a link to the data in the **SalesPerson** table.</span></span>

 <span data-ttu-id="7393e-146">Une contrainte de clé étrangère empêche une telle situation.</span><span class="sxs-lookup"><span data-stu-id="7393e-146">A foreign key constraint prevents this situation.</span></span> <span data-ttu-id="7393e-147">La contrainte conserve l'intégrité référentielle en garantissant qu'aucune modification ne peut être apportée aux données de la table de clés primaires si ces modifications rendent non valide la liaison avec les données de la table de clés étrangères.</span><span class="sxs-lookup"><span data-stu-id="7393e-147">The constraint enforces referential integrity by guaranteeing that changes cannot be made to data in the primary key table if those changes invalidate the link to data in the foreign key table.</span></span> <span data-ttu-id="7393e-148">En cas de tentative de suppression de la ligne d'une table de clés primaires ou de modification d'une valeur de clé primaire, l'action échoue si la valeur de clé primaire supprimée ou modifiée correspond à une valeur de la contrainte de clé étrangère d'une autre table.</span><span class="sxs-lookup"><span data-stu-id="7393e-148">If an attempt is made to delete the row in a primary key table or to change a primary key value, the action will fail when the deleted or changed primary key value corresponds to a value in the foreign key constraint of another table.</span></span> <span data-ttu-id="7393e-149">Pour parvenir à modifier ou à supprimer une ligne d'une contrainte de clé étrangère, vous devez d'abord supprimer ou modifier les données de clé étrangère de la table de clés étrangères, ce qui crée une liaison entre la clé étrangère et d'autres données de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-149">To successfully change or delete a row in a foreign key constraint, you must first either delete the foreign key data in the foreign key table or change the foreign key data in the foreign key table, which links the foreign key to different primary key data.</span></span>

#### <a name="cascading-referential-integrity"></a><span data-ttu-id="7393e-150">Intégrité référentielle en cascade</span><span class="sxs-lookup"><span data-stu-id="7393e-150">Cascading Referential Integrity</span></span>
 <span data-ttu-id="7393e-151">Les contraintes d'intégrité référentielle en cascade définissent les actions exécutées par le [!INCLUDE[ssDE](../../includes/ssde-md.md)] lorsqu'un utilisateur tente de supprimer ou de mettre à jour une clé vers laquelle pointent des clés étrangères existantes.</span><span class="sxs-lookup"><span data-stu-id="7393e-151">By using cascading referential integrity constraints, you can define the actions that the [!INCLUDE[ssDE](../../includes/ssde-md.md)] takes when a user tries to delete or update a key to which existing foreign keys point.</span></span> <span data-ttu-id="7393e-152">Les actions en cascade suivantes peuvent être définies.</span><span class="sxs-lookup"><span data-stu-id="7393e-152">The following cascading actions can be defined.</span></span>

 <span data-ttu-id="7393e-153">AUCUNE ACTION [!INCLUDE[ssDE](../../includes/ssde-md.md)] déclenche une erreur et l’action de suppression ou de mise à jour sur la ligne de la table parente est annulée.</span><span class="sxs-lookup"><span data-stu-id="7393e-153">NO ACTION The [!INCLUDE[ssDE](../../includes/ssde-md.md)] raises an error and the delete or update action on the row in the parent table is rolled back.</span></span>

 <span data-ttu-id="7393e-154">Les lignes correspondantes en CASCADE sont mises à jour ou supprimées dans la table de référence lorsque cette ligne est mise à jour ou supprimée dans la table parente.</span><span class="sxs-lookup"><span data-stu-id="7393e-154">CASCADE Corresponding rows are updated or deleted in the referencing table when that row is updated or deleted in the parent table.</span></span> <span data-ttu-id="7393e-155">La valeur CASCADE ne peut pas être spécifiée si une colonne `timestamp` fait partie de la clé étrangère ou de la clé référencée.</span><span class="sxs-lookup"><span data-stu-id="7393e-155">CASCADE cannot be specified if a `timestamp` column is part of either the foreign key or the referenced key.</span></span> <span data-ttu-id="7393e-156">L'action ON DELETE CASCADE ne peut pas être spécifiée pour une table possédant un déclencheur INSTEAD OF DELETE.</span><span class="sxs-lookup"><span data-stu-id="7393e-156">ON DELETE CASCADE cannot be specified for a table that has an INSTEAD OF DELETE trigger.</span></span> <span data-ttu-id="7393e-157">L'action ON UPDATE CASCADE ne peut pas être spécifiée pour les tables possédant des déclencheurs INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="7393e-157">ON UPDATE CASCADE cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7393e-158">Définissez NULL toutes les valeurs qui composent la clé étrangère sont définies sur NULL lorsque la ligne correspondante dans la table parente est mise à jour ou supprimée.</span><span class="sxs-lookup"><span data-stu-id="7393e-158">SET NULL All the values that make up the foreign key are set to NULL when the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="7393e-159">Pour que cette contrainte s'applique, les colonnes clés étrangères doivent pouvoir cependant être définies sur NULL.</span><span class="sxs-lookup"><span data-stu-id="7393e-159">For this constraint to execute, the foreign key columns must be nullable.</span></span> <span data-ttu-id="7393e-160">Les actions suivantes ne peuvent pas être spécifiées pour les tables possédant des déclencheurs INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="7393e-160">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7393e-161">Définissez par défaut toutes les valeurs qui composent la clé étrangère sont définies sur leurs valeurs par défaut si la ligne correspondante dans la table parente est mise à jour ou supprimée.</span><span class="sxs-lookup"><span data-stu-id="7393e-161">SET DEFAULT All the values that make up the foreign key are set to their default values if the corresponding row in the parent table is updated or deleted.</span></span> <span data-ttu-id="7393e-162">Pour que cette contrainte s'applique, les colonnes clés étrangères doivent disposer cependant de valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="7393e-162">For this constraint to execute, all foreign key columns must have default definitions.</span></span> <span data-ttu-id="7393e-163">Si une colonne peut être affectée de la valeur NULL et qu'aucune valeur par défaut n'est définie, NULL constitue alors la valeur par défaut de la colonne de façon implicite.</span><span class="sxs-lookup"><span data-stu-id="7393e-163">If a column is nullable, and there is no explicit default value set, NULL becomes the implicit default value of the column.</span></span> <span data-ttu-id="7393e-164">Les actions suivantes ne peuvent pas être spécifiées pour les tables possédant des déclencheurs INSTEAD OF UPDATE.</span><span class="sxs-lookup"><span data-stu-id="7393e-164">Cannot be specified for tables that have INSTEAD OF UPDATE triggers.</span></span>

 <span data-ttu-id="7393e-165">Il est possible de combiner CASCADE, SET NULL, SET DEFAULT et NO ACTION pour des tables liées par des relations référentielles.</span><span class="sxs-lookup"><span data-stu-id="7393e-165">CASCADE, SET NULL, SET DEFAULT and NO ACTION can be combined on tables that have referential relationships with each other.</span></span> <span data-ttu-id="7393e-166">Si le moteur [!INCLUDE[ssDE](../../includes/ssde-md.md)] rencontre NO ACTION, il s’interrompt et restaure les actions CASCADE, SET NULL et SET DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="7393e-166">If the [!INCLUDE[ssDE](../../includes/ssde-md.md)] encounters NO ACTION, it stops and rolls back related CASCADE, SET NULL and SET DEFAULT actions.</span></span> <span data-ttu-id="7393e-167">Lorsqu'une instruction DELETE génère une combinaison d'actions CASCADE, SET NULL, SET DEFAULT et NO ACTION, les actions CASCADE, SET NULL et SET DEFAULT sont appliquées par le [!INCLUDE[ssDE](../../includes/ssde-md.md)] avant toute recherche de NO ACTION.</span><span class="sxs-lookup"><span data-stu-id="7393e-167">When a DELETE statement causes a combination of CASCADE, SET NULL, SET DEFAULT and NO ACTION actions, all the CASCADE, SET NULL and SET DEFAULT actions are applied before the [!INCLUDE[ssDE](../../includes/ssde-md.md)] checks for any NO ACTION.</span></span>

### <a name="triggers-and-cascading-referential-actions"></a><span data-ttu-id="7393e-168">Déclencheurs et actions d'intégrité référentielle en cascade</span><span class="sxs-lookup"><span data-stu-id="7393e-168">Triggers and Cascading Referential Actions</span></span>
 <span data-ttu-id="7393e-169">Les actions d'intégrité référentielle en cascade activent les déclencheurs AFTER UPDATE ou AFTER DELETE de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="7393e-169">Cascading referential actions fire the AFTER UPDATE or AFTER DELETE triggers in the following manner:</span></span>

-   <span data-ttu-id="7393e-170">Toutes les actions d'intégrité référentielle en cascade générées directement par l'instruction DELETE ou UPDATE initiale sont exécutées en premier.</span><span class="sxs-lookup"><span data-stu-id="7393e-170">All the cascading referential actions directly caused by the original DELETE or UPDATE are performed first.</span></span>

-   <span data-ttu-id="7393e-171">Si des déclencheurs AFTER sont définis sur les tables affectées, ils sont activés une fois réalisées toutes les actions en cascade.</span><span class="sxs-lookup"><span data-stu-id="7393e-171">If there are any AFTER triggers defined on the affected tables, these triggers fire after all cascading actions are performed.</span></span> <span data-ttu-id="7393e-172">Ces déclencheurs sont activés dans l'ordre inverse de l'action en cascade.</span><span class="sxs-lookup"><span data-stu-id="7393e-172">These triggers fire in opposite order of the cascading action.</span></span> <span data-ttu-id="7393e-173">Si une table possède plusieurs déclencheurs dont aucun n'est un premier ni un dernier déclencheur dédié, ils sont activés dans un ordre aléatoire.</span><span class="sxs-lookup"><span data-stu-id="7393e-173">If there are multiple triggers on a single table, they fire in random order, unless there is a dedicated first or last trigger for the table.</span></span> <span data-ttu-id="7393e-174">Cet ordre est spécifié à l’aide de [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="7393e-174">This order is as specified by using [sp_settriggerorder](/sql/relational-databases/system-stored-procedures/sp-settriggerorder-transact-sql).</span></span>

-   <span data-ttu-id="7393e-175">Si plusieurs chaînes d'actions en cascade proviennent de la table qui était la cible directe d'une action UPDATE ou DELETE, l'ordre dans lequel ces chaînes activent leurs déclencheurs respectifs n'est pas spécifié.</span><span class="sxs-lookup"><span data-stu-id="7393e-175">If multiple cascading chains originate from the table that was the direct target of an UPDATE or DELETE action, the order in which these chains fire their respective triggers is unspecified.</span></span> <span data-ttu-id="7393e-176">Toutefois, une chaîne active toujours tous ses déclencheurs avant qu'une autre chaîne ne soit activée.</span><span class="sxs-lookup"><span data-stu-id="7393e-176">However, one chain always fires all its triggers before another chain starts firing.</span></span>

-   <span data-ttu-id="7393e-177">Si la table qui est la cible directe d'une action UPDATE ou DELETE possède un déclencheur AFTER, celui-ci est activé, que des lignes soient ou non affectées.</span><span class="sxs-lookup"><span data-stu-id="7393e-177">An AFTER trigger on the table that is the direct target of an UPDATE or DELETE action fires regardless of whether any rows are affected.</span></span> <span data-ttu-id="7393e-178">Dans ce cas, aucune autre table n'est affectée par les actions en cascade.</span><span class="sxs-lookup"><span data-stu-id="7393e-178">There are no other tables affected by cascading in this case.</span></span>

-   <span data-ttu-id="7393e-179">Si l'un des déclencheurs précédents effectue des opérations UPDATE ou DELETE sur d'autres tables, ces actions peuvent démarrer des chaînes d'actions en cascade secondaires.</span><span class="sxs-lookup"><span data-stu-id="7393e-179">If any one of the previous triggers perform UPDATE or DELETE operations on other tables, these actions can start secondary cascading chains.</span></span> <span data-ttu-id="7393e-180">Ces chaînes secondaires sont traitées pour chaque opération UPDATE ou DELETE une fois activés tous les déclencheurs de toutes les chaînes primaires.</span><span class="sxs-lookup"><span data-stu-id="7393e-180">These secondary chains are processed for each UPDATE or DELETE operation at a time after all triggers on all primary chains fire.</span></span> <span data-ttu-id="7393e-181">Ce processus peut être répété de façon récursive pour des opérations UPDATE ou DELETE ultérieures.</span><span class="sxs-lookup"><span data-stu-id="7393e-181">This process may be recursively repeated for subsequent UPDATE or DELETE operations.</span></span>

-   <span data-ttu-id="7393e-182">La réalisation d'opérations CREATE, ALTER, DELETE ou d'autres opérations DDL (Data Definition Language) dans les déclencheurs peut activer les déclencheurs DDL.</span><span class="sxs-lookup"><span data-stu-id="7393e-182">Performing CREATE, ALTER, DELETE, or other data definition language (DDL) operations inside the triggers may cause DDL triggers to fire.</span></span> <span data-ttu-id="7393e-183">Cela peut ensuite activer des opérations DELETE ou UPDATE qui démarrent des chaînes d'actions en cascade et des déclencheurs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="7393e-183">This may subsequently perform DELETE or UPDATE operations that start additional cascading chains and triggers.</span></span>

-   <span data-ttu-id="7393e-184">Si une erreur est générée dans une chaîne spécifique d'actions d'intégrité référentielle en cascade, une erreur se produit, aucun déclencheur AFTER n'est activé dans cette chaîne et l'opération DELETE ou UPDATE qui a créé la chaîne est restaurée.</span><span class="sxs-lookup"><span data-stu-id="7393e-184">If an error is generated inside any particular cascading referential action chain, an error is raised, no AFTER triggers are fired in that chain, and the DELETE or UPDATE operation that created the chain is rolled back.</span></span>

-   <span data-ttu-id="7393e-185">En outre, une table possédant un déclencheur INSTEAD OF ne peut pas détenir de clause REFERENCES spécifiant une action en cascade.</span><span class="sxs-lookup"><span data-stu-id="7393e-185">A table that has an INSTEAD OF trigger cannot also have a REFERENCES clause that specifies a cascading action.</span></span> <span data-ttu-id="7393e-186">Cependant, un déclencheur AFTER d'une table impliquée dans une action en cascade peut exécuter une instruction INSERT, UPDATE ou DELETE sur une autre table ou vue, qui active un déclencheur INSTEAD OF défini sur cet objet.</span><span class="sxs-lookup"><span data-stu-id="7393e-186">However, an AFTER trigger on a table targeted by a cascading action can execute an INSERT, UPDATE, or DELETE statement on another table or view that fires an INSTEAD OF trigger defined on that object.</span></span>

##  <a name="related-tasks"></a><a name="Tasks"></a> <span data-ttu-id="7393e-187">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="7393e-187">Related Tasks</span></span>
 <span data-ttu-id="7393e-188">Le tableau suivant répertorie les tâches courantes associées aux contraintes de clé primaire et de clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="7393e-188">The following table lists the common tasks associated with primary key and foreign key constraints.</span></span>

|<span data-ttu-id="7393e-189">Tâche</span><span class="sxs-lookup"><span data-stu-id="7393e-189">Task</span></span>|<span data-ttu-id="7393e-190">Rubrique</span><span class="sxs-lookup"><span data-stu-id="7393e-190">Topic</span></span>|
|----------|-----------|
|<span data-ttu-id="7393e-191">Décrit comment créer une clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-191">Describes how to create a primary key.</span></span>|[<span data-ttu-id="7393e-192">Créer des clés primaires</span><span class="sxs-lookup"><span data-stu-id="7393e-192">Create Primary Keys</span></span>](../tables/create-primary-keys.md)|
|<span data-ttu-id="7393e-193">Décrit comment supprimer une clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-193">Describes how to delete a primary key.</span></span>|[<span data-ttu-id="7393e-194">Supprimer des clés primaires</span><span class="sxs-lookup"><span data-stu-id="7393e-194">Delete Primary Keys</span></span>](../tables/delete-primary-keys.md)|
|<span data-ttu-id="7393e-195">Explique comment modifier une clé primaire.</span><span class="sxs-lookup"><span data-stu-id="7393e-195">Describes how to modify a primary key.</span></span>|[<span data-ttu-id="7393e-196">Modifier des clés primaires</span><span class="sxs-lookup"><span data-stu-id="7393e-196">Modify Primary Keys</span></span>](../tables/modify-primary-keys.md)|
|<span data-ttu-id="7393e-197">Explique comment créer des relations de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7393e-197">Describes how to create foreign key relationships</span></span>|[<span data-ttu-id="7393e-198">Créer des relations de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7393e-198">Create Foreign Key Relationships</span></span>](../tables/create-foreign-key-relationships.md)|
|<span data-ttu-id="7393e-199">Décrit comment modifier les relations de clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="7393e-199">Describes how to modify foreign key relationships.</span></span>|[<span data-ttu-id="7393e-200">Modifier des relations de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7393e-200">Modify Foreign Key Relationships</span></span>](../tables/modify-foreign-key-relationships.md)|
|<span data-ttu-id="7393e-201">Décrit comment supprimer des relations de clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="7393e-201">Describes how to delete foreign key relationships.</span></span>|[<span data-ttu-id="7393e-202">Supprimer les relations entre les clés étrangères</span><span class="sxs-lookup"><span data-stu-id="7393e-202">Delete Foreign Key Relationships</span></span>](../tables/delete-foreign-key-relationships.md)|
|<span data-ttu-id="7393e-203">Décrit comment afficher les propriétés de clé étrangère.</span><span class="sxs-lookup"><span data-stu-id="7393e-203">Describes how to view foreign key properties.</span></span>|[<span data-ttu-id="7393e-204">Afficher les propriétés de clés étrangères</span><span class="sxs-lookup"><span data-stu-id="7393e-204">View Foreign Key Properties</span></span>](../tables/view-foreign-key-properties.md)|
|<span data-ttu-id="7393e-205">Décrit comment désactiver les contraintes de clé étrangère pour la réplication.</span><span class="sxs-lookup"><span data-stu-id="7393e-205">Describes how to disable foreign key constraints for replication.</span></span>|[<span data-ttu-id="7393e-206">Désactiver des contraintes de clé étrangère pour la réplication</span><span class="sxs-lookup"><span data-stu-id="7393e-206">Disable Foreign Key Constraints for Replication</span></span>](../tables/disable-foreign-key-constraints-for-replication.md)|
|<span data-ttu-id="7393e-207">Décrit comment désactiver les contraintes de clé étrangère pendant une instruction INSERT ou UPDATE.</span><span class="sxs-lookup"><span data-stu-id="7393e-207">Describes how to disable foreign key constraints during an INSERT or UPDATE statement.</span></span>|[<span data-ttu-id="7393e-208">Désactiver les contraintes de clé étrangère avec des instructions INSERT et UPDATE</span><span class="sxs-lookup"><span data-stu-id="7393e-208">Disable Foreign Key Constraints with INSERT and UPDATE Statements</span></span>](../tables/disable-foreign-key-constraints-with-insert-and-update-statements.md)|


