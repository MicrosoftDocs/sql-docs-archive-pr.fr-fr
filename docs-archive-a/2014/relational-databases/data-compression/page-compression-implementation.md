---
title: Implémentation de la compression de page | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
helpviewer_keywords:
- page compression [Database Engine]
- compression [SQL Server], page
ms.assetid: 78c83277-1dbb-4e07-95bd-47b14d2b5cd4
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: e6edba79d1548d68e60f406d370abd5354a62fcb
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612951"
---
# <a name="page-compression-implementation"></a><span data-ttu-id="45a8c-102">Implémentation de la compression de page</span><span class="sxs-lookup"><span data-stu-id="45a8c-102">Page Compression Implementation</span></span>
  <span data-ttu-id="45a8c-103">Cette rubrique récapitule la manière dont le [!INCLUDE[ssDE](../../includes/ssde-md.md)] implémente la compression de page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-103">This topic summarizes how the [!INCLUDE[ssDE](../../includes/ssde-md.md)] implements page compression.</span></span> <span data-ttu-id="45a8c-104">Elle fournit des informations de base qui vous aideront à planifier l'espace de stockage dont vous avez besoin pour vos données.</span><span class="sxs-lookup"><span data-stu-id="45a8c-104">This summary provides basic information to help you plan the storage space that you need for your data.</span></span>  
  
 <span data-ttu-id="45a8c-105">La compression de page est identique pour les tables, les partitions de table, les index et les partitions d'index.</span><span class="sxs-lookup"><span data-stu-id="45a8c-105">Page compression is similar for tables, table partitions, indexes, and index partitions.</span></span> <span data-ttu-id="45a8c-106">La compression de page qui est décrite ci-dessous pour une table peut s'appliquer de la même manière à tous les autres types d'objets.</span><span class="sxs-lookup"><span data-stu-id="45a8c-106">The following description of page compression for a table applies equally to page compression for all object types.</span></span> <span data-ttu-id="45a8c-107">Dans les exemples qui suivent, les chaînes de caractères sont compressées, mais la compression de préfixe et la compression de dictionnaire appliquent les mêmes principes aux autres types de données.</span><span class="sxs-lookup"><span data-stu-id="45a8c-107">The following examples compress character strings, but both prefix and dictionary compression apply the same principles to other data types.</span></span>  
  
 <span data-ttu-id="45a8c-108">La compression du niveau feuille des tables et des index avec la compression de page regroupe trois opérations réalisées dans l'ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="45a8c-108">Compressing the leaf level of tables and indexes with page compression consists of three operations in the following order:</span></span>  
  
1.  <span data-ttu-id="45a8c-109">Compression de ligne</span><span class="sxs-lookup"><span data-stu-id="45a8c-109">Row compression</span></span>  
  
2.  <span data-ttu-id="45a8c-110">Compression de préfixe</span><span class="sxs-lookup"><span data-stu-id="45a8c-110">Prefix compression</span></span>  
  
3.  <span data-ttu-id="45a8c-111">Compression de dictionnaire</span><span class="sxs-lookup"><span data-stu-id="45a8c-111">Dictionary compression</span></span>  
  
 <span data-ttu-id="45a8c-112">Quand vous utilisez la compression de page, les pages qui ne sont pas au niveau feuille sont compressées en utilisant uniquement la compression de ligne.</span><span class="sxs-lookup"><span data-stu-id="45a8c-112">When you use page compression, non-leaf-level pages of indexes are compressed by using only row compression.</span></span> <span data-ttu-id="45a8c-113">Pour plus d’informations sur la compression de ligne, consultez [Implémentation de la compression de ligne](../data-compression/row-compression-implementation.md).</span><span class="sxs-lookup"><span data-stu-id="45a8c-113">For more information about row compression, see [Row Compression Implementation](../data-compression/row-compression-implementation.md).</span></span>  
  
## <a name="prefix-compression"></a><span data-ttu-id="45a8c-114">Compression de préfixe</span><span class="sxs-lookup"><span data-stu-id="45a8c-114">Prefix Compression</span></span>  
 <span data-ttu-id="45a8c-115">Pour chaque page compressée, la compression de préfixe utilise les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="45a8c-115">For each page that is being compressed, prefix compression uses the following steps:</span></span>  
  
1.  <span data-ttu-id="45a8c-116">Pour chaque colonne, une valeur est identifiée qui peut être utilisée pour réduire l'espace de stockage des valeurs dans chaque colonne.</span><span class="sxs-lookup"><span data-stu-id="45a8c-116">For each column, a value is identified that can be used to reduce the storage space for the values in each column.</span></span>  
  
2.  <span data-ttu-id="45a8c-117">Une ligne qui représente les valeurs de préfixe de chaque colonne est créée et stockée dans la structure des informations de compression qui suit immédiatement l'en-tête de page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-117">A row that represents the prefix values for each column is created and stored in the compression information (CI) structure that immediately follows the page header.</span></span>  
  
3.  <span data-ttu-id="45a8c-118">Les valeurs de préfixe répétées dans la colonne sont remplacées par une référence au préfixe correspondant.</span><span class="sxs-lookup"><span data-stu-id="45a8c-118">The repeated prefix values in the column are replaced by a reference to the corresponding prefix.</span></span> <span data-ttu-id="45a8c-119">Si la valeur d'une ligne ne correspond pas exactement à la valeur de préfixe sélectionnée, une correspondance partielle peut encore être indiquée.</span><span class="sxs-lookup"><span data-stu-id="45a8c-119">If the value in a row does not exactly match the selected prefix value, a partial match can still be indicated.</span></span>  
  
 <span data-ttu-id="45a8c-120">L'illustration suivante montre un exemple de page d'une table avant la compression de préfixe.</span><span class="sxs-lookup"><span data-stu-id="45a8c-120">The following illustration shows a sample page of a table before prefix compression.</span></span>  
  
 <span data-ttu-id="45a8c-121">![Page avant compression de préfixe](../media/skt-tblcompression1c.gif "Page avant compression de préfixe")</span><span class="sxs-lookup"><span data-stu-id="45a8c-121">![Page before prefix compression](../media/skt-tblcompression1c.gif "Page before prefix compression")</span></span>  
  
 <span data-ttu-id="45a8c-122">L'illustration suivante montre la même page après compression de préfixe.</span><span class="sxs-lookup"><span data-stu-id="45a8c-122">The following illustration shows the same page after prefix compression.</span></span> <span data-ttu-id="45a8c-123">Le préfixe est déplacé vers l'en-tête et les valeurs des colonnes sont remplacées par des références au préfixe.</span><span class="sxs-lookup"><span data-stu-id="45a8c-123">The prefix is moved to the header, and the column values are changed to references to the prefix.</span></span>  
  
 <span data-ttu-id="45a8c-124">![Page après compression de préfixe](../media/tblcompression2.gif "Page après compression de préfixe")</span><span class="sxs-lookup"><span data-stu-id="45a8c-124">![Page after prefix compression](../media/tblcompression2.gif "Page after prefix compression")</span></span>  
  
 <span data-ttu-id="45a8c-125">Dans la première colonne de la première ligne, la valeur 4b indique que les quatre premiers caractères du préfixe (aaab) sont présents pour cette ligne, de même que le caractère b.</span><span class="sxs-lookup"><span data-stu-id="45a8c-125">In the first column of the first row, the value 4b indicates that the first four characters of the prefix (aaab) are present for that row, and also the character b.</span></span> <span data-ttu-id="45a8c-126">Cela donne donc la valeur aaabb, qui est la valeur d'origine.</span><span class="sxs-lookup"><span data-stu-id="45a8c-126">This makes the resultant value aaabb, which is the original value.</span></span>  
  
## <a name="dictionary-compression"></a><span data-ttu-id="45a8c-127">Compression de dictionnaire</span><span class="sxs-lookup"><span data-stu-id="45a8c-127">Dictionary Compression</span></span>  
 <span data-ttu-id="45a8c-128">Une fois la compression de préfixe terminée, la compression de dictionnaire est appliquée.</span><span class="sxs-lookup"><span data-stu-id="45a8c-128">After prefix compression has been completed, dictionary compression is applied.</span></span> <span data-ttu-id="45a8c-129">La compression de dictionnaire recherche les valeurs répétées n'importe où dans la page et les stocke dans la zone des informations de compression.</span><span class="sxs-lookup"><span data-stu-id="45a8c-129">Dictionary compression searches for repeated values anywhere on the page, and stores them in the CI area.</span></span> <span data-ttu-id="45a8c-130">Contrairement à la compression de préfixe, la compression de dictionnaire n'est pas limitée à une seule colonne.</span><span class="sxs-lookup"><span data-stu-id="45a8c-130">Unlike prefix compression, dictionary compression is not restricted to one column.</span></span> <span data-ttu-id="45a8c-131">La compression de dictionnaire peut remplacer des valeurs répétées qui apparaissent n'importe où sur une page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-131">Dictionary compression can replace repeated values that occur anywhere on a page.</span></span> <span data-ttu-id="45a8c-132">L'illustration suivante montre la même page après compression de dictionnaire.</span><span class="sxs-lookup"><span data-stu-id="45a8c-132">The following illustration shows the same page after dictionary compression.</span></span>  
  
 <span data-ttu-id="45a8c-133">![Page après compression de dictionnaire](../media/tblcompression3.gif "Page après compression de dictionnaire")</span><span class="sxs-lookup"><span data-stu-id="45a8c-133">![Page after dictionary compression](../media/tblcompression3.gif "Page after dictionary compression")</span></span>  
  
 <span data-ttu-id="45a8c-134">Notez que la valeur 4b a été référencée à partir de colonnes différentes de la page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-134">Note that the value 4b has been referenced from different columns of the page.</span></span>  
  
## <a name="when-page-compression-occurs"></a><span data-ttu-id="45a8c-135">Lorsque la compression de page se produit</span><span class="sxs-lookup"><span data-stu-id="45a8c-135">When Page Compression Occurs</span></span>  
 <span data-ttu-id="45a8c-136">Lorsqu'une table est créée avec compression de page, aucune compression ne se produit.</span><span class="sxs-lookup"><span data-stu-id="45a8c-136">When a new table is created that has page compression, no compression occurs.</span></span> <span data-ttu-id="45a8c-137">Toutefois, les métadonnées de la table indiquent que la compression de page doit être utilisée.</span><span class="sxs-lookup"><span data-stu-id="45a8c-137">However, the metadata for the table indicates that page compression should be used.</span></span> <span data-ttu-id="45a8c-138">Lorsque des données sont ajoutées à la première page de données, une compression de ligne est appliquée aux données.</span><span class="sxs-lookup"><span data-stu-id="45a8c-138">As data is added to the first data page, data is row-compressed.</span></span> <span data-ttu-id="45a8c-139">Dans la mesure où la page n'est pas pleine, la compression de page ne procure aucun avantage.</span><span class="sxs-lookup"><span data-stu-id="45a8c-139">Because the page is not full, no benefit is gained from page compression.</span></span> <span data-ttu-id="45a8c-140">Lorsque la page est pleine, la ligne suivante à ajouter lance l'opération de compression de page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-140">When the page is full, the next row to be added initiates the page compression operation.</span></span> <span data-ttu-id="45a8c-141">La page entière est examinée ; chaque colonne est évaluée pour la compression de préfixe, puis, toutes les colonnes sont évaluées pour la compression de dictionnaire.</span><span class="sxs-lookup"><span data-stu-id="45a8c-141">The whole page is reviewed; each column is evaluated for prefix compression, and then all columns are evaluated for dictionary compression.</span></span> <span data-ttu-id="45a8c-142">Si la compression de page a créé suffisamment de place sur la page pour insérer une ligne supplémentaire, la ligne est ajoutée, puis la compression de ligne et la compression de page sont appliquées aux données.</span><span class="sxs-lookup"><span data-stu-id="45a8c-142">If page compression has created enough room on the page for an additional row, the row is added, and the data is both row- and page-compressed.</span></span> <span data-ttu-id="45a8c-143">Si l'espace gagné par la compression de page moins l'espace requis pour la structure des informations de compression n'est pas significatif, la compression de page n'est pas utilisée pour cette page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-143">If the space gained by page compression minus the space that is required for the CI structure is not significant, page compression is not used for that page.</span></span> <span data-ttu-id="45a8c-144">Soit les prochaines lignes rentrent dans la nouvelle page, soit elles ne rentrent pas et une nouvelle page est ajoutée à la table.</span><span class="sxs-lookup"><span data-stu-id="45a8c-144">Future rows either fit onto the new page or, if they do not fit, a new page is added to the table.</span></span> <span data-ttu-id="45a8c-145">Comme pour la première page, la compression de page n'est pas directement appliquée à la nouvelle page.</span><span class="sxs-lookup"><span data-stu-id="45a8c-145">Similar to the first page, the new page is not at first page-compressed.</span></span>  
  
 <span data-ttu-id="45a8c-146">Lorsqu'une table existante contenant des données est convertie en compression de page, chaque page est reconstruite et évaluée.</span><span class="sxs-lookup"><span data-stu-id="45a8c-146">When an existing table that contains data is converted to page compression, each page is rebuilt and evaluated.</span></span> <span data-ttu-id="45a8c-147">La reconstruction de toutes les pages provoque la reconstruction de la table, de l'index ou de la partition.</span><span class="sxs-lookup"><span data-stu-id="45a8c-147">Rebuilding all the pages causes the rebuilding of the table, index, or partition.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="45a8c-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="45a8c-148">See Also</span></span>  
 <span data-ttu-id="45a8c-149">[Compression de données](data-compression.md) </span><span class="sxs-lookup"><span data-stu-id="45a8c-149">[Data Compression](data-compression.md) </span></span>  
 [<span data-ttu-id="45a8c-150">Implémentation de la compression de ligne</span><span class="sxs-lookup"><span data-stu-id="45a8c-150">Row Compression Implementation</span></span>](row-compression-implementation.md)  
  
  
