---
title: Mise à jour d’une application pour SQL Server Native Client à partir de MDAC | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- SQLNCLI, vs. MDAC
- SQL Server Native Client, vs. MDAC
- data access [SQL Server Native Client], vs. MDAC
- SQL Server Native Client, updating applications
ms.assetid: 2860efdd-c59a-4deb-8a0e-5124a8f4e6dd
author: rothja
ms.author: jroth
ms.openlocfilehash: 804f4340f3ca9a381f28507e0516d5f2e7d913a6
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706399"
---
# <a name="updating-an-application-to-sql-server-native-client-from-mdac"></a><span data-ttu-id="2c086-102">Mise à jour d'une application vers SQL Server Native Client à partir de MDAC</span><span class="sxs-lookup"><span data-stu-id="2c086-102">Updating an Application to SQL Server Native Client from MDAC</span></span>
  <span data-ttu-id="2c086-103">Il existe plusieurs différences entre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client et MDAC (Microsoft Data Access Components). Notez qu'à compter de Windows Vista, MDAC prend le nom de « Windows DAC » (Windows Data Access Components).</span><span class="sxs-lookup"><span data-stu-id="2c086-103">There are a number of differences between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and Microsoft Data Access Components (MDAC; starting with Windows Vista, the data access components are now called Windows Data Access Components, or Windows DAC).</span></span> <span data-ttu-id="2c086-104">Même si ces deux solutions fournissent aux données natives un accès aux bases de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client a été spécialement conçu pour exposer les nouvelles fonctionnalités de [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], tout en restant compatible avec les versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="2c086-104">Although both provide native data access to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client has been specifically designed to expose the new features of [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], while at the same time maintaining backward compatibility with earlier versions.</span></span>  
  
 <span data-ttu-id="2c086-105">Les informations contenues dans cette rubrique permettent de mettre à jour votre application MDAC (ou Windows DAC) pour la rendre conforme à la version de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fournie avec [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2c086-105">The information in this topic helps update your MDAC (or Windows DAC) application to be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that was included in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="2c086-106">Pour vous aider à rendre cette application à jour avec la version de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fournie dans [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] , consultez [mise à jour d’une application à partir de SQL Server Native Client 2005](updating-an-application-from-sql-server-2005-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="2c086-106">To help you make this application be current with the version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client that shipped in [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)], see [Updating an Application from SQL Server 2005 Native Client](updating-an-application-from-sql-server-2005-native-client.md).</span></span>  
  
 <span data-ttu-id="2c086-107">Par ailleurs, bien que MDAC contienne des composants permettant d'utiliser OLE DB, ODBC et des objets ADO (ActiveX Data Object), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implémente uniquement OLE DB et ODBC (bien que les objets ADO puissent accéder aux fonctionnalités de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span><span class="sxs-lookup"><span data-stu-id="2c086-107">In addition, although MDAC contains components for using OLE DB, ODBC, and ActiveX Data Objects (ADO), [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client only implements OLE DB and ODBC (although ADO can access the functionality of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client).</span></span>  
  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-108">Native Client et MDAC diffèrent également dans les domaines suivants :</span><span class="sxs-lookup"><span data-stu-id="2c086-108">Native Client and MDAC differ in the other following areas:</span></span>  
  
-   <span data-ttu-id="2c086-109">Les utilisateurs qui utilisent des objets ADO pour accéder à un fournisseur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client peuvent trouver moins de fonctionnalités de filtrage qu'en accédant à un fournisseur OLE DB SQL.</span><span class="sxs-lookup"><span data-stu-id="2c086-109">Users who use ADO to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client provider may find less filtering functionality than when they accessed a SQL OLE DB provider.</span></span>  
  
-   <span data-ttu-id="2c086-110">Si une application ADO utilise [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client et qu'elle tente de mettre à jour une colonne calculée, une erreur est signalée.</span><span class="sxs-lookup"><span data-stu-id="2c086-110">If an ADO application uses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and attempts to update a computed column, an error will be reported.</span></span> <span data-ttu-id="2c086-111">Avec MDAC, la mise à jour était acceptée mais ignorée.</span><span class="sxs-lookup"><span data-stu-id="2c086-111">With MDAC the update was accepted but ignored.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-112">Native Client est un fichier bibliothèque de liens dynamiques (DLL) autonome unique.</span><span class="sxs-lookup"><span data-stu-id="2c086-112">Native Client is a single self-contained dynamic link library (DLL) file.</span></span> <span data-ttu-id="2c086-113">Les interfaces exposées publiquement ont été limitées en nombre pour faciliter la distribution et limiter l'exposition de sécurité.</span><span class="sxs-lookup"><span data-stu-id="2c086-113">The publicly exposed interfaces have been kept to a minimum, both to ease distribution, as well as to limit security exposure.</span></span>  
  
-   <span data-ttu-id="2c086-114">Seules les interfaces OLE DB et ODBC sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="2c086-114">Only OLE DB and ODBC interfaces are supported.</span></span>  
  
-   <span data-ttu-id="2c086-115">Le fournisseur OLE DB Native Client [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et les noms de pilote ODBC sont différents de ceux utilisés avec MDAC.</span><span class="sxs-lookup"><span data-stu-id="2c086-115">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and ODBC driver names are different from those used with MDAC.</span></span>  
  
-   <span data-ttu-id="2c086-116">Les fonctionnalités accessibles à l'utilisateur fournies par les composants MDAC sont disponibles lorsque vous utilisez [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2c086-116">User-accessible functionality supplied by MDAC components is available when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="2c086-117">Cela comprend, entre autres, le regroupement de connexions, la prise en charge des objets ADO et la prise en charge du curseur client.</span><span class="sxs-lookup"><span data-stu-id="2c086-117">This includes, but is not limited to, the following: connection pooling, ADO support, and client cursor support.</span></span> <span data-ttu-id="2c086-118">Lorsque l'une de ces fonctionnalités est utilisée, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client fournit uniquement la connectivité de base de données.</span><span class="sxs-lookup"><span data-stu-id="2c086-118">When any of these features are used, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supplies only database connectivity.</span></span> <span data-ttu-id="2c086-119">MDAC fournit des fonctionnalités telles que le suivi, des contrôles de gestion et des compteurs de performance.</span><span class="sxs-lookup"><span data-stu-id="2c086-119">MDAC provides functionality such as tracing, management controls, and performance counters.</span></span>  
  
-   <span data-ttu-id="2c086-120">Les applications peuvent utiliser les services principaux OLE DB avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, mais si elles utilisent le moteur de curseur OLE DB, elles doivent utiliser l'option de compatibilité du type de données pour éviter tout problème pouvant résulter du fait que le moteur de curseur n'a pas connaissance des nouveaux types de données [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2c086-120">Applications can use OLE DB core services with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but if using the OLE DB cursor engine, they should use the data type compatibility option to avoid any potential problems that might arise because the cursor engine has no knowledge of the new [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] data types.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-121">Native Client prend en charge l'accès aux bases de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] précédentes.</span><span class="sxs-lookup"><span data-stu-id="2c086-121">Native Client supports access to previous [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] databases.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-122">Native Client n'offre pas l'intégration XML.</span><span class="sxs-lookup"><span data-stu-id="2c086-122">Native Client does not contain XML integration.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="2c086-123">Native Client prend en charge SELECT... Les requêtes FOR XML, mais ne prennent pas en charge d’autres fonctionnalités XML.</span><span class="sxs-lookup"><span data-stu-id="2c086-123">Native Client supports SELECT ... FOR XML queries, but does not support any other XML functionality.</span></span> <span data-ttu-id="2c086-124">Toutefois, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client prend en charge le type de données `xml` introduit dans [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2c086-124">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does support the `xml` data type introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-125">Native Client prend uniquement en charge la configuration de bibliothèques réseau côté client à l'aide d'attributs de chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="2c086-125">Native Client supports configuring client-side network libraries using only connection string attributes.</span></span> <span data-ttu-id="2c086-126">Pour configurer une bibliothèque réseau de manière plus complète, vous devez utiliser le Gestionnaire de configuration [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2c086-126">If you need more complete network library configuration, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-127">Native Client n'est pas compatible avec odbcbcp.dll.</span><span class="sxs-lookup"><span data-stu-id="2c086-127">Native Client is not compatible with odbcbcp.dll.</span></span> <span data-ttu-id="2c086-128">Les applications qui utilisent à la fois des API ODBC et **BCP** doivent être reconstruites pour être liées à SQLNCLI11. lib afin d’utiliser [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2c086-128">Applications that use both ODBC and **bcp** APIs must be rebuilt to link with sqlncli11.lib in order to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-129">Native Client n'est pas pris en charge à partir du fournisseur Microsoft OLE DB pour ODBC (MSDASQL).</span><span class="sxs-lookup"><span data-stu-id="2c086-129">Native Client is not supported from the Microsoft OLE DB provider for ODBC (MSDASQL).</span></span> <span data-ttu-id="2c086-130">Si vous utilisez le pilote MDAC SQLODBC avec MSDASQL ou le pilote MDAC SQLODBC avec ADO, utilisez OLE DB dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2c086-130">If you are using the MDAC SQLODBC driver with MSDASQL or MDAC SQLODBC driver with ADO, use OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client..</span></span>  
  
-   <span data-ttu-id="2c086-131">Les chaînes de connexion MDAC autorisent une valeur booléenne ( `true` ) pour le mot clé **Trusted_Connection** .</span><span class="sxs-lookup"><span data-stu-id="2c086-131">MDAC connection strings allow a Boolean value (`true`) for the **Trusted_Connection** keyword.</span></span> <span data-ttu-id="2c086-132">Une [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] chaîne de connexion Native Client doit utiliser `yes` ou **non**.</span><span class="sxs-lookup"><span data-stu-id="2c086-132">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client connection string must use `yes` or **no**.</span></span>  
  
-   <span data-ttu-id="2c086-133">Des changements mineurs affectent les avertissements et les erreurs.</span><span class="sxs-lookup"><span data-stu-id="2c086-133">Minor changes have occurred to warnings and errors.</span></span> <span data-ttu-id="2c086-134">Les avertissements et les erreurs retournées par le serveur conservent désormais la même gravité lorsqu'ils sont passés à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2c086-134">Warnings and errors returned by the server now retain the same severity when passed to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="2c086-135">Vous devez vous assurer d'avoir rigoureusement testé votre application si vous comptez sur l'interception d'avertissements et d'erreurs particuliers.</span><span class="sxs-lookup"><span data-stu-id="2c086-135">You should ensure you have thoroughly tested your application if you depend on trapping particular warnings and errors.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-136">Native Client effectue une vérification des erreurs plus stricte que MDAC, ce qui signifie que certaines applications qui ne sont pas strictement conformes aux spécifications ODBC et OLE DB peuvent se comporter différemment.</span><span class="sxs-lookup"><span data-stu-id="2c086-136">Native Client has stricter error checking than MDAC, which means that some applications that do not conform strictly to the ODBC and OLE DB specifications may behave differently.</span></span> <span data-ttu-id="2c086-137">Par exemple, le fournisseur SQLOLEDB n’appliquait pas la règle selon laquelle les noms de paramètres doivent commencer par « \@ » pour les paramètres de résultat, contrairement au [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur Native Client OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2c086-137">For example, the SQLOLEDB provider did not enforce the rule that parameter names must start with '\@' for result parameters, but the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-138">Native Client se comporte différemment de MDAC en ce qui concerne les connexions échouées.</span><span class="sxs-lookup"><span data-stu-id="2c086-138">Native Client behaves differently from MDAC in regards to failed connections.</span></span> <span data-ttu-id="2c086-139">Par exemple, MDAC retourne des valeurs de propriété mises en cache pour une connexion qui a échoué, alors que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client signale une erreur à l'application appelante.</span><span class="sxs-lookup"><span data-stu-id="2c086-139">For example, MDAC returns cached property values for a connection that has failed, whereas [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client reports an error to the calling application.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-140">Native Client ne génère pas d'événements Visual Studio Analyzer, mais il génère à la place des événements de suivi Windows.</span><span class="sxs-lookup"><span data-stu-id="2c086-140">Native Client does not generate Visual Studio Analyzer events, but instead generates Windows tracing events.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-141">Native Client ne peut pas être utilisé avec perfmon.</span><span class="sxs-lookup"><span data-stu-id="2c086-141">Native Client cannot be used with perfmon.</span></span> <span data-ttu-id="2c086-142">Perfmon est un outil Windows qui peut être uniquement utilisé avec des noms de source de données (DSN) qui utilisent le pilote MDAC SQLODBC inclus avec Windows.</span><span class="sxs-lookup"><span data-stu-id="2c086-142">Perfmon is a Windows tool that can only be used with DSNs that use the MDAC SQLODBC driver included with Windows.</span></span>  
  
-   <span data-ttu-id="2c086-143">Lorsque [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client est connecté à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] et versions ultérieures, l'erreur de serveur 16947 est retournée en tant qu'erreur (SQL_ERROR).</span><span class="sxs-lookup"><span data-stu-id="2c086-143">When [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client is connected to [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] and later versions, server error 16947 is returned as a SQL_ERROR.</span></span> <span data-ttu-id="2c086-144">Cette erreur se produit lorsqu'une mise à jour ou une suppression positionnée ne parvient pas à mettre à jour ou à supprimer une ligne.</span><span class="sxs-lookup"><span data-stu-id="2c086-144">This error occurs when a positioned update or delete fails to update or delete a row.</span></span> <span data-ttu-id="2c086-145">Avec MDAC lors de la connexion à n'importe quelle version de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], l'erreur de serveur 16947 est retournée en tant qu'avertissement (SQL_SUCCESS_WITH_INFO).</span><span class="sxs-lookup"><span data-stu-id="2c086-145">With MDAC when connecting to any version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], server error 16947 is returned as a warning (SQL_SUCCESS_WITH_INFO).</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="2c086-146">Native Client implémente l’interface **IDBDataSourceAdmin** , qui est une interface OLE DB facultative qui n’a pas été implémentée précédemment, mais seule la méthode **CreateDataSource** de cette interface facultative est implémentée.</span><span class="sxs-lookup"><span data-stu-id="2c086-146">Native Client implements the **IDBDataSourceAdmin** interface, which is an optional OLE DB interface that was not previously implemented, but only the **CreateDataSource** method of this optional interface is implemented.</span></span> [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  
  
-   <span data-ttu-id="2c086-147">Le fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client retourne des synonymes dans les ensembles de lignes de schéma TABLES et TABLE_INFO, avec la valeur SYNONYM attribuée à TABLE_TYPE.</span><span class="sxs-lookup"><span data-stu-id="2c086-147">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns synonyms in the TABLES and TABLE_INFO schema rowsets, with TABLE_TYPE set to SYNONYM.</span></span>  
  
-   <span data-ttu-id="2c086-148">Les valeurs de retour de type de données,,,, `varchar(max)` `nvarchar(max)` ou d' `varbinary(max)` `xml` `udt` autres types d’objets volumineux ne peuvent pas être retournées aux versions clientes antérieures à [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2c086-148">Return values of data type `varchar(max)`, `nvarchar(max)`, `varbinary(max)`, `xml`, `udt`, or other large object types can not be returned to client versions earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="2c086-149">Si vous souhaitez utiliser ces types comme valeurs de retour, vous devez utiliser [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="2c086-149">If you wish to use these types as return values, you must use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span>  
  
-   <span data-ttu-id="2c086-150">Contrairement à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, MDAC permet l'exécution des instructions suivantes au démarrage de transactions manuelles et implicites.</span><span class="sxs-lookup"><span data-stu-id="2c086-150">MDAC allows the following statements to be executed at the start of manual and implicit transactions, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not.</span></span> <span data-ttu-id="2c086-151">Elles doivent être exécutées en mode de validation automatique.</span><span class="sxs-lookup"><span data-stu-id="2c086-151">They must be executed in autocommit mode.</span></span>  
  
    -   <span data-ttu-id="2c086-152">Tous les opérations de texte intégral (DDL d'index et de catalogue)</span><span class="sxs-lookup"><span data-stu-id="2c086-152">All full-text operations (index and catalog DDL)</span></span>  
  
    -   <span data-ttu-id="2c086-153">Toutes les opérations de base de données (create database, alter database, drop database)</span><span class="sxs-lookup"><span data-stu-id="2c086-153">All database operations (create database, alter database, drop database)</span></span>  
  
    -   <span data-ttu-id="2c086-154">Reconfigurer</span><span class="sxs-lookup"><span data-stu-id="2c086-154">Reconfigure</span></span>  
  
    -   <span data-ttu-id="2c086-155">Shutdown</span><span class="sxs-lookup"><span data-stu-id="2c086-155">Shutdown</span></span>  
  
    -   <span data-ttu-id="2c086-156">Tuer</span><span class="sxs-lookup"><span data-stu-id="2c086-156">Kill</span></span>  
  
    -   <span data-ttu-id="2c086-157">Sauvegarde</span><span class="sxs-lookup"><span data-stu-id="2c086-157">Backup</span></span>  
  
-   <span data-ttu-id="2c086-158">Lorsque des applications MDAC se connectent à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les types de données introduits dans [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] apparaissent en tant que types de données compatibles avec [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], comme indiqué dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="2c086-158">When MDAC applications connect to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the data types introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] will appear as [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)]-compatible data types as shown in the following table.</span></span>  
  
    |<span data-ttu-id="2c086-159">Type SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="2c086-159">SQL Server 2005 type</span></span>|<span data-ttu-id="2c086-160">Type SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="2c086-160">SQL Server 2000 type</span></span>|  
    |--------------------------|--------------------------|  
    |`varchar(max)`|`text`|  
    |`nvarchar(max)`|`ntext`|  
    |`varbinary(max)`|`image`|  
    |`udt`|`varbinary`|  
    |`xml`|`ntext`|  
  
     <span data-ttu-id="2c086-161">Ce mappage de type affecte les valeurs retournées pour les métadonnées de colonne.</span><span class="sxs-lookup"><span data-stu-id="2c086-161">This type mapping affects the values returned for column metadata.</span></span> <span data-ttu-id="2c086-162">Par exemple, une `text` colonne a une taille maximale de 2 147 483 647, mais [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC signale la taille maximale des `varchar(max)` colonnes comme SQL_SS_LENGTH_UNLIMITED, et [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB signale la taille maximale des `varchar(max)` colonnes comme 2 147 483 647 ou-1, en fonction de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="2c086-162">For example, a `text` column has a maximum size of 2,147,483,647, but [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC reports the maximum size of `varchar(max)` columns as SQL_SS_LENGTH_UNLIMITED, and [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB reports the maximum size of `varchar(max)` columns as 2,147,483,647 or -1, depending on platform.</span></span>  
  
-   [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="2c086-163">Native Client autorise l'ambiguïté dans les chaînes de connexion (par exemple, quelques mots clés peuvent être spécifiés plusieurs fois et des mots clés en conflit peuvent être autorisés avec la résolution basée sur la position ou la précédence) pour des raisons de compatibilité descendante.</span><span class="sxs-lookup"><span data-stu-id="2c086-163">Native Client allows ambiguity in connection strings (for example, some keywords may be specified more than once, and conflicting keywords may be allowed with resolution based on position or precedence) for reasons of backward compatibility.</span></span> <span data-ttu-id="2c086-164">Les versions ultérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client n'autoriseront peut-être pas l'ambiguïté dans les chaînes de connexion.</span><span class="sxs-lookup"><span data-stu-id="2c086-164">Future releases of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client might not allow ambiguity in connection strings.</span></span> <span data-ttu-id="2c086-165">Lors de la modification d'applications, il est conseillé d'utiliser [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client pour éliminer toute dépendance vis-à-vis de l'ambiguïté de chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="2c086-165">It is good practice when modifying applications to use [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to eliminate any dependency on connection string ambiguity.</span></span>  
  
-   <span data-ttu-id="2c086-166">Si vous utilisez un appel ODBC ou OLE DB pour démarrer des transactions, une différence de comportement existe entre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client et MDAC : les transactions commencent immédiatement avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, tandis qu'elles commencent après le premier accès à la base de données avec MDAC.</span><span class="sxs-lookup"><span data-stu-id="2c086-166">If you use an ODBC or OLE DB call to start transactions, there is a difference in behavior between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC; transactions will begin immediately with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, but transactions will begin after the first database access using MDAC.</span></span> <span data-ttu-id="2c086-167">Cela peut affecter le comportement des procédures stockées et des lots, car [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requiert \@ \@ la valeur de TRANCOUNT après la fin de l’exécution d’un traitement ou d’une procédure stockée, comme c’était le cas lors du démarrage du traitement ou de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="2c086-167">This can affect the behavior of stored procedures and batches because [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] requires \@\@TRANCOUNT to be the same after a batch or stored procedure finishes execution as it was when the batch or stored procedure started.</span></span>  
  
-   <span data-ttu-id="2c086-168">Avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal :: BeginTransaction entraîne le démarrage immédiat d’une transaction.</span><span class="sxs-lookup"><span data-stu-id="2c086-168">With [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, ITransactionLocal::BeginTransaction will cause a transaction to be started immediately.</span></span> <span data-ttu-id="2c086-169">Avec MDAC le démarrage de transaction est différé jusqu'à ce que l'application exécute une instruction qui requiert une transaction en mode de transaction implicite.</span><span class="sxs-lookup"><span data-stu-id="2c086-169">With MDAC the transaction start was delayed until the application executed a statement which required a transaction in implicit transaction mode.</span></span> <span data-ttu-id="2c086-170">Pour plus d’informations, consultez [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2c086-170">For more information, see [SET IMPLICIT_TRANSACTIONS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-implicit-transactions-transact-sql).</span></span>  
  
-   <span data-ttu-id="2c086-171">Vous pouvez rencontrer des erreurs lors de l’utilisation d' [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] un pilote client natif avec System. Data. ODBC pour accéder à un [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] serveur qui expose de nouveaux [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] types de données ou fonctionnalités spécifiques.</span><span class="sxs-lookup"><span data-stu-id="2c086-171">You might encounter errors when using [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver with System.Data.Odbc to access a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] server computer that exposes new, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific data types or features.</span></span> <span data-ttu-id="2c086-172">System. Data. ODBC fournit une implémentation ODBC générique et n’expose pas par la suite de fonctionnalités ou d’extensions spécifiques au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2c086-172">System.Data.Odbc provides a generic ODBC implementation and subsequently does not expose vendor specific functionality or extensions.</span></span> <span data-ttu-id="2c086-173">(Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Le pilote Native Client est mis à jour pour prendre en charge en mode natif les fonctionnalités les plus récentes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .) Pour contourner ce problème, vous pouvez soit revenir à MDAC, soit migrer vers System. Data. SqlClient.</span><span class="sxs-lookup"><span data-stu-id="2c086-173">(The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver is updated to natively support the latest [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] features.) To workaround this issue, you can either revert to MDAC, or migrate to System.Data.SqlClient.</span></span>  
  
 <span data-ttu-id="2c086-174">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client et MDAC prennent en charge l'isolation de la transaction de lecture validée à l'aide du contrôle de version de ligne, mais seul [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client prend en charge l'isolation de la transaction d'instantané.</span><span class="sxs-lookup"><span data-stu-id="2c086-174">Both [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client and MDAC support read committed transaction isolation using row versioning, but only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports snapshot transaction isolation.</span></span> <span data-ttu-id="2c086-175">(En termes de programmation, l'isolation de la transaction de lecture validée à l'aide du contrôle de version de ligne est la même chose que la transaction de lecture validée.)</span><span class="sxs-lookup"><span data-stu-id="2c086-175">(In programming terms, read committed transaction isolation using row versioning is the same as read-committed transaction.).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2c086-176">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2c086-176">See Also</span></span>  
 [<span data-ttu-id="2c086-177">Génération d’applications avec SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="2c086-177">Building Applications with SQL Server Native Client</span></span>](building-applications-with-sql-server-native-client.md)  
  
  
