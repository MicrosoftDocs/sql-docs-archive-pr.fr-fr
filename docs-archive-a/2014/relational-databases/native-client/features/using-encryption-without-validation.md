---
title: Utilisation du chiffrement sans validation | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], encryption
- cryptography [SQL Server Native Client]
- SQLNCLI, encryption
- encryption [SQL Server Native Client]
- SQL Server Native Client, encryption
ms.assetid: f4c63206-80bb-4d31-84ae-ccfcd563effa
author: rothja
ms.author: jroth
ms.openlocfilehash: 0a6d2e8b3d696a92e3fa3e1b7de7604551d4f9ce
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602108"
---
# <a name="using-encryption-without-validation"></a><span data-ttu-id="11ac4-102">Utilisation du chiffrement sans validation</span><span class="sxs-lookup"><span data-stu-id="11ac4-102">Using Encryption Without Validation</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="11ac4-103">chiffre toujours les paquets réseau associés à l’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="11ac4-103">always encrypts network packets associated with logging in.</span></span> <span data-ttu-id="11ac4-104">Si aucun certificat n'a été fourni sur le serveur à son démarrage, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] génère un certificat auto-signé qui est utilisé pour chiffrer les paquets d’ouverture de session.</span><span class="sxs-lookup"><span data-stu-id="11ac4-104">If no certificate has been provisioned on the server when it starts up, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] generates a self-signed certificate which is used to encrypt login packets.</span></span>  
  
 <span data-ttu-id="11ac4-105">Les applications peuvent également demander le chiffrement de tout le trafic réseau en utilisant des mots clés de chaîne de connexion ou des propriétés de connexion.</span><span class="sxs-lookup"><span data-stu-id="11ac4-105">Applications may also request encryption of all network traffic by using connection string keywords or connection properties.</span></span> <span data-ttu-id="11ac4-106">Les mots clés sont « Encrypt » pour ODBC et OLE DB lors de l’utilisation d’une chaîne de fournisseur avec **IDBInitialize :: Initialize**, ou « utiliser le chiffrement pour les données » pour ADO et OLE DB lors de l’utilisation d’une chaîne d’initialisation avec **IDataInitialize**.</span><span class="sxs-lookup"><span data-stu-id="11ac4-106">The keywords are "Encrypt" for ODBC and OLE DB when using a provider string with **IDbInitialize::Initialize**, or "Use Encryption for Data" for ADO and OLE DB when using an initialization string with **IDataInitialize**.</span></span> <span data-ttu-id="11ac4-107">Cela peut également être configuré par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager à l’aide de l’option **forcer le chiffrement du protocole** .</span><span class="sxs-lookup"><span data-stu-id="11ac4-107">This may also be configured by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager using the **Force Protocol Encryption** option.</span></span> <span data-ttu-id="11ac4-108">Par défaut, le chiffrement de tout le trafic réseau pour une connexion requiert la fourniture d'un certificat sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="11ac4-108">By default, encryption of all network traffic for a connection requires that a certificate be provisioned on the server.</span></span>  
  
 <span data-ttu-id="11ac4-109">Pour plus d’informations sur les mots clés de chaîne de connexion, consultez [utilisation de mots clés de chaîne de connexion avec SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="11ac4-109">For information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="11ac4-110">Pour activer le chiffrement à utiliser quand aucun certificat n’a été provisionné sur le serveur, le Gestionnaire de configuration [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] peut être utilisé pour définir les options **Forcer le chiffrement du protocole** et **Faire confiance au certificat de serveur**.</span><span class="sxs-lookup"><span data-stu-id="11ac4-110">To enable encryption to be used when a certificate has not been provisioned on the server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Configuration Manager can be used to set both the **Force Protocol Encryption** and the **Trust Server Certificate** options.</span></span> <span data-ttu-id="11ac4-111">Dans ce cas, le chiffrement utilise un certificat de serveur auto-signé sans validation si aucun certificat vérifiable n'a été fourni sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="11ac4-111">In this case, encryption will use a self-signed server certificate without validation if no verifiable certificate has been provisioned on the server.</span></span>  
  
 <span data-ttu-id="11ac4-112">Les applications peuvent également utiliser le mot clé « TrustServerCertificat » ou son attribut de connexion associé pour garantir que le chiffrement est réalisé.</span><span class="sxs-lookup"><span data-stu-id="11ac4-112">Applications may also use the "TrustServerCertificate" keyword or its associated connection attribute to guarantee that encryption takes place.</span></span> <span data-ttu-id="11ac4-113">Les paramètres de l'application ne réduisent jamais le niveau de sécurité défini par le Gestionnaire de configuration du client [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], mais peuvent le renforcer.</span><span class="sxs-lookup"><span data-stu-id="11ac4-113">Application settings never reduce the level of security set by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Client Configuration Manager, but may strengthen it.</span></span> <span data-ttu-id="11ac4-114">Par exemple, si l’option **Forcer le chiffrement du protocole** n’est pas définie pour le client, une application peut demander elle-même le chiffrement.</span><span class="sxs-lookup"><span data-stu-id="11ac4-114">For example, if **Force Protocol Encryption** is not set for the client, an application may request encryption itself.</span></span> <span data-ttu-id="11ac4-115">Pour garantir le chiffrement même si aucun certificat de serveur n'a été fourni, une application peut demander le chiffrement et « TrustServerCertificate ».</span><span class="sxs-lookup"><span data-stu-id="11ac4-115">To guarantee encryption even when a server certificate has not been provisioned, an application may request encryption and "TrustServerCertificate".</span></span> <span data-ttu-id="11ac4-116">Toutefois, si« TrustServerCertificate » n'est pas activé dans la configuration client, un certificat de serveur fourni est toujours requis.</span><span class="sxs-lookup"><span data-stu-id="11ac4-116">However, if "TrustServerCertificate" is not enabled in the client configuration, a provisioned server certificate is still required.</span></span> <span data-ttu-id="11ac4-117">Le tableau ci-dessous décrit l'ensembles des scénarios :</span><span class="sxs-lookup"><span data-stu-id="11ac4-117">The following table describes all cases:</span></span>  
  
|<span data-ttu-id="11ac4-118">Paramètre client Forcer le chiffrement du protocole</span><span class="sxs-lookup"><span data-stu-id="11ac4-118">Force Protocol Encryption client setting</span></span>|<span data-ttu-id="11ac4-119">Paramètre client Faire confiance au certificat de serveur</span><span class="sxs-lookup"><span data-stu-id="11ac4-119">Trust Server Certificate client setting</span></span>|<span data-ttu-id="11ac4-120">Chaîne de connexion/attribut de connexion Encrypt/Use Encryption for Data</span><span class="sxs-lookup"><span data-stu-id="11ac4-120">Connection string/connection attribute Encrypt/Use Encryption for Data</span></span>|<span data-ttu-id="11ac4-121">Chaîne de connexion/attribut de connexion Trust Server Certificate</span><span class="sxs-lookup"><span data-stu-id="11ac4-121">Connection string/connection attribute Trust Server Certificate</span></span>|<span data-ttu-id="11ac4-122">Résultats</span><span class="sxs-lookup"><span data-stu-id="11ac4-122">Result</span></span>|  
|----------------------------------------------|---------------------------------------------|------------------------------------------------------------------------------|----------------------------------------------------------------------|------------|  
|<span data-ttu-id="11ac4-123">Non</span><span class="sxs-lookup"><span data-stu-id="11ac4-123">No</span></span>|<span data-ttu-id="11ac4-124">N/A</span><span class="sxs-lookup"><span data-stu-id="11ac4-124">N/A</span></span>|<span data-ttu-id="11ac4-125">Non (par défaut)</span><span class="sxs-lookup"><span data-stu-id="11ac4-125">No (default)</span></span>|<span data-ttu-id="11ac4-126">Ignoré</span><span class="sxs-lookup"><span data-stu-id="11ac4-126">Ignored</span></span>|<span data-ttu-id="11ac4-127">Aucun chiffrement ne se produit.</span><span class="sxs-lookup"><span data-stu-id="11ac4-127">No encryption occurs.</span></span>|  
|<span data-ttu-id="11ac4-128">Non</span><span class="sxs-lookup"><span data-stu-id="11ac4-128">No</span></span>|<span data-ttu-id="11ac4-129">N/A</span><span class="sxs-lookup"><span data-stu-id="11ac4-129">N/A</span></span>|<span data-ttu-id="11ac4-130">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-130">Yes</span></span>|<span data-ttu-id="11ac4-131">Non (par défaut)</span><span class="sxs-lookup"><span data-stu-id="11ac4-131">No (default)</span></span>|<span data-ttu-id="11ac4-132">Le chiffrement se produit uniquement s'il existe un certificat de serveur vérifiable ; sinon, la tentative de connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="11ac4-132">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="11ac4-133">Non</span><span class="sxs-lookup"><span data-stu-id="11ac4-133">No</span></span>|<span data-ttu-id="11ac4-134">N/A</span><span class="sxs-lookup"><span data-stu-id="11ac4-134">N/A</span></span>|<span data-ttu-id="11ac4-135">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-135">Yes</span></span>|<span data-ttu-id="11ac4-136">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-136">Yes</span></span>|<span data-ttu-id="11ac4-137">Le chiffrement se produit toujours, mais peut utiliser un certificat de serveur auto-signé.</span><span class="sxs-lookup"><span data-stu-id="11ac4-137">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="11ac4-138">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-138">Yes</span></span>|<span data-ttu-id="11ac4-139">Non</span><span class="sxs-lookup"><span data-stu-id="11ac4-139">No</span></span>|<span data-ttu-id="11ac4-140">Ignoré</span><span class="sxs-lookup"><span data-stu-id="11ac4-140">Ignored</span></span>|<span data-ttu-id="11ac4-141">Ignoré</span><span class="sxs-lookup"><span data-stu-id="11ac4-141">Ignored</span></span>|<span data-ttu-id="11ac4-142">Le chiffrement se produit uniquement s'il existe un certificat de serveur vérifiable ; sinon, la tentative de connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="11ac4-142">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="11ac4-143">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-143">Yes</span></span>|<span data-ttu-id="11ac4-144">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-144">Yes</span></span>|<span data-ttu-id="11ac4-145">Non (par défaut)</span><span class="sxs-lookup"><span data-stu-id="11ac4-145">No (default)</span></span>|<span data-ttu-id="11ac4-146">Ignoré</span><span class="sxs-lookup"><span data-stu-id="11ac4-146">Ignored</span></span>|<span data-ttu-id="11ac4-147">Le chiffrement se produit toujours, mais peut utiliser un certificat de serveur auto-signé.</span><span class="sxs-lookup"><span data-stu-id="11ac4-147">Encryption always occurs, but may use a self-signed server certificate.</span></span>|  
|<span data-ttu-id="11ac4-148">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-148">Yes</span></span>|<span data-ttu-id="11ac4-149">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-149">Yes</span></span>|<span data-ttu-id="11ac4-150">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-150">Yes</span></span>|<span data-ttu-id="11ac4-151">Non (par défaut)</span><span class="sxs-lookup"><span data-stu-id="11ac4-151">No (default)</span></span>|<span data-ttu-id="11ac4-152">Le chiffrement se produit uniquement s'il existe un certificat de serveur vérifiable ; sinon, la tentative de connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="11ac4-152">Encryption occurs only if there is a verifiable server certificate, otherwise the connection attempt fails.</span></span>|  
|<span data-ttu-id="11ac4-153">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-153">Yes</span></span>|<span data-ttu-id="11ac4-154">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-154">Yes</span></span>|<span data-ttu-id="11ac4-155">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-155">Yes</span></span>|<span data-ttu-id="11ac4-156">Oui</span><span class="sxs-lookup"><span data-stu-id="11ac4-156">Yes</span></span>|<span data-ttu-id="11ac4-157">Le chiffrement se produit toujours, mais peut utiliser un certificat de serveur auto-signé.</span><span class="sxs-lookup"><span data-stu-id="11ac4-157">Encryption always occurs, but might use a self-signed server certificate.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="11ac4-158">Fournisseur OLE DB SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="11ac4-158">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="11ac4-159">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client prend en charge le chiffrement sans validation par le biais de l’ajout de la propriété d’initialisation de la source de données SSPROP_INIT_TRUST_SERVER_CERTIFICATE, qui est implémentée dans le jeu de propriétés DBPROPSET_SQLSERVERDBINIT.</span><span class="sxs-lookup"><span data-stu-id="11ac4-159">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports encryption without validation through the addition of the SSPROP_INIT_TRUST_SERVER_CERTIFICATE data source initialization property, which is implemented in the DBPROPSET_SQLSERVERDBINIT property set.</span></span> <span data-ttu-id="11ac4-160">De plus, un nouveau mot clé de chaîne de connexion, « TrustServerCertificate» , a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="11ac4-160">In addition, a new connection string keyword, "TrustServerCertificate", as been added.</span></span> <span data-ttu-id="11ac4-161">Il accepte les valeurs « oui » ou « non », « non » étant la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="11ac4-161">It accepts yes or no values; no is the default.</span></span> <span data-ttu-id="11ac4-162">Lors de l'utilisation de composants du service, il accepte les valeurs true ou false ; false étant la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="11ac4-162">When using service components, it accepts true or false values; false is the default.</span></span>  
  
 <span data-ttu-id="11ac4-163">Pour plus d'informations sur les améliorations apportées au jeu de propriétés DBPROPSET_SQLSERVERDBINIT, consultez [Propriétés d'initialisation et d'autorisation](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span><span class="sxs-lookup"><span data-stu-id="11ac4-163">For more information about enhancements made to the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="11ac4-164">Pilote ODBC SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="11ac4-164">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="11ac4-165">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC Native Client prend en charge le chiffrement sans validation par le biais d’ajouts aux fonctions [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) et [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) .</span><span class="sxs-lookup"><span data-stu-id="11ac4-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports encryption without validation through additions to the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) functions.</span></span> <span data-ttu-id="11ac4-166">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE a été ajouté pour accepter SQL_TRUST_SERVER_CERTIFICATE_YES ou SQL_TRUST_SERVER_CERTIFICATE_NO ; SQL_TRUST_SERVER_CERTIFICATE_NO étant la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="11ac4-166">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE has been added to accept either SQL_TRUST_SERVER_CERTIFICATE_YES or SQL_TRUST_SERVER_CERTIFICATE_NO, with SQL_TRUST_SERVER_CERTIFICATE_NO being the default.</span></span> <span data-ttu-id="11ac4-167">De plus, un nouveau mot clé de chaîne de connexion, « TrustServerCertificate », a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="11ac4-167">In addition, a new connection string keyword, "TrustServerCertificate", has been added.</span></span> <span data-ttu-id="11ac4-168">Il accepte les valeurs « yes » ou « no » ; «no » étant la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="11ac4-168">It accepts yes or no values; "no" is the default.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="11ac4-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="11ac4-169">See Also</span></span>  
 [<span data-ttu-id="11ac4-170">Fonctionnalités de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="11ac4-170">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
