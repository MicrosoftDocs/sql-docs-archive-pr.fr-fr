---
title: Prise en charge SQL Server Native Client pour la haute disponibilité et la récupération d’urgence | Microsoft Docs
ms.custom: ''
ms.date: 08/31/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 2b06186b-4090-4728-b96b-90d6ebd9f66f
author: rothja
ms.author: jroth
ms.openlocfilehash: 43c835d5c0e1c064387aee7fb0db65f577c3aa26
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613434"
---
# <a name="sql-server-native-client-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="7c778-102">Prise en charge des fonctionnalités de récupération d'urgence, haute disponibilité par SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="7c778-102">SQL Server Native Client Support for High Availability, Disaster Recovery</span></span>
  <span data-ttu-id="7c778-103">Cette rubrique décrit la prise en charge de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client (ajouté dans [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c778-103">This topic discusses [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client support (added in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]) for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="7c778-104">Pour plus d’informations sur [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], consultez [Écouteurs de groupe de disponibilité, connectivité client et basculement d’application &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Création et configuration des groupes de disponibilité &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Clustering de basculement et groupes de disponibilité AlwaysOn &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), et [Secondaires actifs : réplicas secondaires lisibles (groupes de disponibilité AlwaysOn)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="7c778-104">For more information about [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../../database-engine/listeners-client-connectivity-application-failover.md), [Creation and Configuration of Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/creation-and-configuration-of-availability-groups-sql-server.md), [Failover Clustering and AlwaysOn Availability Groups &#40;SQL Server&#41;](../../../database-engine/availability-groups/windows/failover-clustering-and-always-on-availability-groups-sql-server.md), and [Active Secondaries: Readable Secondary Replicas (AlwaysOn Availability Groups)](../../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).</span></span>  
  
 <span data-ttu-id="7c778-105">Vous pouvez spécifier l’écouteur d’un groupe de disponibilité donné dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c778-105">You can specify the availability group listener of a given availability group in the connection string.</span></span> <span data-ttu-id="7c778-106">Si une application [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client est connectée à une base de données dans un groupe de disponibilité qui bascule, la connexion d'origine est rompue et l'application doit ouvrir une nouvelle connexion pour reprendre le travail après le basculement.</span><span class="sxs-lookup"><span data-stu-id="7c778-106">If a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application is connected to a database in an availability group that fails over, the original connection is broken, and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="7c778-107">Si vous ne vous connectez pas à un écouteur du groupe de disponibilité et si plusieurs adresses IP sont associées à un nom d'hôte, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client effectue une itération de façon séquentielle parmi toutes les adresses IP associées à l'entrée DNS.</span><span class="sxs-lookup"><span data-stu-id="7c778-107">If you are not connecting to an availability group listener, and if multiple IP addresses are associated with a hostname, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="7c778-108">Cette opération peut prendre du temps si la première adresse IP retournée par le serveur DNS n'est liée à aucune carte d'interface réseau (NIC).</span><span class="sxs-lookup"><span data-stu-id="7c778-108">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="7c778-109">Lors de la connexion à un écouteur du groupe de disponibilité, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tente d'établir des connexions à toutes les adresses IP en parallèle et, si une tentative de connexion réussit, le pilote ignore toutes les tentatives de connexion en attente.</span><span class="sxs-lookup"><span data-stu-id="7c778-109">When connecting to an availability group listener, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="7c778-110">L'augmentation du délai de connexion et l'implémentation de la logique de tentative de connexion augmente la probabilité qu'une application se connecte à un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7c778-110">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="7c778-111">En raison du risque d'échec de connexion en cas de basculement d'un groupe de disponibilité, il est également nécessaire d'implémenter la logique de déclenchement de nouvelles tentatives de connexion, afin de multiplier les tentatives jusqu'à ce qu'une connexion soit établie.</span><span class="sxs-lookup"><span data-stu-id="7c778-111">Also, because a connection can fail because of an availability group failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="7c778-112">Connexion à MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="7c778-112">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="7c778-113">Spécifiez toujours `MultiSubnetFailover=Yes` lors de la connexion à un écouteur du groupe de disponibilité SQL Server 2012 ou à une instance de cluster de basculement SQL Server 2012.</span><span class="sxs-lookup"><span data-stu-id="7c778-113">Always specify `MultiSubnetFailover=Yes` when connecting to a SQL Server 2012 availability group listener or SQL Server 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="7c778-114">`MultiSubnetFailover` permet un basculement plus rapide pour tous les groupes de disponibilité et l'instance de cluster de basculement dans SQL Server 2012, et réduit considérablement le temps de basculement pour les topologies AlwaysOn uniques et de sous-réseaux multiples.</span><span class="sxs-lookup"><span data-stu-id="7c778-114">`MultiSubnetFailover` enables faster failover for all Availability Groups and failover cluster instance in SQL Server 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="7c778-115">Lors d'un basculement de sous-réseaux multiples, le client tente les connexions en parallèle.</span><span class="sxs-lookup"><span data-stu-id="7c778-115">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="7c778-116">Lors d'un basculement de sous-réseau, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client retente de façon intensive d'établir la connexion TCP.</span><span class="sxs-lookup"><span data-stu-id="7c778-116">During a subnet failover, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="7c778-117">La propriété de connexion `MultiSubnetFailover` indique que l'application est déployée sur un groupe de disponibilité ou une instance de cluster de basculement et que [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client tente de se connecter à la base de données sur l'instance [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] principale en essayant toutes les adresses IP du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7c778-117">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or Failover Cluster Instance, and that [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="7c778-118">Lorsque `MultiSubnetFailover=Yes` est spécifié pour une connexion, le client réessaye les tentatives de connexion TCP plus rapidement que les intervalles de retransmission TCP par défaut du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="7c778-118">When `MultiSubnetFailover=Yes` is specified for a connection, the client retries TCP connection attempts faster than the operating system's default TCP retransmit intervals.</span></span> <span data-ttu-id="7c778-119">Cela permet une reconnexion plus rapide après le basculement d'un groupe de disponibilité AlwaysOn ou d'une instance de cluster de basculement AlwaysOn et s'applique aux groupes de disponibilité et aux instances de cluster de basculement uniques et à plusieurs sous-réseaux.</span><span class="sxs-lookup"><span data-stu-id="7c778-119">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="7c778-120">Pour plus d’informations sur les mots clés de chaîne de connexion, consultez [Utilisation de mots clés de chaîne de connexion avec SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="7c778-120">For more information about connection string keywords, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c778-121">La spécification de `MultiSubnetFailover=Yes` lorsque la connexion n'est pas établie avec un écouteur de groupe de disponibilité ou une instance de cluster de basculement peut avoir un impact négatif sur les performances et n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="7c778-121">Specifying `MultiSubnetFailover=Yes` when connecting to something other than an availability group listener or Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="7c778-122">Utilisez les instructions suivantes pour la connexion à un serveur dans un groupe de disponibilité ou dans une instance de cluster de basculement :</span><span class="sxs-lookup"><span data-stu-id="7c778-122">Use the following guidelines to connect to a server in an availability group or Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="7c778-123">Utilisez la propriété de connexion `MultiSubnetFailover` lors de la connexion à un seul réseau ou à plusieurs réseau car elle optimise les performances dans les deux cas de figure.</span><span class="sxs-lookup"><span data-stu-id="7c778-123">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="7c778-124">Pour vous connecter à un groupe de disponibilité, spécifiez l'écouteur du groupe de disponibilité en tant que serveur dans votre chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c778-124">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="7c778-125">La connexion à une instance [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] configurée avec plus de 64 adresses IP provoque un échec de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c778-125">Connecting to a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="7c778-126">Le comportement d'une application qui utilise la propriété de connexion `MultiSubnetFailover` n'est pas affecté selon le type d'authentification : authentification [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], authentification Kerberos ou authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="7c778-126">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="7c778-127">Vous pouvez augmenter la valeur de `loginTimeout` pour tenir compte du temps de basculement et réduire les nouvelles tentatives de connexion d'application.</span><span class="sxs-lookup"><span data-stu-id="7c778-127">You can increase the value of `loginTimeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="7c778-128">Les transactions distribuées ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="7c778-128">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="7c778-129">Si le routage en lecture seule n'est pas appliqué, la connexion à un emplacement de réplica secondaire dans un groupe de disponibilité échoue dans les situations suivantes :</span><span class="sxs-lookup"><span data-stu-id="7c778-129">If read-only routing is not in effect, connecting to a secondary replica location in an availability group will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="7c778-130">Si l'emplacement du réplica secondaire n'est pas configuré pour accepter des connexions.</span><span class="sxs-lookup"><span data-stu-id="7c778-130">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="7c778-131">Si une application utilise `ApplicationIntent=ReadWrite` (voir ci-dessous) et si l'emplacement de réplica secondaire est configuré pour un accès en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-131">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="7c778-132">Une connexion échoue si un réplica principal est configuré pour rejeter des charges de travail en lecture seule et si la chaîne de connexion contient `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="7c778-132">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="7c778-133">Mise à niveau pour utiliser des clusters de sous-réseaux multiples à partir de la mise en miroir de bases de données</span><span class="sxs-lookup"><span data-stu-id="7c778-133">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="7c778-134">Une erreur de connexion se produit si les mots clés de connexion `MultiSubnetFailover` et `Failover_Partner` sont présents dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c778-134">A connection error will occur if the `MultiSubnetFailover` and `Failover_Partner` connection keywords are present in the connection string.</span></span> <span data-ttu-id="7c778-135">Une erreur se produit également si `MultiSubnetFailover` est utilisé et si [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] retourne une réponse de partenaire de basculement qui indique qu'il fait partie d'une paire de mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-135">An error will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="7c778-136">Si vous mettez à niveau une application [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client qui utilise actuellement la mise en miroir de bases de données vers un scénario de sous-réseaux multiples, vous devez supprimer la propriété de connexion `Failover_Partner` et la remplacer par `MultiSubnetFailover` avec la valeur `Yes` et remplacer le nom du serveur dans la chaîne de connexion par un écouteur du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7c778-136">If you upgrade a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover_Partner` connection property and replace it with `MultiSubnetFailover` set to `Yes` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="7c778-137">Si une chaîne de connexion utilise `Failover_Partner` et `MultiSubnetFailover=Yes`, le pilote génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="7c778-137">If a connection string uses `Failover_Partner` and `MultiSubnetFailover=Yes`, the driver will generate an error.</span></span> <span data-ttu-id="7c778-138">Toutefois, si une chaîne de connexion utilise `Failover_Partner` et `MultiSubnetFailover=No` (ou `ApplicationIntent=ReadWrite`), l'application utilise la mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-138">However, if a connection string uses `Failover_Partner` and `MultiSubnetFailover=No` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="7c778-139">Le pilote renvoie une erreur si la mise en miroir de bases de données est utilisée sur la base de données primaire dans le groupe de disponibilité, et si `MultiSubnetFailover=Yes` est utilisé dans la chaîne de connexion qui se connecte à une base de données primaire plutôt qu’à un écouteur de groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="7c778-139">The driver will return an error if database mirroring is used on the primary database in the availability group, and if `MultiSubnetFailover=Yes` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="7c778-140">Spécification de l'intention d'application</span><span class="sxs-lookup"><span data-stu-id="7c778-140">Specifying Application Intent</span></span>  
 <span data-ttu-id="7c778-141">Lorsque `ApplicationIntent=ReadOnly`, le client demande une charge de travail en lecture lors de la connexion à une base de données prenant en charge AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="7c778-141">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="7c778-142">Le serveur applique l'intention au moment de la connexion et pendant une instruction de base de données USE mais uniquement sur une base de données prenant en charge AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="7c778-142">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="7c778-143">Le mot clé `ApplicationIntent` ne fonctionne pas avec les bases de données en lecture seule existantes.</span><span class="sxs-lookup"><span data-stu-id="7c778-143">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="7c778-144">Une base de données peut autoriser ou interdire les charges de travail en lecture sur la base de données AlwaysOn ciblée.</span><span class="sxs-lookup"><span data-stu-id="7c778-144">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="7c778-145">(Faites ceci avec la clause `ALLOW_CONNECTIONS` des instructions `PRIMARY_ROLE` et `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="7c778-145">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="7c778-146">Le mot clé `ApplicationIntent` est utilisé pour activer le routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-146">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="7c778-147">Routage en lecture seule</span><span class="sxs-lookup"><span data-stu-id="7c778-147">Read-Only Routing</span></span>  
 <span data-ttu-id="7c778-148">Le routage en lecture seule est une fonctionnalité qui peut garantir la disponibilité d'un réplica en lecture seule d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-148">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="7c778-149">Pour activer le routage en lecture seule :</span><span class="sxs-lookup"><span data-stu-id="7c778-149">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="7c778-150">Vous devez vous connecter à un écouteur du groupe de disponibilité Always On.</span><span class="sxs-lookup"><span data-stu-id="7c778-150">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="7c778-151">Le mot clé de chaîne de connexion `ApplicationIntent` doit avoir la valeur `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="7c778-151">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="7c778-152">Le groupe de disponibilité doit être configuré par l'administrateur de base de données pour activer le routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-152">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="7c778-153">Il est possible que plusieurs connexions utilisant le routage en lecture seule ne se connectent pas toutes au même réplica en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-153">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="7c778-154">Les modifications apportées à la synchronisation de base de données ou à la configuration du routage du serveur peuvent entraîner des connexions clientes à différents réplicas en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-154">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="7c778-155">Pour vérifier que toutes les demandes en lecture seule se connectent au même réplica en lecture seule, ne transmettez pas d'écouteur du groupe de disponibilité au mot clé de chaîne de connexion `Server`.</span><span class="sxs-lookup"><span data-stu-id="7c778-155">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Server` connection string keyword.</span></span> <span data-ttu-id="7c778-156">Au lieu de cela, spécifiez le nom de l'instance en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="7c778-156">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="7c778-157">Le routage en lecture seule peut prendre plus de temps que la connexion au réplica primaire car le routage en lecture seule se connecte d'abord au réplica primaire, puis recherche le meilleur réplica secondaire lisible disponible.</span><span class="sxs-lookup"><span data-stu-id="7c778-157">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="7c778-158">Pour cette raison, vous devez augmenter le délai de connexion.</span><span class="sxs-lookup"><span data-stu-id="7c778-158">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="odbc"></a><span data-ttu-id="7c778-159">ODBC</span><span class="sxs-lookup"><span data-stu-id="7c778-159">ODBC</span></span>  
 <span data-ttu-id="7c778-160">Deux mots clés de chaîne de connexion ODBC ont été ajoutés pour prendre en charge [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client :</span><span class="sxs-lookup"><span data-stu-id="7c778-160">Two ODBC connection string keywords were added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="7c778-161">Pour plus d’informations sur les mots clés de chaîne de connexion ODBC dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consultez [Utilisation de mots clés de chaîne de connexion avec SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="7c778-161">For more information about ODBC connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c778-162">Les propriétés de connexion équivalentes sont :</span><span class="sxs-lookup"><span data-stu-id="7c778-162">The equivalent connection properties are:</span></span>  
  
-   `SQL_COPT_SS_APPLICATION_INTENT`  
  
-   `SQL_COPT_SS_MULTISUBNET_FAILOVER`  
  
 <span data-ttu-id="7c778-163">Pour plus d’informations sur les propriétés de connexion ODBC dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consultez [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="7c778-163">For more information about ODBC connection properties in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md).</span></span>  
  
 <span data-ttu-id="7c778-164">Les fonctionnalités des mots clés `ApplicationIntent` et `MultiSubnetFailover` sont exposées dans l'Administrateur de sources de données ODBC pour les noms de source de données (DSN) qui utilisent le pilote [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, à compter de [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c778-164">The functionality of the `ApplicationIntent` and `MultiSubnetFailover` keywords will be exposed in the ODBC Data Source Administrator for DSNs that use the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client driver, beginning in [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)].</span></span>  
  
 <span data-ttu-id="7c778-165">Une application ODBC [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client peut utiliser l'une de ces trois fonctions pour établir la connexion :</span><span class="sxs-lookup"><span data-stu-id="7c778-165">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC application can use one of three functions to make the connection:</span></span>  
  
|<span data-ttu-id="7c778-166">Fonction</span><span class="sxs-lookup"><span data-stu-id="7c778-166">Function</span></span>|<span data-ttu-id="7c778-167">Description</span><span class="sxs-lookup"><span data-stu-id="7c778-167">Description</span></span>|  
|--------------|-----------------|  
|[<span data-ttu-id="7c778-168">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="7c778-168">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)|<span data-ttu-id="7c778-169">La liste de serveurs retournée par `SQLBrowseConnect` n'inclut pas de VNN.</span><span class="sxs-lookup"><span data-stu-id="7c778-169">The list of servers returned by `SQLBrowseConnect` will not include VNNs.</span></span> <span data-ttu-id="7c778-170">Vous verrez seulement une liste de serveurs sans indication si ces derniers sont des serveurs autonomes, ou un serveur principal ou secondaire dans un cluster de Clustering de basculement Windows Server (WSFC) qui contient deux instances ou plus de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] activées pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c778-170">You will only see a list of servers without any indication if the server is a standalone server, or a primary or secondary server in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].</span></span> <span data-ttu-id="7c778-171">Si la connexion à un serveur se solde par un échec, c'est peut-être parce que le paramètre `ApplicationIntent` n'est pas compatible avec la configuration de ce serveur.</span><span class="sxs-lookup"><span data-stu-id="7c778-171">If you connect to a server and get a failure, it may be because you have connected to a server, and the `ApplicationIntent` setting is not compatible with the server configuration.</span></span><br /><br /> <span data-ttu-id="7c778-172">Étant donné que `SQLBrowseConnect` ne reconnaît pas de serveurs dans un cluster Clustering de basculement Windows Server (WSFC) qui contient deux d'instances ou plus de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] activées pour [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignore le mot clé de chaîne de connexion `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="7c778-172">Because `SQLBrowseConnect` does not recognize servers in a Windows Server Failover Clustering (WSFC) cluster that contains two or more [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances that have been enabled for [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], `SQLBrowseConnect` ignores the `MultiSubnetFailover` connection string keyword.</span></span>|  
|[<span data-ttu-id="7c778-173">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="7c778-173">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)|<span data-ttu-id="7c778-174">`SQLConnect` prend en charge `ApplicationIntent` et `MultiSubnetFailover` via des propriétés de connexion ou un nom de source de données (DSN).</span><span class="sxs-lookup"><span data-stu-id="7c778-174">`SQLConnect` supports both `ApplicationIntent` and `MultiSubnetFailover` via a data source name (DSN) or connection properties.</span></span>|  
|[<span data-ttu-id="7c778-175">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="7c778-175">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)|<span data-ttu-id="7c778-176">`SQLDriverConnect` prend en charge `ApplicationIntent` et `MultiSubnetFailover` via des mots clés de chaîne de connexion, des propriétés de connexion ou un nom de source de données (DSN).</span><span class="sxs-lookup"><span data-stu-id="7c778-176">`SQLDriverConnect` supports `ApplicationIntent` and `MultiSubnetFailover` via connection string keywords, connection properties, or DSN.</span></span>|  
  
## <a name="ole-db"></a><span data-ttu-id="7c778-177">OLE DB</span><span class="sxs-lookup"><span data-stu-id="7c778-177">OLE DB</span></span>  
 <span data-ttu-id="7c778-178">OLE DB dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ne prend pas en charge le mot clé `MultiSubnetFailover`.</span><span class="sxs-lookup"><span data-stu-id="7c778-178">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not support the `MultiSubnetFailover` keyword.</span></span>  
  
 <span data-ttu-id="7c778-179">OLE DB dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client prendra en charge l'intention de l'application.</span><span class="sxs-lookup"><span data-stu-id="7c778-179">OLE DB in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will support application intent.</span></span> <span data-ttu-id="7c778-180">L'intention de l'application se comporte de manière identique pour les applications OLE DB et les applications ODBC (voir ci-dessus).</span><span class="sxs-lookup"><span data-stu-id="7c778-180">Application intent will behave the same for OLE DB applications as ODBC applications (see above).</span></span>  
  
 <span data-ttu-id="7c778-181">Un mot clé de chaîne de connexion OLE DB a été ajouté pour prendre en charge [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client :</span><span class="sxs-lookup"><span data-stu-id="7c778-181">One OLE DB connection string keyword added to support [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client:</span></span>  
  
-   `Application Intent`  
  
 <span data-ttu-id="7c778-182">Pour plus d’informations sur les mots clés de chaîne de connexion dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consultez [Utilisation de mots clés de chaîne de connexion avec SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span><span class="sxs-lookup"><span data-stu-id="7c778-182">For more information about connection string keywords in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="7c778-183">Les propriétés de connexion équivalentes sont :</span><span class="sxs-lookup"><span data-stu-id="7c778-183">The equivalent connection properties are:</span></span>  
  
-   `SSPROP_INIT_APPLICATIONINTENT`  
  
-   `DBPROP_INIT_PROVIDERSTRING`  
  
 <span data-ttu-id="7c778-184">Une application OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client peut utiliser l'une de ces méthodes pour spécifier l'intention de l'application :</span><span class="sxs-lookup"><span data-stu-id="7c778-184">A [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB application can use one of the methods to specify application intent:</span></span>  
  
 `IDBInitialize::Initialize`  
 <span data-ttu-id="7c778-185">`IDBInitialize::Initialize` utilise le jeu de propriétés configuré précédemment pour initialiser la source de données et créer l'objet source de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-185">`IDBInitialize::Initialize` uses the previously configured set of properties to initialize the data source and create the data source object.</span></span> <span data-ttu-id="7c778-186">Spécifiez l'intention de l'application en tant que propriété de fournisseur ou dans le cadre de la chaîne de propriétés étendues.</span><span class="sxs-lookup"><span data-stu-id="7c778-186">Specify application intent as a provider property or as part of the extended properties string.</span></span>  
  
 `IDataInitialize::GetDataSource`  
 <span data-ttu-id="7c778-187">`IDataInitialize::GetDataSource` accepte une chaîne de connexion d'entrée qui peut contenir le mot clé `Application Intent`.</span><span class="sxs-lookup"><span data-stu-id="7c778-187">`IDataInitialize::GetDataSource` takes an input connection string that can contain the `Application Intent` keyword.</span></span>  
  
 `IDBProperties::GetProperties`  
 <span data-ttu-id="7c778-188">`IDBProperties::GetProperties` récupère la valeur de la propriété définie actuellement sur la source de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-188">`IDBProperties::GetProperties` retrieves the value of the property that is currently set on the data source.</span></span>  <span data-ttu-id="7c778-189">Vous pouvez récupérer la valeur `Application Intent` via les propriétés DBPROP_INIT_PROVIDERSTRING et SSPROP_INIT_APPLICATIONINTENT.</span><span class="sxs-lookup"><span data-stu-id="7c778-189">You can retrieve the `Application Intent` value through the DBPROP_INIT_PROVIDERSTRING property and SSPROP_INIT_APPLICATIONINTENT property.</span></span>  
  
 `IDBProperties::SetProperties`  
 <span data-ttu-id="7c778-190">Pour définir la valeur de propriété `ApplicationIntent`, appelez `IDBProperties::SetProperties` qui passe la propriété `SSPROP_INIT_APPLICATIONINTENT` avec la valeur « `ReadWrite` » ou « `ReadOnly` » ou `DBPROP_INIT_PROVIDERSTRING` avec la valeur qui contient « `ApplicationIntent=ReadOnly` » ou « `ApplicationIntent=ReadWrite` ».</span><span class="sxs-lookup"><span data-stu-id="7c778-190">To set the `ApplicationIntent` property value, call `IDBProperties::SetProperties` passing in the `SSPROP_INIT_APPLICATIONINTENT` property with value "`ReadWrite`" or "`ReadOnly`" or `DBPROP_INIT_PROVIDERSTRING` property with value containing "`ApplicationIntent=ReadOnly`" or "`ApplicationIntent=ReadWrite`".</span></span>  
  
 <span data-ttu-id="7c778-191">Vous pouvez spécifier l’intention de l’application dans le champ Propriétés de l’intention de l’application de l’onglet Tous de la boîte de dialogue **Propriétés de liaison de données**.</span><span class="sxs-lookup"><span data-stu-id="7c778-191">You can specify application intent in the Application Intent Properties field of the All tab in the **Data Link Properties** dialog box.</span></span>  
  
 <span data-ttu-id="7c778-192">Lorsque des connexions implicites sont établies, la connexion implicite utilise le paramètre d'intention de l'application de la connexion parente.</span><span class="sxs-lookup"><span data-stu-id="7c778-192">When implicit connections are established, the implicit connection will use the application intent setting of the parent connection.</span></span> <span data-ttu-id="7c778-193">De la même façon, plusieurs sessions créées à partir de la même source de données héritent du paramètre d'intention de l'application de la source de données.</span><span class="sxs-lookup"><span data-stu-id="7c778-193">Similarly, multiple sessions created from the same data source will inherit the data source's application intent setting.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c778-194">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7c778-194">See Also</span></span>  
 <span data-ttu-id="7c778-195">[Fonctionnalités de SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="7c778-195">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="7c778-196">Utilisation de mots clés de chaîne de connexion avec SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="7c778-196">Using Connection String Keywords with SQL Server Native Client</span></span>](../applications/using-connection-string-keywords-with-sql-server-native-client.md)  
  
  
