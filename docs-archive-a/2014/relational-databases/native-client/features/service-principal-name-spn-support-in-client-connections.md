---
title: Prise en charge des noms de principal du service (SPN) dans les connexions clientes | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- SQL Server Native Client, SPNs
- ODBC, SPNs
- OLE DB, SPNs
- SPNs [SQL Server]
ms.assetid: 96598c69-ce9a-4090-aacb-d546591e8af7
author: rothja
ms.author: jroth
ms.openlocfilehash: 10a64baa17bd070d9354beaf6ff8c2e460682318
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602114"
---
# <a name="service-principal-name-spn-support-in-client-connections"></a><span data-ttu-id="1ad50-102">Prise en charge des noms de principaux du service (SPN) dans les connexions clientes</span><span class="sxs-lookup"><span data-stu-id="1ad50-102">Service Principal Name (SPN) Support in Client Connections</span></span>
  <span data-ttu-id="1ad50-103">À partir de [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], la prise en charge des noms de principal du service (SPN) a été étendue pour permettre une authentification mutuelle entre tous les protocoles.</span><span class="sxs-lookup"><span data-stu-id="1ad50-103">Beginning with [!INCLUDE[ssKatmai](../../../includes/sskatmai-md.md)], support for service principal names (SPNs) has been extended to enable mutual authentication across all protocols.</span></span> <span data-ttu-id="1ad50-104">Dans les versions antérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les noms de principal du service étaient pris en charge uniquement pour Kerberos sur TCP quand le nom de principal du service par défaut de l’instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] était inscrit auprès d’Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1ad50-104">In previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], SPNs were only supported for Kerberos over TCP when the default SPN for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance was registered with Active Directory.</span></span>  
  
 <span data-ttu-id="1ad50-105">Les noms de principal du service sont utilisés par le protocole d’authentification pour déterminer le compte dans lequel s’exécute une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-105">SPNs are used by the authentication protocol to determine the account in which a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance runs.</span></span> <span data-ttu-id="1ad50-106">Si le compte de l'instance est connu, l'authentification Kerberos peut être utilisée pour fournir une authentification mutuelle par le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="1ad50-106">If the instance account is known, Kerberos authentication can be used to provide mutual authentication by the client and server.</span></span> <span data-ttu-id="1ad50-107">Si le compte de l'instance n'est pas connu, l'authentification NTLM, qui fournit uniquement une authentification du client par le serveur, est utilisée.</span><span class="sxs-lookup"><span data-stu-id="1ad50-107">If the instance account is not known, NTLM authentication, which only provides authentication of the client by the server, is used.</span></span> <span data-ttu-id="1ad50-108">Actuellement, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client effectue la recherche d'authentification en faisant dériver le nom principal de service du nom de l'instance et des propriétés de connexion réseau.</span><span class="sxs-lookup"><span data-stu-id="1ad50-108">Currently, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client performs the authentication lookup, deriving the SPN from the instance name and network connection properties.</span></span> <span data-ttu-id="1ad50-109">Les instances de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] tentent d’inscrire les noms de principal du service au démarrage, mais ces derniers peuvent également être inscrits manuellement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-109">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instances will attempt to register SPNs on startup, or they can be registered manually.</span></span> <span data-ttu-id="1ad50-110">Toutefois, l'inscription échoue si les droits d'accès sont insuffisants pour le compte qui essaie d'inscrire les noms principaux de service.</span><span class="sxs-lookup"><span data-stu-id="1ad50-110">However, registration will fail if there are insufficient access rights for the account that attempts to register the SPNs.</span></span>  
  
 <span data-ttu-id="1ad50-111">Les comptes de domaine et d'ordinateur sont inscrits automatiquement dans Active Directory.</span><span class="sxs-lookup"><span data-stu-id="1ad50-111">Domain and computer accounts are registered automatically in Active Directory.</span></span> <span data-ttu-id="1ad50-112">Ils peuvent être utilisés comme noms principaux de service ; par ailleurs, les administrateurs peuvent définir leurs propres noms principaux de service.</span><span class="sxs-lookup"><span data-stu-id="1ad50-112">These can be used as SPNs, or administators can define their own SPNs.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="1ad50-113">rend l’authentification sécurisée plus gérable et plus fiable en autorisant les clients à spécifier directement le nom de principal du service à utiliser.</span><span class="sxs-lookup"><span data-stu-id="1ad50-113">makes secure authentication more manageable and reliable by allowing clients to directly specify the SPN to use.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="1ad50-114">Un nom principal de service spécifié par une application cliente est utilisé uniquement lorsqu'une connexion est établie avec la sécurité intégrée Windows.</span><span class="sxs-lookup"><span data-stu-id="1ad50-114">An SPN specified by a client application is only used when a connection is made with Windows integrated security.</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="1ad50-115">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] pour [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** est un outil de diagnostic qui permet de dépanner les problèmes de connexion que rencontre Kerberos avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-115">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos Configuration Manager for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** is a diagnostic tool that helps troubleshoot Kerberos related connectivity issues with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1ad50-116">Pour plus d'informations, consultez [Gestionnaire de configuration de Microsoft Kerberos pour SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span><span class="sxs-lookup"><span data-stu-id="1ad50-116">For more information, see [Microsoft Kerberos Configuration Manager for SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span></span>  
  
> [!TIP]  
>  <span data-ttu-id="1ad50-117">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] pour [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** est un outil de diagnostic qui permet de dépanner les problèmes de connexion que rencontre Kerberos avec [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-117">**[!INCLUDE[msCoName](../../../includes/msconame-md.md)] Kerberos Configuration Manager for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]** is a diagnostic tool that helps troubleshoot Kerberos related connectivity issues with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1ad50-118">Pour plus d'informations, consultez [Gestionnaire de configuration de Microsoft Kerberos pour SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span><span class="sxs-lookup"><span data-stu-id="1ad50-118">For more information, see [Microsoft Kerberos Configuration Manager for SQL Server](https://www.microsoft.com/download/details.aspx?id=39046).</span></span>  
  
 <span data-ttu-id="1ad50-119">Pour plus d'informations sur Kerberos, consultez les articles suivants :</span><span class="sxs-lookup"><span data-stu-id="1ad50-119">For more information about Kerberos, see the following articles:</span></span>  
  
-   [<span data-ttu-id="1ad50-120">Kerberos Technical Supplement for Windows (en anglais)</span><span class="sxs-lookup"><span data-stu-id="1ad50-120">Kerberos Technical Supplement for Windows</span></span>](https://go.microsoft.com/fwlink/?LinkId=101449)  
  
-   [<span data-ttu-id="1ad50-121">Microsoft Kerberos (en anglais)</span><span class="sxs-lookup"><span data-stu-id="1ad50-121">Microsoft Kerberos</span></span>](https://go.microsoft.com/fwlink/?LinkID=100758)  
  
## <a name="usage"></a><span data-ttu-id="1ad50-122">Usage</span><span class="sxs-lookup"><span data-stu-id="1ad50-122">Usage</span></span>  
 <span data-ttu-id="1ad50-123">Le tableau suivant décrit les scénarios les plus courants dans lesquels les applications clientes peuvent activer l'authentification sécurisée.</span><span class="sxs-lookup"><span data-stu-id="1ad50-123">The following table describes the most common scenarios in which client applications can enable secure authentication.</span></span>  
  
|<span data-ttu-id="1ad50-124">Scénario</span><span class="sxs-lookup"><span data-stu-id="1ad50-124">Scenario</span></span>|<span data-ttu-id="1ad50-125">Description</span><span class="sxs-lookup"><span data-stu-id="1ad50-125">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="1ad50-126">Une application héritée ne spécifie pas de nom principal de service.</span><span class="sxs-lookup"><span data-stu-id="1ad50-126">A legacy application does not specify an SPN.</span></span>|<span data-ttu-id="1ad50-127">Ce scénario de compatibilité garantit l'absence de tout changement de comportement dans les applications développées pour les versions antérieures de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-127">This compatibility scenario guarantees that there will be no behavior change for applications developed for previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="1ad50-128">Si aucun nom principal de service n'est spécifié, l'application s'appuie sur les noms principaux de service générés et n'a aucune connaissance de la méthode d'authentification utilisée.</span><span class="sxs-lookup"><span data-stu-id="1ad50-128">If no SPN is specified, the application relies on generated SPNs and has no knowledge of which authentication method is used.</span></span>|  
|<span data-ttu-id="1ad50-129">Une application cliente utilisant la version actuelle de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client spécifie un nom principal de service dans la chaîne de connexion en tant que compte d'utilisateur de domaine ou compte d'ordinateur de domaine, en tant que nom principal de service spécifique à une instance ou en tant que chaîne définie par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1ad50-129">A client application using the current version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client specifies an SPN in the connection string as a domain user or computer account, as an instance-specific SPN, or as a user-defined string.</span></span>|<span data-ttu-id="1ad50-130">Le mot clé `ServerSPN` peut être utilisé dans une chaîne de fournisseur, une chaîne d'initialisation ou une chaîne de connexion afin d'effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="1ad50-130">The `ServerSPN` keyword can be used in a provider, initialization, or connection string to do the following:</span></span><br /><br /> <span data-ttu-id="1ad50-131">-Spécifiez le compte utilisé par l' [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance pour une connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-131">-   Specify the account used by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance for a connection.</span></span> <span data-ttu-id="1ad50-132">Cela simplifie l'accès à l'authentification Kerberos.</span><span class="sxs-lookup"><span data-stu-id="1ad50-132">This simplifies access to Kerberos authentication.</span></span> <span data-ttu-id="1ad50-133">Si un centre de distribution de clés Kerberos (KDC) est présent et si le compte approprié est spécifié, l'utilisation de l'authentification Kerberos est plus probable que celle de l'authentification NTLM.</span><span class="sxs-lookup"><span data-stu-id="1ad50-133">If a Kerberos Key Distribution Center (KDC) is present and the correct account is specified, Kerberos authentication is more likely to be used than NTLM.</span></span> <span data-ttu-id="1ad50-134">Le centre de distribution de clés se trouve habituellement sur le même ordinateur que le contrôleur de domaine.</span><span class="sxs-lookup"><span data-stu-id="1ad50-134">The KDC usually resides on the same computer as the domain controller.</span></span><br /><span data-ttu-id="1ad50-135">-Spécifiez un SPN pour rechercher le compte de service de l' [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span><span class="sxs-lookup"><span data-stu-id="1ad50-135">-   Specify an SPN to look up the service account for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="1ad50-136">Pour chaque instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], deux noms de principal du service par défaut sont générés et peuvent être utilisés à cette fin.</span><span class="sxs-lookup"><span data-stu-id="1ad50-136">For every [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance, two default SPNs are generated that can be used for this purpose.</span></span> <span data-ttu-id="1ad50-137">Toutefois, il n'est pas certain que ces clés soient présentes dans Active Directory ; par conséquent, dans cette situation, l'authentification Kerberos n'est pas garantie.</span><span class="sxs-lookup"><span data-stu-id="1ad50-137">These keys are not guaranteed to be present in Active Directory, however, so in this situation Kerberos authentication is not guaranteed.</span></span><br /><span data-ttu-id="1ad50-138">-Spécifiez un nom de principal du service qui sera utilisé pour rechercher le compte de service de l' [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span><span class="sxs-lookup"><span data-stu-id="1ad50-138">-   Specify an SPN that will be used to look up the service account for the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance.</span></span> <span data-ttu-id="1ad50-139">Il peut s'agir de n'importe quelle chaîne définie par l'utilisateur et mappée au compte de service.</span><span class="sxs-lookup"><span data-stu-id="1ad50-139">This can be any user-defined string that maps to the service account.</span></span> <span data-ttu-id="1ad50-140">Dans ce cas, la clé doit être inscrite manuellement dans le centre de distribution de clés et doit répondre aux exigences relatives à un nom principal de service défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1ad50-140">In this case, the key must be registered manually in the KDC and must satisfy the rules for a user-defined SPN.</span></span><br /><br /> <span data-ttu-id="1ad50-141">Le mot clé `FailoverPartnerSPN` peut être utilisé pour spécifier le nom principal de service du serveur partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-141">The `FailoverPartnerSPN` keyword can be used to specify the SPN for the failover partner server.</span></span> <span data-ttu-id="1ad50-142">La plage des valeurs de comptes et de clés Active Directory est identique à celle des valeurs que vous pouvez spécifier pour le serveur principal.</span><span class="sxs-lookup"><span data-stu-id="1ad50-142">The range of account and Active Directory key values is the same as the values you can specify for the principal server.</span></span>|  
|<span data-ttu-id="1ad50-143">Une application ODBC spécifie un nom principal de service en tant qu'attribut de connexion pour le serveur principal ou le partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-143">An ODBC application specifies an SPN as a connection attribute for the principal server or failover partner server.</span></span>|<span data-ttu-id="1ad50-144">L'attribut de connexion `SQL_COPT_SS_SERVER_SPN` peut être utilisé pour spécifier le nom principal de service d'une connexion au serveur principal.</span><span class="sxs-lookup"><span data-stu-id="1ad50-144">The connection attribute `SQL_COPT_SS_SERVER_SPN` can be used to specify the SPN for a connection to the principal server.</span></span><br /><br /> <span data-ttu-id="1ad50-145">L'attribut de connexion `SQL_COPT_SS_FAILOVER_PARTNER_SPN` peut être utilisé pour spécifier le nom principal de service du serveur partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-145">The connection attribute `SQL_COPT_SS_FAILOVER_PARTNER_SPN` can be used to specify the SPN for the failover partner server.</span></span>|  
|<span data-ttu-id="1ad50-146">Une application OLE DB spécifie un nom principal de service en tant que propriété d'initialisation d'une source de données pour le serveur principal ou pour un partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-146">An OLE DB application specifies an SPN as a data source initialization property for the principal server or for a failover partner server.</span></span>|<span data-ttu-id="1ad50-147">La propriété de connexion `SSPROP_INIT_SERVER_SPN` du jeu de propriétés `DBPROPSET_SQLSERVERDBINIT` peut être utilisée pour spécifier le nom principal de service d'une connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-147">The connection property `SSPROP_INIT_SERVER_SPN` in the `DBPROPSET_SQLSERVERDBINIT` property set can be used to specify the SPN for a connection.</span></span><br /><br /> <span data-ttu-id="1ad50-148">La propriété de connexion `SSPROP_INIT_FAILOVER_PARTNER_SPN` dans `DBPROPSET_SQLSERVERDBINIT` peut être utilisée pour spécifier le nom principal de service du serveur partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-148">The connection property `SSPROP_INIT_FAILOVER_PARTNER_SPN` in the `DBPROPSET_SQLSERVERDBINIT` can be used to specify the SPN for the failover partner server.</span></span>|  
|<span data-ttu-id="1ad50-149">Un utilisateur spécifie un nom principal de service pour un serveur ou un partenaire de basculement dans un nom de source de données ODBC.</span><span class="sxs-lookup"><span data-stu-id="1ad50-149">A user specifies an SPN for a server or failover partner server in an ODBC data source name (DSN).</span></span>|<span data-ttu-id="1ad50-150">Le nom principal de service peut être spécifié dans un nom de source de données ODBC via les boîtes de dialogue d'installation du nom de la source de données.</span><span class="sxs-lookup"><span data-stu-id="1ad50-150">The SPN can be specified in an ODBC DSN through the DSN setup dialog boxes.</span></span>|  
|<span data-ttu-id="1ad50-151">L'utilisateur spécifie un nom principal de service pour un serveur ou un serveur partenaire de basculement dans une boîte de dialogue **Liaison de données** ou **Connexion** OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1ad50-151">The user specifies an SPN for a server or failover partner server in an OLE DB **Data Link** or **Login** dialog box.</span></span>|<span data-ttu-id="1ad50-152">Le nom principal de service peut être spécifié dans une boîte de dialogue **Liaison de données** ou **Connexion** .</span><span class="sxs-lookup"><span data-stu-id="1ad50-152">The SPN can be specified in a **Data Link** or **Login** dialog box.</span></span> <span data-ttu-id="1ad50-153">La boîte de dialogue **Connexion** peut être utilisée avec ODBC ou OLE DB.</span><span class="sxs-lookup"><span data-stu-id="1ad50-153">The **Login** dialog box can be used with either ODBC or OLE DB.</span></span>|  
|<span data-ttu-id="1ad50-154">Une application ODBC détermine la méthode d'authentification utilisée pour établir une connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-154">An ODBC application determines the authentication method used to establish a connection.</span></span>|<span data-ttu-id="1ad50-155">Lorsqu'une connexion est ouverte avec succès, une application peut interroger l'attribut de connexion `SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD` pour déterminer la méthode d'authentification utilisée.</span><span class="sxs-lookup"><span data-stu-id="1ad50-155">When a connection has been opened successfully, an application can query the connection attribute `SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD` to determine which authentication method was used.</span></span> <span data-ttu-id="1ad50-156">Les valeurs incluent `NTLM` et `Kerberos`, mais ne se limitent pas à ces dernières.</span><span class="sxs-lookup"><span data-stu-id="1ad50-156">The values will include, but are not limited to, `NTLM` and `Kerberos`.</span></span>|  
|<span data-ttu-id="1ad50-157">Une application OLE DB détermine la méthode d'authentification utilisée pour établir une connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-157">An OLE DB application determines the authentication method used to establish a connection.</span></span>|<span data-ttu-id="1ad50-158">Lorsqu'une connexion est ouverte avec succès, une application peut interroger la propriété de connexion `SSPROP_AUTHENTICATION_METHOD` dans le jeu de propriétés `DBPROPSET_SQLSERVERDATASOURCEINFO` pour déterminer la méthode d'authentification utilisée.</span><span class="sxs-lookup"><span data-stu-id="1ad50-158">When a connection has been opened successfully, an application can query the connection property `SSPROP_AUTHENTICATION_METHOD` in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set to determine which authentication method was used.</span></span> <span data-ttu-id="1ad50-159">Les valeurs incluent `NTLM` et `Kerberos`, mais ne se limitent pas à ces dernières.</span><span class="sxs-lookup"><span data-stu-id="1ad50-159">The values will include, but are not limited to, `NTLM` and `Kerberos`.</span></span>|  
  
## <a name="failover"></a><span data-ttu-id="1ad50-160">Basculement</span><span class="sxs-lookup"><span data-stu-id="1ad50-160">Failover</span></span>  
 <span data-ttu-id="1ad50-161">Les noms principaux de service ne sont pas stockés dans le cache de basculement et par conséquent ne peuvent pas être passés entre les connexions.</span><span class="sxs-lookup"><span data-stu-id="1ad50-161">SPNs are not stored in the failover cache and therefore cannot be passed between connections.</span></span> <span data-ttu-id="1ad50-162">Les noms principaux de service sont utilisés lors de toutes les tentatives de connexion au principal et au serveur partenaire lorsque cela est spécifié dans la chaîne de connexion ou les attributs de connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-162">SPNs will be used on all connection attempts to the principal and partner when specified in the connection string or connection attributes.</span></span>  
  
## <a name="connection-pooling"></a><span data-ttu-id="1ad50-163">Regroupement de connexions</span><span class="sxs-lookup"><span data-stu-id="1ad50-163">Connection Pooling</span></span>  
 <span data-ttu-id="1ad50-164">Les applications doivent prendre en compte le fait que la spécification de noms principaux de service dans une partie (au lieu de la totalité) des chaînes de connexion peut contribuer à la fragmentation du regroupement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-164">Applications should be aware that specifying SPNs in some but not all connection strings can contribute to pool fragmentation.</span></span>  
  
 <span data-ttu-id="1ad50-165">Les applications peuvent spécifier par programme des noms principaux de service en tant qu'attributs de connexion, au lieu de spécifier des mots clés de chaînes de connexion.</span><span class="sxs-lookup"><span data-stu-id="1ad50-165">Applications can programmatically specify SPNs as connection attributes, instead of specifying connection string keywords.</span></span> <span data-ttu-id="1ad50-166">Cela peut permettre de gérer la fragmentation du regroupement de connexions.</span><span class="sxs-lookup"><span data-stu-id="1ad50-166">This can help manage connection pool fragmentation.</span></span>  
  
 <span data-ttu-id="1ad50-167">Les applications doivent prendre en compte le fait que les noms principaux de service dans les chaînes de connexion peuvent être substitués en définissant les attributs de connexion correspondants ; toutefois, les chaînes de connexion utilisées par le regroupement de connexions tirent parti des valeurs de chaînes de connexion à des fins de regroupement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-167">Applications should be aware that SPNs in connection strings can be overridden by setting the corresponding connection attributes, but connection strings used by connection pooling will use the connection string values for pooling purposes.</span></span>  
  
## <a name="down-level-server-behavior"></a><span data-ttu-id="1ad50-168">Comportement de serveur de bas niveau</span><span class="sxs-lookup"><span data-stu-id="1ad50-168">Down-Level Server Behavior</span></span>  
 <span data-ttu-id="1ad50-169">Le nouveau comportement de connexion est implémenté par le client ; par conséquent, il n'est pas spécifique à une version de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-169">The new connection behavior is implemented by the client; therefore, it is not specific to a version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
## <a name="linked-servers-and-delegation"></a><span data-ttu-id="1ad50-170">Serveurs liés et délégation</span><span class="sxs-lookup"><span data-stu-id="1ad50-170">Linked Servers and Delegation</span></span>  
 <span data-ttu-id="1ad50-171">Quand des serveurs liés sont créés, le paramètre `@provstr` de [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) peut être utilisé pour spécifier les noms de principal du service du serveur et du partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="1ad50-171">When linked servers are created, the `@provstr` parameter of [sp_addlinkedserver](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) can be used to specify the server and failover partner SPNs.</span></span> <span data-ttu-id="1ad50-172">Les avantages de ce choix sont les mêmes que pour la spécification de noms principaux de service dans les chaînes de connexion des clients : davantage de simplicité et de fiabilité pour l'établissement des connexions qui utilisent l'authentification Kerberos.</span><span class="sxs-lookup"><span data-stu-id="1ad50-172">The benefits of doing this are the same as specifying SPNs in client connection strings: It is simpler and more reliable to establish connections that use Kerberos authentication.</span></span>  
  
 <span data-ttu-id="1ad50-173">La délégation avec des serveurs liés requiert l'authentification Kerberos.</span><span class="sxs-lookup"><span data-stu-id="1ad50-173">Delegation with linked servers requires Kerberos authentication.</span></span>  
  
## <a name="management-aspects-of-spns-specified-by-applications"></a><span data-ttu-id="1ad50-174">Aspects liés à la gestion des noms principaux de service spécifiés par les applications</span><span class="sxs-lookup"><span data-stu-id="1ad50-174">Management Aspects of SPNs Specified by Applications</span></span>  
 <span data-ttu-id="1ad50-175">Au moment de choisir s'il faut spécifier des noms principaux de service dans une application (via les chaînes de connexion) ou par programme via les propriétés de connexion (au lieu de recourir aux noms principaux de service par défaut générés par le fournisseur), prenez en considération les facteurs suivants :</span><span class="sxs-lookup"><span data-stu-id="1ad50-175">When choosing whether to specify SPNs in an application (through connection strings) or programmatically through connection properties (rather than relying on the defalt provider generated SPNs), consider the following factors:</span></span>  
  
-   <span data-ttu-id="1ad50-176">Sécurité : est-ce que le nom principal de service spécifié divulgue des informations protégées ?</span><span class="sxs-lookup"><span data-stu-id="1ad50-176">Security: Does the specified SPN disclose information that is protected?</span></span>  
  
-   <span data-ttu-id="1ad50-177">Fiabilité : pour permettre l’utilisation des noms de principal du service par défaut, le compte de service dans lequel s’exécute l’instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] doit avoir les privilèges suffisants pour mettre à jour Active Directory sur le centre de distribution de clés.</span><span class="sxs-lookup"><span data-stu-id="1ad50-177">Reliability: To enable the use of default SPNs, the service account in which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance runs must have sufficient privileges to update the Active Directory on the KDC.</span></span>  
  
-   <span data-ttu-id="1ad50-178">Commodité et transparence de l'emplacement : comment les noms principaux de service d'une application sont-ils affectés si la base de données correspondante est déplacée vers une autre instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ?</span><span class="sxs-lookup"><span data-stu-id="1ad50-178">Convenience and location transparency: How will an application's SPNs be affected if its database moves to a different [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance?</span></span> <span data-ttu-id="1ad50-179">Cela s'applique à la fois au serveur principal et à son partenaire de basculement, si vous utilisez la mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="1ad50-179">This applies to both the principal server and its failover partner if you use database mirroring.</span></span> <span data-ttu-id="1ad50-180">Si une modification du serveur signifie une modification des noms principaux de service, comment cela affecte-t-il les applications ?</span><span class="sxs-lookup"><span data-stu-id="1ad50-180">If a server change means that SPNs must be changed, how will this affect applications?</span></span> <span data-ttu-id="1ad50-181">Est-ce que les modifications sont gérées ?</span><span class="sxs-lookup"><span data-stu-id="1ad50-181">Will any changes be managed?</span></span>  
  
## <a name="specifying-the-spn"></a><span data-ttu-id="1ad50-182">Spécification du nom principal de service</span><span class="sxs-lookup"><span data-stu-id="1ad50-182">Specifying the SPN</span></span>  
 <span data-ttu-id="1ad50-183">Vous pouvez spécifier un nom principal de service dans les boîtes de dialogue et dans le code.</span><span class="sxs-lookup"><span data-stu-id="1ad50-183">You can specify an SPN in dialog boxes and in code.</span></span> <span data-ttu-id="1ad50-184">Cette section explique comment vous pouvez spécifier un nom principal de service.</span><span class="sxs-lookup"><span data-stu-id="1ad50-184">This section discusses how you can specify an SPN.</span></span>  
  
 <span data-ttu-id="1ad50-185">La longueur maximale d'un nom principal de service est 260 caractères.</span><span class="sxs-lookup"><span data-stu-id="1ad50-185">The maximum length for an SPN is 260 characters.</span></span>  
  
 <span data-ttu-id="1ad50-186">La syntaxe que les noms principaux de service utilisent dans la chaîne de connexion ou les attributs de connexion est la suivante :</span><span class="sxs-lookup"><span data-stu-id="1ad50-186">The syntax that SPNs use in connection string or connection attributes is as follows:</span></span>  
  
|<span data-ttu-id="1ad50-187">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="1ad50-187">Syntax</span></span>|<span data-ttu-id="1ad50-188">Description</span><span class="sxs-lookup"><span data-stu-id="1ad50-188">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="1ad50-189">MSSQLSvc/*FQDN*</span><span class="sxs-lookup"><span data-stu-id="1ad50-189">MSSQLSvc/*fqdn*</span></span>|<span data-ttu-id="1ad50-190">Nom principal de service par défaut, généré par le fournisseur, pour une instance par défaut lorsqu'un autre protocole que TCP est utilisé.</span><span class="sxs-lookup"><span data-stu-id="1ad50-190">The provider-generated, default SPN for a default instance when a protocol other than TCP is used.</span></span><br /><br /> <span data-ttu-id="1ad50-191">*FQDN* est un nom de domaine complet.</span><span class="sxs-lookup"><span data-stu-id="1ad50-191">*fqdn* is a fully-qualified domain name.</span></span>|  
|<span data-ttu-id="1ad50-192">MSSQLSvc/*fqdn*:*port*</span><span class="sxs-lookup"><span data-stu-id="1ad50-192">MSSQLSvc/*fqdn*:*port*</span></span>|<span data-ttu-id="1ad50-193">Nom principal de service par défaut, généré par le fournisseur, lorsque le protocole TCP est utilisé.</span><span class="sxs-lookup"><span data-stu-id="1ad50-193">The provider-generated, default SPN when TCP is used.</span></span><br /><br /> <span data-ttu-id="1ad50-194">*port* est un numéro de port TCP.</span><span class="sxs-lookup"><span data-stu-id="1ad50-194">*port* is a TCP port number.</span></span>|  
|<span data-ttu-id="1ad50-195">MSSQLSvc/*FQDN*:*nom_instance*</span><span class="sxs-lookup"><span data-stu-id="1ad50-195">MSSQLSvc/*fqdn*:*InstanceName*</span></span>|<span data-ttu-id="1ad50-196">Nom principal de service par défaut, généré par le fournisseur, pour une instance nommée lorsqu'un autre protocole que TCP est utilisé.</span><span class="sxs-lookup"><span data-stu-id="1ad50-196">The provider-generated, default SPN for a named instance when a protocol other than TCP is used.</span></span><br /><br /> <span data-ttu-id="1ad50-197">*InstanceName* est le nom d’une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="1ad50-197">*InstanceName* is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] instance name.</span></span>|  
|<span data-ttu-id="1ad50-198">HOST/*fqdn*</span><span class="sxs-lookup"><span data-stu-id="1ad50-198">HOST/*fqdn*</span></span><br /><br /> <span data-ttu-id="1ad50-199">HOST/*MachineName*</span><span class="sxs-lookup"><span data-stu-id="1ad50-199">HOST/*MachineName*</span></span>|<span data-ttu-id="1ad50-200">Nom principal de service mappé aux comptes d'ordinateur intégrés qui sont inscrits automatiquement par Windows.</span><span class="sxs-lookup"><span data-stu-id="1ad50-200">The SPN that maps to built-in computer accounts that are automatically registered by Windows.</span></span>|  
|<span data-ttu-id="1ad50-201">*Nom d’utilisateur* @ *Domaine*</span><span class="sxs-lookup"><span data-stu-id="1ad50-201">*Username*@*Domain*</span></span>|<span data-ttu-id="1ad50-202">Spécification directe d'un compte de domaine.</span><span class="sxs-lookup"><span data-stu-id="1ad50-202">Direct specification of a domain account.</span></span><br /><br /> <span data-ttu-id="1ad50-203">*Username* est un nom de compte d'utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="1ad50-203">*Username* is a Windows user account name.</span></span><br /><br /> <span data-ttu-id="1ad50-204">*Domain* est un nom de domaine ou nom de domaine complet Windows.</span><span class="sxs-lookup"><span data-stu-id="1ad50-204">*Domain* is a Windows domain name or fully-qualified domain name.</span></span>|  
|<span data-ttu-id="1ad50-205">*Nomordinateur* $@ *Domaine*</span><span class="sxs-lookup"><span data-stu-id="1ad50-205">*MachineName*$@*Domain*</span></span>|<span data-ttu-id="1ad50-206">Spécification directe d'un compte d'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="1ad50-206">Direct specification of a computer account.</span></span><br /><br /> <span data-ttu-id="1ad50-207">(Si le serveur auquel vous vous connectez s’exécute sous les comptes système local ou service réseau, pour accéder à l’authentification Kerberos, `ServerSPN` peut *MachineName*être au format de $@ *domaine* MachineName.)</span><span class="sxs-lookup"><span data-stu-id="1ad50-207">(If the server you are connecting to is running under LOCAL SYSTEM or NETWORK SERVICE accounts, to get Kerberos authentication, `ServerSPN` can be in the *MachineName*$@*Domain* format.)</span></span>|  
|<span data-ttu-id="1ad50-208">*KDCKey* / *Nomordinateur*</span><span class="sxs-lookup"><span data-stu-id="1ad50-208">*KDCKey*/*MachineName*</span></span>|<span data-ttu-id="1ad50-209">Nom principal de service spécifié par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1ad50-209">A user-specified SPN.</span></span><br /><br /> <span data-ttu-id="1ad50-210">*KDCKey* est une chaîne alphanumérique conforme aux règles d'une clé du centre de distribution de clés.</span><span class="sxs-lookup"><span data-stu-id="1ad50-210">*KDCKey* is an alphanumeric string that conforms to the rules for a KDC key.</span></span>|  
  
## <a name="odbc-and-ole-db-syntax-supporting-spns"></a><span data-ttu-id="1ad50-211">Syntaxe ODBC et OLE DB prenant en charge les noms principaux de service</span><span class="sxs-lookup"><span data-stu-id="1ad50-211">ODBC and OLE DB Syntax Supporting SPNs</span></span>  
 <span data-ttu-id="1ad50-212">Pour plus d'informations spécifiques à la syntaxe, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="1ad50-212">For syntax-specific information, see the following topics:</span></span>  
  
-   [<span data-ttu-id="1ad50-213">Noms de principaux du service &#40;noms SPN&#41; dans les connexions clientes &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="1ad50-213">Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;</span></span>](../odbc/service-principal-names-spns-in-client-connections-odbc.md)  
  
-   [<span data-ttu-id="1ad50-214">Noms de principaux du service &#40;noms SPN&#41; dans les connexions clientes &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="1ad50-214">Service Principal Names &#40;SPNs&#41; in Client Connections &#40;OLE DB&#41;</span></span>](../ole-db/service-principal-names-spns-in-client-connections-ole-db.md)  
  
 <span data-ttu-id="1ad50-215">Pour plus d'informations sur les exemples d'applications qui illustrent cette fonctionnalité, consultez [Exemples de programmabilité des données SQL Server](https://msftdpprodsamples.codeplex.com/).</span><span class="sxs-lookup"><span data-stu-id="1ad50-215">For information about sample applications that demonstrate this feature, see [SQL Server Data Programmability Samples](https://msftdpprodsamples.codeplex.com/).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1ad50-216">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1ad50-216">See Also</span></span>  
 [<span data-ttu-id="1ad50-217">Fonctionnalités de SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="1ad50-217">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
