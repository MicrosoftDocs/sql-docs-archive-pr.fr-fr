---
title: Exécution d’opérations de copie en bloc | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602118"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="3eb7c-102">Exécution d'opérations de copie en bloc</span><span class="sxs-lookup"><span data-stu-id="3eb7c-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="3eb7c-103">La fonction de copie en bloc de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prend en charge le transfert de quantités importantes de données vers ou depuis une table ou une vue [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="3eb7c-104">Les données peuvent également être transférées en spécifiant une instruction SELECT.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="3eb7c-105">Les données peuvent être déplacées entre [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et un fichier de données du système d'exploitation, par exemple un fichier ASCII.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="3eb7c-106">Le fichier de données peut avoir différents formats ; le format est défini pour effectuer la copie en bloc dans un fichier de format.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="3eb7c-107">Facultativement, les données peuvent être chargées dans des variables de programme et transférées vers [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] à l'aide de fonctions et de méthodes de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="3eb7c-108">Pour obtenir un exemple d’application qui illustre cette fonctionnalité, consultez [Copier des données en bloc avec IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="3eb7c-109">Une application utilise en général la copie en bloc de l'une des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="3eb7c-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="3eb7c-110">Effectuer une copie en bloc à partir d'une table, d'une vue ou du jeu de résultats d'une instruction Transact-SQL dans un fichier de données où les données sont stockées dans le même format que la table ou la vue.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="3eb7c-111">On parle de « fichier de données en mode natif ».</span><span class="sxs-lookup"><span data-stu-id="3eb7c-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="3eb7c-112">Effectuer une copie en bloc à partir d'une table, d'une vue ou du jeu de résultats d'une instruction Transact-SQL dans un fichier de données où les données sont stockées dans un format différent de celui de la table ou de la vue.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="3eb7c-113">Dans ce cas, un fichier de format séparé est créé qui définit les caractéristiques (type de données, position, longueur, terminateur, etc.) de chaque colonne à mesure que les colonnes sont stockées dans le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="3eb7c-114">Si toutes les colonnes sont converties en format caractère, le fichier résultant est appelé un « fichier de données en mode caractère ».</span><span class="sxs-lookup"><span data-stu-id="3eb7c-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="3eb7c-115">Effectuer une copie en bloc à partir d'un fichier de données dans une table ou une vue.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="3eb7c-116">Si nécessaire, un fichier de format est utilisé pour déterminer la structure du fichier de données.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="3eb7c-117">Charger des données dans des variables de programme, puis importer les données dans une table ou une vue à l'aide des fonctions de copie en bloc pour effectuer la copie en bloc dans une ligne à la fois.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="3eb7c-118">Il n'est pas nécessaire que les fichiers de données utilisés par les fonctions de copie en bloc soient créés par un autre programme de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="3eb7c-119">Tout autre système peut générer un fichier de données et un fichier de format conformément aux définitions de la copie en bloc ; ces fichiers peuvent ensuite être utilisés avec un programme de copie en bloc [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour importer des données dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3eb7c-120">Par exemple, vous pouvez exporter des données à partir d'une feuille de calcul dans un fichier délimité par des tabulations, générer un fichier de format décrivant le fichier délimité par des tabulations, puis utilisez un programme de copie en bloc pour importer rapidement les données dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3eb7c-121">Les fichiers de données générés par la copie en bloc peuvent également être importés dans d'autres applications.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="3eb7c-122">Par exemple, vous pouvez utiliser des fonctions de copie en bloc pour exporter les données d'une table ou d'une vue dans un fichier délimité par des tabulations que vous pouvez ensuite charger dans une feuille de calcul.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="3eb7c-123">Les programmeurs qui codent des applications pour utiliser les fonctions de copie en bloc doivent respecter les règles générales pour obtenir de bonnes performances en matière de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="3eb7c-124">Pour plus d’informations sur la prise en charge des opérations de copie en bloc dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], consultez [Importation et exportation en bloc de données &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="3eb7c-125">Limitations et restrictions</span><span class="sxs-lookup"><span data-stu-id="3eb7c-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="3eb7c-126">Un type CLR défini par l'utilisateur (UDT) doit être lié en tant que données binaires.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="3eb7c-127">Même si un fichier de format spécifie SQLCHAR en tant que type de données pour une colonne UDT cible, l'utilitaire BCP traite les données en tant que données binaires.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="3eb7c-128">N'utilisez pas SET FMTONLY OFF avec des opérations de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="3eb7c-129">SET FMTONLY OFF peut entraîner l'échec de votre opération de copie en bloc ou générer des résultats inattendus.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="3eb7c-130">Fournisseur OLE DB SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="3eb7c-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="3eb7c-131">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client implémente deux méthodes pour effectuer des opérations de copie en bloc avec une [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] base de données.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="3eb7c-132">La première méthode implique l’utilisation de l’interface [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) pour les opérations de copie en bloc basées sur la mémoire, tandis que la seconde implique l’utilisation de l’interface [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) pour les opérations de copie en bloc basées sur le fichier.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="3eb7c-133">Utilisation d'opérations de copie en bloc basées sur la mémoire</span><span class="sxs-lookup"><span data-stu-id="3eb7c-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="3eb7c-134">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client implémente l’interface **IRowsetFastLoad** pour exposer la prise en charge des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] opérations de copie en bloc basées sur la mémoire.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="3eb7c-135">L’interface **IRowsetFastLoad** implémente les méthodes [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) et [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="3eb7c-136">Activation d'une session pour IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="3eb7c-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="3eb7c-137">Le consommateur notifie le fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client de son besoin en matière de copie en bloc en attribuant la valeur VARIANT_TRUE à la propriété SSPROP_ENABLEFASTLOAD de la source de données spécifique au fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="3eb7c-138">Lorsque la propriété est définie sur la source de données, le consommateur crée une session du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="3eb7c-139">La nouvelle session permet au consommateur d’accéder à l’interface **IRowsetFastLoad**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3eb7c-140">Si l’interface **IDataInitialize** est utilisée pour initialiser la source de données, vous devez définir la propriété SSPROP_IRowsetFastLoad dans le paramètre *rgPropertySets* de la méthode **IOpenRowset::OpenRowset** ; sinon, l’appel à la méthode **OpenRowset** retourne E_NOINTERFACE.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="3eb7c-141">L'activation d'une session pour la copie en bloc limite la prise en charge du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client aux interfaces sur la session.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="3eb7c-142">Une session compatible avec la copie en bloc expose uniquement les interfaces suivantes :</span><span class="sxs-lookup"><span data-stu-id="3eb7c-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="3eb7c-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="3eb7c-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="3eb7c-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="3eb7c-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="3eb7c-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="3eb7c-148">Pour désactiver la création d'ensembles de lignes compatibles avec la copie en bloc et forcer la session du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à rétablir le traitement standard, attribuez la valeur VARIANT_FALSE à SSPROP_ENABLEFASTLOAD.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="3eb7c-149">Ensembles de lignes IRowsetFastLoad</span><span class="sxs-lookup"><span data-stu-id="3eb7c-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="3eb7c-150">Les ensembles de lignes de copie en bloc du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client sont en écriture seule, mais ils exposent des interfaces qui permettent au consommateur de déterminer la structure d'une table [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="3eb7c-151">Les interfaces suivantes sont exposées sur un ensemble de lignes du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client compatible avec la copie en bloc :</span><span class="sxs-lookup"><span data-stu-id="3eb7c-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="3eb7c-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="3eb7c-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="3eb7c-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="3eb7c-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="3eb7c-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="3eb7c-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="3eb7c-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="3eb7c-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="3eb7c-159">Les propriétés spécifiques au fournisseur SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS et SSPROP_FASTLOADKEEPIDENTITY contrôle les comportements d'un ensemble de lignes de copie en bloc du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="3eb7c-160">Les propriétés sont spécifiées dans le membre *rgProperties* d’un membre de paramètre**IOpenRowset** _rgPropertySets_.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="3eb7c-161">ID de propriété</span><span class="sxs-lookup"><span data-stu-id="3eb7c-161">Property ID</span></span>|<span data-ttu-id="3eb7c-162">Description</span><span class="sxs-lookup"><span data-stu-id="3eb7c-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="3eb7c-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="3eb7c-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="3eb7c-164">Colonne : Non</span><span class="sxs-lookup"><span data-stu-id="3eb7c-164">Column: No</span></span><br /><br /> <span data-ttu-id="3eb7c-165">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="3eb7c-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="3eb7c-166">Tapez : VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="3eb7c-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="3eb7c-167">Valeur par défaut : VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="3eb7c-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="3eb7c-168">Description : maintient les valeurs d'identité fournies par le consommateur.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="3eb7c-169">VARIANT_FALSE : les valeurs pour une colonne d'identité dans la table [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sont générées par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3eb7c-170">Toute valeur liée à la colonne est ignorée par le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="3eb7c-171">VARIANT_TRUE : le consommateur lie un accesseur qui fournit une valeur pour une colonne d'identité [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="3eb7c-172">La propriété d’identité n’étant pas disponible sur les colonnes qui acceptent Null, le consommateur fournit une valeur unique sur chaque appel de **IRowsetFastLoad::Insert**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="3eb7c-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="3eb7c-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="3eb7c-174">Colonne : Non</span><span class="sxs-lookup"><span data-stu-id="3eb7c-174">Column: No</span></span><br /><br /> <span data-ttu-id="3eb7c-175">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="3eb7c-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="3eb7c-176">Tapez : VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="3eb7c-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="3eb7c-177">Valeur par défaut : VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="3eb7c-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="3eb7c-178">Description : maintient la valeur NULL pour les colonnes avec une contrainte DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="3eb7c-179">Affecte uniquement les colonnes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui acceptent NULL et auxquelles une contrainte DEFAULT est appliquée.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="3eb7c-180">VARIANT_FALSE : [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] insère la valeur par défaut pour la colonne lorsque le consommateur du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client insère une ligne contenant NULL pour la colonne.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="3eb7c-181">VARIANT_TRUE : [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] insère NULL pour la valeur de colonne lorsque le consommateur du fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client insère une ligne contenant NULL pour la colonne.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="3eb7c-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="3eb7c-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="3eb7c-183">Colonne : Non</span><span class="sxs-lookup"><span data-stu-id="3eb7c-183">Column: No</span></span><br /><br /> <span data-ttu-id="3eb7c-184">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="3eb7c-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="3eb7c-185">Tapez : VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="3eb7c-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="3eb7c-186">Valeur par défaut : aucune</span><span class="sxs-lookup"><span data-stu-id="3eb7c-186">Default: none</span></span><br /><br /> <span data-ttu-id="3eb7c-187">Description : cette propriété équivaut à l'option **-h** "*hint*[,...*n*]" de l'utilitaire **bcp**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="3eb7c-188">La ou les chaînes suivantes peuvent être utilisées en tant qu'options pour la copie en bloc de données dans une table.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="3eb7c-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Ordre de tri des données dans le fichier de données.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="3eb7c-190">Les performances de la copie en bloc peuvent être améliorées si le fichier de données à charger est trié conformément à l'index cluster de la table.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="3eb7c-191">**ROWS_PER_BATCH** = *bb* : Nombre de lignes de données par lot ( *bb*).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="3eb7c-192">Le serveur optimise le chargement en masse en fonction de la valeur de *bb*.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="3eb7c-193">Par défaut, **ROWS_PER_BATCH** est inconnu.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="3eb7c-194">**KILOBYTES_PER_BATCH** = *cc* : Nombre de kilo-octets (Ko) de données par lot (comme cc).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="3eb7c-195">Par défaut, **KILOBYTES_PER_BATCH** est inconnu.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="3eb7c-196">**TABLOCK** : Un verrou au niveau de la table est acquis pour la durée de l'opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="3eb7c-197">Cette option augmente sensiblement les performances car le maintien d'un verrou uniquement pour la durée de la seule opération de copie en bloc réduit la contention de verrou sur la table.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="3eb7c-198">Une table peut être chargée simultanément par plusieurs clients si elle ne comporte pas d’index et si **TABLOCK** est spécifié.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="3eb7c-199">Par défaut, le comportement de verrouillage est déterminé par l’option de table **table lock on bulk load**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="3eb7c-200">**CHECK_CONSTRAINTS** : Toutes les contraintes sur *table_name* sont vérifiées pendant l'opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="3eb7c-201">Par défaut, les contraintes sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="3eb7c-202">**FIRE_TRIGGER** : [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] utilise le contrôle de version de ligne pour les déclencheurs et stocke les versions des lignes dans le magasin de versions de la base de données **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="3eb7c-203">Par conséquent, les optimisations de journalisation en bloc sont disponibles même lorsque les déclencheurs sont activés.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="3eb7c-204">Avant de procéder à l’importation en bloc d’un lot comptant un nombre important de lignes avec les déclencheurs activés, vous devrez peut-être augmenter la taille de **tempdb**.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="3eb7c-205">Utilisation d'opérations de copie en bloc basées sur le fichier</span><span class="sxs-lookup"><span data-stu-id="3eb7c-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="3eb7c-206">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client implémente l’interface **IBCPSession** pour exposer la prise en charge des [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] opérations de copie en bloc basées sur des fichiers.</span><span class="sxs-lookup"><span data-stu-id="3eb7c-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="3eb7c-207">L’interface **IBCPSession** implémente les méthodes [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) et [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="3eb7c-208">Pilote ODBC SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="3eb7c-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="3eb7c-209">Le pilote ODBC [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client maintient la même prise en charge pour les opérations de copie en bloc qui faisaient partie des versions précédentes du pilote ODBC [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3eb7c-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="3eb7c-210">Pour plus d’informations sur les opérations de copie en bloc à l’aide du [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC Native Client, consultez [exécution d’opérations de copie en bloc &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="3eb7c-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3eb7c-211">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3eb7c-211">See Also</span></span>  
 <span data-ttu-id="3eb7c-212">[Fonctionnalités de SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="3eb7c-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="3eb7c-213">[Propriétés de la source de données &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="3eb7c-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="3eb7c-214">[Importation et exportation en bloc de données &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="3eb7c-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="3eb7c-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="3eb7c-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="3eb7c-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="3eb7c-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="3eb7c-217">[Optimisation des performances de l’importation en bloc](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="3eb7c-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
