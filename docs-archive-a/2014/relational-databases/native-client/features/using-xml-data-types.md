---
title: Utilisation des types de données XML | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- IRowsetChange interface
- IRowsetUpdate interface
- data access [SQL Server Native Client], xml data type
- SQL Server Native Client OLE DB schema rowsets
- PROVIDER_TYPES rowset
- IColumnsInfo interface
- IRowsetFind interface
- IColumnsRowset interface
- PROCEDURE_PARAMETERS rowset
- SQLNCLI, XML
- xml data type [SQL Server], SQL Server Native Client
- SQL Server Native Client, XML
- IRowset interface
- ISequentialStream interface
- ISSCommandWithParameters interface
- SS_XMLSCHEMA rowset
- SQL Server Native Client OLE DB interfaces
- XML [SQL Server], SQL Server Native Client
- COLUMNS rowset
ms.assetid: a7af5b72-c5c2-418d-a636-ae4ac6270ee5
author: rothja
ms.author: jroth
ms.openlocfilehash: 3d0dcc8cf7259a24e53281724d8440c6ff2209f1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612275"
---
# <a name="using-xml-data-types"></a><span data-ttu-id="99a72-102">Utilisation de types de données XML</span><span class="sxs-lookup"><span data-stu-id="99a72-102">Using XML Data Types</span></span>
  [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] <span data-ttu-id="99a72-103">a introduit un type de données **xml** qui vous permet de stocker des documents et des fragments XML dans une base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99a72-103">introduced an **xml** data type that enables you to store XML documents and fragments in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="99a72-104">Le type de données **xml** est intégré dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et s’apparente à certains égards à d’autres types intégrés, comme **int** et **varchar**.</span><span class="sxs-lookup"><span data-stu-id="99a72-104">The **xml** data type is a built-in data type in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], and is in some ways similar to other built-in types, such as **int** and **varchar**.</span></span> <span data-ttu-id="99a72-105">Tout comme les autres types intégrés, vous pouvez utiliser le type de données **xml** en tant que type de colonne quand vous créez une table ou en tant que type de variable, type de paramètre ou type de retour de fonction ou bien dans des fonctions CAST et CONVERT.</span><span class="sxs-lookup"><span data-stu-id="99a72-105">As with other built-in types, you can use the **xml** data type as a column type when creating a table; as a variable type, a parameter type, or a function-return type; or in CAST and CONVERT functions.</span></span>  
  
## <a name="programming-considerations"></a><span data-ttu-id="99a72-106">Éléments de programmation à prendre en considération</span><span class="sxs-lookup"><span data-stu-id="99a72-106">Programming Considerations</span></span>  
 <span data-ttu-id="99a72-107">XML peut être autodescriptif dans ce sens où il peut inclure un en-tête XML (facultatif) qui spécifie l'encodage du document. Par exemple :</span><span class="sxs-lookup"><span data-stu-id="99a72-107">XML can be self-describing in that it can optionally include an XML header that specifies the encoding of the document, for example:</span></span>  
  
 `<?xml version="1.0" encoding="windows-1252"?><doc/>`  
  
 <span data-ttu-id="99a72-108">Le standard XML décrit la manière dont un processeur XML est capable de détecter l'encodage utilisé pour un document en examinant les premiers octets du document.</span><span class="sxs-lookup"><span data-stu-id="99a72-108">The XML standard describes how an XML processor can detect the encoding used for a document by examining the first few bytes of the document.</span></span> <span data-ttu-id="99a72-109">Parfois, il est possible que l'encodage spécifié par l'application soit en conflit avec celui spécifié par le document.</span><span class="sxs-lookup"><span data-stu-id="99a72-109">There are opportunities for the encoding specified by the application to conflict with the encoding specified by the document.</span></span> <span data-ttu-id="99a72-110">Dans le cadre des documents passés en tant que paramètres liés, XML est traité en tant que données binaires par [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ; aucune conversion n'est donc réalisée et l'analyseur XML peut sans problème exploiter l'encodage spécifié dans le document.</span><span class="sxs-lookup"><span data-stu-id="99a72-110">For documents passed as bound parameters, XML is treated as binary data by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], so no conversions are made and the XML parser can use the encoding specified within the document without problems.</span></span> <span data-ttu-id="99a72-111">Toutefois, pour les données XML liées en tant que données de type WSTR, l'application doit alors garantir que le document est encodé au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="99a72-111">However, for XML data that is bound as WSTR, then the application must ensure that the document is encoded as Unicode.</span></span> <span data-ttu-id="99a72-112">Ceci peut impliquer le chargement du document dans un DOM, le passage de l'encodage en Unicode et la sérialisation du document.</span><span class="sxs-lookup"><span data-stu-id="99a72-112">This may entail loading the document into a DOM, changing the encoding to Unicode and serializing the document.</span></span> <span data-ttu-id="99a72-113">Si cela n'est pas fait, des conversions de données peuvent se produire et générer simultanément des données XML non valides ou endommagées.</span><span class="sxs-lookup"><span data-stu-id="99a72-113">If this is not done, data conversions may occur, resulting in invalid or corrupt XML.</span></span>  
  
 <span data-ttu-id="99a72-114">Il existe également un risque potentiel de conflit lorsque vous spécifiez du XML dans des littéraux.</span><span class="sxs-lookup"><span data-stu-id="99a72-114">There is also potential for conflict when XML is specified in literals.</span></span> <span data-ttu-id="99a72-115">Par exemple, les données suivantes ne sont pas valides :</span><span class="sxs-lookup"><span data-stu-id="99a72-115">For example the following are invalid:</span></span>  
  
 `INSERT INTO xmltable(xmlcol) VALUES('<?xml version="1.0" encoding="UTF-16"?><doc/>')`  
  
 `INSERT INTO xmltable(xmlcol) VALUES(N'<?xml version="1.0" encoding="UTF-8"?><doc/>')`  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="99a72-116">Fournisseur OLE DB SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="99a72-116">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="99a72-117">DBTYPE_XML est un nouveau type de données propre à XML dans le fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="99a72-117">DBTYPE_XML is a new data type specific to XML in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="99a72-118">De plus, vous pouvez accéder aux données XML par le biais des types OLE DB existants DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT et DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="99a72-118">In addition, XML data can be accessed through the existing OLE DB types of DBTYPE_BYTES, DBTYPE_WSTR, DBTYPE_BSTR, DBTYPE_XML, DBTYPE_STR, DBTYPE_VARIANT, and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="99a72-119">Les données stockées dans les colonnes de type XML peuvent être extraites à partir de la colonne d'un ensemble de lignes de fournisseur OLE DB [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client dans les formats suivants :</span><span class="sxs-lookup"><span data-stu-id="99a72-119">Data stored in columns of type XML can be retrieved from a column in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset in the following formats:</span></span>  
  
-   <span data-ttu-id="99a72-120">Chaîne de texte</span><span class="sxs-lookup"><span data-stu-id="99a72-120">A text string</span></span>  
  
-   <span data-ttu-id="99a72-121">**ISequentialStream**</span><span class="sxs-lookup"><span data-stu-id="99a72-121">An **ISequentialStream**</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="99a72-122">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client n’inclut pas de lecteur SAX, mais **ISequentialStream** peut être facilement passé aux objets sax et DOM dans MSXML.</span><span class="sxs-lookup"><span data-stu-id="99a72-122">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider does not include a SAX reader, but the **ISequentialStream** can be easily passed to SAX and DOM objects in MSXML.</span></span>  
  
 <span data-ttu-id="99a72-123">**ISequentialStream** doit être utilisé pour la récupération de documents XML volumineux.</span><span class="sxs-lookup"><span data-stu-id="99a72-123">**ISequentialStream** should be use used for retrieval of large XML documents.</span></span> <span data-ttu-id="99a72-124">Les mêmes techniques utilisées pour les types de valeur élevée s'appliquent également à XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-124">The same techniques used for other large value types also apply to XML.</span></span> <span data-ttu-id="99a72-125">Pour plus d’informations, consultez la section [Utilisation de types de valeur élevée](using-large-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="99a72-125">For more information, see [Using Large Value Types](using-large-value-types.md).</span></span>  
  
 <span data-ttu-id="99a72-126">Les données stockées dans les colonnes de type XML dans un ensemble de lignes peuvent également être récupérées, insérées ou mises à jour par une application via les interfaces classiques, comme **IRow::GetColumns**, **IRowChange::SetColumns** et **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="99a72-126">Data stored in columns of type XML in a rowset can also be retrieved, inserted, or updated by an application via the usual interfaces such as **IRow::GetColumns**, **IRowChange::SetColumns**, and **ICommand::Execute**.</span></span> <span data-ttu-id="99a72-127">De même que dans le cas de l’extraction, un programme d’application peut transmettre une chaîne de texte ou une **ISequentialStream** au [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="99a72-127">Similarly to the retrieval case, an application program can pass either a text string or an **ISequentialStream** to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="99a72-128">Pour envoyer des données XML dans un format de chaîne par le biais de l’interface **ISequentialStream**, vous devez obtenir **ISequentialStream** en spécifiant DBTYPE_IUNKNOWN et affecter la valeur Null à son argument *pObject* dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="99a72-128">To send XML data in string format through the **ISequentialStream** interface, you must obtain **ISequentialStream** by specifying DBTYPE_IUNKNOWN and set its *pObject* argument to null in the binding.</span></span>  
  
 <span data-ttu-id="99a72-129">Lorsque des données XML extraites apparaissent tronquées en raison d'une mémoire tampon du consommateur trop petite, la longueur retournée peut être 0xffffffff, ce qui signifie qu'elle est n'est pas connue.</span><span class="sxs-lookup"><span data-stu-id="99a72-129">When retrieved XML data is truncated due to the consumer buffer being too small, the length may be returned as 0xffffffff, which means that the length is unknown.</span></span> <span data-ttu-id="99a72-130">Ceci est cohérent avec son implémentation en tant que type de données transmis au client sans envoyer des informations de longueur avant les données réelles.</span><span class="sxs-lookup"><span data-stu-id="99a72-130">This is consistent with its implementation as a data type that is streamed to the client without sending length information ahead of the actual data.</span></span> <span data-ttu-id="99a72-131">Dans certains cas, la longueur réelle peut être retournée lorsque le fournisseur a mis en mémoire tampon la valeur entière, telle que **IRowset :: GetData** et où la conversion des données est effectuée.</span><span class="sxs-lookup"><span data-stu-id="99a72-131">In some cases the actual length may be returned when the provider has buffered the whole value, such as **IRowset::GetData** and where data conversion is performed.</span></span>  
  
 <span data-ttu-id="99a72-132">Les données XML envoyées à SQL Server sont traitées en tant que données binaires par le serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-132">XML data sent to SQL Server is treated as binary data by the server.</span></span> <span data-ttu-id="99a72-133">Ceci empêche tout risque de conversion et permet à l'analyseur XML de détecter automatiquement l'encodage XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-133">This prevents any conversions occurring and allows the XML parser to auto-detect the XML encoding.</span></span> <span data-ttu-id="99a72-134">Un plus large éventail de documents XML (par exemple, les documents encodés au format UTF-8) peuvent être acceptés en tant qu'entrées dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99a72-134">This allows a wider range of XML documents (for example those encoded in UTF-8) to be accepted as input to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="99a72-135">Si du contenu XML d'entrée est lié en tant que données du type DBTYPE_WSTR, l'application doit garantir qu'il est déjà encodé en Unicode pour éviter tout risque d'altération suite à des conversions de données indésirables.</span><span class="sxs-lookup"><span data-stu-id="99a72-135">If input XML is bound as DBTYPE_WSTR, the application must ensure it is already Unicode encoded to avoid any possibility of corruption by unwanted data conversions.</span></span>  
  
### <a name="data-bindings-and-coercions"></a><span data-ttu-id="99a72-136">Liaisons de données et forçages de type</span><span class="sxs-lookup"><span data-stu-id="99a72-136">Data Bindings and Coercions</span></span>  
 <span data-ttu-id="99a72-137">Le tableau suivant décrit la liaison et le forçage de type survenant quand vous utilisez les types de données répertoriés avec le type de données  **xml**[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="99a72-137">The following table describes the binding and coercion that occurs when using the listed data types with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **xml** data type.</span></span>  
  
|<span data-ttu-id="99a72-138">Type de données</span><span class="sxs-lookup"><span data-stu-id="99a72-138">Data type</span></span>|<span data-ttu-id="99a72-139">Vers le serveur</span><span class="sxs-lookup"><span data-stu-id="99a72-139">To Server</span></span><br /><br /> <span data-ttu-id="99a72-140">**XML**</span><span class="sxs-lookup"><span data-stu-id="99a72-140">**XML**</span></span>|<span data-ttu-id="99a72-141">Vers le serveur</span><span class="sxs-lookup"><span data-stu-id="99a72-141">To Server</span></span><br /><br /> <span data-ttu-id="99a72-142">**Non-XML**</span><span class="sxs-lookup"><span data-stu-id="99a72-142">**Non-XML**</span></span>|<span data-ttu-id="99a72-143">Depuis le serveur</span><span class="sxs-lookup"><span data-stu-id="99a72-143">From Server</span></span><br /><br /> <span data-ttu-id="99a72-144">**XML**</span><span class="sxs-lookup"><span data-stu-id="99a72-144">**XML**</span></span>|<span data-ttu-id="99a72-145">Depuis le serveur</span><span class="sxs-lookup"><span data-stu-id="99a72-145">From Server</span></span><br /><br /> <span data-ttu-id="99a72-146">**Non-XML**</span><span class="sxs-lookup"><span data-stu-id="99a72-146">**Non-XML**</span></span>|  
|---------------|---------------------------|--------------------------------|-----------------------------|----------------------------------|  
|<span data-ttu-id="99a72-147">DBTYPE_XML</span><span class="sxs-lookup"><span data-stu-id="99a72-147">DBTYPE_XML</span></span>|<span data-ttu-id="99a72-148">Transfert direct<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-148">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="99a72-149">Erreur<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-149">Error<sup>1</sup></span></span>|<span data-ttu-id="99a72-150">OK<sup>11, 6</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-150">OK<sup>11, 6</sup></span></span>|<span data-ttu-id="99a72-151">Erreur<sup>8</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-151">Error<sup>8</sup></span></span>|  
|<span data-ttu-id="99a72-152">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="99a72-152">DBTYPE_BYTES</span></span>|<span data-ttu-id="99a72-153">Transfert direct<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-153">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="99a72-154">N/A<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-154">N/A<sup>2</sup></span></span>|<span data-ttu-id="99a72-155">OK <sup>11, 6</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-155">OK <sup>11, 6</sup></span></span>|<span data-ttu-id="99a72-156">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-156">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-157">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-157">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-158">Transfert direct<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-158">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="99a72-159">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-159">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-160">OK<sup>4, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-160">OK<sup>4, 6, 12</sup></span></span>|<span data-ttu-id="99a72-161">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-161">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-162">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-162">DBTYPE_BSTR</span></span>|<span data-ttu-id="99a72-163">Transfert direct<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-163">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="99a72-164">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-164">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-165">OK <sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-165">OK <sup>3</sup></span></span>|<span data-ttu-id="99a72-166">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-166">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-167">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="99a72-167">DBTYPE_STR</span></span>|<span data-ttu-id="99a72-168">OK<sup>6, 9, 10</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-168">OK<sup>6, 9, 10</sup></span></span>|<span data-ttu-id="99a72-169">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-169">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-170">OK<sup>5, 6, 12</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-170">OK<sup>5, 6, 12</sup></span></span>|<span data-ttu-id="99a72-171">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-171">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-172">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="99a72-172">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="99a72-173">Flux d’octets via **ISequentialStream**<sup>7</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-173">Byte stream via **ISequentialStream**<sup>7</sup></span></span>|<span data-ttu-id="99a72-174">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-174">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-175">Flux d’octets via **ISequentialStream**<sup>11</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-175">Byte stream via **ISequentialStream**<sup>11</sup></span></span>|<span data-ttu-id="99a72-176">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-176">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="99a72-177">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="99a72-178">Transfert direct<sup>6,7</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-178">Pass through<sup>6,7</sup></span></span>|<span data-ttu-id="99a72-179">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-179">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-180">N/A</span><span class="sxs-lookup"><span data-stu-id="99a72-180">N/A</span></span>|<span data-ttu-id="99a72-181">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-181">N/A <sup>2</sup></span></span>|  
|<span data-ttu-id="99a72-182">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="99a72-182">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="99a72-183">Transfert direct<sup>6,10</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-183">Pass through<sup>6,10</sup></span></span>|<span data-ttu-id="99a72-184">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-184">N/A <sup>2</sup></span></span>|<span data-ttu-id="99a72-185">OK<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-185">OK<sup>3</sup></span></span>|<span data-ttu-id="99a72-186">N/A <sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="99a72-186">N/A <sup>2</sup></span></span>|  
  
 <span data-ttu-id="99a72-187"><sup>1</sup> Si un type de serveur autre que DBTYPE_XML est spécifié avec **ICommandWithParameters :: SetParameterInfo** et que le type d’accesseur est DBTYPE_XML, une erreur se produit lorsque l’instruction est exécutée (DB_E_ERRORSOCCURRED, l’état du paramètre est DBSTATUS_E_BADACCESSOR); dans le cas contraire, les données sont envoyées au serveur, mais le serveur retourne une erreur indiquant qu’il n’existe aucune conversion implicite de XML en type de données du paramètre.</span><span class="sxs-lookup"><span data-stu-id="99a72-187"><sup>1</sup>If a server type other than DBTYPE_XML is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_XML, an error occurs when the statement is executed (DB_E_ERRORSOCCURRED, the parameter status is DBSTATUS_E_BADACCESSOR); otherwise the data is sent to the server, but the server returns an error indicating that there is no implicit conversion from XML to the parameter's data type.</span></span>  
  
 <span data-ttu-id="99a72-188"><sup>2</sup> Au-delà du cadre de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="99a72-188"><sup>2</sup>Beyond the scope of this topic.</span></span>  
  
 <span data-ttu-id="99a72-189"><sup>3</sup>Le format est UTF-16. Absence de marque d’ordre d’octet (BOM), de spécification d’encodage et de marque de fin Null.</span><span class="sxs-lookup"><span data-stu-id="99a72-189"><sup>3</sup>Format is UTF-16, no bye-order mark (BOM), no encoding specification, no null termination.</span></span>  
  
 <span data-ttu-id="99a72-190"><sup>4</sup>Le format est UTF-16. Absence de marque d’ordre d’octet (BOM), de spécification d’encodage et de marque de fin Null.</span><span class="sxs-lookup"><span data-stu-id="99a72-190"><sup>4</sup>Format is UTF-16, no BOM, no encoding specification, null termination.</span></span>  
  
 <span data-ttu-id="99a72-191"><sup>5</sup>Le format employé est celui de caractères multioctets encodés dans la page de codes du client avec une marque de fin Null.</span><span class="sxs-lookup"><span data-stu-id="99a72-191"><sup>5</sup>Format is multibyte characters encoded in client code page with null terminator.</span></span> <span data-ttu-id="99a72-192">Toute conversion à partir de code Unicode sur le serveur risque d'endommager les données. Cette liaison est donc fortement déconseillée.</span><span class="sxs-lookup"><span data-stu-id="99a72-192">Conversion from server supplied Unicode may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="99a72-193"><sup>6</sup>BY_REF peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="99a72-193"><sup>6</sup>BY_REF may be used.</span></span>  
  
 <span data-ttu-id="99a72-194"><sup>7</sup>Les données UTF-16 doivent commencer par une marque d’ordre d’octet.</span><span class="sxs-lookup"><span data-stu-id="99a72-194"><sup>7</sup>UTF-16 data must start with a BOM.</span></span> <span data-ttu-id="99a72-195">Si cela n'est pas le cas, il est possible que l'encodage ne soit pas correctement reconnu par le serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-195">If it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
 <span data-ttu-id="99a72-196"><sup>8</sup>La validation peut avoir lieu au moment de créer l’accesseur ou au moment de l’extraction.</span><span class="sxs-lookup"><span data-stu-id="99a72-196"><sup>8</sup>Validation can happen at create accessor time, or at fetch time.</span></span> <span data-ttu-id="99a72-197">L'erreur est DB_E_ERRORSOCCURRED et l'état de la liaison est défini sur DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="99a72-197">The error is DB_E_ERRORSOCCURRED, binding status set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>  
  
 <span data-ttu-id="99a72-198"><sup>9</sup>Les données sont converties au format Unicode à l’aide de la page de codes du client avant d’être envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-198"><sup>9</sup>Data is converted to Unicode using the client codepage before being sent to the server.</span></span> <span data-ttu-id="99a72-199">Si l'encodage du document ne correspond pas à la page de codes du client, les données risquent d'être endommagées. Cette liaison est donc fortement déconseillée.</span><span class="sxs-lookup"><span data-stu-id="99a72-199">If the document encoding does not match the client codepage, this can result in data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="99a72-200"><sup>10</sup>Une marque d’ordre d’octet est toujours ajoutée aux données envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-200"><sup>10</sup>A BOM is always added to data sent to the server.</span></span> <span data-ttu-id="99a72-201">Si les données commencent déjà par une marque d'ordre d'octet, deux marques d'ordre d'octet apparaissent alors au démarrage de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="99a72-201">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="99a72-202">Le serveur utilise la première marque d’ordre d’octet pour reconnaître l’encodage en tant qu’encodage UTF-16, puis l’ignore.</span><span class="sxs-lookup"><span data-stu-id="99a72-202">The server uses the first BOM to recognize the encoding as UTF-16 and then discards it.</span></span> <span data-ttu-id="99a72-203">La deuxième marque d'ordre d'octet est interprétée comme un espace insécable de largeur nulle.</span><span class="sxs-lookup"><span data-stu-id="99a72-203">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
 <span data-ttu-id="99a72-204"><sup>11</sup>Le format est UTF-16. Absence de spécification d’encodage et ajout d’une marque d’ordre d’octet aux données reçues du serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-204"><sup>11</sup>Format is UTF-16, no encoding specification, a BOM is added to data received from the server.</span></span> <span data-ttu-id="99a72-205">Si le serveur retourne une chaîne vide, une marque d’ordre d’octet est quand même retournée à l’application.</span><span class="sxs-lookup"><span data-stu-id="99a72-205">If an empty string is returned by the server, a BOM is still returned to the application.</span></span> <span data-ttu-id="99a72-206">Si la longueur de la mémoire tampon est un nombre impair d’octets, les données sont tronquées comme il se doit.</span><span class="sxs-lookup"><span data-stu-id="99a72-206">If the buffer length is an odd number of bytes, the data is truncated correctly.</span></span> <span data-ttu-id="99a72-207">Si la valeur entière est retournée en plusieurs segments, vous pouvez les concaténer pour reconstituer la valeur correcte.</span><span class="sxs-lookup"><span data-stu-id="99a72-207">If the whole value is returned in chunks, they can be concatenated to reconstitute the correct value.</span></span>  
  
 <span data-ttu-id="99a72-208"><sup>12</sup> Si la longueur de la mémoire tampon est inférieure à deux caractères, c’est-à-dire que l’espace est insuffisant pour la fin de la valeur null, une erreur de dépassement est signalée.</span><span class="sxs-lookup"><span data-stu-id="99a72-208"><sup>12</sup>If the buffer length is less than two characters--that is, not enough space for null termination--an overflow error is reported.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="99a72-209">Aucune donnée n'est retournée pour les valeurs XML NULL.</span><span class="sxs-lookup"><span data-stu-id="99a72-209">No data is returned for NULL XML values.</span></span>  
  
 <span data-ttu-id="99a72-210">Le standard XML exigent que les données XML encodées UTF-16 commencent par une marque d'ordre d'octet (BOM), soit le code de caractère UTF-16 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="99a72-210">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="99a72-211">Lorsque vous travaillez avec des liaisons WSTR et BSTR, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client n’exige pas ou n’ajoute pas de marque de nomenclature, car l’encodage est implicite par la liaison.</span><span class="sxs-lookup"><span data-stu-id="99a72-211">When working with WSTR and BSTR bindings, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM as the encoding is implied by the binding.</span></span> <span data-ttu-id="99a72-212">Dans le cadre des liaisons BYTES, XML ou IUNKNOWN, l'objectif recherché est la simplification de l'utilisation d'autres processeurs et systèmes de stockage XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-212">When working with BYTES, XML, or IUNKNOWN bindings, the intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="99a72-213">Dans ce cas, une marque d'ordre d'octet doit être présente avec les données XML encodées UTF-16 et l'application n'a pas à se soucier de l'encodage réel puisque la majorité des processeurs XML (y compris SQL Server) détectent l'encodage par inspection des premiers octets de la valeur.</span><span class="sxs-lookup"><span data-stu-id="99a72-213">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, since the majority of XML processors (including SQL Server) deduces the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="99a72-214">Les données XML reçues de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client à l’aide de liaisons bytes, XML ou IUnknown sont toujours encodées en UTF-16 avec une marque de nomenclature et sans déclaration d’encodage incorporée.</span><span class="sxs-lookup"><span data-stu-id="99a72-214">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using BYTES, XML, or IUNKNOWN bindings is always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
 <span data-ttu-id="99a72-215">Les conversions de données fournies par les services principaux OLE DB (**IDataConvert**) ne s’appliquent pas à DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-215">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_XML.</span></span>  
  
 <span data-ttu-id="99a72-216">La validation s'effectue lorsque les données sont envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-216">Validation is done when data is sent to the server.</span></span> <span data-ttu-id="99a72-217">La validation côté client et les modifications d'encodage doivent être gérées par votre application et il est fortement recommandé que vous ne traitiez pas les données XML directement mais utilisiez à la place un lecteur DOM ou SAX pour leur traitement.</span><span class="sxs-lookup"><span data-stu-id="99a72-217">Client-side validation and encoding changes should be handled by your application, and it is strongly recommended that you not process the XML data directly, but should instead use a DOM or SAX reader to process it.</span></span>  
  
 <span data-ttu-id="99a72-218">Les types DBTYPE_NULL et DBTYPE_EMPTY peuvent être liés pour des paramètres d'entrée mais pas pour des paramètres de résultats ou pour des sorties.</span><span class="sxs-lookup"><span data-stu-id="99a72-218">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters but not for output parameters or results.</span></span> <span data-ttu-id="99a72-219">S'ils sont liés pour des paramètres d'entrée, l'état doit être défini sur DBSTATUS_S_ISNULL ou DBSTATUS_S_DEFAULT.</span><span class="sxs-lookup"><span data-stu-id="99a72-219">When bound for input parameters the status must be set to DBSTATUS_S_ISNULL or DBSTATUS_S_DEFAULT.</span></span>  
  
 <span data-ttu-id="99a72-220">DBTYPE_XML peut être converti en DBTYPE_EMPTY et DBTYPE_NULL, DBTYPE_EMPTY peut être converti en DBTYPE_XML mais DBTYPE_NULL ne peut pas être converti en DBTYPE_XML,</span><span class="sxs-lookup"><span data-stu-id="99a72-220">DBTYPE_XML can be converted to DBTYPE_EMPTY and DBTYPE_NULL, DBTYPE_EMPTY can be converted to DBTYPE_XML, but DBTYPE_NULL cannot be converted to DBTYPE_XML.</span></span> <span data-ttu-id="99a72-221">ce qui est cohérent avec DBTYPE_WSTR.</span><span class="sxs-lookup"><span data-stu-id="99a72-221">This is consistent with DBTYPE_WSTR.</span></span>  
  
 <span data-ttu-id="99a72-222">DBTYPE_IUNKNOWN est une liaison prise en charge (voir le tableau ci-dessus) mais il n'existe aucune conversion entre DBTYPE_XML et DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="99a72-222">DBTYPE_IUNKNOWN is a supported binding (as shown in the above table), but there are no conversions between DBTYPE_XML and DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="99a72-223">DBTYPE_IUNKNOWN ne peut pas être utilisé avec DBTYPE_BYREF.</span><span class="sxs-lookup"><span data-stu-id="99a72-223">DBTYPE_IUNKNOWN may not be used with DBTYPE_BYREF.</span></span>  
  
### <a name="ole-db-rowset-additions-and-changes"></a><span data-ttu-id="99a72-224">Ajout et modifications dans les ensembles de lignes OLE DB</span><span class="sxs-lookup"><span data-stu-id="99a72-224">OLE DB Rowset Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="99a72-225">Native Client ajoute de nouvelles valeurs ou des modifications à un grand nombre d’ensembles de lignes de schéma OLE DB de base.</span><span class="sxs-lookup"><span data-stu-id="99a72-225">Native Client adds new values or changes to many of the core OLE DB schema rowsets.</span></span>  
  
#### <a name="the-columns-and-procedure_parameters-schema-rowsets"></a><span data-ttu-id="99a72-226">Ensembles de lignes de schéma COLUMNS et PROCEDURE_PARAMETERS</span><span class="sxs-lookup"><span data-stu-id="99a72-226">The COLUMNS and PROCEDURE_PARAMETERS Schema Rowsets</span></span>  
 <span data-ttu-id="99a72-227">Les ajouts réalisés dans les ensembles de lignes de schéma COLUMNS et PROCEDURE_PARAMETERS incluent les colonnes suivantes.</span><span class="sxs-lookup"><span data-stu-id="99a72-227">Additions to the COLUMNS and PROCEDURE_PARAMETERS schema rowsets include the following columns.</span></span>  
  
|<span data-ttu-id="99a72-228">Nom de la colonne</span><span class="sxs-lookup"><span data-stu-id="99a72-228">Column name</span></span>|<span data-ttu-id="99a72-229">Type</span><span class="sxs-lookup"><span data-stu-id="99a72-229">Type</span></span>|<span data-ttu-id="99a72-230">Description</span><span class="sxs-lookup"><span data-stu-id="99a72-230">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="99a72-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-231">SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="99a72-232">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-232">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-233">Nom d'un catalogue dans lequel une collection de schémas XML est définie.</span><span class="sxs-lookup"><span data-stu-id="99a72-233">The name of a catalog in which an XML schema collection is defined.</span></span> <span data-ttu-id="99a72-234">Possède la valeur NULL pour une colonne non XML ou une colonne XML non typée.</span><span class="sxs-lookup"><span data-stu-id="99a72-234">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="99a72-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-235">SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="99a72-236">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-236">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-237">Nom d'un schéma dans lequel une collection de schémas XML est définie.</span><span class="sxs-lookup"><span data-stu-id="99a72-237">The name of a schema in which an XML schema collection is defined.</span></span> <span data-ttu-id="99a72-238">Possède la valeur NULL pour une colonne non XML ou une colonne XML non typée.</span><span class="sxs-lookup"><span data-stu-id="99a72-238">NULL for a non-XML column or un-typed XML column.</span></span>|  
|<span data-ttu-id="99a72-239">SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-239">SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="99a72-240">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-240">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-241">Nom de la collection de schémas XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-241">The name of XML schema collection.</span></span> <span data-ttu-id="99a72-242">Possède la valeur NULL pour une colonne non XML ou une colonne XML non typée.</span><span class="sxs-lookup"><span data-stu-id="99a72-242">NULL for a non-XML column or un-typed XML column.</span></span>|  
  
#### <a name="the-provider_types-schema-rowset"></a><span data-ttu-id="99a72-243">Ensemble de lignes de schéma PROVIDER_TYPES</span><span class="sxs-lookup"><span data-stu-id="99a72-243">The PROVIDER_TYPES Schema Rowset</span></span>  
 <span data-ttu-id="99a72-244">Dans l’ensemble de lignes de schéma PROVIDER_TYPES, la valeur COLUMN_SIZE est 0 pour le type de données **xml** et la valeur DATA_TYPE est DBTYPE_XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-244">In the PROVIDER_TYPES schema rowset, the COLUMN_SIZE value is 0 for the **xml** data type, and the DATA_TYPE is DBTYPE_XML.</span></span>  
  
#### <a name="the-ss_xmlschema-schema-rowset"></a><span data-ttu-id="99a72-245">Ensemble de lignes de schéma SS_XMLSCHEMA</span><span class="sxs-lookup"><span data-stu-id="99a72-245">The SS_XMLSCHEMA Schema Rowset</span></span>  
 <span data-ttu-id="99a72-246">Un nouvel ensemble de lignes de schéma SS_XMLSCHEMA permettant d'extraire des informations de schéma XML est proposé pour les clients.</span><span class="sxs-lookup"><span data-stu-id="99a72-246">A new schema rowset SS_XMLSCHEMA is introduced for clients to retrieve XML schema information.</span></span> <span data-ttu-id="99a72-247">L'ensemble de lignes SS_XMLSCHEMA contient les colonnes suivantes.</span><span class="sxs-lookup"><span data-stu-id="99a72-247">The SS_XMLSCHEMA rowset contains the following columns.</span></span>  
  
|<span data-ttu-id="99a72-248">Nom de la colonne</span><span class="sxs-lookup"><span data-stu-id="99a72-248">Column name</span></span>|<span data-ttu-id="99a72-249">Type</span><span class="sxs-lookup"><span data-stu-id="99a72-249">Type</span></span>|<span data-ttu-id="99a72-250">Description</span><span class="sxs-lookup"><span data-stu-id="99a72-250">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="99a72-251">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-251">SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="99a72-252">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-252">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-253">Catalogue auquel une collection XML appartient.</span><span class="sxs-lookup"><span data-stu-id="99a72-253">The catalog an XML collection belongs to.</span></span>|  
|<span data-ttu-id="99a72-254">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-254">SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="99a72-255">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-255">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-256">Schéma auquel une collection XML appartient.</span><span class="sxs-lookup"><span data-stu-id="99a72-256">The schema an XML collection belongs to.</span></span>|  
|<span data-ttu-id="99a72-257">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-257">SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="99a72-258">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-258">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-259">Nom d’une collection de schémas XML pour les colonnes XML typées, valeur Null dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="99a72-259">The name of an XML schema collection for typed XML columns, NULL otherwise.</span></span>|  
|<span data-ttu-id="99a72-260">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="99a72-260">TARGETNAMESPACEURI</span></span>|<span data-ttu-id="99a72-261">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-261">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-262">Espace de noms cible d'un schéma XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-262">The target name space of an XML schema.</span></span>|  
|<span data-ttu-id="99a72-263">SCHEMACONTENT</span><span class="sxs-lookup"><span data-stu-id="99a72-263">SCHEMACONTENT</span></span>|<span data-ttu-id="99a72-264">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-264">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-265">Contenu du schéma XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-265">The XML schema content.</span></span>|  
  
 <span data-ttu-id="99a72-266">L'étendue de chaque schéma XML est définie par nom de catalogue, nom de schéma, nom de collection de schémas et par URI (Uniform Resource Identifier) d'espace de noms cible.</span><span class="sxs-lookup"><span data-stu-id="99a72-266">Each XML schema is scoped by catalog name, schema name, schema collection name, and target name space Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="99a72-267">Qui plus est, un nouveau GUID nommé DBSCHEMA_XML_COLLECTIONS est également défini.</span><span class="sxs-lookup"><span data-stu-id="99a72-267">In addition, a new GUID with the name DBSCHEMA_XML_COLLECTIONS is also defined.</span></span> <span data-ttu-id="99a72-268">Le nombre de restrictions et les colonnes restreintes pour l'ensemble de lignes de schéma SS_XMLSCHEMA sont définis comme suit.</span><span class="sxs-lookup"><span data-stu-id="99a72-268">The number of restrictions and restricted columns for the SS_XMLSCHEMA schema rowset are defined as follows.</span></span>  
  
|<span data-ttu-id="99a72-269">GUID</span><span class="sxs-lookup"><span data-stu-id="99a72-269">GUID</span></span>|<span data-ttu-id="99a72-270">Nombre de restrictions</span><span class="sxs-lookup"><span data-stu-id="99a72-270">Number of restrictions</span></span>|<span data-ttu-id="99a72-271">Colonnes restreintes</span><span class="sxs-lookup"><span data-stu-id="99a72-271">Restricted columns</span></span>|  
|----------|----------------------------|------------------------|  
|<span data-ttu-id="99a72-272">DBSCHEMA_XML_COLLECTIONS</span><span class="sxs-lookup"><span data-stu-id="99a72-272">DBSCHEMA_XML_COLLECTIONS</span></span>|<span data-ttu-id="99a72-273">4</span><span class="sxs-lookup"><span data-stu-id="99a72-273">4</span></span>|<span data-ttu-id="99a72-274">SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-274">SCHEMACOLLECTION_CATALOGNAME</span></span><br /><br /> <span data-ttu-id="99a72-275">SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-275">SCHEMACOLLECTION_SCHEMANAME</span></span><br /><br /> <span data-ttu-id="99a72-276">SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-276">SCHEMACOLLECTIONNAME</span></span><br /><br /> <span data-ttu-id="99a72-277">TARGETNAMESPACEURI</span><span class="sxs-lookup"><span data-stu-id="99a72-277">TARGETNAMESPACEURI</span></span>|  
  
### <a name="ole-db-property-set-additions-and-changes"></a><span data-ttu-id="99a72-278">Ajouts et modifications effectués dans le jeu de propriétés OLE DB</span><span class="sxs-lookup"><span data-stu-id="99a72-278">OLE DB Property Set Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="99a72-279">Native Client ajoute de nouvelles valeurs ou des modifications à un grand nombre de jeux de propriétés de OLE DB de base.</span><span class="sxs-lookup"><span data-stu-id="99a72-279">Native Client adds new values or changes to many of the core OLE DB property sets.</span></span>  
  
#### <a name="the-dbpropset_sqlserverparameter-property-set"></a><span data-ttu-id="99a72-280">Jeu de propriétés DBPROPSET_SQLSERVERPARAMETER</span><span class="sxs-lookup"><span data-stu-id="99a72-280">The DBPROPSET_SQLSERVERPARAMETER Property Set</span></span>  
 <span data-ttu-id="99a72-281">Afin de prendre en charge le type de données **XML** via OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implémente le nouveau jeu de propriétés DBPROPSET_SQLSERVERPARAMETER, qui contient les valeurs suivantes.</span><span class="sxs-lookup"><span data-stu-id="99a72-281">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements the new DBPROPSET_SQLSERVERPARAMETER property set, which contains the following values.</span></span>  
  
|<span data-ttu-id="99a72-282">Nom</span><span class="sxs-lookup"><span data-stu-id="99a72-282">Name</span></span>|<span data-ttu-id="99a72-283">Type</span><span class="sxs-lookup"><span data-stu-id="99a72-283">Type</span></span>|<span data-ttu-id="99a72-284">Description</span><span class="sxs-lookup"><span data-stu-id="99a72-284">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="99a72-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-285">SSPROP_PARAM_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="99a72-286">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-286">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-287">Nom d'un catalogue (base de données) dans lequel une collection de schémas XML est définie.</span><span class="sxs-lookup"><span data-stu-id="99a72-287">The name of a catalog (database) in which an XML schema collection is defined.</span></span> <span data-ttu-id="99a72-288">Une des trois parties qui composent l’identificateur de nom SQL.</span><span class="sxs-lookup"><span data-stu-id="99a72-288">A part of the SQL three-part name identifier.</span></span>|  
|<span data-ttu-id="99a72-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-289">SSPROP_PARAM_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="99a72-290">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-290">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-291">Nom d'un schéma XML dans la collection de schémas.</span><span class="sxs-lookup"><span data-stu-id="99a72-291">The name of an XML schema within the schema collection.</span></span> <span data-ttu-id="99a72-292">Une des trois parties qui composent l'identificateur de nom SQL.</span><span class="sxs-lookup"><span data-stu-id="99a72-292">A part of the SQL three -part name identifier.</span></span>|  
|<span data-ttu-id="99a72-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-293">SSPROP_PARAM_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="99a72-294">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-294">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-295">Nom de la collection de schémas XML dans le catalogue. Une des trois parties qui composent l'identificateur de nom SQL.</span><span class="sxs-lookup"><span data-stu-id="99a72-295">The name of the XML schema collection within the catalog A part of the SQL three -part name identifier.</span></span>|  
  
#### <a name="the-dbpropset_sqlservercolumn-property-set"></a><span data-ttu-id="99a72-296">Jeu de propriétés DBPROPSET_SQLSERVERCOLUMN</span><span class="sxs-lookup"><span data-stu-id="99a72-296">The DBPROPSET_SQLSERVERCOLUMN Property Set</span></span>  
 <span data-ttu-id="99a72-297">Pour prendre en charge la création de tables dans l’interface **ITableDefinition** , [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ajoute trois nouvelles colonnes au jeu de propriétés DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="99a72-297">To support the creation of tables in the **ITableDefinition** interface, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client adds three new columns to the DBPROPSET_SQLSERVERCOLUMN property set.</span></span>  
  
|<span data-ttu-id="99a72-298">Nom</span><span class="sxs-lookup"><span data-stu-id="99a72-298">Name</span></span>|<span data-ttu-id="99a72-299">Type</span><span class="sxs-lookup"><span data-stu-id="99a72-299">Type</span></span>|<span data-ttu-id="99a72-300">Description</span><span class="sxs-lookup"><span data-stu-id="99a72-300">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="99a72-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-301">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="99a72-302">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-302">VT_BSTR</span></span>|<span data-ttu-id="99a72-303">Pour les colonnes XML typées, cette propriété est une chaîne qui spécifie le nom du catalogue où le schéma XML est stocké.</span><span class="sxs-lookup"><span data-stu-id="99a72-303">For typed XML columns, this property is a string specifying the name of the catalog where the XML schema is stored.</span></span> <span data-ttu-id="99a72-304">Pour d'autres types de colonnes, cette propriété retourne une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="99a72-304">For other column types this property returns an empty string.</span></span>|  
|<span data-ttu-id="99a72-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-305">SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="99a72-306">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-306">VT_BSTR</span></span>|<span data-ttu-id="99a72-307">Pour les colonnes XML typées, cette propriété est une chaîne qui spécifie le nom de schéma XML qui définit cette colonne.</span><span class="sxs-lookup"><span data-stu-id="99a72-307">For typed XML columns, this property is a string specifying the name of XML schema that defines this column.</span></span>|  
|<span data-ttu-id="99a72-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-308">SSPROP_COL_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="99a72-309">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-309">VT_BSTR</span></span>|<span data-ttu-id="99a72-310">Pour les colonnes XML typées, cette propriété est une chaîne qui spécifie le nom de la collection de schémas XML qui définit la valeur.</span><span class="sxs-lookup"><span data-stu-id="99a72-310">For typed XML columns, this property is a string specifying the name of the schema XML schema collection defining the value.</span></span>|  
  
 <span data-ttu-id="99a72-311">De même que les valeurs SSPROP_PARAM, toutes ces propriétés sont facultatives et sont vides par défaut.</span><span class="sxs-lookup"><span data-stu-id="99a72-311">Like the SSPROP_PARAM values, all of these properties are optional and default to empty.</span></span> <span data-ttu-id="99a72-312">Les valeurs SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME et SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME peuvent être spécifiées uniquement si la valeur SSPROP_COL_XML_SCHEMACOLLECTIONNAME est spécifiée.</span><span class="sxs-lookup"><span data-stu-id="99a72-312">SSPROP_COL_XML_SCHEMACOLLECTION_CATALOGNAME and SSPROP_COL_XML_SCHEMACOLLECTION_SCHEMANAME may only be specified if SSPROP_COL_XML_SCHEMACOLLECTIONNAME is specified.</span></span> <span data-ttu-id="99a72-313">Lorsque vous passez des données XML au serveur, si ces valeurs sont incluses, leur raison d'être (validité) est vérifiée par rapport à la base de données actuelle et les données d'instance sont vérifiées par rapport au schéma.</span><span class="sxs-lookup"><span data-stu-id="99a72-313">When passing XML to the server, if these values are included they are checked for existence (validity) against the current database and the instance data is checked against the schema.</span></span> <span data-ttu-id="99a72-314">Dans tous les cas, pour être valides, elles doivent toutes être vides ou renseignées.</span><span class="sxs-lookup"><span data-stu-id="99a72-314">In all cases, to be valid they are either all empty or all filled in.</span></span>  
  
### <a name="ole-db-interface-additions-and-changes"></a><span data-ttu-id="99a72-315">Ajout et modifications dans l'interface OLE DB</span><span class="sxs-lookup"><span data-stu-id="99a72-315">OLE DB Interface Additions and Changes</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="99a72-316">Native Client ajoute de nouvelles valeurs ou des modifications à la plupart des interfaces de OLE DB principales.</span><span class="sxs-lookup"><span data-stu-id="99a72-316">Native Client adds new values or changes to many of the core OLE DB interfaces.</span></span>  
  
#### <a name="the-isscommandwithparameters-interface"></a><span data-ttu-id="99a72-317">Interface ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="99a72-317">The ISSCommandWithParameters Interface</span></span>  
 <span data-ttu-id="99a72-318">Afin de prendre en charge le type de données **XML** via OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implémente un certain nombre de modifications, notamment l’ajout de l’interface [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) .</span><span class="sxs-lookup"><span data-stu-id="99a72-318">In order to support the **xml** data type through OLE DB, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client implements a number of changes including the addition of the [ISSCommandWithParameters](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md) interface.</span></span> <span data-ttu-id="99a72-319">Cette nouvelle interface hérite de l’interface OLE DB **ICommandWithParameters** principale.</span><span class="sxs-lookup"><span data-stu-id="99a72-319">This new interface inherits from the core OLE DB interface **ICommandWithParameters**.</span></span> <span data-ttu-id="99a72-320">Outre les trois méthodes héritées de **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**et **SetParameterInfo**; **ISSCommandWithParameters** fournit les méthodes [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) et [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) utilisées pour gérer les types de données spécifiques au serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-320">In addition to the three methods inherited from **ICommandWithParameters**; **GetParameterInfo**, **MapParameterNames**, and **SetParameterInfo**; **ISSCommandWithParameters** provides the [GetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-getparameterproperties-ole-db.md) and [SetParameterProperties](../../native-client-ole-db-interfaces/isscommandwithparameters-setparameterproperties-ole-db.md) methods that are used to handle server specific data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="99a72-321">L’interface **ISSCommandWithParameters** exploite également la nouvelle structure SSPARAMPROPS.</span><span class="sxs-lookup"><span data-stu-id="99a72-321">The **ISSCommandWithParameters** interface also makes use of the new SSPARAMPROPS structure.</span></span>  
  
#### <a name="the-icolumnsrowset-interface"></a><span data-ttu-id="99a72-322">Interface IColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="99a72-322">The IColumnsRowset Interface</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="99a72-323">Native Client ajoute les [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] colonnes spécifiques suivantes à l’ensemble de lignes retourné par la méthode **ColumnRowset :: GetColumnsRowset** .</span><span class="sxs-lookup"><span data-stu-id="99a72-323">Native Client adds the following [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]-specific columns to the rowset returned by the **IColumnRowset::GetColumnsRowset** method.</span></span> <span data-ttu-id="99a72-324">Ces colonnes contiennent le nom en trois parties d'une collection de schémas XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-324">These columns contain the three-part name of an XML schema collection.</span></span> <span data-ttu-id="99a72-325">Dans le cas des colonnes non XML ou des colonnes XML non typées, ces trois colonnes possèdent toutes la valeur NULL par défaut.</span><span class="sxs-lookup"><span data-stu-id="99a72-325">For non-XML columns or untyped XML columns, all three columns take the default value of NULL.</span></span>  
  
|<span data-ttu-id="99a72-326">Nom de la colonne</span><span class="sxs-lookup"><span data-stu-id="99a72-326">Column name</span></span>|<span data-ttu-id="99a72-327">Type</span><span class="sxs-lookup"><span data-stu-id="99a72-327">Type</span></span>|<span data-ttu-id="99a72-328">Description</span><span class="sxs-lookup"><span data-stu-id="99a72-328">Description</span></span>|  
|-----------------|----------|-----------------|  
|<span data-ttu-id="99a72-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-329">DBCOLUMN_SS_XML_SCHEMACOLLECTION_CATALOGNAME</span></span>|<span data-ttu-id="99a72-330">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-330">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-331">Catalogue auquel une collection de schémas XML appartient.</span><span class="sxs-lookup"><span data-stu-id="99a72-331">The catalog an XML schema collection belongs to,</span></span><br /><br /> <span data-ttu-id="99a72-332">Possède la valeur NULL sinon.</span><span class="sxs-lookup"><span data-stu-id="99a72-332">NULL otherwise.</span></span>|  
|<span data-ttu-id="99a72-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="99a72-333">DBCOLUMN_SS_XML_SCHEMACOLLECTION_SCHEMANAME</span></span>|<span data-ttu-id="99a72-334">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-334">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-335">Schéma auquel une collection de schémas XML appartient.</span><span class="sxs-lookup"><span data-stu-id="99a72-335">The schema an XML schema collection belongs to.</span></span> <span data-ttu-id="99a72-336">Possède la valeur NULL sinon.</span><span class="sxs-lookup"><span data-stu-id="99a72-336">NULL otherwise.</span></span>|  
|<span data-ttu-id="99a72-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span><span class="sxs-lookup"><span data-stu-id="99a72-337">DBCOLUMN_SS_XML_SCHEMACOLLECTIONNAME</span></span>|<span data-ttu-id="99a72-338">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="99a72-338">DBTYPE_WSTR</span></span>|<span data-ttu-id="99a72-339">Nom d'une collection de schémas XML pour les colonnes XML typées, valeur NULL dans le cas contraire.</span><span class="sxs-lookup"><span data-stu-id="99a72-339">The name of XML schema collection for typed XML column, NULL otherwise.</span></span>|  
  
#### <a name="the-irowset-interface"></a><span data-ttu-id="99a72-340">Interface IRowset</span><span class="sxs-lookup"><span data-stu-id="99a72-340">The IRowset Interface</span></span>  
 <span data-ttu-id="99a72-341">Une instance XML est récupérée d’une colonne XML au moyen de la méthode **IRowset::GetData**.</span><span class="sxs-lookup"><span data-stu-id="99a72-341">An XML instance in an XML column is retrieved through the **IRowset::GetData** method.</span></span> <span data-ttu-id="99a72-342">En fonction de la liaison spécifiée par le client, une instance XML peut être extraite en tant que type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR ou DBTYPE_BYTES, ou bien en tant qu'interface via DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="99a72-342">Depending on the binding specified by the client, an XML instance can be retrieved as DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML, DBTYPE_STR, DBTYPE_BYTES, or as an interface via DBTYPE_IUNKNOWN.</span></span> <span data-ttu-id="99a72-343">Si le consommateur spécifie DBTYPE_BSTR, DBTYPE_WSTR ou DBTYPE_VARIANT, le fournisseur convertit l'instance XML d'après le type demandé par l'utilisateur et le stocke à l'emplacement précisé dans la liaison correspondante.</span><span class="sxs-lookup"><span data-stu-id="99a72-343">If the consumer specifies DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider converts the XML instance to the user requested type and put it into the location specified in the corresponding binding.</span></span>  
  
 <span data-ttu-id="99a72-344">Si le consommateur spécifie DBTYPE_IUNKNOWN et affecte la valeur Null à l’argument *pObject*, ou affecte IID_ISequentialStream à l’argument *pObject*, le fournisseur retourne une interface **ISequentialStream** au consommateur afin que ce dernier puisse extraire les données XML de la colonne.</span><span class="sxs-lookup"><span data-stu-id="99a72-344">If the consumer specifies DBTYPE_IUNKNOWN and sets the *pObject* argument to NULL, or sets the *pObject* argument to IID_ISequentialStream, the provider returns an **ISequentialStream** interface to the consumer so that the consumer can stream the XML data out of the column.</span></span> <span data-ttu-id="99a72-345">**ISequentialStream** retourne ensuite les données XML sous forme de flux de caractères Unicode.</span><span class="sxs-lookup"><span data-stu-id="99a72-345">**ISequentialStream** then returns the XML data as a Unicode character stream.</span></span>  
  
 <span data-ttu-id="99a72-346">Au moment de retourner une valeur XML liée à DBTYPE_IUNKNOWN, le fournisseur signale une valeur de taille `sizeof (IUnknown *)`.</span><span class="sxs-lookup"><span data-stu-id="99a72-346">When returning an XML value bound to DBTYPE_IUNKNOWN, the provider reports a size value of `sizeof (IUnknown *)`.</span></span> <span data-ttu-id="99a72-347">Notez que ceci est cohérent avec l'approche adoptée lorsqu'une colonne est liée en tant que DBTYPE_IUnknown ou DBTYPE_IDISPATCH et par DBTYPE_IUNKNOWN/ISequentialStream lorsque la taille de colonne exacte est impossible à déterminer.</span><span class="sxs-lookup"><span data-stu-id="99a72-347">Note that this is consistent with the approach taken when a column is bound as DBTYPE_IUnknown or DBTYPE_IDISPATCH, and by DBTYPE_IUNKNOWN/ISequentialStream when the exact column size cannot be determined.</span></span>  
  
#### <a name="the-irowsetchange-interface"></a><span data-ttu-id="99a72-348">Interface IRowsetChange</span><span class="sxs-lookup"><span data-stu-id="99a72-348">The IRowsetChange Interface</span></span>  
 <span data-ttu-id="99a72-349">Il existe deux moyens pour un consommateur de mettre à jour une instance XML dans une colonne.</span><span class="sxs-lookup"><span data-stu-id="99a72-349">There are two ways a consumer can update an XML instance in a column.</span></span> <span data-ttu-id="99a72-350">Le premier est de faire appel à l’objet de stockage **ISequentialStream** créé par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="99a72-350">The first one is through the storage object **ISequentialStream** created by the provider.</span></span> <span data-ttu-id="99a72-351">Le consommateur peut appeler la méthode **ISequentialStream::Write** pour mettre à jour directement l’instance XML retournée par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="99a72-351">The consumer can call the **ISequentialStream::Write** method to directly update the XML instance returned by the provider.</span></span>  
  
 <span data-ttu-id="99a72-352">La deuxième approche repose sur la méthode **IRowsetChange::SetData** ou **IRowsetChange::InsertRow**.</span><span class="sxs-lookup"><span data-stu-id="99a72-352">The second approach is through **IRowsetChange::SetData** or **IRowsetChange::InsertRow** methods.</span></span> <span data-ttu-id="99a72-353">Dans ce cas précis, une instance XML issue de la mémoire tampon du consommateur peut être spécifiée dans une liaison de type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML ou DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="99a72-353">In this approach, an XML instance in the consumer's buffer can be specified in a binding of type DBTYPE_BSTR, DBTYPE_WSTR, DBTYPE_VARIANT, DBTYPE_XML or DBTYPE_IUNKNOWN.</span></span>  
  
 <span data-ttu-id="99a72-354">Dans le cas du type DBTYPE_BSTR, DBTYPE_WSTR ou DBTYPE_VARIANT, le fournisseur stocke l'instance XML résidant dans la mémoire tampon du consommateur à l'intérieur de la colonne appropriée.</span><span class="sxs-lookup"><span data-stu-id="99a72-354">In case of DBTYPE_BSTR, DBTYPE_WSTR, or DBTYPE_VARIANT, the provider stores the XML instance residing in the consumer buffer into the proper column.</span></span>  
  
 <span data-ttu-id="99a72-355">Dans le cas de DBTYPE_IUNKNOWN/ISequentialStream, si le consommateur ne spécifie pas d’objet de stockage, le consommateur doit créer un objet **ISequentialStream** à l’avance, lier le document XML à l’objet, puis passer l’objet au fournisseur par le biais de la méthode **IRowsetChange :: SetData** .</span><span class="sxs-lookup"><span data-stu-id="99a72-355">In the case of DBTYPE_IUNKNOWN/ISequentialStream, if the consumer does not specify any storage object, the consumer must create an **ISequentialStream** object in advance, bind the XML document with the object, and then pass the object to the provider through the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="99a72-356">Le consommateur peut également créer un objet de stockage, affecter IID_ISequentialStream à l’argument pObject, créer un objet **ISequentialStream**, puis passer l’objet **ISequentialStream** à la méthode **IRowsetChange::SetData**.</span><span class="sxs-lookup"><span data-stu-id="99a72-356">The consumer can also create a storage object, set the pObject argument to IID_ISequentialStream, create an **ISequentialStream** object and then pass the **ISequentialStream** object to the **IRowsetChange::SetData** method.</span></span> <span data-ttu-id="99a72-357">Dans les deux cas, le fournisseur peut récupérer l’objet XML via l’objet **ISequentialStream** et l’insérer dans une colonne appropriée.</span><span class="sxs-lookup"><span data-stu-id="99a72-357">In both cases, the provider can retrieve the XML object through the **ISequentialStream** object and insert it into a proper column.</span></span>  
  
#### <a name="the-irowsetupdate-interface"></a><span data-ttu-id="99a72-358">Interface IRowsetUpdate</span><span class="sxs-lookup"><span data-stu-id="99a72-358">The IRowsetUpdate Interface</span></span>  
 <span data-ttu-id="99a72-359">L’interface **IRowsetUpdate** fournit les fonctionnalités nécessaires dans le cas de mises à jour différées.</span><span class="sxs-lookup"><span data-stu-id="99a72-359">**IRowsetUpdate** interface provides functionality for delayed updates.</span></span> <span data-ttu-id="99a72-360">Les données mises à disposition pour les ensembles de lignes ne sont pas mises à la disposition d’autres transactions tant que le consommateur n’a pas appelé la méthode **IRowsetUpdate : Update** .</span><span class="sxs-lookup"><span data-stu-id="99a72-360">The data made available to the rowsets is not made available to other transactions until the consumer calls the **IRowsetUpdate:Update** method.</span></span>  
  
#### <a name="the-irowsetfind-interface"></a><span data-ttu-id="99a72-361">Interface IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="99a72-361">The IRowsetFind Interface</span></span>  
 <span data-ttu-id="99a72-362">La méthode **IRowsetFind::FindNextRow** ne fonctionne pas avec le type de données **xml**.</span><span class="sxs-lookup"><span data-stu-id="99a72-362">The **IRowsetFind::FindNextRow** method does not work with the **xml** data type.</span></span> <span data-ttu-id="99a72-363">Quand vous appelez **IRowsetFind::FindNextRow** et que l’argument *hAccessor* spécifie une colonne de type DBTYPE_XML, la valeur DB_E_BADBINDINFO est retournée.</span><span class="sxs-lookup"><span data-stu-id="99a72-363">When **IRowsetFind::FindNextRow** is called and the *hAccessor* argument specifies a column of DBTYPE_XML, DB_E_BADBINDINFO is returned.</span></span> <span data-ttu-id="99a72-364">Cette situation se produit quel que soit le type de colonne recherché.</span><span class="sxs-lookup"><span data-stu-id="99a72-364">This occurs regardless of the type of column that is being searched.</span></span> <span data-ttu-id="99a72-365">Pour tous les autres types de liaisons, la méthode **FindNextRow** échoue avec DB_E_BADCOMPAREOP si la colonne dans laquelle effectuer la recherche affiche le type de données **xml**.</span><span class="sxs-lookup"><span data-stu-id="99a72-365">For any other binding type, the **FindNextRow** fails with DB_E_BADCOMPAREOP if the column to be searched is of the **xml** data type.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="99a72-366">Pilote ODBC SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="99a72-366">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="99a72-367">Dans le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC Native Client, un certain nombre de modifications ont été apportées à différentes fonctions pour prendre en charge le type de données **XML** .</span><span class="sxs-lookup"><span data-stu-id="99a72-367">In the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, a number of changes have been made to various functions to support the **xml** data type.</span></span>  
  
### <a name="sqlcolattribute"></a><span data-ttu-id="99a72-368">SQLColAttribute</span><span class="sxs-lookup"><span data-stu-id="99a72-368">SQLColAttribute</span></span>  
 <span data-ttu-id="99a72-369">La fonction [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) possède trois nouveaux identificateurs de champ, notamment SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME et SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="99a72-369">The [SQLColAttribute](../../native-client-odbc-api/sqlcolattribute.md) function has three new field identifiers, including SQL_CA_SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SQL_CA_SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SQL_CA_SS _XML_SCHEMACOLLECTION_NAME.</span></span>  
  
 <span data-ttu-id="99a72-370">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC native client signale SQL_SS_LENGTH_UNLIMITED pour les colonnes SQL_DESC_DISPLAY_SIZE et SQL_DESC_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="99a72-370">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the SQL_DESC_DISPLAY_SIZE and SQL_DESC_LENGTH columns.</span></span>  
  
### <a name="sqlcolumns"></a><span data-ttu-id="99a72-371">SQLColumns</span><span class="sxs-lookup"><span data-stu-id="99a72-371">SQLColumns</span></span>  
 <span data-ttu-id="99a72-372">La fonction [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) comporte trois nouvelles colonnes, dont SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME et SS_XML_SCHEMACOLLECTION_NAME.</span><span class="sxs-lookup"><span data-stu-id="99a72-372">The [SQLColumns](../../native-client-odbc-api/sqlcolumns.md) function has three new columns including SS_XML_SCHEMACOLLECTION_CATALOG_NAME, SS_XML_SCHEMACOLLECTION_SCHEMA_NAME, and SS_XML_SCHEMACOLLECTION_NAME.</span></span> <span data-ttu-id="99a72-373">La colonne TYPE_NAME existante est utilisée pour indiquer le nom du type XML et la valeur DATA_TYPE d'une colonne ou d'un paramètre de type XML est SQL_SS_XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-373">The existing TYPE_NAME column is used to indicate the name of the XML type, and the DATA_TYPE for a XML type column or parameter is SQL_SS_XML.</span></span>  
  
 <span data-ttu-id="99a72-374">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC native client signale SQL_SS_LENGTH_UNLIMITED pour les valeurs COLUMN_SIZE et CHAR_OCTET_LENGTH.</span><span class="sxs-lookup"><span data-stu-id="99a72-374">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED for the COLUMN_SIZE and CHAR_OCTET_LENGTH values.</span></span>  
  
### <a name="sqldescribecol"></a><span data-ttu-id="99a72-375">SQLDescribeCol</span><span class="sxs-lookup"><span data-stu-id="99a72-375">SQLDescribeCol</span></span>  
 <span data-ttu-id="99a72-376">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC native client signale SQL_SS_LENGTH_UNLIMITED lorsque la taille de la colonne ne peut pas être déterminée dans la fonction [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) .</span><span class="sxs-lookup"><span data-stu-id="99a72-376">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED when the column size cannot be determined in the [SQLDescribeCol](../../native-client-odbc-api/sqldescribecol.md) function.</span></span>  
  
### <a name="sqlgettypeinfo"></a><span data-ttu-id="99a72-377">SQLGetTypeInfo</span><span class="sxs-lookup"><span data-stu-id="99a72-377">SQLGetTypeInfo</span></span>  
 <span data-ttu-id="99a72-378">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC native client signale SQL_SS_LENGTH_UNLIMITED comme COLUMN_SIZE maximal pour le type de données **XML** dans la fonction [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) .</span><span class="sxs-lookup"><span data-stu-id="99a72-378">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type in the [SQLGetTypeInfo](../../native-client-odbc-api/sqlgettypeinfo.md) function.</span></span>  
  
### <a name="sqlprocedurecolumns"></a><span data-ttu-id="99a72-379">SQLProcedureColumns</span><span class="sxs-lookup"><span data-stu-id="99a72-379">SQLProcedureColumns</span></span>  
 <span data-ttu-id="99a72-380">La fonction [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) a les mêmes ajouts de colonnes que la fonction **SQLColumns** .</span><span class="sxs-lookup"><span data-stu-id="99a72-380">The [SQLProcedureColumns](../../native-client-odbc-api/sqlprocedurecolumns.md) function has the same column additions as the **SQLColumns** function.</span></span>  
  
 <span data-ttu-id="99a72-381">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pilote ODBC native client signale SQL_SS_LENGTH_UNLIMITED comme COLUMN_SIZE maximal pour le type de données **XML** .</span><span class="sxs-lookup"><span data-stu-id="99a72-381">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver reports SQL_SS_LENGTH_UNLIMITED as the maximum COLUMN_SIZE for the **xml** data type.</span></span>  
  
### <a name="supported-conversions"></a><span data-ttu-id="99a72-382">Conversions prises en charge</span><span class="sxs-lookup"><span data-stu-id="99a72-382">Supported Conversions</span></span>  
 <span data-ttu-id="99a72-383">Lorsque vous procédez à des conversions entre des types de données SQL vers C, SQL_C_WCHAR, SQL_C_BINARY et SQL_C_CHAR peuvent tous être convertis en SQL_SS_XML avec les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="99a72-383">When converting from SQL to C data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="99a72-384">SQL_C_WCHAR : format UTF-16, absence de marque d'ordre d'octet (BOM), marque de fin null.</span><span class="sxs-lookup"><span data-stu-id="99a72-384">SQL_C_WCHAR: Format is UTF-16, no byte-order mark (BOM), with null termination.</span></span>  
  
-   <span data-ttu-id="99a72-385">SQL_C_BINARY : format UTF-16, absence de marque de fin null.</span><span class="sxs-lookup"><span data-stu-id="99a72-385">SQL_C_BINARY: Format is UTF-16, with no null termination.</span></span> <span data-ttu-id="99a72-386">Une marque d'ordre d'octet (BOM) est ajoutée aux données reçues du serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-386">A BOM is added to data received from the server.</span></span> <span data-ttu-id="99a72-387">Si le serveur retourne une chaîne vide, une marque d'ordre d'octet est quand même retournée à l'application.</span><span class="sxs-lookup"><span data-stu-id="99a72-387">If an empty string is returned by the server a BOM is still returned to the application.</span></span> <span data-ttu-id="99a72-388">Si la longueur de la mémoire tampon est un nombre impair d'octets, les données sont tronquées comme il se doit.</span><span class="sxs-lookup"><span data-stu-id="99a72-388">If the buffer length is an odd number of bytes the data ise truncated correctly.</span></span> <span data-ttu-id="99a72-389">Si la valeur tout entière est retournée en plusieurs segments, vous pouvez les concaténer pour reconstituer la valeur correcte.</span><span class="sxs-lookup"><span data-stu-id="99a72-389">If the whole value is returned in chunks they can be concatenated to re-constitute the correct value</span></span>  
  
-   <span data-ttu-id="99a72-390">SQL_C_CHAR : le format employé est celui de caractères multioctets encodés dans la page de codes du client avec une marque de fin null.</span><span class="sxs-lookup"><span data-stu-id="99a72-390">SQL_C_CHAR: Format is multibyte characters encoded in client code page with null termination.</span></span> <span data-ttu-id="99a72-391">Toute conversion à partir de code UTF-16 sur le serveur risque d'endommager les données. Cette liaison est donc fortement déconseillée.</span><span class="sxs-lookup"><span data-stu-id="99a72-391">Conversion from server supplied UTF-16 may cause data corruption, so this binding is strongly discouraged.</span></span>  
  
 <span data-ttu-id="99a72-392">Lorsque vous procédez à des conversions entre des types de données C vers SQL, SQL_C_WCHAR, SQL_C_BINARY et SQL_C_CHAR peuvent tous être convertis en SQL_SS_XML avec les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="99a72-392">When converting from C to SQL data types, SQL_C_WCHAR, SQL_C_BINARY, and SQL_C_CHAR can all be converted to SQL_SS_XML, with the following stipulations:</span></span>  
  
-   <span data-ttu-id="99a72-393">SQL_C_WCHAR : une marque d'ordre d'octet (BOM) est toujours ajoutée aux données envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-393">SQL_C_WCHAR: A BOM is always be added to data sent to the server.</span></span> <span data-ttu-id="99a72-394">Si les données commencent déjà par une marque d'ordre d'octet, deux marques d'ordre d'octet apparaissent alors au démarrage de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="99a72-394">If the data already started with a BOM, this results in two BOMs at the start of the buffer.</span></span> <span data-ttu-id="99a72-395">Le serveur utilise la première marque d'ordre d'octet pour reconnaître l'encodage en tant qu'encodage UTF-16, puis l'ignore.</span><span class="sxs-lookup"><span data-stu-id="99a72-395">The server uses the first BOM to recognize the encoding as UTF-16 and then discard it.</span></span> <span data-ttu-id="99a72-396">La deuxième marque d'ordre d'octet est interprétée comme un espace insécable de largeur nulle.</span><span class="sxs-lookup"><span data-stu-id="99a72-396">The second BOM is interpreted as a zero-width nonbreaking space character.</span></span>  
  
-   <span data-ttu-id="99a72-397">SQL_C_BINARY : aucune conversion n'a lieu et les données sont transmises au serveur en l'état.</span><span class="sxs-lookup"><span data-stu-id="99a72-397">SQL_C_BINARY: No conversion is performed, and the data is passed to the server "as is."</span></span> <span data-ttu-id="99a72-398">Les données UTF-16 doivent commencer par une marque d'ordre d'octet (BOM) sans quoi l'encodage risque d'être mal reconnu par le serveur.</span><span class="sxs-lookup"><span data-stu-id="99a72-398">UTF-16 data must start with a BOM; if it does not, the encoding may not be correctly recognized by the server.</span></span>  
  
-   <span data-ttu-id="99a72-399">SQL_C_CHAR : les données sont converties en UTF-16 sur le client et envoyées au serveur uniquement en tant que SQL_C_WCHAR (avec ajout d'une marque d'ordre d'octet compris).</span><span class="sxs-lookup"><span data-stu-id="99a72-399">SQL_C_CHAR: The data is converted to UTF-16 on the client and sent to the server just as SQL_C_WCHAR (including the addition of a BOM).</span></span> <span data-ttu-id="99a72-400">Si le contenu XML n'est pas encodé dans la page de codes du client, les données risquent d'être endommagées.</span><span class="sxs-lookup"><span data-stu-id="99a72-400">If the XML is not encoded in the client code page this can cause data corruption.</span></span>  
  
 <span data-ttu-id="99a72-401">Le standard XML exigent que les données XML encodées UTF-16 commencent par une marque d'ordre d'octet (BOM), soit le code de caractère UTF-16 0xFEFF.</span><span class="sxs-lookup"><span data-stu-id="99a72-401">The XML standard requires UTF-16 encoded XML to start with a byte-order mark (BOM), UTF-16 character code 0xFEFF.</span></span> <span data-ttu-id="99a72-402">Lorsque vous utilisez une liaison de SQL_C_BINARY, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client n’exige pas ou n’ajoute pas de marque de nomenclature, car l’encodage est impliqué par la liaison.</span><span class="sxs-lookup"><span data-stu-id="99a72-402">When working with a SQL_C_BINARY binding, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client does not require or add a BOM, as the encoding is implied by the binding.</span></span> <span data-ttu-id="99a72-403">L'objectif recherché est la simplification de l'utilisation d'autres processeurs et systèmes de stockage XML.</span><span class="sxs-lookup"><span data-stu-id="99a72-403">The intent is to provide simplicity in dealing with other XML processors and storage systems.</span></span> <span data-ttu-id="99a72-404">Dans ce cas, une marque d'ordre d'octet doit être présente avec les données XML encodées UTF-16 et l'application n'a pas à se soucier de l'encodage réel puisque la majorité des processeurs XML (y compris [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) détectent l'encodage par inspection des premiers octets de la valeur.</span><span class="sxs-lookup"><span data-stu-id="99a72-404">In this case a BOM should be present with UTF-16 encoded XML, and the application need not be concerned with the actual encoding, because the majority of XML processors (including [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]) deduce the encoding by inspecting the first few bytes of the value.</span></span> <span data-ttu-id="99a72-405">Les données XML reçues de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client à l’aide de SQL_C_BINARY liaisons sont toujours encodées au format UTF-16 avec une marque de nomenclature et sans déclaration d’encodage incorporée.</span><span class="sxs-lookup"><span data-stu-id="99a72-405">XML data received from [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client using SQL_C_BINARY bindings are always encoded in UTF-16 with a BOM and without an embedded encoding declaration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99a72-406">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="99a72-406">See Also</span></span>  
 <span data-ttu-id="99a72-407">[Fonctionnalités de SQL Server Native Client](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="99a72-407">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="99a72-408">ISSCommandWithParameters &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="99a72-408">ISSCommandWithParameters &#40;OLE DB&#41;</span></span>](../../native-client-ole-db-interfaces/isscommandwithparameters-ole-db.md)  
  
  
