---
title: Noms de principal du service (SPN) dans les connexions clientes (ODBC) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: 1d60cb30-4c46-49b2-89ab-701e77a330a2
author: rothja
ms.author: jroth
ms.openlocfilehash: 752cbdbf017fac6d086b9493c23ea7a490ac6ef7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87702863"
---
# <a name="service-principal-names-spns-in-client-connections-odbc"></a><span data-ttu-id="d1208-102">Noms de principaux du service (SPN) dans les connexions clientes (ODBC)</span><span class="sxs-lookup"><span data-stu-id="d1208-102">Service Principal Names (SPNs) in Client Connections (ODBC)</span></span>
  <span data-ttu-id="d1208-103">Cette rubrique décrit les attributs et fonctions ODBC qui prennent en charge les noms de principaux du service (SPN) dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="d1208-103">This topic describes ODBC attributes and functions that support service principal names (SPNs) in client applications.</span></span> <span data-ttu-id="d1208-104">Pour plus d’informations sur les SPN dans les applications clientes, consultez [nom de principal du Service &#40;SPN&#41; prise en charge dans les connexions clientes](../features/service-principal-name-spn-support-in-client-connections.md) et [obtenir une authentification Kerberos mutuelle](../../native-client-odbc-how-to/get-mutual-kerberos-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="d1208-104">For more information about SPNs in client applications, see [Service Principal Name &#40;SPN&#41; Support in Client Connections](../features/service-principal-name-spn-support-in-client-connections.md) and [Get Mutual Kerberos Authentication](../../native-client-odbc-how-to/get-mutual-kerberos-authentication.md).</span></span>  
  
## <a name="connection-string-keywords"></a><span data-ttu-id="d1208-105">Mots clés de chaîne de connexion</span><span class="sxs-lookup"><span data-stu-id="d1208-105">Connection String Keywords</span></span>  
 <span data-ttu-id="d1208-106">Les mots clés de chaîne de connexion suivants permettent aux applications clientes de spécifier un nom principal de service.</span><span class="sxs-lookup"><span data-stu-id="d1208-106">The following connection string keywords enable client applications to specify an SPN.</span></span>  
  
|<span data-ttu-id="d1208-107">Mot clé</span><span class="sxs-lookup"><span data-stu-id="d1208-107">Keyword</span></span>|<span data-ttu-id="d1208-108">Valeur</span><span class="sxs-lookup"><span data-stu-id="d1208-108">Value</span></span>|  
|-------------|-----------|  
|`ServerSPN`|<span data-ttu-id="d1208-109">Nom principal de service (SPN) du serveur.</span><span class="sxs-lookup"><span data-stu-id="d1208-109">The SPN for the server.</span></span> <span data-ttu-id="d1208-110">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le pilote.</span><span class="sxs-lookup"><span data-stu-id="d1208-110">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, driver-generated SPN.</span></span>|  
|`FailoverPartnerSPN`|<span data-ttu-id="d1208-111">Nom principal de service du partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="d1208-111">The SPN for the failover partner.</span></span> <span data-ttu-id="d1208-112">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le pilote.</span><span class="sxs-lookup"><span data-stu-id="d1208-112">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, driver-generated SPN.</span></span>|  
  
## <a name="connection-attributes"></a><span data-ttu-id="d1208-113">Attributs de connexion</span><span class="sxs-lookup"><span data-stu-id="d1208-113">Connection Attributes</span></span>  
 <span data-ttu-id="d1208-114">Les attributs de connexion suivants permettent aux applications clientes de spécifier un nom principal de service et d'interroger la méthode d'authentification.</span><span class="sxs-lookup"><span data-stu-id="d1208-114">The following connection attributes enable client applications to specify an SPN and query for the authentication method.</span></span>  
  
|<span data-ttu-id="d1208-115">Nom</span><span class="sxs-lookup"><span data-stu-id="d1208-115">Name</span></span>|<span data-ttu-id="d1208-116">Type</span><span class="sxs-lookup"><span data-stu-id="d1208-116">Type</span></span>|<span data-ttu-id="d1208-117">Usage</span><span class="sxs-lookup"><span data-stu-id="d1208-117">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="d1208-118">SQL_COPT_SS_SERVER_SPN</span><span class="sxs-lookup"><span data-stu-id="d1208-118">SQL_COPT_SS_SERVER_SPN</span></span><br /><br /> <span data-ttu-id="d1208-119">SQL_COPT_SS_FAILOVER_PARTNER_SPN</span><span class="sxs-lookup"><span data-stu-id="d1208-119">SQL_COPT_SS_FAILOVER_PARTNER_SPN</span></span>|<span data-ttu-id="d1208-120">SQLTCHAR, lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="d1208-120">SQLTCHAR, read/write</span></span>|<span data-ttu-id="d1208-121">Spécifie le nom principal de service du serveur.</span><span class="sxs-lookup"><span data-stu-id="d1208-121">Specifies the SPN for the server.</span></span> <span data-ttu-id="d1208-122">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le pilote.</span><span class="sxs-lookup"><span data-stu-id="d1208-122">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, driver-generated SPN.</span></span><br /><br /> <span data-ttu-id="d1208-123">Cet attribut peut être interrogé uniquement après avoir été défini par programme ou après l'ouverture d'une connexion.</span><span class="sxs-lookup"><span data-stu-id="d1208-123">This attribute can be queried only after it has been set programmatically, or after a connection has been opened.</span></span> <span data-ttu-id="d1208-124">Si une tentative d'interrogation de cet attribut sur une connexion qui n'est pas ouverte est effectuée et que l'attribut n'a pas été défini par programme, SQL_ERROR est retournée et un enregistrement de diagnostic est enregistré avec SQLState 08003 et le message « Connexion non ouverte ».</span><span class="sxs-lookup"><span data-stu-id="d1208-124">If an attempt is made to query this attribute on a connection that is not open and the attribute has not been set programmatically, SQL_ERROR is returned, and a diagnostic record is logged with SQLState 08003 and the message "Connection not open".</span></span><br /><br /> <span data-ttu-id="d1208-125">Si une tentative de définition de cet attribut est effectuée lorsqu'une connexion est ouverte, SQL_ERROR est retournée et un enregistrement de diagnostic est consigné avec SQLState HY011 et le message « Opération actuellement non valide ».</span><span class="sxs-lookup"><span data-stu-id="d1208-125">If an attempt is made to set this attribute when a connection is open, SQL_ERROR is returned, and a diagnostic record is logged with SQLState HY011 and the message "Operation invalid at this time".</span></span>|  
|<span data-ttu-id="d1208-126">SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD</span><span class="sxs-lookup"><span data-stu-id="d1208-126">SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD</span></span>|<span data-ttu-id="d1208-127">SQLTCHAR, lecture seule</span><span class="sxs-lookup"><span data-stu-id="d1208-127">SQLTCHAR, read-only</span></span>|<span data-ttu-id="d1208-128">Retourne la méthode d'authentification utilisée pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="d1208-128">Returns the authentication method used for the connection.</span></span> <span data-ttu-id="d1208-129">La valeur retournée à l'application est la valeur que Windows renvoie à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="d1208-129">The value returned to the application is the value that Windows returns to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="d1208-130">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="d1208-130">Possible values are:</span></span><br /><br /> <span data-ttu-id="d1208-131">-« NTLM », qui est retourné lorsqu’une connexion est ouverte à l’aide de l’authentification NTLM.</span><span class="sxs-lookup"><span data-stu-id="d1208-131">-   "NTLM", which is returned when a connection is opened using NTLM authentication.</span></span><br /><span data-ttu-id="d1208-132">-« Kerberos », qui est retourné lorsqu’une connexion est ouverte à l’aide de l’authentification Kerberos.</span><span class="sxs-lookup"><span data-stu-id="d1208-132">-   "Kerberos", which is returned when a connection is opened using Kerberos authentication.</span></span><br /><br /> <span data-ttu-id="d1208-133">Cet attribut peut être lu uniquement pour une connexion ouverte ayant utilisé l'authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="d1208-133">This attribute can only be read for an open connection that used Windows Authentication.</span></span> <span data-ttu-id="d1208-134">Si une tentative de lecture de cet attribut est effectuée avant qu'une connexion ait été ouverte, SQL_ERROR est retournée et une erreur est enregistrée avec SQLState 08003 et le message « Connexion non ouverte ».</span><span class="sxs-lookup"><span data-stu-id="d1208-134">If an attempt is made to read it before a connection has been opened, SQL_ERROR is returned, and an error is logged with SQLState 08003 and the message "Connection not open".</span></span><br /><br /> <span data-ttu-id="d1208-135">Si cet attribut est interrogé sur une connexion qui n'a pas utilisé l'authentification Windows, SQL_ERROR est retournée, une erreur est enregistrée avec SQLState HY092 et le message « Identificateur d'option/attribut non valide (SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD n'est disponible que pour les connexions approuvées) ».</span><span class="sxs-lookup"><span data-stu-id="d1208-135">If this attribute is queried on a connection that did not use Windows Authentication, SQL_ERROR is returned, and an error is logged with SQLState HY092 and the message "Invalid attribute/option identifier (SQL_COPT_SS_INTEGRATED_AUTHENTICATION_METHOD is only available for Trusted Connections)".</span></span><br /><br /> <span data-ttu-id="d1208-136">Si la méthode d'authentification ne peut pas être déterminée, SQL_ERROR est retournée et une erreur est enregistrée avec SQLState HY000 et le message « Erreur générale »</span><span class="sxs-lookup"><span data-stu-id="d1208-136">If the authentication method cannot be determined, SQL_ERROR is returned, and an error is logged with SQLState HY000 and the message "General error".</span></span>|  
|<span data-ttu-id="d1208-137">SQL_COPT_SS_MUTUALLY_AUTHENTICATED</span><span class="sxs-lookup"><span data-stu-id="d1208-137">SQL_COPT_SS_MUTUALLY_AUTHENTICATED</span></span>|<span data-ttu-id="d1208-138">SQLSMALLINT, lecture seule</span><span class="sxs-lookup"><span data-stu-id="d1208-138">SQLSMALLINT, read-only</span></span>|<span data-ttu-id="d1208-139">Retourne SQL_TRUE si le serveur dans la connexion a été authentifié mutuellement ; sinon, retourne SQL_FALSE.</span><span class="sxs-lookup"><span data-stu-id="d1208-139">Returns SQL_TRUE if the server in the connection was mutually authenticated; otherwise, returns SQL_FALSE.</span></span><br /><br /> <span data-ttu-id="d1208-140">Cet attribut peut être lu uniquement pour une connexion ouverte.</span><span class="sxs-lookup"><span data-stu-id="d1208-140">This attribute can only be read for an open connection.</span></span> <span data-ttu-id="d1208-141">Si une tentative de lecture de cet attribut est effectuée avant qu'une connexion ait été ouverte, SQL_ERROR est retournée et une erreur est enregistrée avec SQLState 08003 et le message « Connexion non ouverte ».</span><span class="sxs-lookup"><span data-stu-id="d1208-141">If an attempt is made to read it before a connection has been opened, SQL_ERROR is returned, and an error is logged with SQLState 08003 and the message "Connection not open".</span></span><br /><br /> <span data-ttu-id="d1208-142">Si cet attribut est interrogé pour une connexion n'ayant pas utilisé l'authentification Windows, SQL_FALSE est retournée.</span><span class="sxs-lookup"><span data-stu-id="d1208-142">If this attribute is queried for a connection that did not use Windows Authentication, SQL_FALSE is returned.</span></span>|  
  
## <a name="odbc-function-support-for-specifying-spns"></a><span data-ttu-id="d1208-143">Prise en charge de fonction ODBC pour la spécification des SPN</span><span class="sxs-lookup"><span data-stu-id="d1208-143">ODBC Function Support for Specifying SPNs</span></span>  
 <span data-ttu-id="d1208-144">Les fonctions ODBC suivantes prennent en charge les applications clientes et les noms principaux de service :</span><span class="sxs-lookup"><span data-stu-id="d1208-144">The following ODBC functions support client applications and SPNs:</span></span>  
  
-   [<span data-ttu-id="d1208-145">SQLBrowseConnect</span><span class="sxs-lookup"><span data-stu-id="d1208-145">SQLBrowseConnect</span></span>](../../native-client-odbc-api/sqlbrowseconnect.md)  
  
-   [<span data-ttu-id="d1208-146">SQLConnect</span><span class="sxs-lookup"><span data-stu-id="d1208-146">SQLConnect</span></span>](../../native-client-odbc-api/sqlconnect.md)  
  
-   [<span data-ttu-id="d1208-147">SQLDriverConnect</span><span class="sxs-lookup"><span data-stu-id="d1208-147">SQLDriverConnect</span></span>](../../native-client-odbc-api/sqldriverconnect.md)  
  
-   [<span data-ttu-id="d1208-148">SQLGetConnectAttr</span><span class="sxs-lookup"><span data-stu-id="d1208-148">SQLGetConnectAttr</span></span>](../../native-client-odbc-api/sqlgetconnectattr.md)  
  
-   [<span data-ttu-id="d1208-149">SQLSetConnectAttr</span><span class="sxs-lookup"><span data-stu-id="d1208-149">SQLSetConnectAttr</span></span>](../../native-client-odbc-api/sqlsetconnectattr.md)  
  
## <a name="see-also"></a><span data-ttu-id="d1208-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d1208-150">See Also</span></span>  
 [<span data-ttu-id="d1208-151">SQL Server Native Client &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="d1208-151">SQL Server Native Client &#40;ODBC&#41;</span></span>](sql-server-native-client-odbc.md)  
  
  
