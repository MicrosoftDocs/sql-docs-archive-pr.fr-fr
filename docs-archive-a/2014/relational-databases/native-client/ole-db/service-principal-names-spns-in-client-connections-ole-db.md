---
title: Noms de principaux du service (SPN) dans les connexions clientes (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
ms.assetid: e212010e-a5b6-4ad1-a3c0-575327d3ffd3
author: rothja
ms.author: jroth
ms.openlocfilehash: cd88b11eb7416be869dce3c9ea166787f88d9ee7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602097"
---
# <a name="service-principal-names-spns-in-client-connections-ole-db"></a><span data-ttu-id="b4b6d-102">Noms de principaux du service (SPN) dans les connexions clientes (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="b4b6d-102">Service Principal Names (SPNs) in Client Connections (OLE DB)</span></span>
  <span data-ttu-id="b4b6d-103">Cette rubrique décrit les propriétés et fonctions membres OLE DB qui prennent en charge les noms de principaux du service (SPN) dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-103">This topic describes OLE DB properties and member functions that support service principal names (SPNs) in client applications.</span></span> <span data-ttu-id="b4b6d-104">Pour plus d’informations sur les SPN dans les applications clientes, voir [Prise en charge des noms de principal du service &#40;SPN&#41; dans les connexions clientes](../features/service-principal-name-spn-support-in-client-connections.md).</span><span class="sxs-lookup"><span data-stu-id="b4b6d-104">For more information about SPNs in client applications, see [Service Principal Name &#40;SPN&#41; Support in Client Connections](../features/service-principal-name-spn-support-in-client-connections.md).</span></span> <span data-ttu-id="b4b6d-105">Pour un exemple, consultez [Authentification Kerberos intégrée &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="b4b6d-105">For a sample, see [Integrated Kerberos Authentication &#40;OLE DB&#41;](../../native-client-ole-db-how-to/integrated-kerberos-authentication-ole-db.md).</span></span>  
  
## <a name="provider-initialization-string-keywords"></a><span data-ttu-id="b4b6d-106">Mots clés de chaîne d'initialisation du fournisseur</span><span class="sxs-lookup"><span data-stu-id="b4b6d-106">Provider Initialization String Keywords</span></span>  
 <span data-ttu-id="b4b6d-107">Les mots clés de chaîne d'initialisation du fournisseur suivants prennent en charge les SPN dans les applications OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-107">The following provider initialization string keywords support SPNs in OLE DB applications.</span></span> <span data-ttu-id="b4b6d-108">Dans le tableau suivant, les valeurs de la colonne de mot clé sont utilisées dans la chaîne du fournisseur de IDBInitialize::Initialize.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-108">In the following table, the values in the keyword column are used for the provider string of IDBInitialize::Initialize.</span></span> <span data-ttu-id="b4b6d-109">Les valeurs de la colonne de description sont utilisées dans les chaînes d’initialisation lors de la connexion avec ADO ou IDataInitialize::GetDataSource.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-109">The values in the description column are used in initialization strings when connecting using ADO or IDataInitialize::GetDataSource.</span></span>  
  
|<span data-ttu-id="b4b6d-110">Mot clé</span><span class="sxs-lookup"><span data-stu-id="b4b6d-110">Keyword</span></span>|<span data-ttu-id="b4b6d-111">Description</span><span class="sxs-lookup"><span data-stu-id="b4b6d-111">Description</span></span>|<span data-ttu-id="b4b6d-112">Valeur</span><span class="sxs-lookup"><span data-stu-id="b4b6d-112">Value</span></span>|  
|-------------|-----------------|-----------|  
|<span data-ttu-id="b4b6d-113">ServerSPN</span><span class="sxs-lookup"><span data-stu-id="b4b6d-113">ServerSPN</span></span>|<span data-ttu-id="b4b6d-114">SPN du serveur</span><span class="sxs-lookup"><span data-stu-id="b4b6d-114">Server SPN</span></span>|<span data-ttu-id="b4b6d-115">Nom principal de service (SPN) du serveur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-115">The SPN for the server.</span></span> <span data-ttu-id="b4b6d-116">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-116">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="b4b6d-117">FailoverPartnerSPN</span><span class="sxs-lookup"><span data-stu-id="b4b6d-117">FailoverPartnerSPN</span></span>|<span data-ttu-id="b4b6d-118">SPN du partenaire de basculement</span><span class="sxs-lookup"><span data-stu-id="b4b6d-118">Failover Partner SPN</span></span>|<span data-ttu-id="b4b6d-119">Nom principal de service du partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-119">The SPN for the failover partner.</span></span> <span data-ttu-id="b4b6d-120">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-120">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-initialization-properties"></a><span data-ttu-id="b4b6d-121">Propriétés d'initialisation de la source de données</span><span class="sxs-lookup"><span data-stu-id="b4b6d-121">Data Source Initialization Properties</span></span>  
 <span data-ttu-id="b4b6d-122">Les propriétés suivantes du jeu de propriétés `DBPROPSET_SQLSERVERDBINIT` permettent aux applications de spécifier des SPN.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-122">The following properties in the `DBPROPSET_SQLSERVERDBINIT` property set allow applications to specify SPNs.</span></span>  
  
|<span data-ttu-id="b4b6d-123">Nom</span><span class="sxs-lookup"><span data-stu-id="b4b6d-123">Name</span></span>|<span data-ttu-id="b4b6d-124">Type</span><span class="sxs-lookup"><span data-stu-id="b4b6d-124">Type</span></span>|<span data-ttu-id="b4b6d-125">Usage</span><span class="sxs-lookup"><span data-stu-id="b4b6d-125">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="b4b6d-126">SSPROP_INIT_SERVERSPN</span><span class="sxs-lookup"><span data-stu-id="b4b6d-126">SSPROP_INIT_SERVERSPN</span></span>|<span data-ttu-id="b4b6d-127">VT_BSTR, lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="b4b6d-127">VT_BSTR, read/write</span></span>|<span data-ttu-id="b4b6d-128">Spécifie le nom principal de service du serveur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-128">Specifies the SPN for the server.</span></span> <span data-ttu-id="b4b6d-129">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-129">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
|<span data-ttu-id="b4b6d-130">SSPROP_INIT_FAILOVERPARTNERSPN</span><span class="sxs-lookup"><span data-stu-id="b4b6d-130">SSPROP_INIT_FAILOVERPARTNERSPN</span></span>|<span data-ttu-id="b4b6d-131">VT_BSTR, lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="b4b6d-131">VT_BSTR, read/write</span></span>|<span data-ttu-id="b4b6d-132">Spécifie le nom principal de service du partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-132">Specifies the SPN for the failover partner.</span></span> <span data-ttu-id="b4b6d-133">La valeur par défaut est une chaîne vide, ce qui force [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client à utiliser le nom principal de service par défaut, généré par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-133">The default value is an empty string, which causes [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to use the default, provider-generated SPN.</span></span>|  
  
## <a name="data-source-properties"></a><span data-ttu-id="b4b6d-134">Propriétés de la source de données</span><span class="sxs-lookup"><span data-stu-id="b4b6d-134">Data Source Properties</span></span>  
 <span data-ttu-id="b4b6d-135">Les propriétés suivantes du jeu de propriétés `DBPROPSET_SQLSERVERDATASOURCEINFO` permettent aux applications d'identifier la méthode d'authentification.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-135">The following properties in the `DBPROPSET_SQLSERVERDATASOURCEINFO` property set allow applications to discover the authentication method.</span></span>  
  
|<span data-ttu-id="b4b6d-136">Nom</span><span class="sxs-lookup"><span data-stu-id="b4b6d-136">Name</span></span>|<span data-ttu-id="b4b6d-137">Type</span><span class="sxs-lookup"><span data-stu-id="b4b6d-137">Type</span></span>|<span data-ttu-id="b4b6d-138">Usage</span><span class="sxs-lookup"><span data-stu-id="b4b6d-138">Usage</span></span>|  
|----------|----------|-----------|  
|<span data-ttu-id="b4b6d-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span><span class="sxs-lookup"><span data-stu-id="b4b6d-139">SSPROP_INTEGRATEDAUTHENTICATIONMETHOD</span></span>|<span data-ttu-id="b4b6d-140">VT_BSTR, lecture seule</span><span class="sxs-lookup"><span data-stu-id="b4b6d-140">VT_BSTR, readonly</span></span>|<span data-ttu-id="b4b6d-141">Retourne la méthode d'authentification utilisée pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-141">Returns the authentication method used for the connection.</span></span> <span data-ttu-id="b4b6d-142">La valeur retournée à l'application est la valeur que Windows renvoie à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-142">The value returned to the application is the value that Windows returns to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client.</span></span> <span data-ttu-id="b4b6d-143">Les valeurs possibles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="b4b6d-143">The following are possible values:</span></span><br /><br /> <span data-ttu-id="b4b6d-144">-« NTLM », qui est retourné lorsqu’une connexion est ouverte à l’aide de l’authentification NTLM.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-144">-   "NTLM", which is returned when a connection is opened using NTLM authentication.</span></span><br /><span data-ttu-id="b4b6d-145">-« Kerberos », qui est retourné lorsqu’une connexion est ouverte à l’aide de l’authentification Kerberos.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-145">-   "Kerberos", which is returned when a connection is opened using Kerberos authentication.</span></span><br /><br /> <span data-ttu-id="b4b6d-146">Si une connexion a été ouverte et si la méthode d'authentification ne peut pas être déterminée, VT_EMPTY est retourné.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-146">If a connection has been opened and the authentication method cannot be determined, VT_EMPTY is returned.</span></span><br /><br /> <span data-ttu-id="b4b6d-147">Cette propriété ne peut être lue que lorsqu'une source de données a été initialisée.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-147">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="b4b6d-148">Si vous essayez de lire la propriété avant qu’une source de données ait été initialisée, IDBProperties::GetProperies retourne DB_S_ERRORSOCCURRED ou DB_E_ERRORSOCCURRED, selon le cas, et DBPROPSTATUS_NOTSUPPORTED est défini dans DBPROPSET_PROPERTIESINERROR pour cette propriété.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-148">If you attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="b4b6d-149">Ce comportement est conforme à la spécification principale OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-149">This behavior is in accordance with the OLE DB core specification.</span></span>|  
|<span data-ttu-id="b4b6d-150">SSPROP_MUTUALLYAUTHENICATED</span><span class="sxs-lookup"><span data-stu-id="b4b6d-150">SSPROP_MUTUALLYAUTHENICATED</span></span>|<span data-ttu-id="b4b6d-151">VT_BOOL, lecture seule</span><span class="sxs-lookup"><span data-stu-id="b4b6d-151">VT_BOOL, readonly</span></span>|<span data-ttu-id="b4b6d-152">Retourne VARIANT_TRUE si les serveurs de la connexion ont été authentifiés mutuellement ; sinon, retourne VARIANT_FALSE.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-152">Returns VARIANT_TRUE if the servers on the connection were mutually authenticated; otherwise, returns VARIANT_FALSE.</span></span><br /><br /> <span data-ttu-id="b4b6d-153">Cette propriété ne peut être lue que lorsqu'une source de données a été initialisée.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-153">This property can only be read when a data source has been initialized.</span></span> <span data-ttu-id="b4b6d-154">Si une tentative de lecture de la propriété est faite avant qu’une source de données ait été initialisée, IDBProperties::GetProperies retourne DB_S_ERRORSOCCURRED ou DB_E_ERRORSOCCURRED, selon le cas, et DBPROPSTATUS_NOTSUPPORTED est défini dans DBPROPSET_PROPERTIESINERROR pour cette propriété.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-154">If there is an attempt to read the property before a data source has been initialized, IDBProperties::GetProperies will return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED, as appropriate, and DBPROPSTATUS_NOTSUPPORTED will be set in DBPROPSET_PROPERTIESINERROR for this property.</span></span> <span data-ttu-id="b4b6d-155">Ce comportement est conforme à la spécification principale d’OLE DB.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-155">This behavior is in accordance with the OLE DB core specification</span></span><br /><br /> <span data-ttu-id="b4b6d-156">Si cet attribut est interrogé pour une connexion n'ayant pas utilisé l'authentification Windows, VARIANT_FALSE est retourné.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-156">If this attribute is queried for a connection that did not use Windows Authentication, VARIANT_FALSE is returned.</span></span>|  
  
## <a name="ole-db-api-support-for-spns"></a><span data-ttu-id="b4b6d-157">Prise en charge des SPN par l'API OLE DB</span><span class="sxs-lookup"><span data-stu-id="b4b6d-157">OLE DB API Support for SPNs</span></span>  
 <span data-ttu-id="b4b6d-158">Le tableau suivant décrit les fonctions membres OLE DB qui prennent en charge les SPN dans les connexions clientes :</span><span class="sxs-lookup"><span data-stu-id="b4b6d-158">The following table describes the OLE DB member functions that support SPNs in client connections:</span></span>  
  
|<span data-ttu-id="b4b6d-159">Fonction membre</span><span class="sxs-lookup"><span data-stu-id="b4b6d-159">Member function</span></span>|<span data-ttu-id="b4b6d-160">Description</span><span class="sxs-lookup"><span data-stu-id="b4b6d-160">Description</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="b4b6d-161">IDataInitialize::GetDataSource</span><span class="sxs-lookup"><span data-stu-id="b4b6d-161">IDataInitialize::GetDataSource</span></span>|<span data-ttu-id="b4b6d-162">*pwszInitializationString* peut contenir les nouveaux mots clés `ServerSPN` et `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="b4b6d-162">*pwszInitializationString* can contain the new keywords `ServerSPN` and `FailoverPartnerSPN`.</span></span>|  
|<span data-ttu-id="b4b6d-163">IDataInitialize::GetInitializationString</span><span class="sxs-lookup"><span data-stu-id="b4b6d-163">IDataInitialize::GetInitializationString</span></span>|<span data-ttu-id="b4b6d-164">Si SSPROP_INIT_SERVERSPN et SSPROP_INIT_FAILOVERPARTNERSPN ont des valeurs autres que celles par défaut, elles sont incluses dans la chaîne d’initialisation via *ppwszInitString* comme valeurs de mot clé pour `ServerSPN` et `FailoverPartnerSPN` .</span><span class="sxs-lookup"><span data-stu-id="b4b6d-164">If SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN have non-default values, they will be included in the initialization string through *ppwszInitString* as keyword values for `ServerSPN` and `FailoverPartnerSPN`.</span></span> <span data-ttu-id="b4b6d-165">Sinon, ces mots clés ne sont pas inclus dans la chaîne d'initialisation.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-165">Otherwise, these keywords will not be included in the initialization string.</span></span>|  
|<span data-ttu-id="b4b6d-166">IDBInitialize::Initialize</span><span class="sxs-lookup"><span data-stu-id="b4b6d-166">IDBInitialize::Initialize</span></span>|<span data-ttu-id="b4b6d-167">Si l'invite est activée en définissant DBPROP_INIT_PROMPT dans les propriétés d'initialisation de la source de données, la boîte de dialogue de connexion OLE DB s'affiche.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-167">If prompting is enabled by setting DBPROP_INIT_PROMPT in the data source initialization properties, the OLE DB Login dialog box will be displayed.</span></span> <span data-ttu-id="b4b6d-168">Celle-ci vous permet d'entrer des SPN à la fois pour le serveur principal et pour le partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-168">This allows SPNs to be entered for both the principal server and its failover partner.</span></span><br /><br /> <span data-ttu-id="b4b6d-169">La chaîne du fournisseur dans DPPROP_INIT_PROVIDERSTRING, si elle est définie, reconnaît les nouveaux mots clés `ServerSPN` et `FailoverPartnerSPN` et utilise leurs valeurs, le cas échéant, pour initialiser SSPROP_INIT_SERVER_SPN et SSPROP_INIT_FAILOVER_PARTNER_SPN.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-169">The provider string in DPPROP_INIT_PROVIDERSTRING, if set, will recognize the new keywords `ServerSPN` and `FailoverPartnerSPN` and use their values, if present, to initialize SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN.</span></span><br /><br /> <span data-ttu-id="b4b6d-170">IDBProperties::SetProperties peut être appelé pour définir les propriétés SSPROP_INIT_SERVER_SPN et SSPROP_INIT_FAILOVER_PARTNER_SPN avant que IDBInitialize::Initialize ne soit appelé.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-170">IDBProperties::SetProperties can be called to set the properties SSPROP_INIT_SERVER_SPN and SSPROP_INIT_FAILOVER_PARTNER_SPN before IDBInitialize::Initialize is called.</span></span> <span data-ttu-id="b4b6d-171">Il s'agit d'une alternative à l'utilisation d'une chaîne de fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-171">This is an alternative to using a provider string.</span></span><br /><br /> <span data-ttu-id="b4b6d-172">Si une propriété est définie à plusieurs emplacements, une valeur définie par programme est prioritaire sur un jeu de valeurs dans la chaîne du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-172">If a property is set in more than one place, a value set programmatically takes precedence over a value set in the provider string.</span></span> <span data-ttu-id="b4b6d-173">Une valeur définie dans une chaîne d'initialisation est prioritaire sur une valeur définie dans la boîte de dialogue de connexion.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-173">A value set in an initialization string takes precedence over a value set in a login dialog box.</span></span><br /><br /> <span data-ttu-id="b4b6d-174">Si le même mot clé apparaît plus d'une fois dans la chaîne du fournisseur, la valeur de la première occurrence est prioritaire.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-174">If the same keyword appears more than once in the provider string, the value from first occurrence takes precedence.</span></span>|  
|<span data-ttu-id="b4b6d-175">IDBProperties::GetProperties</span><span class="sxs-lookup"><span data-stu-id="b4b6d-175">IDBProperties::GetProperties</span></span>|<span data-ttu-id="b4b6d-176">IDBProperties::GetProperties peut être appelé pour obtenir les valeurs des propriétés d’initialisation de la nouvelle source de données (SSPROP_INIT_SERVERSPN et SSPROP_INIT_FAILOVERPARTNERSPN) et des propriétés de la nouvelle source de données (SSPROP_AUTHENTICATIONMETHOD et SSPROP_MUTUALLYAUTHENTICATED).</span><span class="sxs-lookup"><span data-stu-id="b4b6d-176">IDBProperties::GetProperties can be called to get the values of the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, and of the new data source properties SSPROP_AUTHENTICATIONMETHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="b4b6d-177">IDBProperties::GetPropertyInfo</span><span class="sxs-lookup"><span data-stu-id="b4b6d-177">IDBProperties::GetPropertyInfo</span></span>|<span data-ttu-id="b4b6d-178">IdbProperties::GetPropertyInfo inclut les propriétés d’initialisation de la nouvelle source de données (SSPROP_INIT_SERVERSPN et SSPROP_INIT_FAILOVERPARTNERSPN) ou les propriétés de la nouvelle source de données (SSPROP_AUTHENTICATION_METHOD et SSPROP_MUTUALLYAUTHENTICATED).</span><span class="sxs-lookup"><span data-stu-id="b4b6d-178">IdbProperties::GetPropertyInfo will include the new data source initialization properties SSPROP_INIT_SERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN, or the new data source properties SSPROP_AUTHENTICATION_METHOD and SSPROP_MUTUALLYAUTHENTICATED.</span></span>|  
|<span data-ttu-id="b4b6d-179">IDBProperties::SetProperties</span><span class="sxs-lookup"><span data-stu-id="b4b6d-179">IDBProperties::SetProperties</span></span>|<span data-ttu-id="b4b6d-180">IDBProperties::SetProperties peut être appelé pour définir les valeurs des propriétés d’initialisation de la nouvelle source de données (SSPROP_INITSERVERSPN et SSPROP_INIT_FAILOVERPARTNERSPN).</span><span class="sxs-lookup"><span data-stu-id="b4b6d-180">IDBProperties::SetProperties can be called to set the values of the new data source initialization properties SSPROP_INITSERVERSPN and SSPROP_INIT_FAILOVERPARTNERSPN.</span></span><br /><br /> <span data-ttu-id="b4b6d-181">Ces propriétés peuvent être définies à tout moment, mais si la source de données est déjà ouverte, l'erreur suivante est retournée : DB_E_ERRORSOCCURRED, « Une opération OLE DB en plusieurs étapes a généré des erreurs.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-181">These properties can be set at any time, but if the data source is already open, the following error will be returned: DB_E_ERRORSOCCURRED, "Multiple-step OLE DB operation generated errors.</span></span> <span data-ttu-id="b4b6d-182">Vérifiez chaque valeur d'état OLE DB disponible.</span><span class="sxs-lookup"><span data-stu-id="b4b6d-182">Check each OLE DB status value, if available.</span></span> <span data-ttu-id="b4b6d-183">Aucun travail n'a été effectué. »</span><span class="sxs-lookup"><span data-stu-id="b4b6d-183">No work was done."</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b4b6d-184">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b4b6d-184">See Also</span></span>  
 [<span data-ttu-id="b4b6d-185">SQL Server Native Client &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="b4b6d-185">SQL Server Native Client &#40;OLE DB&#41;</span></span>](sql-server-native-client-ole-db.md)  
  
  
