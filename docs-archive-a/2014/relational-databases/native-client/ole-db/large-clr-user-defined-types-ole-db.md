---
title: Types CLR volumineux définis par l'utilisateur (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- large CLR user-defined types [OLE DB]
ms.assetid: 4bf12058-0534-42ca-a5ba-b1c23b24d90f
author: rothja
ms.author: jroth
ms.openlocfilehash: 62384b2be5fda767ba306c0e9321fd27b8239f10
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698070"
---
# <a name="large-clr-user-defined-types-ole-db"></a><span data-ttu-id="0eaa2-102">Types CLR volumineux définis par l'utilisateur (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-102">Large CLR User-Defined Types (OLE DB)</span></span>
  <span data-ttu-id="0eaa2-103">Cette rubrique traite des modifications apportées à OLE DB dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client pour prendre en charge les types définis par l'utilisateur (UDT) du CLR (Common Language Runtime) volumineux.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-103">This topic discusses the changes to OLE DB in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client to support large common language runtime (CLR) user-defined types (UDTs).</span></span>  
  
 <span data-ttu-id="0eaa2-104">Pour plus d’informations sur la prise en charge des UDT volumineux CLR dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, consultez [types CLR volumineux définis par l’utilisateur](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="0eaa2-104">For more information about support for large CLR UDTs in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client, see [Large CLR User-Defined Types](../../clr-integration-database-objects-user-defined-types/clr-user-defined-types.md).</span></span> <span data-ttu-id="0eaa2-105">Pour un exemple, consultez [Utiliser des types CLR volumineux &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span><span class="sxs-lookup"><span data-stu-id="0eaa2-105">For a sample, see [Use Large CLR UDTs &#40;OLE DB&#41;](../../native-client-ole-db-how-to/use-large-clr-udts-ole-db.md).</span></span>  
  
## <a name="data-format"></a><span data-ttu-id="0eaa2-106">Format de données</span><span class="sxs-lookup"><span data-stu-id="0eaa2-106">Data Format</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="0eaa2-107">Native Client utilise ~0 pour représenter la longueur des valeurs qui sont de taille illimitée pour les types d'objets volumineux (LOB).</span><span class="sxs-lookup"><span data-stu-id="0eaa2-107">Native Client uses ~0 to represent the length of values that are of unlimited size for large object (LOB) types.</span></span> <span data-ttu-id="0eaa2-108">~0 représente également la taille des types UDT du CLR supérieurs à 8 000 octets.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-108">~0 also represents the size of CLR UDTs that are larger than 8,000 bytes.</span></span>  
  
 <span data-ttu-id="0eaa2-109">Le tableau suivant montre le mappage des types de données dans les paramètres et les ensembles de lignes :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-109">The following table shows data type mapping in parameters and rowsets:</span></span>  
  
|<span data-ttu-id="0eaa2-110">Type de données SQL Server</span><span class="sxs-lookup"><span data-stu-id="0eaa2-110">SQL Server data type</span></span>|<span data-ttu-id="0eaa2-111">Type de données OLE DB</span><span class="sxs-lookup"><span data-stu-id="0eaa2-111">OLE DB data type</span></span>|<span data-ttu-id="0eaa2-112">Disposition en mémoire</span><span class="sxs-lookup"><span data-stu-id="0eaa2-112">Memory layout</span></span>|<span data-ttu-id="0eaa2-113">Valeur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-113">Value</span></span>|  
|--------------------------|----------------------|-------------------|-----------|  
|<span data-ttu-id="0eaa2-114">UDT CLR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-114">CLR UDT</span></span>|<span data-ttu-id="0eaa2-115">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-115">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-116">BYTE[](tableau d’octets\)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-116">BYTE[](byte array\)</span></span>|<span data-ttu-id="0eaa2-117">132 (oledb.h)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-117">132 (oledb.h)</span></span>|  
  
 <span data-ttu-id="0eaa2-118">Les valeurs UDT sont représentées sous la forme de tableaux d'octets.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-118">UDT values are represented as byte arrays.</span></span> <span data-ttu-id="0eaa2-119">Les conversions en chaînes hexadécimales de même que les conversions depuis des chaînes hexadécimales sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-119">Conversions to and from hex strings are supported.</span></span> <span data-ttu-id="0eaa2-120">Les valeurs littérales sont représentées sous forme de chaînes hexadécimales avec le préfixe « 0x ».</span><span class="sxs-lookup"><span data-stu-id="0eaa2-120">Literal values are represented as hex strings with a prefix of "0x".</span></span> <span data-ttu-id="0eaa2-121">Une chaîne hexadécimale est la représentation textuelle de données binaires en base 16.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-121">A hex string is the textual representation of binary data in base 16.</span></span> <span data-ttu-id="0eaa2-122">Un exemple est une conversion du type serveur `varbinary(10)` en DBTYPE_STR, ce qui se traduit par une représentation hexadécimale de 20 caractères où chaque paire de caractères représente un octet unique.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-122">A example is a conversion from server type `varbinary(10)` to DBTYPE_STR, which results in hexadecimal representation of 20 characters where every pair of characters represents a single byte.</span></span>  
  
## <a name="parameter-properties"></a><span data-ttu-id="0eaa2-123">Propriétés de paramètre</span><span class="sxs-lookup"><span data-stu-id="0eaa2-123">Parameter Properties</span></span>  
 <span data-ttu-id="0eaa2-124">Le jeu de propriétés DBPROPSET_SQLSERVERPARAMETER prend en charge les types UDT via OLE DB.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-124">The DBPROPSET_SQLSERVERPARAMETER property set supports UDTs through OLE DB.</span></span> <span data-ttu-id="0eaa2-125">Pour plus d’informations, consultez [Types CLR définis par l’utilisateur](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="0eaa2-125">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="column-properties"></a><span data-ttu-id="0eaa2-126">Propriétés de colonne</span><span class="sxs-lookup"><span data-stu-id="0eaa2-126">Column Properties</span></span>  
 <span data-ttu-id="0eaa2-127">Le jeu de propriétés DBPROPSET_SQLSERVERCOLUMN prend en charge la création de tables via OLE DB.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-127">The DBPROPSET_SQLSERVERCOLUMN property set supports the creation of tables through OLE DB.</span></span> <span data-ttu-id="0eaa2-128">Pour plus d’informations, consultez [Types CLR définis par l’utilisateur](../features/using-user-defined-types.md).</span><span class="sxs-lookup"><span data-stu-id="0eaa2-128">For more information, see [Using User-Defined Types](../features/using-user-defined-types.md).</span></span>  
  
## <a name="data-type-mapping-in-itabledefinitioncreatetable"></a><span data-ttu-id="0eaa2-129">Mappage des types de données dans ITableDefinition::CreateTable</span><span class="sxs-lookup"><span data-stu-id="0eaa2-129">Data Type Mapping in ITableDefinition::CreateTable</span></span>  
 <span data-ttu-id="0eaa2-130">Les informations suivantes sont utilisées dans les `DBCOLUMNDESC` structures utilisées par ITableDefinition :: CreateTable lorsque des colonnes UDT sont requises :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-130">The following information is used in `DBCOLUMNDESC` structures used by ITableDefinition::CreateTable when UDT columns are required:</span></span>  
  
|<span data-ttu-id="0eaa2-131">Type de données OLE DB (*wType*)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-131">OLE DB data type (*wType*)</span></span>|<span data-ttu-id="0eaa2-132">*pwszTypeName*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-132">*pwszTypeName*</span></span>|<span data-ttu-id="0eaa2-133">Type de données SQL Server</span><span class="sxs-lookup"><span data-stu-id="0eaa2-133">SQL Server data type</span></span>|<span data-ttu-id="0eaa2-134">*rgPropertySets*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-134">*rgPropertySets*</span></span>|  
|----------------------------------|--------------------|--------------------------|----------------------|  
|<span data-ttu-id="0eaa2-135">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-135">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-136">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-136">Ignored</span></span>|<span data-ttu-id="0eaa2-137">UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-137">UDT</span></span>|<span data-ttu-id="0eaa2-138">Doit inclure un jeu de propriétés DBPROPSET_SQLSERVERCOLUMN.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-138">Must include a DBPROPSET_SQLSERVERCOLUMN property set.</span></span>|  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="0eaa2-139">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="0eaa2-139">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="0eaa2-140">Les informations retournées dans la structure DBPARAMINFO via **prgParamInfo** sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-140">Information returned in the DBPARAMINFO structure through **prgParamInfo** is as follows:</span></span>  
  
|<span data-ttu-id="0eaa2-141">Type de paramètre</span><span class="sxs-lookup"><span data-stu-id="0eaa2-141">Parameter type</span></span>|<span data-ttu-id="0eaa2-142">*wType*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-142">*wType*</span></span>|<span data-ttu-id="0eaa2-143">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-143">*ulParamSize*</span></span>|<span data-ttu-id="0eaa2-144">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-144">*bPrecision*</span></span>|<span data-ttu-id="0eaa2-145">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-145">*bScale*</span></span>|<span data-ttu-id="0eaa2-146">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0eaa2-146">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="0eaa2-147">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-147">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-148">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-148">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-149">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="0eaa2-149">"DBTYPE_UDT"</span></span>|<span data-ttu-id="0eaa2-150">*n*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-150">*n*</span></span>|<span data-ttu-id="0eaa2-151">non défini</span><span class="sxs-lookup"><span data-stu-id="0eaa2-151">undefined</span></span>|<span data-ttu-id="0eaa2-152">non défini</span><span class="sxs-lookup"><span data-stu-id="0eaa2-152">undefined</span></span>|<span data-ttu-id="0eaa2-153">clear</span><span class="sxs-lookup"><span data-stu-id="0eaa2-153">clear</span></span>|  
|<span data-ttu-id="0eaa2-154">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-154">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-155">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-155">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-156">"DBTYPE_UDT"</span><span class="sxs-lookup"><span data-stu-id="0eaa2-156">"DBTYPE_UDT"</span></span>|<span data-ttu-id="0eaa2-157">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-157">~0</span></span>|<span data-ttu-id="0eaa2-158">non défini</span><span class="sxs-lookup"><span data-stu-id="0eaa2-158">undefined</span></span>|<span data-ttu-id="0eaa2-159">non défini</span><span class="sxs-lookup"><span data-stu-id="0eaa2-159">undefined</span></span>|<span data-ttu-id="0eaa2-160">set</span><span class="sxs-lookup"><span data-stu-id="0eaa2-160">set</span></span>|  
  
## <a name="icommandwithparameterssetparameterinfo"></a><span data-ttu-id="0eaa2-161">ICommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="0eaa2-161">ICommandWithParameters::SetParameterInfo</span></span>  
 <span data-ttu-id="0eaa2-162">Les informations fournies dans la structure DBPARAMBINDINFO doivent respecter les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-162">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="0eaa2-163">Type de paramètre</span><span class="sxs-lookup"><span data-stu-id="0eaa2-163">Parameter type</span></span>|<span data-ttu-id="0eaa2-164">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-164">*pwszDataSourceType*</span></span>|<span data-ttu-id="0eaa2-165">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-165">*ulParamSize*</span></span>|<span data-ttu-id="0eaa2-166">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-166">*bPrecision*</span></span>|<span data-ttu-id="0eaa2-167">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-167">*bScale*</span></span>|<span data-ttu-id="0eaa2-168">*dwFlags* DBPARAMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0eaa2-168">*dwFlags* DBPARAMFLAGS_ISLONG</span></span>|  
|--------------------|--------------------------|-------------------|------------------|--------------|------------------------------------|  
|<span data-ttu-id="0eaa2-169">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-169">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-170">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-170">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-171">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-171">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-172">*n*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-172">*n*</span></span>|<span data-ttu-id="0eaa2-173">ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-173">ignored</span></span>|<span data-ttu-id="0eaa2-174">ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-174">ignored</span></span>|<span data-ttu-id="0eaa2-175">Doit être défini si le paramètre doit être passé à l'aide de DBTYPE_IUNKNOWN.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-175">Must be set if the parameter is to be passed using DBTYPE_IUNKNOWN.</span></span>|  
|<span data-ttu-id="0eaa2-176">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-176">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-177">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-177">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-178">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-178">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-179">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-179">~0</span></span>|<span data-ttu-id="0eaa2-180">ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-180">ignored</span></span>|<span data-ttu-id="0eaa2-181">ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-181">ignored</span></span>|<span data-ttu-id="0eaa2-182">ignoré</span><span class="sxs-lookup"><span data-stu-id="0eaa2-182">ignored</span></span>|  
  
## <a name="isscommandwithparameters"></a><span data-ttu-id="0eaa2-183">ISSCommandWithParameters</span><span class="sxs-lookup"><span data-stu-id="0eaa2-183">ISSCommandWithParameters</span></span>  
 <span data-ttu-id="0eaa2-184">Les applications utilisent **ISSCommandWithParameters** pour obtenir et définir les propriétés de paramètre définies dans la section Propriétés du paramètre.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-184">Applications use **ISSCommandWithParameters** to get and set the parameter properties defined in the Parameter Properties section.</span></span>  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="0eaa2-185">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="0eaa2-185">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="0eaa2-186">Les colonnes retournées sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-186">Columns returned are as follows:</span></span>  
  
|<span data-ttu-id="0eaa2-187">Type de colonne</span><span class="sxs-lookup"><span data-stu-id="0eaa2-187">Column type</span></span>|<span data-ttu-id="0eaa2-188">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-188">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="0eaa2-189">DBCOLUMN_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-189">DBCOLUMN_COLUMNSIZE</span></span>|<span data-ttu-id="0eaa2-190">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="0eaa2-190">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="0eaa2-191">DBCOLUMN_SCALE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-191">DBCOLUMN_SCALE</span></span>|<span data-ttu-id="0eaa2-192">DBCOLUMN_FLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0eaa2-192">DBCOLUMN_FLAGS_ISLONG</span></span>|<span data-ttu-id="0eaa2-193">DBCOLUMNS_ISSEARCHABLE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-193">DBCOLUMNS_ISSEARCHABLE</span></span>|<span data-ttu-id="0eaa2-194">DBCOLUMN_OCTETLENGTH</span><span class="sxs-lookup"><span data-stu-id="0eaa2-194">DBCOLUMN_OCTETLENGTH</span></span>|  
|-----------------|--------------------|--------------------------|-------------------------|---------------------|-----------------------------|-----------------------------|---------------------------|  
|<span data-ttu-id="0eaa2-195">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-195">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-196">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-196">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-197">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-197">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-198">*n*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-198">*n*</span></span>|<span data-ttu-id="0eaa2-199">NULL</span><span class="sxs-lookup"><span data-stu-id="0eaa2-199">NULL</span></span>|<span data-ttu-id="0eaa2-200">NULL</span><span class="sxs-lookup"><span data-stu-id="0eaa2-200">NULL</span></span>|<span data-ttu-id="0eaa2-201">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0eaa2-201">Clear</span></span>|<span data-ttu-id="0eaa2-202">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-202">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="0eaa2-203">n</span><span class="sxs-lookup"><span data-stu-id="0eaa2-203">n</span></span>|  
|<span data-ttu-id="0eaa2-204">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-204">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-205">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-205">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-206">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-206">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-207">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-207">~0</span></span>|<span data-ttu-id="0eaa2-208">NULL</span><span class="sxs-lookup"><span data-stu-id="0eaa2-208">NULL</span></span>|<span data-ttu-id="0eaa2-209">NULL</span><span class="sxs-lookup"><span data-stu-id="0eaa2-209">NULL</span></span>|<span data-ttu-id="0eaa2-210">Définissez</span><span class="sxs-lookup"><span data-stu-id="0eaa2-210">Set</span></span>|<span data-ttu-id="0eaa2-211">DB_ALL_EXCEPT_LIKE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-211">DB_ALL_EXCEPT_LIKE</span></span>|<span data-ttu-id="0eaa2-212">0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-212">0</span></span>|  
  
 <span data-ttu-id="0eaa2-213">Les colonnes suivantes sont également définies pour les types UDT :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-213">The following columns are also defined for UDTs:</span></span>  
  
|<span data-ttu-id="0eaa2-214">Identificateur de colonne</span><span class="sxs-lookup"><span data-stu-id="0eaa2-214">Column Identifier</span></span>|<span data-ttu-id="0eaa2-215">Type</span><span class="sxs-lookup"><span data-stu-id="0eaa2-215">Type</span></span>|<span data-ttu-id="0eaa2-216">Description</span><span class="sxs-lookup"><span data-stu-id="0eaa2-216">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="0eaa2-217">DBCOLUMN_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-217">DBCOLUMN_UDT_CATALOGNAME</span></span>|<span data-ttu-id="0eaa2-218">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-218">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-219">Pour les colonnes UDT, il s'agit du nom du catalogue où le type UDT est défini.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-219">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="0eaa2-220">DBCOLUMN_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-220">DBCOLUMN_UDT_SCHEMANAME</span></span>|<span data-ttu-id="0eaa2-221">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-221">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-222">Pour les colonnes UDT, il s'agit du nom du schéma où le type UDT est défini.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-222">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="0eaa2-223">DBCOLUMN_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-223">DBCOLUMN_UDT_NAME</span></span>|<span data-ttu-id="0eaa2-224">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-224">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-225">Pour les colonnes UDT, il s'agit du nom en une partie du type UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-225">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="0eaa2-226">DBCOLUMN_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-226">DBCOLUMN_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="0eaa2-227">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-227">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-228">Pour les colonnes UDT, il s’agit du nom de type complet du type UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-228">For UDT columns, the full type name of the UDT.</span></span> <span data-ttu-id="0eaa2-229">Le nom complet du type d'assembly vous permet d'instancier un objet de ce type à l'aide de la méthode Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-229">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="0eaa2-230">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="0eaa2-230">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="0eaa2-231">Les informations retournées dans la structure DBCOLUMNINFO sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-231">The information returned in the DBCOLUMNINFO structure is as follows:</span></span>  
  
|<span data-ttu-id="0eaa2-232">Type de paramètre</span><span class="sxs-lookup"><span data-stu-id="0eaa2-232">Parameter type</span></span>|<span data-ttu-id="0eaa2-233">*wType*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-233">*wType*</span></span>|<span data-ttu-id="0eaa2-234">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-234">*ulColumnSize*</span></span>|<span data-ttu-id="0eaa2-235">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-235">*bPrecision*</span></span>|<span data-ttu-id="0eaa2-236">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-236">*bScale*</span></span>|<span data-ttu-id="0eaa2-237">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-237">*dwFlags*</span></span><br /><br /> <span data-ttu-id="0eaa2-238">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0eaa2-238">DBCOLUMNFLAGS_ISLONG</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------|  
|<span data-ttu-id="0eaa2-239">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-239">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-240">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-240">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-241">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-241">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-242">*n*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-242">*n*</span></span>|<span data-ttu-id="0eaa2-243">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-243">~0</span></span>|<span data-ttu-id="0eaa2-244">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-244">~0</span></span>|<span data-ttu-id="0eaa2-245">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0eaa2-245">Clear</span></span>|  
|<span data-ttu-id="0eaa2-246">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-246">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-247">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-247">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-248">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-248">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-249">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-249">~0</span></span>|<span data-ttu-id="0eaa2-250">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-250">~0</span></span>|<span data-ttu-id="0eaa2-251">~0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-251">~0</span></span>|<span data-ttu-id="0eaa2-252">Définissez</span><span class="sxs-lookup"><span data-stu-id="0eaa2-252">Set</span></span>|  
  
## <a name="columns-rowset-schema-rowsets"></a><span data-ttu-id="0eaa2-253">Ensemble de lignes COLUMNS (ensembles de lignes de schéma)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-253">COLUMNS Rowset (Schema Rowsets)</span></span>  
 <span data-ttu-id="0eaa2-254">Les valeurs de colonnes suivantes sont retournées pour les types UDT :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-254">The following column values are returned for UDT types:</span></span>  
  
|<span data-ttu-id="0eaa2-255">Type de colonne</span><span class="sxs-lookup"><span data-stu-id="0eaa2-255">Column type</span></span>|<span data-ttu-id="0eaa2-256">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-256">DATA_TYPE</span></span>|<span data-ttu-id="0eaa2-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0eaa2-257">COLUMN_FLAGS, DBCOLUMFLAGS_ISLONG</span></span>|<span data-ttu-id="0eaa2-258">CHARACTER_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="0eaa2-258">CHARACTER_OCTET_LENGTH</span></span>|  
|-----------------|----------------|-----------------------------------------|------------------------------|  
|<span data-ttu-id="0eaa2-259">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-259">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-260">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-260">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-261">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-261">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-262">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0eaa2-262">Clear</span></span>|<span data-ttu-id="0eaa2-263">*n*</span><span class="sxs-lookup"><span data-stu-id="0eaa2-263">*n*</span></span>|  
|<span data-ttu-id="0eaa2-264">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-264">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-265">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-265">(length greater than 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-266">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-266">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-267">Définissez</span><span class="sxs-lookup"><span data-stu-id="0eaa2-267">Set</span></span>|<span data-ttu-id="0eaa2-268">0</span><span class="sxs-lookup"><span data-stu-id="0eaa2-268">0</span></span>|  
  
 <span data-ttu-id="0eaa2-269">Les colonnes supplémentaires suivantes sont définies pour les types UDT :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-269">The following additional columns are defined for UDTs:</span></span>  
  
|<span data-ttu-id="0eaa2-270">Identificateur de colonne</span><span class="sxs-lookup"><span data-stu-id="0eaa2-270">Column identifier</span></span>|<span data-ttu-id="0eaa2-271">Type</span><span class="sxs-lookup"><span data-stu-id="0eaa2-271">Type</span></span>|<span data-ttu-id="0eaa2-272">Description</span><span class="sxs-lookup"><span data-stu-id="0eaa2-272">Description</span></span>|  
|-----------------------|----------|-----------------|  
|<span data-ttu-id="0eaa2-273">SS_UDT_CATALOGNAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-273">SS_UDT_CATALOGNAME</span></span>|<span data-ttu-id="0eaa2-274">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-274">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-275">Pour les colonnes UDT, il s'agit du nom du catalogue où le type UDT est défini.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-275">For UDT columns, the name of the catalog where the UDT is defined.</span></span>|  
|<span data-ttu-id="0eaa2-276">SS_UDT_SCHEMANAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-276">SS_UDT_SCHEMANAME</span></span>|<span data-ttu-id="0eaa2-277">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-277">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-278">Pour les colonnes UDT, il s'agit du nom du schéma où le type UDT est défini.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-278">For UDT columns, the name of the schema where the UDT is defined.</span></span>|  
|<span data-ttu-id="0eaa2-279">SS_UDT_NAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-279">SS_UDT_NAME</span></span>|<span data-ttu-id="0eaa2-280">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-280">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-281">Pour les colonnes UDT, il s'agit du nom en une partie du type UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-281">For UDT columns, the single part name of the UDT.</span></span>|  
|<span data-ttu-id="0eaa2-282">SS_ASSEMBLY_TYPENAME</span><span class="sxs-lookup"><span data-stu-id="0eaa2-282">SS_ASSEMBLY_TYPENAME</span></span>|<span data-ttu-id="0eaa2-283">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-283">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-284">Pour les colonnes UDT, il s'agit du nom de type complet du type UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-284">For UDT columns, this is the full type name of the UDT.</span></span> <span data-ttu-id="0eaa2-285">Le nom complet du type d'assembly vous permet d'instancier un objet de ce type à l'aide de la méthode Type.GetType.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-285">The fully-qualified name of the assembly type lets you instantiate an object of that type using Type.GetType method.</span></span>|  
  
 <span data-ttu-id="0eaa2-286">En ce qui concerne l'ensemble de lignes PROCEDURE_PARAMETERS, DATA_TYPE contient les mêmes valeurs que l'ensemble de lignes de schéma COLUMNS et TYPE_NAME contient UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-286">Regarding the PROCEDURE_PARAMETERS rowset, DATA_TYPE contains the same values as the COLUMNS schema rowset and TYPE_NAME contains UDT.</span></span> <span data-ttu-id="0eaa2-287">Les mêmes colonnes supplémentaires sont également définies.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-287">The same additional columns are also defined.</span></span>  
  
 <span data-ttu-id="0eaa2-288">Les types définis par l'utilisateur n'apparaîtront pas dans l'ensemble de lignes de schéma PROVIDER_TYPES.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-288">User-defined types will not appear in the PROVIDER_TYPES schema rowset.</span></span>  
  
## <a name="bindings-and-conversions"></a><span data-ttu-id="0eaa2-289">Liaisons et conversions</span><span class="sxs-lookup"><span data-stu-id="0eaa2-289">Bindings and Conversions</span></span>  
  
|<span data-ttu-id="0eaa2-290">Type de données de liaison</span><span class="sxs-lookup"><span data-stu-id="0eaa2-290">Binding data tpe</span></span>|<span data-ttu-id="0eaa2-291">UDT vers serveur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-291">UDT to server</span></span>|<span data-ttu-id="0eaa2-292">Non-UDT vers serveur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-292">Non-UDT to server</span></span>|<span data-ttu-id="0eaa2-293">UDT à partir du serveur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-293">UDT from server</span></span>|<span data-ttu-id="0eaa2-294">Non-UDT à partir du serveur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-294">Non-UDT from server</span></span>|  
|----------------------|-------------------|------------------------|---------------------|--------------------------|  
|<span data-ttu-id="0eaa2-295">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-295">DBTYPE_UDT</span></span>|<span data-ttu-id="0eaa2-296">Pris en charge (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-296">Supported (5)</span></span>|<span data-ttu-id="0eaa2-297">Erreur (1)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-297">Error (1)</span></span>|<span data-ttu-id="0eaa2-298">Pris en charge (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-298">Supported (5)</span></span>|<span data-ttu-id="0eaa2-299">Erreur (4)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-299">Error (4)</span></span>|  
|<span data-ttu-id="0eaa2-300">DBTYPE_BYTES</span><span class="sxs-lookup"><span data-stu-id="0eaa2-300">DBTYPE_BYTES</span></span>|<span data-ttu-id="0eaa2-301">Pris en charge (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-301">Supported (5)</span></span>|<span data-ttu-id="0eaa2-302">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-302">N/A</span></span>|<span data-ttu-id="0eaa2-303">Pris en charge (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-303">Supported (5)</span></span>|<span data-ttu-id="0eaa2-304">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-304">N/A</span></span>|  
|<span data-ttu-id="0eaa2-305">DBTYPE_WSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-305">DBTYPE_WSTR</span></span>|<span data-ttu-id="0eaa2-306">Pris en charge (2), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-306">Supported (2), (5)</span></span>|<span data-ttu-id="0eaa2-307">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-307">N/A</span></span>|<span data-ttu-id="0eaa2-308">Pris en charge (3), (5), (6)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-308">Supported (3), (5), (6)</span></span>|<span data-ttu-id="0eaa2-309">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-309">N/A</span></span>|  
|<span data-ttu-id="0eaa2-310">DBTYPE_BSTR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-310">DBTYPE_BSTR</span></span>|<span data-ttu-id="0eaa2-311">Pris en charge (2), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-311">Supported (2), (5)</span></span>|<span data-ttu-id="0eaa2-312">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-312">N/A</span></span>|<span data-ttu-id="0eaa2-313">Pris en charge (3), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-313">Supported (3), (5)</span></span>|<span data-ttu-id="0eaa2-314">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-314">N/A</span></span>|  
|<span data-ttu-id="0eaa2-315">DBTYPE_STR</span><span class="sxs-lookup"><span data-stu-id="0eaa2-315">DBTYPE_STR</span></span>|<span data-ttu-id="0eaa2-316">Pris en charge (2), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-316">Supported (2), (5)</span></span>|<span data-ttu-id="0eaa2-317">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-317">N/A</span></span>|<span data-ttu-id="0eaa2-318">Pris en charge (3), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-318">Supported (3), (5)</span></span>|<span data-ttu-id="0eaa2-319">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-319">N/A</span></span>|  
|<span data-ttu-id="0eaa2-320">DBTYPE_IUNKNOWN</span><span class="sxs-lookup"><span data-stu-id="0eaa2-320">DBTYPE_IUNKNOWN</span></span>|<span data-ttu-id="0eaa2-321">Pris en charge (6)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-321">Supported (6)</span></span>|<span data-ttu-id="0eaa2-322">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-322">N/A</span></span>|<span data-ttu-id="0eaa2-323">Pris en charge (6)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-323">Supported (6)</span></span>|<span data-ttu-id="0eaa2-324">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-324">N/A</span></span>|  
|<span data-ttu-id="0eaa2-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-325">DBTYPE_VARIANT (VT_UI1 &#124; VT_ARRAY)</span></span>|<span data-ttu-id="0eaa2-326">Pris en charge (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-326">Supported  (5)</span></span>|<span data-ttu-id="0eaa2-327">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-327">N/A</span></span>|<span data-ttu-id="0eaa2-328">Pris en charge (3), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-328">Supported (3), (5)</span></span>|<span data-ttu-id="0eaa2-329">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-329">N/A</span></span>|  
|<span data-ttu-id="0eaa2-330">DBTYPE_VARIANT (VT_BSTR)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-330">DBTYPE_VARIANT (VT_BSTR)</span></span>|<span data-ttu-id="0eaa2-331">Pris en charge (2), (5)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-331">Supported (2), (5)</span></span>|<span data-ttu-id="0eaa2-332">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-332">N/A</span></span>|<span data-ttu-id="0eaa2-333">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-333">N/A</span></span>|<span data-ttu-id="0eaa2-334">N/A</span><span class="sxs-lookup"><span data-stu-id="0eaa2-334">N/A</span></span>|  
  
### <a name="key-to-symbols"></a><span data-ttu-id="0eaa2-335">Liste des symboles</span><span class="sxs-lookup"><span data-stu-id="0eaa2-335">Key to Symbols</span></span>  
  
|<span data-ttu-id="0eaa2-336">Symbole</span><span class="sxs-lookup"><span data-stu-id="0eaa2-336">Symbol</span></span>|<span data-ttu-id="0eaa2-337">Signification</span><span class="sxs-lookup"><span data-stu-id="0eaa2-337">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="0eaa2-338">1</span><span class="sxs-lookup"><span data-stu-id="0eaa2-338">1</span></span>|<span data-ttu-id="0eaa2-339">Si un type serveur autre que DBTYPE_UDT est spécifié avec **ICommandWithParameters::SetParameterInfo** et que le type d’accesseur est DBTYPE_UDT, une erreur se produit quand l’instruction est exécutée.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-339">If a server type other than DBTYPE_UDT is specified with **ICommandWithParameters::SetParameterInfo** and the accessor type is DBTYPE_UDT, an error occurs when the statement is executed.</span></span>  <span data-ttu-id="0eaa2-340">L'erreur sera DB_E_ERRORSOCCURRED et l'état du paramètre sera DBSTATUS_E_BADACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-340">The error will be DB_E_ERRORSOCCURRED and the parameter status will be DBSTATUS_E_BADACCESSOR.</span></span><br /><br /> <span data-ttu-id="0eaa2-341">Le fait de spécifier un paramètre de type UDT pour un paramètre serveur qui n'est pas un type UDT constitue une erreur.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-341">It is an error to specify a parameter of type UDT for a server parameter that is not a UDT.</span></span>|  
|<span data-ttu-id="0eaa2-342">2</span><span class="sxs-lookup"><span data-stu-id="0eaa2-342">2</span></span>|<span data-ttu-id="0eaa2-343">Les données sont converties d'une chaîne hexadécimale en données binaires.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-343">Data is converted from hex string to binary data.</span></span>|  
|<span data-ttu-id="0eaa2-344">3</span><span class="sxs-lookup"><span data-stu-id="0eaa2-344">3</span></span>|<span data-ttu-id="0eaa2-345">Les données sont converties données binaires en chaîne hexadécimale.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-345">Data is converted from binary data to hex string.</span></span>|  
|<span data-ttu-id="0eaa2-346">4</span><span class="sxs-lookup"><span data-stu-id="0eaa2-346">4</span></span>|<span data-ttu-id="0eaa2-347">La validation peut se produire lors de l’utilisation de **CreateAccessor** ou de **GetNextRows**.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-347">Validation can happen when using **CreateAccessor** or **GetNextRows**.</span></span> <span data-ttu-id="0eaa2-348">L'erreur est DB_E_ERRORSOCCURRED.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-348">The error is DB_E_ERRORSOCCURRED.</span></span> <span data-ttu-id="0eaa2-349">L'état de liaison a la valeur DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-349">Binding status is set to DBBINDSTATUS_UNSUPPORTEDCONVERSION.</span></span>|  
|<span data-ttu-id="0eaa2-350">5</span><span class="sxs-lookup"><span data-stu-id="0eaa2-350">5</span></span>|<span data-ttu-id="0eaa2-351">BY_REF peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-351">BY_REF may be used.</span></span>|  
|<span data-ttu-id="0eaa2-352">6</span><span class="sxs-lookup"><span data-stu-id="0eaa2-352">6</span></span>|<span data-ttu-id="0eaa2-353">Les paramètres UDT peuvent être liés en tant que DBTYPE_IUNKNOWN dans le DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-353">UDT parameters can be bound as DBTYPE_IUNKNOWN in the DBBINDING.</span></span> <span data-ttu-id="0eaa2-354">La liaison à DBTYPE_IUNKNOWN indique que l’application veut traiter les données en tant que flux avec l’interface ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-354">Binding to DBTYPE_IUNKNOWN indicates that the application wants to process the data as a stream using the ISequentialStream interface.</span></span> <span data-ttu-id="0eaa2-355">Lorsqu’un consommateur spécifie *wType* dans une liaison en tant que type DBTYPE_IUNKNOWN, et que la colonne ou le paramètre de sortie correspondant de la procédure stockée est un type défini par l’utilisateur (UDT), SQL Server Native Client retourne ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-355">When a consumer specifies *wType* in a binding as type DBTYPE_IUNKNOWN, and the corresponding column or output parameter of the stored procedure is a UDT, SQL Server Native Client will return ISequentialStream.</span></span> <span data-ttu-id="0eaa2-356">Pour un paramètre d’entrée, SQL Server Native Client interroge le pour l’interface ISequentialStream.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-356">For an input parameter, SQL Server Native Client will query for the for the ISequentialStream interface.</span></span><br /><br /> <span data-ttu-id="0eaa2-357">Vous pouvez choisir de ne pas lier la longueur de données UDT à l'aide de la liaison DBTYPE_IUNKNOWN en cas types UDT volumineux.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-357">You can choose to not bind the length of UDT data while using DBTYPE_IUNKNOWN binding, in the case of large UDTs.</span></span> <span data-ttu-id="0eaa2-358">Toutefois, la longueur doit être liée pour de petits types UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-358">However, the length must be bound for small UDTs.</span></span> <span data-ttu-id="0eaa2-359">Un paramètre DBTYPE_UDT peut être spécifié en tant que type UDT volumineux si une ou plusieurs des conditions suivantes sont réunies :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-359">A DBTYPE_UDT parameter can be specified as a large UDT if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="0eaa2-360">-   *ulParamParamSize* est ~ 0.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-360">-   *ulParamParamSize* is ~0.</span></span><br /><span data-ttu-id="0eaa2-361">-DBPARAMFLAGS_ISLONG est défini dans la structure DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-361">-   DBPARAMFLAGS_ISLONG is set in the DBPARAMBINDINFO struct.</span></span><br /><br /> <span data-ttu-id="0eaa2-362">Pour les données de ligne, la liaison DBTYPE_IUNKNOWN est uniquement autorisée pour les types UDT volumineux.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-362">For row data, DBTYPE_IUNKNOWN binding is only allowed for large UDTs.</span></span> <span data-ttu-id="0eaa2-363">Vous pouvez déterminer si une colonne est un type UDT volumineux à l’aide de la méthode IColumnsInfo::GetColumnInfo sur l’interface IColumnsInfo d’un ensemble de lignes ou d’un objet de commande.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-363">You can find out whether a column is a large UDT type by using the IColumnsInfo::GetColumnInfo method on a Rowset or Command object's IColumnsInfo interface.</span></span> <span data-ttu-id="0eaa2-364">Une colonne DBTYPE_UDT est une colonne UDT volumineuse si une ou plusieurs des conditions suivantes sont réunies :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-364">A DBTYPE_UDT column is a large UDT column if one or more of the following is true:</span></span><br /><br /> <span data-ttu-id="0eaa2-365">-DBCOLUMNFLAGS_ISLONG indicateur est défini sur le membre *dwFlags* de la structure DBCOLUMNINFO</span><span class="sxs-lookup"><span data-stu-id="0eaa2-365">-   DBCOLUMNFLAGS_ISLONG flag is set on *dwFlags* member of DBCOLUMNINFO structure</span></span><br /><span data-ttu-id="0eaa2-366">-   le membre *ulColumnSize* de DBCOLUMNINFO est ~ 0.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-366">-   *ulColumnSize* member of DBCOLUMNINFO is ~0.</span></span>|  
  
 <span data-ttu-id="0eaa2-367">DBTYPE_NULL et DBTYPE_EMPTY peuvent être liés pour des paramètres d'entrée, mais pas pour des résultats ou des paramètres de sortie.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-367">DBTYPE_NULL and DBTYPE_EMPTY can be bound for input parameters, but not for output parameters or results.</span></span> <span data-ttu-id="0eaa2-368">S'ils sont liés pour des paramètres d'entrée, l'état doit avoir la valeur DBSTATUS_S_ISNULL pour DBTYPE_NULL ou DBSTATUS_S_DEFAULT pour DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-368">When bound for input parameters, the status must be set to DBSTATUS_S_ISNULL for DBTYPE_NULL or DBSTATUS_S_DEFAULT for DBTYPE_EMPTY.</span></span> <span data-ttu-id="0eaa2-369">DBTYPE_BYREF ne peut pas être utilisé avec DBTYPE_NULL ou DBTYPE_EMPTY.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-369">DBTYPE_BYREF cannot be used with DBTYPE_NULL or DBTYPE_EMPTY.</span></span>  
  
 <span data-ttu-id="0eaa2-370">DBTYPE_UDT peut également être converti en DBTYPE_EMPTY et en DBTYPE_NULL.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-370">DBTYPE_UDT can also be converted to DBTYPE_EMPTY and DBTYPE_NULL.</span></span> <span data-ttu-id="0eaa2-371">Toutefois, DBTYPE_NULL et DBTYPE_EMPTY ne peuvent pas être convertis en DBTYPE_UDT,</span><span class="sxs-lookup"><span data-stu-id="0eaa2-371">However, DBTYPE_NULL and DBTYPE_EMPTY cannot be converted to DBTYPE_UDT.</span></span> <span data-ttu-id="0eaa2-372">ce qui est cohérent avec DBTYPE_BYTES.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-372">This is consistent with DBTYPE_BYTES.</span></span> <span data-ttu-id="0eaa2-373">**ISSCommandWithParameters** est utilisé pour traiter les types UDT en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-373">**ISSCommandWithParameters** is used to process UDTs as parameters.</span></span>  
  
 <span data-ttu-id="0eaa2-374">Les conversions de données fournies par les services principaux d’OLE DB (**IDataConvert**) ne s’appliquent pas à DBTYPE_UDT.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-374">Data conversions supplied by OLE DB core services (**IDataConvert**) are not applicable to DBTYPE_UDT.</span></span>  
  
 <span data-ttu-id="0eaa2-375">Aucune autre liaison n'est prise en charge.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-375">No other bindings are supported.</span></span>  
  
## <a name="comparability-for-irowsetfind"></a><span data-ttu-id="0eaa2-376">Comparabilité pour IRowsetFind</span><span class="sxs-lookup"><span data-stu-id="0eaa2-376">Comparability for IRowsetFind</span></span>  
 <span data-ttu-id="0eaa2-377">Pour les types UDT, seules les comparaisons suivantes sont prises en charge :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-377">For UDT types, only the following comparisons are supported:</span></span>  
  
-   <span data-ttu-id="0eaa2-378">EQ</span><span class="sxs-lookup"><span data-stu-id="0eaa2-378">EQ</span></span>  
  
-   <span data-ttu-id="0eaa2-379">NE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-379">NE</span></span>  
  
-   <span data-ttu-id="0eaa2-380">IGNORE</span><span class="sxs-lookup"><span data-stu-id="0eaa2-380">IGNORE</span></span>  
  
 <span data-ttu-id="0eaa2-381">Si une autre comparaison est tentée, DB_E_BADCOMPAREOP est retourné.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-381">If any other comparison is attempted DB_E_BADCOMPAREOP is returned.</span></span>  
  
## <a name="bcp-support-for-udts"></a><span data-ttu-id="0eaa2-382">Prise en charge des UDT par BCP</span><span class="sxs-lookup"><span data-stu-id="0eaa2-382">BCP Support for UDTs</span></span>  
 <span data-ttu-id="0eaa2-383">Les valeurs UDT peuvent être uniquement importées et exportées en tant que valeurs de caractère ou valeurs binaires.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-383">UDT values can be imported and exported only as character or binary values.</span></span>  
  
## <a name="down-level-client-behavior-for-udts"></a><span data-ttu-id="0eaa2-384">Comportement client de bas niveau pour les types UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-384">Down-level Client Behavior for UDTs</span></span>  
 <span data-ttu-id="0eaa2-385">Les UDT sont mappés aux clients de niveau inférieur de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="0eaa2-385">UDTs are subject to type mapping with down-level clients, as follows:</span></span>  
  
|<span data-ttu-id="0eaa2-386">Version du client</span><span class="sxs-lookup"><span data-stu-id="0eaa2-386">Client version</span></span>|<span data-ttu-id="0eaa2-387">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-387">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-388">(longueur inférieure ou égale à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-388">(length less than or equal to 8,000 bytes)</span></span>|<span data-ttu-id="0eaa2-389">DBTYPE_UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-389">DBTYPE_UDT</span></span><br /><br /> <span data-ttu-id="0eaa2-390">(longueur supérieure à 8 000 octets)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-390">(length greater than 8,000 bytes)</span></span>|  
|--------------------|------------------------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="0eaa2-391">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="0eaa2-391">SQL Server 2005</span></span>|<span data-ttu-id="0eaa2-392">UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-392">UDT</span></span>|<span data-ttu-id="0eaa2-393">varbinary(max)</span><span class="sxs-lookup"><span data-stu-id="0eaa2-393">varbinary(max)</span></span>|  
|<span data-ttu-id="0eaa2-394">SQL Server 2008 et ultérieur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-394">SQL Server 2008 and later</span></span>|<span data-ttu-id="0eaa2-395">UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-395">UDT</span></span>|<span data-ttu-id="0eaa2-396">UDT</span><span class="sxs-lookup"><span data-stu-id="0eaa2-396">UDT</span></span>|  
  
 <span data-ttu-id="0eaa2-397">Lorsque `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) a la valeur 80, les types UDT volumineux apparaissent aux clients de la même façon que pour les clients de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="0eaa2-397">When `DataTypeCompatibility` (SSPROP_INIT_DATATYPECOMPATIBILITY) is set to "80", large UDT types appear to clients in the same way that they appear for down-level clients.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0eaa2-398">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0eaa2-398">See Also</span></span>  
 [<span data-ttu-id="0eaa2-399">Types CLR volumineux définis par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="0eaa2-399">Large CLR User-Defined Types</span></span>](../features/large-clr-user-defined-types.md)  
  
  
