---
title: Appel d’une procédure stockée (OLE DB) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- calling stored procedures
- RPC escape sequence
- OLE DB, stored procedures
- parameters [SQL Server Native Client], OLE DB
- ODBC CALL escape sequence
- stored procedures [OLE DB], calling
- SQL Server Native Client OLE DB provider, stored procedures
ms.assetid: 8e5738e5-4bbe-4f34-bd69-0c0633290bdd
author: rothja
ms.author: jroth
ms.openlocfilehash: 695848c8633d310f5e8ee21e9e738749d1550e4a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706372"
---
# <a name="calling-a-stored-procedure-ole-db"></a><span data-ttu-id="2b62c-102">Appel d'une procédure stockée (OLE DB)</span><span class="sxs-lookup"><span data-stu-id="2b62c-102">Calling a Stored Procedure (OLE DB)</span></span>
  <span data-ttu-id="2b62c-103">Une procédure stockée peut avoir entre zéro et plusieurs paramètres.</span><span class="sxs-lookup"><span data-stu-id="2b62c-103">A stored procedure can have zero or more parameters.</span></span> <span data-ttu-id="2b62c-104">Elle peut également retourner une valeur.</span><span class="sxs-lookup"><span data-stu-id="2b62c-104">It can also return a value.</span></span> <span data-ttu-id="2b62c-105">Lorsque vous utilisez le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client, les paramètres d’une procédure stockée peuvent être passés par :</span><span class="sxs-lookup"><span data-stu-id="2b62c-105">When using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider, parameters to a stored procedure can be passed by:</span></span>  
  
-   <span data-ttu-id="2b62c-106">via un codage effectué de manière irréversible de la valeur de données ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-106">Hard-coding the data value.</span></span>  
  
-   <span data-ttu-id="2b62c-107">via un marqueur de paramètre (?) pour spécifier les paramètres, lier une variable de programme au marqueur de paramètre, puis placer la valeur de données dans la variable de programme.</span><span class="sxs-lookup"><span data-stu-id="2b62c-107">Using a parameter marker (?) to specify parameters, bind a program variable to the parameter marker, and then place the data value in the program variable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2b62c-108">Lors de l’appel des procédures stockées [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] à l’aide de paramètres nommés avec OLE DB, les noms de paramètres doivent commencer par le caractère « \@ ».</span><span class="sxs-lookup"><span data-stu-id="2b62c-108">When calling [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] stored procedures using named parameters with OLE DB, the parameter names must start with the '\@' character.</span></span> <span data-ttu-id="2b62c-109">Il s'agit d'une restriction spécifique à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2b62c-109">This is a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] specific restriction.</span></span> <span data-ttu-id="2b62c-110">Le fournisseur OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client applique cette restriction plus strictement que MDAC.</span><span class="sxs-lookup"><span data-stu-id="2b62c-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider enforces this restriction more strictly than MDAC.</span></span>  
  
 <span data-ttu-id="2b62c-111">Pour prendre en charge les paramètres, l’interface **ICommandWithParameters** est exposée sur l’objet de commande.</span><span class="sxs-lookup"><span data-stu-id="2b62c-111">To support parameters, the **ICommandWithParameters** interface is exposed on the command object.</span></span> <span data-ttu-id="2b62c-112">Pour utiliser les paramètres, le consommateur les décrit au préalable au fournisseur en appelant la méthode **ICommandWithParameters::SetParameterInfo** (ou prépare éventuellement une instruction qui appelle la méthode **GetParameterInfo**).</span><span class="sxs-lookup"><span data-stu-id="2b62c-112">To use parameters, the consumer first describes the parameters to the provider by calling the **ICommandWithParameters::SetParameterInfo** method (or optionally prepares a calling statement that calls the **GetParameterInfo** method).</span></span> <span data-ttu-id="2b62c-113">Le consommateur crée ensuite un accesseur qui spécifie la structure d'une mémoire tampon dans laquelle il place des valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="2b62c-113">The consumer then creates an accessor that specifies the structure of a buffer and places parameter values in this buffer.</span></span> <span data-ttu-id="2b62c-114">Enfin, il passe le handle de l’accesseur et un pointeur vers la mémoire tampon à **Execute**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-114">Finally, it passes the handle of the accessor and a pointer to the buffer to **Execute**.</span></span> <span data-ttu-id="2b62c-115">Lors des appels ultérieurs à **Execute**, le consommateur place de nouvelles valeurs de paramètre en mémoire tampon et appelle **Execute** avec le handle d’accesseur et le pointeur de la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="2b62c-115">On later calls to **Execute**, the consumer places new parameter values in the buffer and calls **Execute** with the accessor handle and buffer pointer.</span></span>  
  
 <span data-ttu-id="2b62c-116">Une commande qui appelle une procédure stockée temporaire à l’aide de paramètres doit appeler au préalable **ICommandWithParameters::SetParameterInfo** pour définir les informations de paramètre, de sorte que la commande puisse être préparée avec succès.</span><span class="sxs-lookup"><span data-stu-id="2b62c-116">A command that calls a temporary stored procedure using parameters must first call **ICommandWithParameters::SetParameterInfo** to define the parameter information, before the command can be successfully prepared.</span></span> <span data-ttu-id="2b62c-117">En effet, le nom interne d'une procédure stockée temporaire diffère du nom externe utilisé par un client ; par ailleurs, SQLOLEDB ne peut pas interroger les tables système afin de déterminer les informations de paramètre pour une procédure stockée temporaire.</span><span class="sxs-lookup"><span data-stu-id="2b62c-117">This is because the internal name for a temporary stored procedure differs from the external name used by a client and SQLOLEDB cannot query the system tables to determine the parameter information for a temporary stored procedure.</span></span>  
  
 <span data-ttu-id="2b62c-118">Voici les étapes du processus de liaison des paramètres :</span><span class="sxs-lookup"><span data-stu-id="2b62c-118">These are the steps in the parameter binding process:</span></span>  
  
1.  <span data-ttu-id="2b62c-119">Indiquez les informations de paramètre dans un tableau de structures DBPARAMBINDINFO, notamment le nom du paramètre, le nom spécifique au fournisseur pour le type de données du paramètre ou un nom de type de données standard, etc.</span><span class="sxs-lookup"><span data-stu-id="2b62c-119">Fill in the parameter information in an array of DBPARAMBINDINFO structures; that is, parameter name, provider-specific name for the data type of the parameter or a standard data type name, and so on.</span></span> <span data-ttu-id="2b62c-120">Chaque structure du tableau décrit un paramètre.</span><span class="sxs-lookup"><span data-stu-id="2b62c-120">Each structure in the array describes one parameter.</span></span> <span data-ttu-id="2b62c-121">Ce tableau est ensuite passé à la méthode **SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-121">This array is then passed to the **SetParameterInfo** method.</span></span>  
  
2.  <span data-ttu-id="2b62c-122">Appelez la méthode **ICommandWithParameters::SetParameterInfo** pour décrire les paramètres au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b62c-122">Call the **ICommandWithParameters::SetParameterInfo** method to describe parameters to the provider.</span></span> <span data-ttu-id="2b62c-123">**SetParameterInfo** spécifie le type de données natif de chaque paramètre.</span><span class="sxs-lookup"><span data-stu-id="2b62c-123">**SetParameterInfo** specifies the native data type of each parameter.</span></span> <span data-ttu-id="2b62c-124">Les arguments de **SetParameterInfo** sont :</span><span class="sxs-lookup"><span data-stu-id="2b62c-124">**SetParameterInfo** arguments are:</span></span>  
  
    -   <span data-ttu-id="2b62c-125">le nombre de paramètres pour lesquels définir des informations de type ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-125">The number of parameters for which to set type information.</span></span>  
  
    -   <span data-ttu-id="2b62c-126">un tableau d'ordinaux de paramètres pour lesquels définir des informations de type ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-126">An array of parameter ordinals for which to set type information.</span></span>  
  
    -   <span data-ttu-id="2b62c-127">un tableau de structures DBPARAMBINDINFO.</span><span class="sxs-lookup"><span data-stu-id="2b62c-127">An array of DBPARAMBINDINFO structures.</span></span>  
  
3.  <span data-ttu-id="2b62c-128">Créez un accesseur de paramètre en utilisant la commande **IAccessor::CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-128">Create a parameter accessor by using the **IAccessor::CreateAccessor** command.</span></span> <span data-ttu-id="2b62c-129">L'accesseur spécifie la structure d'une mémoire tampon dans laquelle il place les valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="2b62c-129">The accessor specifies the structure of a buffer and places parameter values in the buffer.</span></span> <span data-ttu-id="2b62c-130">La commande **CreateAccessor** crée un accesseur à partir d’un jeu de liaisons.</span><span class="sxs-lookup"><span data-stu-id="2b62c-130">The **CreateAccessor** command creates an accessor from a set of bindings.</span></span> <span data-ttu-id="2b62c-131">Ces liaisons sont décrites par le consommateur via un tableau de structures DBBINDING.</span><span class="sxs-lookup"><span data-stu-id="2b62c-131">These bindings are described by the consumer by using an array of DBBINDING structures.</span></span> <span data-ttu-id="2b62c-132">Chaque liaison associe un paramètre unique à la mémoire tampon du consommateur et contient les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="2b62c-132">Each binding associates a single parameter to the buffer of the consumer and contains information such as:</span></span>  
  
    -   <span data-ttu-id="2b62c-133">ordinal du paramètre auquel la liaison s'applique ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-133">The ordinal of the parameter to which the binding applies.</span></span>  
  
    -   <span data-ttu-id="2b62c-134">élément lié (valeur de données, longueur et état) ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-134">What is bound (the data value, its length, and its status).</span></span>  
  
    -   <span data-ttu-id="2b62c-135">offset en mémoire tampon pour chacun de ces composants ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-135">The offset in the buffer to each of these parts.</span></span>  
  
    -   <span data-ttu-id="2b62c-136">longueur et type de la valeur de données dans la mémoire tampon du consommateur.</span><span class="sxs-lookup"><span data-stu-id="2b62c-136">The length and type of the data value as it exists in the buffer of the consumer.</span></span>  
  
     <span data-ttu-id="2b62c-137">Un accesseur est identifié par son handle, qui est de type HACCESSOR.</span><span class="sxs-lookup"><span data-stu-id="2b62c-137">An accessor is identified by its handle, which is of type HACCESSOR.</span></span> <span data-ttu-id="2b62c-138">Ce handle est retourné par la méthode **CreateAccessor**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-138">This handle is returned by the **CreateAccessor** method.</span></span> <span data-ttu-id="2b62c-139">Chaque fois que le consommateur finit d’utiliser un accesseur, il doit appeler la méthode **ReleaseAccessor** pour libérer la mémoire détenue.</span><span class="sxs-lookup"><span data-stu-id="2b62c-139">Whenever the consumer finishes using an accessor, the consumer must call the **ReleaseAccessor** method to release the memory it holds.</span></span>  
  
     <span data-ttu-id="2b62c-140">Quand le consommateur appelle une méthode, par exemple **ICommand::Execute**, il passe lui-même le handle à un accesseur et un pointeur vers une mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="2b62c-140">When the consumer calls a method, such as **ICommand::Execute**, it passes the handle to an accessor and a pointer to a buffer itself.</span></span> <span data-ttu-id="2b62c-141">Le fournisseur utilise cet accesseur pour déterminer comment transférer les données contenues en mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="2b62c-141">The provider uses this accessor to determine how to transfer the data contained in the buffer.</span></span>  
  
4.  <span data-ttu-id="2b62c-142">Remplissez la structure DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="2b62c-142">Fill in the DBPARAMS structure.</span></span> <span data-ttu-id="2b62c-143">Les variables de consommateur à partir desquelles les valeurs de paramètre d’entrée sont récupérées et dans lesquelles les valeurs de paramètre de sortie sont écrites sont passées au moment de l’exécution à **ICommand::Execute** dans la structure DBPARAMS.</span><span class="sxs-lookup"><span data-stu-id="2b62c-143">The consumer variables from which input parameter values are taken and to which output parameter values are written are passed at run time to **ICommand::Execute** in the DBPARAMS structure.</span></span> <span data-ttu-id="2b62c-144">La structure DBPARAMS inclut trois éléments :</span><span class="sxs-lookup"><span data-stu-id="2b62c-144">The DBPARAMS structure includes three elements:</span></span>  
  
    -   <span data-ttu-id="2b62c-145">un pointeur vers la mémoire tampon à partir de laquelle le fournisseur récupère les données de paramètre d'entrée et dans laquelle il retourne les données de paramètre de sortie, en fonction des liaisons spécifiées par le handle d'accesseur ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-145">A pointer to the buffer from which the provider retrieves input parameter data and to which the provider returns output parameter data, according to the bindings specified by the accessor handle.</span></span>  
  
    -   <span data-ttu-id="2b62c-146">le nombre de jeux de paramètres en mémoire tampon ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-146">The number of sets of parameters in the buffer.</span></span>  
  
    -   <span data-ttu-id="2b62c-147">le handle d'accesseur créé à l'étape 3.</span><span class="sxs-lookup"><span data-stu-id="2b62c-147">The accessor handle created in Step 3.</span></span>  
  
5.  <span data-ttu-id="2b62c-148">Exécutez la commande en utilisant **ICommand::Execute**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-148">Execute the command by using **ICommand::Execute**.</span></span>  
  
## <a name="methods-of-calling-a-stored-procedure"></a><span data-ttu-id="2b62c-149">Méthodes d'appel d'une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="2b62c-149">Methods of Calling a Stored Procedure</span></span>  
 <span data-ttu-id="2b62c-150">Lors de l’exécution d’une procédure stockée dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client prend en charge les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="2b62c-150">When executing a stored procedure in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports the:</span></span>  
  
-   <span data-ttu-id="2b62c-151">séquence d'échappement ODBC CALL ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-151">ODBC CALL escape sequence.</span></span>  
  
-   <span data-ttu-id="2b62c-152">séquence d'échappement d'appel de procédure distante (RPC, Remote Procedure Call) ;</span><span class="sxs-lookup"><span data-stu-id="2b62c-152">Remote procedure call (RPC) escape sequence.</span></span>  
  
-   <span data-ttu-id="2b62c-153">instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] EXECUTE.</span><span class="sxs-lookup"><span data-stu-id="2b62c-153">[!INCLUDE[tsql](../../../includes/tsql-md.md)] EXECUTE statement.</span></span>  
  
### <a name="odbc-call-escape-sequence"></a><span data-ttu-id="2b62c-154">Séquence d'échappement ODBC CALL</span><span class="sxs-lookup"><span data-stu-id="2b62c-154">ODBC CALL Escape Sequence</span></span>  
 <span data-ttu-id="2b62c-155">Si vous connaissez les informations de paramètre, appelez la méthode **ICommandWithParameters::SetParameterInfo** pour décrire les paramètres au fournisseur.</span><span class="sxs-lookup"><span data-stu-id="2b62c-155">If you know parameter information, call **ICommandWithParameters::SetParameterInfo** method to describe the parameters to the provider.</span></span> <span data-ttu-id="2b62c-156">Sinon, lorsque la syntaxe ODBC CALL est utilisée pour appeler une procédure stockée, le fournisseur appelle une fonction d'assistance afin de rechercher les informations de paramètre de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="2b62c-156">Otherwise, when the ODBC CALL syntax is used in calling a stored procedure, the provider calls a helper function to find the stored procedure parameter information.</span></span>  
  
 <span data-ttu-id="2b62c-157">Si vous n'êtes pas sûr des informations de paramètre (métadonnées de paramètre), la syntaxe ODBC CALL est recommandée.</span><span class="sxs-lookup"><span data-stu-id="2b62c-157">If you are not sure about the parameter information (parameter metadata), ODBC CALL syntax is recommended.</span></span>  
  
 <span data-ttu-id="2b62c-158">La syntaxe générale pour l'appel d'une procédure à l'aide de la séquence d'échappement ODBC CALL est :</span><span class="sxs-lookup"><span data-stu-id="2b62c-158">The general syntax for calling a procedure by using the ODBC CALL escape sequence is:</span></span>  
  
 <span data-ttu-id="2b62c-159">{[**? =**]**appel**_PROCEDURE_NAME_[**(**[*paramètre*] [**,**[*paramètre*]]... **)**]}</span><span class="sxs-lookup"><span data-stu-id="2b62c-159">{[**?=**]**call**_procedure_name_[**(**[*parameter*][**,**[*parameter*]]...**)**]}</span></span>  
  
 <span data-ttu-id="2b62c-160">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2b62c-160">For example:</span></span>  
  
```  
{call SalesByCategory('Produce', '1995')}  
```  
  
### <a name="rpc-escape-sequence"></a><span data-ttu-id="2b62c-161">Séquence d'échappement RPC</span><span class="sxs-lookup"><span data-stu-id="2b62c-161">RPC Escape Sequence</span></span>  
 <span data-ttu-id="2b62c-162">La séquence d'échappement d'appel de procédure distante (RPC, Remote Procedure Call) est semblable à la syntaxe ODBC CALL de l'appel d'une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="2b62c-162">The RPC escape sequence is similar to the ODBC CALL syntax of calling a stored procedure.</span></span> <span data-ttu-id="2b62c-163">Si vous devez appeler la procédure plusieurs fois, la séquence d'échappement RPC offre les meilleures performances parmi les trois méthodes d'appel d'une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="2b62c-163">If you will call the procedure multiple times, the RPC escape sequence provides most optimal performance among the three methods of calling a stored procedure.</span></span>  
  
 <span data-ttu-id="2b62c-164">Lorsque la séquence d'échappement RPC est utilisée pour exécuter une procédure stockée, le fournisseur n'appelle pas de fonction d'assistance pour déterminer les informations de paramètre (comme il le fait dans le cas de la syntaxe ODBC CALL).</span><span class="sxs-lookup"><span data-stu-id="2b62c-164">When the RPC escape sequence is used to execute a stored procedure, the provider does not call any helper function to determine the parameter information (as it does in the case of ODBC CALL syntax).</span></span> <span data-ttu-id="2b62c-165">La syntaxe RPC est plus simple que la syntaxe ODBC CALL ; par conséquent, la commande est analysée plus rapidement, ce qui améliore les performances.</span><span class="sxs-lookup"><span data-stu-id="2b62c-165">The RPC syntax is simpler than the ODBC CALL syntax, so the command is parsed faster, improving performance.</span></span> <span data-ttu-id="2b62c-166">Dans ce cas, vous devez fournir les informations de paramètre en exécutant **ICommandWithParameters::SetParameterInfo**.</span><span class="sxs-lookup"><span data-stu-id="2b62c-166">In this case, you need to provide the parameter information by executing **ICommandWithParameters::SetParameterInfo**.</span></span>  
  
 <span data-ttu-id="2b62c-167">La séquence d'échappement RPC nécessite que vous disposiez d'une valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="2b62c-167">The RPC escape sequence requires you to have a return value.</span></span> <span data-ttu-id="2b62c-168">Si la procédure stockée ne retourne pas de valeur, le serveur retourne 0 par défaut.</span><span class="sxs-lookup"><span data-stu-id="2b62c-168">If the stored procedure does not return a value, the server returns a 0 by default.</span></span> <span data-ttu-id="2b62c-169">De plus, vous ne pouvez pas ouvrir de curseur [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] sur la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="2b62c-169">In addition, you cannot open a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] cursor on the stored procedure.</span></span> <span data-ttu-id="2b62c-170">La procédure stockée est préparée implicitement et l’appel à **ICommandPrepare::Prepare** échoue.</span><span class="sxs-lookup"><span data-stu-id="2b62c-170">The stored procedure is prepared implicitly and the call to **ICommandPrepare::Prepare** will fail.</span></span> <span data-ttu-id="2b62c-171">En raison de l'incapacité de préparer un appel RPC, vous ne pouvez pas interroger les métadonnées des colonnes ; IColumnsInfo::GetColumnInfo et IColumnsRowset::GetColumnsRowset retourneront DB_E_NOTPREPARED.</span><span class="sxs-lookup"><span data-stu-id="2b62c-171">Because of the inability to prepare an RPC call, you can not query column metadata; IColumnsInfo::GetColumnInfo and IColumnsRowset::GetColumnsRowset will return DB_E_NOTPREPARED.</span></span>  
  
 <span data-ttu-id="2b62c-172">Si vous connaissez toutes les métadonnées de paramètre, la séquence d'échappement RPC est la méthode recommandée pour exécuter les procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="2b62c-172">If you know all the parameter metadata, RPC escape sequence is the recommended way to execute stored procedures.</span></span>  
  
 <span data-ttu-id="2b62c-173">Voici un exemple de séquence d'échappement RPC pour l'appel d'une procédure stockée :</span><span class="sxs-lookup"><span data-stu-id="2b62c-173">This is an example of RPC escape sequence for calling a stored procedure:</span></span>  
  
```  
{rpc SalesByCategory}  
```  
  
 <span data-ttu-id="2b62c-174">Pour obtenir un exemple d’application qui illustre une séquence d’échappement RPC, consultez [Exécuter une procédure stockée (avec la syntaxe RPC) et traiter les codes de retour et les paramètres de sortie &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span><span class="sxs-lookup"><span data-stu-id="2b62c-174">For a sample application that demonstrates an RPC escape sequence, see [Execute a Stored Procedure &#40;Using RPC Syntax&#41; and Process Return Codes and Output Parameters &#40;OLE DB&#41;](../../native-client-ole-db-how-to/results/execute-stored-procedure-with-rpc-and-process-output.md).</span></span>  
  
### <a name="transact-sql-execute-statement"></a><span data-ttu-id="2b62c-175">Instruction Transact-SQL EXECUTE</span><span class="sxs-lookup"><span data-stu-id="2b62c-175">Transact-SQL EXECUTE Statement</span></span>  
 <span data-ttu-id="2b62c-176">La séquence d’échappement ODBC CALL et la séquence d’échappement RPC sont les méthodes recommandées pour l’appel d’une procédure stockée, plutôt que l’instruction [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="2b62c-176">The ODBC CALL escape sequence and the RPC escape sequence are the preferred methods for calling a stored procedure rather than the [EXECUTE](/sql/t-sql/language-elements/execute-transact-sql) statement.</span></span> <span data-ttu-id="2b62c-177">Le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client utilise le mécanisme RPC de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour optimiser le traitement des commandes.</span><span class="sxs-lookup"><span data-stu-id="2b62c-177">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the RPC mechanism of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to optimize command processing.</span></span> <span data-ttu-id="2b62c-178">Ce protocole RPC augmente les performances en supprimant une bonne partie du traitement des paramètres et de l'analyse des instructions sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="2b62c-178">This RPC protocol increases performance by eliminating much of the parameter processing and statement parsing done on the server.</span></span>  
  
 <span data-ttu-id="2b62c-179">Voici un exemple d’instruction [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** :</span><span class="sxs-lookup"><span data-stu-id="2b62c-179">This is an example of the [!INCLUDE[tsql](../../../includes/tsql-md.md)] **EXECUTE** statement:</span></span>  
  
```  
EXECUTE SalesByCategory 'Produce', '1995'  
```  
  
## <a name="see-also"></a><span data-ttu-id="2b62c-180">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2b62c-180">See Also</span></span>  
 [<span data-ttu-id="2b62c-181">Procédures stockées</span><span class="sxs-lookup"><span data-stu-id="2b62c-181">Stored Procedures</span></span>](stored-procedures.md)  
  
  
