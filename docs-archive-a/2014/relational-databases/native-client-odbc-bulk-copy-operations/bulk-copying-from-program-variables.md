---
title: Copie en bloc à partir de variables de programme | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [ODBC], program variables
- bcp_bind function
- mapping data types [ODBC]
- SQL Server Native Client ODBC driver, bulk copy
- data types [ODBC], bulk copying
- ODBC, bulk copy operations
- program variables [ODBC]
ms.assetid: e4284a1b-7534-4b34-8488-b8d05ed67b8c
author: rothja
ms.author: jroth
ms.openlocfilehash: 5a50e8e104d63c63138a1ae14e27104181e6d9fd
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87614582"
---
# <a name="bulk-copying-from-program-variables"></a><span data-ttu-id="f76c7-102">Copie en bloc à partir de variables de programme</span><span class="sxs-lookup"><span data-stu-id="f76c7-102">Bulk Copying from Program Variables</span></span>
  <span data-ttu-id="f76c7-103">Vous pouvez effectuer une copie en bloc directement à partir de variables de programme.</span><span class="sxs-lookup"><span data-stu-id="f76c7-103">You can bulk copy directly from program variables.</span></span> <span data-ttu-id="f76c7-104">Après avoir alloué des variables pour stocker les données d’une ligne et appelant [bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md) pour démarrer la copie en bloc, appelez [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) pour chaque colonne afin de spécifier l’emplacement et le format de la variable de programme à associer à la colonne.</span><span class="sxs-lookup"><span data-stu-id="f76c7-104">After allocating variables to hold the data for a row and calling [bcp_init](../native-client-odbc-extensions-bulk-copy-functions/bcp-init.md) to start the bulk copy, call [bcp_bind](../native-client-odbc-extensions-bulk-copy-functions/bcp-bind.md) for each column to specify the location and format of the program variable to be associated with the column.</span></span> <span data-ttu-id="f76c7-105">Remplissez chaque variable avec des données, puis appelez [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) pour envoyer une ligne de données au serveur.</span><span class="sxs-lookup"><span data-stu-id="f76c7-105">Fill each variable with data, then call [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) to send one row of data to the server.</span></span> <span data-ttu-id="f76c7-106">Répétez le processus de remplissage des variables et en appelant **bcp_sendrow** jusqu’à ce que toutes les lignes aient été envoyées au serveur, puis appelez [bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md) pour spécifier que l’opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="f76c7-106">Repeat the process of filling the variables and calling **bcp_sendrow** until all the rows have been sent to the server, then call [bcp_done](../native-client-odbc-extensions-bulk-copy-functions/bcp-done.md) to specify that the operation is complete.</span></span>  
  
 <span data-ttu-id="f76c7-107">Le paramètre **bcp_bind**_pData_ contient l’adresse de la variable liée à la colonne.</span><span class="sxs-lookup"><span data-stu-id="f76c7-107">The **bcp_bind**_pData_ parameter contains the address of the variable being bound to the column.</span></span> <span data-ttu-id="f76c7-108">Les données de chaque colonne peuvent être stockées de l'une des deux manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="f76c7-108">The data for each column can be stored in one of two ways:</span></span>  
  
-   <span data-ttu-id="f76c7-109">Allocation d'une variable destinée à contenir les données.</span><span class="sxs-lookup"><span data-stu-id="f76c7-109">Allocate one variable to hold the data.</span></span>  
  
-   <span data-ttu-id="f76c7-110">Allocation d'une variable indicateur suivie immédiatement de la variable de données.</span><span class="sxs-lookup"><span data-stu-id="f76c7-110">Allocate an indicator variable followed immediately by the data variable.</span></span>  
  
 <span data-ttu-id="f76c7-111">La variable indicateur indique la longueur des données des colonnes de longueur variable et indique des valeurs NULL si la colonne autorise ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="f76c7-111">The indicator variable indicates the length of the data for variable-length columns, and also indicates NULL values if the column allows NULLs.</span></span> <span data-ttu-id="f76c7-112">Si seule une variable de données est utilisée, l’adresse de cette variable est stockée dans le paramètre **bcp_bind**_pData_ .</span><span class="sxs-lookup"><span data-stu-id="f76c7-112">If only a data variable is used, then the address of this variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="f76c7-113">Si une variable indicateur est utilisée, l’adresse de la variable indicateur est stockée dans le paramètre **bcp_bind**_pData_ .</span><span class="sxs-lookup"><span data-stu-id="f76c7-113">If an indicator variable is used, the address of the indicator variable is stored in the **bcp_bind**_pData_ parameter.</span></span> <span data-ttu-id="f76c7-114">Les fonctions de copie en bloc calculent l’emplacement de la variable de données en ajoutant les paramètres **bcp_bind**_cbIndicator_ et *pData* .</span><span class="sxs-lookup"><span data-stu-id="f76c7-114">The bulk copy functions calculate the location of the data variable by adding the **bcp_bind**_cbIndicator_ and *pData* parameters.</span></span>  
  
 <span data-ttu-id="f76c7-115">**bcp_bind** prend en charge trois méthodes de gestion des données de longueur variable :</span><span class="sxs-lookup"><span data-stu-id="f76c7-115">**bcp_bind** supports three methods for dealing with variable-length data:</span></span>  
  
-   <span data-ttu-id="f76c7-116">Utilisez *cbData* avec uniquement une variable de données.</span><span class="sxs-lookup"><span data-stu-id="f76c7-116">Use *cbData* with only a data variable.</span></span> <span data-ttu-id="f76c7-117">Placez la longueur des données dans *cbData*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-117">Place the length of the data in *cbData*.</span></span> <span data-ttu-id="f76c7-118">Chaque fois que la longueur des données à copier en bloc change, appelez [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)pour réinitialiser *cbData*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-118">Each time the length of the data to be bulk copied changes, call [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md)to reset *cbData*.</span></span> <span data-ttu-id="f76c7-119">Si l’une des deux autres méthodes est utilisée, spécifiez SQL_VARLEN_DATA pour *cbData*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-119">If one of the other two methods is being used, specify SQL_VARLEN_DATA for *cbData*.</span></span> <span data-ttu-id="f76c7-120">Si toutes les valeurs de données fournies pour une colonne sont NULL, spécifiez SQL_NULL_DATA pour *cbData*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-120">If all the data values being supplied for a column are NULL, specify SQL_NULL_DATA for *cbData*.</span></span>  
  
-   <span data-ttu-id="f76c7-121">Utilisation de variables indicateur.</span><span class="sxs-lookup"><span data-stu-id="f76c7-121">Use indicator variables.</span></span> <span data-ttu-id="f76c7-122">Dès qu'une nouvelle valeur de données est déplacée dans la variable de données, stockez la longueur de la valeur dans la variable indicateur.</span><span class="sxs-lookup"><span data-stu-id="f76c7-122">As each new data value is moved into the data variable, store the length of the value in the indicator variable.</span></span> <span data-ttu-id="f76c7-123">Si l’une des deux autres méthodes est utilisée, spécifiez 0 pour *cbIndicator*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-123">If one of the other two methods is being used, specify 0 for *cbIndicator*.</span></span>  
  
-   <span data-ttu-id="f76c7-124">Utilisation de pointeurs de terminateur.</span><span class="sxs-lookup"><span data-stu-id="f76c7-124">Use terminator pointers.</span></span> <span data-ttu-id="f76c7-125">Chargez le paramètre **bcp_bind**_pterm_ avec l’adresse du modèle binaire qui termine les données.</span><span class="sxs-lookup"><span data-stu-id="f76c7-125">Load the **bcp_bind**_pTerm_ parameter with the address of the bit pattern that terminates the data.</span></span> <span data-ttu-id="f76c7-126">Si l’une des deux autres méthodes est utilisée, spécifiez NULL pour *pterm*.</span><span class="sxs-lookup"><span data-stu-id="f76c7-126">If one of the other two methods is being used, specify NULL for *pTerm*.</span></span>  
  
 <span data-ttu-id="f76c7-127">Ces trois méthodes peuvent être utilisées sur le même appel de **bcp_bind** , auquel cas la spécification qui produit la plus petite quantité de données copiée est utilisée.</span><span class="sxs-lookup"><span data-stu-id="f76c7-127">All three of these methods can be used on the same **bcp_bind** call, in which case the specification that results in the smallest amount of data being copied is used.</span></span>  
  
 <span data-ttu-id="f76c7-128">Le paramètre de_type_ **bcp_bind**utilise des identificateurs de type de données DB-Library, et non des identificateurs de type de données ODBC.</span><span class="sxs-lookup"><span data-stu-id="f76c7-128">The **bcp_bind**_type_ parameter uses DB-Library data type identifiers, not ODBC data type identifiers.</span></span> <span data-ttu-id="f76c7-129">Les identificateurs de type de données DB-Library sont définis dans sqlncli. h pour une utilisation avec la fonction ODBC **bcp_bind** .</span><span class="sxs-lookup"><span data-stu-id="f76c7-129">DB-Library data type identifiers are defined in sqlncli.h for use with the ODBC **bcp_bind** function.</span></span>  
  
 <span data-ttu-id="f76c7-130">Les fonctions de copie en bloc ne prennent pas en charge tous les types de données ODBC C.</span><span class="sxs-lookup"><span data-stu-id="f76c7-130">Bulk copy functions do not support all ODBC C data types.</span></span> <span data-ttu-id="f76c7-131">Par exemple, les fonctions de copie en bloc ne prennent pas en charge la structure ODBC SQL_C_TYPE_TIMESTAMP. Utilisez donc [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) ou [SQLGetData](../native-client-odbc-api/sqlgetdata.md) pour convertir les données ODBC SQL_TYPE_TIMESTAMP en une variable SQL_C_CHAR.</span><span class="sxs-lookup"><span data-stu-id="f76c7-131">For example, the bulk copy functions do not support the ODBC SQL_C_TYPE_TIMESTAMP structure, so use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) or [SQLGetData](../native-client-odbc-api/sqlgetdata.md) to convert ODBC SQL_TYPE_TIMESTAMP data to a SQL_C_CHAR variable.</span></span> <span data-ttu-id="f76c7-132">Si vous utilisez ensuite **bcp_bind** avec un paramètre de *type* SQLCHARACTER pour lier la variable à une [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] colonne **DateTime** , les fonctions de copie en bloc convertissent la clause d’échappement timestamp dans la variable caractère au format DateTime approprié.</span><span class="sxs-lookup"><span data-stu-id="f76c7-132">If you then use **bcp_bind** with a *type* parameter of SQLCHARACTER to bind the variable to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **datetime** column, the bulk copy functions convert the timestamp escape clause in the character variable to the proper datetime format.</span></span>  
  
 <span data-ttu-id="f76c7-133">Le tableau suivant répertorie les types de données recommandés à utiliser lors du mappage d'un type de données SQL ODBC à un type de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f76c7-133">The following table lists the recommended data types to use in mapping from an ODBC SQL data type to a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span>  
  
|<span data-ttu-id="f76c7-134">Type de données ODBC SQL</span><span class="sxs-lookup"><span data-stu-id="f76c7-134">ODBC SQLdata type</span></span>|<span data-ttu-id="f76c7-135">Type de données ODBC C</span><span class="sxs-lookup"><span data-stu-id="f76c7-135">ODBC C data type</span></span>|<span data-ttu-id="f76c7-136">paramètre de *type* bcp_bind</span><span class="sxs-lookup"><span data-stu-id="f76c7-136">bcp_bind *type* parameter</span></span>|<span data-ttu-id="f76c7-137">Type de données SQL Server</span><span class="sxs-lookup"><span data-stu-id="f76c7-137">SQL Server data type</span></span>|  
|-----------------------|----------------------|--------------------------------|--------------------------|  
|<span data-ttu-id="f76c7-138">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-138">SQL_CHAR</span></span>|<span data-ttu-id="f76c7-139">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-139">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-140">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-140">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-141">**symbole**</span><span class="sxs-lookup"><span data-stu-id="f76c7-141">**character**</span></span><br /><br /> <span data-ttu-id="f76c7-142">**char**</span><span class="sxs-lookup"><span data-stu-id="f76c7-142">**char**</span></span>|  
|<span data-ttu-id="f76c7-143">SQL_VARCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-143">SQL_VARCHAR</span></span>|<span data-ttu-id="f76c7-144">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-144">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-145">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-145">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-146">**varchar**</span><span class="sxs-lookup"><span data-stu-id="f76c7-146">**varchar**</span></span><br /><br /> <span data-ttu-id="f76c7-147">**character varying**</span><span class="sxs-lookup"><span data-stu-id="f76c7-147">**character varying**</span></span><br /><br /> <span data-ttu-id="f76c7-148">**char varying**</span><span class="sxs-lookup"><span data-stu-id="f76c7-148">**char varying**</span></span><br /><br /> <span data-ttu-id="f76c7-149">**sysname**</span><span class="sxs-lookup"><span data-stu-id="f76c7-149">**sysname**</span></span>|  
|<span data-ttu-id="f76c7-150">SQL_LONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-150">SQL_LONGVARCHAR</span></span>|<span data-ttu-id="f76c7-151">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-151">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-152">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-152">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-153">**text**</span><span class="sxs-lookup"><span data-stu-id="f76c7-153">**text**</span></span>|  
|<span data-ttu-id="f76c7-154">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-154">SQL_WCHAR</span></span>|<span data-ttu-id="f76c7-155">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-155">SQL_C_WCHAR</span></span>|<span data-ttu-id="f76c7-156">SQLNCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-156">SQLNCHAR</span></span>|<span data-ttu-id="f76c7-157">**nchar**</span><span class="sxs-lookup"><span data-stu-id="f76c7-157">**nchar**</span></span>|  
|<span data-ttu-id="f76c7-158">SQL_WVARCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-158">SQL_WVARCHAR</span></span>|<span data-ttu-id="f76c7-159">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-159">SQL_C_WCHAR</span></span>|<span data-ttu-id="f76c7-160">SQLNVARCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-160">SQLNVARCHAR</span></span>|<span data-ttu-id="f76c7-161">**nvarchar**</span><span class="sxs-lookup"><span data-stu-id="f76c7-161">**nvarchar**</span></span>|  
|<span data-ttu-id="f76c7-162">SQL_WLONGVARCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-162">SQL_WLONGVARCHAR</span></span>|<span data-ttu-id="f76c7-163">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-163">SQL_C_WCHAR</span></span>|<span data-ttu-id="f76c7-164">SQLNTEXT</span><span class="sxs-lookup"><span data-stu-id="f76c7-164">SQLNTEXT</span></span>|<span data-ttu-id="f76c7-165">**ntext**</span><span class="sxs-lookup"><span data-stu-id="f76c7-165">**ntext**</span></span>|  
|<span data-ttu-id="f76c7-166">SQL_DECIMAL</span><span class="sxs-lookup"><span data-stu-id="f76c7-166">SQL_DECIMAL</span></span>|<span data-ttu-id="f76c7-167">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-167">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-168">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-168">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-169">**decimal**</span><span class="sxs-lookup"><span data-stu-id="f76c7-169">**decimal**</span></span><br /><br /> <span data-ttu-id="f76c7-170">**decembre**</span><span class="sxs-lookup"><span data-stu-id="f76c7-170">**dec**</span></span><br /><br /> <span data-ttu-id="f76c7-171">**money**</span><span class="sxs-lookup"><span data-stu-id="f76c7-171">**money**</span></span><br /><br /> <span data-ttu-id="f76c7-172">**smallmoney**</span><span class="sxs-lookup"><span data-stu-id="f76c7-172">**smallmoney**</span></span>|  
|<span data-ttu-id="f76c7-173">SQL_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="f76c7-173">SQL_NUMERIC</span></span>|<span data-ttu-id="f76c7-174">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="f76c7-174">SQL_C_NUMERIC</span></span>|<span data-ttu-id="f76c7-175">SQLNUMERICN</span><span class="sxs-lookup"><span data-stu-id="f76c7-175">SQLNUMERICN</span></span>|<span data-ttu-id="f76c7-176">**numeric**</span><span class="sxs-lookup"><span data-stu-id="f76c7-176">**numeric**</span></span>|  
|<span data-ttu-id="f76c7-177">SQL_BIT</span><span class="sxs-lookup"><span data-stu-id="f76c7-177">SQL_BIT</span></span>|<span data-ttu-id="f76c7-178">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="f76c7-178">SQL_C_BIT</span></span>|<span data-ttu-id="f76c7-179">SQLBIT</span><span class="sxs-lookup"><span data-stu-id="f76c7-179">SQLBIT</span></span>|<span data-ttu-id="f76c7-180">**bit**</span><span class="sxs-lookup"><span data-stu-id="f76c7-180">**bit**</span></span>|  
|<span data-ttu-id="f76c7-181">SQL_TINYINT (signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-181">SQL_TINYINT (signed)</span></span>|<span data-ttu-id="f76c7-182">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="f76c7-182">SQL_C_SSHORT</span></span>|<span data-ttu-id="f76c7-183">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="f76c7-183">SQLINT2</span></span>|<span data-ttu-id="f76c7-184">**smallint**</span><span class="sxs-lookup"><span data-stu-id="f76c7-184">**smallint**</span></span>|  
|<span data-ttu-id="f76c7-185">SQL_TINYINT (non signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-185">SQL_TINYINT (unsigned)</span></span>|<span data-ttu-id="f76c7-186">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="f76c7-186">SQL_C_UTINYINT</span></span>|<span data-ttu-id="f76c7-187">SQLINT1</span><span class="sxs-lookup"><span data-stu-id="f76c7-187">SQLINT1</span></span>|<span data-ttu-id="f76c7-188">**tinyint**</span><span class="sxs-lookup"><span data-stu-id="f76c7-188">**tinyint**</span></span>|  
|<span data-ttu-id="f76c7-189">SQL_SMALL_INT (signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-189">SQL_SMALL_INT (signed)</span></span>|<span data-ttu-id="f76c7-190">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="f76c7-190">SQL_C_SSHORT</span></span>|<span data-ttu-id="f76c7-191">SQLINT2</span><span class="sxs-lookup"><span data-stu-id="f76c7-191">SQLINT2</span></span>|<span data-ttu-id="f76c7-192">**smallint**</span><span class="sxs-lookup"><span data-stu-id="f76c7-192">**smallint**</span></span>|  
|<span data-ttu-id="f76c7-193">SQL_SMALL_INT (non signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-193">SQL_SMALL_INT (unsigned)</span></span>|<span data-ttu-id="f76c7-194">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="f76c7-194">SQL_C_SLONG</span></span>|<span data-ttu-id="f76c7-195">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="f76c7-195">SQLINT4</span></span>|<span data-ttu-id="f76c7-196">**int**</span><span class="sxs-lookup"><span data-stu-id="f76c7-196">**int**</span></span><br /><br /> <span data-ttu-id="f76c7-197">**integer**</span><span class="sxs-lookup"><span data-stu-id="f76c7-197">**integer**</span></span>|  
|<span data-ttu-id="f76c7-198">SQL_INTEGER (signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-198">SQL_INTEGER (signed)</span></span>|<span data-ttu-id="f76c7-199">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="f76c7-199">SQL_C_SLONG</span></span>|<span data-ttu-id="f76c7-200">SQLINT4</span><span class="sxs-lookup"><span data-stu-id="f76c7-200">SQLINT4</span></span>|<span data-ttu-id="f76c7-201">**int**</span><span class="sxs-lookup"><span data-stu-id="f76c7-201">**int**</span></span><br /><br /> <span data-ttu-id="f76c7-202">**integer**</span><span class="sxs-lookup"><span data-stu-id="f76c7-202">**integer**</span></span>|  
|<span data-ttu-id="f76c7-203">SQL_INTEGER (non signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-203">SQL_INTEGER (unsigned)</span></span>|<span data-ttu-id="f76c7-204">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-204">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-205">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-205">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-206">**decimal**</span><span class="sxs-lookup"><span data-stu-id="f76c7-206">**decimal**</span></span><br /><br /> <span data-ttu-id="f76c7-207">**decembre**</span><span class="sxs-lookup"><span data-stu-id="f76c7-207">**dec**</span></span>|  
|<span data-ttu-id="f76c7-208">SQL_BIGINT (signé et non signé)</span><span class="sxs-lookup"><span data-stu-id="f76c7-208">SQL_BIGINT (signed and unsigned)</span></span>|<span data-ttu-id="f76c7-209">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-209">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-210">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-210">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-211">**bigint**</span><span class="sxs-lookup"><span data-stu-id="f76c7-211">**bigint**</span></span>|  
|<span data-ttu-id="f76c7-212">SQL_REAL</span><span class="sxs-lookup"><span data-stu-id="f76c7-212">SQL_REAL</span></span>|<span data-ttu-id="f76c7-213">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="f76c7-213">SQL_C_FLOAT</span></span>|<span data-ttu-id="f76c7-214">SQLFLT4</span><span class="sxs-lookup"><span data-stu-id="f76c7-214">SQLFLT4</span></span>|<span data-ttu-id="f76c7-215">**real**</span><span class="sxs-lookup"><span data-stu-id="f76c7-215">**real**</span></span>|  
|<span data-ttu-id="f76c7-216">SQL_FLOAT</span><span class="sxs-lookup"><span data-stu-id="f76c7-216">SQL_FLOAT</span></span>|<span data-ttu-id="f76c7-217">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="f76c7-217">SQL_C_DOUBLE</span></span>|<span data-ttu-id="f76c7-218">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="f76c7-218">SQLFLT8</span></span>|<span data-ttu-id="f76c7-219">**float**</span><span class="sxs-lookup"><span data-stu-id="f76c7-219">**float**</span></span>|  
|<span data-ttu-id="f76c7-220">SQL_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="f76c7-220">SQL_DOUBLE</span></span>|<span data-ttu-id="f76c7-221">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="f76c7-221">SQL_C_DOUBLE</span></span>|<span data-ttu-id="f76c7-222">SQLFLT8</span><span class="sxs-lookup"><span data-stu-id="f76c7-222">SQLFLT8</span></span>|<span data-ttu-id="f76c7-223">**float**</span><span class="sxs-lookup"><span data-stu-id="f76c7-223">**float**</span></span>|  
|<span data-ttu-id="f76c7-224">SQL_BINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-224">SQL_BINARY</span></span>|<span data-ttu-id="f76c7-225">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-225">SQL_C_BINARY</span></span>|<span data-ttu-id="f76c7-226">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-226">SQLBINARY</span></span>|<span data-ttu-id="f76c7-227">**binary**</span><span class="sxs-lookup"><span data-stu-id="f76c7-227">**binary**</span></span><br /><br /> <span data-ttu-id="f76c7-228">**timestamp**</span><span class="sxs-lookup"><span data-stu-id="f76c7-228">**timestamp**</span></span>|  
|<span data-ttu-id="f76c7-229">SQL_VARBINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-229">SQL_VARBINARY</span></span>|<span data-ttu-id="f76c7-230">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-230">SQL_C_BINARY</span></span>|<span data-ttu-id="f76c7-231">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-231">SQLBINARY</span></span>|<span data-ttu-id="f76c7-232">**varbinary**</span><span class="sxs-lookup"><span data-stu-id="f76c7-232">**varbinary**</span></span><br /><br /> <span data-ttu-id="f76c7-233">**binary varying**</span><span class="sxs-lookup"><span data-stu-id="f76c7-233">**binary varying**</span></span>|  
|<span data-ttu-id="f76c7-234">SQL_LONGVARBINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-234">SQL_LONGVARBINARY</span></span>|<span data-ttu-id="f76c7-235">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-235">SQL_C_BINARY</span></span>|<span data-ttu-id="f76c7-236">SQLBINARY</span><span class="sxs-lookup"><span data-stu-id="f76c7-236">SQLBINARY</span></span>|<span data-ttu-id="f76c7-237">**image**</span><span class="sxs-lookup"><span data-stu-id="f76c7-237">**image**</span></span>|  
|<span data-ttu-id="f76c7-238">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="f76c7-238">SQL_TYPE_DATE</span></span>|<span data-ttu-id="f76c7-239">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-239">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-240">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-240">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-241">**datetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-241">**datetime**</span></span><br /><br /> <span data-ttu-id="f76c7-242">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-242">**smalldatetime**</span></span>|  
|<span data-ttu-id="f76c7-243">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="f76c7-243">SQL_TYPE_TIME</span></span>|<span data-ttu-id="f76c7-244">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-244">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-245">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-245">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-246">**datetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-246">**datetime**</span></span><br /><br /> <span data-ttu-id="f76c7-247">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-247">**smalldatetime**</span></span>|  
|<span data-ttu-id="f76c7-248">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="f76c7-248">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="f76c7-249">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-249">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-250">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-250">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-251">**datetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-251">**datetime**</span></span><br /><br /> <span data-ttu-id="f76c7-252">**smalldatetime**</span><span class="sxs-lookup"><span data-stu-id="f76c7-252">**smalldatetime**</span></span>|  
|<span data-ttu-id="f76c7-253">SQL_GUID</span><span class="sxs-lookup"><span data-stu-id="f76c7-253">SQL_GUID</span></span>|<span data-ttu-id="f76c7-254">SQL_C_GUID</span><span class="sxs-lookup"><span data-stu-id="f76c7-254">SQL_C_GUID</span></span>|<span data-ttu-id="f76c7-255">SQLUNIQUEID</span><span class="sxs-lookup"><span data-stu-id="f76c7-255">SQLUNIQUEID</span></span>|<span data-ttu-id="f76c7-256">**uniqueidentifier**</span><span class="sxs-lookup"><span data-stu-id="f76c7-256">**uniqueidentifier**</span></span>|  
|<span data-ttu-id="f76c7-257">SQL_INTERVAL_</span><span class="sxs-lookup"><span data-stu-id="f76c7-257">SQL_INTERVAL_</span></span>|<span data-ttu-id="f76c7-258">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="f76c7-258">SQL_C_CHAR</span></span>|<span data-ttu-id="f76c7-259">SQLCHARACTER</span><span class="sxs-lookup"><span data-stu-id="f76c7-259">SQLCHARACTER</span></span>|<span data-ttu-id="f76c7-260">**char**</span><span class="sxs-lookup"><span data-stu-id="f76c7-260">**char**</span></span>|  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="f76c7-261">n’a pas de types de données **tinyint**, unsigned **smallint**ou unsigned **int** signés.</span><span class="sxs-lookup"><span data-stu-id="f76c7-261">does not have signed **tinyint**, unsigned **smallint**, or unsigned **int** data types.</span></span> <span data-ttu-id="f76c7-262">Pour empêcher la perte de valeurs de données lors de la migration de ces types de données, créez la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] avec le plus grand type de données integer suivant.</span><span class="sxs-lookup"><span data-stu-id="f76c7-262">To prevent the loss of data values when migrating these data types, create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with the next largest integer data type.</span></span> <span data-ttu-id="f76c7-263">Pour empêcher les utilisateurs d'ajouter ultérieurement des valeurs en dehors de la plage autorisée par le type de données d'origine, appliquez une règle à la colonne [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de manière à limiter les valeurs autorisées à la plage prise en charge par le type de données dans la source d'origine :</span><span class="sxs-lookup"><span data-stu-id="f76c7-263">To prevent users from later adding values outside the range allowed by the original data type, apply a rule to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] column to restrict the allowable values to the range supported by the data type in the original source:</span></span>  
  
```  
CREATE TABLE Sample_Ints(STinyIntCol   SMALLINT,  
USmallIntCol INT)  
GO  
CREATE RULE STinyInt_Rule  
AS   
@range >= -128 AND @range <= 127  
GO  
CREATE RULE USmallInt_Rule  
AS   
@range >= 0 AND @range <= 65535  
GO  
sp_bindrule STinyInt_Rule, 'Sample_Ints.STinyIntCol'  
GO  
sp_bindrule USmallInt_Rule, 'Sample_Ints.USmallIntCol'  
GO  
```  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="f76c7-264">ne prend pas en charge directement les types de données interval.</span><span class="sxs-lookup"><span data-stu-id="f76c7-264">does not support interval data types directly.</span></span> <span data-ttu-id="f76c7-265">Toutefois, une application peut stocker des séquences d'échappement d'intervalle sous la forme de chaînes de caractères dans une colonne [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de type character.</span><span class="sxs-lookup"><span data-stu-id="f76c7-265">An application can, however, store interval escape sequences as character strings in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] character column.</span></span> <span data-ttu-id="f76c7-266">L'application peut les lire pour une utilisation ultérieure, mais elles ne peuvent pas être utilisées dans des instructions [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f76c7-266">The application can read them for later use, but they cannot be used in [!INCLUDE[tsql](../../includes/tsql-md.md)] statements.</span></span>  
  
 <span data-ttu-id="f76c7-267">Les fonctions de copie en bloc peuvent être utilisées pour charger rapidement dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] des données qui ont été lues à partir d'une source de données ODBC.</span><span class="sxs-lookup"><span data-stu-id="f76c7-267">The bulk copy functions can be used to quickly load data into [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that has been read from an ODBC data source.</span></span> <span data-ttu-id="f76c7-268">Utilisez [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) pour lier les colonnes d’un jeu de résultats à des variables de programme, puis utilisez **bcp_bind** pour lier les mêmes variables de programme à une opération de copie en bloc.</span><span class="sxs-lookup"><span data-stu-id="f76c7-268">Use [SQLBindCol](../native-client-odbc-api/sqlbindcol.md) to bind the columns of a result set to program variables, then use **bcp_bind** to bind the same program variables to a bulk copy operation.</span></span> <span data-ttu-id="f76c7-269">L’appel de [SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md) ou **SQLFetch** récupère ensuite une ligne de données de la source de données ODBC dans les variables de programme, et l’appel de [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) copie en bloc les données à partir des variables de programme vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f76c7-269">Calling [SQLFetchScroll](../native-client-odbc-api/sqlfetchscroll.md) or **SQLFetch** then fetches a row of data from the ODBC data source into the program variables, and calling [bcp_sendrow](../native-client-odbc-extensions-bulk-copy-functions/bcp-sendrow.md) bulk copies the data from the program variables to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span></span>  
  
 <span data-ttu-id="f76c7-270">Une application peut utiliser la fonction [bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md) à chaque fois qu’elle a besoin de modifier l’adresse de la variable de données spécifiée à l’origine dans le paramètre **bcp_bind** _pData_ .</span><span class="sxs-lookup"><span data-stu-id="f76c7-270">An application can use the [bcp_colptr](../native-client-odbc-extensions-bulk-copy-functions/bcp-colptr.md) function anytime it needs to change the address of the data variable originally specified in the **bcp_bind** _pData_ parameter.</span></span> <span data-ttu-id="f76c7-271">Une application peut utiliser la fonction [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md) à chaque fois qu’elle a besoin de modifier la longueur des données spécifiée à l’origine dans le paramètre **bcp_bind**_cbData_ .</span><span class="sxs-lookup"><span data-stu-id="f76c7-271">An application can use the [bcp_collen](../native-client-odbc-extensions-bulk-copy-functions/bcp-collen.md) function anytime it needs to change the data length originally specified in the **bcp_bind**_cbData_ parameter.</span></span>  
  
 <span data-ttu-id="f76c7-272">Vous ne pouvez pas lire des données de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] dans des variables de programme à l'aide de la copie en bloc. Il n'existe en effet pas de fonction similaire à « bcp_readrow ».</span><span class="sxs-lookup"><span data-stu-id="f76c7-272">You cannot read data from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] into program variables using bulk copy; there is nothing like a "bcp_readrow" function.</span></span> <span data-ttu-id="f76c7-273">Vous pouvez seulement envoyer des données de l'application au serveur.</span><span class="sxs-lookup"><span data-stu-id="f76c7-273">You can only send data from the application to the server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f76c7-274">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f76c7-274">See Also</span></span>  
 [<span data-ttu-id="f76c7-275">Exécution d’opérations de copie en bloc &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="f76c7-275">Performing Bulk Copy Operations &#40;ODBC&#41;</span></span>](performing-bulk-copy-operations-odbc.md)  
  
  
