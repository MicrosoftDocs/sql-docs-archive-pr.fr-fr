---
title: Vue d’ensemble des index spatiaux | Microsoft Docs
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- spatial indexes [SQL Server]
ms.assetid: b1ae7b78-182a-459e-ab28-f743e43f8293
author: MladjoA
ms.author: mlandzic
ms.openlocfilehash: 36406bd60b4204469aca3d20862020870a8832fe
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611015"
---
# <a name="spatial-indexes-overview"></a><span data-ttu-id="32d2f-102">Vue d'ensemble des index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-102">Spatial Indexes Overview</span></span>
  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="32d2f-103">prend en charge les données spatiales et les index spatiaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-103">supports spatial data and spatial indexes.</span></span> <span data-ttu-id="32d2f-104">Un *index spatial* est un type d'index étendu qui vous permet d'indexer une colonne spatiale.</span><span class="sxs-lookup"><span data-stu-id="32d2f-104">A *spatial index* is a type of extended index that allows you to index a spatial column.</span></span> <span data-ttu-id="32d2f-105">Une colonne spatiale est une colonne de table qui contient des données d'un type de données spatiales, tel que `geometry` ou `geography`.</span><span class="sxs-lookup"><span data-stu-id="32d2f-105">A spatial column is a table column that contains data of a spatial data type, such as `geometry` or `geography`.</span></span>

> [!IMPORTANT]
>  <span data-ttu-id="32d2f-106">Pour obtenir une description détaillée et des exemples des fonctionnalités spatiales introduites dans [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], notamment les fonctionnalités qui affectent les index spatiaux, téléchargez le livre blanc [New Spatial Features in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=226407)(Nouvelles fonctionnalités spatiales de SQL Server 2012).</span><span class="sxs-lookup"><span data-stu-id="32d2f-106">For a detailed description and examples of spatial features introduced in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], including features that affect spatial indexes, download the white paper, [New Spatial Features in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=226407).</span></span>

##  <a name="about-spatial-indexes"></a><a name="about"></a> <span data-ttu-id="32d2f-107">À propos des index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-107">About Spatial Indexes</span></span>

###  <a name="decomposing-indexed-space-into-a-grid-hierarchy"></a><a name="decompose"></a> <span data-ttu-id="32d2f-108">Décomposition de l'espace indexé en une hiérarchie de grille</span><span class="sxs-lookup"><span data-stu-id="32d2f-108">Decomposing Indexed Space into a Grid Hierarchy</span></span>
 <span data-ttu-id="32d2f-109">Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les index spatiaux sont construits à l'aide d'arbres B (B-trees), ce qui signifie que les index doivent représenter les données spatiales bidimensionnelles dans l'ordre linéaire d'arbres B.</span><span class="sxs-lookup"><span data-stu-id="32d2f-109">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], spatial indexes are built using B-trees, which means that the indexes must represent the 2-dimensional spatial data in the linear order of B-trees.</span></span> <span data-ttu-id="32d2f-110">Par conséquent, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implémente une décomposition uniforme hiérarchique de l'espace avant de lire des données dans un index spatial.</span><span class="sxs-lookup"><span data-stu-id="32d2f-110">Therefore, before reading data into a spatial index, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] implements a hierarchical uniform decomposition of space.</span></span> <span data-ttu-id="32d2f-111">Le processus de création d’index *décompose* l’espace en une *hiérarchie de grille*à quatre niveaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-111">The index-creation process *decomposes* the space into a four-level *grid hierarchy*.</span></span> <span data-ttu-id="32d2f-112">Ces niveaux sont appelés *niveau 1* (niveau supérieur), *niveau 2*, *niveau 3*et *niveau 4*.</span><span class="sxs-lookup"><span data-stu-id="32d2f-112">These levels are referred to as *level 1* (the top level), *level 2*, *level 3*, and *level 4*.</span></span>

 <span data-ttu-id="32d2f-113">Chaque niveau consécutif décompose davantage le niveau supérieur ; chaque cellule de niveau supérieur contient donc une grille complète au niveau suivant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-113">Each successive level further decomposes the level above it, so each upper-level cell contains a complete grid at the next level.</span></span> <span data-ttu-id="32d2f-114">Sur un niveau donné, toutes les grilles ont le même nombre de cellules le long des deux axes (par exemple, 4x4 ou 8x8) et les cellules sont toutes d'une seule taille.</span><span class="sxs-lookup"><span data-stu-id="32d2f-114">On a given level, all the grids have the same number of cells along both axes (for example, 4x4 or 8x8), and the cells are all one size.</span></span>

 <span data-ttu-id="32d2f-115">L'illustration suivante montre la décomposition pour la cellule supérieure droite à chaque niveau de la hiérarchie de grille en une grille 4x4.</span><span class="sxs-lookup"><span data-stu-id="32d2f-115">The following illustration shows the decomposition for the upper-right cell at each level of the grid hierarchy into a 4x4 grid.</span></span> <span data-ttu-id="32d2f-116">En réalité, toutes les cellules sont décomposées de cette manière.</span><span class="sxs-lookup"><span data-stu-id="32d2f-116">In reality, all the cells are decomposed in this way.</span></span> <span data-ttu-id="32d2f-117">Par exemple, la décomposition d'un espace en quatre niveaux de grilles 4x4 produit en fait un total de 65 536 cellules de niveau quatre.</span><span class="sxs-lookup"><span data-stu-id="32d2f-117">Thus, for example, decomposing a space into four levels of 4x4 grids actually produces a total of 65,536 level-four cells.</span></span>

 <span data-ttu-id="32d2f-118">![Quatre niveaux de pavage récursif](../../database-engine/media/spndx-recursive-levels-telescoped.gif "Quatre niveaux de pavage récursif")</span><span class="sxs-lookup"><span data-stu-id="32d2f-118">![Four-levels of recursive tessellation](../../database-engine/media/spndx-recursive-levels-telescoped.gif "Four-levels of recursive tessellation")</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-119">La décomposition d'espace pour un index spatial est indépendante de l'unité de mesure utilisée par les données de l'application.</span><span class="sxs-lookup"><span data-stu-id="32d2f-119">The decomposition of space for a spatial index is independent of the unit of measurement that the application data uses.</span></span>

 <span data-ttu-id="32d2f-120">Les cellules d'une hiérarchie de grille sont numérotées de façon linéaire en utilisant une variante de la courbe de remplissage d'espace de Hilbert.</span><span class="sxs-lookup"><span data-stu-id="32d2f-120">Grid hierarchy cells are numbered in a linear fashion by using a variation of the Hilbert space-filling curve.</span></span> <span data-ttu-id="32d2f-121">Toutefois, à des fins d'illustration, cette discussion utilise une numérotation de ligne simple plutôt que la numérotation réellement générée par la courbe Hilbert.</span><span class="sxs-lookup"><span data-stu-id="32d2f-121">For the purpose of illustration, however, this discussion uses a simple row-wise numbering, instead of the numbering that is actually produced by the Hilbert curve.</span></span> <span data-ttu-id="32d2f-122">Dans l'illustration suivante, plusieurs polygones qui représentent des bâtiments et des lignes qui représentent des rues ont déjà été placés dans une grille 4x4 de niveau 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-122">In the following illustration, several polygons that represent buildings, and lines that represent streets, have already been placed into a 4x4, level-1 grid.</span></span> <span data-ttu-id="32d2f-123">Les cellules de niveau 1 sont numérotées de 1 à 16, en commençant par la cellule supérieure gauche.</span><span class="sxs-lookup"><span data-stu-id="32d2f-123">The level-1 cells are numbered from 1 through 16, starting with the upper-left cell.</span></span>

 <span data-ttu-id="32d2f-124">![Polygones et lignes placés dans une grille 4x4 de niveau 1](../../database-engine/media/spndx-level-1-objects.gif "Polygones et lignes placés dans une grille 4x4 de niveau 1")</span><span class="sxs-lookup"><span data-stu-id="32d2f-124">![Polygons and lines placed into a 4x4 level-1 grid](../../database-engine/media/spndx-level-1-objects.gif "Polygons and lines placed into a 4x4 level-1 grid")</span></span>

#### <a name="grid-density"></a><span data-ttu-id="32d2f-125">Densité de grille</span><span class="sxs-lookup"><span data-stu-id="32d2f-125">Grid Density</span></span>
 <span data-ttu-id="32d2f-126">Le nombre de cellules le long des axes d'une grille détermine sa *densité*: plus le nombre est élevé, plus la grille est dense.</span><span class="sxs-lookup"><span data-stu-id="32d2f-126">The number of cells along the axes of a grid determines its *density*: the larger the number, the denser the grid.</span></span> <span data-ttu-id="32d2f-127">Par exemple, une grille 8x8 (qui produit 64 cellules) est plus dense qu'une grille 4x4 (qui produit 16 cellules).</span><span class="sxs-lookup"><span data-stu-id="32d2f-127">For example, an 8x8 grid (which produces 64 cells), is denser than a 4x4 grid (which produces 16 cells).</span></span> <span data-ttu-id="32d2f-128">La densité de grille est définie sur la base de chaque niveau.</span><span class="sxs-lookup"><span data-stu-id="32d2f-128">Grid density is defined on a per-level basis.</span></span>

 <span data-ttu-id="32d2f-129">L'instruction [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] prend en charge une clause GRIDS qui vous permet de spécifier des densités de grille différentes à des niveaux différents.</span><span class="sxs-lookup"><span data-stu-id="32d2f-129">The [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement supports a GRIDS clause that enables you to specify different grid densities at different levels.</span></span> <span data-ttu-id="32d2f-130">La densité de grille pour un niveau donné est spécifiée à l'aide de l'un des mots clés suivants.</span><span class="sxs-lookup"><span data-stu-id="32d2f-130">The grid density for a given level is specified by using one of the following keywords.</span></span>

|<span data-ttu-id="32d2f-131">Mot clé</span><span class="sxs-lookup"><span data-stu-id="32d2f-131">Keyword</span></span>|<span data-ttu-id="32d2f-132">Configuration de grille</span><span class="sxs-lookup"><span data-stu-id="32d2f-132">Grid configuration</span></span>|<span data-ttu-id="32d2f-133">Nombre de cellules</span><span class="sxs-lookup"><span data-stu-id="32d2f-133">Number of cells</span></span>|
|-------------|------------------------|---------------------|
|<span data-ttu-id="32d2f-134">LOW</span><span class="sxs-lookup"><span data-stu-id="32d2f-134">LOW</span></span>|<span data-ttu-id="32d2f-135">4X4</span><span class="sxs-lookup"><span data-stu-id="32d2f-135">4X4</span></span>|<span data-ttu-id="32d2f-136">16</span><span class="sxs-lookup"><span data-stu-id="32d2f-136">16</span></span>|
|<span data-ttu-id="32d2f-137">MEDIUM</span><span class="sxs-lookup"><span data-stu-id="32d2f-137">MEDIUM</span></span>|<span data-ttu-id="32d2f-138">8X8</span><span class="sxs-lookup"><span data-stu-id="32d2f-138">8X8</span></span>|<span data-ttu-id="32d2f-139">64</span><span class="sxs-lookup"><span data-stu-id="32d2f-139">64</span></span>|
|<span data-ttu-id="32d2f-140">HIGH</span><span class="sxs-lookup"><span data-stu-id="32d2f-140">HIGH</span></span>|<span data-ttu-id="32d2f-141">16X16</span><span class="sxs-lookup"><span data-stu-id="32d2f-141">16X16</span></span>|<span data-ttu-id="32d2f-142">256</span><span class="sxs-lookup"><span data-stu-id="32d2f-142">256</span></span>|

 <span data-ttu-id="32d2f-143">Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], lorsque le niveau de compatibilité de la base de données est défini sur 100 ou une valeur inférieure, la valeur par défaut est MEDIUM sur tous les niveaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-143">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], when the database compatibility level is set to 100 or lower, then the default is MEDIUM on all levels.</span></span> <span data-ttu-id="32d2f-144">Lorsque le niveau de compatibilité de la base de données est défini sur 110 ou une valeur supérieure, la valeur par défaut est un modèle de grille automatique.</span><span class="sxs-lookup"><span data-stu-id="32d2f-144">When the database compatibility level is set to 110 or higher, then the default is an auto grid scheme.</span></span>

 <span data-ttu-id="32d2f-145">Vous pouvez contrôler le processus de décomposition en spécifiant des densités de grille autres que les densités par défaut.</span><span class="sxs-lookup"><span data-stu-id="32d2f-145">You can control the decomposition process by specifying non-default grid densities.</span></span> <span data-ttu-id="32d2f-146">Par exemple, différentes densités de grille sur différents niveaux peuvent être utiles pour le réglage fin d'un index en fonction de la taille de l'espace indexé et des objets contenus dans la colonne spatiale.</span><span class="sxs-lookup"><span data-stu-id="32d2f-146">For example, different grid densities on different levels might be useful for fine tuning an index based on the size of the indexed space and the objects in the spatial column.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-147">Les densités de grille d’un index spatial sont visibles dans les colonnes level_1_grid, level_2_grid, level_3_grid et level_4_grid de l’affichage catalogue [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) quand le niveau de compatibilité de la base de données est défini à 100 ou à une valeur inférieure.</span><span class="sxs-lookup"><span data-stu-id="32d2f-147">The grid densities of a spatial index are visible in the level_1_grid, level_2_grid, level_3_grid, and level_4_grid columns of the [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) catalog view when the database compatibility level is set to 100 or lower.</span></span> <span data-ttu-id="32d2f-148">Les `GEOMETRY_AUTO_GRID` / `GEOGRAPHY_AUTO_GRID` options de schéma de pavage ne remplissent pas ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="32d2f-148">The `GEOMETRY_AUTO_GRID`/`GEOGRAPHY_AUTO_GRID` tessellation scheme options do not populate these columns.</span></span> <span data-ttu-id="32d2f-149">l’affichage catalogue sys. spatial_index_tessellations a `NULL` des valeurs pour ces colonnes lorsque les options de grille automatique sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="32d2f-149">sys.spatial_index_tessellations catalog view has `NULL` values for these columns when the auto grid options are used.</span></span>

###  <a name="tessellation"></a><a name="tessellation"></a> <span data-ttu-id="32d2f-150">Pavage</span><span class="sxs-lookup"><span data-stu-id="32d2f-150">Tessellation</span></span>
 <span data-ttu-id="32d2f-151">Après la décomposition d'un espace indexé en une hiérarchie de grille, l'index spatial lit les données de la colonne spatiale, ligne par ligne.</span><span class="sxs-lookup"><span data-stu-id="32d2f-151">After decomposition of an indexed space into a grid hierarchy, the spatial index reads the data from the spatial column, row by row.</span></span> <span data-ttu-id="32d2f-152">Après avoir lu les données pour un objet spatial (ou une instance), l’index spatial exécute un *processus de pavage* pour cet objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-152">After reading the data for a spatial object (or instance), the spatial index performs a *tessellation process* for that object.</span></span> <span data-ttu-id="32d2f-153">Le processus de pavage place l’objet dans la hiérarchie de grille en associant l’objet à un ensemble de cellules de grille qu’il touche (*cellules touchées*).</span><span class="sxs-lookup"><span data-stu-id="32d2f-153">The tessellation processfits the object into the grid hierarchy by associating the object with a set of grid cells that it touches (*touched cells*).</span></span> <span data-ttu-id="32d2f-154">En partant du niveau 1 de la hiérarchie de grille, le processus de pavage continue *dans le sens de la largeur* à travers le niveau.</span><span class="sxs-lookup"><span data-stu-id="32d2f-154">Starting at level 1 of the grid hierarchy, the tessellation process proceeds *breadth first* across the level.</span></span> <span data-ttu-id="32d2f-155">Potentiellement, le processus peut se poursuivre à travers les quatre niveaux, un niveau à la fois.</span><span class="sxs-lookup"><span data-stu-id="32d2f-155">Potentially, the process can continue through all four levels, one level at a time.</span></span>

 <span data-ttu-id="32d2f-156">La sortie du processus de pavage est un jeu de cellules touchées enregistrées dans l'index spatial pour l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-156">The output of the tessellation process is a set of touched cells that are recorded in the spatial index for the object.</span></span> <span data-ttu-id="32d2f-157">En faisant référence à ces cellules enregistrées, l'index spatial peut localiser l'objet dans l'espace relativement à d'autres objets dans la colonne spatiale qui sont également stockés dans l'index.</span><span class="sxs-lookup"><span data-stu-id="32d2f-157">By referring to these recorded cells, the spatial index can locate the object in space relative to other objects in the spatial column that are also stored in the index.</span></span>

#### <a name="tessellation-rules"></a><span data-ttu-id="32d2f-158">Règles de pavage</span><span class="sxs-lookup"><span data-stu-id="32d2f-158">Tessellation Rules</span></span>
 <span data-ttu-id="32d2f-159">Pour limiter le nombre de cellules touchées enregistrées pour un objet, le processus de pavage applique plusieurs règles de pavage.</span><span class="sxs-lookup"><span data-stu-id="32d2f-159">To limit the number of touched cells that are recorded for an object, the tessellation process applies several tessellation rules.</span></span> <span data-ttu-id="32d2f-160">Ces règles déterminent la profondeur du processus de pavage et lesquelles des cellules touchées sont enregistrées dans l'index.</span><span class="sxs-lookup"><span data-stu-id="32d2f-160">These rules determine the depth of the tessellation process and which of the touched cells are recorded in the index.</span></span>

 <span data-ttu-id="32d2f-161">Ces règles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="32d2f-161">These rules are as follows:</span></span>

-   <span data-ttu-id="32d2f-162">La règle de couverture</span><span class="sxs-lookup"><span data-stu-id="32d2f-162">The covering rule</span></span>

     <span data-ttu-id="32d2f-163">Si l'objet couvre complètement une cellule, cette cellule est dite *couverte* par l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-163">If the object completely covers a cell, that cell is said to be *covered* by the object.</span></span> <span data-ttu-id="32d2f-164">Une cellule couverte est comptée et n'est pas pavée.</span><span class="sxs-lookup"><span data-stu-id="32d2f-164">A covered cell is counted and is not tessellated.</span></span> <span data-ttu-id="32d2f-165">Cette règle s'applique à tous les niveaux de la hiérarchie de grille.</span><span class="sxs-lookup"><span data-stu-id="32d2f-165">This rule applies at all levels of the grid hierarchy.</span></span> <span data-ttu-id="32d2f-166">La règle de couverture simplifie le processus de pavage et réduit la quantité de données enregistrées par un index spatial.</span><span class="sxs-lookup"><span data-stu-id="32d2f-166">The covering rule simplifies the tessellation process and reduces the amount of data that a spatial index records.</span></span>

-   <span data-ttu-id="32d2f-167">La règle de cellules par objet</span><span class="sxs-lookup"><span data-stu-id="32d2f-167">The cells-per-object rule</span></span>

     <span data-ttu-id="32d2f-168">Cette règle applique la *limite de cellules par objet*, qui détermine le nombre maximal de cellules qui peuvent être comptées pour chaque objet, hormis au niveau 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-168">This rule enforces the *cells-per-object limit*, which determines the maximum number of cells that can be counted for each object, except on level 1.</span></span> <span data-ttu-id="32d2f-169">Aux niveaux inférieurs, la règle de cellules par objet contrôle la quantité d'informations qui peuvent être enregistrées à propos de l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-169">At lower levels, the cells-per-object rule controls the amount of information that can be recorded about the object.</span></span>

-   <span data-ttu-id="32d2f-170">La règle de cellule la plus profonde</span><span class="sxs-lookup"><span data-stu-id="32d2f-170">The deepest-cell rule</span></span>

     <span data-ttu-id="32d2f-171">La règle de cellule la plus profonde génère la meilleure approximation d'un objet en enregistrant uniquement les seules cellules les plus profondes qui ont été pavées pour l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-171">The deepest-cell rule generates the best approximation of an object by recording only the bottom-most cells that have been tessellated for the object.</span></span> <span data-ttu-id="32d2f-172">Les cellules parentes ne contribuent pas au nombre de cellules par objet et elles ne sont pas enregistrées dans l'index.</span><span class="sxs-lookup"><span data-stu-id="32d2f-172">Parent cells do not contribute to the cells-per-object count, and they are not recorded in the index.</span></span>

 <span data-ttu-id="32d2f-173">Ces règles de pavage sont appliquées de manière récursive sur chaque niveau de grille.</span><span class="sxs-lookup"><span data-stu-id="32d2f-173">These tessellation rules are applied recursively on each grid level.</span></span> <span data-ttu-id="32d2f-174">Le reste de cette section décrit les règles de pavage en détail.</span><span class="sxs-lookup"><span data-stu-id="32d2f-174">The rest of this section describes the tessellation rules in more detail.</span></span>

#### <a name="covering-rule"></a><span data-ttu-id="32d2f-175">Règle de couverture</span><span class="sxs-lookup"><span data-stu-id="32d2f-175">Covering Rule</span></span>
 <span data-ttu-id="32d2f-176">Si un objet couvre complètement une cellule, cette cellule est dite *couverte* par l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-176">If an object completely covers a cell, that cell is said to be *covered* by the object.</span></span> <span data-ttu-id="32d2f-177">Par exemple, dans l'illustration suivante, l'une des cellules de second niveau, 15.11, est complètement couverte par la partie centrale d'un octogone.</span><span class="sxs-lookup"><span data-stu-id="32d2f-177">For example, in the following illustration, one of the second-level cells, 15.11, is completely covered by the middle portion of an octagon.</span></span>

 <span data-ttu-id="32d2f-178">![Optimisation de la couverture](../../database-engine/media/spndx-opt-covering.gif "Optimisation de la couverture")</span><span class="sxs-lookup"><span data-stu-id="32d2f-178">![Covering optimization](../../database-engine/media/spndx-opt-covering.gif "Covering optimization")</span></span>

 <span data-ttu-id="32d2f-179">Une cellule couverte est comptée et enregistrée dans l'index, et la cellule n'est pas pavée davantage.</span><span class="sxs-lookup"><span data-stu-id="32d2f-179">A covered cell is counted and recorded in the index, and the cell is not tessellated any further.</span></span>

#### <a name="cells-per-object-rule"></a><span data-ttu-id="32d2f-180">Règle de cellules par objet</span><span class="sxs-lookup"><span data-stu-id="32d2f-180">Cells-Per-Object Rule</span></span>
 <span data-ttu-id="32d2f-181">L’étendue de pavage de chaque objet dépend principalement de la *limite de cellules par objet* de l’index spatial.</span><span class="sxs-lookup"><span data-stu-id="32d2f-181">The extent of tessellation of each object depends primarily on the *cells-per-object limit* of the spatial index.</span></span> <span data-ttu-id="32d2f-182">Cette limite définit le nombre maximal de cellules que le pavage peut compter par objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-182">This limit defines the maximum number of cells that tessellation can count per object.</span></span> <span data-ttu-id="32d2f-183">Notez toutefois que la règle de cellules par objet n'est pas appliquée au niveau 1 ; il est par conséquent possible de dépasser cette limite.</span><span class="sxs-lookup"><span data-stu-id="32d2f-183">Note, however, that the cells-per-object rule is not enforced for level 1, so it is possible to exceed this limit.</span></span> <span data-ttu-id="32d2f-184">Si le nombre de cellules au niveau 1 atteint ou dépasse la limite de cellules par objet, aucun pavage supplémentaire n'a lieu aux niveaux inférieurs.</span><span class="sxs-lookup"><span data-stu-id="32d2f-184">If the level-1 count reaches, or exceeds, the cells-per-object limit, no further tessellation occurs at the lower levels.</span></span>

 <span data-ttu-id="32d2f-185">Tant que le nombre est inférieur à la limite de cellules par objet, le processus de pavage continue.</span><span class="sxs-lookup"><span data-stu-id="32d2f-185">As long as the count is less than the cells-per-object limit, the tessellation process continues.</span></span> <span data-ttu-id="32d2f-186">En commençant par la cellule touchée la plus basse (par exemple, la cellule 15.6 dans l'illustration précédente), le processus teste chaque cellule afin d'évaluer s'il faut la compter ou la paver.</span><span class="sxs-lookup"><span data-stu-id="32d2f-186">Starting with the lowest-number touched cell (for example, cell 15.6 in the preceding illustration), the process tests each cell to evaluate whether to count it or tessellate it.</span></span> <span data-ttu-id="32d2f-187">Si le pavage d'une cellule entraîne un dépassement de la limite de cellules par objet, la cellule est comptée et non pavée.</span><span class="sxs-lookup"><span data-stu-id="32d2f-187">If tessellating a cell would exceed the cells-per-object limit, the cell is counted and not tessellated.</span></span> <span data-ttu-id="32d2f-188">Autrement, la cellule est pavée et les cellules de niveau inférieur touchées par l'objet sont comptées.</span><span class="sxs-lookup"><span data-stu-id="32d2f-188">Otherwise, the cell is tessellated, and the lower-level cells that are touched by the object are counted.</span></span> <span data-ttu-id="32d2f-189">Le processus de pavage se poursuit de cette manière, dans le sens de la largeur, à travers le niveau.</span><span class="sxs-lookup"><span data-stu-id="32d2f-189">The tessellation process continues in this way, breadth-wise, across the level.</span></span> <span data-ttu-id="32d2f-190">Ce processus est répété de façon récursive pour les grilles de niveau inférieur des cellules pavées jusqu'à ce que la limite soit atteinte ou qu'il n'y ait plus de cellules à compter.</span><span class="sxs-lookup"><span data-stu-id="32d2f-190">This process is repeated recursively for the lower-level grids of the tessellated cells until the limit is reached or there are no more cells to count.</span></span>

 <span data-ttu-id="32d2f-191">Par exemple, considérez l'illustration précédente, qui montre un octogone qui s'adapte parfaitement à la cellule 15 de la grille de niveau 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-191">For example, consider the preceding illustration, which shows an octagon that fits completely into cell 15 of the level-1 grid.</span></span> <span data-ttu-id="32d2f-192">Dans l'illustration, la cellule 15 a été pavée, l'octogone ayant été disséqué en neuf cellules de niveau 2.</span><span class="sxs-lookup"><span data-stu-id="32d2f-192">In the figure, cell 15 has been tessellated, dissecting the octagon into nine level-2 cells.</span></span> <span data-ttu-id="32d2f-193">Cette illustration suppose que la limite de cellules par objet est supérieure ou égale à 9.</span><span class="sxs-lookup"><span data-stu-id="32d2f-193">This illustration assumes that the cells-per-object limit is 9 or more.</span></span> <span data-ttu-id="32d2f-194">Si la limite de cellules par objet était inférieure ou égale à 8, la cellule 15 ne serait pas pavée et seule cette cellule 15 serait comptée pour l'objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-194">If the cells-per-object limit were 8 or less, however, cell 15 would not be tessellated, and only that cell 15 would be counted for the object.</span></span>

 <span data-ttu-id="32d2f-195">Par défaut, la limite de cellules par objet est de 16, ce qui constitue un compromis satisfaisant entre l'espace et la précision pour la plupart des index spatiaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-195">By default, the cells-per-object limit is 16 cells per object, which provides a satisfactory trade-off between space and precision for most spatial indexes.</span></span> <span data-ttu-id="32d2f-196">Toutefois, l’instruction [Create spatial index](/sql/t-sql/statements/create-spatial-index-transact-sql) [!INCLUDE[tsql](../../../includes/tsql-md.md)] prend en charge une clause CELLS_PER_OBJECT `=` *n* qui vous permet de spécifier une limite de cellules par objet comprise entre 1 et 8192 inclus.</span><span class="sxs-lookup"><span data-stu-id="32d2f-196">However, the [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement supports a CELLS_PER_OBJECT`=`*n* clause that enables you to specify a cells-per-object limit between 1 and 8192, inclusive.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-197">Le paramètre **cells_per_object** d’un index spatial est visible dans l’affichage catalogue [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="32d2f-197">The **cells_per_object** setting of a spatial index is visible in the [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) catalog view.</span></span>

#### <a name="deepest-cell-rule"></a><span data-ttu-id="32d2f-198">Règle de cellule la plus profonde</span><span class="sxs-lookup"><span data-stu-id="32d2f-198">Deepest-Cell Rule</span></span>
 <span data-ttu-id="32d2f-199">La règle de cellule la plus profonde exploite le fait que chaque cellule de niveau inférieur appartient à la cellule située au-dessus d'elle : une cellule de niveau 4 appartient à une cellule de niveau 3, une cellule de niveau 3 appartient à une cellule de niveau 2 et une cellule de niveau 2 appartient à une cellule de niveau 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-199">The deepest-cell rule exploits the fact that every lower-level cell belongs to the cell above it: a level-4 cell belongs to a level-3 cell, a level-3 cell belongs to a level-2 cell, and a level-2 cell belongs to a level-1 cell.</span></span> <span data-ttu-id="32d2f-200">Par exemple, un objet qui appartient à la cellule 1.1.1.1 appartient également à la cellule 1.1.1, à la cellule 1.1 et à la cellule 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-200">For example, an object that belongs to cell 1.1.1.1 also belongs to cell 1.1.1, cell 1.1, and cell 1.</span></span> <span data-ttu-id="32d2f-201">La connaissance de telles relations de hiérarchie de cellule est intégrée au processeur de requêtes.</span><span class="sxs-lookup"><span data-stu-id="32d2f-201">Knowledge of such cell-hierarchy relationships is built into the query processor.</span></span> <span data-ttu-id="32d2f-202">Par conséquent, seules les cellules les plus profondes doivent être enregistrées dans l'index, ce qui réduit la quantité d'informations que l'index doit stocker.</span><span class="sxs-lookup"><span data-stu-id="32d2f-202">Therefore, only the deepest-level cells need to be recorded in the index, minimizing the information that the index needs to store.</span></span>

 <span data-ttu-id="32d2f-203">Dans l'illustration suivante, un polygone en losange relativement petit est pavé.</span><span class="sxs-lookup"><span data-stu-id="32d2f-203">In the following illustration, a relatively small diamond-shaped polygon is tessellated.</span></span> <span data-ttu-id="32d2f-204">L'index utilise la limite de cellules par objet par défaut de 16, qui n'est pas atteinte pour ce petit objet.</span><span class="sxs-lookup"><span data-stu-id="32d2f-204">The index uses the default cells-per-object limit of 16, which is not reached for this small object.</span></span> <span data-ttu-id="32d2f-205">Par conséquent, le pavage continue jusqu'au niveau 4.</span><span class="sxs-lookup"><span data-stu-id="32d2f-205">Therefore, tessellation continues down to level 4.</span></span> <span data-ttu-id="32d2f-206">Le polygone réside dans les cellules suivantes du niveau 1 au niveau 3 : 4, 4.4 et 4.4.10 et 4.4.14.</span><span class="sxs-lookup"><span data-stu-id="32d2f-206">The polygon resides in the following level-1 through level-3 cells: 4, 4.4, and 4.4.10 and 4.4.14.</span></span> <span data-ttu-id="32d2f-207">Toutefois, avec la règle de cellule la plus profonde, le pavage compte uniquement les douze cellules de niveau 4 : 4.4.10.13-15 et 4.4.14.1-3, 4.4.14.5-7 et 4.4.14.9-11.</span><span class="sxs-lookup"><span data-stu-id="32d2f-207">However, using the deepest-cell rule, the tessellation counts only the twelve level-4 cells: 4.4.10.13-15 and 4.4.14.1-3, 4.4.14.5-7, and 4.4.14.9-11.</span></span>

 <span data-ttu-id="32d2f-208">![Optimisation de la cellule la plus profonde](../../database-engine/media/spndx-opt-deepest-cell.gif "Optimisation de la cellule la plus profonde")</span><span class="sxs-lookup"><span data-stu-id="32d2f-208">![Deepest-cell optimization](../../database-engine/media/spndx-opt-deepest-cell.gif "Deepest-cell optimization")</span></span>

###  <a name="tessellation-schemes"></a><a name="schemes"></a> <span data-ttu-id="32d2f-209">Schémas de pavage</span><span class="sxs-lookup"><span data-stu-id="32d2f-209">Tessellation Schemes</span></span>
 <span data-ttu-id="32d2f-210">Le comportement d'un index spatial dépend en partie de son *schéma de pavage*.</span><span class="sxs-lookup"><span data-stu-id="32d2f-210">The behavior of a spatial index depends partly on its *tessellation scheme*.</span></span> <span data-ttu-id="32d2f-211">Le schéma de pavage est spécifique au type de données.</span><span class="sxs-lookup"><span data-stu-id="32d2f-211">The tessellation scheme is data-type specific.</span></span> <span data-ttu-id="32d2f-212">Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], les index spatiaux prennent en charge deux schémas de pavage :</span><span class="sxs-lookup"><span data-stu-id="32d2f-212">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], spatial indexes support two tessellation schemes:</span></span>

-   <span data-ttu-id="32d2f-213">*Pavage de grille géométrique*, qui est le schéma pour le `geometry` type de données.</span><span class="sxs-lookup"><span data-stu-id="32d2f-213">*Geometry grid tessellation*, which is the scheme for the `geometry` data type.</span></span>

-   <span data-ttu-id="32d2f-214">Le *pavage de grille géographique*, qui s’applique aux colonnes du `geography` type de données.</span><span class="sxs-lookup"><span data-stu-id="32d2f-214">*Geography grid tessellation*, which applies to columns of the `geography` data type.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-215">Le paramètre **tessellation_scheme** d’un index spatial est visible dans l’affichage catalogue [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="32d2f-215">The **tessellation_scheme** setting of a spatial index is visible in the [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) catalog view.</span></span>

#### <a name="geometry-grid-tessellation-scheme"></a><span data-ttu-id="32d2f-216">Schéma de pavage de grille géométrique</span><span class="sxs-lookup"><span data-stu-id="32d2f-216">Geometry Grid Tessellation Scheme</span></span>
 <span data-ttu-id="32d2f-217">Le pavage GEOMETRY_AUTO_GRID est le schéma de pavage par défaut pour le type de données `geometry`, pour [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="32d2f-217">GEOMETRY_AUTO_GRID tessellation is the default tessellation scheme for the `geometry` data type for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and later.</span></span>  <span data-ttu-id="32d2f-218">Le pavage GEOMETRY_GRID est le seul schéma de pavage disponible pour les types de données de géométrie dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="32d2f-218">GEOMETRY_GRID tessellation is the only tessellation scheme available for geometry data types in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="32d2f-219">Cette section traite des aspects du pavage de grille géométrique qui sont pertinents à l'utilisation d'index spatiaux : méthodes prises en charge et zones englobantes.</span><span class="sxs-lookup"><span data-stu-id="32d2f-219">This section discusses aspects of geometry grid tessellation that are relevant to working with spatial indexes: supported methods and bounding boxes.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-220">Vous pouvez spécifier explicitement ce schéma de pavage à l’aide de la clause USING (GEOMETRY_AUTO_GRID/GEOMETRY_GRID) de l’instruction [Create spatial index](/sql/t-sql/statements/create-spatial-index-transact-sql) [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32d2f-220">You can explicitly specify this tessellation scheme by using the USING (GEOMETRY_AUTO_GRID/GEOMETRY_GRID) clause of the [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement.</span></span>

##### <a name="the-bounding-box"></a><span data-ttu-id="32d2f-221">Cadre englobant</span><span class="sxs-lookup"><span data-stu-id="32d2f-221">The Bounding Box</span></span>
 <span data-ttu-id="32d2f-222">Les données géométriques occupent un plan qui peut être infini.</span><span class="sxs-lookup"><span data-stu-id="32d2f-222">Geometric data occupies a plane that can be infinite.</span></span> <span data-ttu-id="32d2f-223">Dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], toutefois, un index spatial requiert un espace fini.</span><span class="sxs-lookup"><span data-stu-id="32d2f-223">In [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], however, a spatial index requires a finite space.</span></span> <span data-ttu-id="32d2f-224">Pour établir un espace fini pour la décomposition, le schéma de pavage de grille géométrique requiert un *cadre englobant*rectangulaire.</span><span class="sxs-lookup"><span data-stu-id="32d2f-224">To establish a finite space for decomposition, the geometry grid tessellation scheme requires a rectangular *bounding box*.</span></span> <span data-ttu-id="32d2f-225">Le cadre englobant est défini par quatre coordonnées, `(` _x-min_**,**_y-min_ `)` et `(` _x-max_**,**_y-max_, `)` qui sont stockées en tant que propriétés de l’index spatial.</span><span class="sxs-lookup"><span data-stu-id="32d2f-225">The bounding box is defined by four coordinates, `(`_x-min_**,**_y-min_`)` and `(`_x-max_**,**_y-max_`)`, which are stored as properties of the spatial index.</span></span> <span data-ttu-id="32d2f-226">Ces coordonnées représentent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="32d2f-226">These coordinates represent the following:</span></span>

-   <span data-ttu-id="32d2f-227">*x-min* est la coordonnée x de l’angle inférieur gauche du cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-227">*x-min* is the x-coordinate of the lower-left corner of the bounding box.</span></span>

-   <span data-ttu-id="32d2f-228">*y-min* est la coordonnée y de l’angle inférieur gauche.</span><span class="sxs-lookup"><span data-stu-id="32d2f-228">*y-min* is the y-coordinate of the lower-left corner.</span></span>

-   <span data-ttu-id="32d2f-229">*x-max* est la coordonnée x de l’angle supérieur droit.</span><span class="sxs-lookup"><span data-stu-id="32d2f-229">*x-max* is the x-coordinate of the upper-right corner.</span></span>

-   <span data-ttu-id="32d2f-230">*x-max* est la coordonnée y de l’angle supérieur droit.</span><span class="sxs-lookup"><span data-stu-id="32d2f-230">*y-max* is the y-coordinate of upper-right corner.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-231">Ces coordonnées sont spécifiées par la clause BOUNDING_BOX de l’instruction [Create spatial index](/sql/t-sql/statements/create-spatial-index-transact-sql) [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32d2f-231">These coordinates are specified by the BOUNDING_BOX clause of the [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement.</span></span>

 <span data-ttu-id="32d2f-232">Les `(` coordonnées _x-min_**,**_y-min_ `)` et `(` _x-max_**,**_y-max_ `)` déterminent la position et les dimensions du cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-232">The `(`_x-min_**,**_y-min_`)` and `(`_x-max_**,**_y-max_`)` coordinates determine the placement and dimensions of the bounding box.</span></span> <span data-ttu-id="32d2f-233">L'espace en dehors du cadre englobant est traité comme une cellule unique affectée du numéro 0.</span><span class="sxs-lookup"><span data-stu-id="32d2f-233">The space outside of the bounding box is treated as a single cell that is numbered 0.</span></span>

 <span data-ttu-id="32d2f-234">L'index spatial décompose l'espace à l'intérieur du cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-234">The spatial index decomposes the space inside the bounding box.</span></span> <span data-ttu-id="32d2f-235">La grille de niveau 1 de la hiérarchie de grille remplit le cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-235">The level-1 grid of the grid hierarchy fills the bounding box.</span></span> <span data-ttu-id="32d2f-236">Pour placer un objet géométrique dans la hiérarchie de grille, l'index spatial compare les coordonnées de l'objet à celles du cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-236">To place a geometric object in the grid hierarchy, the spatial index compares the coordinates of the object to the bounding-box coordinates.</span></span>

 <span data-ttu-id="32d2f-237">L’illustration suivante montre les points définis par les `(` coordonnées _x-min_**,**_y-min_ `)` et `(` _x-max_**,**_y-max_ `)` du cadre englobant.</span><span class="sxs-lookup"><span data-stu-id="32d2f-237">The following illustration shows the points defined by the `(`_x-min_**,**_y-min_`)` and `(`_x-max_**,**_y-max_`)` coordinates of the bounding box.</span></span> <span data-ttu-id="32d2f-238">Le niveau supérieur de la hiérarchie de grille est illustré comme une grille 4x4.</span><span class="sxs-lookup"><span data-stu-id="32d2f-238">The top-level of the grid hierarchy is shown as a 4x4 grid.</span></span> <span data-ttu-id="32d2f-239">À des fins d'illustration, les niveaux inférieurs sont omis.</span><span class="sxs-lookup"><span data-stu-id="32d2f-239">For the purpose of illustration, the lower levels are omitted.</span></span> <span data-ttu-id="32d2f-240">L'espace en dehors de la zone englobante est indiqué par un zéro (0).</span><span class="sxs-lookup"><span data-stu-id="32d2f-240">The space outside of the bounding box is indicated by a zero (0).</span></span> <span data-ttu-id="32d2f-241">Notez que l'objet 'A' s'étend en partie au-delà du cadre et que l'objet 'B' se trouve complètement à l'extérieur du cadre dans la cellule 0.</span><span class="sxs-lookup"><span data-stu-id="32d2f-241">Note that object 'A' extends partly beyond the box, and object 'B' lies completely outside the box in cell 0.</span></span>

 <span data-ttu-id="32d2f-242">![Rectangle englobant affichant les coordonnées et la cellule 0.](../../database-engine/media/spndx-bb-4x4-objects.gif "Rectangle englobant affichant les coordonnées et la cellule 0.")</span><span class="sxs-lookup"><span data-stu-id="32d2f-242">![Bounding box showing coordinates and cell 0.](../../database-engine/media/spndx-bb-4x4-objects.gif "Bounding box showing coordinates and cell 0.")</span></span>

 <span data-ttu-id="32d2f-243">Un cadre englobant correspond à une partie des données spatiales d'une application.</span><span class="sxs-lookup"><span data-stu-id="32d2f-243">A bounding box corresponds to some portion of an application's spatial data.</span></span> <span data-ttu-id="32d2f-244">Le fait que le cadre englobant de l'index contienne toutes les données stockées dans la colonne spatiale ou uniquement une partie d'entre elles dépend de l'application.</span><span class="sxs-lookup"><span data-stu-id="32d2f-244">Whether the bounding-box of the index completely contains the data stored in the spatial column, or only contains a portion, is up to the application.</span></span> <span data-ttu-id="32d2f-245">Seules les opérations calculées sur des objets qui sont entièrement à l'intérieur du cadre englobant tirent parti de l'index spatial.</span><span class="sxs-lookup"><span data-stu-id="32d2f-245">Only operations computed on objects that are entirely inside of the bounding box benefit from the spatial index.</span></span> <span data-ttu-id="32d2f-246">Par conséquent, pour profiter au plus d'un index spatial sur une colonne `geometry`, vous devez spécifier une zone englobante qui contient tous les objets ou la plupart d'entre eux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-246">Therefore, to gain the greatest advantage from a spatial index on a `geometry` column, you need to specify a bounding-box that contains all or most of the objects.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-247">Les densités de grille d’un index spatial sont visibles dans les colonnes bounding_box_xmin, bounding_box_ymin, bounding_box_xmax et bounding_box_ymax de l’affichage catalogue [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="32d2f-247">The grid densities of a spatial index are visible in the bounding_box_xmin, bounding_box_ymin, bounding_box_xmax, and bounding_box_ymax columns of the [sys.spatial_index_tessellations](/sql/relational-databases/system-catalog-views/sys-spatial-index-tessellations-transact-sql) catalog view.</span></span>

#### <a name="the-geography-grid-tessellation-scheme"></a><span data-ttu-id="32d2f-248">Le schéma de pavage de grille géographique</span><span class="sxs-lookup"><span data-stu-id="32d2f-248">The Geography Grid Tessellation Scheme</span></span>
 <span data-ttu-id="32d2f-249">Ce schéma de pavage s'applique uniquement à une colonne `geography`.</span><span class="sxs-lookup"><span data-stu-id="32d2f-249">This tessellation scheme applies only to a `geography` column.</span></span> <span data-ttu-id="32d2f-250">Cette section résume les méthodes qui sont prises en charge par le pavage de grille géographique et discute de la manière dont l'espace géodésique est projeté sur un plan, qui est ensuite décomposé en une hiérarchie de grille.</span><span class="sxs-lookup"><span data-stu-id="32d2f-250">This section summarizes the methods that are supported by geography grid tessellation and discusses how geodetic space is projected onto a plane, which is then decomposed into a grid hierarchy.</span></span>

> [!NOTE]
>  <span data-ttu-id="32d2f-251">Vous pouvez spécifier explicitement ce schéma de pavage à l’aide de la clause USING (GEOGRAPHY_AUTO_GRID/GEOGRAPHY_GRID) de l’instruction [Create spatial index](/sql/t-sql/statements/create-spatial-index-transact-sql) [!INCLUDE[tsql](../../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="32d2f-251">You can explicitly specify this tessellation scheme by using the USING (GEOGRAPHY_AUTO_GRID/GEOGRAPHY_GRID) clause of the [CREATE SPATIAL INDEX](/sql/t-sql/statements/create-spatial-index-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement.</span></span>

##### <a name="projection-of-the-geodetic-space-onto-a-plane"></a><span data-ttu-id="32d2f-252">Projection de l'espace géodésique sur un plan</span><span class="sxs-lookup"><span data-stu-id="32d2f-252">Projection of the Geodetic Space onto a Plane</span></span>
 <span data-ttu-id="32d2f-253">Les calculs sur les instances (objets) `geography` traitent l'espace qui contient les objets comme une ellipsoïde géodésique.</span><span class="sxs-lookup"><span data-stu-id="32d2f-253">Computations on `geography` instances (objects) treat the space containing the objects as a geodetic ellipsoid.</span></span> <span data-ttu-id="32d2f-254">Pour décomposer cet espace, le schéma de pavage de grille géographique divise la surface de l'ellipsoïde en ses hémisphères supérieur et inférieur puis effectue les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="32d2f-254">To decompose this space, the geography grid tessellation scheme divides the surface of the ellipsoid into its upper and lower hemispheres and then performs the following steps:</span></span>

1.  <span data-ttu-id="32d2f-255">Projection de chaque hémisphère sur les facettes d'une pyramide quadrilatère.</span><span class="sxs-lookup"><span data-stu-id="32d2f-255">Projects each hemisphere onto the facets of a quadrilateral pyramid.</span></span>

2.  <span data-ttu-id="32d2f-256">Aplatissement des deux pyramides.</span><span class="sxs-lookup"><span data-stu-id="32d2f-256">Flattens the two pyramids.</span></span>

3.  <span data-ttu-id="32d2f-257">Jointure des pyramides aplaties pour former un plan non Euclidien.</span><span class="sxs-lookup"><span data-stu-id="32d2f-257">Joins the flattened pyramids to form a non-Euclidean plane.</span></span>

 <span data-ttu-id="32d2f-258">L'illustration suivante montre une vue schématique du processus de décomposition en trois étapes.</span><span class="sxs-lookup"><span data-stu-id="32d2f-258">The following illustration shows a schematic view of the three-step decomposition process.</span></span> <span data-ttu-id="32d2f-259">Dans les pyramides, les traits pointillés représentent les limites des quatre facettes de chaque pyramide.</span><span class="sxs-lookup"><span data-stu-id="32d2f-259">In the pyramids, the dotted lines represent the boundaries of the four facets of each pyramid.</span></span> <span data-ttu-id="32d2f-260">Les étapes 1 et 2 illustrent l'ellipsoïde géodésique, avec une ligne horizontale verte pour représenter la ligne de longitude équatoriale et une série de lignes verticales vertes pour représenter plusieurs lignes de latitude.</span><span class="sxs-lookup"><span data-stu-id="32d2f-260">Steps 1 and 2 illustrate the geodetic ellipsoid, using a green horizontal line to represent the equatorial longitude line and a series of green vertical lines to represent several latitude lines.</span></span> <span data-ttu-id="32d2f-261">L'étape 1 illustre la projection des pyramides sur les deux hémisphères.</span><span class="sxs-lookup"><span data-stu-id="32d2f-261">Step 1 shows the pyramids being projected over the two hemispheres.</span></span> <span data-ttu-id="32d2f-262">L'étape 2 illustre l'aplatissement des pyramides.</span><span class="sxs-lookup"><span data-stu-id="32d2f-262">Step 2 shows the pyramids being flattened.</span></span> <span data-ttu-id="32d2f-263">L'étape 3 illustre les pyramides aplaties, après qu'elles ont été combinées de façon à former un plan, avec plusieurs lignes de longitude projetées.</span><span class="sxs-lookup"><span data-stu-id="32d2f-263">Step 3 illustrates the flattened pyramids, after they have been combined to form a plane, showing a number of projected longitude lines.</span></span> <span data-ttu-id="32d2f-264">Remarquez que ces lignes projetées sont tendues et que leur longueur varie en fonction de l'emplacement où elles sont sur les pyramides.</span><span class="sxs-lookup"><span data-stu-id="32d2f-264">Notice that these projected lines are straightened and vary in length, depending on where they fall on the pyramids.</span></span>

 <span data-ttu-id="32d2f-265">![Projection de l'ellipsoïde sur un plan](../../database-engine/media/spndx-geodetic-projection.gif "Projection de l'ellipsoïde sur un plan")</span><span class="sxs-lookup"><span data-stu-id="32d2f-265">![Projection of the ellipsoid onto a plane](../../database-engine/media/spndx-geodetic-projection.gif "Projection of the ellipsoid onto a plane")</span></span>

 <span data-ttu-id="32d2f-266">Une fois l'espace projeté sur le plan, celui-ci est décomposé en une hiérarchie de grille à quatre niveaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-266">Once the space has been projected onto the plane, the plane is decomposed into the four-level grid hierarchy.</span></span> <span data-ttu-id="32d2f-267">Différents niveaux peuvent utiliser différentes densités de grille.</span><span class="sxs-lookup"><span data-stu-id="32d2f-267">Different levels can use different grid densities.</span></span> <span data-ttu-id="32d2f-268">L'illustration suivante montre le plan après qu'il a été décomposé en une grille 4x4 de niveau 1.</span><span class="sxs-lookup"><span data-stu-id="32d2f-268">The following illustration shows the plane after it has been decomposed into a 4x4 level-1 grid.</span></span> <span data-ttu-id="32d2f-269">À des fins d'illustration, les niveaux inférieurs de la hiérarchie de grille sont omis.</span><span class="sxs-lookup"><span data-stu-id="32d2f-269">For the purposes of illustration, the lower-levels of the grid hierarchy are omitted.</span></span> <span data-ttu-id="32d2f-270">En réalité, le plan est décomposé entièrement en une hiérarchie de grille à quatre niveaux.</span><span class="sxs-lookup"><span data-stu-id="32d2f-270">In actuality, the plane is fully decomposed into a four-level grid hierarchy.</span></span> <span data-ttu-id="32d2f-271">Une fois le processus de décomposition terminé, les données géographiques sont lues, ligne par ligne, à partir de la colonne géographique et le processus de pavage est effectué pour chaque objet l'un après l'autre.</span><span class="sxs-lookup"><span data-stu-id="32d2f-271">After the decomposition process finishes, the geographic data is read, row by row, from the geography column, and the tessellation process is performed for each object in turn.</span></span>

 <span data-ttu-id="32d2f-272">![Grille géographique de niveau 1](../../database-engine/media/spndx-geodetic-level1grid.gif "Grille géographique de niveau 1")</span><span class="sxs-lookup"><span data-stu-id="32d2f-272">![Level-1 geography grid](../../database-engine/media/spndx-geodetic-level1grid.gif "Level-1 geography grid")</span></span>

##  <a name="methods-supported-by-spatial-indexes"></a><a name="methods"></a><span data-ttu-id="32d2f-273">Méthodes prises en charge par les index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-273">Methods Supported by Spatial Indexes</span></span>

###  <a name="geometry-methods-supported-by-spatial-indexes"></a><a name="geometry"></a><span data-ttu-id="32d2f-274">Méthodes géométriques prises en charge par les index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-274">Geometry Methods Supported by Spatial Indexes</span></span>
 <span data-ttu-id="32d2f-275">Les index spatiaux prennent en charge les méthodes géométriques suivantes basées sur les ensembles sous certaines conditions : STContains(), STDistance(), STEquals(), STIntersects(), STOverlaps(), STTouches() et STWithin().</span><span class="sxs-lookup"><span data-stu-id="32d2f-275">Spatial indexes support the following set-oriented geometry methods under certain conditions: STContains(), STDistance(), STEquals(), STIntersects(), STOverlaps(), STTouches(), and STWithin().</span></span> <span data-ttu-id="32d2f-276">Pour être prises en charge par un index spatial, ces méthodes doivent être utilisées dans la clause WHERE ou JOIN ON d'une requête et elles doivent se produire dans un prédicat de la forme générale suivante :</span><span class="sxs-lookup"><span data-stu-id="32d2f-276">To be supported by a spatial index, these methods must be used within the WHERE or JOIN ON clause of a query, and they must occur within a predicate of the following general form:</span></span>

 <span data-ttu-id="32d2f-277">*Geometry1*. *method_name*(*Geometry2*)*comparison_operator \* \* valid_number*</span><span class="sxs-lookup"><span data-stu-id="32d2f-277">*geometry1*.*method_name*(*geometry2*)*comparison_operator\*\*valid_number*</span></span>

 <span data-ttu-id="32d2f-278">Pour retourner un résultat non Null, *geometry1* et *geometry2* doivent avoir le même [identificateur de référence spatiale (SRID)](../spatial/spatial-reference-identifiers-srids.md).</span><span class="sxs-lookup"><span data-stu-id="32d2f-278">To return a non-null result, *geometry1* and *geometry2* must have the same [spatial reference identifier (SRID)](../spatial/spatial-reference-identifiers-srids.md).</span></span> <span data-ttu-id="32d2f-279">Sinon, la méthode renvoie NULL.</span><span class="sxs-lookup"><span data-stu-id="32d2f-279">Otherwise, the method returns NULL.</span></span>

 <span data-ttu-id="32d2f-280">Les index spatiaux prennent en charge les formes de prédicat suivantes :</span><span class="sxs-lookup"><span data-stu-id="32d2f-280">Spatial indexes support the following predicate forms:</span></span>

-   <span data-ttu-id="32d2f-281">*geometry1*.[STContains](/sql/t-sql/spatial-geometry/stcontains-geometry-data-type)(*geometry2*) = 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-281">*geometry1*.[STContains](/sql/t-sql/spatial-geometry/stcontains-geometry-data-type)(*geometry2*) = 1</span></span>

-   <span data-ttu-id="32d2f-282">*Geometry1*. [STDistance](/sql/t-sql/spatial-geometry/stdistance-geometry-data-type)(*Geometry2*) < *nombre*</span><span class="sxs-lookup"><span data-stu-id="32d2f-282">*geometry1*.[STDistance](/sql/t-sql/spatial-geometry/stdistance-geometry-data-type)(*geometry2*) < *number*</span></span>

-   <span data-ttu-id="32d2f-283">*geometry1*.[STDistance](/sql/t-sql/spatial-geometry/stdistance-geometry-data-type)(*geometry2*) <= *nombre*</span><span class="sxs-lookup"><span data-stu-id="32d2f-283">*geometry1*.[STDistance](/sql/t-sql/spatial-geometry/stdistance-geometry-data-type)(*geometry2*) <= *number*</span></span>

-   <span data-ttu-id="32d2f-284">*geometry1*.[STEquals](/sql/t-sql/spatial-geometry/stequals-geometry-data-type)(*geometry2*)= 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-284">*geometry1*.[STEquals](/sql/t-sql/spatial-geometry/stequals-geometry-data-type)(*geometry2*)= 1</span></span>

-   <span data-ttu-id="32d2f-285">*geometry1*.[STIntersects](/sql/t-sql/spatial-geometry/stintersects-geometry-data-type)(*geometry2*)= 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-285">*geometry1*.[STIntersects](/sql/t-sql/spatial-geometry/stintersects-geometry-data-type)(*geometry2*)= 1</span></span>

-   <span data-ttu-id="32d2f-286">*geometry1.*</span><span class="sxs-lookup"><span data-stu-id="32d2f-286">*geometry1.*</span></span> <span data-ttu-id="32d2f-287">[STOverlaps](/sql/t-sql/spatial-geometry/stoverlaps-geometry-data-type) *(geometry2) = 1*</span><span class="sxs-lookup"><span data-stu-id="32d2f-287">[STOverlaps](/sql/t-sql/spatial-geometry/stoverlaps-geometry-data-type) *(geometry2) = 1*</span></span>

-   <span data-ttu-id="32d2f-288">*geometry1*.[STTouches](/sql/t-sql/spatial-geometry/sttouches-geometry-data-type)(*geometry2*) = 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-288">*geometry1*.[STTouches](/sql/t-sql/spatial-geometry/sttouches-geometry-data-type)(*geometry2*) = 1</span></span>

-   <span data-ttu-id="32d2f-289">*geometry1*.[STWithin](/sql/t-sql/spatial-geometry/stwithin-geometry-data-type)(*geometry2*)= 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-289">*geometry1*.[STWithin](/sql/t-sql/spatial-geometry/stwithin-geometry-data-type)(*geometry2*)= 1</span></span>

###  <a name="geography-methods-supported-by-spatial-indexes"></a><a name="geography"></a><span data-ttu-id="32d2f-290">Méthodes géographiques prises en charge par les index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-290">Geography Methods Supported by Spatial Indexes</span></span>
 <span data-ttu-id="32d2f-291">Sous certaines conditions, les index spatiaux prennent en charge les méthodes géographiques suivantes basées sur les ensembles : STIntersects(),STEquals(), and STDistance().</span><span class="sxs-lookup"><span data-stu-id="32d2f-291">Under certain conditions, spatial indexes support the following set-oriented geography methods: STIntersects(),STEquals(), and STDistance().</span></span> <span data-ttu-id="32d2f-292">Pour être prises en charge par un index spatial, ces méthodes doivent être utilisées dans la clause WHERE d'une requête et elles doivent se produire dans un prédicat de la forme générale suivante :</span><span class="sxs-lookup"><span data-stu-id="32d2f-292">To be supported by a spatial index, these methods must be used within the WHERE clause of a query, and they must occur within a predicate of the following general form:</span></span>

 <span data-ttu-id="32d2f-293">*geography1*. *method_name*(*geography2*)*comparison_operator \* \* valid_number*</span><span class="sxs-lookup"><span data-stu-id="32d2f-293">*geography1*.*method_name*(*geography2*)*comparison_operator\*\*valid_number*</span></span>

 <span data-ttu-id="32d2f-294">Pour retourner un résultat non Null, *geography1* et *geography2* doivent avoir le même [identificateur de référence spatiale (SRID)](../spatial/spatial-reference-identifiers-srids.md).</span><span class="sxs-lookup"><span data-stu-id="32d2f-294">To return a non-null result, *geography1* and *geography2* must have the same [Spatial Reference Identifier (SRID)](../spatial/spatial-reference-identifiers-srids.md).</span></span> <span data-ttu-id="32d2f-295">Sinon, la méthode renvoie NULL.</span><span class="sxs-lookup"><span data-stu-id="32d2f-295">Otherwise, the method returns NULL.</span></span>

 <span data-ttu-id="32d2f-296">Les index spatiaux prennent en charge les formes de prédicat suivantes :</span><span class="sxs-lookup"><span data-stu-id="32d2f-296">Spatial indexes support the following predicate forms:</span></span>

-   <span data-ttu-id="32d2f-297">*geography1*.[STIntersects](/sql/t-sql/spatial-geography/stintersects-geography-data-type)(*geography2*)= 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-297">*geography1*.[STIntersects](/sql/t-sql/spatial-geography/stintersects-geography-data-type)(*geography2*)= 1</span></span>

-   <span data-ttu-id="32d2f-298">*geography1*.[STEquals](/sql/t-sql/spatial-geography/stequals-geography-data-type)(*geography2*)= 1</span><span class="sxs-lookup"><span data-stu-id="32d2f-298">*geography1*.[STEquals](/sql/t-sql/spatial-geography/stequals-geography-data-type)(*geography2*)= 1</span></span>

-   <span data-ttu-id="32d2f-299">*geography1*. [STDistance](/sql/t-sql/spatial-geography/stdistance-geography-data-type)(*geography2*) < *nombre*</span><span class="sxs-lookup"><span data-stu-id="32d2f-299">*geography1*.[STDistance](/sql/t-sql/spatial-geography/stdistance-geography-data-type)(*geography2*) < *number*</span></span>

-   <span data-ttu-id="32d2f-300">*geography1*.[STDistance](/sql/t-sql/spatial-geography/stdistance-geography-data-type)(*geography2*) <= *nombre*</span><span class="sxs-lookup"><span data-stu-id="32d2f-300">*geography1*.[STDistance](/sql/t-sql/spatial-geography/stdistance-geography-data-type)(*geography2*) <= *number*</span></span>

### <a name="queries-that-use-spatial-indexes"></a><span data-ttu-id="32d2f-301">Requêtes qui utilisent des index spatiaux</span><span class="sxs-lookup"><span data-stu-id="32d2f-301">Queries that use Spatial Indexes</span></span>
 <span data-ttu-id="32d2f-302">Les index spatiaux sont pris en charge uniquement dans les requêtes qui comprennent un opérateur spatial indexé dans la clause `WHERE`.</span><span class="sxs-lookup"><span data-stu-id="32d2f-302">Spatial indexes are only supported in queries that include an indexed spatial operator in the `WHERE` clause.</span></span> <span data-ttu-id="32d2f-303">Par exemple, la syntaxe :</span><span class="sxs-lookup"><span data-stu-id="32d2f-303">For example syntax such as:</span></span>

```
[spatial object].SpatialMethod([reference spatial object]) [ = | < ] [const literal or variable]
```

 <span data-ttu-id="32d2f-304">L'optimiseur de requête comprend la propriété commutative des opérations spatiales ( `@a.STIntersects(@b) = @b.STInterestcs(@a)` ).</span><span class="sxs-lookup"><span data-stu-id="32d2f-304">The query optimizer understands the commutativity of spatial operations (that `@a.STIntersects(@b) = @b.STInterestcs(@a)` ).</span></span> <span data-ttu-id="32d2f-305">Toutefois, l'index spatial ne sera pas utilisé si le début de la comparaison ne contient pas l'opérateur spatial (par exemple `WHERE 1 = spatial op` n'utilise pas l'index spatial).</span><span class="sxs-lookup"><span data-stu-id="32d2f-305">However, the spatial index will not be used if the beginning of a comparison does not contain the spatial operator (for example `WHERE 1 = spatial op` will not use the spatial index).</span></span> <span data-ttu-id="32d2f-306">Pour utiliser l'index spatial, réécrivez la comparaison (par exemple `WHERE spatial op = 1`).</span><span class="sxs-lookup"><span data-stu-id="32d2f-306">To use the spatial index, rewrite the comparison (for example `WHERE spatial op = 1`).</span></span>

 <span data-ttu-id="32d2f-307">Comme pour tout autre index, lorsqu'un index spatial est pris en charge, l'utilisation de l'index spatial sélectionné dépend du coût, par conséquent l'optimiseur de requête peut choisir de ne pas utiliser l'index spatial même si toutes les spécifications d'utilisation de ce dernier sont remplies.</span><span class="sxs-lookup"><span data-stu-id="32d2f-307">As with any other index, when a spatial index is supported, the use of the spatial index is chosen based on cost, so the query optimizer might not choose to use the spatial index even though all requirements for using it are met.</span></span> <span data-ttu-id="32d2f-308">Utilisez le plan d'exécution de requêtes pour déterminer si l'index spatial est utilisé et, si nécessaire, pour fournir des indicateurs de requête pour forcer un plan de requête désiré.</span><span class="sxs-lookup"><span data-stu-id="32d2f-308">Use showplan to see if the spatial index was used and if necessary provide query hints to force a desired query plan.</span></span>

 <span data-ttu-id="32d2f-309">Le type de requête voisin le plus proche prend également en charge les index spatiaux, mais uniquement si une syntaxe spécifique de requête est écrite.</span><span class="sxs-lookup"><span data-stu-id="32d2f-309">The nearest neighbor type of query also supports spatial indexes however only if a specific query syntax is written.</span></span> <span data-ttu-id="32d2f-310">La syntaxe appropriée est :</span><span class="sxs-lookup"><span data-stu-id="32d2f-310">The appropriate syntax is:</span></span>

```
SELECT TOP(K) [WITH TIES] * 
FROM <Table> AS T [WITH(INDEX(<SpatialIndex>))]
WHERE <SpatialColumn>.STDistance(@reference_object) IS NOT NULL
ORDER BY <SpatialColumn>.STDistance(@reference_object) [;]
```

## <a name="see-also"></a><span data-ttu-id="32d2f-311">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="32d2f-311">See Also</span></span>
 [<span data-ttu-id="32d2f-312">Données spatiales &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="32d2f-312">Spatial Data &#40;SQL Server&#41;</span></span>](../spatial/spatial-data-sql-server.md)


