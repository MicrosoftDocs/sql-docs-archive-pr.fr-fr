---
title: Conversions de SQL en C | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], SQL to C
ms.assetid: 059431e2-a65c-4587-ba4a-9929a1611e96
author: rothja
ms.author: jroth
ms.openlocfilehash: 0cc1fe6049824217a12a291b7006599a4a3a7319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612285"
---
# <a name="conversions-from-sql-to-c"></a><span data-ttu-id="34c86-102">Conversions de SQL à C</span><span class="sxs-lookup"><span data-stu-id="34c86-102">Conversions from SQL to C</span></span>
  <span data-ttu-id="34c86-103">Le tableau suivant répertorie les aspects à prendre en compte lorsque vous effectuez une conversion de types date/heure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en types C.</span><span class="sxs-lookup"><span data-stu-id="34c86-103">The following table lists issues to consider when you convert from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types to C types.</span></span>  
  
## <a name="conversions"></a><span data-ttu-id="34c86-104">Conversions</span><span class="sxs-lookup"><span data-stu-id="34c86-104">Conversions</span></span>  
  
||||||||||  
|-|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="34c86-105">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="34c86-105">SQL_C_DATE</span></span>|<span data-ttu-id="34c86-106">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="34c86-106">SQL_C_TIME</span></span>|<span data-ttu-id="34c86-107">SQL_C_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="34c86-107">SQL_C_TIMESTAMP</span></span>|<span data-ttu-id="34c86-108">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="34c86-108">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="34c86-109">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="34c86-109">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="34c86-110">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="34c86-110">SQL_C_BINARY</span></span>|<span data-ttu-id="34c86-111">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="34c86-111">SQL_C_CHAR</span></span>|<span data-ttu-id="34c86-112">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="34c86-112">SQL_C_WCHAR</span></span>|  
|<span data-ttu-id="34c86-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="34c86-113">SQL_CHAR</span></span>|<span data-ttu-id="34c86-114">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="34c86-114">2,3,4,5</span></span>|<span data-ttu-id="34c86-115">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="34c86-115">2,3,6,7,8</span></span>|<span data-ttu-id="34c86-116">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="34c86-116">2,3,9,10,11</span></span>|<span data-ttu-id="34c86-117">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="34c86-117">2,3,6,7</span></span>|<span data-ttu-id="34c86-118">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="34c86-118">2,3,9,10,11</span></span>|<span data-ttu-id="34c86-119">1</span><span class="sxs-lookup"><span data-stu-id="34c86-119">1</span></span>|<span data-ttu-id="34c86-120">1</span><span class="sxs-lookup"><span data-stu-id="34c86-120">1</span></span>|<span data-ttu-id="34c86-121">1</span><span class="sxs-lookup"><span data-stu-id="34c86-121">1</span></span>|  
|<span data-ttu-id="34c86-122">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="34c86-122">SQL_WCHAR</span></span>|<span data-ttu-id="34c86-123">2, 3, 4, 5</span><span class="sxs-lookup"><span data-stu-id="34c86-123">2,3,4,5</span></span>|<span data-ttu-id="34c86-124">2, 3, 6, 7, 8</span><span class="sxs-lookup"><span data-stu-id="34c86-124">2,3,6,7,8</span></span>|<span data-ttu-id="34c86-125">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="34c86-125">2,3,9,10,11</span></span>|<span data-ttu-id="34c86-126">2, 3, 6, 7</span><span class="sxs-lookup"><span data-stu-id="34c86-126">2,3,6,7</span></span>|<span data-ttu-id="34c86-127">2, 3, 9, 10, 11</span><span class="sxs-lookup"><span data-stu-id="34c86-127">2,3,9,10,11</span></span>|<span data-ttu-id="34c86-128">1</span><span class="sxs-lookup"><span data-stu-id="34c86-128">1</span></span>|<span data-ttu-id="34c86-129">1</span><span class="sxs-lookup"><span data-stu-id="34c86-129">1</span></span>|<span data-ttu-id="34c86-130">1</span><span class="sxs-lookup"><span data-stu-id="34c86-130">1</span></span>|  
|<span data-ttu-id="34c86-131">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="34c86-131">SQL_TYPE_DATE</span></span>|<span data-ttu-id="34c86-132">OK</span><span class="sxs-lookup"><span data-stu-id="34c86-132">OK</span></span>|<span data-ttu-id="34c86-133">12</span><span class="sxs-lookup"><span data-stu-id="34c86-133">12</span></span>|<span data-ttu-id="34c86-134">13</span><span class="sxs-lookup"><span data-stu-id="34c86-134">13</span></span>|<span data-ttu-id="34c86-135">12</span><span class="sxs-lookup"><span data-stu-id="34c86-135">12</span></span>|<span data-ttu-id="34c86-136">13, 23</span><span class="sxs-lookup"><span data-stu-id="34c86-136">13,23</span></span>|<span data-ttu-id="34c86-137">14</span><span class="sxs-lookup"><span data-stu-id="34c86-137">14</span></span>|<span data-ttu-id="34c86-138">16</span><span class="sxs-lookup"><span data-stu-id="34c86-138">16</span></span>|<span data-ttu-id="34c86-139">16</span><span class="sxs-lookup"><span data-stu-id="34c86-139">16</span></span>|  
|<span data-ttu-id="34c86-140">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="34c86-140">SQL_SS_TIME2</span></span>|<span data-ttu-id="34c86-141">12</span><span class="sxs-lookup"><span data-stu-id="34c86-141">12</span></span>|<span data-ttu-id="34c86-142">8</span><span class="sxs-lookup"><span data-stu-id="34c86-142">8</span></span>|<span data-ttu-id="34c86-143">15</span><span class="sxs-lookup"><span data-stu-id="34c86-143">15</span></span>|<span data-ttu-id="34c86-144">OK</span><span class="sxs-lookup"><span data-stu-id="34c86-144">OK</span></span>|<span data-ttu-id="34c86-145">10, 23</span><span class="sxs-lookup"><span data-stu-id="34c86-145">10,23</span></span>|<span data-ttu-id="34c86-146">17</span><span class="sxs-lookup"><span data-stu-id="34c86-146">17</span></span>|<span data-ttu-id="34c86-147">16</span><span class="sxs-lookup"><span data-stu-id="34c86-147">16</span></span>|<span data-ttu-id="34c86-148">16</span><span class="sxs-lookup"><span data-stu-id="34c86-148">16</span></span>|  
|<span data-ttu-id="34c86-149">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="34c86-149">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="34c86-150">18</span><span class="sxs-lookup"><span data-stu-id="34c86-150">18</span></span>|<span data-ttu-id="34c86-151">7, 8</span><span class="sxs-lookup"><span data-stu-id="34c86-151">7,8</span></span>|<span data-ttu-id="34c86-152">OK</span><span class="sxs-lookup"><span data-stu-id="34c86-152">OK</span></span>|<span data-ttu-id="34c86-153">7</span><span class="sxs-lookup"><span data-stu-id="34c86-153">7</span></span>|<span data-ttu-id="34c86-154">23</span><span class="sxs-lookup"><span data-stu-id="34c86-154">23</span></span>|<span data-ttu-id="34c86-155">19</span><span class="sxs-lookup"><span data-stu-id="34c86-155">19</span></span>|<span data-ttu-id="34c86-156">16</span><span class="sxs-lookup"><span data-stu-id="34c86-156">16</span></span>|<span data-ttu-id="34c86-157">16</span><span class="sxs-lookup"><span data-stu-id="34c86-157">16</span></span>|  
|<span data-ttu-id="34c86-158">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="34c86-158">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="34c86-159">18, 22</span><span class="sxs-lookup"><span data-stu-id="34c86-159">18,22</span></span>|<span data-ttu-id="34c86-160">7, 8, 20</span><span class="sxs-lookup"><span data-stu-id="34c86-160">7,8,20</span></span>|<span data-ttu-id="34c86-161">20</span><span class="sxs-lookup"><span data-stu-id="34c86-161">20</span></span>|<span data-ttu-id="34c86-162">7, 20</span><span class="sxs-lookup"><span data-stu-id="34c86-162">7,20</span></span>|<span data-ttu-id="34c86-163">OK</span><span class="sxs-lookup"><span data-stu-id="34c86-163">OK</span></span>|<span data-ttu-id="34c86-164">21</span><span class="sxs-lookup"><span data-stu-id="34c86-164">21</span></span>|<span data-ttu-id="34c86-165">16</span><span class="sxs-lookup"><span data-stu-id="34c86-165">16</span></span>|<span data-ttu-id="34c86-166">16</span><span class="sxs-lookup"><span data-stu-id="34c86-166">16</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="34c86-167">Liste des symboles</span><span class="sxs-lookup"><span data-stu-id="34c86-167">Key to Symbols</span></span>  
  
|<span data-ttu-id="34c86-168">Symbole</span><span class="sxs-lookup"><span data-stu-id="34c86-168">Symbol</span></span>|<span data-ttu-id="34c86-169">Signification</span><span class="sxs-lookup"><span data-stu-id="34c86-169">Meaning</span></span>|  
|------------|-------------|  
|<span data-ttu-id="34c86-170">OK</span><span class="sxs-lookup"><span data-stu-id="34c86-170">OK</span></span>|<span data-ttu-id="34c86-171">Aucun problème de conversion.</span><span class="sxs-lookup"><span data-stu-id="34c86-171">No conversion issues.</span></span>|  
|<span data-ttu-id="34c86-172">1</span><span class="sxs-lookup"><span data-stu-id="34c86-172">1</span></span>|<span data-ttu-id="34c86-173">Les règles antérieures à [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] s'appliquent.</span><span class="sxs-lookup"><span data-stu-id="34c86-173">Rules prior to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] apply.</span></span>|  
|<span data-ttu-id="34c86-174">2</span><span class="sxs-lookup"><span data-stu-id="34c86-174">2</span></span>|<span data-ttu-id="34c86-175">Les espaces de début et de fin sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="34c86-175">Leading and trailing spaces are ignored.</span></span>|  
|<span data-ttu-id="34c86-176">3</span><span class="sxs-lookup"><span data-stu-id="34c86-176">3</span></span>|<span data-ttu-id="34c86-177">La chaîne est analysée en date, time, timezone ou timezoneoffset et autorise jusqu'à neuf chiffres pour les fractions de seconde.</span><span class="sxs-lookup"><span data-stu-id="34c86-177">The string is parsed into a date, time, timezone, or timezoneoffset, and allows up to 9 digits for fractional seconds.</span></span> <span data-ttu-id="34c86-178">Si un timezoneoffset est analysé, l'heure est convertie en fuseau horaire du client.</span><span class="sxs-lookup"><span data-stu-id="34c86-178">If a timezoneoffset is parsed, the time is converted to the client timezone.</span></span> <span data-ttu-id="34c86-179">Si une erreur se produit pendant cette conversion, un enregistrement de diagnostic est généré avec SQLSTATE 22018 et le message « DateTime Field overflow ».</span><span class="sxs-lookup"><span data-stu-id="34c86-179">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22018 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="34c86-180">4</span><span class="sxs-lookup"><span data-stu-id="34c86-180">4</span></span>|<span data-ttu-id="34c86-181">Si la valeur n'est pas une valeur date, timestamp ou timestampoffset valide, un enregistrement de diagnostic est généré avec SQLSTATE 22018 et le message « Valeur de caractère non valide pour la spécification de la casse ».</span><span class="sxs-lookup"><span data-stu-id="34c86-181">If the value is not a valid date, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="34c86-182">5</span><span class="sxs-lookup"><span data-stu-id="34c86-182">5</span></span>|<span data-ttu-id="34c86-183">Si l'heure n'est pas nulle, un enregistrement de diagnostic est généré avec SQLSTATE 01S07 et le message « Troncation fractionnelle ».</span><span class="sxs-lookup"><span data-stu-id="34c86-183">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="34c86-184">6</span><span class="sxs-lookup"><span data-stu-id="34c86-184">6</span></span>|<span data-ttu-id="34c86-185">Si la valeur n'est pas une valeur time, timestamp ou timestampoffset valide, un enregistrement de diagnostic est généré avec SQLSTATE 22018 et le message « Valeur de caractère non valide pour la spécification de la casse ».</span><span class="sxs-lookup"><span data-stu-id="34c86-185">If the value is not a valid time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="34c86-186">7</span><span class="sxs-lookup"><span data-stu-id="34c86-186">7</span></span>|<span data-ttu-id="34c86-187">Le composant date est ignoré.</span><span class="sxs-lookup"><span data-stu-id="34c86-187">The date component is ignored.</span></span>|  
|<span data-ttu-id="34c86-188">8</span><span class="sxs-lookup"><span data-stu-id="34c86-188">8</span></span>|<span data-ttu-id="34c86-189">Si les fractions de seconde ne sont pas nulles, un enregistrement de diagnostic est généré avec SQLSTATE 01S07 et le message « Troncation fractionnelle ».</span><span class="sxs-lookup"><span data-stu-id="34c86-189">If the fractional seconds are non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="34c86-190">9</span><span class="sxs-lookup"><span data-stu-id="34c86-190">9</span></span>|<span data-ttu-id="34c86-191">Si la valeur n'est pas une valeur date, time, timestamp ou timestampoffset valide, un enregistrement de diagnostic est généré avec SQLSTATE 22018 et le message « Valeur de caractère non valide pour la spécification de la casse ».</span><span class="sxs-lookup"><span data-stu-id="34c86-191">If the value is not a valid date, time, timestamp, or timestampoffset value, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span>|  
|<span data-ttu-id="34c86-192">10</span><span class="sxs-lookup"><span data-stu-id="34c86-192">10</span></span>|<span data-ttu-id="34c86-193">Si la valeur est une heure valide, le composant date est défini à la date actuelle du client.</span><span class="sxs-lookup"><span data-stu-id="34c86-193">If the value is a valid time, the date component is set to current client date.</span></span>|  
|<span data-ttu-id="34c86-194">11</span><span class="sxs-lookup"><span data-stu-id="34c86-194">11</span></span>|<span data-ttu-id="34c86-195">Si la valeur est une date valide, l'heure est définie à zéro.</span><span class="sxs-lookup"><span data-stu-id="34c86-195">If the value is a valid date, the time is set to zero.</span></span>|  
|<span data-ttu-id="34c86-196">12</span><span class="sxs-lookup"><span data-stu-id="34c86-196">12</span></span>|<span data-ttu-id="34c86-197">Un enregistrement de diagnostic est généré avec SQLSTATE 07006 et le message « Violation de l'attribut de type de données restreint ».</span><span class="sxs-lookup"><span data-stu-id="34c86-197">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="34c86-198">13</span><span class="sxs-lookup"><span data-stu-id="34c86-198">13</span></span>|<span data-ttu-id="34c86-199">L'heure est définie avec la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="34c86-199">The time is set to zero.</span></span>|  
|<span data-ttu-id="34c86-200">14</span><span class="sxs-lookup"><span data-stu-id="34c86-200">14</span></span>|<span data-ttu-id="34c86-201">Si la mémoire tampon n'est pas assez grande pour contenir un SQL_DATE_STRUCT, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="34c86-201">If the buffer is not large enough to accommodate a SQL_DATE_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="34c86-202">15</span><span class="sxs-lookup"><span data-stu-id="34c86-202">15</span></span>|<span data-ttu-id="34c86-203">La date est définie à la date actuelle du client.</span><span class="sxs-lookup"><span data-stu-id="34c86-203">The date is set to the current client date.</span></span>|  
|<span data-ttu-id="34c86-204">16</span><span class="sxs-lookup"><span data-stu-id="34c86-204">16</span></span>|<span data-ttu-id="34c86-205">Si la mémoire tampon n'est pas assez grande pour contenir la valeur de chaîne convertie, mais uniquement les fractions de seconde, la troncation se produit et un enregistrement de diagnostic est généré avec SQLSTATE 01004 et le message « Troncation à droite de la chaîne de données ».</span><span class="sxs-lookup"><span data-stu-id="34c86-205">If the buffer is not large enough to accommodate the converted string value but only fractional seconds, truncation occurs and a diagnostic record is generated with SQLSTATE 01004 and the message "String data, right truncated".</span></span> <span data-ttu-id="34c86-206">Si la mémoire tampon n'est pas assez grande pour contenir la valeur de chaîne sans troncation de composants date, time ou offset, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="34c86-206">If the buffer is not large enough to accommodate the string value without truncation of date, time, or offset components, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span> <span data-ttu-id="34c86-207">Notez que pour date et timestampoffset, SQLSTATE 01004 n'est pas possible car la partie la plus à droite de la chaîne convertie ne contient pas de fractions de seconde.</span><span class="sxs-lookup"><span data-stu-id="34c86-207">Note that for date and timestampoffset, SQLSTATE 01004 is not possible because the rightmost part of the converted string does not contain fractional seconds.</span></span> <span data-ttu-id="34c86-208">Par conséquent, toute troncation provoque la perte de données.</span><span class="sxs-lookup"><span data-stu-id="34c86-208">Therefore, any truncation causes data loss.</span></span>|  
|<span data-ttu-id="34c86-209">17</span><span class="sxs-lookup"><span data-stu-id="34c86-209">17</span></span>|<span data-ttu-id="34c86-210">Si la mémoire tampon n'est pas assez grande pour contenir un SQL_SS_TIME2_STRUCT, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="34c86-210">If the buffer is not large enough to accommodate a SQL_SS_TIME2_STRUCT, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="34c86-211">18</span><span class="sxs-lookup"><span data-stu-id="34c86-211">18</span></span>|<span data-ttu-id="34c86-212">Si l'heure n'est pas nulle, un enregistrement de diagnostic est généré avec SQLSTATE 01S07 et le message « Troncation fractionnelle ».</span><span class="sxs-lookup"><span data-stu-id="34c86-212">If the time is non-zero, a diagnostic record is generated with SQLSTATE 01S07 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="34c86-213">19</span><span class="sxs-lookup"><span data-stu-id="34c86-213">19</span></span>|<span data-ttu-id="34c86-214">Si le type de serveur est datetime ou smalldatetime, la valeur correspond au format de câble TDS et sera une valeur de 4 octets pour smalldatetime et une valeur de 8 octets pour datetime.</span><span class="sxs-lookup"><span data-stu-id="34c86-214">If the server type is datetime or smalldatetime, the value corresponds to the TDS wire format and will be a 4-byte value for smalldatetime and an 8-byte value for datetime.</span></span><br /><br /> <span data-ttu-id="34c86-215">Si le type de serveur est datetime2, la valeur est renvoyée en tant que SQL_TIMESTAMP_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="34c86-215">If the server type is datetime2, the value is returned as a SQL_TIMESTAMP_STRUCT.</span></span> <span data-ttu-id="34c86-216">Si la mémoire tampon n'est pas assez grande pour contenir la valeur retournée, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="34c86-216">If the buffer is not large enough to accommodate the returned value, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="34c86-217">20</span><span class="sxs-lookup"><span data-stu-id="34c86-217">20</span></span>|<span data-ttu-id="34c86-218">L'heure est convertie en fuseau horaire du client.</span><span class="sxs-lookup"><span data-stu-id="34c86-218">The time is converted to the client timezone.</span></span> <span data-ttu-id="34c86-219">Si une erreur se produit pendant cette conversion, un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Dépassement de la capacité du champ datetime ».</span><span class="sxs-lookup"><span data-stu-id="34c86-219">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="34c86-220">21</span><span class="sxs-lookup"><span data-stu-id="34c86-220">21</span></span>|<span data-ttu-id="34c86-221">Si la mémoire tampon est assez grande pour contenir un SQL_SS_TIMESTAMPOFFSET_STRUCT, la valeur est renvoyée en tant que SQL_SS_TIMESTAMPOFFSET_STRUCT.</span><span class="sxs-lookup"><span data-stu-id="34c86-221">If the buffer is large enough to accommodate a SQL_SS_TIMESTAMPOFFSET_STRUCT, the value is returned as a SQL_SS_TIMESTAMPOFFSET_STRUCT.</span></span> <span data-ttu-id="34c86-222">Sinon, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="34c86-222">Otherwise, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="34c86-223">22</span><span class="sxs-lookup"><span data-stu-id="34c86-223">22</span></span>|<span data-ttu-id="34c86-224">La valeur est convertie au fuseau horaire du client avant que la date ne soit extraite.</span><span class="sxs-lookup"><span data-stu-id="34c86-224">The value is converted to the client timezone before the date is extracted.</span></span> <span data-ttu-id="34c86-225">Cela procure une cohérence avec les autres conversions avec les types timestampoffset.</span><span class="sxs-lookup"><span data-stu-id="34c86-225">This provides consistency with other conversions with timestampoffset types.</span></span> <span data-ttu-id="34c86-226">Si une erreur se produit pendant cette conversion, un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Dépassement de la capacité du champ datetime ».</span><span class="sxs-lookup"><span data-stu-id="34c86-226">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span> <span data-ttu-id="34c86-227">En conséquence, la date peut différer de la valeur obtenue par simple troncation.</span><span class="sxs-lookup"><span data-stu-id="34c86-227">This might result in a date that differs from the value obtained by simple truncation.</span></span>|  
  
 <span data-ttu-id="34c86-228">Le tableau dans cette rubrique décrit les conversions entre le type retourné au client et le type dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="34c86-228">The table in this topic describes conversions between the type returned to the client and the type in the binding.</span></span> <span data-ttu-id="34c86-229">Pour les paramètres de sortie, si le type de serveur spécifié dans SQLBindParameter ne correspond pas au type réel sur le serveur, une conversion implicite est effectuée par le serveur et le type retourné au client correspond au type spécifié par le biais de SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="34c86-229">For output parameters, if the server type specified in SQLBindParameter does not match the actual type on the server, an implicit conversion will be performed by the server and the type returned to the client will match the type specified through SQLBindParameter.</span></span> <span data-ttu-id="34c86-230">Cela peut entraîner des résultats de conversion inattendus lorsque les règles de conversion du serveur sont différentes de celles répertoriées dans le tableau précédent.</span><span class="sxs-lookup"><span data-stu-id="34c86-230">This can lead to unexpected conversion results when the server's conversion rules are different from those listed in the preceding table.</span></span> <span data-ttu-id="34c86-231">Par exemple, lorsqu'une date par défaut doit être fournie, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] utilise 1900-1-1, plutôt que la date actuelle.</span><span class="sxs-lookup"><span data-stu-id="34c86-231">For example, when a default date must be provided, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] uses 1900-1-1, rather than the current date.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="34c86-232">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="34c86-232">See Also</span></span>  
 [<span data-ttu-id="34c86-233">Améliorations de la date et de l’heure &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="34c86-233">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
