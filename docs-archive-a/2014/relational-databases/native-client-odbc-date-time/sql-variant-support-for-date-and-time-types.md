---
title: Prise en charge sql_variant pour les types de date et d’heure | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- sql_variant data type
ms.assetid: 12ff1ea6-e2cc-40e6-910c-3126974a90b3
author: rothja
ms.author: jroth
ms.openlocfilehash: 0818f0ccee72264ea7cab69b90e18418179031ca
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87706464"
---
# <a name="sql_variant-support-for-date-and-time-types"></a><span data-ttu-id="e2f01-102">Prise en charge de sql_variant pour les types Date et Time</span><span class="sxs-lookup"><span data-stu-id="e2f01-102">sql_variant Support for Date and Time Types</span></span>
  <span data-ttu-id="e2f01-103">Cette rubrique décrit la façon dont le type de données `sql_variant` prend en charge les fonctionnalités de date et heure améliorées.</span><span class="sxs-lookup"><span data-stu-id="e2f01-103">This topic describes how the `sql_variant` data type supports enhanced date and time functionality.</span></span>  
  
 <span data-ttu-id="e2f01-104">L'attribut de colonne SQL_CA_SS_VARIANT_TYPE est utilisé pour retourner le type C d'une colonne de résultat de variante.</span><span class="sxs-lookup"><span data-stu-id="e2f01-104">The column attribute SQL_CA_SS_VARIANT_TYPE is used to return the C type of a variant result column.</span></span> [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] <span data-ttu-id="e2f01-105">introduit un attribut supplémentaire, SQL_CA_SS_VARIANT_SQL_TYPE, qui définit le type SQL d'une colonne de résultat de variante dans le descripteur de ligne d'implémentation (IRD, Implementation Row Descriptor).</span><span class="sxs-lookup"><span data-stu-id="e2f01-105">introduces an additional attribute, SQL_CA_SS_VARIANT_SQL_TYPE, which sets the SQL type of a variant result column in the implementation row descriptor (IRD).</span></span> <span data-ttu-id="e2f01-106">SQL_CA_SS_VARIANT_SQL_TYPE peut également être utilisé dans le descripteur de paramètre d'implémentation (IPD, Implementation Parameter Descriptor) pour spécifier le type SQL d'un paramètre SQL_SS_TIME2 ou SQL_SS_TIMESTAMPOFFSET qui a le type de C SQL_C_BINARY lié au type SQL_SS_VARIANT.</span><span class="sxs-lookup"><span data-stu-id="e2f01-106">SQL_CA_SS_VARIANT_SQL_TYPE can also be used in the implementation parameter descriptor (IPD) to specify the SQL type of a SQL_SS_TIME2 or SQL_SS_TIMESTAMPOFFSET parameter that has SQL_C_BINARY C type bound with type SQL_SS_VARIANT.</span></span>  
  
 <span data-ttu-id="e2f01-107">Les nouveaux types SQL_SS_TIME2 et SQL_SS_TIMESTAMPOFFSET peuvent être définis par SQLColAttribute.</span><span class="sxs-lookup"><span data-stu-id="e2f01-107">The new types SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET can be set by SQLColAttribute.</span></span> <span data-ttu-id="e2f01-108">SQL_CA_SS_VARIANT_SQL_TYPE peut être retourné par SQLGetDescField.</span><span class="sxs-lookup"><span data-stu-id="e2f01-108">SQL_CA_SS_VARIANT_SQL_TYPE can be returned by SQLGetDescField.</span></span>  
  
 <span data-ttu-id="e2f01-109">Pour les colonnes de résultats, le pilote effectue une conversion de la variante vers les types date/heure.</span><span class="sxs-lookup"><span data-stu-id="e2f01-109">For result columns, the driver will convert from the variant to date/time types.</span></span> <span data-ttu-id="e2f01-110">Pour plus d’informations, consultez [conversions de SQL en C](datetime-data-type-conversions-from-sql-to-c.md). Lors de la liaison à SQL_C_BINARY, la longueur de la mémoire tampon doit être suffisamment grande pour recevoir le struct qui correspond au type SQL.</span><span class="sxs-lookup"><span data-stu-id="e2f01-110">For more information, see [Conversions from SQL to C](datetime-data-type-conversions-from-sql-to-c.md). When binding to SQL_C_BINARY, the buffer length must be large enough to receive the struct that corresponds to the SQL type.</span></span>  
  
 <span data-ttu-id="e2f01-111">Pour les paramètres SQL_SS_TIME2 et SQL_SS_TIMESTAMPOFFSET, le pilote convertit les valeurs C en valeurs `sql_variant`, comme décrit dans le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="e2f01-111">For the SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET parameters, the driver will convert C values to `sql_variant` values, as described in the table below.</span></span> <span data-ttu-id="e2f01-112">Si un paramètre est lié en tant que SQL_C_BINARY et que le type de serveur est SQL_SS_VARIANT, il est traité comme une valeur binaire à moins que l'application n'ait défini SQL_CA_SS_VARIANT_SQL_TYPE sur un autre type SQL.</span><span class="sxs-lookup"><span data-stu-id="e2f01-112">If a parameter is bound as SQL_C_BINARY and the server type is SQL_SS_VARIANT, it will be treated as a binary value unless the application has set SQL_CA_SS_VARIANT_SQL_TYPE to some other SQL type.</span></span> <span data-ttu-id="e2f01-113">Dans ce cas, SQL_CA_SS_VARIANT_SQL_TYPE est prioritaire ; autrement dit, si SQL_CA_SS_VARIANT_SQL_TYPE est défini, il substitue le comportement par défaut consistant à déduire le type SQL variant du type C.</span><span class="sxs-lookup"><span data-stu-id="e2f01-113">In this case, SQL_CA_SS_VARIANT_SQL_TYPE takes precedence; that is, if SQL_CA_SS_VARIANT_SQL_TYPE is set, it overrides the default behavior of deducing the variant SQL type from the C type.</span></span>  
  
|<span data-ttu-id="e2f01-114">Type C</span><span class="sxs-lookup"><span data-stu-id="e2f01-114">C type</span></span>|<span data-ttu-id="e2f01-115">Type de serveur</span><span class="sxs-lookup"><span data-stu-id="e2f01-115">Server type</span></span>|<span data-ttu-id="e2f01-116">Commentaires</span><span class="sxs-lookup"><span data-stu-id="e2f01-116">Comments</span></span>|  
|------------|-----------------|--------------|  
|<span data-ttu-id="e2f01-117">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="e2f01-117">SQL_C_CHAR</span></span>|<span data-ttu-id="e2f01-118">varchar</span><span class="sxs-lookup"><span data-stu-id="e2f01-118">varchar</span></span>|<span data-ttu-id="e2f01-119">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-119">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-120">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="e2f01-120">SQL_C_WCHAR</span></span>|<span data-ttu-id="e2f01-121">nvarcar</span><span class="sxs-lookup"><span data-stu-id="e2f01-121">nvarcar</span></span>|<span data-ttu-id="e2f01-122">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-122">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-123">SQL_C_TINYINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-123">SQL_C_TINYINT</span></span>|<span data-ttu-id="e2f01-124">SMALLINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-124">smallint</span></span>|<span data-ttu-id="e2f01-125">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-125">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-126">SQL_C_STINYINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-126">SQL_C_STINYINT</span></span>|<span data-ttu-id="e2f01-127">SMALLINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-127">smallint</span></span>|<span data-ttu-id="e2f01-128">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-128">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-129">SQL_C_SHORT</span><span class="sxs-lookup"><span data-stu-id="e2f01-129">SQL_C_SHORT</span></span>|<span data-ttu-id="e2f01-130">SMALLINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-130">smallint</span></span>|<span data-ttu-id="e2f01-131">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-131">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-132">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="e2f01-132">SQL_C_SSHORT</span></span>|<span data-ttu-id="e2f01-133">SMALLINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-133">smallint</span></span>|<span data-ttu-id="e2f01-134">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-134">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-135">SQL_C_USHORT</span><span class="sxs-lookup"><span data-stu-id="e2f01-135">SQL_C_USHORT</span></span>|<span data-ttu-id="e2f01-136">int</span><span class="sxs-lookup"><span data-stu-id="e2f01-136">int</span></span>|<span data-ttu-id="e2f01-137">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-137">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-138">SQL_C_LONG</span><span class="sxs-lookup"><span data-stu-id="e2f01-138">SQL_C_LONG</span></span>|<span data-ttu-id="e2f01-139">int</span><span class="sxs-lookup"><span data-stu-id="e2f01-139">int</span></span>|<span data-ttu-id="e2f01-140">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-140">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-141">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="e2f01-141">SQL_C_SLONG</span></span>|<span data-ttu-id="e2f01-142">int</span><span class="sxs-lookup"><span data-stu-id="e2f01-142">int</span></span>|<span data-ttu-id="e2f01-143">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-143">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-144">SQL_C_ULONG</span><span class="sxs-lookup"><span data-stu-id="e2f01-144">SQL_C_ULONG</span></span>|<span data-ttu-id="e2f01-145">bigint</span><span class="sxs-lookup"><span data-stu-id="e2f01-145">bigint</span></span>|<span data-ttu-id="e2f01-146">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-146">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-147">SQL_C_SBIGINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-147">SQL_C_SBIGINT</span></span>|<span data-ttu-id="e2f01-148">bigint</span><span class="sxs-lookup"><span data-stu-id="e2f01-148">bigint</span></span>|<span data-ttu-id="e2f01-149">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-149">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-150">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="e2f01-150">SQL_C_FLOAT</span></span>|<span data-ttu-id="e2f01-151">real</span><span class="sxs-lookup"><span data-stu-id="e2f01-151">real</span></span>|<span data-ttu-id="e2f01-152">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-152">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-153">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="e2f01-153">SQL_C_DOUBLE</span></span>|<span data-ttu-id="e2f01-154">float</span><span class="sxs-lookup"><span data-stu-id="e2f01-154">float</span></span>|<span data-ttu-id="e2f01-155">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-155">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-156">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="e2f01-156">SQL_C_BIT</span></span>|<span data-ttu-id="e2f01-157">bit</span><span class="sxs-lookup"><span data-stu-id="e2f01-157">bit</span></span>|<span data-ttu-id="e2f01-158">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-158">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-159">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-159">SQL_C_UTINYINT</span></span>|<span data-ttu-id="e2f01-160">TINYINT</span><span class="sxs-lookup"><span data-stu-id="e2f01-160">tinyint</span></span>|<span data-ttu-id="e2f01-161">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-161">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-162">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e2f01-162">SQL_C_BINARY</span></span>|<span data-ttu-id="e2f01-163">varbinary</span><span class="sxs-lookup"><span data-stu-id="e2f01-163">varbinary</span></span>|<span data-ttu-id="e2f01-164">SQL_CA_SS_VARIANT_SQL_TYPE n'est pas défini.</span><span class="sxs-lookup"><span data-stu-id="e2f01-164">SQL_CA_SS_VARIANT_SQL_TYPE is not set.</span></span>|  
|<span data-ttu-id="e2f01-165">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e2f01-165">SQL_C_BINARY</span></span>|<span data-ttu-id="e2f01-166">time</span><span class="sxs-lookup"><span data-stu-id="e2f01-166">time</span></span>|<span data-ttu-id="e2f01-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e2f01-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span></span><br /><br /> <span data-ttu-id="e2f01-168">L’échelle est définie sur SQL_DESC_PRECISION (le paramètre *DecimalDigits* de `SQLBindParameter` ).</span><span class="sxs-lookup"><span data-stu-id="e2f01-168">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e2f01-169">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="e2f01-169">SQL_C_BINARY</span></span>|<span data-ttu-id="e2f01-170">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="e2f01-170">datetimeoffset</span></span>|<span data-ttu-id="e2f01-171">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e2f01-171">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="e2f01-172">L’échelle est définie sur SQL_DESC_PRECISION (le paramètre *DecimalDigits* de `SQLBindParameter` ).</span><span class="sxs-lookup"><span data-stu-id="e2f01-172">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e2f01-173">SQL_C_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="e2f01-173">SQL_C_TYPE_DATE</span></span>|<span data-ttu-id="e2f01-174">Date</span><span class="sxs-lookup"><span data-stu-id="e2f01-174">date</span></span>|<span data-ttu-id="e2f01-175">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-175">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-176">SQL_C_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="e2f01-176">SQL_C_TYPE_TIME</span></span>|<span data-ttu-id="e2f01-177">time(0)</span><span class="sxs-lookup"><span data-stu-id="e2f01-177">time(0)</span></span>|<span data-ttu-id="e2f01-178">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e2f01-178">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="e2f01-179">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e2f01-179">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="e2f01-180">datetime2</span><span class="sxs-lookup"><span data-stu-id="e2f01-180">datetime2</span></span>|<span data-ttu-id="e2f01-181">L’échelle est définie sur SQL_DESC_PRECISION (le paramètre *DecimalDigits* de `SQLBindParameter` ).</span><span class="sxs-lookup"><span data-stu-id="e2f01-181">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="e2f01-182">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="e2f01-182">SQL_C_NUMERIC</span></span>|<span data-ttu-id="e2f01-183">Décimal</span><span class="sxs-lookup"><span data-stu-id="e2f01-183">decimal</span></span>|<span data-ttu-id="e2f01-184">La précision est définie sur SQL_DESC_PRECISION (le paramètre *columnr* de `SQLBindParameter` ).</span><span class="sxs-lookup"><span data-stu-id="e2f01-184">Precision is set to SQL_DESC_PRECISION (the *ColumnSize* parameter of `SQLBindParameter`).</span></span><br /><br /> <span data-ttu-id="e2f01-185">Mise à l’échelle définie sur SQL_DESC_SCALE (paramètre *DecimalDigits* de SQLBindParameter).</span><span class="sxs-lookup"><span data-stu-id="e2f01-185">Scale set to SQL_DESC_SCALE (the *DecimalDigits* parameter of SQLBindParameter).</span></span>|  
|<span data-ttu-id="e2f01-186">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e2f01-186">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="e2f01-187">time</span><span class="sxs-lookup"><span data-stu-id="e2f01-187">time</span></span>|<span data-ttu-id="e2f01-188">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré</span><span class="sxs-lookup"><span data-stu-id="e2f01-188">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
|<span data-ttu-id="e2f01-189">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e2f01-189">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="e2f01-190">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="e2f01-190">datetimeoffset</span></span>|<span data-ttu-id="e2f01-191">SQL_CA_SS_VARIANT_SQL_TYPE est ignoré</span><span class="sxs-lookup"><span data-stu-id="e2f01-191">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e2f01-192">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e2f01-192">See Also</span></span>  
 [<span data-ttu-id="e2f01-193">Améliorations de la date et de l’heure &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="e2f01-193">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
