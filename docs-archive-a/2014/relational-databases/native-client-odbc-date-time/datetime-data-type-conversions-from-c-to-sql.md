---
title: Conversions de C en SQL | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- conversions [ODBC], C to SQL
ms.assetid: 7ac098db-9147-4883-8da9-a58ab24a0d31
author: rothja
ms.author: jroth
ms.openlocfilehash: 2ec8856b9c516ff3693da2ebf1077289d414e589
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612288"
---
# <a name="conversions-from-c-to-sql"></a><span data-ttu-id="e227a-102">Conversions de C en SQL</span><span class="sxs-lookup"><span data-stu-id="e227a-102">Conversions from C to SQL</span></span>
  <span data-ttu-id="e227a-103">Cette rubrique répertorie les problèmes à prendre en compte lors de la conversion de types C en [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] types date/heure.</span><span class="sxs-lookup"><span data-stu-id="e227a-103">This topic lists issues to consider when you convert from C types to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] date/time types.</span></span>  
  
 <span data-ttu-id="e227a-104">Les conversions décrites dans le tableau suivant s'appliquent aux conversions effectuées sur le client.</span><span class="sxs-lookup"><span data-stu-id="e227a-104">The conversions described in the following table apply to conversions made on the client.</span></span> <span data-ttu-id="e227a-105">Dans les cas où le client spécifie la précision à la fraction de seconde pour un paramètre qui diffère de celui défini sur le serveur, la conversion cliente peut réussir, mais le serveur retourne une erreur en cas d'appel de `SQLExecute` ou `SQLExecuteDirect`.</span><span class="sxs-lookup"><span data-stu-id="e227a-105">In cases where the client specifies fractional second precision for a parameter that differs from that defined on the server, the client conversion might succeed but the server will return an error when `SQLExecute` or `SQLExecuteDirect` is called.</span></span> <span data-ttu-id="e227a-106">En particulier, ODBC traite toute troncation de fraction de seconde comme une erreur, alors que le comportement de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] consiste à arrondir ; par exemple, un arrondi se produit lorsque vous passez de `datetime2(6)` à `datetime2(2)`.</span><span class="sxs-lookup"><span data-stu-id="e227a-106">In particular, ODBC treats any truncation of fractional seconds as an error, whereas the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] behavior is to round; for example, rounding occurs when you go from `datetime2(6)` to `datetime2(2)`.</span></span> <span data-ttu-id="e227a-107">Les colonnes datetime sont arrondies au 1/300ème de seconde et les secondes des colonnes smalldatetime sont définies avec la valeur zéro (0) par le serveur.</span><span class="sxs-lookup"><span data-stu-id="e227a-107">Datetime column values are rounded to 1/300th of a second and smalldatetime columns have seconds set to zero by the server.</span></span>  
  
|||||||||  
|-|-|-|-|-|-|-|-|  
||<span data-ttu-id="e227a-108">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="e227a-108">SQL_TYPE_DATE</span></span>|<span data-ttu-id="e227a-109">SQL_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="e227a-109">SQL_TYPE_TIME</span></span>|<span data-ttu-id="e227a-110">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e227a-110">SQL_SS_TIME2</span></span>|<span data-ttu-id="e227a-111">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e227a-111">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="e227a-112">SQL_SS_TIMSTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e227a-112">SQL_SS_TIMSTAMPOFFSET</span></span>|<span data-ttu-id="e227a-113">SQL_CHAR</span><span class="sxs-lookup"><span data-stu-id="e227a-113">SQL_CHAR</span></span>|<span data-ttu-id="e227a-114">SQL_WCHAR</span><span class="sxs-lookup"><span data-stu-id="e227a-114">SQL_WCHAR</span></span>|  
|<span data-ttu-id="e227a-115">SQL_C_DATE</span><span class="sxs-lookup"><span data-stu-id="e227a-115">SQL_C_DATE</span></span>|<span data-ttu-id="e227a-116">1</span><span class="sxs-lookup"><span data-stu-id="e227a-116">1</span></span>|-|-|<span data-ttu-id="e227a-117">1,6</span><span class="sxs-lookup"><span data-stu-id="e227a-117">1,6</span></span>|<span data-ttu-id="e227a-118">1,5,6</span><span class="sxs-lookup"><span data-stu-id="e227a-118">1,5,6</span></span>|<span data-ttu-id="e227a-119">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-119">1,13</span></span>|<span data-ttu-id="e227a-120">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-120">1,13</span></span>|  
|<span data-ttu-id="e227a-121">SQL_C_TIME</span><span class="sxs-lookup"><span data-stu-id="e227a-121">SQL_C_TIME</span></span>|-|<span data-ttu-id="e227a-122">1</span><span class="sxs-lookup"><span data-stu-id="e227a-122">1</span></span>|<span data-ttu-id="e227a-123">1</span><span class="sxs-lookup"><span data-stu-id="e227a-123">1</span></span>|<span data-ttu-id="e227a-124">1,7</span><span class="sxs-lookup"><span data-stu-id="e227a-124">1,7</span></span>|<span data-ttu-id="e227a-125">1, 5, 7</span><span class="sxs-lookup"><span data-stu-id="e227a-125">1,5,7</span></span>|<span data-ttu-id="e227a-126">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-126">1,13</span></span>|<span data-ttu-id="e227a-127">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-127">1,13</span></span>|  
|<span data-ttu-id="e227a-128">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="e227a-128">SQL_C_SS_TIME2</span></span>|-|<span data-ttu-id="e227a-129">1,3</span><span class="sxs-lookup"><span data-stu-id="e227a-129">1,3</span></span>|<span data-ttu-id="e227a-130">1,10</span><span class="sxs-lookup"><span data-stu-id="e227a-130">1,10</span></span>|<span data-ttu-id="e227a-131">1,7</span><span class="sxs-lookup"><span data-stu-id="e227a-131">1,7</span></span>|<span data-ttu-id="e227a-132">1, 5, 7</span><span class="sxs-lookup"><span data-stu-id="e227a-132">1,5,7</span></span>|<span data-ttu-id="e227a-133">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-133">1,13</span></span>|<span data-ttu-id="e227a-134">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-134">1,13</span></span>|  
|<span data-ttu-id="e227a-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="e227a-135">SQL_C_BINARY(SQL_SS_TIME2_STRUCT)</span></span>|<span data-ttu-id="e227a-136">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-136">N/A</span></span>|<span data-ttu-id="e227a-137">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-137">N/A</span></span>|<span data-ttu-id="e227a-138">1,10,11</span><span class="sxs-lookup"><span data-stu-id="e227a-138">1,10,11</span></span>|<span data-ttu-id="e227a-139">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-139">N/A</span></span>|<span data-ttu-id="e227a-140">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-140">N/A</span></span>|<span data-ttu-id="e227a-141">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-141">N/A</span></span>|<span data-ttu-id="e227a-142">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-142">N/A</span></span>|  
|<span data-ttu-id="e227a-143">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e227a-143">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="e227a-144">1,2</span><span class="sxs-lookup"><span data-stu-id="e227a-144">1,2</span></span>|<span data-ttu-id="e227a-145">1,3,4</span><span class="sxs-lookup"><span data-stu-id="e227a-145">1,3,4</span></span>|<span data-ttu-id="e227a-146">1,4,10</span><span class="sxs-lookup"><span data-stu-id="e227a-146">1,4,10</span></span>|<span data-ttu-id="e227a-147">1,10</span><span class="sxs-lookup"><span data-stu-id="e227a-147">1,10</span></span>|<span data-ttu-id="e227a-148">1,5,10</span><span class="sxs-lookup"><span data-stu-id="e227a-148">1,5,10</span></span>|<span data-ttu-id="e227a-149">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-149">1,13</span></span>|<span data-ttu-id="e227a-150">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-150">1,13</span></span>|  
|<span data-ttu-id="e227a-151">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="e227a-151">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="e227a-152">1,2,8</span><span class="sxs-lookup"><span data-stu-id="e227a-152">1,2,8</span></span>|<span data-ttu-id="e227a-153">1,3,4,8</span><span class="sxs-lookup"><span data-stu-id="e227a-153">1,3,4,8</span></span>|<span data-ttu-id="e227a-154">1,4,8,10</span><span class="sxs-lookup"><span data-stu-id="e227a-154">1,4,8,10</span></span>|<span data-ttu-id="e227a-155">1,8,10</span><span class="sxs-lookup"><span data-stu-id="e227a-155">1,8,10</span></span>|<span data-ttu-id="e227a-156">1,10</span><span class="sxs-lookup"><span data-stu-id="e227a-156">1,10</span></span>|<span data-ttu-id="e227a-157">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-157">1,13</span></span>|<span data-ttu-id="e227a-158">1,13</span><span class="sxs-lookup"><span data-stu-id="e227a-158">1,13</span></span>|  
|<span data-ttu-id="e227a-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="e227a-159">SQL_C_BINARY(SQL_SS_TIMESTAMPOFFSET_STRUCT)</span></span>|<span data-ttu-id="e227a-160">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-160">N/A</span></span>|<span data-ttu-id="e227a-161">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-161">N/A</span></span>|<span data-ttu-id="e227a-162">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-162">N/A</span></span>|<span data-ttu-id="e227a-163">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-163">N/A</span></span>|<span data-ttu-id="e227a-164">1,10,11</span><span class="sxs-lookup"><span data-stu-id="e227a-164">1,10,11</span></span>|<span data-ttu-id="e227a-165">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-165">N/A</span></span>|<span data-ttu-id="e227a-166">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-166">N/A</span></span>|  
|<span data-ttu-id="e227a-167">SQL_C_CHAR/SQL_WCHAR (date)</span><span class="sxs-lookup"><span data-stu-id="e227a-167">SQL_C_CHAR/SQL_WCHAR (date)</span></span>|<span data-ttu-id="e227a-168">9</span><span class="sxs-lookup"><span data-stu-id="e227a-168">9</span></span>|<span data-ttu-id="e227a-169">9</span><span class="sxs-lookup"><span data-stu-id="e227a-169">9</span></span>|<span data-ttu-id="e227a-170">9</span><span class="sxs-lookup"><span data-stu-id="e227a-170">9</span></span>|<span data-ttu-id="e227a-171">9,6</span><span class="sxs-lookup"><span data-stu-id="e227a-171">9,6</span></span>|<span data-ttu-id="e227a-172">9,5,6</span><span class="sxs-lookup"><span data-stu-id="e227a-172">9,5,6</span></span>|<span data-ttu-id="e227a-173">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-173">N/A</span></span>|<span data-ttu-id="e227a-174">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-174">N/A</span></span>|  
|<span data-ttu-id="e227a-175">SQL_C_CHAR/SQL_WCHAR (time2)</span><span class="sxs-lookup"><span data-stu-id="e227a-175">SQL_C_CHAR/SQL_WCHAR (time2)</span></span>|<span data-ttu-id="e227a-176">9</span><span class="sxs-lookup"><span data-stu-id="e227a-176">9</span></span>|<span data-ttu-id="e227a-177">9, 3</span><span class="sxs-lookup"><span data-stu-id="e227a-177">9,3</span></span>|<span data-ttu-id="e227a-178">9,10</span><span class="sxs-lookup"><span data-stu-id="e227a-178">9,10</span></span>|<span data-ttu-id="e227a-179">9,7,10</span><span class="sxs-lookup"><span data-stu-id="e227a-179">9,7,10</span></span>|<span data-ttu-id="e227a-180">9,5,7,10</span><span class="sxs-lookup"><span data-stu-id="e227a-180">9,5,7,10</span></span>|<span data-ttu-id="e227a-181">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-181">N/A</span></span>|<span data-ttu-id="e227a-182">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-182">N/A</span></span>|  
|<span data-ttu-id="e227a-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span><span class="sxs-lookup"><span data-stu-id="e227a-183">SQL_C_CHAR/SQL_WCHAR (datetime)</span></span>|<span data-ttu-id="e227a-184">9,2</span><span class="sxs-lookup"><span data-stu-id="e227a-184">9,2</span></span>|<span data-ttu-id="e227a-185">9, 3, 4</span><span class="sxs-lookup"><span data-stu-id="e227a-185">9,3,4</span></span>|<span data-ttu-id="e227a-186">9,4,10</span><span class="sxs-lookup"><span data-stu-id="e227a-186">9,4,10</span></span>|<span data-ttu-id="e227a-187">9,10</span><span class="sxs-lookup"><span data-stu-id="e227a-187">9,10</span></span>|<span data-ttu-id="e227a-188">9,5,10</span><span class="sxs-lookup"><span data-stu-id="e227a-188">9,5,10</span></span>|<span data-ttu-id="e227a-189">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-189">N/A</span></span>|<span data-ttu-id="e227a-190">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-190">N/A</span></span>|  
|<span data-ttu-id="e227a-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span><span class="sxs-lookup"><span data-stu-id="e227a-191">SQL_C_CHAR/SQL_WCHAR (datetimeoffset)</span></span>|<span data-ttu-id="e227a-192">9,2,8</span><span class="sxs-lookup"><span data-stu-id="e227a-192">9,2,8</span></span>|<span data-ttu-id="e227a-193">9, 3, 4, 8</span><span class="sxs-lookup"><span data-stu-id="e227a-193">9,3,4,8</span></span>|<span data-ttu-id="e227a-194">9,4,8,10</span><span class="sxs-lookup"><span data-stu-id="e227a-194">9,4,8,10</span></span>|<span data-ttu-id="e227a-195">9,8,10</span><span class="sxs-lookup"><span data-stu-id="e227a-195">9,8,10</span></span>|<span data-ttu-id="e227a-196">9,10</span><span class="sxs-lookup"><span data-stu-id="e227a-196">9,10</span></span>|<span data-ttu-id="e227a-197">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-197">N/A</span></span>|<span data-ttu-id="e227a-198">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-198">N/A</span></span>|  
|<span data-ttu-id="e227a-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="e227a-199">SQL_C_BINARY(SQL_DATE_STRUCT)</span></span>|<span data-ttu-id="e227a-200">1,11</span><span class="sxs-lookup"><span data-stu-id="e227a-200">1,11</span></span>|<span data-ttu-id="e227a-201">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-201">N/A</span></span>|<span data-ttu-id="e227a-202">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-202">N/A</span></span>|<span data-ttu-id="e227a-203">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-203">N/A</span></span>|<span data-ttu-id="e227a-204">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-204">N/A</span></span>|<span data-ttu-id="e227a-205">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-205">N/A</span></span>|<span data-ttu-id="e227a-206">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-206">N/A</span></span>|  
|<span data-ttu-id="e227a-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="e227a-207">SQL_C_BINARY(SQL_TIME_STRUCT)</span></span>|<span data-ttu-id="e227a-208">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-208">N/A</span></span>|<span data-ttu-id="e227a-209">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-209">N/A</span></span>|<span data-ttu-id="e227a-210">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-210">N/A</span></span>|<span data-ttu-id="e227a-211">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-211">N/A</span></span>|<span data-ttu-id="e227a-212">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-212">N/A</span></span>|<span data-ttu-id="e227a-213">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-213">N/A</span></span>|<span data-ttu-id="e227a-214">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-214">N/A</span></span>|  
|<span data-ttu-id="e227a-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span><span class="sxs-lookup"><span data-stu-id="e227a-215">SQL_C_BINARY(SQL_TIMESTAMP_STRUCT)</span></span>|<span data-ttu-id="e227a-216">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-216">N/A</span></span>|<span data-ttu-id="e227a-217">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-217">N/A</span></span>|<span data-ttu-id="e227a-218">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-218">N/A</span></span>|<span data-ttu-id="e227a-219">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-219">N/A</span></span>|<span data-ttu-id="e227a-220">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-220">N/A</span></span>|<span data-ttu-id="e227a-221">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-221">N/A</span></span>|<span data-ttu-id="e227a-222">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-222">N/A</span></span>|  
  
## <a name="key-to-symbols"></a><span data-ttu-id="e227a-223">Liste des symboles</span><span class="sxs-lookup"><span data-stu-id="e227a-223">Key to Symbols</span></span>  
  
|<span data-ttu-id="e227a-224">Symbole</span><span class="sxs-lookup"><span data-stu-id="e227a-224">Symbol</span></span>|<span data-ttu-id="e227a-225">Signification</span><span class="sxs-lookup"><span data-stu-id="e227a-225">Meaning</span></span>|  
|------------|-------------|  
|-|<span data-ttu-id="e227a-226">Aucune conversion n'est prise en charge.</span><span class="sxs-lookup"><span data-stu-id="e227a-226">No conversion is supported.</span></span> <span data-ttu-id="e227a-227">Un enregistrement de diagnostic est généré avec SQLSTATE 07006 et le message « Violation de l'attribut de type de données restreint ».</span><span class="sxs-lookup"><span data-stu-id="e227a-227">A diagnostic record is generated with SQLSTATE 07006 and the message "Restricted data type attribute violation".</span></span>|  
|<span data-ttu-id="e227a-228">1</span><span class="sxs-lookup"><span data-stu-id="e227a-228">1</span></span>|<span data-ttu-id="e227a-229">Si les données fournies ne sont pas valides, un enregistrement de diagnostic est généré avec SQLSTATE 22007 et le message « Format datetime non valide ».</span><span class="sxs-lookup"><span data-stu-id="e227a-229">If the data supplied is not valid, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="e227a-230">2</span><span class="sxs-lookup"><span data-stu-id="e227a-230">2</span></span>|<span data-ttu-id="e227a-231">Les champs d'heure doivent être nuls ou un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Troncation fractionnelle ».</span><span class="sxs-lookup"><span data-stu-id="e227a-231">Time fields must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="e227a-232">3</span><span class="sxs-lookup"><span data-stu-id="e227a-232">3</span></span>|<span data-ttu-id="e227a-233">Les fractions de secondes doivent être nulles ou un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Troncation fractionnelle ».</span><span class="sxs-lookup"><span data-stu-id="e227a-233">Fractional seconds must be zero or a diagnostic record is generated with SQLSTATE 22008 and the message "Fractional truncation".</span></span>|  
|<span data-ttu-id="e227a-234">4</span><span class="sxs-lookup"><span data-stu-id="e227a-234">4</span></span>|<span data-ttu-id="e227a-235">Le composant date est ignoré.</span><span class="sxs-lookup"><span data-stu-id="e227a-235">The date component is ignored.</span></span>|  
|<span data-ttu-id="e227a-236">5</span><span class="sxs-lookup"><span data-stu-id="e227a-236">5</span></span>|<span data-ttu-id="e227a-237">Le composant timezone est défini avec le paramètre timezone du client.</span><span class="sxs-lookup"><span data-stu-id="e227a-237">The timezone is set to the client's timezone setting.</span></span>|  
|<span data-ttu-id="e227a-238">6</span><span class="sxs-lookup"><span data-stu-id="e227a-238">6</span></span>|<span data-ttu-id="e227a-239">L'heure est définie avec la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="e227a-239">The time is set to zero.</span></span>|  
|<span data-ttu-id="e227a-240">7</span><span class="sxs-lookup"><span data-stu-id="e227a-240">7</span></span>|<span data-ttu-id="e227a-241">La date est définie avec la date en cours.</span><span class="sxs-lookup"><span data-stu-id="e227a-241">The date is set to the current date.</span></span>|  
|<span data-ttu-id="e227a-242">8</span><span class="sxs-lookup"><span data-stu-id="e227a-242">8</span></span>|<span data-ttu-id="e227a-243">L’heure est convertie du fuseau horaire du client en heure UTC.</span><span class="sxs-lookup"><span data-stu-id="e227a-243">The time is converted from the client's timezone to UTC.</span></span> <span data-ttu-id="e227a-244">Si une erreur se produit pendant cette conversion, un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Dépassement de la capacité du champ datetime ».</span><span class="sxs-lookup"><span data-stu-id="e227a-244">If an error occurs during this conversion, a diagnostic record is generated with SQLSTATE 22008 and the message "Datetime field overflow".</span></span>|  
|<span data-ttu-id="e227a-245">9</span><span class="sxs-lookup"><span data-stu-id="e227a-245">9</span></span>|<span data-ttu-id="e227a-246">La chaîne est analysée et convertie en valeur date, datetime, datetimeoffset ou time, selon le premier caractère de ponctuation rencontré et la présence de composants restants.</span><span class="sxs-lookup"><span data-stu-id="e227a-246">The string is parsed and converted to a date, datetime, datetimeoffset, or time value, depending on the first punctuation character encountered and the presence of remaining components.</span></span> <span data-ttu-id="e227a-247">La chaîne est ensuite convertie en type cible,  selon les règles de la table précédente pour le type source découvert par ce processus.</span><span class="sxs-lookup"><span data-stu-id="e227a-247">The string is then converted to the target type, following the rules in the preceding table for the source type discovered by this process.</span></span> <span data-ttu-id="e227a-248">Si une erreur est détectée en analysant les données, un enregistrement de diagnostic est généré avec SQLSTATE 22018 et le message « Valeur de caractère non valide pour la spécification de la casse ».</span><span class="sxs-lookup"><span data-stu-id="e227a-248">If an error is detected while parsing the data, a diagnostic record is generated with SQLSTATE 22018 and the message "Invalid character value for cast specification".</span></span> <span data-ttu-id="e227a-249">Pour les paramètres datetime et smalldatetime, si l'année est en dehors de la plage prise en charge par ces types, un enregistrement de diagnostic est généré avec SQLSTATE 22007 et le message « Format datetime non valide ».</span><span class="sxs-lookup"><span data-stu-id="e227a-249">For datetime and smalldatetime parameters, if the year is outside the range supported by these types, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span><br /><br /> <span data-ttu-id="e227a-250">Pour datetimeoffset, la valeur doit se situer dans la plage après la conversion au format UTC, même si aucune conversion au format UTC n'est demandée.</span><span class="sxs-lookup"><span data-stu-id="e227a-250">For datetimeoffset, the value must be within range after conversion to UTC, even if no conversion to UTC is requested.</span></span> <span data-ttu-id="e227a-251">Cela tient au fait que TDS et le serveur normalisent toujours l'heure des valeurs datetimeoffset pour UTC, si bien que le client doit vérifier que les composants heure se situent dans la plage prise en charge après la conversion au format UTC.</span><span class="sxs-lookup"><span data-stu-id="e227a-251">This is because TDS and the server always normalize the time in datetimeoffset values for UTC, so the client must verify that time components are within the range supported after conversion to UTC.</span></span> <span data-ttu-id="e227a-252">Si la valeur n'est pas dans la plage UTC prise en charge, un enregistrement de diagnostic est généré avec SQLSTATE 22007 et le message « Format de datetime non valide ».</span><span class="sxs-lookup"><span data-stu-id="e227a-252">If the value is not within the supported UTC range, a diagnostic record is generated with SQLSTATE 22007 and the message "Invalid datetime format".</span></span>|  
|<span data-ttu-id="e227a-253">10</span><span class="sxs-lookup"><span data-stu-id="e227a-253">10</span></span>|<span data-ttu-id="e227a-254">S'il se produit une troncation avec perte de données, un enregistrement de diagnostic est généré avec SQLSTATE 22008 et le message « Format d'heure non valide ».</span><span class="sxs-lookup"><span data-stu-id="e227a-254">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22008 and the message "Invalid time format".</span></span> <span data-ttu-id="e227a-255">Cette erreur se produit également si la valeur est située en dehors de la plage qui peut être représentée par la plage UTC utilisée par le serveur.</span><span class="sxs-lookup"><span data-stu-id="e227a-255">This error also occurs if the value falls outside the range that can be represented by the UTC range used by the server.</span></span>|  
|<span data-ttu-id="e227a-256">11</span><span class="sxs-lookup"><span data-stu-id="e227a-256">11</span></span>|<span data-ttu-id="e227a-257">Si la longueur d'octet n'est pas égale à la taille de la structure requise par le type SQL, un enregistrement de diagnostic est généré avec SQLSTATE 22003 et le message « Valeur numérique hors limites ».</span><span class="sxs-lookup"><span data-stu-id="e227a-257">If the byte length of the data does not equal the size of the struct required by the SQL type, a diagnostic record is generated with SQLSTATE 22003 and the message "Numeric value out of range".</span></span>|  
|<span data-ttu-id="e227a-258">12</span><span class="sxs-lookup"><span data-stu-id="e227a-258">12</span></span>|<span data-ttu-id="e227a-259">Si la longueur d'octet est égale à 4 ou à 8, les données sont envoyées au serveur au format brut datetime ou smalldatetime TDS.</span><span class="sxs-lookup"><span data-stu-id="e227a-259">If the byte length of the data is 4 or 8, the data is sent to the server in raw TDS smalldatetime or datetime format.</span></span> <span data-ttu-id="e227a-260">Si la longueur d'octet des données correspond exactement à la taille de SQL_TIMESTAMP_STRUCT, les données sont converties au format TDS pour datetime2.</span><span class="sxs-lookup"><span data-stu-id="e227a-260">If the byte length of the data exactly matches the size of SQL_TIMESTAMP_STRUCT, the data is converted to the TDS format for datetime2.</span></span>|  
|<span data-ttu-id="e227a-261">13</span><span class="sxs-lookup"><span data-stu-id="e227a-261">13</span></span>|<span data-ttu-id="e227a-262">S'il se produit une troncation avec perte de données, un enregistrement de diagnostic est généré avec SQLSTATE 22001 et le message « Troncation à droite de la chaîne de données ».</span><span class="sxs-lookup"><span data-stu-id="e227a-262">If truncation with data loss occurs, a diagnostic record is generated with SQLSTATE 22001 and the message "String data, right truncated".</span></span><br /><br /> <span data-ttu-id="e227a-263">Le nombre de chiffres de fractions de seconde (l’échelle) est déterminé à partir de la taille de la colonne de destination en fonction des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="e227a-263">The number of fractional seconds digits (the scale) is determined from the destination column's size according to the following:</span></span><br /><br /> <span data-ttu-id="e227a-264">**Tapez :** SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="e227a-264">**Type:** SQL_C_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="e227a-265">Échelle impliquée</span><span class="sxs-lookup"><span data-stu-id="e227a-265">Implied Scale</span></span><br /><br /> <span data-ttu-id="e227a-266">0</span><span class="sxs-lookup"><span data-stu-id="e227a-266">0</span></span><br /><br /> <span data-ttu-id="e227a-267">19</span><span class="sxs-lookup"><span data-stu-id="e227a-267">19</span></span><br /><br /> <span data-ttu-id="e227a-268">Échelle impliquée</span><span class="sxs-lookup"><span data-stu-id="e227a-268">Implied Scale</span></span><br /><br /> <span data-ttu-id="e227a-269">1.. 9</span><span class="sxs-lookup"><span data-stu-id="e227a-269">1..9</span></span><br /><br /> <span data-ttu-id="e227a-270">21..29</span><span class="sxs-lookup"><span data-stu-id="e227a-270">21..29</span></span><br /><br /> <span data-ttu-id="e227a-271">Toutefois, pour SQL_C_TYPE_TIMESTAMP, si les fractions de seconde peuvent être représentées avec trois chiffres sans perte de données et que la taille de colonne est égale ou supérieure à 23, trois chiffres de fractions de seconde sont générés.</span><span class="sxs-lookup"><span data-stu-id="e227a-271">However, for SQL_C_TYPE_TIMESTAMP, if the fractional seconds can be represented with three digits without data loss and the column size is 23 or larger, then exactly three fractional seconds' digits are generated.</span></span> <span data-ttu-id="e227a-272">Ce comportement garantit la compatibilité descendante pour les applications développées à l'aide de pilotes ODBC plus anciens.</span><span class="sxs-lookup"><span data-stu-id="e227a-272">This behavior ensures backwards compatibility for applications developed using older ODBC drivers.</span></span><br /><br /> <span data-ttu-id="e227a-273">Pour les tailles de colonne supérieures à la plage du tableau, une échelle de 9 est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="e227a-273">For column sizes larger than the range in the table, a scale of 9 is implied.</span></span> <span data-ttu-id="e227a-274">Cette conversion accepte jusqu'à neuf chiffres de fractions de seconde, valeur maximale autorisée par ODBC.</span><span class="sxs-lookup"><span data-stu-id="e227a-274">This conversion should allow for up to nine fractional seconds digits, the maximum allowed by ODBC.</span></span><br /><br /> <span data-ttu-id="e227a-275">Une taille de colonne égale à zéro implique une taille illimitée pour les types de caractères de longueur variable en ODBC (9 chiffres, à moins que la règle des 3 chiffres pour SQL_C_TYPE_TIMESTAMP ne s'applique).</span><span class="sxs-lookup"><span data-stu-id="e227a-275">A column size of zero implies unlimited size for variable length character types in ODBC (9 digits, unless the 3-digit rule for SQL_C_TYPE_TIMESTAMP applies).</span></span> <span data-ttu-id="e227a-276">La spécification d'une taille de colonne égale à zéro avec un type de caractère de longueur fixe constitue une erreur.</span><span class="sxs-lookup"><span data-stu-id="e227a-276">Specifying a column size of zero with a fixed length character type is an error.</span></span>|  
|<span data-ttu-id="e227a-277">N/A</span><span class="sxs-lookup"><span data-stu-id="e227a-277">N/A</span></span>|<span data-ttu-id="e227a-278">Le comportement existant et antérieur de [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] est conservé.</span><span class="sxs-lookup"><span data-stu-id="e227a-278">Existing [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] and earlier behavior is maintained.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="e227a-279">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e227a-279">See Also</span></span>  
 [<span data-ttu-id="e227a-280">Améliorations de la date et de l’heure &#40;ODBC&#41;</span><span class="sxs-lookup"><span data-stu-id="e227a-280">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
