---
title: Mise à jour des données dans les curseurs SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- updating data [SQL Server]
- isolation levels [SQL Server]
- delayed update mode [OLE DB]
- immediate update mode [OLE DB]
- cursors [OLE DB]
- data updates [SQL Server], OLE DB
ms.assetid: 732dafee-f2d5-4aef-aad7-3a8bf3b1e876
author: rothja
ms.author: jroth
ms.openlocfilehash: 42e6221a85c30e3adb97df3a11c9cbdc49216b4d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602821"
---
# <a name="updating-data-in-sql-server-cursors"></a><span data-ttu-id="f7281-102">Mise à jour des données dans les curseurs SQL Server</span><span class="sxs-lookup"><span data-stu-id="f7281-102">Updating Data in SQL Server Cursors</span></span>
  <span data-ttu-id="f7281-103">Lors de l’extraction et de la mise à jour des données par le biais de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] curseurs, une [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] application cliente OLE DB fournisseur Native Client est liée par les mêmes considérations et contraintes qui s’appliquent à toute autre application cliente.</span><span class="sxs-lookup"><span data-stu-id="f7281-103">When fetching and updating data through [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer application is bound by the same considerations and constraints that apply to any other client application.</span></span>  
  
 <span data-ttu-id="f7281-104">Seules les lignes des curseurs [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] participent à un contrôle de simultanéité d'accès aux données.</span><span class="sxs-lookup"><span data-stu-id="f7281-104">Only rows in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cursors participate in concurrent data-access control.</span></span> <span data-ttu-id="f7281-105">Lorsque le consommateur demande un ensemble de lignes modifiable, le contrôle de simultanéité est vérifié par DBPROP_LOCKMODE.</span><span class="sxs-lookup"><span data-stu-id="f7281-105">When the consumer requests a modifiable rowset, the concurrency control is controlled by DBPROP_LOCKMODE.</span></span> <span data-ttu-id="f7281-106">Pour modifier le niveau de contrôle d'accès simultané, le consommateur définit la propriété DBPROP_LOCKMODE avant d'ouvrir l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="f7281-106">To modify the level of concurrent access control, the consumer sets the DBPROP_LOCKMODE property before opening the rowset.</span></span>  
  
 <span data-ttu-id="f7281-107">Les niveaux d'isolation de la transaction peuvent provoquer des décalages significatifs dans la position des lignes si la conception de l'application cliente permet aux transactions de demeurer ouvertes sur une longue période de temps.</span><span class="sxs-lookup"><span data-stu-id="f7281-107">Transaction isolation levels can cause significant lags in row positioning if client application design lets transactions remain open for long periods of time.</span></span> <span data-ttu-id="f7281-108">Par défaut, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client utilise le niveau d’isolation de lecture validée spécifié par DBPROPVAL_TI_READCOMMITTED.</span><span class="sxs-lookup"><span data-stu-id="f7281-108">By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses the read-committed isolation level specified by DBPROPVAL_TI_READCOMMITTED.</span></span> <span data-ttu-id="f7281-109">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client prend en charge l’isolation de lecture incorrecte lorsque la concurrence d’ensemble de lignes est en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="f7281-109">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports dirty read isolation when the rowset concurrency is read-only.</span></span> <span data-ttu-id="f7281-110">Par conséquent, le consommateur peut demander un niveau supérieur d'isolation dans un ensemble de lignes modifiable, mais il ne peut pas demander avec succès un niveau inférieur.</span><span class="sxs-lookup"><span data-stu-id="f7281-110">Therefore, the consumer can request a higher level of isolation in a modifiable rowset but cannot request any lower level successfully.</span></span>  
  
## <a name="immediate-and-delayed-update-modes"></a><span data-ttu-id="f7281-111">Modes de mises à jour immédiat et différé</span><span class="sxs-lookup"><span data-stu-id="f7281-111">Immediate and Delayed Update Modes</span></span>  
 <span data-ttu-id="f7281-112">En mode de mise à jour immédiate, chaque appel à **IRowsetChange::SetData** entraîne un aller-retour vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f7281-112">In immediate update mode, each call to **IRowsetChange::SetData** causes a round trip to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="f7281-113">Si le consommateur apporte plusieurs modifications à une seule ligne, il est plus efficace de soumettre toutes les modifications avec un seul appel à **SetData**.</span><span class="sxs-lookup"><span data-stu-id="f7281-113">If the consumer makes multiple changes to a single row, it is more efficient to submit all changes with a single **SetData** call.</span></span>  
  
 <span data-ttu-id="f7281-114">En mode de mise à jour différée, un aller-retour vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] a lieu pour chaque ligne indiquée dans les paramètres *cRows* et *rghRows* de **IRowsetUpdate::Update**.</span><span class="sxs-lookup"><span data-stu-id="f7281-114">In delayed update mode, a roundtrip is made to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] for each row indicated in the *cRows* and *rghRows* parameters of **IRowsetUpdate::Update**.</span></span>  
  
 <span data-ttu-id="f7281-115">Dans l'un et l'autre mode, un aller-retour représente une transaction distincte quand aucun objet de transaction n'est ouvert pour l'ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="f7281-115">In either mode, a roundtrip represents a distinct transaction when no transaction object is open for the rowset.</span></span>  
  
 <span data-ttu-id="f7281-116">Lorsque vous utilisez **IRowsetUpdate :: Update**, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client tente de traiter chaque ligne indiquée.</span><span class="sxs-lookup"><span data-stu-id="f7281-116">When you are using **IRowsetUpdate::Update**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider tries to process each indicated row.</span></span> <span data-ttu-id="f7281-117">Une erreur qui se produit en raison de valeurs de données, de longueur ou d’État non valides pour une ligne n’arrête pas le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] traitement du fournisseur OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="f7281-117">An error occurring because of invalid data, length, or status values for any row does not stop [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider processing.</span></span> <span data-ttu-id="f7281-118">La totalité des autres lignes prenant part à la mise à jour peut être modifiée.</span><span class="sxs-lookup"><span data-stu-id="f7281-118">All or none of the other rows participating in the update may be modified.</span></span> <span data-ttu-id="f7281-119">Le consommateur doit examiner le tableau *prgRowStatus* retourné pour déterminer l’échec d’une ligne spécifique lorsque le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne DB_S_ERRORSOCCURRED.</span><span class="sxs-lookup"><span data-stu-id="f7281-119">The consumer must examine the returned *prgRowStatus* array to determine failure for any specific row when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED.</span></span>  
  
 <span data-ttu-id="f7281-120">Un consommateur ne doit pas présumer que les lignes sont traitées selon un ordre spécifique.</span><span class="sxs-lookup"><span data-stu-id="f7281-120">A consumer should not assume that rows are processed in any specific order.</span></span> <span data-ttu-id="f7281-121">Si un consommateur a besoin d'un traitement ordonné de la modification des données sur plusieurs lignes, le consommateur doit établir cet ordre dans la logique de l'application et ouvrir une transaction pour encadrer le processus.</span><span class="sxs-lookup"><span data-stu-id="f7281-121">If a consumer requires ordered processing of data modification over more than a single row, the consumer should establish that order in the application logic and open a transaction to enclose the process.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7281-122">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f7281-122">See Also</span></span>  
 [<span data-ttu-id="f7281-123">Mise à jour des données dans les ensembles de lignes</span><span class="sxs-lookup"><span data-stu-id="f7281-123">Updating Data in Rowsets</span></span>](updating-data-in-rowsets.md)  
  
  
