---
title: Type et colonnes de données XML (SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: xml
ms.topic: conceptual
ms.assetid: 00db8f21-7d4b-4347-ae43-3a7c314d2fa1
author: rothja
ms.author: jroth
ms.openlocfilehash: 575f8b8fc640ea5ff671a6b0cef4208e7447898f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709008"
---
# <a name="xml-data-type-and-columns-sql-server"></a><span data-ttu-id="3a0f2-102">Type et colonnes de données XML (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="3a0f2-102">XML Data Type and Columns (SQL Server)</span></span>
  <span data-ttu-id="3a0f2-103">Cette rubrique décrit les avantages et les limitations du type de `xml` données dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , et vous aide à choisir comment stocker des données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-103">This topic discusses the advantages and the limitations of the `xml` data type in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and helps you to choose how to store XML data.</span></span>  
  
## <a name="relational-or-xml-data-model"></a><span data-ttu-id="3a0f2-104">Modèle de données relationnel ou XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-104">Relational or XML Data Model</span></span>  
 <span data-ttu-id="3a0f2-105">Si vos données sont très structurées et s'accompagnent de schémas connus, le modèle relationnel est sans doute le mieux adapté au stockage des données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-105">If your data is highly structured with known schema, the relational model is likely to work best for data storage.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="3a0f2-106">fournit les fonctionnalités et les outils dont vous pourrez avoir besoin.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-106">provides the required functionality and tools you may need.</span></span> <span data-ttu-id="3a0f2-107">En revanche, s'il s'agit de données semi-structurées ou non structurées, ou si la structure est inconnue, mieux vaut envisager la modélisation de ces données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-107">On the other hand, if the structure is semi-structured or unstructured, or unknown, you have to give consideration to modeling such data.</span></span>  
  
 <span data-ttu-id="3a0f2-108">XML s'avère une solution de choix si vous souhaitez un modèle indépendant des plateformes pour assurer la portabilité des données à l'aide d'un balisage structurel et sémantique.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-108">XML is a good choice if you want a platform-independent model in order to ensure portability of the data by using structural and semantic markup.</span></span> <span data-ttu-id="3a0f2-109">De plus, cette solution semble mieux adaptée si certaines des conditions suivantes sont réunies :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-109">Additionally, it is an appropriate option if some of the following properties are satisfied:</span></span>  
  
-   <span data-ttu-id="3a0f2-110">Vos données sont éparses, vous n'en connaissez pas la structure ou la structure de vos données risque d'évoluer considérablement dans l'avenir.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-110">Your data is sparse or you do not know the structure of the data, or the structure of your data may change significantly in the future.</span></span>  
  
-   <span data-ttu-id="3a0f2-111">Vos données représentent une hiérarchie d'imbrications, et non des références entre entités, et peuvent être récursives.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-111">Your data represents containment hierarchy, instead of references among entities, and may be recursive.</span></span>  
  
-   <span data-ttu-id="3a0f2-112">L'ordre est inhérent dans vos données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-112">Order is inherent in your data.</span></span>  
  
-   <span data-ttu-id="3a0f2-113">Vous souhaitez interroger les données ou en mettre à jour certaines en fonction de leur structure.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-113">You want to query into the data or update parts of it, based on its structure.</span></span>  
  
 <span data-ttu-id="3a0f2-114">Si aucune de ces conditions n'est remplie, il est préférable d'utiliser le modèle de données relationnel.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-114">If none of these conditions is met, you should use the relational data model.</span></span> <span data-ttu-id="3a0f2-115">Par exemple, si vos données sont au format XML, alors que votre application n'utilise la base de données que pour stocker et récupérer les données, une colonne `[n]varchar(max)` suffit.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-115">For example, if your data is in XML format but your application just uses the database to store and retrieve the data, an `[n]varchar(max)` column is all you require.</span></span> <span data-ttu-id="3a0f2-116">Le stockage des données dans une colonne XML apporte d'autres avantages :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-116">Storing the data in an XML column has additional benefits.</span></span> <span data-ttu-id="3a0f2-117">le moteur peut vérifier que les données sont bien formées ou valides, et vous pouvez lancer des requêtes et des mises à jour à granularité fine sur les données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-117">This includes having the engine determine that the data is well formed or valid, and also includes support for fine-grained query and updates into the XML data.</span></span>  
  
## <a name="reasons-for-storing-xml-data-in-sql-server"></a><span data-ttu-id="3a0f2-118">Raisons justifiant le stockage des données XML dans SQL Server</span><span class="sxs-lookup"><span data-stu-id="3a0f2-118">Reasons for Storing XML Data in SQL Server</span></span>  
 <span data-ttu-id="3a0f2-119">Vous trouverez ici quelques bonnes raisons d'opter pour les fonctions XML natives de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] au lieu de gérer vos données XML dans le système de fichiers :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-119">Following are some of the reasons to use native XML features in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instead of managing your XML data in the file system:</span></span>  
  
-   <span data-ttu-id="3a0f2-120">Vous voulez partager, interroger et modifier vos données XML d'une manière efficace et transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-120">You want to share, query, and modify your XML data in an efficient and transacted way.</span></span> <span data-ttu-id="3a0f2-121">Votre application a besoin d'accéder aux données à un niveau très détaillé.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-121">Fine-grained data access is important to your application.</span></span> <span data-ttu-id="3a0f2-122">Par exemple, vous souhaitez extraire quelques passages d'un document XML, ou insérer une nouvelle section, sans avoir à remplacer l'ensemble du document.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-122">For example, you may want to extract some of the sections within an XML document, or you may want to insert a new section without replacing your whole document.</span></span>  
  
-   <span data-ttu-id="3a0f2-123">Vous disposez de données relationnelles et de données XML et souhaitez garantir une parfaite interopérabilité entre elles au sein de votre application.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-123">You have relational data and XML data and you want interoperability between both relational and XML data within your application.</span></span>  
  
-   <span data-ttu-id="3a0f2-124">Vous cherchez un langage permettant d'interroger et de modifier les données d'applications inter-domaines.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-124">You need language support for query and data modification for cross-domain applications.</span></span>  
  
-   <span data-ttu-id="3a0f2-125">Vous souhaitez que le serveur vérifie la bonne formation des données et valide éventuellement vos données par rapport à des schémas XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-125">You want the server to guarantee that the data is well formed and also optionally validate your data according to XML schemas.</span></span>  
  
-   <span data-ttu-id="3a0f2-126">Vous cherchez à indexer les données XML pour optimiser le traitement des requêtes et faciliter la montée en charge, et voulez profiter d'un optimiseur de requête de tout premier ordre.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-126">You want indexing of XML data for efficient query processing and good scalability, and the use of a first-rate query optimizer.</span></span>  
  
-   <span data-ttu-id="3a0f2-127">Vous voulez pouvoir accéder aux données XML par le biais de SOAP, ADO.NET et OLE DB.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-127">You want SOAP, ADO.NET, and OLE DB access to XML data.</span></span>  
  
-   <span data-ttu-id="3a0f2-128">Vous voulez profiter des fonctions d'administration du serveur de base de données pour gérer vos données XML,</span><span class="sxs-lookup"><span data-stu-id="3a0f2-128">You want to use administrative functionality of the database server for managing your XML data.</span></span> <span data-ttu-id="3a0f2-129">en cas de sauvegarde, de récupération et de réplication par exemple.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-129">For example, this would be backup, recovery, and replication.</span></span>  
  
 <span data-ttu-id="3a0f2-130">Si aucune de ces conditions n'est remplie, vous avez intérêt à stocker vos données dans un type d'objet volumineux non-XML, tel que `[n]varchar(max)` ou `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-130">If none of these conditions is satisfied, it may be better to store your data as a non-XML, large object type, such as `[n]varchar(max)` or `varbinary(max)`.</span></span>  
  
## <a name="xml-storage-options"></a><span data-ttu-id="3a0f2-131">Options de stockage XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-131">XML Storage Options</span></span>  
 <span data-ttu-id="3a0f2-132">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , vous disposez des options de stockage XML suivantes :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-132">The storage options for XML in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] include the following:</span></span>  
  
-   <span data-ttu-id="3a0f2-133">Stockage en mode natif dans le type de données `xml`</span><span class="sxs-lookup"><span data-stu-id="3a0f2-133">Native storage as `xml` data type</span></span>  
  
     <span data-ttu-id="3a0f2-134">Les données sont stockées dans une représentation interne qui conserve le contenu XML des données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-134">The data is stored in an internal representation that preserves the XML content of the data.</span></span> <span data-ttu-id="3a0f2-135">Cette représentation interne inclut des informations à propos de la hiérarchie de relations contenant-contenu, l'ordre des documents et les valeurs d'éléments et d'attributs.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-135">This internal representation includes information about the containment hierarchy, document order, and element and attribute values.</span></span> <span data-ttu-id="3a0f2-136">Plus précisément, le contenu InfoSet des données XML est préservé.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-136">Specifically, the InfoSet content of the XML data is preserved.</span></span> <span data-ttu-id="3a0f2-137">Pour plus d’informations sur InfoSet, consultez [http://www.w3.org/TR/xml-infoset](https://go.microsoft.com/fwlink/?LinkId=48843).</span><span class="sxs-lookup"><span data-stu-id="3a0f2-137">For more information about InfoSet, visit [http://www.w3.org/TR/xml-infoset](https://go.microsoft.com/fwlink/?LinkId=48843).</span></span> <span data-ttu-id="3a0f2-138">Le contenu InfoSet n'est pas une copie conforme du texte XML puisque les éléments suivants ne sont pas conservés : espaces non significatifs, ordre des attributs, préfixes d'espace de noms et déclaration XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-138">The InfoSet content may not be an identical copy of the text XML, because the following information is not retained: insignificant white spaces, order of attributes, namespace prefixes, and XML declaration.</span></span>  
  
     <span data-ttu-id="3a0f2-139">Pour `xml` un type de données typé, un `xml` type de données lié à des schémas XML, le jeu d’informations postérieures à la validation du schéma (PSVI) ajoute des informations de type au jeu d’informations et est encodé dans la représentation interne.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-139">For typed `xml` data type, an `xml` data type bound to XML schemas, the post-schema validation InfoSet (PSVI) adds type information to the InfoSet and is encoded in the internal representation.</span></span> <span data-ttu-id="3a0f2-140">L'analyse s'en trouve considérablement accélérée.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-140">This improves parsing speed significantly.</span></span> <span data-ttu-id="3a0f2-141">Pour plus d’informations, consultez les spécifications XML Schema de W3C sur [http://www.w3.org/TR/xmlschema-1](https://go.microsoft.com/fwlink/?LinkId=48881) et [http://www.w3.org/TR/xmlschema-2](https://go.microsoft.com/fwlink/?LinkId=4871).</span><span class="sxs-lookup"><span data-stu-id="3a0f2-141">For more information, see the W3C XML Schema specifications at [http://www.w3.org/TR/xmlschema-1](https://go.microsoft.com/fwlink/?LinkId=48881) and [http://www.w3.org/TR/xmlschema-2](https://go.microsoft.com/fwlink/?LinkId=4871).</span></span>  
  
-   <span data-ttu-id="3a0f2-142">Mappage entre stockage XML et relationnel</span><span class="sxs-lookup"><span data-stu-id="3a0f2-142">Mapping between XML and relational storage</span></span>  
  
     <span data-ttu-id="3a0f2-143">À l'aide d'un schéma annoté (AXSD), le code XML est décomposé en colonnes dans une ou plusieurs tables</span><span class="sxs-lookup"><span data-stu-id="3a0f2-143">By using an annotated schema (AXSD), the XML is decomposed into columns in one or more tables.</span></span> <span data-ttu-id="3a0f2-144">de façon à préserver la fidélité des données au niveau relationnel.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-144">This preserves fidelity of the data at the relational level.</span></span> <span data-ttu-id="3a0f2-145">La structure hiérarchique est ainsi conservée bien que l'ordre des éléments soit ignoré.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-145">As a result, the hierarchical structure is preserved although order among elements is ignored.</span></span> <span data-ttu-id="3a0f2-146">Le schéma ne peut pas être récursif.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-146">The schema cannot be recursive.</span></span>  
  
-   <span data-ttu-id="3a0f2-147">Stockage d'objets volumineux, `[n]varchar(max)` et `varbinary(max)`</span><span class="sxs-lookup"><span data-stu-id="3a0f2-147">Large object storage, `[n]varchar(max)` and `varbinary(max)`</span></span>  
  
     <span data-ttu-id="3a0f2-148">Une copie conforme des données est stockée.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-148">An identical copy of the data is stored.</span></span> <span data-ttu-id="3a0f2-149">Cela s'avère nécessaire pour des applications spécifiques telles que des documents juridiques.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-149">This is useful for special-purpose applications such as legal documents.</span></span> <span data-ttu-id="3a0f2-150">Généralement, les applications ne réclament pas une copie conforme et se satisfont du contenu XML (fidélité de l'InfoSet).</span><span class="sxs-lookup"><span data-stu-id="3a0f2-150">Most applications do not require an exact copy and are satisfied with the XML content (InfoSet fidelity).</span></span>  
  
 <span data-ttu-id="3a0f2-151">Dans la plupart des cas, vous aurez probablement à combiner ces deux approches.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-151">Generally, you may have to use a combination of these approaches.</span></span> <span data-ttu-id="3a0f2-152">Vous pouvez, par exemple, stocker vos données XML dans une colonne de type de données `xml` et en promouvoir les propriétés dans des colonnes relationnelles.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-152">For example, you may want to store your XML data in an `xml` data type column and promote properties from it into relational columns.</span></span> <span data-ttu-id="3a0f2-153">Vous pouvez également utiliser la technologie de mappage pour stocker des parties non réparties dans des colonnes non-XML et uniquement les parties récursives dans des `xml` colonnes de type de données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-153">Or, you may want to use mapping technology to store nonrecursive parts in non-XML columns and only the recursive parts in `xml` data type columns.</span></span>  
  
### <a name="choice-of-xml-technology"></a><span data-ttu-id="3a0f2-154">Choix de la technologie XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-154">Choice of XML Technology</span></span>  
 <span data-ttu-id="3a0f2-155">Le choix de la technologie XML, mode XML natif ou vue XML, dépend généralement des facteurs suivants :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-155">The choice of XML technology, native XML versus XML view, generally depends upon the following factors:</span></span>  
  
-   <span data-ttu-id="3a0f2-156">Options de stockage</span><span class="sxs-lookup"><span data-stu-id="3a0f2-156">Storage options</span></span>  
  
     <span data-ttu-id="3a0f2-157">Vos données XML sont peut-être plus adaptées à un stockage d'objet volumineux (manuel de produit, par exemple) ou à un stockage en colonnes relationnelles (article converti en XML, par exemple).</span><span class="sxs-lookup"><span data-stu-id="3a0f2-157">Your XML data may be more appropriate for large object storage (for example, a product manual), or more amenable to storage in relational columns (for example, a line item converted to XML).</span></span> <span data-ttu-id="3a0f2-158">Chaque option de stockage préserve la fidélité du document à sa manière.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-158">Each storage option preserves document fidelity to a different extent.</span></span>  
  
-   <span data-ttu-id="3a0f2-159">Interrogation des données par requête</span><span class="sxs-lookup"><span data-stu-id="3a0f2-159">Query capabilities</span></span>  
  
     <span data-ttu-id="3a0f2-160">Vous trouverez peut-être qu'une option de stockage convient mieux qu'une autre en fonction de la nature de vos requêtes et de la façon dont vous interrogez vos données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-160">You may find one storage option more appropriate than another, based on the nature of your queries and on the extent to which you query your XML data.</span></span> <span data-ttu-id="3a0f2-161">Les requêtes à granularité fine sur des données XML, évaluation de prédicat sur des nœuds XML par exemple, ne sont prises en charge qu'à des degrés divers dans les deux options de stockage.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-161">Fine-grained query of your XML data, for example, predicate evaluation on XML nodes, is supported to varying degrees in the two storage options.</span></span>  
  
-   <span data-ttu-id="3a0f2-162">Indexation des données XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-162">Indexing XML data</span></span>  
  
     <span data-ttu-id="3a0f2-163">Vous cherchez peut-être à indexer les données XML de manière à optimiser les performances des requêtes XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-163">You may want to index the XML data to speed up XML query performance.</span></span> <span data-ttu-id="3a0f2-164">Les options d'indexation varient avec les options de stockage. Il vous appartient de choisir la solution la mieux adaptée à l'optimisation de votre charge de travail.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-164">Indexing options vary with the storage options; you have to make the appropriate choice to optimize your workload.</span></span>  
  
-   <span data-ttu-id="3a0f2-165">Modification des données</span><span class="sxs-lookup"><span data-stu-id="3a0f2-165">Data modification capabilities</span></span>  
  
     <span data-ttu-id="3a0f2-166">Certaines charges de travail impliquent la modification des données XML à un degré de granularité assez fin.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-166">Some workloads involve fine-grained modification of XML data.</span></span> <span data-ttu-id="3a0f2-167">Il peut s'agir, notamment, d'ajouter une nouvelle section à un document sans que d'autres charges de travail, le contenu Web par exemple, ne soient concernées.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-167">For example, this can include adding a new section within a document, while other workloads, such as Web content, do not.</span></span> <span data-ttu-id="3a0f2-168">La prise en charge d'un langage de modification des données peut jouer un rôle essentiel pour votre application.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-168">Data modification language support may be important for your application.</span></span>  
  
-   <span data-ttu-id="3a0f2-169">Prise en charge des schémas</span><span class="sxs-lookup"><span data-stu-id="3a0f2-169">Schema support</span></span>  
  
     <span data-ttu-id="3a0f2-170">Vos données XML peuvent être décrites par un schéma qui peut (ou non) être un document de schéma XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-170">Your XML data may be described by a schema that may or may not be an XML schema document.</span></span> <span data-ttu-id="3a0f2-171">La prise en charge de code XML associé à un schéma dépend de la technologie XML adoptée.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-171">The support for schema-bound XML depends upon the XML technology.</span></span>  
  
 <span data-ttu-id="3a0f2-172">Qui dit choix différents, dit aussi performances différentes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-172">Different choices also have different performance characteristics.</span></span>  
  
### <a name="native-xml-storage"></a><span data-ttu-id="3a0f2-173">Stockage XML natif</span><span class="sxs-lookup"><span data-stu-id="3a0f2-173">Native XML Storage</span></span>  
 <span data-ttu-id="3a0f2-174">Vous pouvez stocker vos données XML dans une colonne de type de données `xml` sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-174">You can store your XML data in an `xml` data type column at the server.</span></span> <span data-ttu-id="3a0f2-175">C'est une solution de choix si vous vous trouvez dans les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-175">This is an appropriate choice if the following applies:</span></span>  
  
-   <span data-ttu-id="3a0f2-176">Vous cherchez un moyen simple de stocker vos données XML sur le serveur et voulez, en parallèle, préserver l'ordre et la structure du document.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-176">You want a straightforward way to store your XML data at the server and, at the same time, preserve document order and document structure.</span></span>  
  
-   <span data-ttu-id="3a0f2-177">Vous disposez ou non d'un schéma pour vos données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-177">You may or may not have a schema for your XML data.</span></span>  
  
-   <span data-ttu-id="3a0f2-178">Vous voulez pouvoir interroger et modifier vos données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-178">You want to query and modify your XML data.</span></span>  
  
-   <span data-ttu-id="3a0f2-179">Vous voulez indexer les données XML pour accélérer le traitement des requêtes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-179">You want to index the XML data for faster query processing.</span></span>  
  
-   <span data-ttu-id="3a0f2-180">Votre application a besoin d'affichages catalogue système pour gérer vos données XML et vos schémas XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-180">Your application needs system catalog views to administer your XML data and XML schemas.</span></span>  
  
 <span data-ttu-id="3a0f2-181">Le stockage XML natif est utile lorsque les documents XML présentent des structures différentes ou suivent des schémas différents ou complexes beaucoup trop difficiles à mapper à des structures relationnelles.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-181">Native XML storage is useful when you have XML documents that have a range of structures, or you have XML documents that conform to different or complex schemas that are too hard to map to relational structures.</span></span>  
  
#### <a name="example-modeling-xml-data-using-the-xml-data-type"></a><span data-ttu-id="3a0f2-182">Exemple : modélisation de données XML à l’aide du type de données xml</span><span class="sxs-lookup"><span data-stu-id="3a0f2-182">Example: Modeling XML Data Using the xml Data Type</span></span>  
 <span data-ttu-id="3a0f2-183">Prenons l'exemple d'un manuel de produit au format XML. Chaque rubrique fait l'objet d'un chapitre distinct, lui-même composé de plusieurs sections.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-183">Consider a product manual in XML format that is made up of a separate chapter for each topic and that has multiple sections within each chapter.</span></span> <span data-ttu-id="3a0f2-184">Une section peut contenir des sous-sections.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-184">A section can contain subsections.</span></span> <span data-ttu-id="3a0f2-185">L’élément \<section> est donc un élément récursif.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-185">As a result, \<section> is a recursive element.</span></span> <span data-ttu-id="3a0f2-186">Les manuels de produit regroupent un gros volume de données diverses : contenu, diagrammes, explications techniques ; les données sont semi-structurées.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-186">Product manuals contain a large amount of mixed content, diagrams, and technical material; the data is semi-structured.</span></span> <span data-ttu-id="3a0f2-187">Les utilisateurs veulent pouvoir lancer une recherche contextuelle sur les rubriques qui les intéressent, par exemple rechercher la section consacrée aux « index cluster » dans le chapitre sur l'« indexation », et s'informer des quantités techniques.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-187">Users may want to perform a contextual search for topics of interest such as searching for the section on "clustered index" within the chapter on "indexing", and query technical quantities.</span></span>  
  
 <span data-ttu-id="3a0f2-188">Une colonne de type de données `xml` constitue un modèle de stockage approprié pour vos documents XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-188">An appropriate storage model for your XML documents is an `xml` data type column.</span></span> <span data-ttu-id="3a0f2-189">Vous conservez ainsi le contenu InfoSet de vos données XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-189">This preserves the InfoSet content of your XML data.</span></span> <span data-ttu-id="3a0f2-190">L'indexation de la colonne XML permet d'optimiser les performances des requêtes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-190">Indexing the XML column benefits query performance.</span></span>  
  
#### <a name="example-retaining-exact-copies-of-xml-data"></a><span data-ttu-id="3a0f2-191">Exemple : conservation de copies conformes des données XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-191">Example: Retaining Exact Copies of XML Data</span></span>  
 <span data-ttu-id="3a0f2-192">Supposons, par exemple, que la législation en vigueur vous oblige à conserver des copies textuelles conformes de vos documents XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-192">For illustration, assume that government regulations require you to retain exact textual copies of your XML documents.</span></span> <span data-ttu-id="3a0f2-193">Il pourrait s'agir notamment de documents signés, de documents juridiques ou d'ordres boursiers.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-193">For example, these could include signed documents, legal documents, or stock transaction orders.</span></span> <span data-ttu-id="3a0f2-194">Vous pouvez stocker vos documents dans une colonne `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-194">You may want to store your documents in a `[n]varchar(max)` column.</span></span>  
  
 <span data-ttu-id="3a0f2-195">Pour ce qui est des requêtes, convertissez les données en données de type `xml` lors de l'exécution et appliquez-leur une requête Xquery.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-195">For querying, convert the data to `xml` data type at run time and execute Xquery on it.</span></span> <span data-ttu-id="3a0f2-196">La conversion lors de l'exécution peut s'avérer onéreuse, surtout si le document est volumineux.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-196">The run-time conversion may be costly, especially when the document is large.</span></span> <span data-ttu-id="3a0f2-197">Si vous exécutez fréquemment des requêtes, vous pouvez stocker les documents de façon redondante dans une colonne de type de données `xml`, puis indexer cette dernière lorsque vous retournez des copies conformes à partir de la colonne `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-197">If you query frequently, you can redundantly store the documents in an `xml` data type column and index it while you return exact document copies from the `[n]varchar(max)` column.</span></span>  
  
 <span data-ttu-id="3a0f2-198">La colonne XML peut être une colonne calculée, basée sur la colonne `[n]varchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-198">The XML column may be a computed column, based on the `[n]varchar(max)` column.</span></span> <span data-ttu-id="3a0f2-199">Toutefois, vous ne pouvez pas créer d’index XML sur une colonne XML calculée, ni sur des `[n]varchar(max)` `varbinary(max)` colonnes ou.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-199">However, you cannot create an XML index on a computed, XML column, nor can an XML index be built on `[n]varchar(max)` or `varbinary(max)` columns.</span></span>  
  
### <a name="xml-view-technology"></a><span data-ttu-id="3a0f2-200">Vue XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-200">XML View Technology</span></span>  
 <span data-ttu-id="3a0f2-201">En définissant un mappage entre vos schémas XML et les tables d'une base de données, vous créez une « vue XML » de vos données persistantes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-201">By defining a mapping between your XML schemas and the tables in a database, you create an "XML view" of your persistent data.</span></span> <span data-ttu-id="3a0f2-202">Le chargement en masse XML peut servir à remplir les tables sous-jacentes d'après la vue XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-202">XML bulk load can be used to populate the underlying tables by using the XML view.</span></span> <span data-ttu-id="3a0f2-203">Vous pouvez aussi interroger la vue XML en utilisant XPath version 1.0 ; la requête est traduite en requêtes SQL portant sur les tables.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-203">You can query the XML view by using XPath version 1.0; the query is translated to SQL queries on the tables.</span></span> <span data-ttu-id="3a0f2-204">De même, les mises à jour peuvent se propager à ces tables.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-204">Similarly, updates are also propagated to those tables.</span></span>  
  
 <span data-ttu-id="3a0f2-205">Les vues XML sont utiles dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-205">This technology is useful in the following situations:</span></span>  
  
-   <span data-ttu-id="3a0f2-206">Vous voulez avoir un modèle de programmation orienté XML en utilisant des vues XML des données relationnelles existantes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-206">You want to have an XML-centric programming model using XML views over your existing relational data.</span></span>  
  
-   <span data-ttu-id="3a0f2-207">Vous avez un schéma (XSD, XDR) pour vos données XML qu'un partenaire externe vous a fourni.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-207">You have a schema (XSD, XDR) for your XML data that an external partner may have provided.</span></span>  
  
-   <span data-ttu-id="3a0f2-208">L'ordre de vos données importe peu, les données des tables de requête ne sont pas récursives, ou la profondeur de récursivité maximale est connue à l'avance.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-208">Order is not important in your data, or your query table data is not recursive, or the maximal recursion depth is known in advance.</span></span>  
  
-   <span data-ttu-id="3a0f2-209">Vous voulez interroger et modifier les données via la vue XML en utilisant XPath version 1.0.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-209">You want to query and modify the data through the XML view by using XPath version 1.0.</span></span>  
  
-   <span data-ttu-id="3a0f2-210">Vous voulez charger en masse les données XML, puis les répartir dans les tables sous-jacentes à l'aide de la vue XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-210">You want to bulk load XML data and decompose them into the underlying tables by using the XML view.</span></span>  
  
 <span data-ttu-id="3a0f2-211">Il pourrait s'agir de données relationnelles exposées au format XML pour l'échange des données et les services Web, et de données XML avec un schéma fixe.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-211">Examples include relational data exposed as XML for data exchange and Web services, and XML data with fixed schema.</span></span> <span data-ttu-id="3a0f2-212">Pour plus d'informations, consultez [MSDN Online Library](https://go.microsoft.com/fwlink/?linkid=31174)(éventuellement en anglais).</span><span class="sxs-lookup"><span data-stu-id="3a0f2-212">For more information, see the [MSDN Online Library](https://go.microsoft.com/fwlink/?linkid=31174).</span></span>  
  
#### <a name="example-modeling-data-using-an-annotated-xml-schema-axsd"></a><span data-ttu-id="3a0f2-213">Exemple : modélisation des données à l’aide d’un schéma XML annoté (AXSD)</span><span class="sxs-lookup"><span data-stu-id="3a0f2-213">Example: Modeling Data Using an Annotated XML Schema (AXSD)</span></span>  
 <span data-ttu-id="3a0f2-214">Partons du principe que vous disposez de données relationnelles (clients, commandes et articles) et que vous voulez les gérer sous forme XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-214">For illustration, assume that you have existing relational data, such as customers, orders, and line items, that you want to handle as XML.</span></span> <span data-ttu-id="3a0f2-215">Définissez une vue XML en utilisant AXSD sur les données relationnelles.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-215">Define an XML view by using AXSD over the relational data.</span></span> <span data-ttu-id="3a0f2-216">La vue XML vous permet de charger en masse les données XML dans vos tables, puis d'interroger et de mettre à jour les données relationnelles à l'aide de la vue XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-216">The XML view allows you to bulk load XML data into your tables and query and update the relational data by using the XML view.</span></span> <span data-ttu-id="3a0f2-217">Ce modèle s'avère très utile si vous avez à échanger des données contenant des balises XML avec d'autres applications alors que les applications SQL fonctionnent sans interruption.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-217">This model is useful if you have to exchange data that contains XML markup with other applications while your SQL applications work uninterrupted.</span></span>  
  
### <a name="hybrid-model"></a><span data-ttu-id="3a0f2-218">Modèle hybride</span><span class="sxs-lookup"><span data-stu-id="3a0f2-218">Hybrid Model</span></span>  
 <span data-ttu-id="3a0f2-219">Souvent, une combinaison de colonnes relationnelles et de `xml` colonnes de type de données est appropriée pour la modélisation des données.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-219">Frequently, a combination of relational and `xml` data type columns is appropriate for data modeling.</span></span> <span data-ttu-id="3a0f2-220">Certaines valeurs de vos données XML peuvent être stockées dans des colonnes relationnelles alors que le reste (ou la totalité) des valeurs XML sont stockées dans une colonne XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-220">Some of the values from your XML data can be stored in relational columns, and the rest, or the whole XML value stored in an XML column.</span></span> <span data-ttu-id="3a0f2-221">Vous obtenez ainsi de meilleures performances puisque vous avez une meilleure maîtrise des index créés sur les colonnes relationnelles et sur les caractéristiques des verrous.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-221">This may yield better performance in that you have more control over the indexes created on the relational columns and locking characteristics.</span></span>  
  
 <span data-ttu-id="3a0f2-222">Les valeurs à stocker dans les colonnes relationnelles dépendent de votre charge de travail.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-222">The values to store in relational columns depend on your workload.</span></span> <span data-ttu-id="3a0f2-223">Par exemple, si vous récupérez toutes les valeurs XML en fonction de l’expression de chemin, /Customer/@CustId, en promouvant la valeur de l’attribut **CustId** dans une colonne relationnelle et en l’indexant, vous pouvez accélérer notablement le traitement des requêtes.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-223">For example, if you retrieve all the XML values based on the path expression, /Customer/@CustId, promoting the value of the **CustId** attribute into a relational column and indexing it may yield faster query performance.</span></span> <span data-ttu-id="3a0f2-224">En revanche, si vos données XML sont largement décomposées de façon non redondante dans des colonnes relationnelles, le réassemblage risque de s'avérer fort coûteux.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-224">On the other hand, if your XML data is extensively and nonredundantly decomposed into relational columns, the re-assembly cost may be significant.</span></span>  
  
 <span data-ttu-id="3a0f2-225">Pour des données XML très structurées, par exemple, le contenu d'une table a été converti en XML de façon à pouvoir mapper toutes les valeurs aux colonnes relationnelles, et éventuellement faire appel aux vues XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-225">For highly structured XML data, for example, the content of a table has been converted into XML; you can map all values to relational columns, and possibly use XML view technology.</span></span>  
  
## <a name="granularity-of-xml-data"></a><span data-ttu-id="3a0f2-226">Granularité des données XML</span><span class="sxs-lookup"><span data-stu-id="3a0f2-226">Granularity of XML Data</span></span>  
 <span data-ttu-id="3a0f2-227">La granularité des données XML stockées dans une colonne XML est d'une importance capitale pour le verrouillage et de moindre importance pour les mises à jour.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-227">The granularity of the XML data stored in an XML column is very important for locking and, to a lesser degree, it is also important for updates.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="3a0f2-228">utilise le même mécanisme de verrouillage, qu’il s’agisse de données XML ou non XML.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-228">uses the same locking mechanism for both XML and non-XML data.</span></span> <span data-ttu-id="3a0f2-229">Par conséquent, le verrouillage au niveau de la ligne verrouille toutes les instances XML de la ligne.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-229">Therefore, row-level locking causes all XML instances in the row to be locked.</span></span> <span data-ttu-id="3a0f2-230">En cas de grosse granularité, le verrouillage des grosses instances XML pendant les mises à jour provoque une baisse de la capacité de traitement dans un scénario multi-utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-230">When the granularity is large, locking large XML instances for updates causes throughput to decline in a multiuser scenario.</span></span> <span data-ttu-id="3a0f2-231">En cas de décomposition fine, l'encapsulation des objets est perdue et le coût de réassemblage augmente.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-231">On the other hand, severe decomposition loses object encapsulation and increases reassembly cost.</span></span>  
  
 <span data-ttu-id="3a0f2-232">Pour le bien de la conception, il est essentiel de trouver un juste équilibre entre les exigences de la modélisation des données et les critères de verrouillage et de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-232">A balance between data modeling requirements and locking and update characteristics is important for good design.</span></span> <span data-ttu-id="3a0f2-233">Toutefois, dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la taille des instances XML stockées proprement dites ne revêt pas une telle importante.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-233">However, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the size of actual stored XML instances is not as critical.</span></span>  
  
 <span data-ttu-id="3a0f2-234">Par exemple, les mises à jour d'une instance XML s'effectuent à l'aide d'une nouvelle prise en charge des mises à jour partielles d'objets blob et d'index au cours desquelles l'instance XML stockée est comparée à sa version mise à jour.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-234">For example, updates to an XML instance are performed by using new support for partial binary large object (BLOB) and partial index updates in which the existing stored XML instance is compared to its updated version.</span></span> <span data-ttu-id="3a0f2-235">En cas de mises à jour partielles d'objets blob, une comparaison différentielle des deux instances XML a lieu et seules les différences sont mises à jour.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-235">Partial binary large object (BLOB) update performs a differential comparison between the two XML instances and updates only the differences.</span></span> <span data-ttu-id="3a0f2-236">En cas de mises à jour partielles d'index, seules les lignes devant être changées dans l'index XML sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-236">Partial index updates modify only those rows that must be changed in the XML index.</span></span>  
  
## <a name="limitations-of-the-xml-data-type"></a><span data-ttu-id="3a0f2-237">Limites du type de données xml</span><span class="sxs-lookup"><span data-stu-id="3a0f2-237">Limitations of the xml Data Type</span></span>  
 <span data-ttu-id="3a0f2-238">Notez les limitations générales suivantes applicables au type de données `xml` :</span><span class="sxs-lookup"><span data-stu-id="3a0f2-238">Note the following general limitations that apply to the `xml` data type:</span></span>  
  
-   <span data-ttu-id="3a0f2-239">La représentation stockée d'instances de type de données `xml` ne peut pas dépasser 2 Go.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-239">The stored representation of `xml` data type instances cannot exceed 2 GB.</span></span>  
  
-   <span data-ttu-id="3a0f2-240">Il ne peut pas être utilisé comme sous-type d’une instance **sql_variant** .</span><span class="sxs-lookup"><span data-stu-id="3a0f2-240">It cannot be used as a subtype of a **sql_variant** instance.</span></span>  
  
-   <span data-ttu-id="3a0f2-241">Il ne prend pas en charge la conversion en `text` ni en `ntext`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-241">It does not support casting or converting to either `text` or `ntext`.</span></span> <span data-ttu-id="3a0f2-242">Utilisez plutôt `varchar(max)` ou `nvarchar(max)`.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-242">Use `varchar(max)` or `nvarchar(max)` instead.</span></span>  
  
-   <span data-ttu-id="3a0f2-243">Il ne peut pas être comparé ni trié.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-243">It cannot be compared or sorted.</span></span> <span data-ttu-id="3a0f2-244">Autrement dit, un type de données `xml` ne peut pas être utilisé dans une instruction GROUP BY.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-244">This means an `xml` data type cannot be used in a GROUP BY statement.</span></span>  
  
-   <span data-ttu-id="3a0f2-245">Il ne peut pas être utilisé en tant que paramètre d'une fonction scalaire intégrée autre que ISNULL, COALESCE et DATALENGTH.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-245">It cannot be used as a parameter to any scalar, built-in functions other than ISNULL, COALESCE, and DATALENGTH.</span></span>  
  
-   <span data-ttu-id="3a0f2-246">Il ne peut pas être utilisé en tant que colonne clé dans un index.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-246">It cannot be used as a key column in an index.</span></span> <span data-ttu-id="3a0f2-247">En revanche, il peut être inclus en tant que donnée dans un index cluster ou ajouté explicitement à un index non-cluster à l'aide du mot clé INCLUDE lors de la création d'un index non-cluster.</span><span class="sxs-lookup"><span data-stu-id="3a0f2-247">However, it can be included as data in a clustered index or explicitly added to a nonclustered index by using the INCLUDE keyword when the nonclustered index is created.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3a0f2-248">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3a0f2-248">See Also</span></span>  
 [<span data-ttu-id="3a0f2-249">Exemples d’importation et d’exportation en bloc de documents XML &#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="3a0f2-249">Examples of Bulk Import and Export of XML Documents &#40;SQL Server&#41;</span></span>](../import-export/examples-of-bulk-import-and-export-of-xml-documents-sql-server.md)  
  
  
