---
title: Attacher des indicateurs de requête à un repère de plan | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: performance
ms.topic: conceptual
ms.assetid: 2131f796-6359-4f9e-9047-da0b3d4dedaf
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 074c69ffefd2b5a7b2ef445f941f97b7130b0732
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611744"
---
# <a name="attach-query-hints-to-a-plan-guide"></a><span data-ttu-id="62d71-102">Attacher des indicateurs de requête à un repère de plan</span><span class="sxs-lookup"><span data-stu-id="62d71-102">Attach Query Hints to a Plan Guide</span></span>
  <span data-ttu-id="62d71-103">Toute combinaison d'indicateurs de requête valides peut être utilisée dans un repère de plan.</span><span class="sxs-lookup"><span data-stu-id="62d71-103">Any combination of valid query hints can be used in a plan guide.</span></span> <span data-ttu-id="62d71-104">Lorsqu'un repère de plan correspond à une requête, la clause OPTION spécifiée dans la clause des indicateurs d'un repère de plan est ajoutée à la requête avant qu'elle ne soit compilée et optimisée.</span><span class="sxs-lookup"><span data-stu-id="62d71-104">When a plan guide matches a query, the OPTION clause specified in the hints clause of a plan guide is added to the query before it compiles and optimizes.</span></span> <span data-ttu-id="62d71-105">Si une requête mise en correspondance avec un repère de plan possède déjà une clause OPTION, les indicateurs de requête spécifiés dans le repère de plan remplacent ceux existant dans la requête.</span><span class="sxs-lookup"><span data-stu-id="62d71-105">If a query that is matched to a plan guide already has an OPTION clause, the query hints specified in the plan guide replace those in the query.</span></span> <span data-ttu-id="62d71-106">Toutefois, pour qu'un repère de plan corresponde à une requête possédant déjà une clause OPTION, vous devez inclure la clause OPTION de la requête lorsque vous spécifiez le texte de la requête avec laquelle établir la correspondance dans l'instruction sp_create_plan_guide.</span><span class="sxs-lookup"><span data-stu-id="62d71-106">However, for a plan guide to match a query that already has an OPTION clause, you must include the OPTION clause of the query when you specify the text of the query to match in the sp_create_plan_guide statement.</span></span> <span data-ttu-id="62d71-107">Si vous souhaitez que les indicateurs spécifiés dans le repère de plan soient ajoutés aux indicateurs qui existent déjà sur la requête, au lieu de les remplacer, vous devez spécifier les indicateurs d'origine et les indicateurs supplémentaires dans la clause OPTION du repère de plan.</span><span class="sxs-lookup"><span data-stu-id="62d71-107">If you want the hints specified in the plan guide to be added to the hints that already exist on the query, instead of replacing them, you must specify both the original hints and the additional hints in the OPTION clause of the plan guide.</span></span>  
  
> [!CAUTION]  
>  <span data-ttu-id="62d71-108">Les repères de plan qui utilisent les indicateurs de requête à mauvais escient peuvent entraîner des problèmes de compilation, d'exécution ou de performances.</span><span class="sxs-lookup"><span data-stu-id="62d71-108">Plan guides that misuse query hints can cause compilation, execution, or performance problems.</span></span> <span data-ttu-id="62d71-109">Les repères de plan doivent être utilisés uniquement par des administrateurs de base de données et des développeurs expérimentés.</span><span class="sxs-lookup"><span data-stu-id="62d71-109">Plan guides should be used only by experienced developers and database administrators.</span></span>  
  
## <a name="common-query-hints-used-in-plan-guides"></a><span data-ttu-id="62d71-110">Indicateurs de requêtes courants utilisés dans les repères de plan</span><span class="sxs-lookup"><span data-stu-id="62d71-110">Common Query Hints Used in Plan Guides</span></span>  
 <span data-ttu-id="62d71-111">Les requêtes qui peuvent tirer parti des repères de plan sont généralement les requêtes paramétrables et celles qui peuvent présenter des performances médiocres parce qu'elles utilisent des plans de requête en cache dont les valeurs de paramètre ne représentent pas un scénario pessimiste ou le plus représentatif.</span><span class="sxs-lookup"><span data-stu-id="62d71-111">Queries that can benefit from plan guides are generally parameter-based, and may be performing poorly because they use cached query plans whose parameter values do not represent a worst-case or most representative scenario.</span></span> <span data-ttu-id="62d71-112">Les indicateurs de requête OPTIMIZE FOR et RECOMPILE peuvent être employés pour résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="62d71-112">The OPTIMIZE FOR and RECOMPILE query hints can be used to address this problem.</span></span> <span data-ttu-id="62d71-113">OPTIMIZE FOR prescrit à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] d'utiliser une valeur particulière pour un paramètre quand la requête est optimisée.</span><span class="sxs-lookup"><span data-stu-id="62d71-113">OPTIMIZE FOR instructs [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to use a particular value for a parameter when the query is optimized.</span></span> <span data-ttu-id="62d71-114">RECOMPILE indique au serveur d'ignorer le plan de requête après exécution, forçant l'optimiseur de requête à recompiler un nouveau plan de requête lors de l'exécution suivante de la même requête.</span><span class="sxs-lookup"><span data-stu-id="62d71-114">RECOMPILE instructs the server to discard a query plan after execution, forcing the query optimizer to recompile a new query plan the next time that the same query is executed.</span></span> <span data-ttu-id="62d71-115">Pour obtenir un exemple, consultez [Repères de plan](plan-guides.md).</span><span class="sxs-lookup"><span data-stu-id="62d71-115">For an example, see [Plan Guides](plan-guides.md).</span></span>  
  
 <span data-ttu-id="62d71-116">Vous pouvez aussi spécifier les indicateurs de table INDEX, FORCESCAN et FORCESEEK en tant qu'indicateurs de requête.</span><span class="sxs-lookup"><span data-stu-id="62d71-116">In addition, you can specify the table hints INDEX, FORCESCAN, and FORCESEEK as query hints.</span></span> <span data-ttu-id="62d71-117">Lorsqu'ils sont spécifiés en tant qu'indicateurs de requête, ces indicateurs se comportent comme une table inline ou une astuce de vue.</span><span class="sxs-lookup"><span data-stu-id="62d71-117">When specified as query hints, these hints behave like an inline table or view hint.</span></span> <span data-ttu-id="62d71-118">L'indicateur INDEX force l'optimiseur de requête à utiliser uniquement les index spécifiés pour accéder aux données dans la table ou la vue référencée.</span><span class="sxs-lookup"><span data-stu-id="62d71-118">The INDEX hint forces the query optimizer to use only the specified indexes to access the data in the referenced table or view.</span></span> <span data-ttu-id="62d71-119">L'indicateur FORCESEEK force l'optimiseur à utiliser uniquement une opération de recherche d'index pour accéder aux données dans la table ou la vue référencée.</span><span class="sxs-lookup"><span data-stu-id="62d71-119">The FORCESEEK hint forces the optimizer to use only an index seek operation to access the data in the referenced table or view.</span></span> <span data-ttu-id="62d71-120">Ces indicateurs fournissent des fonctionnalités de repère de plan supplémentaires et vous permettent de mieux contrôler l'optimisation des requêtes qui utilisent le repère de plan.</span><span class="sxs-lookup"><span data-stu-id="62d71-120">These hints provide additional plan guide functionality and allow you to have more influence over the optimization of queries that use the plan guide.</span></span>  
  
  
