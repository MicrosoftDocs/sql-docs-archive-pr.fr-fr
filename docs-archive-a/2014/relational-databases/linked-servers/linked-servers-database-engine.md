---
title: Serveurs liés (Moteur de base de données) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB, linked servers
- OLE DB provider, linked servers
- server management [SQL Server], linked servers
- linked servers [SQL Server]
- distributed queries [SQL Server], linked servers
- servers [SQL Server], linked
- remote servers [SQL Server], linked servers
- linked servers [SQL Server], about linked servers
ms.assetid: 6ef578bf-8da7-46e0-88b5-e310fc908bb0
author: stevestein
ms.author: sstein
ms.openlocfilehash: 4a1de70882cdeb87ccc0ae42aa23a9b6c8b3248e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600886"
---
# <a name="linked-servers-database-engine"></a><span data-ttu-id="effb8-102">Serveurs liés (Moteur de base de données)</span><span class="sxs-lookup"><span data-stu-id="effb8-102">Linked Servers (Database Engine)</span></span>
  <span data-ttu-id="effb8-103">Configurez un serveur lié pour permettre à [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] d'exécuter des commandes sur des sources de données OLE DB situées en dehors de l'instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="effb8-103">Configure a linked server to enable the [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] to execute commands against OLE DB data sources outside of the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="effb8-104">En général, les serveurs liés sont configurés pour permettre au [!INCLUDE[ssDE](../../includes/ssde-md.md)] d'exécuter une instruction [!INCLUDE[tsql](../../includes/tsql-md.md)] qui inclut des tables situées dans une autre instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]ou un autre produit de base de données comme Oracle.</span><span class="sxs-lookup"><span data-stu-id="effb8-104">Typically linked servers are configured to enable the [!INCLUDE[ssDE](../../includes/ssde-md.md)] to execute a [!INCLUDE[tsql](../../includes/tsql-md.md)] statement that includes tables in another instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], or another database product such as Oracle.</span></span> <span data-ttu-id="effb8-105">De nombreux types de sources de données OLE DB peuvent être configurés comme serveurs liés, y compris [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access et Excel.</span><span class="sxs-lookup"><span data-stu-id="effb8-105">Many types OLE DB data sources can be configured as linked servers, including [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Access and Excel.</span></span> <span data-ttu-id="effb8-106">Les serveurs liés offrent les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="effb8-106">Linked servers offer the following advantages:</span></span>

-   <span data-ttu-id="effb8-107">la possibilité d'accéder à des données extérieures à [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)];</span><span class="sxs-lookup"><span data-stu-id="effb8-107">The ability to access data from outside of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

-   <span data-ttu-id="effb8-108">la possibilité d'émettre des requêtes, des mises à jour, des commandes et des transactions partagées sur des sources de données hétérogènes situées dans les différents services de l'entreprise ;</span><span class="sxs-lookup"><span data-stu-id="effb8-108">The ability to issue distributed queries, updates, commands, and transactions on heterogeneous data sources across the enterprise.</span></span>

-   <span data-ttu-id="effb8-109">la possibilité de traiter diverses sources de données de manière identique.</span><span class="sxs-lookup"><span data-stu-id="effb8-109">The ability to address diverse data sources similarly.</span></span>

 <span data-ttu-id="effb8-110">Vous pouvez configurer un serveur lié en utilisant [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] ou à l’aide de l’instruction [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) .</span><span class="sxs-lookup"><span data-stu-id="effb8-110">You can configure a linked server by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)] or by using the [sp_addlinkedserver &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql) statement.</span></span> <span data-ttu-id="effb8-111">Le type et le nombre de paramètres requis sont très différents en fonction des fournisseurs OLE DB.</span><span class="sxs-lookup"><span data-stu-id="effb8-111">OLE DB providers vary greatly in the type and number of parameters required.</span></span> <span data-ttu-id="effb8-112">Par exemple, certains fournisseurs exigent que vous fournissiez un contexte de sécurité pour la connexion à l’aide de [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="effb8-112">For example some providers require you to provide a security context for the connection using [sp_addlinkedsrvlogin &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql).</span></span> <span data-ttu-id="effb8-113">Certains fournisseurs OLE DB autorisent [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] à mettre à jour les données sur la source OLE DB.</span><span class="sxs-lookup"><span data-stu-id="effb8-113">Some OLE DB providers allow [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] to update data on the OLE DB source.</span></span> <span data-ttu-id="effb8-114">D'autres fournissent uniquement un accès en lecture seule aux données.</span><span class="sxs-lookup"><span data-stu-id="effb8-114">Others provide only read-only data access.</span></span> <span data-ttu-id="effb8-115">Pour plus d'informations sur chaque fournisseur OLE DB, consultez sa documentation.</span><span class="sxs-lookup"><span data-stu-id="effb8-115">For information about each OLE DB provider, consult documentation for that OLE DB provider.</span></span>

## <a name="linked-server-components"></a><span data-ttu-id="effb8-116">Composants des serveurs liés</span><span class="sxs-lookup"><span data-stu-id="effb8-116">Linked Server Components</span></span>
 <span data-ttu-id="effb8-117">Une définition de serveur lié spécifie les objets suivants :</span><span class="sxs-lookup"><span data-stu-id="effb8-117">A linked server definition specifies the following objects:</span></span>

-   <span data-ttu-id="effb8-118">Un fournisseur OLE°DB</span><span class="sxs-lookup"><span data-stu-id="effb8-118">An OLE DB provider</span></span>

-   <span data-ttu-id="effb8-119">Une source de données OLE°DB</span><span class="sxs-lookup"><span data-stu-id="effb8-119">An OLE DB data source</span></span>

 <span data-ttu-id="effb8-120">Un *fournisseur OLE°DB* représente une DLL qui gère une source de données spécifique et interagit avec elle.</span><span class="sxs-lookup"><span data-stu-id="effb8-120">An *OLE DB provider* is a DLL that manages and interacts with a specific data source.</span></span> <span data-ttu-id="effb8-121">Une *source de données OLE DB* identifie la base de données spécifique accessible via OLE DB.</span><span class="sxs-lookup"><span data-stu-id="effb8-121">An *OLE DB data source* identifies the specific database that can be accessed through OLE DB.</span></span> <span data-ttu-id="effb8-122">Bien que les sources de données interrogées au moyen des définitions de serveurs liés soient d'ordinaire des bases de données, des fournisseurs OLE°DB existent pour différents fichiers et formats de fichiers,</span><span class="sxs-lookup"><span data-stu-id="effb8-122">Although data sources queried through linked server definitions are ordinarily databases, OLE DB providers exist for a variety of files and file formats.</span></span> <span data-ttu-id="effb8-123">dont les fichiers texte, les données incluses dans des feuilles de calcul et les résultats de recherches de contenu.</span><span class="sxs-lookup"><span data-stu-id="effb8-123">These include text files, spreadsheet data, and the results of full-text content searches.</span></span>

 <span data-ttu-id="effb8-124">Le [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client (ProgID : SQLNCLI11) est le fournisseur OLE DB officiel pour [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="effb8-124">The [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider (PROGID: SQLNCLI11) is the official OLE DB provider for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

> [!NOTE]
>  [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="effb8-125">ont été conçues pour être utilisées avec tout fournisseur OLE DB qui implémente les interfaces OLE DB requises.</span><span class="sxs-lookup"><span data-stu-id="effb8-125">distributed queries are designed to work with any OLE DB provider that implements the required OLE DB interfaces.</span></span> <span data-ttu-id="effb8-126">Toutefois, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] n'a été testé qu’avec le fournisseur OLE DB de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client et certains autres fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="effb8-126">However, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] has been tested against only the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB Provider and certain other providers.</span></span>

## <a name="linked-server-details"></a><span data-ttu-id="effb8-127">Détails des serveurs liés</span><span class="sxs-lookup"><span data-stu-id="effb8-127">Linked Server Details</span></span>
 <span data-ttu-id="effb8-128">L'illustration suivante montre les aspects fondamentaux d'une configuration de serveurs liés.</span><span class="sxs-lookup"><span data-stu-id="effb8-128">The following illustration shows the basics of a linked server configuration.</span></span>

 <span data-ttu-id="effb8-129">![Niveau client, niveau serveur et niveau serveur de base de données](../../database-engine/media/lsvr.gif "Niveau client, niveau serveur et niveau serveur de base de données")</span><span class="sxs-lookup"><span data-stu-id="effb8-129">![Client tier, server tier, and database server tier](../../database-engine/media/lsvr.gif "Client tier, server tier, and database server tier")</span></span>

 <span data-ttu-id="effb8-130">Généralement, les serveurs liés sont utilisés pour le traitement des requêtes distribuées.</span><span class="sxs-lookup"><span data-stu-id="effb8-130">Typically, linked servers are used to handle distributed queries.</span></span> <span data-ttu-id="effb8-131">Lorsqu'une application cliente exécute une requête distribuée via un serveur lié, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] analyse la commande et envoie des demandes à OLE°DB.</span><span class="sxs-lookup"><span data-stu-id="effb8-131">When a client application executes a distributed query through a linked server, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] parses the command and sends requests to OLE DB.</span></span> <span data-ttu-id="effb8-132">La requête d'ensemble de lignes peut se présenter sous la forme d'une exécution de requête vers le fournisseur, ou par l'ouverture d'une table de base à partir du fournisseur.</span><span class="sxs-lookup"><span data-stu-id="effb8-132">The rowset request may be in the form of executing a query against the provider or opening a base table from the provider.</span></span>

 <span data-ttu-id="effb8-133">Pour qu'une source de données renvoie les données via un serveur lié, le fournisseur OLE DB (DLL) associé à cette source de données doit se trouver sur le même serveur que l'instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="effb8-133">For a data source to return data through a linked server, the OLE DB provider (DLL) for that data source must be present on the same server as the instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>

 <span data-ttu-id="effb8-134">Lorsqu'un fournisseur OLE°DB tiers est utilisé, le compte sous lequel le service [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] s'exécute doit disposer d'autorisations de lecture et d'exécution sur le répertoire, et sur tous les sous-répertoires correspondants, dans lequel le fournisseur est installé.</span><span class="sxs-lookup"><span data-stu-id="effb8-134">When a third-party OLE DB provider is used, the account under which the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service runs must have read and execute permissions for the directory, and all subdirectories, in which the provider is installed.</span></span>

## <a name="managing-providers"></a><span data-ttu-id="effb8-135">Gestion des fournisseurs</span><span class="sxs-lookup"><span data-stu-id="effb8-135">Managing Providers</span></span>
 <span data-ttu-id="effb8-136">Un ensemble d'options permettent de contrôler la façon dont [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] charge et utilise des fournisseurs OLE DB spécifiés dans le Registre.</span><span class="sxs-lookup"><span data-stu-id="effb8-136">There is a set of options that control how [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] loads and uses OLE DB providers that are specified in the registry.</span></span>

## <a name="managing-linked-server-definitions"></a><span data-ttu-id="effb8-137">Gestion des définitions de serveurs liés</span><span class="sxs-lookup"><span data-stu-id="effb8-137">Managing Linked Server Definitions</span></span>
 <span data-ttu-id="effb8-138">Pendant que vous configurez un serveur lié, inscrivez les informations de connexion et les informations relatives aux sources de données dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="effb8-138">When you are setting up a linked server, register the connection information and data source information with [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="effb8-139">Une fois cette source de données enregistrée, vous pouvez y faire référence avec un nom logique unique.</span><span class="sxs-lookup"><span data-stu-id="effb8-139">After registered, that data source can be referred to with a single logical name.</span></span>

 <span data-ttu-id="effb8-140">Vous pouvez utiliser des procédures stockées et des affichages catalogue pour gérer les définitions de serveurs liés :</span><span class="sxs-lookup"><span data-stu-id="effb8-140">You can use stored procedures and catalog views to manage linked server definitions:</span></span>

-   <span data-ttu-id="effb8-141">Créez une définition de serveur lié en exécutant **sp_addlinkedserver**.</span><span class="sxs-lookup"><span data-stu-id="effb8-141">Create a linked server definition by running **sp_addlinkedserver**.</span></span>

-   <span data-ttu-id="effb8-142">Visualisez les informations relatives aux serveurs liés définis dans une instance spécifique de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] en exécutant une requête sur les affichages catalogue système **sys.servers** .</span><span class="sxs-lookup"><span data-stu-id="effb8-142">View information about the linked servers defined in a specific instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] by running a query against the **sys.servers** system catalog views.</span></span>

-   <span data-ttu-id="effb8-143">Supprimez une définition de serveur lié en exécutant **sp_dropserver**.</span><span class="sxs-lookup"><span data-stu-id="effb8-143">Delete a linked server definition by running **sp_dropserver**.</span></span> <span data-ttu-id="effb8-144">Vous pouvez également utiliser cette procédure stockée pour supprimer un serveur distant.</span><span class="sxs-lookup"><span data-stu-id="effb8-144">You can also use this stored procedure to remove a remote server.</span></span>

 <span data-ttu-id="effb8-145">Vous pouvez également définir des serveurs liés à l'aide de [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="effb8-145">You can also define linked servers by using [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="effb8-146">Dans l’Explorateur d’objets, cliquez avec le bouton droit sur **Objets serveur**et sélectionnez **Nouveau**, puis **Serveur lié**.</span><span class="sxs-lookup"><span data-stu-id="effb8-146">In the Object Explorer, right-click **Server Objects**, select **New**, and select **Linked Server**.</span></span> <span data-ttu-id="effb8-147">Pour supprimer une définition de serveur lié, vous pouvez cliquer avec le bouton droit sur le nom du serveur lié, puis sélectionner **Supprimer**.</span><span class="sxs-lookup"><span data-stu-id="effb8-147">You can delete a linked server definition by right-clicking the linked server name and selecting **Delete**.</span></span>

 <span data-ttu-id="effb8-148">Lorsque vous exécutez une requête distribuée sur un serveur lié, veillez à inclure pour chaque source de données à interroger un nom de table en quatre parties complet.</span><span class="sxs-lookup"><span data-stu-id="effb8-148">When you execute a distributed query against a linked server, include a fully qualified, four-part table name for each data source to query.</span></span> <span data-ttu-id="effb8-149">Ce nom en quatre parties doit se présenter sous la forme _linked_server_name. Catalog_\*\*. _`schema`_ \*\* _object_name_.</span><span class="sxs-lookup"><span data-stu-id="effb8-149">This four-part name should be in the form _linked_server_name.catalog_**._`schema`_.**_object_name_.</span></span>

> [!NOTE]
>  <span data-ttu-id="effb8-150">Les serveurs liés peuvent être définis de façon à repointer (en bouclage) vers le serveur sur lequel ils sont définis.</span><span class="sxs-lookup"><span data-stu-id="effb8-150">Linked servers can be defined to point back (loop back) to the server on which they are defined.</span></span> <span data-ttu-id="effb8-151">Les serveurs en boucle sont particulièrement utiles pour tester une application utilisant des requêtes distribuées sur un réseau comportant un seul serveur.</span><span class="sxs-lookup"><span data-stu-id="effb8-151">Loopback servers are most useful when testing an application that uses distributed queries on a single server network.</span></span> <span data-ttu-id="effb8-152">Les serveurs liés en boucle sont conçus à des fins de test et ne sont pas pris en charge pour de nombreuses opérations, telles que les transactions distribuées.</span><span class="sxs-lookup"><span data-stu-id="effb8-152">Loopback linked servers are intended for testing and are not supported for many operations, such as distributed transactions.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="effb8-153">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="effb8-153">Related Tasks</span></span>
 [<span data-ttu-id="effb8-154">Créer des serveurs liés &#40;Moteur de base de données SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-154">Create Linked Servers &#40;SQL Server Database Engine&#41;</span></span>](create-linked-servers-sql-server-database-engine.md)

 [<span data-ttu-id="effb8-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-155">sp_addlinkedserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedserver-transact-sql)

 [<span data-ttu-id="effb8-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-156">sp_addlinkedsrvlogin &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-addlinkedsrvlogin-transact-sql)

 [<span data-ttu-id="effb8-157">sp_dropserver &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-157">sp_dropserver &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-dropserver-transact-sql)

## <a name="related-content"></a><span data-ttu-id="effb8-158">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="effb8-158">Related Content</span></span>
 [<span data-ttu-id="effb8-159">sys.servers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-159">sys.servers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-catalog-views/sys-servers-transact-sql)

 [<span data-ttu-id="effb8-160">sp_linkedservers &#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="effb8-160">sp_linkedservers &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-linkedservers-transact-sql)


