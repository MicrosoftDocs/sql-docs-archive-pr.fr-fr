---
title: Scripts du moteur de base de données
ms.custom: seo-lt-2019
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- scripts [SQL Server], PowerShell
- scripts [SQL Server]
- scripting [SQL Server Database Engine]
- scripting [SQL Server Database Engine], PowerShell
ms.assetid: 9978a884-59a2-4e7f-a82a-335149f3a261
author: rothja
ms.author: jroth
ms.openlocfilehash: 79dca27e2aa5f2c0bc473534e0a8b204345b3993
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87599874"
---
# <a name="database-engine-scripting"></a><span data-ttu-id="bd85a-102">Scripts du moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="bd85a-102">Database Engine Scripting</span></span>
  <span data-ttu-id="bd85a-103">Le [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] prend en charge l'environnement de script [!INCLUDE[msCoName](../../includes/msconame-md.md)] PowerShell pour gérer les instances du [!INCLUDE[ssDE](../../includes/ssde-md.md)] et leurs objets.</span><span class="sxs-lookup"><span data-stu-id="bd85a-103">The [!INCLUDE[ssDEnoversion](../../includes/ssdenoversion-md.md)] supports the [!INCLUDE[msCoName](../../includes/msconame-md.md)] PowerShell scripting environment to manage instances of the [!INCLUDE[ssDE](../../includes/ssde-md.md)] and the objects in the instances.</span></span> <span data-ttu-id="bd85a-104">Vous pouvez également générer et exécuter des requêtes de [!INCLUDE[ssDE](../../includes/ssde-md.md)] qui contiennent des éléments [!INCLUDE[tsql](../../includes/tsql-md.md)] et XQuery dans des environnements très similaires aux environnements de script.</span><span class="sxs-lookup"><span data-stu-id="bd85a-104">You can also build and run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries that contain [!INCLUDE[tsql](../../includes/tsql-md.md)] and XQuery in environments very similar to scripting environments.</span></span>  
  
## <a name="sql-server-powershell"></a><span data-ttu-id="bd85a-105">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="bd85a-105">SQL Server PowerShell</span></span>  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="bd85a-106">inclut deux [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] composants logiciels enfichables PowerShell qui implémentent :</span><span class="sxs-lookup"><span data-stu-id="bd85a-106">includes two [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell snap-ins that implement:</span></span>  
  
-   <span data-ttu-id="bd85a-107">Un fournisseur [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell qui expose les hiérarchies du modèle objet de gestion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] en tant que chemins d'accès PowerShell semblables aux chemins d'accès de système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="bd85a-107">A [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell provider that exposes the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model hierarchies as PowerShell paths that are similar to file system paths.</span></span> <span data-ttu-id="bd85a-108">Vous pouvez utiliser les classes du modèle objet de gestion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour gérer les objets représentés à chaque nœud du chemin d'accès.</span><span class="sxs-lookup"><span data-stu-id="bd85a-108">You can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] management object model classes to manage the objects represented at each node of the path.</span></span>  
  
-   <span data-ttu-id="bd85a-109">Un jeu d'applets de commande [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] qui implémentent des commandes [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-109">A set of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] cmdlets that implement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] commands.</span></span> <span data-ttu-id="bd85a-110">L’une des applets de commande est **Invoke-Sqlcmd**.</span><span class="sxs-lookup"><span data-stu-id="bd85a-110">One of the cmdlets is **Invoke-Sqlcmd**.</span></span> <span data-ttu-id="bd85a-111">Cela permet d’exécuter [!INCLUDE[ssDE](../../includes/ssde-md.md)] des scripts de requête à exécuter avec l' `sqlcmd` utilitaire.</span><span class="sxs-lookup"><span data-stu-id="bd85a-111">This is used to run [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query scripts to be run with the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="bd85a-112">fournit ces fonctionnalités pour exécuter PowerShell :</span><span class="sxs-lookup"><span data-stu-id="bd85a-112">provides these features for running PowerShell:</span></span>  
  
-   <span data-ttu-id="bd85a-113">Le module PowerShell **sqlps** qui peut être importé dans une session PowerShell. Le module charge ensuite les composants logiciels enfichables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Vous pouvez exécuter des commandes PowerShell appropriées de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="bd85a-113">The **sqlps** PowerShell module that can be imported to a PowerShell session, the module then loads the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] snap-ins. You can interactively run ad hoc PowerShell commands.</span></span> <span data-ttu-id="bd85a-114">Vous pouvez exécuter des fichiers de script à l'aide d'une commande telle que .\MonDossier\MonScript.ps1.</span><span class="sxs-lookup"><span data-stu-id="bd85a-114">You can run script files using a command such as .\MyFolder\MyScript.ps1.</span></span>  
  
-   <span data-ttu-id="bd85a-115">Les fichiers de script PowerShell peuvent être fournis en entrée à des étapes de travail de PowerShell [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent qui exécutent les scripts selon des intervalles planifiés ou en réponse à des événements système.</span><span class="sxs-lookup"><span data-stu-id="bd85a-115">PowerShell script files can be used as input to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent PowerShell job steps that run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
-   <span data-ttu-id="bd85a-116">L’utilitaire **sqlps** qui démarre PowerShell et importe le module [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-116">The **sqlps** utility that starts PowerShell and imports the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] module.</span></span> <span data-ttu-id="bd85a-117">Vous pouvez ensuite effectuer toutes les actions prises en charge par le module.</span><span class="sxs-lookup"><span data-stu-id="bd85a-117">You can then perform all actions supported by the module.</span></span> <span data-ttu-id="bd85a-118">Vous pouvez démarrer l’utilitaire **sqlps** dans une invite de commandes ou en cliquant avec le bouton droit sur les nœuds dans l’arborescence de l’Explorateur d’objets [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio et en sélectionnant **Démarrer PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="bd85a-118">You can start the **sqlps** utility either in a command prompt or by right-clicking on the nodes in the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Management Studio Object Explorer tree and selecting **Start PowerShell**.</span></span>  
  
## <a name="database-engine-queries"></a><span data-ttu-id="bd85a-119">Requêtes de moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="bd85a-119">Database Engine Queries</span></span>  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="bd85a-120">Les scripts de requêtes contiennent trois types d’éléments :</span><span class="sxs-lookup"><span data-stu-id="bd85a-120">query scripts contain three types of elements:</span></span>  
  
-   [!INCLUDE[tsql](../../includes/tsql-md.md)] <span data-ttu-id="bd85a-121">Instructions du langage</span><span class="sxs-lookup"><span data-stu-id="bd85a-121">language statements.</span></span>  
  
-   <span data-ttu-id="bd85a-122">Instructions du langage XQuery</span><span class="sxs-lookup"><span data-stu-id="bd85a-122">XQuery language statements</span></span>  
  
-   <span data-ttu-id="bd85a-123">Commandes et variables de l' `sqlcmd` utilitaire.</span><span class="sxs-lookup"><span data-stu-id="bd85a-123">Commands and variables from the `sqlcmd` utility.</span></span>  
  
 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="bd85a-124">fournit trois environnements pour la génération et l’exécution de requêtes du [!INCLUDE[ssDE](../../includes/ssde-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="bd85a-124">provides three environments for building and running [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries:</span></span>  
  
-   <span data-ttu-id="bd85a-125">Vous pouvez, de manière interactive, exécuter et déboguer des requêtes de [!INCLUDE[ssDE](../../includes/ssde-md.md)] dans l'éditeur de requête du [!INCLUDE[ssDE](../../includes/ssde-md.md)] de [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bd85a-125">You can interactively run and debug [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries in the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)].</span></span> <span data-ttu-id="bd85a-126">Vous pouvez coder et déboguer plusieurs instructions en une session, puis enregistrer toutes les instructions dans un même fichier de script.</span><span class="sxs-lookup"><span data-stu-id="bd85a-126">You can code and debug several statements in one session, then save all of the statements in a single script file.</span></span>  
  
-   <span data-ttu-id="bd85a-127">L' `sqlcmd` utilitaire d’invite de commandes vous permet d’exécuter interactivement des [!INCLUDE[ssDE](../../includes/ssde-md.md)] requêtes et d’exécuter des [!INCLUDE[ssDE](../../includes/ssde-md.md)] fichiers de script de requête existants.</span><span class="sxs-lookup"><span data-stu-id="bd85a-127">The `sqlcmd` command prompt utility lets you interactively run [!INCLUDE[ssDE](../../includes/ssde-md.md)] queries, and also run existing [!INCLUDE[ssDE](../../includes/ssde-md.md)] query script files.</span></span>  
  
 [!INCLUDE[ssDE](../../includes/ssde-md.md)] <span data-ttu-id="bd85a-128">Les fichiers de script de requête sont en général codés de manière interactive dans [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] en utilisant l’éditeur de requête du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-128">query script files are typically coded interactively in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] by using the [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor.</span></span> <span data-ttu-id="bd85a-129">Le fichier peut par la suite être ouvert dans l'un de ces environnements :</span><span class="sxs-lookup"><span data-stu-id="bd85a-129">The file can later be opened in one of these environments:</span></span>  
  
-   <span data-ttu-id="bd85a-130">Utilisez le menu [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] **Ouvrir**/**de** pour ouvrir le fichier dans une nouvelle fenêtre de l’éditeur de requête du [!INCLUDE[ssDE](../../includes/ssde-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-130">Use the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] **File**/**Open** menu to open the file in a new [!INCLUDE[ssDE](../../includes/ssde-md.md)] Query Editor window.</span></span>  
  
-   <span data-ttu-id="bd85a-131">Utilisez le paramètre **-i**_input_file_ pour exécuter le fichier avec l' `sqlcmd` utilitaire.</span><span class="sxs-lookup"><span data-stu-id="bd85a-131">Use the **-i**_input_file_ parameter to run the file with the `sqlcmd` utility.</span></span>  
  
-   <span data-ttu-id="bd85a-132">Utilisez le paramètre **-QueryFromFile** pour exécuter le fichier avec l’applet de commande **Invoke-Sqlcmd** dans les scripts [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bd85a-132">Use the **-QueryFromFile** parameter to run the file with the **Invoke-Sqlcmd** cmdlet in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] PowerShell scripts.</span></span>  
  
-   <span data-ttu-id="bd85a-133">Utilisez des étapes de travail [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de l'Agent [!INCLUDE[tsql](../../includes/tsql-md.md)] pour exécuter des scripts selon des intervalles planifiés ou en réponse à des événements système.</span><span class="sxs-lookup"><span data-stu-id="bd85a-133">Use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent [!INCLUDE[tsql](../../includes/tsql-md.md)] job steps to run the scripts either at scheduled intervals or in response to system events.</span></span>  
  
 <span data-ttu-id="bd85a-134">En outre, vous pouvez utiliser l’Assistant Génération de scripts [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour générer des scripts [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-134">In addition, you can use the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Generate Script Wizard to generate [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts.</span></span> <span data-ttu-id="bd85a-135">Vous pouvez cliquer avec le bouton droit sur des objets dans l’Explorateur d’objets [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] , puis sélectionner l’élément de menu **Générer un script** .</span><span class="sxs-lookup"><span data-stu-id="bd85a-135">You can right-click objects in the [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] Object Explorer, then select the **Generate Script** menu item.</span></span> <span data-ttu-id="bd85a-136">**Générer un script** lance l’Assistant, qui vous guide dans le processus de création d’un script.</span><span class="sxs-lookup"><span data-stu-id="bd85a-136">**Generate Script** launches the wizard, which guides you through the process of creating a script.</span></span>  
  
## <a name="database-engine-scripting-tasks"></a><span data-ttu-id="bd85a-137">Tâches de script du moteur de base de données</span><span class="sxs-lookup"><span data-stu-id="bd85a-137">Database Engine Scripting Tasks</span></span>  
  
|<span data-ttu-id="bd85a-138">Description de la tâche</span><span class="sxs-lookup"><span data-stu-id="bd85a-138">Task Description</span></span>|<span data-ttu-id="bd85a-139">Rubrique</span><span class="sxs-lookup"><span data-stu-id="bd85a-139">Topic</span></span>|  
|----------------------|-----------|  
|<span data-ttu-id="bd85a-140">Explique comment utiliser le code et les éditeurs de texte dans [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] pour développer, déboguer, et exécuter interactivement des scripts [!INCLUDE[tsql](../../includes/tsql-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bd85a-140">Describes how to use the code and text editors in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)] to interactively develop, debug, and run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts</span></span>|[<span data-ttu-id="bd85a-141">Éditeurs de texte et de requête &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="bd85a-141">Query and Text Editors &#40;SQL Server Management Studio&#41;</span></span>](../scripting/query-and-text-editors-sql-server-management-studio.md)|  
|<span data-ttu-id="bd85a-142">Explique comment utiliser l'utilitaire `sqlcmd` pour exécuter des scripts [!INCLUDE[tsql](../../includes/tsql-md.md)] à partir de l'invite de commandes, notamment la possibilité de développer interactivement des scripts.</span><span class="sxs-lookup"><span data-stu-id="bd85a-142">Describes how to use the `sqlcmd` utility to run [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts from the command prompt, including the ability to interactively develop scripts.</span></span>|[<span data-ttu-id="bd85a-143">Rubriques de procédures liées à sqlcmd</span><span class="sxs-lookup"><span data-stu-id="bd85a-143">sqlcmd How-to Topics</span></span>](../../database-engine/sqlcmd-how-to-topics.md)|  
|<span data-ttu-id="bd85a-144">Explique comment intégrer les composants SQL Server dans un environnement Windows PowerShell 2.0 et générer des scripts PowerShell pour gérer des instances et des objets SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bd85a-144">Describes how to integrate the SQL Server components into a Windows PowerShell 2.0 environment and then build PowerShell scripts for managing SQL Server instances and objects.</span></span>|[<span data-ttu-id="bd85a-145">SQL Server PowerShell</span><span class="sxs-lookup"><span data-stu-id="bd85a-145">SQL Server PowerShell</span></span>](../../powershell/sql-server-powershell.md)|  
|<span data-ttu-id="bd85a-146">Explique comment utiliser l’Assistant **Générer et publier des scripts** pour créer des scripts [!INCLUDE[tsql](../../includes/tsql-md.md)] qui recréent un ou plusieurs objets d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="bd85a-146">Describes how to use the **Generate and Publish Scripts** wizard to create [!INCLUDE[tsql](../../includes/tsql-md.md)] scripts that recreate one or more of the objects from a database.</span></span>|[<span data-ttu-id="bd85a-147">Générer des scripts &#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="bd85a-147">Generate Scripts &#40;SQL Server Management Studio&#41;</span></span>](generate-scripts-sql-server-management-studio.md)|  
  
## <a name="see-also"></a><span data-ttu-id="bd85a-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bd85a-148">See Also</span></span>  
 <span data-ttu-id="bd85a-149">[Utilitaire sqlcmd](../../tools/sqlcmd-utility.md) </span><span class="sxs-lookup"><span data-stu-id="bd85a-149">[sqlcmd Utility](../../tools/sqlcmd-utility.md) </span></span>  
 [<span data-ttu-id="bd85a-150">Tutoriel : Écriture d’instructions Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="bd85a-150">Tutorial: Writing Transact-SQL Statements</span></span>](../../t-sql/tutorial-writing-transact-sql-statements.md)  
  
  
