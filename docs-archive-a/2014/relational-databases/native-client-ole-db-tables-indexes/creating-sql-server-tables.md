---
title: Création de tables SQL Server | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- tables [OLE DB]
- SQL Server Native Client OLE DB provider, tables
- DBCOLUMNDESC usage
- adding tables
- CreateTable function
ms.assetid: a7b8d142-d76a-44d9-a583-86ac5109fbe8
author: rothja
ms.author: jroth
ms.openlocfilehash: 7b3d11a26c2f5d27f28a60effdb26978edd07409
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611046"
---
# <a name="creating-sql-server-tables"></a><span data-ttu-id="a86a9-102">Création de tables SQL Server</span><span class="sxs-lookup"><span data-stu-id="a86a9-102">Creating SQL Server Tables</span></span>
  <span data-ttu-id="a86a9-103">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client expose la fonction **ITableDefinition :: CreateTable** , ce qui permet aux consommateurs de créer des [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span><span class="sxs-lookup"><span data-stu-id="a86a9-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes the **ITableDefinition::CreateTable** function, allowing consumers to create [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="a86a9-104">Les consommateurs utilisent **CreateTable** pour créer des tables permanentes nommées par le consommateur, ainsi que des tables permanentes ou temporaires avec des noms uniques générés par le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="a86a9-104">Consumers use **CreateTable** to create consumer-named permanent tables, and permanent or temporary tables with unique names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
 <span data-ttu-id="a86a9-105">Lorsque le consommateur appelle **ITableDefinition :: CreateTable**, si la valeur de la propriété DBPROP_TBL_TEMPTABLE est VARIANT_TRUE, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client génère un nom de table temporaire pour le consommateur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-105">When the consumer calls **ITableDefinition::CreateTable**, if the value of the DBPROP_TBL_TEMPTABLE property is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="a86a9-106">Le consommateur attribue la valeur NULL au paramètre *pTableID* de la méthode **CreateTable**.</span><span class="sxs-lookup"><span data-stu-id="a86a9-106">The consumer sets the *pTableID* parameter of the **CreateTable** method to NULL.</span></span> <span data-ttu-id="a86a9-107">Les tables temporaires avec les noms générés par le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client n’apparaissent pas dans l’ensemble de lignes des **tables** , mais sont accessibles via l’interface **IOpenRowset** .</span><span class="sxs-lookup"><span data-stu-id="a86a9-107">The temporary tables with names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider do not appear in the **TABLES** rowset, but are accessible through the **IOpenRowset** interface.</span></span>  
  
 <span data-ttu-id="a86a9-108">Lorsque les consommateurs spécifient le nom de la table dans le membre *pwszName* de l’Union *uname* dans le paramètre *pTableID* , le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client crée une [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table portant ce nom.</span><span class="sxs-lookup"><span data-stu-id="a86a9-108">When consumers specify the table name in the *pwszName* member of the *uName* union in the *pTableID* parameter, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with that name.</span></span> <span data-ttu-id="a86a9-109">Des contraintes en matière d'affectation de noms aux tables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] s'appliquent et le nom de la table peut indiquer une table permanente ou une table temporaire locale ou globale.</span><span class="sxs-lookup"><span data-stu-id="a86a9-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table naming constraints apply, and the table name can indicate a permanent table, or either a local or global temporary table.</span></span> <span data-ttu-id="a86a9-110">Pour plus d’informations, consultez [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="a86a9-110">For more information, see [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql).</span></span> <span data-ttu-id="a86a9-111">Le paramètre *ppTableID* peut avoir la valeur NULL.</span><span class="sxs-lookup"><span data-stu-id="a86a9-111">The *ppTableID* parameter can be NULL.</span></span>  
  
 <span data-ttu-id="a86a9-112">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client peut générer les noms des tables permanentes ou temporaires.</span><span class="sxs-lookup"><span data-stu-id="a86a9-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider can generate the names of permanent or temporary tables.</span></span> <span data-ttu-id="a86a9-113">Lorsque le consommateur définit le paramètre *pTableID* sur null et définit *ppTableID* pour qu’il pointe vers un dbid valide \* , le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client retourne le nom généré de la table dans le membre *pwszName* de l’Union *uname* du dbid désigné par la valeur de *ppTableID*.</span><span class="sxs-lookup"><span data-stu-id="a86a9-113">When the consumer sets the *pTableID* parameter to NULL and sets *ppTableID* to point to a valid DBID\*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns the generated name of the table in the *pwszName* member of the *uName* union of the DBID pointed to by the value of *ppTableID*.</span></span> <span data-ttu-id="a86a9-114">Pour créer une table temporaire [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native cliente OLE DB fournisseur, le consommateur comprend la propriété de table OLE DB DBPROP_TBL_TEMPTABLE dans un jeu de propriétés de table référencé dans le paramètre *rgPropertySets* .</span><span class="sxs-lookup"><span data-stu-id="a86a9-114">To create a temporary, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider-named table, the consumer includes the OLE DB table property DBPROP_TBL_TEMPTABLE in a table property set referenced in the *rgPropertySets* parameter.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="a86a9-115">Les tables temporaires du fournisseur OLE DB Native Client sont locales.</span><span class="sxs-lookup"><span data-stu-id="a86a9-115">Native Client OLE DB provider-named temporary tables are local.</span></span>  
  
 <span data-ttu-id="a86a9-116">**CreateTable** retourne DB_E_BADTABLEID si le membre *eKind* du paramètre *pTableID* n’indique pas DBKIND_NAME.</span><span class="sxs-lookup"><span data-stu-id="a86a9-116">**CreateTable** returns DB_E_BADTABLEID if the *eKind* member of the *pTableID* parameter does not indicate DBKIND_NAME.</span></span>  
  
## <a name="dbcolumndesc-usage"></a><span data-ttu-id="a86a9-117">Utilisation de la structure DBCOLUMNDESC</span><span class="sxs-lookup"><span data-stu-id="a86a9-117">DBCOLUMNDESC Usage</span></span>  
 <span data-ttu-id="a86a9-118">Le consommateur peut indiquer un type de données de colonne en utilisant soit le membre *pwszTypeName*, soit le membre *wType*.</span><span class="sxs-lookup"><span data-stu-id="a86a9-118">The consumer can indicate a column data type by using either the *pwszTypeName* member or the *wType* member.</span></span> <span data-ttu-id="a86a9-119">Si le consommateur spécifie le type de données dans *pwszTypeName*, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client ignore la valeur de *wType*.</span><span class="sxs-lookup"><span data-stu-id="a86a9-119">If the consumer specifies the data type in *pwszTypeName*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider ignores the value of *wType*.</span></span>  
  
 <span data-ttu-id="a86a9-120">S’il utilise le membre *pwszTypeName*, le consommateur spécifie le type de données à l’aide de noms du type de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a86a9-120">If using the *pwszTypeName* member, the consumer specifies the data type by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type names.</span></span> <span data-ttu-id="a86a9-121">Les noms de type de données valides sont les noms retournés dans la colonne TYPE_NAME de l'ensemble de lignes de schéma PROVIDER_TYPES.</span><span class="sxs-lookup"><span data-stu-id="a86a9-121">Valid data type names are those returned in the TYPE_NAME column of the PROVIDER_TYPES schema rowset.</span></span>  
  
 <span data-ttu-id="a86a9-122">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client reconnaît un sous-ensemble de valeurs DbType énumérées OLE DB dans le membre *wType* .</span><span class="sxs-lookup"><span data-stu-id="a86a9-122">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider recognizes a subset of OLE DB-enumerated DBTYPE values in the *wType* member.</span></span> <span data-ttu-id="a86a9-123">Pour plus d'informations, voir [Mappage de types de données dans ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span><span class="sxs-lookup"><span data-stu-id="a86a9-123">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a86a9-124">**CreateTable** retourne DB_E_BADTYPE si le consommateur choisit le membre *pTypeInfo* ou *pclsid* pour spécifier le type de données de colonne.</span><span class="sxs-lookup"><span data-stu-id="a86a9-124">**CreateTable** returns DB_E_BADTYPE if consumer sets either the *pTypeInfo* or *pclsid* member to specify the column data type.</span></span>  
  
 <span data-ttu-id="a86a9-125">Le consommateur spécifie le nom de colonne dans le membre *pwszName* de l’union *uName* du membre *dbcid* DBCOLUMNDESC.</span><span class="sxs-lookup"><span data-stu-id="a86a9-125">The consumer specifies the column name in the *pwszName* member of the *uName* union of the DBCOLUMNDESC *dbcid* member.</span></span> <span data-ttu-id="a86a9-126">Le nom de colonne est spécifié en tant que chaîne de caractères Unicode.</span><span class="sxs-lookup"><span data-stu-id="a86a9-126">The column name is specified as a Unicode character string.</span></span> <span data-ttu-id="a86a9-127">Le membre *eKind* de *dbcid* doit être DBKIND_NAME.</span><span class="sxs-lookup"><span data-stu-id="a86a9-127">The *eKind* member of *dbcid* must be DBKIND_NAME.</span></span> <span data-ttu-id="a86a9-128">**CreateTable** retourne DB_E_BADCOLUMNID si le membre *eKind* n’est pas valide, si *pwszName* possède la valeur NULL ou si la valeur de *pwszName* n’est pas un identificateur [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] valide.</span><span class="sxs-lookup"><span data-stu-id="a86a9-128">**CreateTable** returns DB_E_BADCOLUMNID if *eKind* is invalid, *pwszName* is NULL, or if the value of *pwszName* is not a valid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identifier.</span></span>  
  
 <span data-ttu-id="a86a9-129">Toutes les propriétés de colonne sont disponibles dans toutes les colonnes définies pour la table.</span><span class="sxs-lookup"><span data-stu-id="a86a9-129">All column properties are available on all columns defined for the table.</span></span> <span data-ttu-id="a86a9-130">**CreateTable** peut retourner DB_S_ERRORSOCCURRED ou DB_E_ERRORSOCCURRED si les valeurs des propriétés sont en conflit.</span><span class="sxs-lookup"><span data-stu-id="a86a9-130">**CreateTable** can return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED if property values are set in conflict.</span></span> <span data-ttu-id="a86a9-131">**CreateTable** retourne une erreur lorsque les paramètres des propriétés de colonne non valides entraîne un échec lors de la création de tables [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a86a9-131">**CreateTable** returns an error when invalid column property settings cause [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table-creation failure.</span></span>  
  
 <span data-ttu-id="a86a9-132">Les propriétés des colonnes dans une structure DBCOLUMNDESC se définissent de la manière suivante.</span><span class="sxs-lookup"><span data-stu-id="a86a9-132">Column properties in a DBCOLUMNDESC are interpreted as follows.</span></span>  
  
|<span data-ttu-id="a86a9-133">ID de propriété</span><span class="sxs-lookup"><span data-stu-id="a86a9-133">Property ID</span></span>|<span data-ttu-id="a86a9-134">Description</span><span class="sxs-lookup"><span data-stu-id="a86a9-134">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="a86a9-135">DBPROP_COL_AUTOINCREMENT</span><span class="sxs-lookup"><span data-stu-id="a86a9-135">DBPROP_COL_AUTOINCREMENT</span></span>|<span data-ttu-id="a86a9-136">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-136">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-137">Valeur par défaut : VARIANT_FALSE Description : définit la propriété d'identité dans la colonne créée.</span><span class="sxs-lookup"><span data-stu-id="a86a9-137">Default: VARIANT_FALSE Description: Sets the identity property on the column created.</span></span> <span data-ttu-id="a86a9-138">Pour [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], la propriété d'identité est valide pour une colonne unique au sein d'une table.</span><span class="sxs-lookup"><span data-stu-id="a86a9-138">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the identity property is valid for a single column within a table.</span></span> <span data-ttu-id="a86a9-139">La définition de la propriété sur VARIANT_TRUE pour plusieurs colonnes génère une erreur lorsque le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client tente de créer la table sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-139">Setting the property to VARIANT_TRUE for more than a single column generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="a86a9-140">La propriété d’identité [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est uniquement valide pour les types **integer**, **numeric** et **decimal** lorsque l’échelle est définie sur 0.</span><span class="sxs-lookup"><span data-stu-id="a86a9-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property is only valid for the **integer**, **numeric**, and **decimal** types when the scale is 0.</span></span> <span data-ttu-id="a86a9-141">La définition de la propriété sur VARIANT_TRUE sur une colonne de tout autre type de données génère une erreur lorsque le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client tente de créer la table sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-141">Setting the property to VARIANT_TRUE on a column of any other data type generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="a86a9-142">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client retourne DB_S_ERRORSOCCURRED lorsque DBPROP_COL_AUTOINCREMENT et DBPROP_COL_NULLABLE sont tous deux VARIANT_TRUE et que le *valeur dwoption* de DBPROP_COL_NULLABLE n’est pas DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-142">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE is not DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="a86a9-143">DB_E_ERRORSOCCURRED est retourné lorsque DBPROP_COL_AUTOINCREMENT et DBPROP_COL_NULLABLE sont tous les deux définis sur VARIANT_TRUE et quand la valeur *dwOption* de DBPROP_COL_NULLABLE est égale à DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-143">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="a86a9-144">La colonne est définie avec la propriété d’identité [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le membre *dwStatus* DBPROP_COL_NULLABLE est défini sur DBPROPSTATUS_CONFLICTING.</span><span class="sxs-lookup"><span data-stu-id="a86a9-144">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span>|  
|<span data-ttu-id="a86a9-145">DBPROP_COL_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="a86a9-145">DBPROP_COL_DEFAULT</span></span>|<span data-ttu-id="a86a9-146">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-146">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-147">Valeur par défaut : aucune</span><span class="sxs-lookup"><span data-stu-id="a86a9-147">Default: None</span></span><br /><br /> <span data-ttu-id="a86a9-148">Description : crée une contrainte DEFAULT [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour la colonne.</span><span class="sxs-lookup"><span data-stu-id="a86a9-148">Description: Creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT constraint for the column.</span></span><br /><br /> <span data-ttu-id="a86a9-149">Le membre *vValue* DBPROP peut appartenir aux types suivants.</span><span class="sxs-lookup"><span data-stu-id="a86a9-149">The *vValue* DBPROP member can be any of a number of types.</span></span> <span data-ttu-id="a86a9-150">Le membre *vValue.vt* doit spécifier un type compatible avec le type de données de la colonne.</span><span class="sxs-lookup"><span data-stu-id="a86a9-150">The *vValue.vt* member should specify a type compatible with the data type of the column.</span></span> <span data-ttu-id="a86a9-151">Par exemple, le choix de BSTR N/A comme valeur par défaut d'une colonne définie en tant que DBTYPE_WSTR offre une valeur de correspondance compatible.</span><span class="sxs-lookup"><span data-stu-id="a86a9-151">For example, defining BSTR N/A as the default value for a column defined as DBTYPE_WSTR is a compatible match.</span></span> <span data-ttu-id="a86a9-152">La définition de la même valeur par défaut sur une colonne définie en tant que DBTYPE_R8 génère une erreur lorsque le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client tente de créer la table sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-152">Defining the same default on a column defined as DBTYPE_R8 generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span>|  
|<span data-ttu-id="a86a9-153">DBPROP_COL_DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="a86a9-153">DBPROP_COL_DESCRIPTION</span></span>|<span data-ttu-id="a86a9-154">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-154">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-155">Valeur par défaut : aucune</span><span class="sxs-lookup"><span data-stu-id="a86a9-155">Default: None</span></span><br /><br /> <span data-ttu-id="a86a9-156">Description : la propriété de colonne DBPROP_COL_DESCRIPTION n’est pas implémentée par le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="a86a9-156">Description: The DBPROP_COL_DESCRIPTION column property is not implemented by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="a86a9-157">Le membre *dwStatus* de la structure DBPROP retourne DBPROPSTATUS_NOTSUPPORTED lorsque le consommateur tente d’écrire la valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="a86a9-157">The *dwStatus* member of the DBPROP structure returns DBPROPSTATUS_NOTSUPPORTED when the consumer attempts to write the property value.</span></span><br /><br /> <span data-ttu-id="a86a9-158">La définition de la propriété ne constitue pas une erreur irrécupérable pour le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client.</span><span class="sxs-lookup"><span data-stu-id="a86a9-158">Setting the property does not constitute a fatal error for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="a86a9-159">Si toutes les autres valeurs de paramètres sont valides, la table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est créée.</span><span class="sxs-lookup"><span data-stu-id="a86a9-159">If all other parameter values are valid, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table is created.</span></span>|  
|<span data-ttu-id="a86a9-160">DBPROP_COL_FIXEDLENGTH</span><span class="sxs-lookup"><span data-stu-id="a86a9-160">DBPROP_COL_FIXEDLENGTH</span></span>|<span data-ttu-id="a86a9-161">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-161">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-162">Valeur par défaut : VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="a86a9-162">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="a86a9-163">Description : le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client utilise DBPROP_COL_FIXEDLENGTH pour déterminer le mappage de type de données lorsque le consommateur définit le type de données d’une colonne à l’aide du membre *WTYPE* du DBCOLUMNDESC.</span><span class="sxs-lookup"><span data-stu-id="a86a9-163">Description: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses DBPROP_COL_FIXEDLENGTH to determine data type-mapping when the consumer defines a column's data type by using the *wType* member of the DBCOLUMNDESC.</span></span> <span data-ttu-id="a86a9-164">Pour plus d'informations, voir [Mappage de types de données dans ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span><span class="sxs-lookup"><span data-stu-id="a86a9-164">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>|  
|<span data-ttu-id="a86a9-165">DBPROP_COL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="a86a9-165">DBPROP_COL_NULLABLE</span></span>|<span data-ttu-id="a86a9-166">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-166">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-167">Valeur par défaut : aucune</span><span class="sxs-lookup"><span data-stu-id="a86a9-167">Default: None</span></span><br /><br /> <span data-ttu-id="a86a9-168">Description : lors de la création de la table, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client indique si la colonne doit accepter des valeurs NULL si la propriété est définie.</span><span class="sxs-lookup"><span data-stu-id="a86a9-168">Description: When creating the table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider indicates whether the column should accept null values if the property is set.</span></span> <span data-ttu-id="a86a9-169">Lorsque la propriété n'est pas définie, l'aptitude de la colonne à valider la valeur NULL dépend de l'option de base de données par défaut ANSI_NULLS de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a86a9-169">When the property is not set, the ability of the column to accept NULL as a value is determined by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS default database option.</span></span><br /><br /> <span data-ttu-id="a86a9-170">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client est un fournisseur conforme à la norme ISO.</span><span class="sxs-lookup"><span data-stu-id="a86a9-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider is an ISO-compliant provider.</span></span> <span data-ttu-id="a86a9-171">Les sessions connectées affichent des comportements ISO.</span><span class="sxs-lookup"><span data-stu-id="a86a9-171">Connected sessions exhibit ISO behaviors.</span></span> <span data-ttu-id="a86a9-172">Si le consommateur ne définit pas DBPROP_COL_NULLABLE, les colonnes acceptent des valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="a86a9-172">If the consumer does not set DBPROP_COL_NULLABLE, columns accept null values.</span></span>|  
|<span data-ttu-id="a86a9-173">DBPROP_COL_PRIMARYKEY</span><span class="sxs-lookup"><span data-stu-id="a86a9-173">DBPROP_COL_PRIMARYKEY</span></span>|<span data-ttu-id="a86a9-174">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-174">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-175">Valeur par défaut : VARIANT_FALSE Description : lorsque VARIANT_TRUE, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client crée la colonne avec une contrainte de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="a86a9-175">Default: VARIANT_FALSE Description: When VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates the column with a PRIMARY KEY constraint.</span></span><br /><br /> <span data-ttu-id="a86a9-176">Si la propriété est définie comme une propriété de colonne, seule une colonne unique peut déterminer la contrainte.</span><span class="sxs-lookup"><span data-stu-id="a86a9-176">When defined as a column property, only a single column can determine the constraint.</span></span> <span data-ttu-id="a86a9-177">La définition de la VARIANT_TRUE de la propriété pour plusieurs colonnes retourne une erreur lorsque le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client tente de créer la [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span><span class="sxs-lookup"><span data-stu-id="a86a9-177">Setting the property VARIANT_TRUE for more than a single column returns an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span><br /><br /> <span data-ttu-id="a86a9-178">Remarque : Le consommateur peut faire appel à la fonction **IIndexDefinition::CreateIndex** pour créer une contrainte PRIMARY KEY dans deux ou plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="a86a9-178">Note: The consumer can use **IIndexDefinition::CreateIndex** to create a PRIMARY KEY constraint on two or more columns.</span></span><br /><br /> <span data-ttu-id="a86a9-179">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur OLE DB Native Client retourne DB_S_ERRORSOCCURRED lorsque DBPROP_COL_PRIMARYKEY et DBPROP_COL_UNIQUE sont tous deux VARIANT_TRUE et que le *valeur dwoption* de DBPROP_COL_UNIQUE n’est pas DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-179">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="a86a9-180">DB_E_ERRORSOCCURRED est retourné lorsque DBPROP_COL_PRIMARYKEY et DBPROP_COL_UNIQUE sont tous les deux définis sur VARIANT_TRUE et quand la valeur *dwOption* de DBPROP_COL_UNIQUE est égale à DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-180">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="a86a9-181">La colonne est définie avec la propriété d’identité [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le membre *dwStatus* DBPROP_COL_PRIMARYKEY est défini sur DBPROPSTATUS_CONFLICTING.</span><span class="sxs-lookup"><span data-stu-id="a86a9-181">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="a86a9-182">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne une erreur lorsque DBPROP_COL_PRIMARYKEY et DBPROP_COL_NULLABLE sont tous les deux VARIANT_TRUE.</span><span class="sxs-lookup"><span data-stu-id="a86a9-182">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error when DBPROP_COL_PRIMARYKEY and DBPROP_COL_NULLABLE are both VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="a86a9-183">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne une erreur de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lorsque le consommateur tente de créer une contrainte de clé primaire sur une colonne de type de données non valide [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a86a9-183">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a PRIMARY KEY constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="a86a9-184">Vous ne pouvez pas définir des contraintes PRIMARY KEY dans des colonnes créées avec les types de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]**bit**, **text**, **ntext** et **image**.</span><span class="sxs-lookup"><span data-stu-id="a86a9-184">PRIMARY KEY constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types **bit**, **text**, **ntext**, and **image**.</span></span>|  
|<span data-ttu-id="a86a9-185">DBPROP_COL_UNIQUE</span><span class="sxs-lookup"><span data-stu-id="a86a9-185">DBPROP_COL_UNIQUE</span></span>|<span data-ttu-id="a86a9-186">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-186">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-187">Valeur par défaut : VARIANT_FALSE Description : applique une contrainte UNIQUE [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] à la colonne.</span><span class="sxs-lookup"><span data-stu-id="a86a9-187">Default: VARIANT_FALSE Description: Applies a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UNIQUE constraint to the column.</span></span><br /><br /> <span data-ttu-id="a86a9-188">Si la propriété est définie comme une propriété de colonne, la contrainte est appliquée dans une seule colonne uniquement.</span><span class="sxs-lookup"><span data-stu-id="a86a9-188">When defined as a column property, the constraint is applied on a single column only.</span></span> <span data-ttu-id="a86a9-189">Le consommateur peut se servir de la fonction **IIndexDefinition::CreateIndex** pour appliquer une contrainte UNIQUE à des valeurs combinées de deux ou plusieurs colonnes.</span><span class="sxs-lookup"><span data-stu-id="a86a9-189">The consumer can use **IIndexDefinition::CreateIndex** to apply a UNIQUE constraint on the combined values of two or more columns.</span></span><br /><br /> <span data-ttu-id="a86a9-190">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne DB_S_ERRORSOCCURRED lorsque DBPROP_COL_PRIMARYKEY et DBPROP_COL_UNIQUE sont tous deux VARIANT_TRUE et que *valeur dwOption* n’est pas DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-190">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="a86a9-191">DB_E_ERRORSOCCURRED est retourné lorsque DBPROP_COL_PRIMARYKEY et DBPROP_COL_UNIQUE sont tous les deux définis sur VARIANT_TRUE et quand la valeur *dwOption* est égale à DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-191">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="a86a9-192">La colonne est définie avec la propriété d’identité [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le membre *dwStatus* DBPROP_COL_PRIMARYKEY est défini sur DBPROPSTATUS_CONFLICTING.</span><span class="sxs-lookup"><span data-stu-id="a86a9-192">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="a86a9-193">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne DB_S_ERRORSOCCURRED lorsque DBPROP_COL_NULLABLE et DBPROP_COL_UNIQUE sont tous deux VARIANT_TRUE et que *valeur dwOption* n’est pas DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-193">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="a86a9-194">DB_E_ERRORSOCCURRED est retourné lorsque DBPROP_COL_NULLABLE et DBPROP_COL_UNIQUE sont tous les deux définis sur VARIANT_TRUE et quand la valeur *dwOption* est égale à DBPROPOPTIONS_REQUIRED.</span><span class="sxs-lookup"><span data-stu-id="a86a9-194">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="a86a9-195">La colonne est définie avec la propriété d’identité [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] et le membre *dwStatus* DBPROP_COL_NULLABLE est défini sur DBPROPSTATUS_CONFLICTING.</span><span class="sxs-lookup"><span data-stu-id="a86a9-195">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="a86a9-196">Le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client retourne une erreur de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] lorsque le consommateur tente de créer une contrainte unique sur une colonne de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] type de données non valide.</span><span class="sxs-lookup"><span data-stu-id="a86a9-196">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a UNIQUE constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="a86a9-197">Vous ne pouvez pas définir des contraintes UNIQUE sur des colonnes créées avec le type de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit**.</span><span class="sxs-lookup"><span data-stu-id="a86a9-197">UNIQUE constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** data type.</span></span>|  
  
 <span data-ttu-id="a86a9-198">Lorsque le consommateur appelle **ITableDefinition :: CreateTable**, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client interprète les propriétés de la table comme suit.</span><span class="sxs-lookup"><span data-stu-id="a86a9-198">When the consumer calls **ITableDefinition::CreateTable**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider interprets table properties as follows.</span></span>  
  
|<span data-ttu-id="a86a9-199">ID de propriété</span><span class="sxs-lookup"><span data-stu-id="a86a9-199">Property ID</span></span>|<span data-ttu-id="a86a9-200">Description</span><span class="sxs-lookup"><span data-stu-id="a86a9-200">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="a86a9-201">DBPROP_TBL_TEMPTABLE</span><span class="sxs-lookup"><span data-stu-id="a86a9-201">DBPROP_TBL_TEMPTABLE</span></span>|<span data-ttu-id="a86a9-202">R/W : Lecture/écriture</span><span class="sxs-lookup"><span data-stu-id="a86a9-202">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="a86a9-203">Valeur par défaut : VARIANT_FALSE Description : par défaut, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client crée des tables nommées par le consommateur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-203">Default: VARIANT_FALSE Description: By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates tables named by the consumer.</span></span> <span data-ttu-id="a86a9-204">Lorsque VARIANT_TRUE, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client génère un nom de table temporaire pour le consommateur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-204">When VARIANT_TRUE, The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="a86a9-205">Le consommateur attribue la valeur NULL au paramètre *pTableID* de **CreateTable**.</span><span class="sxs-lookup"><span data-stu-id="a86a9-205">The consumer sets the *pTableID* parameter of **CreateTable** to NULL.</span></span> <span data-ttu-id="a86a9-206">Le paramètre *ppTableID* doit contenir un pointeur valide.</span><span class="sxs-lookup"><span data-stu-id="a86a9-206">The *ppTableID* parameter must contain a valid pointer.</span></span>|  
  
 <span data-ttu-id="a86a9-207">Si le consommateur demande qu’un ensemble de lignes soit ouvert sur une table créée avec succès, le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] fournisseur de OLE DB Native Client ouvre un ensemble de lignes pris en charge par le curseur.</span><span class="sxs-lookup"><span data-stu-id="a86a9-207">If the consumer requests that a rowset be opened on a successfully created table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider opens a cursor-supported rowset.</span></span> <span data-ttu-id="a86a9-208">Toutes les propriétés de l'ensemble de lignes peuvent être indiquées dans les jeux de propriétés passés.</span><span class="sxs-lookup"><span data-stu-id="a86a9-208">Any rowset properties can be indicated in the property sets passed.</span></span>  
  
 <span data-ttu-id="a86a9-209">L'exemple ci-dessous crée une table [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a86a9-209">This example creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span>  
  
```  
// This CREATE TABLE statement shows the details of the table created by   
// the following example code.  
//  
// CREATE TABLE OrderDetails  
// (  
//    OrderID      int      NOT NULL  
//    ProductID   int      NOT NULL  
//    CONSTRAINT PK_OrderDetails  
//         PRIMARY KEY CLUSTERED (OrderID, ProductID),  
//    UnitPrice   money      NOT NULL,  
//    Quantity   int      NOT NULL,  
//    Discount   decimal(2,2)   NOT NULL  
//        DEFAULT 0  
// )  
//  
// The PRIMARY KEY constraint is created in an additional example.  
HRESULT CreateTable  
    (  
    ITableDefinition* pITableDefinition  
    )  
    {  
    DBID            dbidTable;  
    const ULONG     nCols = 5;  
    ULONG           nCol;  
    ULONG           nProp;  
    DBCOLUMNDESC    dbcoldesc[nCols];  
  
    HRESULT         hr;  
  
    // Set up column descriptions. First, set default property values for  
    //  the columns.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        dbcoldesc[nCol].pwszTypeName = NULL;  
        dbcoldesc[nCol].pTypeInfo = NULL;  
        dbcoldesc[nCol].rgPropertySets = new DBPROPSET;  
        dbcoldesc[nCol].pclsid = NULL;  
        dbcoldesc[nCol].cPropertySets = 1;  
        dbcoldesc[nCol].ulColumnSize = 0;  
        dbcoldesc[nCol].dbcid.eKind = DBKIND_NAME;  
        dbcoldesc[nCol].wType = DBTYPE_I4;  
        dbcoldesc[nCol].bPrecision = 0;  
        dbcoldesc[nCol].bScale = 0;  
  
        dbcoldesc[nCol].rgPropertySets[0].rgProperties =   
            new DBPROP[NCOLPROPS_MAX];  
        dbcoldesc[nCol].rgPropertySets[0].cProperties = NCOLPROPS_MAX;  
        dbcoldesc[nCol].rgPropertySets[0].guidPropertySet =  
            DBPROPSET_COLUMN;  
  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                dwOptions = DBPROPOPTIONS_REQUIRED;  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].colid  
                 = DB_NULLID;  
  
            VariantInit(  
                &(dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                    vValue));  
  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt = VT_BOOL;  
            }  
        }  
  
    // Set the column-specific information.  
    dbcoldesc[0].dbcid.uName.pwszName = L"OrderID";  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[0].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[1].dbcid.uName.pwszName = L"ProductID";  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[1].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[2].dbcid.uName.pwszName = L"UnitPrice";  
    dbcoldesc[2].wType = DBTYPE_CY;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[2].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[3].dbcid.uName.pwszName = L"Quantity";  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[3].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[4].dbcid.uName.pwszName = L"Discount";  
    dbcoldesc[4].wType = DBTYPE_NUMERIC;  
    dbcoldesc[4].bPrecision = 2;  
    dbcoldesc[4].bScale = 2;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].dwPropertyID =   
        DBPROP_COL_DEFAULT;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.vt = VT_BSTR;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.bstrVal =  
        SysAllocString(L"0");  
    dbcoldesc[4].rgPropertySets[0].cProperties = 2;  
  
    // Set up the dbid for OrderDetails.  
    dbidTable.eKind = DBKIND_NAME;  
    dbidTable.uName.pwszName = L"OrderDetails";  
  
    if (FAILED(hr = pITableDefinition->CreateTable(NULL, &dbidTable,  
        nCols, dbcoldesc, NULL, 0, NULL, NULL, NULL)))  
        {  
        DumpError(pITableDefinition, IID_ITableDefinition);  
        goto SAFE_EXIT;  
        }  
  
SAFE_EXIT:  
    // Clean up dynamic allocation in the property sets.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            if (dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt == VT_BSTR)  
                {  
                SysFreeString(dbcoldesc[nCol].rgPropertySets[0].  
                    rgProperties[nProp].vValue.bstrVal);  
                }  
            }  
  
        delete [] dbcoldesc[nCol].rgPropertySets[0].rgProperties;  
        delete [] dbcoldesc[nCol].rgPropertySets;  
        }  
  
    return (hr);  
    }  
```  
  
## <a name="see-also"></a><span data-ttu-id="a86a9-210">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a86a9-210">See Also</span></span>  
 [<span data-ttu-id="a86a9-211">Tables et index</span><span class="sxs-lookup"><span data-stu-id="a86a9-211">Tables and Indexes</span></span>](../../relational-databases/native-client-ole-db-tables-indexes/tables-and-indexes.md)  
  
  
