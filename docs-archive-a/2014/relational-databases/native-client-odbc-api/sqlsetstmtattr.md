---
title: SQLSetStmtAttr | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetStmtAttr function
ms.assetid: 799c80fd-c561-4912-8562-9229076dfd19
author: rothja
ms.author: jroth
ms.openlocfilehash: 725a7917f817af44f17f8da06d484171cbe9a25d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605412"
---
# <a name="sqlsetstmtattr"></a><span data-ttu-id="5c976-102">SQLSetStmtAttr</span><span class="sxs-lookup"><span data-stu-id="5c976-102">SQLSetStmtAttr</span></span>
  <span data-ttu-id="5c976-103">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]  Native Client ne prend pas en charge le modèle de curseur mixte (jeu de clés/dynamique).</span><span class="sxs-lookup"><span data-stu-id="5c976-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver does not support the mixed (keyset/dynamic) cursor model.</span></span> <span data-ttu-id="5c976-104">Les tentatives de définir la taille du jeu de clés à l'aide de SQL_ATTR_KEYSET_SIZE échoue si la valeur définie n'est pas égale à 0.</span><span class="sxs-lookup"><span data-stu-id="5c976-104">Attempts to set the keyset size using SQL_ATTR_KEYSET_SIZE will fail if the value set is not equal to 0.</span></span>  
  
 <span data-ttu-id="5c976-105">L’application définit SQL_ATTR_ROW_ARRAY_SIZE sur toutes les instructions pour déclarer le nombre de lignes retournées sur un appel de fonction **SQLFetch** ou [SQLFetchScroll](sqlfetchscroll.md) .</span><span class="sxs-lookup"><span data-stu-id="5c976-105">The application sets SQL_ATTR_ROW_ARRAY_SIZE on all statements to declare the number of rows returned on a **SQLFetch** or [SQLFetchScroll](sqlfetchscroll.md) function call.</span></span> <span data-ttu-id="5c976-106">Sur les instructions qui indiquent un curseur côté serveur, le pilote utilise SQL_ATTR_ROW_ARRAY_SIZE pour déterminer la taille du bloc des lignes que le serveur génère pour satisfaire une demande d'extraction du curseur.</span><span class="sxs-lookup"><span data-stu-id="5c976-106">On statements indicating a server cursor, the driver uses SQL_ATTR_ROW_ARRAY_SIZE to determine the size of the block of rows the server generates to satisfy a fetch request from the cursor.</span></span> <span data-ttu-id="5c976-107">Dans la taille des blocs d'un curseur dynamique, l'appartenance et l'ordre des lignes sont fixes si le niveau d'isolation de la transaction est suffisant pour garantir des lectures renouvelables des transactions validées.</span><span class="sxs-lookup"><span data-stu-id="5c976-107">Within the block size of a dynamic cursor, row membership and ordering are fixed if the transaction isolation level is sufficient to ensure repeatable reads of committed transactions.</span></span> <span data-ttu-id="5c976-108">Le curseur est totalement dynamique en dehors du bloc indiqué par cette valeur.</span><span class="sxs-lookup"><span data-stu-id="5c976-108">The cursor is completely dynamic outside of the block indicated by this value.</span></span> <span data-ttu-id="5c976-109">La taille des blocs de curseur côté serveur est complètement dynamique et peut être changée à n'importe quel stade du traitement d'extraction.</span><span class="sxs-lookup"><span data-stu-id="5c976-109">Server cursor block size is completely dynamic and can be changed at any point in fetch processing.</span></span>  
  
## <a name="sqlsetstmtattr-and-table-valued-parameters"></a><span data-ttu-id="5c976-110">SQLSetStmtAttr et paramètres table</span><span class="sxs-lookup"><span data-stu-id="5c976-110">SQLSetStmtAttr and Table-Valued Parameters</span></span>  
 <span data-ttu-id="5c976-111">SQLSetStmtAttr peut être utilisé pour définir SQL_SOPT_SS_PARAM_FOCUS dans le descripteur de paramètre d’application (APD) avant d’accéder aux champs de descripteur pour les colonnes de paramètre table.</span><span class="sxs-lookup"><span data-stu-id="5c976-111">SQLSetStmtAttr can be used to set SQL_SOPT_SS_PARAM_FOCUS in the application parameter descriptor (APD) before accessing descriptor fields for table-valued parameter columns.</span></span>  
  
 <span data-ttu-id="5c976-112">Si vous tentez de définir SQL_SOPT_SS_PARAM_FOCUS sur l’ordinal d’un paramètre qui n’est pas un paramètre table, SQLSetStmtAttr retourne SQL_ERROR et un enregistrement de diagnostic est créé avec SQLSTATE = HY024 et le message « valeur d’attribut non valide ».</span><span class="sxs-lookup"><span data-stu-id="5c976-112">If an attempt is made to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a parameter that is not a table-valued parameter, SQLSetStmtAttr returns SQL_ERROR and a diagnostic record is created with SQLSTATE = HY024 and the message "Invalid attribute value".</span></span> <span data-ttu-id="5c976-113">SQL_SOPT_SS_PARAM_FOCUS n'est pas modifié quand SQL_ERROR est retourné.</span><span class="sxs-lookup"><span data-stu-id="5c976-113">SQL_SOPT_SS_PARAM_FOCUS is not changed when SQL_ERROR is returned.</span></span>  
  
 <span data-ttu-id="5c976-114">La définition de SQL_SOPT_SS_PARAM_FOCUS sur 0 restaure l'accès aux enregistrements de descripteurs pour les paramètres.</span><span class="sxs-lookup"><span data-stu-id="5c976-114">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores access to descriptor records for parameters.</span></span>  
  
 <span data-ttu-id="5c976-115">SQLSetStmtAttr peut également être utilisé pour définir SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="5c976-115">SQLSetStmtAttr can also be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="5c976-116">Pour plus d'informations, consultez la section SQL_SOPT_SS_NAME_SCOPE, plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="5c976-116">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.</span></span>  
  
 <span data-ttu-id="5c976-117">Pour plus d’informations, consultez [métadonnées de paramètre table pour les instructions préparées](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span><span class="sxs-lookup"><span data-stu-id="5c976-117">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="5c976-118">Pour plus d’informations sur les paramètres table, consultez [paramètres table &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="5c976-118">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlsetstmtattr-support-for-sparse-columns"></a><span data-ttu-id="5c976-119">Prise en charge par SQLSetStmtAttr des colonnes éparses</span><span class="sxs-lookup"><span data-stu-id="5c976-119">SQLSetStmtAttr Support for Sparse Columns</span></span>  
 <span data-ttu-id="5c976-120">SQLSetStmtAttr peut être utilisé pour définir SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="5c976-120">SQLSetStmtAttr can be used to set SQL_SOPT_SS_NAME_SCOPE.</span></span> <span data-ttu-id="5c976-121">Pour plus d’informations, consultez la section SQL_SOPT_SS_NAME_SCOPE, plus loin dans cette rubrique. Pour plus d’informations sur les colonnes éparses, consultez [prise en charge des colonnes éparses &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="5c976-121">For more information, see the SQL_SOPT_SS_NAME_SCOPE section, later in this topic.For more information about sparse columns, see [Sparse Columns Support &#40;ODBC&#41;](../native-client/odbc/sparse-columns-support-odbc.md).</span></span>  
  
## <a name="statement-attributes"></a><span data-ttu-id="5c976-122">Attributs d'instruction</span><span class="sxs-lookup"><span data-stu-id="5c976-122">Statement Attributes</span></span>  
 <span data-ttu-id="5c976-123">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client prend aussi en charge les attributs d'instruction spécifiques au pilote suivants.</span><span class="sxs-lookup"><span data-stu-id="5c976-123">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver also supports the following driver-specific statement attributes.</span></span>  
  
### <a name="sql_sopt_ss_cursor_options"></a><span data-ttu-id="5c976-124">SQL_SOPT_SS_CURSOR_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="5c976-124">SQL_SOPT_SS_CURSOR_OPTIONS</span></span>  
 <span data-ttu-id="5c976-125">L'attribut SQL_SOPT_SS_CURSOR spécifie si le pilote utilise les options de performances spécifiques au pilote sur les curseurs.</span><span class="sxs-lookup"><span data-stu-id="5c976-125">The SQL_SOPT_SS_CURSOR attribute specifies whether the driver will use driver-specific performance options on cursors.</span></span> <span data-ttu-id="5c976-126">[SQLGetData](sqlgetdata.md) n’est pas autorisé lorsque ces options sont définies.</span><span class="sxs-lookup"><span data-stu-id="5c976-126">[SQLGetData](sqlgetdata.md) is not allowed when these options are set.</span></span> <span data-ttu-id="5c976-127">La valeur par défaut est SQL_CO_OFF.</span><span class="sxs-lookup"><span data-stu-id="5c976-127">The default setting is SQL_CO_OFF.</span></span> <span data-ttu-id="5c976-128">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-128">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="5c976-129">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-129">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-130">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-130">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-131">SQL_CO_OFF</span><span class="sxs-lookup"><span data-stu-id="5c976-131">SQL_CO_OFF</span></span>|<span data-ttu-id="5c976-132">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-132">Default.</span></span> <span data-ttu-id="5c976-133">Désactive les curseurs avant uniquement et en lecture seule et l’auto-extraction, active **SQLGetData** sur les curseurs avant uniquement et en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="5c976-133">Disables fast forward-only, read-only cursors and autofetch, enables **SQLGetData** on forward-only, read-only cursors.</span></span> <span data-ttu-id="5c976-134">Lorsque SQL_SOPT_SS_CURSOR_OPTIONS a la valeur SQL_CO_OFF, le type de curseur ne change pas.</span><span class="sxs-lookup"><span data-stu-id="5c976-134">When SQL_SOPT_SS_CURSOR_OPTIONS is set to SQL_CO_OFF, the cursor type will not change.</span></span> <span data-ttu-id="5c976-135">Autrement dit, le curseur avant uniquement rapide demeure un curseur avant uniquement rapide.</span><span class="sxs-lookup"><span data-stu-id="5c976-135">That is, fast forward-only cursor will remain a fast forward-only cursor.</span></span> <span data-ttu-id="5c976-136">Pour modifier le type de curseur, l’application doit maintenant définir un type de curseur différent à l’aide de `SQLSetStmtAttr` /SQL_ATTR_CURSOR_TYPE.</span><span class="sxs-lookup"><span data-stu-id="5c976-136">To change the cursor type, the application must now set a different cursor type using `SQLSetStmtAttr`/SQL_ATTR_CURSOR_TYPE.</span></span>|  
|<span data-ttu-id="5c976-137">SQL_CO_FFO</span><span class="sxs-lookup"><span data-stu-id="5c976-137">SQL_CO_FFO</span></span>|<span data-ttu-id="5c976-138">Active les curseurs avant uniquement et en lecture seule, désactive **SQLGetData** sur les curseurs avant uniquement et en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="5c976-138">Enables fast forward-only, read-only cursors, disables **SQLGetData** on forward-only, read-only cursors.</span></span>|  
|<span data-ttu-id="5c976-139">SQL_CO_AF</span><span class="sxs-lookup"><span data-stu-id="5c976-139">SQL_CO_AF</span></span>|<span data-ttu-id="5c976-140">Active l'option d'auto-extraction sur tout type de curseur.</span><span class="sxs-lookup"><span data-stu-id="5c976-140">Enables the autofetch option on any cursor type.</span></span> <span data-ttu-id="5c976-141">Lorsque cette option est définie pour un descripteur d’instruction, **SQLExecute** ou **SQLExecDirect** génère une **SQLFetchScroll** implicite (SQL_FIRST).</span><span class="sxs-lookup"><span data-stu-id="5c976-141">When this option is set for a statement handle, **SQLExecute** or **SQLExecDirect** will generate an implicit **SQLFetchScroll** (SQL_FIRST).</span></span> <span data-ttu-id="5c976-142">Le curseur est ouvert et le premier lot de lignes est retourné en un seul aller-retour au serveur.</span><span class="sxs-lookup"><span data-stu-id="5c976-142">The cursor is opened and the first batch of rows is returned in a single roundtrip to the server.</span></span>|  
|<span data-ttu-id="5c976-143">SQL_CO_FFO_AF</span><span class="sxs-lookup"><span data-stu-id="5c976-143">SQL_CO_FFO_AF</span></span>|<span data-ttu-id="5c976-144">Active les curseurs avant uniquement rapides avec l'option d'auto-extraction.</span><span class="sxs-lookup"><span data-stu-id="5c976-144">Enables fast forward-only cursors with the autofetch option.</span></span> <span data-ttu-id="5c976-145">La situation est la même que si SQL_CO_AF et SQL_CO_FFO étaient spécifiés.</span><span class="sxs-lookup"><span data-stu-id="5c976-145">It is the same as if both SQL_CO_AF and SQL_CO_FFO are specified.</span></span>|  
  
 <span data-ttu-id="5c976-146">Lorsque ces options sont définies, le serveur ferme automatiquement le curseur lorsqu'il détecte que la dernière ligne a été extraite.</span><span class="sxs-lookup"><span data-stu-id="5c976-146">When these options are set, the server closes the cursor automatically when it detects that the last row has been fetched.</span></span> <span data-ttu-id="5c976-147">L’application doit toujours appeler [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) ou [SQLCloseCursor](sqlclosecursor.md), mais le pilote n’a pas besoin d’envoyer la notification de fermeture au serveur.</span><span class="sxs-lookup"><span data-stu-id="5c976-147">The application must still call [SQLFreeStmt](sqlfreestmt.md) (SQL_CLOSE) or [SQLCloseCursor](sqlclosecursor.md), but the driver does not have to send the close notification to the server.</span></span>  
  
 <span data-ttu-id="5c976-148">Si la liste de sélection contient une colonne **Text**, **ntext**ou **image** , le curseur avant uniquement rapide est converti en curseur dynamique et **SQLGetData** est autorisé.</span><span class="sxs-lookup"><span data-stu-id="5c976-148">If the select list contains a **text**, **ntext**, or **image** column, the fast forward-only cursor is converted to a dynamic cursor and **SQLGetData** is allowed.</span></span>  
  
### <a name="sql_sopt_ss_defer_prepare"></a><span data-ttu-id="5c976-149">SQL_SOPT_SS_DEFER_PREPARE</span><span class="sxs-lookup"><span data-stu-id="5c976-149">SQL_SOPT_SS_DEFER_PREPARE</span></span>  
 <span data-ttu-id="5c976-150">L’attribut SQL_SOPT_SS_DEFER_PREPARE détermine si l’instruction est préparée immédiatement ou différée jusqu’à l’exécution de **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) ou [SQLDescribeParam](sqldescribeparam.md) .</span><span class="sxs-lookup"><span data-stu-id="5c976-150">The SQL_SOPT_SS_DEFER_PREPARE attribute determines whether the statement is prepared immediately or deferred until **SQLExecute**, [SQLDescribeCol](sqldescribecol.md) or [SQLDescribeParam](sqldescribeparam.md) is executed.</span></span> <span data-ttu-id="5c976-151">Dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 et version antérieure, cette propriété est ignorée (aucune préparation différée).</span><span class="sxs-lookup"><span data-stu-id="5c976-151">In [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 7.0 and earlier, this property is ignored (no deferred prepare).</span></span> <span data-ttu-id="5c976-152">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-152">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="5c976-153">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-153">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-154">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-154">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-155">SQL_DP_ON</span><span class="sxs-lookup"><span data-stu-id="5c976-155">SQL_DP_ON</span></span>|<span data-ttu-id="5c976-156">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-156">Default.</span></span> <span data-ttu-id="5c976-157">Après l’appel de la [fonction SQLPrepare](https://go.microsoft.com/fwlink/?LinkId=59360), la préparation de l’instruction est différée jusqu’à ce que **SQLExecute** soit appelé ou que l’opération de métapropriété (**SQLDescribeCol** ou **SQLDescribeParam**) soit exécutée.</span><span class="sxs-lookup"><span data-stu-id="5c976-157">After calling [SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360), the statement preparation is deferred until **SQLExecute** is called or metaproperty operation (**SQLDescribeCol** or **SQLDescribeParam**) is executed.</span></span>|  
|<span data-ttu-id="5c976-158">SQL_DP_OFF</span><span class="sxs-lookup"><span data-stu-id="5c976-158">SQL_DP_OFF</span></span>|<span data-ttu-id="5c976-159">L’instruction est préparée dès que **SQLPrepare** est exécuté.</span><span class="sxs-lookup"><span data-stu-id="5c976-159">The statement is prepared as soon as **SQLPrepare** is executed.</span></span>|  
  
### <a name="sql_sopt_ss_regionalize"></a><span data-ttu-id="5c976-160">SQL_SOPT_SS_REGIONALIZE</span><span class="sxs-lookup"><span data-stu-id="5c976-160">SQL_SOPT_SS_REGIONALIZE</span></span>  
 <span data-ttu-id="5c976-161">L'attribut SQL_SOPT_SS_REGIONALIZE est utilisé pour déterminer la conversion des données au niveau de l'instruction.</span><span class="sxs-lookup"><span data-stu-id="5c976-161">The SQL_SOPT_SS_REGIONALIZE attribute is used to determine data conversion at the statement level.</span></span> <span data-ttu-id="5c976-162">L'attribut oblige le pilote à respecter les paramètres régionaux du client lors de la conversion des valeurs date, heure et devise monétaire en chaînes de caractères.</span><span class="sxs-lookup"><span data-stu-id="5c976-162">The attribute causes the driver to respect the client locale setting when converting date, time, and currency values to character strings.</span></span> <span data-ttu-id="5c976-163">La conversion s'effectue uniquement des types de données natifs [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] vers les chaînes de caractères.</span><span class="sxs-lookup"><span data-stu-id="5c976-163">The conversion is from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native data types to character strings only.</span></span>  
  
 <span data-ttu-id="5c976-164">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-164">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="5c976-165">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-165">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-166">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-166">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-167">SQL_RE_OFF</span><span class="sxs-lookup"><span data-stu-id="5c976-167">SQL_RE_OFF</span></span>|<span data-ttu-id="5c976-168">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-168">Default.</span></span> <span data-ttu-id="5c976-169">Le pilote ne convertit pas les valeurs date, heure et devise monétaire en données de chaînes de caractères à l'aide des paramètres régionaux du client.</span><span class="sxs-lookup"><span data-stu-id="5c976-169">The driver does not convert date, time, and currency data to character string data using the client locale setting.</span></span>|  
|<span data-ttu-id="5c976-170">SQL_RE_ON</span><span class="sxs-lookup"><span data-stu-id="5c976-170">SQL_RE_ON</span></span>|<span data-ttu-id="5c976-171">Le pilote utilise les paramètres régionaux du client lors de la conversion des données date, heure et devise monétaire en données de chaînes de caractères.</span><span class="sxs-lookup"><span data-stu-id="5c976-171">The driver uses the client locale setting when converting date, time, and currency data to character string data.</span></span>|  
  
 <span data-ttu-id="5c976-172">Les paramètres de conversion régionaux s'appliquent aux types de données monétaire, numérique, date et heure.</span><span class="sxs-lookup"><span data-stu-id="5c976-172">Regional conversion settings apply to currency, numeric, date, and time data types.</span></span> <span data-ttu-id="5c976-173">Le paramètre de conversion est applicable uniquement aux conversions sortantes lorsque des valeurs monétaire, numérique, de date ou d'heure sont converties en chaînes de caractères.</span><span class="sxs-lookup"><span data-stu-id="5c976-173">The conversion setting is only applicable to output conversions when currency, numeric, date, or time values are converted to character strings.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5c976-174">Lorsque l'option d'instruction SQL_SOPT_SS_REGIONALIZE est activée, le pilote utilise les paramètres du Registre des paramètres régionaux de l'utilisateur en cours.</span><span class="sxs-lookup"><span data-stu-id="5c976-174">When the statement option SQL_SOPT_SS_REGIONALIZE is on, the driver uses the locale registry settings for the current user.</span></span> <span data-ttu-id="5c976-175">Le pilote n’honore pas les paramètres régionaux du thread actuel si l’application le définit par, par exemple, en appelant **SetThreadLocale**.</span><span class="sxs-lookup"><span data-stu-id="5c976-175">The driver does not honor the current thread's locale if the application sets it by, for example, calling **SetThreadLocale**.</span></span>  
  
 <span data-ttu-id="5c976-176">La modification du comportement régional d'une source de données peut provoquer l'échec de l'application.</span><span class="sxs-lookup"><span data-stu-id="5c976-176">Altering the regional behavior of a data source can cause application failure.</span></span> <span data-ttu-id="5c976-177">Une application qui analyse les chaînes date et s'attend à ce qu'elles apparaissent comme définies par ODBC peut être affectée de manière négative par la modification de cette valeur.</span><span class="sxs-lookup"><span data-stu-id="5c976-177">An application that parses date strings and expects date strings to appear as defined by ODBC, could be adversely affected by altering this value.</span></span>  
  
### <a name="sql_sopt_ss_textptr_logging"></a><span data-ttu-id="5c976-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span><span class="sxs-lookup"><span data-stu-id="5c976-178">SQL_SOPT_SS_TEXTPTR_LOGGING</span></span>  
 <span data-ttu-id="5c976-179">L’attribut SQL_SOPT_SS_TEXTPTR_LOGGING active ou désactive la journalisation des opérations sur les colonnes contenant des données **texte** ou **image** .</span><span class="sxs-lookup"><span data-stu-id="5c976-179">The SQL_SOPT_SS_TEXTPTR_LOGGING attribute toggles logging of operations on columns containing **text** or **image** data.</span></span> <span data-ttu-id="5c976-180">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-180">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="5c976-181">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-181">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-182">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-182">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-183">SQL_TL_OFF</span><span class="sxs-lookup"><span data-stu-id="5c976-183">SQL_TL_OFF</span></span>|<span data-ttu-id="5c976-184">Désactive la journalisation des opérations effectuées sur des données de **texte** et d' **image** .</span><span class="sxs-lookup"><span data-stu-id="5c976-184">Disables logging of operations performed on **text** and **image** data.</span></span>|  
|<span data-ttu-id="5c976-185">SQL_TL_ON</span><span class="sxs-lookup"><span data-stu-id="5c976-185">SQL_TL_ON</span></span>|<span data-ttu-id="5c976-186">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-186">Default.</span></span> <span data-ttu-id="5c976-187">Active la journalisation des opérations effectuées sur les données de **texte** et d' **image** .</span><span class="sxs-lookup"><span data-stu-id="5c976-187">Enables logging of operations performed on **text** and **image** data.</span></span>|  
  
### <a name="sql_sopt_ss_hidden_columns"></a><span data-ttu-id="5c976-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span><span class="sxs-lookup"><span data-stu-id="5c976-188">SQL_SOPT_SS_HIDDEN_COLUMNS</span></span>  
 <span data-ttu-id="5c976-189">L'attribut SQL_SOPT_SS_HIDDEN_COLUMNS expose dans le jeu de résultats les colonnes masquées dans une instruction [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="5c976-189">The SQL_SOPT_SS_HIDDEN_COLUMNS attribute exposes, in the result set, columns hidden in a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] SELECT FOR BROWSE statement.</span></span> <span data-ttu-id="5c976-190">Le pilote n'expose pas ces colonnes par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-190">The driver does not expose these columns by default.</span></span> <span data-ttu-id="5c976-191">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-191">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
|<span data-ttu-id="5c976-192">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-192">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-193">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-193">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-194">SQL_HC_OFF</span><span class="sxs-lookup"><span data-stu-id="5c976-194">SQL_HC_OFF</span></span>|<span data-ttu-id="5c976-195">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-195">Default.</span></span> <span data-ttu-id="5c976-196">Les colonnes FOR BROWSE sont masquées dans le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="5c976-196">FOR BROWSE columns are hidden from the result set.</span></span>|  
|<span data-ttu-id="5c976-197">SQL_HC_ON</span><span class="sxs-lookup"><span data-stu-id="5c976-197">SQL_HC_ON</span></span>|<span data-ttu-id="5c976-198">Expose les colonnes FOR BROWSE.</span><span class="sxs-lookup"><span data-stu-id="5c976-198">Exposes FOR BROWSE columns.</span></span>|  
  
### <a name="sql_sopt_ss_querynotification_msgtext"></a><span data-ttu-id="5c976-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span><span class="sxs-lookup"><span data-stu-id="5c976-199">SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT</span></span>  
 <span data-ttu-id="5c976-200">L'attribut SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT retourne le texte du message pour la demande de notification de requête.</span><span class="sxs-lookup"><span data-stu-id="5c976-200">The SQL_SOPT_SS_QUERYNOTIFICATION_MSGTEXT attribute returns the message text for the query notification request.</span></span>  
  
### <a name="sql_sopt_ss_querynotification_options"></a><span data-ttu-id="5c976-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span><span class="sxs-lookup"><span data-stu-id="5c976-201">SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS</span></span>  
 <span data-ttu-id="5c976-202">L'attribut SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS spécifie les options utilisées pour la demande de notification de requête.</span><span class="sxs-lookup"><span data-stu-id="5c976-202">The SQL_SOPT_SS_QUERYNOTIFICATION_OPTIONS attribute specifies the options used for the query notification request.</span></span> <span data-ttu-id="5c976-203">Ces options sont spécifiés dans une chaîne avec la syntaxe `name=value` comme spécifié ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="5c976-203">These are specified in a string with `name=value` syntax as specified below.</span></span> <span data-ttu-id="5c976-204">L'application est chargée de créer le service et de lire les notifications de la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c976-204">The application is responsible for creating the service and reading notifications off of the queue.</span></span>  
  
 <span data-ttu-id="5c976-205">La syntaxe de la chaîne des options de notifications de requêtes est :</span><span class="sxs-lookup"><span data-stu-id="5c976-205">The syntax of the query notifications options string is:</span></span>  
  
 `service=<service-name>[;(local database=<database>|broker instance=<broker instance>)]`  
  
 <span data-ttu-id="5c976-206">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="5c976-206">For example:</span></span>  
  
 `service=mySSBService;local database=mydb`  
  
### <a name="sql_sopt_ss_querynotification_timeout"></a><span data-ttu-id="5c976-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span><span class="sxs-lookup"><span data-stu-id="5c976-207">SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT</span></span>  
 <span data-ttu-id="5c976-208">L'attribut SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT spécifie le nombre de secondes pendant lesquelles la notification de requête demeure active.</span><span class="sxs-lookup"><span data-stu-id="5c976-208">The SQL_SOPT_SS_QUERYNOTIFICATION_TIMEOUT attribute specifies the number of seconds that the query notification is to remain active.</span></span> <span data-ttu-id="5c976-209">La valeur par défaut est de 432 000 secondes (5 jours).</span><span class="sxs-lookup"><span data-stu-id="5c976-209">The default value is 432000 seconds (5 days).</span></span> <span data-ttu-id="5c976-210">La valeur de *ValuePtr* est de type SQLLEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-210">The *ValuePtr* value is of type SQLLEN.</span></span>  
  
### <a name="sql_sopt_ss_param_focus"></a><span data-ttu-id="5c976-211">SQL_SOPT_SS_PARAM_FOCUS</span><span class="sxs-lookup"><span data-stu-id="5c976-211">SQL_SOPT_SS_PARAM_FOCUS</span></span>  
 <span data-ttu-id="5c976-212">L’attribut SQL_SOPT_SS_PARAM_FOCUS spécifie le focus pour les appels SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec et SQLSetDescRec suivants.</span><span class="sxs-lookup"><span data-stu-id="5c976-212">The SQL_SOPT_SS_PARAM_FOCUS attribute specifies the focus for subsequent SQLBindParameter, SQLGetDescField, SQLSetDescField, SQLGetDescRec, and SQLSetDescRec calls.</span></span>  
  
 <span data-ttu-id="5c976-213">Le type de SQL_SOPT_SS_PARAM_FOCUS est SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-213">The type for SQL_SOPT_SS_PARAM_FOCUS is SQLULEN.</span></span>  
  
 <span data-ttu-id="5c976-214">La valeur par défaut est 0, ce qui signifie que ces appels adressent les paramètres qui correspondent aux marqueurs de paramètre dans l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="5c976-214">The default is 0, which means that these calls address parameters that correspond to parameter markers in the SQL statement.</span></span> <span data-ttu-id="5c976-215">En cas de définition sur le numéro de paramètre d'un paramètre table, ces appels adressent les colonnes de ce paramètre table.</span><span class="sxs-lookup"><span data-stu-id="5c976-215">When set to the parameter number of a table-valued parameter, these calls address columns of that table-valued parameter.</span></span> <span data-ttu-id="5c976-216">En cas de définition sur une valeur qui n'est pas le numéro de paramètre d'un paramètre table, ces appels retournent l'erreur IM020 : « Le focus de paramètre ne fait pas référence à un paramètre table ».</span><span class="sxs-lookup"><span data-stu-id="5c976-216">When set to a value that is not the parameter number of a table-valued parameter, these calls return the error IM020: "Parameter focus does not refer to a table-valued parameter".</span></span>  
  
### <a name="sql_sopt_ss_name_scope"></a><span data-ttu-id="5c976-217">SQL_SOPT_SS_NAME_SCOPE</span><span class="sxs-lookup"><span data-stu-id="5c976-217">SQL_SOPT_SS_NAME_SCOPE</span></span>  
 <span data-ttu-id="5c976-218">L'attribut SQL_SOPT_SS_NAME_SCOPE spécifie la portée de nom des appels de fonctions de catalogue suivants.</span><span class="sxs-lookup"><span data-stu-id="5c976-218">The SQL_SOPT_SS_NAME_SCOPE attribute specifies the name scope for subsequent catalog function calls.</span></span> <span data-ttu-id="5c976-219">Le jeu de résultats retourné par SQLColumns dépend du paramètre de SQL_SOPT_SS_NAME_SCOPE.</span><span class="sxs-lookup"><span data-stu-id="5c976-219">The result set returned by SQLColumns depends on the setting of SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="5c976-220">Le type de SQL_SOPT_SS_NAME_SCOPE est SQLULEN.</span><span class="sxs-lookup"><span data-stu-id="5c976-220">The type for SQL_SOPT_SS_NAME_SCOPE is SQLULEN.</span></span>  
  
|<span data-ttu-id="5c976-221">Valeur *ValuePtr*</span><span class="sxs-lookup"><span data-stu-id="5c976-221">*ValuePtr* value</span></span>|<span data-ttu-id="5c976-222">Description</span><span class="sxs-lookup"><span data-stu-id="5c976-222">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="5c976-223">SQL_SS_NAME_SCOPE_TABLE</span><span class="sxs-lookup"><span data-stu-id="5c976-223">SQL_SS_NAME_SCOPE_TABLE</span></span>|<span data-ttu-id="5c976-224">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c976-224">Default.</span></span><br /><br /> <span data-ttu-id="5c976-225">Lors de l'utilisation de paramètres table, indique que les métadonnées des tables réelles doivent être retournées.</span><span class="sxs-lookup"><span data-stu-id="5c976-225">When using table-valued parameters, indicates that metadata for actual tables should be returned.</span></span><br /><br /> <span data-ttu-id="5c976-226">Lors de l’utilisation de la fonctionnalité des colonnes éparses, SQLColumns retourne uniquement les colonnes qui ne sont pas des membres de l’épars `column_set` .</span><span class="sxs-lookup"><span data-stu-id="5c976-226">When using the sparse columns feature, SQLColumns will return only columns that are not members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="5c976-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span><span class="sxs-lookup"><span data-stu-id="5c976-227">SQL_SS_NAME_SCOPE_TABLE_TYPE</span></span>|<span data-ttu-id="5c976-228">Indique que l'application requiert les métadonnées pour un type de table, plutôt qu'une table réelle (les fonctions de catalogue doivent retourner les métadonnées pour les types de table).</span><span class="sxs-lookup"><span data-stu-id="5c976-228">Indicates that the application requires metadata for a table type, rather than an actual table (catalog functions should return metadata for table types).</span></span> <span data-ttu-id="5c976-229">L’application passe ensuite la TYPE_NAME du paramètre table comme paramètre *TableName* .</span><span class="sxs-lookup"><span data-stu-id="5c976-229">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span>|  
|<span data-ttu-id="5c976-230">SQL_SS_NAME_SCOPE_EXTENDED</span><span class="sxs-lookup"><span data-stu-id="5c976-230">SQL_SS_NAME_SCOPE_EXTENDED</span></span>|<span data-ttu-id="5c976-231">Lors de l’utilisation de la fonctionnalité des colonnes éparses, SQLColumns retourne toutes les colonnes, indépendamment de l' `column_set` appartenance.</span><span class="sxs-lookup"><span data-stu-id="5c976-231">When using the sparse columns feature, SQLColumns returns all columns, regardless of `column_set` membership.</span></span>|  
|<span data-ttu-id="5c976-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span><span class="sxs-lookup"><span data-stu-id="5c976-232">SQL_SS_NAME_SCOPE_SPARSE_COLUMN_SET</span></span>|<span data-ttu-id="5c976-233">Lors de l’utilisation de la fonctionnalité des colonnes éparses, SQLColumns retourne uniquement les colonnes qui sont membres du épars `column_set` .</span><span class="sxs-lookup"><span data-stu-id="5c976-233">When using the sparse columns feature, SQLColumns returns only columns that are members of the sparse `column_set`.</span></span>|  
|<span data-ttu-id="5c976-234">SQL_SS_NAME_SCOPE_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="5c976-234">SQL_SS_NAME_SCOPE_DEFAULT</span></span>|<span data-ttu-id="5c976-235">Identique à SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="5c976-235">Equal to SQL_SS_NAME_SCOPE_TABLE.</span></span>|  
  
 <span data-ttu-id="5c976-236">SS_TYPE_CATALOG_NAME et SS_TYPE_SCHEMA_NAME sont respectivement utilisés avec les paramètres *nomcatalogue* et *SchemaName* pour identifier le catalogue et le schéma du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="5c976-236">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="5c976-237">Quand une application a fini d'extraire les métadonnées des paramètres table, elle doit redéfinir SQL_SOPT_SS_NAME_SCOPE avec sa valeur par défaut SQL_SS_NAME_SCOPE_TABLE.</span><span class="sxs-lookup"><span data-stu-id="5c976-237">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="5c976-238">Lorsque SQL_SOPT_SS_NAME_SCOPE est défini avec la valeur SQL_SS_NAME_SCOPE_TABLE, les requêtes adressées aux serveurs liés échouent.</span><span class="sxs-lookup"><span data-stu-id="5c976-238">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="5c976-239">Les appels à SQLColumns ou SQLPrimaryKeys avec un catalogue qui contient un composant serveur échouent.</span><span class="sxs-lookup"><span data-stu-id="5c976-239">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
 <span data-ttu-id="5c976-240">Si vous essayez de définir SQL_SOPT_SS_NAME_SCOPE avec une valeur non valide, SQL_ERROR est retourné et un enregistrement de diagnostic est généré avec SQLSTATE HY024 et le message « Valeur d'attribut non valide ».</span><span class="sxs-lookup"><span data-stu-id="5c976-240">If you attempt to set SQL_SOPT_SS_NAME_SCOPE to an invalid value, SQL_ERROR is returned and a diagnostic record is generated with SQLSTATE HY024 and the message "Invalid attribute value".</span></span>  
  
 <span data-ttu-id="5c976-241">Si une fonction de catalogue autre que SQLTables, SQLColumns ou SQLPrimaryKeys est appelée lorsque SQL_SOPT_SS_NAME_SCOPE a une valeur autre que SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR est retourné.</span><span class="sxs-lookup"><span data-stu-id="5c976-241">If a catalog function other then SQLTables, SQLColumns, or SQLPrimaryKeys is called when SQL_SOPT_SS_NAME_SCOPE has a value other than SQL_SS_NAME_SCOPE_TABLE, SQL_ERROR is returned.</span></span> <span data-ttu-id="5c976-242">Un enregistrement de diagnostic est généré avec SQLSTATE HY010 et le message « Erreur de séquence de fonction (SQL_SOPT_SS_NAME_SCOPE n'est pas défini avec la valeur SQL_SS_NAME_SCOPE_TABLE) ».</span><span class="sxs-lookup"><span data-stu-id="5c976-242">A diagnostic record is generated with SQLSTATE HY010 and the message "Function sequence error (SQL_SOPT_SS_NAME_SCOPE is not set to SQL_SS_NAME_SCOPE_TABLE)".</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5c976-243">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5c976-243">See Also</span></span>  
 <span data-ttu-id="5c976-244">[SQLGetStmtAttr fonction)](https://go.microsoft.com/fwlink/?LinkId=59355) </span><span class="sxs-lookup"><span data-stu-id="5c976-244">[SQLGetStmtAttr Function](https://go.microsoft.com/fwlink/?LinkId=59355) </span></span>  
 [<span data-ttu-id="5c976-245">Détails de l’implémentation d’API ODBC</span><span class="sxs-lookup"><span data-stu-id="5c976-245">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
