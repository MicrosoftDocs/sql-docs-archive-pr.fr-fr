---
title: SQLBindParameter | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBindParameter function
ms.assetid: c302c87a-e7f4-4d2b-a0a7-de42210174ac
author: rothja
ms.author: jroth
ms.openlocfilehash: 6e50886457c4c20110880cc5b75ec594fd3eaba5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87614032"
---
# <a name="sqlbindparameter"></a><span data-ttu-id="db0d3-102">SQLBindParameter</span><span class="sxs-lookup"><span data-stu-id="db0d3-102">SQLBindParameter</span></span>
  <span data-ttu-id="db0d3-103">`SQLBindParameter`peut éliminer le fardeau de la conversion des données lorsqu’il est utilisé pour fournir des données pour le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pilote ODBC Native Client, ce qui permet d’obtenir des gains de performances significatifs pour les composants client et serveur des applications.</span><span class="sxs-lookup"><span data-stu-id="db0d3-103">`SQLBindParameter` can eliminate the burden of data conversion when used to provide data for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver, resulting in significant performance gains for both the client and server components of applications.</span></span> <span data-ttu-id="db0d3-104">D'autres avantages incluent une perte réduite de précision lors de l'insertion ou de la mise à jour de types de données numériques approximatifs.</span><span class="sxs-lookup"><span data-stu-id="db0d3-104">Other benefits include reduced loss of precision when inserting or updating approximate numeric data types.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="db0d3-105">Lors de l'insertion de données de type `char` et `wchar` dans une colonne image, la taille des données passées est utilisée, par opposition à la taille des données après conversion vers un format binaire.</span><span class="sxs-lookup"><span data-stu-id="db0d3-105">When inserting `char` and `wchar` type data into an image column, the size of the data being passed in is used, as opposed to the size of the data after conversion to a binary format.</span></span>  
  
 <span data-ttu-id="db0d3-106">Si le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client rencontre une erreur sur un élément de tableau unique d'un tableau de paramètres, le pilote continue d'exécuter l'instruction pour les éléments de tableau restants.</span><span class="sxs-lookup"><span data-stu-id="db0d3-106">If the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver encounters an error on a single array element of an array of parameters, the driver continues to execute the statement for the remaining array elements.</span></span> <span data-ttu-id="db0d3-107">Si l'application a lié un tableau d'éléments d'état de paramètre pour l'instruction, les lignes des paramètres qui génèrent des erreurs peuvent être déterminées à partir de ce tableau.</span><span class="sxs-lookup"><span data-stu-id="db0d3-107">If the application has bound an array of parameter status elements for the statement, the rows of parameters generating errors can be determined from the array.</span></span>  
  
 <span data-ttu-id="db0d3-108">Lors de l'utilisation du pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, spécifiez SQL_PARAM_INPUT lors de la liaison de paramètres d'entrée.</span><span class="sxs-lookup"><span data-stu-id="db0d3-108">When using the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver, specify SQL_PARAM_INPUT when binding input parameters.</span></span> <span data-ttu-id="db0d3-109">Spécifiez seulement SQL_PARAM_OUTPUT ou SQL_PARAM_INPUT_OUTPUT lors de la liaison de paramètres de procédure stockée définis avec le mot clé OUTPUT.</span><span class="sxs-lookup"><span data-stu-id="db0d3-109">Only specify SQL_PARAM_OUTPUT or SQL_PARAM_INPUT_OUTPUT when binding stored procedure parameters defined with the OUTPUT keyword.</span></span>  
  
 <span data-ttu-id="db0d3-110">[SQLRowCount](sqlrowcount.md) n’est pas fiable avec le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pilote ODBC Native Client si un élément de tableau d’un tableau de paramètres liés provoque une erreur dans l’exécution de l’instruction.</span><span class="sxs-lookup"><span data-stu-id="db0d3-110">[SQLRowCount](sqlrowcount.md) is unreliable with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver if an array element of a bound-parameter array causes an error in statement execution.</span></span> <span data-ttu-id="db0d3-111">L'attribut d'instruction ODBC SQL_ATTR_PARAMS_PROCESSED_PTR signale le nombre de lignes traitées avant l'erreur.</span><span class="sxs-lookup"><span data-stu-id="db0d3-111">The ODBC statement attribute SQL_ATTR_PARAMS_PROCESSED_PTR reports the number of rows processed before the error occurs.</span></span> <span data-ttu-id="db0d3-112">L'application peut alors parcourir son tableau d'état de paramètre pour découvrir le nombre d'instructions exécutées avec succès, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="db0d3-112">The application can then traverse its parameter status array to discover the number of statements successfully executed, if necessary.</span></span>  
  
## <a name="binding-parameters-for-sql-character-types"></a><span data-ttu-id="db0d3-113">Liaison de paramètres pour les types de caractères SQL</span><span class="sxs-lookup"><span data-stu-id="db0d3-113">Binding Parameters for SQL Character Types</span></span>  
 <span data-ttu-id="db0d3-114">Si le type de données SQL transmis est un type caractère, la valeur de la *colonne column* correspond à la taille en caractères (et non en octets).</span><span class="sxs-lookup"><span data-stu-id="db0d3-114">If the SQL data type passed in is a character type, *ColumnSize* is the size in characters (not bytes).</span></span> <span data-ttu-id="db0d3-115">Si la longueur de la chaîne de données en octets est supérieure à 8000, la valeur de la *colonne column* doit être définie sur `SQL_SS_LENGTH_UNLIMITED` , ce qui indique qu’il n’existe aucune limite à la taille du type SQL.</span><span class="sxs-lookup"><span data-stu-id="db0d3-115">If the length of the data string in bytes is greater than 8000, *ColumnSize* should be set to `SQL_SS_LENGTH_UNLIMITED`, indicating that there is no limit to the size of the SQL type.</span></span>  
  
 <span data-ttu-id="db0d3-116">Par exemple, si le type de données SQL est, la valeur de la `SQL_WVARCHAR` *colonne column* ne doit pas être supérieure à 4000.</span><span class="sxs-lookup"><span data-stu-id="db0d3-116">For instance, if the SQL data type is `SQL_WVARCHAR`, *ColumnSize* should not be greater than 4000.</span></span> <span data-ttu-id="db0d3-117">Si la longueur réelle des données est supérieure à 4000, la valeur de la *colonne column* doit être définie sur afin de pouvoir `SQL_SS_LENGTH_UNLIMITED` `nvarchar(max)` être utilisée par le pilote.</span><span class="sxs-lookup"><span data-stu-id="db0d3-117">If the actual data length is greater than 4000, then *ColumnSize* should be set to `SQL_SS_LENGTH_UNLIMITED` so that `nvarchar(max)` will be used by driver.</span></span>  
  
## <a name="sqlbindparameter-and-table-valued-parameters"></a><span data-ttu-id="db0d3-118">SQLBindParameter et paramètres table</span><span class="sxs-lookup"><span data-stu-id="db0d3-118">SQLBindParameter and Table-Valued Parameters</span></span>  
 <span data-ttu-id="db0d3-119">Comme les autres types de paramètres, les paramètres table sont liés par SQLBindParameter.</span><span class="sxs-lookup"><span data-stu-id="db0d3-119">Like other parameter types, table-valued parameters are bound by SQLBindParameter.</span></span>  
  
 <span data-ttu-id="db0d3-120">Une fois qu'un paramètre table a été lié, ses colonnes sont également liées.</span><span class="sxs-lookup"><span data-stu-id="db0d3-120">After a table-valued parameter has been bound, its columns are also bound.</span></span> <span data-ttu-id="db0d3-121">Pour lier les colonnes, vous appelez [SQLSetStmtAttr](sqlsetstmtattr.md) pour définir SQL_SOPT_SS_PARAM_FOCUS sur l’ordinal du paramètre table.</span><span class="sxs-lookup"><span data-stu-id="db0d3-121">To bind the columns, you call [SQLSetStmtAttr](sqlsetstmtattr.md) to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of the table-valued parameter.</span></span> <span data-ttu-id="db0d3-122">Ensuite, appelez SQLBindParameter pour chaque colonne dans le paramètre table.</span><span class="sxs-lookup"><span data-stu-id="db0d3-122">Then, call SQLBindParameter for each column in the table-valued parameter.</span></span> <span data-ttu-id="db0d3-123">Pour retourner aux liaisons de paramètre de premier niveau, attribuez à SQL_SOPT_SS_PARAM_FOCUS la valeur 0.</span><span class="sxs-lookup"><span data-stu-id="db0d3-123">To return to the top-level parameter bindings, set SQL_SOPT_SS_PARAM_FOCUS to 0.</span></span>  
  
 <span data-ttu-id="db0d3-124">Pour plus d’informations sur le mappage des paramètres aux champs de descripteur pour les paramètres table, consultez [Binding and transfert de données of Table-valued Parameters and Column Values](../native-client-odbc-table-valued-parameters/binding-and-data-transfer-of-table-valued-parameters-and-column-values.md).</span><span class="sxs-lookup"><span data-stu-id="db0d3-124">For information about mapping parameters to descriptor fields for table-valued parameters, see [Binding and Data Transfer of Table-Valued Parameters and Column Values](../native-client-odbc-table-valued-parameters/binding-and-data-transfer-of-table-valued-parameters-and-column-values.md).</span></span>  
  
 <span data-ttu-id="db0d3-125">Pour plus d’informations sur les paramètres table, consultez [paramètres table &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="db0d3-125">For more information about table-valued parameters, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqlbindparameter-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="db0d3-126">Prise en charge de SQLBindParameter pour les fonctionnalités de date et heure améliorées</span><span class="sxs-lookup"><span data-stu-id="db0d3-126">SQLBindParameter Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="db0d3-127">Les valeurs de paramètre de types date/heure sont converties comme décrit dans [conversions de C en SQL](../native-client-odbc-date-time/datetime-data-type-conversions-from-c-to-sql.md).</span><span class="sxs-lookup"><span data-stu-id="db0d3-127">Parameter values of date/time types are converted as described in [Conversions from C to SQL](../native-client-odbc-date-time/datetime-data-type-conversions-from-c-to-sql.md).</span></span> <span data-ttu-id="db0d3-128">Notez que les paramètres de type `time` et `datetimeoffset` doivent avoir un *ValueType* spécifié comme `SQL_C_DEFAULT` ou `SQL_C_BINARY` si leurs structures correspondantes ( `SQL_SS_TIME2_STRUCT` et `SQL_SS_TIMESTAMPOFFSET_STRUCT` ) sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="db0d3-128">Note that parameters of type `time` and `datetimeoffset` must have *ValueType* specified as `SQL_C_DEFAULT` or `SQL_C_BINARY` if their corresponding structures (`SQL_SS_TIME2_STRUCT` and `SQL_SS_TIMESTAMPOFFSET_STRUCT`) are used.</span></span>  
  
 <span data-ttu-id="db0d3-129">Pour plus d’informations, consultez améliorations de la [date et de l’heure &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="db0d3-129">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqlbindparameter-support-for-large-clr-udts"></a><span data-ttu-id="db0d3-130">Prise en charge SQLBindParameter pour les types CLR volumineux définis par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="db0d3-130">SQLBindParameter Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="db0d3-131">`SQLBindParameter` prend en charge les grands types CLR définis par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="db0d3-131">`SQLBindParameter` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="db0d3-132">Pour plus d’informations, consultez [types CLR volumineux définis par l’utilisateur &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="db0d3-132">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="db0d3-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="db0d3-133">See Also</span></span>  
 <span data-ttu-id="db0d3-134">[Détails de l’implémentation de l’API ODBC](odbc-api-implementation-details.md) </span><span class="sxs-lookup"><span data-stu-id="db0d3-134">[ODBC API Implementation Details](odbc-api-implementation-details.md) </span></span>  
 [<span data-ttu-id="db0d3-135">Fonction SQLBindParameter</span><span class="sxs-lookup"><span data-stu-id="db0d3-135">SQLBindParameter Function</span></span>](https://go.microsoft.com/fwlink/?LinkId=59328)  
  
  
