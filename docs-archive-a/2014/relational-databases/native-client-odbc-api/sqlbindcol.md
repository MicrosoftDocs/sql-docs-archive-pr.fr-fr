---
title: SQLBindCol | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLBindCol function
ms.assetid: fbd7ba20-d917-4ca9-b018-018ac6af9f98
author: rothja
ms.author: jroth
ms.openlocfilehash: 72d0ca1b0fbad144117e409019d8d2247bbf918f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709399"
---
# <a name="sqlbindcol"></a><span data-ttu-id="7deea-102">SQLBindCol</span><span class="sxs-lookup"><span data-stu-id="7deea-102">SQLBindCol</span></span>
  <span data-ttu-id="7deea-103">En règle générale, prenez en compte les implications de l’utilisation de **SQLBindCol** pour la conversion de données.</span><span class="sxs-lookup"><span data-stu-id="7deea-103">As a general rule, consider the implications of using **SQLBindCol** to cause data conversion.</span></span> <span data-ttu-id="7deea-104">Les conversions de liaison sont des processus clients. Ainsi, par exemple, l'extraction d'une valeur à virgule flottante liée à une colonne de type character conduit le pilote à effectuer localement la conversion du type de données float en character lorsqu'une ligne est extraite.</span><span class="sxs-lookup"><span data-stu-id="7deea-104">Binding conversions are client processes, so, for example, retrieving a floating-point value bound to a character column causes the driver to perform the float-to-character conversion locally when a row is fetched.</span></span> <span data-ttu-id="7deea-105">La fonction [!INCLUDE[tsql](../../includes/tsql-md.md)] CONVERT peut être utilisée pour reporter le coût de la conversion des données sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="7deea-105">The [!INCLUDE[tsql](../../includes/tsql-md.md)] CONVERT function can be used to place the cost of data conversion on the server.</span></span>  
  
 <span data-ttu-id="7deea-106">Une instance de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peut retourner plusieurs jeux de lignes de résultats à l'issue de l'exécution d'une même instruction.</span><span class="sxs-lookup"><span data-stu-id="7deea-106">An instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] can return multiple sets of result rows on a single statement execution.</span></span> <span data-ttu-id="7deea-107">Chaque jeu de résultats doit être lié séparément.</span><span class="sxs-lookup"><span data-stu-id="7deea-107">Each result set must be bound separately.</span></span> <span data-ttu-id="7deea-108">Pour plus d’informations sur la liaison de plusieurs jeux de résultats, consultez [SQLMoreResults](sqlmoreresults.md).</span><span class="sxs-lookup"><span data-stu-id="7deea-108">For more information about binding for multiple result sets, see [SQLMoreResults](sqlmoreresults.md).</span></span>  
  
 <span data-ttu-id="7deea-109">Le développeur peut lier des colonnes à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] des types de données C spécifiques à à l’aide de la valeur *TargetType* `SQL_C_BINARY` .</span><span class="sxs-lookup"><span data-stu-id="7deea-109">The developer can bind columns to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific C data types using the *TargetType* value `SQL_C_BINARY`.</span></span> <span data-ttu-id="7deea-110">Les colonnes liées à des types propres à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne sont pas portables.</span><span class="sxs-lookup"><span data-stu-id="7deea-110">Columns bound to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific types are not portable.</span></span> <span data-ttu-id="7deea-111">Les types de données ODBC C propres à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] qui sont définis correspondent aux définitions de types de DB-Library. Or les développeurs DB-Library portant des applications souhaiteront peut-être tirer parti de cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="7deea-111">The defined [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific ODBC C data types match the type definitions for DB-Library, and DB-Library developers porting applications may want to take advantage of this feature.</span></span>  
  
 <span data-ttu-id="7deea-112">La création de rapports de troncation des données est un processus coûteux pour le [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pilote ODBC Native Client.</span><span class="sxs-lookup"><span data-stu-id="7deea-112">Reporting data truncation is an expensive process for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="7deea-113">Vous pouvez éviter la troncation en veillant à ce que toutes les mémoires tampons de données liées soient suffisamment grandes pour retourner des données.</span><span class="sxs-lookup"><span data-stu-id="7deea-113">You can avoid truncation by ensuring that all bound data buffers are wide enough to return data.</span></span> <span data-ttu-id="7deea-114">Pour les données de type character, la largeur doit inclure l'espace nécessaire pour un indicateur de fin de chaîne lorsque le comportement par défaut du pilote pour l'indicateur de fin de chaîne est utilisé.</span><span class="sxs-lookup"><span data-stu-id="7deea-114">For character data, the width should include space for a string terminator when the default driver behavior for string termination is used.</span></span> <span data-ttu-id="7deea-115">Par exemple, la liaison d’une colonne de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **type char (5)** à un tableau de cinq caractères entraîne une troncation pour chaque valeur extraite.</span><span class="sxs-lookup"><span data-stu-id="7deea-115">For example, binding a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **char(5)** column to an array of five characters results in truncation for every value fetched.</span></span> <span data-ttu-id="7deea-116">La liaison de la même colonne à un tableau de six caractères évite la troncation en fournissant un élément de type character dans lequel stocker l'indicateur de fin null.</span><span class="sxs-lookup"><span data-stu-id="7deea-116">Binding the same column to an array of six characters avoids the truncation by providing a character element in which to store the null terminator.</span></span> <span data-ttu-id="7deea-117">[SQLGetData](sqlgetdata.md) peut être utilisé pour récupérer efficacement des données binaires et de caractères longs sans troncation.</span><span class="sxs-lookup"><span data-stu-id="7deea-117">[SQLGetData](sqlgetdata.md) can be used to efficiently retrieve long character and binary data without truncation.</span></span>  
  
 <span data-ttu-id="7deea-118">Pour les types de données de valeur élevée, si la mémoire tampon fournie par l’utilisateur n’est pas suffisamment grande pour contenir la valeur entière de la colonne, `SQL_SUCCESS_WITH_INFO` est retournée et les données de chaîne ; la troncation à droite» est émise.</span><span class="sxs-lookup"><span data-stu-id="7deea-118">For large value data types, if the user supplied buffer isn't large enough to hold the entire value of the column, `SQL_SUCCESS_WITH_INFO` is returned and the "string data; right truncation" warning is issued.</span></span> <span data-ttu-id="7deea-119">L'argument `StrLen_or_IndPtr` contient le nombre de chars/octets stockés dans la mémoire tampon.</span><span class="sxs-lookup"><span data-stu-id="7deea-119">The `StrLen_or_IndPtr` argument will contain the number of chars/bytes stored in the buffer.</span></span>  
  
## <a name="sqlbindcol-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="7deea-120">Prise en charge par SQLBindCol des fonctionnalités de date et heure améliorées</span><span class="sxs-lookup"><span data-stu-id="7deea-120">SQLBindCol Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="7deea-121">Les valeurs de colonne de résultats de types date/heure sont converties comme décrit dans [conversions de SQL en C](../native-client-odbc-date-time/datetime-data-type-conversions-from-sql-to-c.md). Notez que pour récupérer des colonnes time et DateTimeOffset en tant que structures correspondantes ( `SQL_SS_TIME2_STRUCT` et **SQL_SS_TIMESTAMPOFFSET_STRUCT**), *TargetType* doit être spécifié en tant que `SQL_C_DEFAULT` ou `SQL_C_BINARY` .</span><span class="sxs-lookup"><span data-stu-id="7deea-121">Result column values of date/time types are converted as described in [Conversions from SQL to C](../native-client-odbc-date-time/datetime-data-type-conversions-from-sql-to-c.md). Note that to retrieve time and datetimeoffset columns as their corresponding structures (`SQL_SS_TIME2_STRUCT` and **SQL_SS_TIMESTAMPOFFSET_STRUCT**), *TargetType* must be specified as `SQL_C_DEFAULT` or `SQL_C_BINARY`.</span></span>  
  
 <span data-ttu-id="7deea-122">Pour plus d’informations, consultez améliorations de la [date et de l’heure &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="7deea-122">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqlbindcol-support-for-large-clr-udts"></a><span data-ttu-id="7deea-123">Prise en charge de SQLBindCol pour les UDT volumineux CLR</span><span class="sxs-lookup"><span data-stu-id="7deea-123">SQLBindCol Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="7deea-124">**SQLBindCol** prend en charge les types CLR volumineux définis par l’utilisateur (UDT).</span><span class="sxs-lookup"><span data-stu-id="7deea-124">**SQLBindCol** supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="7deea-125">Pour plus d’informations, consultez [types CLR volumineux définis par l’utilisateur &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="7deea-125">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7deea-126">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7deea-126">See Also</span></span>  
 <span data-ttu-id="7deea-127">[SQLBindCol, fonction](https://go.microsoft.com/fwlink/?LinkId=59327) </span><span class="sxs-lookup"><span data-stu-id="7deea-127">[SQLBindCol Function](https://go.microsoft.com/fwlink/?LinkId=59327) </span></span>  
 [<span data-ttu-id="7deea-128">Détails de l’implémentation d’API ODBC</span><span class="sxs-lookup"><span data-stu-id="7deea-128">ODBC API Implementation Details</span></span>](odbc-api-implementation-details.md)  
  
  
