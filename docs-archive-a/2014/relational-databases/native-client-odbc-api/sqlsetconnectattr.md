---
title: SQLSetConnectAttr | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLSetConnectAttr function
ms.assetid: d21b5cf1-3724-43f7-bc96-5097df0677b4
author: rothja
ms.author: jroth
ms.openlocfilehash: 716f9d2d27c7e13d754d1cd31f7c7294af3f3f90
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87614011"
---
# <a name="sqlsetconnectattr"></a><span data-ttu-id="3afd9-102">SQLSetConnectAttr</span><span class="sxs-lookup"><span data-stu-id="3afd9-102">SQLSetConnectAttr</span></span>
  <span data-ttu-id="3afd9-103">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ignore le paramètre de SQL_ATTR_CONNECTION_TIMEOUT.</span><span class="sxs-lookup"><span data-stu-id="3afd9-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver ignores the setting of SQL_ATTR_CONNECTION_TIMEOUT.</span></span>  
  
 <span data-ttu-id="3afd9-104">SQL_ATTR_TRANSLATE_LIB est également ignoré ; la spécification d'une autre bibliothèque de traduction n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="3afd9-104">SQL_ATTR_TRANSLATE_LIB is also ignored; specifying another translation library is not supported.</span></span> <span data-ttu-id="3afd9-105">Pour permettre aux applications d'être aisément déplacées pour utiliser un pilote Microsoft ODBC pour [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], toute valeur définie avec SQL_ATTR_TRANSLATE_LIB sera copiée vers et depuis une mémoire tampon dans le gestionnaire de pilotes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-105">To allow applications to easily be ported to use a Microsoft ODBC driver for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], any value set with SQL_ATTR_TRANSLATE_LIB will be copied into and out of a buffer in the Driver Manager.</span></span>  
  
 <span data-ttu-id="3afd9-106">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client implémente l'isolement des transactions de lecture renouvelée comme sérialisable.</span><span class="sxs-lookup"><span data-stu-id="3afd9-106">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver implements repeatable read transaction isolation as serializable.</span></span>  
  
 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] <span data-ttu-id="3afd9-107">a introduit la prise en charge d'un nouvel attribut d'isolation des transactions, SQL_COPT_SS_TXN_ISOLATION.</span><span class="sxs-lookup"><span data-stu-id="3afd9-107">introduced support for a new transaction isolation attribute, SQL_COPT_SS_TXN_ISOLATION.</span></span> <span data-ttu-id="3afd9-108">L'attribution de la valeur SQL_TXN_SS_SNAPSHOT à SQL_COPT_SS_TXN_ISOLATION indique que la transaction aura lieu avec le niveau d'isolement d'instantané.</span><span class="sxs-lookup"><span data-stu-id="3afd9-108">Setting SQL_COPT_SS_TXN_ISOLATION to SQL_TXN_SS_SNAPSHOT indicates that the transaction will take place under the snapshot isolation level.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="3afd9-109">SQL_ATTR_TXN_ISOLATION peut être utilisé pour définir tous les autres niveaux d'isolement à l'exception de SQL_TXN_SS_SNAPSHOT.</span><span class="sxs-lookup"><span data-stu-id="3afd9-109">SQL_ATTR_TXN_ISOLATION can be used to set all other isolation levels except for SQL_TXN_SS_SNAPSHOT.</span></span> <span data-ttu-id="3afd9-110">Si vous souhaitez utiliser le niveau d'isolement d'instantané, vous devez définir SQL_TXN_SS_SNAPSHOT par le biais de SQL_COPT_SS_TXN_ISOLATION.</span><span class="sxs-lookup"><span data-stu-id="3afd9-110">If you want to use snapshot isolation, you must set SQL_TXN_SS_SNAPSHOT through SQL_COPT_SS_TXN_ISOLATION.</span></span> <span data-ttu-id="3afd9-111">Toutefois, vous pouvez récupérer le niveau d'isolement en utilisant SQL_ATTR_TXN_ISOLATION ou SQL_COPT_SS_TXN_ISOLATION.</span><span class="sxs-lookup"><span data-stu-id="3afd9-111">However, you can retrieve the isolation level by using either SQL_ATTR_TXN_ISOLATION or SQL_COPT_SS_TXN_ISOLATION.</span></span>  
  
 <span data-ttu-id="3afd9-112">La promotion des attributs d'instruction ODBC en attributs de connexion peut avoir des conséquences inattendues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-112">Promoting ODBC statement attributes to connection attributes can have unintended consequences.</span></span> <span data-ttu-id="3afd9-113">Les attributs d'instruction qui demandent des curseurs côté serveur pour le traitement du jeu de résultats peuvent être promus pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-113">Statement attributes that request server cursors for result set processing can be promoted to the connection.</span></span> <span data-ttu-id="3afd9-114">Par exemple, affecter à l'attribut d'instruction ODBC SQL_ATTR_CONCURRENCY une valeur plus restrictive que la valeur SQL_CONCUR_READ_ONLY par défaut conduit le pilote à utiliser des curseurs dynamiques pour toutes les instructions soumises sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-114">For example, setting the ODBC statement attribute SQL_ATTR_CONCURRENCY to a value more restrictive than the default SQL_CONCUR_READ_ONLY directs the driver to use dynamic cursors for all statements submitted on the connection.</span></span> <span data-ttu-id="3afd9-115">L'exécution d'une fonction de catalogue ODBC sur une instruction sur la connexion retourne SQL_SUCCESS_WITH_INFO et un enregistrement de diagnostic qui indique que le comportement du curseur a été converti en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="3afd9-115">Executing an ODBC catalog function on a statement on the connection returns SQL_SUCCESS_WITH_INFO and a diagnostic record indicating that the cursor behavior has been changed to read-only.</span></span> <span data-ttu-id="3afd9-116">La tentative d'exécution d'une instruction Transact-SQL SELECT contenant une clause COMPUTE sur la même connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="3afd9-116">Attempting to execute a Transact-SQL SELECT statement containing a COMPUTE clause on the same connection fails.</span></span>  
  
 <span data-ttu-id="3afd9-117">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client prend en charge plusieurs extensions spécifiques au pilote des attributs de connexion ODBC définis dans sqlncli.h.</span><span class="sxs-lookup"><span data-stu-id="3afd9-117">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver supports a number of driver-specific extensions to ODBC connection attributes defined in sqlncli.h.</span></span> <span data-ttu-id="3afd9-118">Le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client peut requérir que l'attribut soit défini avant la connexion, ou il peut ignorer l'attribut si celui-ci est déjà défini.</span><span class="sxs-lookup"><span data-stu-id="3afd9-118">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver may require that the attribute be set prior to connection, or it may ignore the attribute if it is already set.</span></span> <span data-ttu-id="3afd9-119">Le tableau ci-dessous répertorie les restrictions.</span><span class="sxs-lookup"><span data-stu-id="3afd9-119">The following table lists restrictions.</span></span>  
  
|<span data-ttu-id="3afd9-120">Attribut SQL Server</span><span class="sxs-lookup"><span data-stu-id="3afd9-120">SQL Server attribute</span></span>|<span data-ttu-id="3afd9-121">Défini avant ou après la connexion au serveur</span><span class="sxs-lookup"><span data-stu-id="3afd9-121">Set before or after connection to server</span></span>|  
|--------------------------|----------------------------------------------|  
|<span data-ttu-id="3afd9-122">SQL_COPT_SS_ANSI_NPW</span><span class="sxs-lookup"><span data-stu-id="3afd9-122">SQL_COPT_SS_ANSI_NPW</span></span>|<span data-ttu-id="3afd9-123">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-123">Before</span></span>|  
|<span data-ttu-id="3afd9-124">SQL_COPT_SS_APPLICATION_INTENT</span><span class="sxs-lookup"><span data-stu-id="3afd9-124">SQL_COPT_SS_APPLICATION_INTENT</span></span>|<span data-ttu-id="3afd9-125">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-125">Before</span></span>|  
|<span data-ttu-id="3afd9-126">SQL_COPT_SS_ATTACHDBFILENAME</span><span class="sxs-lookup"><span data-stu-id="3afd9-126">SQL_COPT_SS_ATTACHDBFILENAME</span></span>|<span data-ttu-id="3afd9-127">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-127">Before</span></span>|  
|<span data-ttu-id="3afd9-128">SQL_COPT_SS_BCP</span><span class="sxs-lookup"><span data-stu-id="3afd9-128">SQL_COPT_SS_BCP</span></span>|<span data-ttu-id="3afd9-129">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-129">Before</span></span>|  
|<span data-ttu-id="3afd9-130">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="3afd9-130">SQL_COPT_SS_BROWSE_CONNECT</span></span>|<span data-ttu-id="3afd9-131">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-131">Before</span></span>|  
|<span data-ttu-id="3afd9-132">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="3afd9-132">SQL_COPT_SS_BROWSE_SERVER</span></span>|<span data-ttu-id="3afd9-133">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-133">Before</span></span>|  
|<span data-ttu-id="3afd9-134">SQL_COPT_SS_CONCAT_NULL</span><span class="sxs-lookup"><span data-stu-id="3afd9-134">SQL_COPT_SS_CONCAT_NULL</span></span>|<span data-ttu-id="3afd9-135">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-135">Before</span></span>|  
|<span data-ttu-id="3afd9-136">SQL_COPT_SS_CONNECTION_DEAD</span><span class="sxs-lookup"><span data-stu-id="3afd9-136">SQL_COPT_SS_CONNECTION_DEAD</span></span>|<span data-ttu-id="3afd9-137">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-137">After</span></span>|  
|<span data-ttu-id="3afd9-138">SQL_COPT_SS_ENCRYPT</span><span class="sxs-lookup"><span data-stu-id="3afd9-138">SQL_COPT_SS_ENCRYPT</span></span>|<span data-ttu-id="3afd9-139">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-139">Before</span></span>|  
|<span data-ttu-id="3afd9-140">SQL_COPT_SS_ENLIST_IN_DTC</span><span class="sxs-lookup"><span data-stu-id="3afd9-140">SQL_COPT_SS_ENLIST_IN_DTC</span></span>|<span data-ttu-id="3afd9-141">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-141">After</span></span>|  
|<span data-ttu-id="3afd9-142">SQL_COPT_SS_ENLIST_IN_XA</span><span class="sxs-lookup"><span data-stu-id="3afd9-142">SQL_COPT_SS_ENLIST_IN_XA</span></span>|<span data-ttu-id="3afd9-143">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-143">After</span></span>|  
|<span data-ttu-id="3afd9-144">SQL_COPT_SS_FALLBACK_CONNECT</span><span class="sxs-lookup"><span data-stu-id="3afd9-144">SQL_COPT_SS_FALLBACK_CONNECT</span></span>|<span data-ttu-id="3afd9-145">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-145">Before</span></span>|  
|<span data-ttu-id="3afd9-146">SQL_COPT_SS_FAILOVER_PARTNER</span><span class="sxs-lookup"><span data-stu-id="3afd9-146">SQL_COPT_SS_FAILOVER_PARTNER</span></span>|<span data-ttu-id="3afd9-147">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-147">Before</span></span>|  
|<span data-ttu-id="3afd9-148">SQL_COPT_SS_INTEGRATED_SECURITY</span><span class="sxs-lookup"><span data-stu-id="3afd9-148">SQL_COPT_SS_INTEGRATED_SECURITY</span></span>|<span data-ttu-id="3afd9-149">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-149">Before</span></span>|  
|<span data-ttu-id="3afd9-150">SQL_COPT_SS_MARS_ENABLED</span><span class="sxs-lookup"><span data-stu-id="3afd9-150">SQL_COPT_SS_MARS_ENABLED</span></span>|<span data-ttu-id="3afd9-151">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-151">Before</span></span>|  
|<span data-ttu-id="3afd9-152">SQL_COPT_SS_MULTISUBMIT_FAILOVER</span><span class="sxs-lookup"><span data-stu-id="3afd9-152">SQL_COPT_SS_MULTISUBMIT_FAILOVER</span></span>|<span data-ttu-id="3afd9-153">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-153">Before</span></span>|  
|<span data-ttu-id="3afd9-154">SQL_COPT_SS_OLDPWD</span><span class="sxs-lookup"><span data-stu-id="3afd9-154">SQL_COPT_SS_OLDPWD</span></span>|<span data-ttu-id="3afd9-155">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-155">Before</span></span>|  
|<span data-ttu-id="3afd9-156">SQL_COPT_SS_PERF_DATA</span><span class="sxs-lookup"><span data-stu-id="3afd9-156">SQL_COPT_SS_PERF_DATA</span></span>|<span data-ttu-id="3afd9-157">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-157">After</span></span>|  
|<span data-ttu-id="3afd9-158">SQL_COPT_SS_PERF_DATA_LOG</span><span class="sxs-lookup"><span data-stu-id="3afd9-158">SQL_COPT_SS_PERF_DATA_LOG</span></span>|<span data-ttu-id="3afd9-159">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-159">After</span></span>|  
|<span data-ttu-id="3afd9-160">SQL_COPT_SS_PERF_DATA_LOG_NOW</span><span class="sxs-lookup"><span data-stu-id="3afd9-160">SQL_COPT_SS_PERF_DATA_LOG_NOW</span></span>|<span data-ttu-id="3afd9-161">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-161">After</span></span>|  
|<span data-ttu-id="3afd9-162">SQL_COPT_SS_PERF_QUERY</span><span class="sxs-lookup"><span data-stu-id="3afd9-162">SQL_COPT_SS_PERF_QUERY</span></span>|<span data-ttu-id="3afd9-163">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-163">After</span></span>|  
|<span data-ttu-id="3afd9-164">SQL_COPT_SS_PERF_QUERY_INTERVAL</span><span class="sxs-lookup"><span data-stu-id="3afd9-164">SQL_COPT_SS_PERF_QUERY_INTERVAL</span></span>|<span data-ttu-id="3afd9-165">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-165">After</span></span>|  
|<span data-ttu-id="3afd9-166">SQL_COPT_SS_PERF_QUERY_LOG</span><span class="sxs-lookup"><span data-stu-id="3afd9-166">SQL_COPT_SS_PERF_QUERY_LOG</span></span>|<span data-ttu-id="3afd9-167">Après</span><span class="sxs-lookup"><span data-stu-id="3afd9-167">After</span></span>|  
|<span data-ttu-id="3afd9-168">SQL_COPT_SS_PRESERVE_CURSORS</span><span class="sxs-lookup"><span data-stu-id="3afd9-168">SQL_COPT_SS_PRESERVE_CURSORS</span></span>|<span data-ttu-id="3afd9-169">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-169">Before</span></span>|  
|<span data-ttu-id="3afd9-170">SQL_COPT_SS_QUOTED_IDENT</span><span class="sxs-lookup"><span data-stu-id="3afd9-170">SQL_COPT_SS_QUOTED_IDENT</span></span>|<span data-ttu-id="3afd9-171">Vous pouvez soit utiliser</span><span class="sxs-lookup"><span data-stu-id="3afd9-171">Either</span></span>|  
|<span data-ttu-id="3afd9-172">SQL_COPT_SS_TRANSLATE</span><span class="sxs-lookup"><span data-stu-id="3afd9-172">SQL_COPT_SS_TRANSLATE</span></span>|<span data-ttu-id="3afd9-173">Vous pouvez soit utiliser</span><span class="sxs-lookup"><span data-stu-id="3afd9-173">Either</span></span>|  
|<span data-ttu-id="3afd9-174">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE</span><span class="sxs-lookup"><span data-stu-id="3afd9-174">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE</span></span>|<span data-ttu-id="3afd9-175">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-175">Before</span></span>|  
|<span data-ttu-id="3afd9-176">SQL_COPT_SS_TXN_ISOLATION</span><span class="sxs-lookup"><span data-stu-id="3afd9-176">SQL_COPT_SS_TXN_ISOLATION</span></span>|<span data-ttu-id="3afd9-177">Vous pouvez soit utiliser</span><span class="sxs-lookup"><span data-stu-id="3afd9-177">Either</span></span>|  
|<span data-ttu-id="3afd9-178">SQL_COPT_SS_USE_PROC_FOR_PREP</span><span class="sxs-lookup"><span data-stu-id="3afd9-178">SQL_COPT_SS_USE_PROC_FOR_PREP</span></span>|<span data-ttu-id="3afd9-179">Vous pouvez soit utiliser</span><span class="sxs-lookup"><span data-stu-id="3afd9-179">Either</span></span>|  
|<span data-ttu-id="3afd9-180">SQL_COPT_SS_USER_DATA</span><span class="sxs-lookup"><span data-stu-id="3afd9-180">SQL_COPT_SS_USER_DATA</span></span>|<span data-ttu-id="3afd9-181">Vous pouvez soit utiliser</span><span class="sxs-lookup"><span data-stu-id="3afd9-181">Either</span></span>|  
|<span data-ttu-id="3afd9-182">SQL_COPT_SS_WARN_ON_CP_ERROR</span><span class="sxs-lookup"><span data-stu-id="3afd9-182">SQL_COPT_SS_WARN_ON_CP_ERROR</span></span>|<span data-ttu-id="3afd9-183">Avant</span><span class="sxs-lookup"><span data-stu-id="3afd9-183">Before</span></span>|  
  
 <span data-ttu-id="3afd9-184">L'utilisation d'un attribut de préconnexion et la commande [!INCLUDE[tsql](../../includes/tsql-md.md)] équivalente pour la même session, base de données ou état [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] peut produire un comportement inattendu.</span><span class="sxs-lookup"><span data-stu-id="3afd9-184">Using a pre-connection attribute and the equivalent [!INCLUDE[tsql](../../includes/tsql-md.md)] command for the same session, database, or [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] state can produce unexpected behavior.</span></span> <span data-ttu-id="3afd9-185">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="3afd9-185">For example,</span></span>  
  
```  
SQLSetConnectAttr(SQL_COPT_SS_QUOTED_IDENT, SQL_QI_ON) // turn ON via attribute  
SQLDriverConnect(...);  
SQLExecDirect("SET QUOTED_IDENTIFIER OFF") // turn OFF via Transact-SQL  
SQLSetConnectAttr(SQL_ATTR_CURRENT_CATALOG, ...) // restores to pre-connect attribute value  
```  
  
## <a name="sql_copt_ss_ansi_npw"></a><span data-ttu-id="3afd9-186">SQL_COPT_SS_ANSI_NPW</span><span class="sxs-lookup"><span data-stu-id="3afd9-186">SQL_COPT_SS_ANSI_NPW</span></span>  
 <span data-ttu-id="3afd9-187">SQL_COPT_SS_ANSI_NPW active ou désactive l'utilisation de la gestion ISO des valeurs NULL dans les comparaisons et la concaténation, le remplissage des types de données caractère et les avertissements.</span><span class="sxs-lookup"><span data-stu-id="3afd9-187">SQL_COPT_SS_ANSI_NPW enables or disables the use of ISO handling of NULL in comparisons and concatenation, character data type padding, and warnings.</span></span> <span data-ttu-id="3afd9-188">Pour plus d'informations, consultez SET ANSI_NULLS, SET ANSI_PADDING, SET ANSI_WARNINGS et SET CONCAT_NULL_YIELDS_NULL.</span><span class="sxs-lookup"><span data-stu-id="3afd9-188">For more information, see SET ANSI_NULLS, SET ANSI_PADDING, SET ANSI_WARNINGS, and SET CONCAT_NULL_YIELDS_NULL.</span></span>  
  
|<span data-ttu-id="3afd9-189">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-189">Value</span></span>|<span data-ttu-id="3afd9-190">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-190">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-191">SQL_AD_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-191">SQL_AD_ON</span></span>|<span data-ttu-id="3afd9-192">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-192">Default.</span></span> <span data-ttu-id="3afd9-193">La connexion utilise le comportement par défaut ANSI pour gérer les comparaisons NULL, le remplissage, les avertissements et les concaténations NULL.</span><span class="sxs-lookup"><span data-stu-id="3afd9-193">The connection uses ANSI default behavior for handling NULL comparisons, padding, warnings, and NULL concatenations.</span></span>|  
|<span data-ttu-id="3afd9-194">SQL_AD_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-194">SQL_AD_OFF</span></span>|<span data-ttu-id="3afd9-195">La connexion utilise la gestion définie par [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] de NULL, le remplissage des types de données caractère et les avertissements.</span><span class="sxs-lookup"><span data-stu-id="3afd9-195">The connection uses [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-defined handling of NULL, character data type padding, and warnings.</span></span>|  
  
 <span data-ttu-id="3afd9-196">Si vous utilisez le regroupement de connexions, SQL_COPT_SS_ANSI_NPW doit être défini dans la chaîne de connexion, plutôt que avec SQLSetConnectAttr.</span><span class="sxs-lookup"><span data-stu-id="3afd9-196">If you use connection pooling, SQL_COPT_SS_ANSI_NPW should be set in the connection string, rather than with SQLSetConnectAttr.</span></span> <span data-ttu-id="3afd9-197">Après avoir établi une connexion, toute tentative de modification de cet attribut échouera silencieusement lorsque le regroupement de connexions est utilisé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-197">After a connection has been made, any attempt to change this attribute will fail silently when connection pooling is used.</span></span>  
  
## <a name="sql_copt_ss_application_intent"></a><span data-ttu-id="3afd9-198">SQL_COPT_SS_APPLICATION_INTENT</span><span class="sxs-lookup"><span data-stu-id="3afd9-198">SQL_COPT_SS_APPLICATION_INTENT</span></span>  
 <span data-ttu-id="3afd9-199">Déclare le type de la charge de travail de l'application lors de la connexion à un serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-199">Declares the application workload type when connecting to a server.</span></span> <span data-ttu-id="3afd9-200">Les valeurs possibles sont `Readonly` et `ReadWrite`.</span><span class="sxs-lookup"><span data-stu-id="3afd9-200">Possible values are `Readonly` and `ReadWrite`.</span></span> <span data-ttu-id="3afd9-201">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="3afd9-201">For example:</span></span>  
  
```  
SQLSetConnectAttr(hdbc, SQL_COPT_SS_APPLICATION_INTENT, TEXT("Readonly"), SQL_NTS)  
```  
  
 <span data-ttu-id="3afd9-202">Par défaut, il s’agit de `ReadWrite`.</span><span class="sxs-lookup"><span data-stu-id="3afd9-202">The default is `ReadWrite`.</span></span> <span data-ttu-id="3afd9-203">Pour plus d’informations sur [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] la prise en charge de groupes par native client [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] , consultez [SQL Server Native Client la prise en charge de la haute disponibilité et](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="3afd9-203">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client's support for [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] AGs, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
## <a name="sql_copt_ss_attachdbfilename"></a><span data-ttu-id="3afd9-204">SQL_COPT_SS_ATTACHDBFILENAME</span><span class="sxs-lookup"><span data-stu-id="3afd9-204">SQL_COPT_SS_ATTACHDBFILENAME</span></span>  
 <span data-ttu-id="3afd9-205">SQL_COPT_SS_ATTACHDBFILENAME spécifie le nom du fichier primaire d'une base de données pouvant être attachée.</span><span class="sxs-lookup"><span data-stu-id="3afd9-205">SQL_COPT_SS_ATTACHDBFILENAME specifies the name of the primary file of an attachable database.</span></span> <span data-ttu-id="3afd9-206">Cette base de données est attachée et devient la base de données par défaut de la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-206">This database is attached and becomes the default database for the connection.</span></span> <span data-ttu-id="3afd9-207">Pour utiliser SQL_COPT_SS_ATTACHDBFILENAME vous devez spécifier le nom de la base de données comme valeur de l’attribut de connexion SQL_ATTR_CURRENT_CATALOG ou dans le paramètre DATABASE = d’un [SQLDriverConnect](sqldriverconnect.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-207">To use SQL_COPT_SS_ATTACHDBFILENAME you must specify the name of the database as the value of the connection attribute SQL_ATTR_CURRENT_CATALOG or in the DATABASE = parameter of a [SQLDriverConnect](sqldriverconnect.md).</span></span> <span data-ttu-id="3afd9-208">Si la base de données a été attachée précédemment, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ne l'attachera pas de nouveau.</span><span class="sxs-lookup"><span data-stu-id="3afd9-208">If the database was previously attached, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] will not reattach it.</span></span>  
  
|<span data-ttu-id="3afd9-209">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-209">Value</span></span>|<span data-ttu-id="3afd9-210">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-210">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-211">SQLPOINTER vers une chaîne de caractères</span><span class="sxs-lookup"><span data-stu-id="3afd9-211">SQLPOINTER to a character string</span></span>|<span data-ttu-id="3afd9-212">La chaîne contient le nom du fichier primaire de la base de données à attacher.</span><span class="sxs-lookup"><span data-stu-id="3afd9-212">The string contains the name of the primary file for the database to attach.</span></span> <span data-ttu-id="3afd9-213">Incluez le chemin d'accès complet du fichier.</span><span class="sxs-lookup"><span data-stu-id="3afd9-213">Include the full path name of the file.</span></span>|  
  
## <a name="sql_copt_ss_bcp"></a><span data-ttu-id="3afd9-214">SQL_COPT_SS_BCP</span><span class="sxs-lookup"><span data-stu-id="3afd9-214">SQL_COPT_SS_BCP</span></span>  
 <span data-ttu-id="3afd9-215">SQL_COPT_SS_BCP active les fonctions de copie en bloc sur une connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-215">SQL_COPT_SS_BCP enables bulk copy functions on a connection.</span></span> <span data-ttu-id="3afd9-216">Pour plus d’informations, consultez [fonctions de copie en bloc](../native-client-odbc-extensions-bulk-copy-functions/sql-server-driver-extensions-bulk-copy-functions.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-216">For more information, see [Bulk Copy Functions](../native-client-odbc-extensions-bulk-copy-functions/sql-server-driver-extensions-bulk-copy-functions.md).</span></span>  
  
|<span data-ttu-id="3afd9-217">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-217">Value</span></span>|<span data-ttu-id="3afd9-218">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-218">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-219">SQL_BCP_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-219">SQL_BCP_OFF</span></span>|<span data-ttu-id="3afd9-220">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-220">Default.</span></span> <span data-ttu-id="3afd9-221">Les fonctions de copie en bloc ne sont pas disponibles sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-221">Bulk copy functions are not available on the connection.</span></span>|  
|<span data-ttu-id="3afd9-222">SQL_BCP_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-222">SQL_BCP_ON</span></span>|<span data-ttu-id="3afd9-223">Les fonctions de copie en bloc sont disponibles sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-223">Bulk copy functions are available on the connection.</span></span>|  
  
## <a name="sql_copt_ss_browse_connect"></a><span data-ttu-id="3afd9-224">SQL_COPT_SS_BROWSE_CONNECT</span><span class="sxs-lookup"><span data-stu-id="3afd9-224">SQL_COPT_SS_BROWSE_CONNECT</span></span>  
 <span data-ttu-id="3afd9-225">Cet attribut est utilisé pour personnaliser le jeu de résultats retourné par [SQLBrowseConnect](sqlbrowseconnect.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-225">This attribute is used to customize the result set returned by [SQLBrowseConnect](sqlbrowseconnect.md).</span></span> <span data-ttu-id="3afd9-226">SQL_COPT_SS_BROWSE_CONNECT active ou désactive le retour d'informations supplémentaires à partir d'une instance énumérée de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-226">SQL_COPT_SS_BROWSE_CONNECT enables or disables the return of additional information from an enumerated instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3afd9-227">Cela peut inclure des informations, comme par exemple si le serveur est un cluster, les noms d'instances différentes et le numéro de version.</span><span class="sxs-lookup"><span data-stu-id="3afd9-227">This can include information such as whether the server is a cluster, names of different instances, and the version number.</span></span>  
  
|<span data-ttu-id="3afd9-228">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-228">Value</span></span>|<span data-ttu-id="3afd9-229">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-229">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-230">SQL_MORE_INFO_NO</span><span class="sxs-lookup"><span data-stu-id="3afd9-230">SQL_MORE_INFO_NO</span></span>|<span data-ttu-id="3afd9-231">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-231">Default.</span></span> <span data-ttu-id="3afd9-232">Retourne une liste de serveurs.</span><span class="sxs-lookup"><span data-stu-id="3afd9-232">Returns a list of servers.</span></span>|  
|<span data-ttu-id="3afd9-233">SQL_MORE_INFO_YES</span><span class="sxs-lookup"><span data-stu-id="3afd9-233">SQL_MORE_INFO_YES</span></span>|<span data-ttu-id="3afd9-234">**SQLBrowseConnect** retourne une chaîne étendue de propriétés du serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-234">**SQLBrowseConnect** returns an extended string of server properties.</span></span>|  
  
## <a name="sql_copt_ss_browse_server"></a><span data-ttu-id="3afd9-235">SQL_COPT_SS_BROWSE_SERVER</span><span class="sxs-lookup"><span data-stu-id="3afd9-235">SQL_COPT_SS_BROWSE_SERVER</span></span>  
 <span data-ttu-id="3afd9-236">Cet attribut est utilisé pour personnaliser le jeu de résultats retourné par **SQLBrowseConnect**.</span><span class="sxs-lookup"><span data-stu-id="3afd9-236">This attribute is used to customize the result set returned by **SQLBrowseConnect**.</span></span> <span data-ttu-id="3afd9-237">SQL_COPT_SS_BROWSE_SERVER spécifie le nom du serveur pour lequel **SQLBrowseConnect** retourne les informations.</span><span class="sxs-lookup"><span data-stu-id="3afd9-237">SQL_COPT_SS_BROWSE_SERVER specifies the server name for which **SQLBrowseConnect** returns the information.</span></span>  
  
|<span data-ttu-id="3afd9-238">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-238">Value</span></span>|<span data-ttu-id="3afd9-239">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-239">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-240">computername</span><span class="sxs-lookup"><span data-stu-id="3afd9-240">computername</span></span>|<span data-ttu-id="3afd9-241">**SQLBrowseConnect** retourne la liste des instances de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] sur l’ordinateur spécifié.</span><span class="sxs-lookup"><span data-stu-id="3afd9-241">**SQLBrowseConnect** returns a list of instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] on the specified computer.</span></span> <span data-ttu-id="3afd9-242">Les doubles barres obliques inverses ( \\ \\ ) ne doivent pas être utilisées pour le nom du serveur (par exemple, au lieu de \\ \monserveur, monserveur doit être utilisé).</span><span class="sxs-lookup"><span data-stu-id="3afd9-242">Double backslashes (\\\\) should not be used for the server name (for example, instead of \\\MyServer, MyServer should be used).</span></span>|  
|<span data-ttu-id="3afd9-243">NULL</span><span class="sxs-lookup"><span data-stu-id="3afd9-243">NULL</span></span>|<span data-ttu-id="3afd9-244">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-244">Default.</span></span> <span data-ttu-id="3afd9-245">**SQLBrowseConnect** retourne des informations pour tous les serveurs du domaine.</span><span class="sxs-lookup"><span data-stu-id="3afd9-245">**SQLBrowseConnect** returns information for all servers in the domain.</span></span>|  
  
## <a name="sql_copt_ss_concat_null"></a><span data-ttu-id="3afd9-246">SQL_COPT_SS_CONCAT_NULL</span><span class="sxs-lookup"><span data-stu-id="3afd9-246">SQL_COPT_SS_CONCAT_NULL</span></span>  
 <span data-ttu-id="3afd9-247">SQL_COPT_SS_CONCAT_NULL active ou désactive l'utilisation de la gestion ISO des valeurs NULL lors de la concaténation de chaînes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-247">SQL_COPT_SS_CONCAT_NULL enables or disables the use of ISO handling of NULL when concatenating strings.</span></span> <span data-ttu-id="3afd9-248">Pour plus d'informations, consultez SET CONCAT_NULL_YIELDS_NULL.</span><span class="sxs-lookup"><span data-stu-id="3afd9-248">For more information, see SET CONCAT_NULL_YIELDS_NULL.</span></span>  
  
|<span data-ttu-id="3afd9-249">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-249">Value</span></span>|<span data-ttu-id="3afd9-250">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-250">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-251">SQL_CN_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-251">SQL_CN_ON</span></span>|<span data-ttu-id="3afd9-252">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-252">Default.</span></span> <span data-ttu-id="3afd9-253">La connexion utilise le comportement par défaut ISO pour gérer les valeurs NULL lors de la concaténation de chaînes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-253">The connection uses ISO default behavior for handling NULL values when concatenating strings.</span></span>|  
|<span data-ttu-id="3afd9-254">SQL_CN_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-254">SQL_CN_OFF</span></span>|<span data-ttu-id="3afd9-255">La connexion utilise le comportement défini par [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] pour gérer les valeurs NULL lors de la concaténation de chaînes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-255">The connection uses [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-defined behavior for handling NULL values when concatenating strings.</span></span>|  
  
## <a name="sql_copt_ss_encrypt"></a><span data-ttu-id="3afd9-256">SQL_COPT_SS_ENCRYPT</span><span class="sxs-lookup"><span data-stu-id="3afd9-256">SQL_COPT_SS_ENCRYPT</span></span>  
 <span data-ttu-id="3afd9-257">Contrôle le chiffrement pour une connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-257">Controls encryption for a connection.</span></span>  
  
 <span data-ttu-id="3afd9-258">Le chiffrement utilise le certificat sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-258">Encryption uses the certificate on the server.</span></span> <span data-ttu-id="3afd9-259">Cela doit être vérifié par une autorité de certification, à moins que l'attribut de connexion SQL_COPT_SS_TRUST_SERVER_CERTIFICATE ait la valeur SQL_TRUST_SERVER_CERTIFICATE_YES ou que la chaîne de connexion contienne "TrustServerCertificate=yes".</span><span class="sxs-lookup"><span data-stu-id="3afd9-259">This must be verified by a certificate authority, unless the connection attribute SQL_COPT_SS_TRUST_SERVER_CERTIFICATE is set to SQL_TRUST_SERVER_CERTIFICATE_YES or the connection string contains "TrustServerCertificate=yes".</span></span> <span data-ttu-id="3afd9-260">Si l'une ou l'autre de ces conditions est vraie, un certificat généré et signé par le serveur peut être utilisé pour chiffrer la connexion si aucun certificat n'est présent sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-260">If either of these conditions is true, a certificate generated and signed by the server can be used to encrypt the connection if no certificate is on the server.</span></span>  
  
|<span data-ttu-id="3afd9-261">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-261">Value</span></span>|<span data-ttu-id="3afd9-262">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-262">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-263">SQL_EN_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-263">SQL_EN_ON</span></span>|<span data-ttu-id="3afd9-264">La connexion sera chiffrée.</span><span class="sxs-lookup"><span data-stu-id="3afd9-264">The connection will be encrypted.</span></span>|  
|<span data-ttu-id="3afd9-265">SQL_EN_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-265">SQL_EN_OFF</span></span>|<span data-ttu-id="3afd9-266">La connexion ne sera pas chiffrée.</span><span class="sxs-lookup"><span data-stu-id="3afd9-266">The connection will not be encrypted.</span></span> <span data-ttu-id="3afd9-267">Il s'agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-267">This is the default.</span></span>|  
  
## <a name="sql_copt_ss_enlist_in_dtc"></a><span data-ttu-id="3afd9-268">SQL_COPT_SS_ENLIST_IN_DTC</span><span class="sxs-lookup"><span data-stu-id="3afd9-268">SQL_COPT_SS_ENLIST_IN_DTC</span></span>  
 <span data-ttu-id="3afd9-269">Le client appelle la méthode Microsoft Distributed Transaction Coordinator (MS DTC) OLE DB **ITransactionDispenser :: BeginTransaction** pour commencer une transaction MS DTC et créer un objet de transaction MS DTC qui représente la transaction.</span><span class="sxs-lookup"><span data-stu-id="3afd9-269">The client calls the Microsoft Distributed Transaction Coordinator (MS DTC) OLE DB **ITransactionDispenser::BeginTransaction** method to begin an MS DTC transaction and create an MS DTC transaction object that represents the transaction.</span></span> <span data-ttu-id="3afd9-270">L’application appelle ensuite `SQLSetConnectAttr` avec l’option SQL_COPT_SS_ENLIST_IN_DTC pour associer l’objet de transaction à la connexion ODBC.</span><span class="sxs-lookup"><span data-stu-id="3afd9-270">The application then calls `SQLSetConnectAttr` with the SQL_COPT_SS_ENLIST_IN_DTC option to associate the transaction object with the ODBC connection.</span></span> <span data-ttu-id="3afd9-271">Toute l'activité de base de données connexe sera effectuée sous la protection de la transaction MS DTC.</span><span class="sxs-lookup"><span data-stu-id="3afd9-271">All related database activity will be performed under the protection of the MS DTC transaction.</span></span> <span data-ttu-id="3afd9-272">L’application appelle `SQLSetConnectAttr` avec SQL_DTC_DONE pour mettre fin à l’Association DTC de la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-272">The application calls `SQLSetConnectAttr` with SQL_DTC_DONE to end the connection's DTC association.</span></span>  
  
|<span data-ttu-id="3afd9-273">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-273">Value</span></span>|<span data-ttu-id="3afd9-274">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-274">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-275">Objet DTC\*</span><span class="sxs-lookup"><span data-stu-id="3afd9-275">DTC object\*</span></span>|<span data-ttu-id="3afd9-276">Objet de transaction OLE de MS DTC qui spécifie la transaction à exporter vers [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-276">The MS DTC OLE transaction object that specifies the transaction to export to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
|<span data-ttu-id="3afd9-277">SQL_DTC_DONE</span><span class="sxs-lookup"><span data-stu-id="3afd9-277">SQL_DTC_DONE</span></span>|<span data-ttu-id="3afd9-278">Délimite la fin d'une transaction DTC.</span><span class="sxs-lookup"><span data-stu-id="3afd9-278">Delimits the end of a DTC transaction.</span></span>|  
  
## <a name="sql_copt_ss_enlist_in_xa"></a><span data-ttu-id="3afd9-279">SQL_COPT_SS_ENLIST_IN_XA</span><span class="sxs-lookup"><span data-stu-id="3afd9-279">SQL_COPT_SS_ENLIST_IN_XA</span></span>  
 <span data-ttu-id="3afd9-280">Pour commencer une transaction XA avec un processeur de transactions compatible XA (TP), le client appelle la fonction Open Group **tx_begin** .</span><span class="sxs-lookup"><span data-stu-id="3afd9-280">To begin an XA transaction with an XA-compliant Transaction Processor (TP), the client calls the Open Group **tx_begin** function.</span></span> <span data-ttu-id="3afd9-281">L’application appelle ensuite `SQLSetConnectAttr` avec un paramètre SQL_COPT_SS_ENLIST_IN_XA ayant la valeur true pour associer la transaction XA à la connexion ODBC.</span><span class="sxs-lookup"><span data-stu-id="3afd9-281">The application then calls `SQLSetConnectAttr` with a SQL_COPT_SS_ENLIST_IN_XA parameter of TRUE to associate the XA transaction with the ODBC connection.</span></span> <span data-ttu-id="3afd9-282">Toute l'activité de base de données connexe sera effectuée sous la protection de la transaction XA.</span><span class="sxs-lookup"><span data-stu-id="3afd9-282">All related database activity will be performed under the protection of the XA transaction.</span></span> <span data-ttu-id="3afd9-283">Pour mettre fin à une association XA avec une connexion ODBC, le client doit appeler `SQLSetConnectAttr` avec un paramètre SQL_COPT_SS_ENLIST_IN_XA ayant la valeur false.</span><span class="sxs-lookup"><span data-stu-id="3afd9-283">To end an XA association with an ODBC connection, the client must call `SQLSetConnectAttr` with a SQL_COPT_SS_ENLIST_IN_XA parameter of FALSE.</span></span> <span data-ttu-id="3afd9-284">Pour plus d'informations, consultez la documentation sur Microsoft Distributed Transaction Coordinator.</span><span class="sxs-lookup"><span data-stu-id="3afd9-284">For more information, see the Microsoft Distributed Transaction Coordinator documentation.</span></span>  
  
## <a name="sql_copt_ss_fallback_connect"></a><span data-ttu-id="3afd9-285">SQL_COPT_SS_FALLBACK_CONNECT</span><span class="sxs-lookup"><span data-stu-id="3afd9-285">SQL_COPT_SS_FALLBACK_CONNECT</span></span>  
 <span data-ttu-id="3afd9-286">Cet attribut n'est plus pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3afd9-286">This attribute is no longer supported.</span></span>  
  
## <a name="sql_copt_ss_failover_partner"></a><span data-ttu-id="3afd9-287">SQL_COPT_SS_FAILOVER_PARTNER</span><span class="sxs-lookup"><span data-stu-id="3afd9-287">SQL_COPT_SS_FAILOVER_PARTNER</span></span>  
 <span data-ttu-id="3afd9-288">Utilisé pour spécifier ou récupérer le nom du serveur partenaire de basculement utilisé pour la mise en miroir de bases de données dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], et il s'agit d'une chaîne de caractères terminée par le caractère NULL qui doit être définie avant que la connexion à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] soit effectuée initialement.</span><span class="sxs-lookup"><span data-stu-id="3afd9-288">Used to specify or retrieve the name of the failover partner used for database mirroring in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and it is a null terminated character string which must be set before the connection to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is initially made.</span></span>  
  
 <span data-ttu-id="3afd9-289">Après avoir établi la connexion, l’application peut interroger cet attribut à l’aide de [SQLGetConnectAttr](sqlgetconnectattr.md) pour déterminer l’identité du partenaire de basculement.</span><span class="sxs-lookup"><span data-stu-id="3afd9-289">After making the connection, the application can query this attribute using [SQLGetConnectAttr](sqlgetconnectattr.md) to determine the identity of the failover partner.</span></span> <span data-ttu-id="3afd9-290">Si le serveur principal n'a pas de partenaire de basculement, cette propriété retourne une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="3afd9-290">If the primary server has no failover partner this property will return an empty string.</span></span> <span data-ttu-id="3afd9-291">Cela permet à une application intelligente de mettre en cache le serveur de sauvegarde le plus récent ; toutefois, de telles applications doivent prendre en compte le fait que les informations sont mises à jour uniquement lorsque la connexion est établie au préalable, ou réinitialisée en cas de regroupement, et que ces informations peuvent devenir obsolètes dans le cas de connexions à long terme.</span><span class="sxs-lookup"><span data-stu-id="3afd9-291">This allows a smart application to cache the most recently determined backup server, but such applications should be aware that the information is only updated when the connection is first established, or reset, if pooled, and can become out of date for long term connections.</span></span>  
  
 <span data-ttu-id="3afd9-292">Pour plus d’informations, consultez [Utilisation de la mise en miroir de bases de données](../native-client/features/using-database-mirroring.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-292">For more information, see [Using Database Mirroring](../native-client/features/using-database-mirroring.md).</span></span>  
  
## <a name="sql_copt_ss_integrated_security"></a><span data-ttu-id="3afd9-293">SQL_COPT_SS_INTEGRATED_SECURITY</span><span class="sxs-lookup"><span data-stu-id="3afd9-293">SQL_COPT_SS_INTEGRATED_SECURITY</span></span>  
 <span data-ttu-id="3afd9-294">SQL_COPT_SS_INTEGRATED_SECURITY force l'utilisation de l'authentification Windows pour la validation de l'accès sur la connexion au serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-294">SQL_COPT_SS_INTEGRATED_SECURITY forces use of Windows Authentication for access validation on server login.</span></span> <span data-ttu-id="3afd9-295">Lorsque l’authentification Windows est utilisée, le pilote ignore les valeurs d’identificateur et de mot de passe de l’utilisateur fournies dans le cadre du traitement de **SQLConnect**, [SQLDriverConnect](sqldriverconnect.md)ou [SQLBrowseConnect](sqlbrowseconnect.md) .</span><span class="sxs-lookup"><span data-stu-id="3afd9-295">When Windows Authentication is used, the driver ignores user identifier and password values provided as part of **SQLConnect**, [SQLDriverConnect](sqldriverconnect.md), or [SQLBrowseConnect](sqlbrowseconnect.md) processing.</span></span>  
  
|<span data-ttu-id="3afd9-296">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-296">Value</span></span>|<span data-ttu-id="3afd9-297">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-297">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-298">SQL_IS_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-298">SQL_IS_OFF</span></span>|<span data-ttu-id="3afd9-299">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-299">Default.</span></span> <span data-ttu-id="3afd9-300">L'authentification [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est utilisée pour valider l'identificateur d'utilisateur et le mot de passe lors de la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-300">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication is used to validate user identifier and password on login.</span></span>|  
|<span data-ttu-id="3afd9-301">SQL_IS_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-301">SQL_IS_ON</span></span>|<span data-ttu-id="3afd9-302">Le mode d'authentification Windows est utilisé pour valider les droits d'accès d'un utilisateur à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-302">Windows Authentication Mode is used to validate a user's access rights to the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span>|  
  
## <a name="sql_copt_ss_mars_enabled"></a><span data-ttu-id="3afd9-303">SQL_COPT_SS_MARS_ENABLED</span><span class="sxs-lookup"><span data-stu-id="3afd9-303">SQL_COPT_SS_MARS_ENABLED</span></span>  
 <span data-ttu-id="3afd9-304">Cet attribut active ou désactive MARS (Multiple Active Result Sets).</span><span class="sxs-lookup"><span data-stu-id="3afd9-304">This attribute enables or disables Multiple Active Result Sets (MARS).</span></span> <span data-ttu-id="3afd9-305">MARS est désactivé par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-305">By default, MARS is disabled.</span></span> <span data-ttu-id="3afd9-306">Cet attribut doit être défini avant l'établissement d'une connexion à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-306">This attribute should be set before making a connection to [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="3afd9-307">Une fois que la connexion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] est ouverte, MARS reste activé ou désactivé durant toute la durée de vie de la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-307">Once the connection [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] is opened, MARS will remain enabled or disabled for the life of the connection.</span></span>  
  
|<span data-ttu-id="3afd9-308">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-308">Value</span></span>|<span data-ttu-id="3afd9-309">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-309">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-310">SQL_MARS_ENABLED_NO</span><span class="sxs-lookup"><span data-stu-id="3afd9-310">SQL_MARS_ENABLED_NO</span></span>|<span data-ttu-id="3afd9-311">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-311">Default.</span></span> <span data-ttu-id="3afd9-312">MARS (Multiple Active Result Sets) est désactivé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-312">Multiple Active Result Sets (MARS) is disabled.</span></span>|  
|<span data-ttu-id="3afd9-313">SQL_MARS_ENABLED_YES</span><span class="sxs-lookup"><span data-stu-id="3afd9-313">SQL_MARS_ENABLED_YES</span></span>|<span data-ttu-id="3afd9-314">MARS est activé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-314">MARS is enabled.</span></span>|  
  
 <span data-ttu-id="3afd9-315">Pour plus d’informations sur MARS, consultez [utilisation de plusieurs jeux de résultats actifs &#40;&#41;mars ](../native-client/features/using-multiple-active-result-sets-mars.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-315">For more information about MARS, see [Using Multiple Active Result Sets &#40;MARS&#41;](../native-client/features/using-multiple-active-result-sets-mars.md).</span></span>  
  
## <a name="sql_copt_ss_multisubnet_failover"></a><span data-ttu-id="3afd9-316">SQL_COPT_SS_MULTISUBNET_FAILOVER</span><span class="sxs-lookup"><span data-stu-id="3afd9-316">SQL_COPT_SS_MULTISUBNET_FAILOVER</span></span>  
 <span data-ttu-id="3afd9-317">Si votre application se connecte à un groupe de disponibilité [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] sur des sous-réseaux différents, cette propriété de connexion configure [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client afin de permettre une détection plus rapide du serveur (actuellement) actif et la connexion à ce dernier.</span><span class="sxs-lookup"><span data-stu-id="3afd9-317">If your application is connecting to a [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] availability group (AG) on different subnets, this connection property configures [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client to provide faster detection of and connection to the (currently) active server.</span></span> <span data-ttu-id="3afd9-318">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="3afd9-318">For example:</span></span>  
  
```  
SQLSetConnectAttr(hdbc, SQL_COPT_SS_MULTISUBMIT_FAILOVER, SQL_IS_ON, SQL_IS_INTEGER)  
```  
  
 <span data-ttu-id="3afd9-319">Pour plus d’informations sur [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] la prise en charge de groupes par native client [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] , consultez [SQL Server Native Client la prise en charge de la haute disponibilité et](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md)de la récupération d’urgence.</span><span class="sxs-lookup"><span data-stu-id="3afd9-319">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client's support for [!INCLUDE[ssHADR](../../includes/sshadr-md.md)] AGs, see [SQL Server Native Client Support for High Availability, Disaster Recovery](../native-client/features/sql-server-native-client-support-for-high-availability-disaster-recovery.md).</span></span>  
  
|<span data-ttu-id="3afd9-320">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-320">Value</span></span>|<span data-ttu-id="3afd9-321">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-321">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-322">SQL_IS_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-322">SQL_IS_ON</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="3afd9-323">Native Client permet une reconnexion plus rapide en cas de basculement.</span><span class="sxs-lookup"><span data-stu-id="3afd9-323">Native Client provides faster reconnection if there is a failover.</span></span>|  
|<span data-ttu-id="3afd9-324">SQL_IS_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-324">SQL_IS_OFF</span></span>|[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] <span data-ttu-id="3afd9-325">Native Client ne permet pas une reconnexion plus rapide en cas de basculement.</span><span class="sxs-lookup"><span data-stu-id="3afd9-325">Native Client will not provide faster reconnection if there is a failover.</span></span>|  
  
## <a name="sql_copt_ss_oldpwd"></a><span data-ttu-id="3afd9-326">SQL_COPT_SS_OLDPWD</span><span class="sxs-lookup"><span data-stu-id="3afd9-326">SQL_COPT_SS_OLDPWD</span></span>  
 <span data-ttu-id="3afd9-327">L'expiration du mot de passe pour l'authentification SQL Server a été introduite dans [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-327">Password expiration for SQL Server Authentication was introduced in [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="3afd9-328">L'attribut SQL_COPT_SS_OLDPWD a été ajouté pour permettre au client de fournir à la fois l'ancien et le nouveau mots de passe pour la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-328">The SQL_COPT_SS_OLDPWD attribute has been added to allow the client to provide both the old and the new password for the connection.</span></span> <span data-ttu-id="3afd9-329">Lorsque cette propriété est définie, le fournisseur n'utilisera pas le pool de connexions pour la première connexion ou pour les connexions suivantes, puisque la chaîne de connexion contiendra l'« ancien mot de passe » qui a maintenant changé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-329">When this property is set, the provider will not use the connection pool for the first connection or for subsequent connections, since the connection string will contain the "old password" which has now changed.</span></span>  
  
 <span data-ttu-id="3afd9-330">Pour plus d’informations, consultez [Modification des mots de passe par programme](../native-client/features/changing-passwords-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-330">For more information, see [Changing Passwords Programmatically](../native-client/features/changing-passwords-programmatically.md).</span></span>  
  
|<span data-ttu-id="3afd9-331">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-331">Value</span></span>|<span data-ttu-id="3afd9-332">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-332">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-333">SQL_COPT_SS_OLD_PASSWORD</span><span class="sxs-lookup"><span data-stu-id="3afd9-333">SQL_COPT_SS_OLD_PASSWORD</span></span>|<span data-ttu-id="3afd9-334">SQLPOINTER vers une chaîne de caractères contenant l'ancien mot de passe.</span><span class="sxs-lookup"><span data-stu-id="3afd9-334">SQLPOINTER to a character string containing the old password.</span></span> <span data-ttu-id="3afd9-335">Cette valeur est en écriture seule et doit être définie avant la connexion au serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-335">This value is write-only, and must be set before connection to the server.</span></span>|  
  
## <a name="sql_copt_ss_perf_data"></a><span data-ttu-id="3afd9-336">SQL_COPT_SS_PERF_DATA</span><span class="sxs-lookup"><span data-stu-id="3afd9-336">SQL_COPT_SS_PERF_DATA</span></span>  
 <span data-ttu-id="3afd9-337">SQL_COPT_SS_PERF_DATA lance ou arrête la journalisation des données de performances.</span><span class="sxs-lookup"><span data-stu-id="3afd9-337">SQL_COPT_SS_PERF_DATA starts or stops performance data logging.</span></span> <span data-ttu-id="3afd9-338">Il convient de définir le nom du fichier journal des données avant de commencer la journalisation des données.</span><span class="sxs-lookup"><span data-stu-id="3afd9-338">The data log file name must be set prior to starting data logging.</span></span> <span data-ttu-id="3afd9-339">Consultez SQL_COPT_SS_PERF_DATA_LOG ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="3afd9-339">See SQL_COPT_SS_PERF_DATA_LOG below.</span></span>  
  
|<span data-ttu-id="3afd9-340">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-340">Value</span></span>|<span data-ttu-id="3afd9-341">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-341">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-342">SQL_PERF_START</span><span class="sxs-lookup"><span data-stu-id="3afd9-342">SQL_PERF_START</span></span>|<span data-ttu-id="3afd9-343">Démarre le pilote qui échantillonne les données de performances.</span><span class="sxs-lookup"><span data-stu-id="3afd9-343">Starts the driver sampling performance data.</span></span>|  
|<span data-ttu-id="3afd9-344">SQL_PERF_STOP</span><span class="sxs-lookup"><span data-stu-id="3afd9-344">SQL_PERF_STOP</span></span>|<span data-ttu-id="3afd9-345">Arrête les compteurs d'échantillonnage des données de performances.</span><span class="sxs-lookup"><span data-stu-id="3afd9-345">Stops the counters from sampling performance data.</span></span>|  
  
 <span data-ttu-id="3afd9-346">Pour plus d’informations, consultez [SQLGetConnectAttr](sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-346">For more information, see [SQLGetConnectAttr](sqlgetconnectattr.md).</span></span>  
  
## <a name="sql_copt_ss_perf_data_log"></a><span data-ttu-id="3afd9-347">SQL_COPT_SS_PERF_DATA_LOG</span><span class="sxs-lookup"><span data-stu-id="3afd9-347">SQL_COPT_SS_PERF_DATA_LOG</span></span>  
 <span data-ttu-id="3afd9-348">SQL_COPT_SS_PERF_DATA_LOG attribue le nom du fichier journal utilisé pour enregistrer les données de performances.</span><span class="sxs-lookup"><span data-stu-id="3afd9-348">SQL_COPT_SS_PERF_DATA_LOG assigns the name of the log file used to record performance data.</span></span> <span data-ttu-id="3afd9-349">Le nom du fichier journal est une chaîne ANSI ou Unicode terminée par le caractère Null qui dépend de la compilation de l'application.</span><span class="sxs-lookup"><span data-stu-id="3afd9-349">The log file name is an ANSI or Unicode, null-terminated string depending upon application compilation.</span></span> <span data-ttu-id="3afd9-350">L’argument *StringLength* doit être SQL_NTS.</span><span class="sxs-lookup"><span data-stu-id="3afd9-350">The *StringLength* argument should be SQL_NTS.</span></span>  
  
## <a name="sql_copt_ss_perf_data_log_now"></a><span data-ttu-id="3afd9-351">SQL_COPT_SS_PERF_DATA_LOG_NOW</span><span class="sxs-lookup"><span data-stu-id="3afd9-351">SQL_COPT_SS_PERF_DATA_LOG_NOW</span></span>  
 <span data-ttu-id="3afd9-352">SQL_COPT_SS_PERF_DATA_LOG_NOW indique au pilote d'écrire une entrée de journal de statistiques sur le disque.</span><span class="sxs-lookup"><span data-stu-id="3afd9-352">SQL_COPT_SS_PERF_DATA_LOG_NOW instructs the driver to write a statistics log entry to disk.</span></span> <span data-ttu-id="3afd9-353">L’argument *StringLength* doit être SQL_NTS.</span><span class="sxs-lookup"><span data-stu-id="3afd9-353">The *StringLength* argument should be SQL_NTS.</span></span>  
  
## <a name="sql_copt_ss_perf_query"></a><span data-ttu-id="3afd9-354">SQL_COPT_SS_PERF_QUERY</span><span class="sxs-lookup"><span data-stu-id="3afd9-354">SQL_COPT_SS_PERF_QUERY</span></span>  
 <span data-ttu-id="3afd9-355">SQL_COPT_SS_PERF_QUERY démarre ou arrête la journalisation pour les requêtes longues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-355">SQL_COPT_SS_PERF_QUERY starts or stops logging for long running queries.</span></span> <span data-ttu-id="3afd9-356">Il convient de fournir le nom du fichier journal des requêtes avant de commencer la journalisation.</span><span class="sxs-lookup"><span data-stu-id="3afd9-356">The query log file name must be supplied prior to starting logging.</span></span> <span data-ttu-id="3afd9-357">L'application peut définir "longues" en définissant l'intervalle pour la journalisation.</span><span class="sxs-lookup"><span data-stu-id="3afd9-357">The application can define "long running" by setting the interval for logging.</span></span>  
  
|<span data-ttu-id="3afd9-358">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-358">Value</span></span>|<span data-ttu-id="3afd9-359">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-359">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-360">SQL_PERF_START</span><span class="sxs-lookup"><span data-stu-id="3afd9-360">SQL_PERF_START</span></span>|<span data-ttu-id="3afd9-361">Démarre la journalisation des requêtes longues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-361">Starts long running query logging.</span></span>|  
|<span data-ttu-id="3afd9-362">SQL_PERF_STOP</span><span class="sxs-lookup"><span data-stu-id="3afd9-362">SQL_PERF_STOP</span></span>|<span data-ttu-id="3afd9-363">Arrête la journalisation des requêtes longues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-363">Stops logging of long running queries.</span></span>|  
  
 <span data-ttu-id="3afd9-364">Pour plus d’informations, consultez [SQLGetConnectAttr](sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-364">For more information, see [SQLGetConnectAttr](sqlgetconnectattr.md).</span></span>  
  
## <a name="sql_copt_ss_perf_query_interval"></a><span data-ttu-id="3afd9-365">SQL_COPT_SS_PERF_QUERY_INTERVAL</span><span class="sxs-lookup"><span data-stu-id="3afd9-365">SQL_COPT_SS_PERF_QUERY_INTERVAL</span></span>  
 <span data-ttu-id="3afd9-366">SQL_COPT_SS_PERF_QUERY_INTERVAL définit le seuil de journalisation des requêtes en millisecondes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-366">SQL_COPT_SS_PERF_QUERY_INTERVAL sets the query logging threshold in milliseconds.</span></span> <span data-ttu-id="3afd9-367">Les requêtes qui ne sont pas résolues dans cette limite sont enregistrées dans le fichier journal des requêtes longues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-367">Queries that do not resolve within the threshold are recorded in the long running query log file.</span></span> <span data-ttu-id="3afd9-368">Le seuil de requête ne présente pas de limite supérieure.</span><span class="sxs-lookup"><span data-stu-id="3afd9-368">There is no upper limit on the query threshold.</span></span> <span data-ttu-id="3afd9-369">Une valeur de seuil de requête égale à zéro entraîne la consignation de toutes les requêtes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-369">A query threshold value of zero causes logging of all queries.</span></span>  
  
## <a name="sql_copt_ss_perf_query_log"></a><span data-ttu-id="3afd9-370">SQL_COPT_SS_PERF_QUERY_LOG</span><span class="sxs-lookup"><span data-stu-id="3afd9-370">SQL_COPT_SS_PERF_QUERY_LOG</span></span>  
 <span data-ttu-id="3afd9-371">SQL_COPT_SS_PERF_QUERY_LOG attribue le nom d'un fichier journal pour la journalisation des données des requêtes longues.</span><span class="sxs-lookup"><span data-stu-id="3afd9-371">SQL_COPT_SS_PERF_QUERY_LOG assigns the name of a log file for recording long running query data.</span></span> <span data-ttu-id="3afd9-372">Le nom du fichier journal est une chaîne ANSI ou Unicode terminée par le caractère Null qui dépend de la compilation de l'application.</span><span class="sxs-lookup"><span data-stu-id="3afd9-372">The log file name is an ANSI or Unicode, null-terminated string depending upon application compilation.</span></span> <span data-ttu-id="3afd9-373">L’argument *StringLength* doit être SQL_NTS ou la longueur de la chaîne en octets.</span><span class="sxs-lookup"><span data-stu-id="3afd9-373">The *StringLength* argument should be SQL_NTS or the length of the string in bytes.</span></span>  
  
## <a name="sql_copt_ss_preserve_cursors"></a><span data-ttu-id="3afd9-374">SQL_COPT_SS_PRESERVE_CURSORS</span><span class="sxs-lookup"><span data-stu-id="3afd9-374">SQL_COPT_SS_PRESERVE_CURSORS</span></span>  
 <span data-ttu-id="3afd9-375">Cet attribut vous permet d'interroger et de définir si la connexion conservera ou non le ou les curseurs lorsque vous validez/annulez une transaction.</span><span class="sxs-lookup"><span data-stu-id="3afd9-375">This attribute allows you to query and set whether or not the connection will preserve the cursor(s) when you commit/rollback a transaction.</span></span> <span data-ttu-id="3afd9-376">Le paramètre est SQL_PC_ON ou SQL_PC_OFF.</span><span class="sxs-lookup"><span data-stu-id="3afd9-376">The setting is either SQL_PC_ON or SQL_PC_OFF.</span></span> <span data-ttu-id="3afd9-377">La valeur par défaut est SQL_PC_OFF.</span><span class="sxs-lookup"><span data-stu-id="3afd9-377">The default value is SQL_PC_OFF.</span></span> <span data-ttu-id="3afd9-378">Ce paramètre contrôle si le pilote doit fermer le ou les curseurs lorsque vous appelez [SQLEndTran](sqlendtran.md) (ou SQLTransact).</span><span class="sxs-lookup"><span data-stu-id="3afd9-378">This setting controls whether or not the driver will close the cursor(s) for you when you call [SQLEndTran](sqlendtran.md) (or SQLTransact).</span></span>  
  
|<span data-ttu-id="3afd9-379">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-379">Value</span></span>|<span data-ttu-id="3afd9-380">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-380">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-381">SQL_PC_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-381">SQL_PC_OFF</span></span>|<span data-ttu-id="3afd9-382">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-382">Default.</span></span> <span data-ttu-id="3afd9-383">Les curseurs sont fermés lorsque la transaction est validée ou restaurée à l’aide de **SQLEndTran**.</span><span class="sxs-lookup"><span data-stu-id="3afd9-383">Cursors are closed when transaction is committed or rolled back using **SQLEndTran**.</span></span>|  
|<span data-ttu-id="3afd9-384">SQL_PC_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-384">SQL_PC_ON</span></span>|<span data-ttu-id="3afd9-385">Les curseurs ne sont pas fermés lorsque la transaction est validée ou restaurée à l’aide de **SQLEndTran**, sauf en cas d’utilisation d’un curseur statique ou de jeu de clés en mode asynchrone.</span><span class="sxs-lookup"><span data-stu-id="3afd9-385">Cursors are not closed when transaction is committed or rolled back using **SQLEndTran**, except when using a static or keyset cursor in asynchronous mode.</span></span> <span data-ttu-id="3afd9-386">Si une annulation est effectuée alors que le remplissage du curseur n'est pas complet, le curseur est fermé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-386">If a rollback is issued while the population of the cursor is not complete, the cursor is closed.</span></span>|  
  
## <a name="sql_copt_ss_quoted_ident"></a><span data-ttu-id="3afd9-387">SQL_COPT_SS_QUOTED_IDENT</span><span class="sxs-lookup"><span data-stu-id="3afd9-387">SQL_COPT_SS_QUOTED_IDENT</span></span>  
 <span data-ttu-id="3afd9-388">SQL_COPT_SS_QUOTED_IDENT autorise les identificateurs entre guillemets dans les instructions ODBC et Transact-SQL soumises sur la connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-388">SQL_COPT_SS_QUOTED_IDENT allows quoted identifiers in ODBC and Transact-SQL statements submitted on the connection.</span></span> <span data-ttu-id="3afd9-389">En fournissant des identificateurs entre guillemets, le pilote ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client autorise des noms d'objets qui seraient autrement non valides, tels que "My Table", qui contient un espace.</span><span class="sxs-lookup"><span data-stu-id="3afd9-389">By supplying quoted identifiers, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver allows otherwise invalid object names such as "My Table", which contains a space character in the identifier.</span></span> <span data-ttu-id="3afd9-390">Pour plus d'informations, consultez SET QUOTED_IDENTIFIER.</span><span class="sxs-lookup"><span data-stu-id="3afd9-390">For more information, see SET QUOTED_IDENTIFIER.</span></span>  
  
|<span data-ttu-id="3afd9-391">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-391">Value</span></span>|<span data-ttu-id="3afd9-392">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-392">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-393">SQL_QI_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-393">SQL_QI_OFF</span></span>|<span data-ttu-id="3afd9-394">La connexion [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] n'autorise pas les identificateurs entre guillemets dans les instructions [!INCLUDE[tsql](../../includes/tsql-md.md)] soumises.</span><span class="sxs-lookup"><span data-stu-id="3afd9-394">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] connection does not allow quoted identifiers in submitted [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span>|  
|<span data-ttu-id="3afd9-395">SQL_QI_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-395">SQL_QI_ON</span></span>|<span data-ttu-id="3afd9-396">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-396">Default.</span></span> <span data-ttu-id="3afd9-397">La connexion autorise les identificateurs entre guillemets dans les instructions [!INCLUDE[tsql](../../includes/tsql-md.md)] soumises.</span><span class="sxs-lookup"><span data-stu-id="3afd9-397">The connection allows quoted identifiers in submitted [!INCLUDE[tsql](../../includes/tsql-md.md)].</span></span>|  
  
## <a name="sql_copt_ss_translate"></a><span data-ttu-id="3afd9-398">SQL_COPT_SS_TRANSLATE</span><span class="sxs-lookup"><span data-stu-id="3afd9-398">SQL_COPT_SS_TRANSLATE</span></span>  
 <span data-ttu-id="3afd9-399">SQL_COPT_SS_TRANSLATE conduit le pilote à traduire les caractères entre les pages de codes client et serveur lorsque des données MBCS sont échangées.</span><span class="sxs-lookup"><span data-stu-id="3afd9-399">SQL_COPT_SS_TRANSLATE causes the driver to translate characters between the client and server code pages as MBCS data is exchanged.</span></span> <span data-ttu-id="3afd9-400">L’attribut affecte uniquement les données stockées dans les [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] colonnes **char**, **varchar**et **Text** .</span><span class="sxs-lookup"><span data-stu-id="3afd9-400">The attribute affects only data stored in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]**char**, **varchar**, and **text** columns.</span></span>  
  
|<span data-ttu-id="3afd9-401">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-401">Value</span></span>|<span data-ttu-id="3afd9-402">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-402">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-403">SQL_XL_OFF</span><span class="sxs-lookup"><span data-stu-id="3afd9-403">SQL_XL_OFF</span></span>|<span data-ttu-id="3afd9-404">Le pilote ne traduit pas les caractères d'une page de codes à une autre dans les données de type caractère échangées entre le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-404">The driver does not translate characters from one code page to another in character data exchanged between the client and the server.</span></span>|  
|<span data-ttu-id="3afd9-405">SQL_XL_ON</span><span class="sxs-lookup"><span data-stu-id="3afd9-405">SQL_XL_ON</span></span>|<span data-ttu-id="3afd9-406">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-406">Default.</span></span> <span data-ttu-id="3afd9-407">Le pilote traduit les caractères d'une page de codes à une autre dans les données de type caractère échangées entre le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-407">The driver translates characters from one code page to another in character data exchanged between the client and the server.</span></span> <span data-ttu-id="3afd9-408">Le pilote configure automatiquement la traduction du caractère, déterminant la page de codes installée sur le serveur et celle utilisée par le client.</span><span class="sxs-lookup"><span data-stu-id="3afd9-408">The driver automatically configures the character translation, determining the code page installed on the server and that in use by the client.</span></span>|  
  
## <a name="sql_copt_ss_trust_server_certificate"></a><span data-ttu-id="3afd9-409">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE</span><span class="sxs-lookup"><span data-stu-id="3afd9-409">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE</span></span>  
 <span data-ttu-id="3afd9-410">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE conduit le pilote à activer ou désactiver la validation de certificat lors de l'utilisation du chiffrement.</span><span class="sxs-lookup"><span data-stu-id="3afd9-410">SQL_COPT_SS_TRUST_SERVER_CERTIFICATE causes the driver to enable or disable certificate validation when using encryption.</span></span> <span data-ttu-id="3afd9-411">Cet attribut est une valeur en lecture/écriture, mais le définir après l'établissement d'une connexion n'a aucun effet.</span><span class="sxs-lookup"><span data-stu-id="3afd9-411">This attribute is a read/write value, but setting it after a connection has been established has no effect.</span></span>  
  
 <span data-ttu-id="3afd9-412">Les applications clientes peuvent interroger cette propriété après qu'une connexion a été ouverte pour déterminer le chiffrement effectif et les paramètres de validation utilisés.</span><span class="sxs-lookup"><span data-stu-id="3afd9-412">Client applications can query this property after a connection has been opened to determine the actual encryption and validation settings in use.</span></span>  
  
|<span data-ttu-id="3afd9-413">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-413">Value</span></span>|<span data-ttu-id="3afd9-414">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-414">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-415">SQL_TRUST_SERVER_CERTIFICATE_NO</span><span class="sxs-lookup"><span data-stu-id="3afd9-415">SQL_TRUST_SERVER_CERTIFICATE_NO</span></span>|<span data-ttu-id="3afd9-416">Par défaut.</span><span class="sxs-lookup"><span data-stu-id="3afd9-416">Default.</span></span> <span data-ttu-id="3afd9-417">Le chiffrement sans validation de certificat n'est pas activé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-417">Encryption without certificate validation is not enabled.</span></span>|  
|<span data-ttu-id="3afd9-418">SQL_TRUST_SERVER_CERTIFICATE_YES</span><span class="sxs-lookup"><span data-stu-id="3afd9-418">SQL_TRUST_SERVER_CERTIFICATE_YES</span></span>|<span data-ttu-id="3afd9-419">Le chiffrement sans validation de certificat est activé.</span><span class="sxs-lookup"><span data-stu-id="3afd9-419">Encryption without certificate validation is enabled.</span></span>|  
  
## <a name="sql_copt_ss_txn_isolation"></a><span data-ttu-id="3afd9-420">SQL_COPT_SS_TXN_ISOLATION</span><span class="sxs-lookup"><span data-stu-id="3afd9-420">SQL_COPT_SS_TXN_ISOLATION</span></span>  
 <span data-ttu-id="3afd9-421">SQL_COPT_SS_TXN_ISOLATION définit l'attribut du niveau d'isolement d'instantané spécifique à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-421">SQL_COPT_SS_TXN_ISOLATION sets the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specific snapshot isolation attribute.</span></span> <span data-ttu-id="3afd9-422">Le niveau d'isolement d'instantané ne peut pas être défini à l'aide de SQL_ATTR_TXN_ISOLATION car la valeur est spécifique à [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3afd9-422">Snapshot isolation cannot be set using SQL_ATTR_TXN_ISOLATION because the value is [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] specific.</span></span> <span data-ttu-id="3afd9-423">Toutefois, elle peut être extraite à l'aide de SQL_ATTR_TXN_ISOLATION ou de SQL_COPT_SS_TXN_ISOLATION.</span><span class="sxs-lookup"><span data-stu-id="3afd9-423">However, it can be retrieved using either SQL_ATTR_TXN_ISOLATION or SQL_COPT_SS_TXN_ISOLATION.</span></span>  
  
|<span data-ttu-id="3afd9-424">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-424">Value</span></span>|<span data-ttu-id="3afd9-425">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-425">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-426">SQL_TXN_SS_SNAPSHOT</span><span class="sxs-lookup"><span data-stu-id="3afd9-426">SQL_TXN_SS_SNAPSHOT</span></span>|<span data-ttu-id="3afd9-427">Indique qu'il n'est pas possible de voir à partir d'une transaction les modifications apportées dans d'autres transactions, et cela même si vous réexécutez la requête.</span><span class="sxs-lookup"><span data-stu-id="3afd9-427">Indicates that from one transaction you cannot see changes made in other transactions and that you cannot see changes even when requerying.</span></span>|  
  
 <span data-ttu-id="3afd9-428">Pour plus d’informations sur l’isolation d’instantané, consultez [utilisation de l’isolation d’instantané](../native-client/features/working-with-snapshot-isolation.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-428">For more information about snapshot isolation, see [Working with Snapshot Isolation](../native-client/features/working-with-snapshot-isolation.md).</span></span>  
  
## <a name="sql_copt_ss_use_proc_for_prep"></a><span data-ttu-id="3afd9-429">SQL_COPT_SS_USE_PROC_FOR_PREP</span><span class="sxs-lookup"><span data-stu-id="3afd9-429">SQL_COPT_SS_USE_PROC_FOR_PREP</span></span>  
 <span data-ttu-id="3afd9-430">Cet attribut n'est plus pris en charge.</span><span class="sxs-lookup"><span data-stu-id="3afd9-430">This attribute is no longer supported.</span></span>  
  
## <a name="sql_copt_ss_user_data"></a><span data-ttu-id="3afd9-431">SQL_COPT_SS_USER_DATA</span><span class="sxs-lookup"><span data-stu-id="3afd9-431">SQL_COPT_SS_USER_DATA</span></span>  
 <span data-ttu-id="3afd9-432">SQL_COPT_SS_USER_DATA définit le pointeur de données utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-432">SQL_COPT_SS_USER_DATA sets the user data pointer.</span></span> <span data-ttu-id="3afd9-433">Les données utilisateur correspondent à la mémoire détenue par le client et enregistrée par connexion.</span><span class="sxs-lookup"><span data-stu-id="3afd9-433">User data is client-owned memory recorded per connection.</span></span>  
  
 <span data-ttu-id="3afd9-434">Pour plus d’informations, consultez [SQLGetConnectAttr](sqlgetconnectattr.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-434">For more information, see [SQLGetConnectAttr](sqlgetconnectattr.md).</span></span>  
  
## <a name="sql_copt_ss_warn_on_cp_error"></a><span data-ttu-id="3afd9-435">SQL_COPT_SS_WARN_ON_CP_ERROR</span><span class="sxs-lookup"><span data-stu-id="3afd9-435">SQL_COPT_SS_WARN_ON_CP_ERROR</span></span>  
 <span data-ttu-id="3afd9-436">Cet attribut détermine si vous obtenez un avertissement en cas de perte de données lors de la conversion d'une page de codes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-436">This attribute determines whether you will get a warning if there is a loss of data during a code page conversion.</span></span> <span data-ttu-id="3afd9-437">Cela s'applique uniquement aux données provenant du serveur.</span><span class="sxs-lookup"><span data-stu-id="3afd9-437">This applies to only data coming from the server.</span></span>  
  
|<span data-ttu-id="3afd9-438">Valeur</span><span class="sxs-lookup"><span data-stu-id="3afd9-438">Value</span></span>|<span data-ttu-id="3afd9-439">Description</span><span class="sxs-lookup"><span data-stu-id="3afd9-439">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="3afd9-440">SQL_WARN_YES</span><span class="sxs-lookup"><span data-stu-id="3afd9-440">SQL_WARN_YES</span></span>|<span data-ttu-id="3afd9-441">Générer des avertissements lorsqu'une perte de données est constatée pendant la conversion de page de codes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-441">Generate warnings when data loss is encountered during codepage conversion.</span></span>|  
|<span data-ttu-id="3afd9-442">SQL_WARN_NO</span><span class="sxs-lookup"><span data-stu-id="3afd9-442">SQL_WARN_NO</span></span>|<span data-ttu-id="3afd9-443">(Par défaut) Ne pas générer d'avertissements lorsqu'une perte de données est constatée pendant la conversion de page de codes.</span><span class="sxs-lookup"><span data-stu-id="3afd9-443">(Default) Do not generate warnings when data loss is encountered during codepage conversion.</span></span>|  
  
## <a name="sqlsetconnectattr-support-for-service-principal-names-spns"></a><span data-ttu-id="3afd9-444">Prise en charge de SQLSetConnectAttr pour les noms de principaux du service (SPN)</span><span class="sxs-lookup"><span data-stu-id="3afd9-444">SQLSetConnectAttr Support for Service Principal Names (SPNs)</span></span>  
 <span data-ttu-id="3afd9-445">SQLSetConnectAttr peut être utilisé pour définir la valeur des nouveaux attributs de connexion SQL_COPT_SS_SERVER_SPN et SQL_COPT_SS_FAILOVER_PARTNER_SPN.</span><span class="sxs-lookup"><span data-stu-id="3afd9-445">SQLSetConnectAttr can be used to set the value of the new connection attributes SQL_COPT_SS_SERVER_SPN and SQL_COPT_SS_FAILOVER_PARTNER_SPN.</span></span> <span data-ttu-id="3afd9-446">Ces attributs ne peuvent pas être définis lorsqu'une connexion est ouverte ; si vous essayez de définir ces attributs lorsqu'une connexion est ouverte, l'erreur HY011 est retournée avec le message « Opération actuellement non valide ».</span><span class="sxs-lookup"><span data-stu-id="3afd9-446">These attributes cannot be set when a connection is open; if you attempt to set these attributes when a connection is open, error HY011 is returned with the message "Operation invalid at this time".</span></span> <span data-ttu-id="3afd9-447">(SQLSetConnectOption peut également être utilisé pour définir ces valeurs.)</span><span class="sxs-lookup"><span data-stu-id="3afd9-447">(SQLSetConnectOption can also be used to set these values.)</span></span>  
  
 <span data-ttu-id="3afd9-448">Pour plus d’informations sur les SPN, consultez [noms de principal du Service &#40;spn&#41; dans connexions clientes &#40;&#41;ODBC ](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-448">For more information about SPNs, see [Service Principal Names &#40;SPNs&#41; in Client Connections &#40;ODBC&#41;](../native-client/odbc/service-principal-names-spns-in-client-connections-odbc.md).</span></span>  
  
## <a name="sql_copt_ss_connection_dead"></a><span data-ttu-id="3afd9-449">SQL_COPT_SS_CONNECTION_DEAD</span><span class="sxs-lookup"><span data-stu-id="3afd9-449">SQL_COPT_SS_CONNECTION_DEAD</span></span>  
 <span data-ttu-id="3afd9-450">Ceci est un attribut de lecture seule.</span><span class="sxs-lookup"><span data-stu-id="3afd9-450">This is a read-only attribute.</span></span>  
  
 <span data-ttu-id="3afd9-451">Pour plus d’informations sur la SQL_COPT_SS_CONNECTION_DEAD, consultez [SQLGetConnectAttr](sqlgetconnectattr.md) et [connexion à une Source de données &#40;&#41;ODBC ](../native-client-odbc-communication/connecting-to-a-data-source-odbc.md).</span><span class="sxs-lookup"><span data-stu-id="3afd9-451">For more information about SQL_COPT_SS_CONNECTION_DEAD, see [SQLGetConnectAttr](sqlgetconnectattr.md) and [Connecting to a Data Source &#40;ODBC&#41;](../native-client-odbc-communication/connecting-to-a-data-source-odbc.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="3afd9-452">Exemple</span><span class="sxs-lookup"><span data-stu-id="3afd9-452">Example</span></span>  
 <span data-ttu-id="3afd9-453">Cet exemple consigne les données de performances.</span><span class="sxs-lookup"><span data-stu-id="3afd9-453">This example logs performance data.</span></span>  
  
```  
SQLPERF*     pSQLPERF;  
SQLINTEGER   nValue;  
  
// See if you are already logging. SQLPERF* will be NULL if not.  
SQLGetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA, &pSQLPERF,  
    sizeof(SQLPERF*), &nValue);  
  
if (pSQLPERF == NULL)  
    {  
    // Set the performance log file name.  
    SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA_LOG,  
        (SQLPOINTER) "\\My LogDirectory\\MyServerLog.txt", SQL_NTS);  
  
    // Start logging...  
    SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA,  
        (SQLPOINTER) SQL_PERF_START, SQL_IS_INTEGER);  
    }  
else  
    {  
    // Take a snapshot now so that your performance statistics are discernible.  
    SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA_LOG_NOW, NULL, 0);  
    }  
  
    // ...perform some action...  
  
// ...take a performance data snapshot...  
SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA_LOG_NOW, NULL, 0);  
  
    // ...perform more actions...  
  
// ...take another snapshot...  
SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA_LOG_NOW, NULL, 0);  
  
// ...and disable logging.  
SQLSetConnectAttr(hDbc, SQL_COPT_SS_PERF_DATA,  
    (SQLPOINTER) SQL_PERF_STOP, SQL_IS_INTEGER);  
  
// Continue on...  
```  
  
## <a name="see-also"></a><span data-ttu-id="3afd9-454">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3afd9-454">See Also</span></span>  
 <span data-ttu-id="3afd9-455">[Fonction SQLSetConnectAttr](https://go.microsoft.com/fwlink/?LinkId=59368) </span><span class="sxs-lookup"><span data-stu-id="3afd9-455">[SQLSetConnectAttr Function](https://go.microsoft.com/fwlink/?LinkId=59368) </span></span>  
 <span data-ttu-id="3afd9-456">[Détails de l’implémentation de l’API ODBC](odbc-api-implementation-details.md) </span><span class="sxs-lookup"><span data-stu-id="3afd9-456">[ODBC API Implementation Details](odbc-api-implementation-details.md) </span></span>  
 <span data-ttu-id="3afd9-457">[Fonctions de copie en bloc](../native-client-odbc-extensions-bulk-copy-functions/sql-server-driver-extensions-bulk-copy-functions.md) </span><span class="sxs-lookup"><span data-stu-id="3afd9-457">[Bulk Copy Functions](../native-client-odbc-extensions-bulk-copy-functions/sql-server-driver-extensions-bulk-copy-functions.md) </span></span>  
 <span data-ttu-id="3afd9-458">[SET ANSI_NULLS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-nulls-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="3afd9-458">[SET ANSI_NULLS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-nulls-transact-sql) </span></span>  
 <span data-ttu-id="3afd9-459">[SET ANSI_PADDING &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-padding-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="3afd9-459">[SET ANSI_PADDING &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-padding-transact-sql) </span></span>  
 <span data-ttu-id="3afd9-460">[SET ANSI_WARNINGS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-warnings-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="3afd9-460">[SET ANSI_WARNINGS &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-ansi-warnings-transact-sql) </span></span>  
 <span data-ttu-id="3afd9-461">[SET CONCAT_NULL_YIELDS_NULL &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-concat-null-yields-null-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="3afd9-461">[SET CONCAT_NULL_YIELDS_NULL &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-concat-null-yields-null-transact-sql) </span></span>  
 <span data-ttu-id="3afd9-462">[DÉFINIR QUOTED_IDENTIFIER &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-quoted-identifier-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="3afd9-462">[SET QUOTED_IDENTIFIER &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-quoted-identifier-transact-sql) </span></span>  
 <span data-ttu-id="3afd9-463">[SQLPrepare, fonction](https://go.microsoft.com/fwlink/?LinkId=59360) </span><span class="sxs-lookup"><span data-stu-id="3afd9-463">[SQLPrepare Function](https://go.microsoft.com/fwlink/?LinkId=59360) </span></span>  
 [<span data-ttu-id="3afd9-464">SQLGetInfo</span><span class="sxs-lookup"><span data-stu-id="3afd9-464">SQLGetInfo</span></span>](../../relational-databases/native-client-odbc-api/sqlgetinfo.md)  
  
  
