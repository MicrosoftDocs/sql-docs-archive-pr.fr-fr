---
title: Métadonnées de paramètre et d’ensemble de lignes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- metadata [OLE DB]
ms.assetid: 31b318a4-20e7-4db0-b367-eb9938859029
author: rothja
ms.author: jroth
ms.openlocfilehash: f3bddb4d83a8904b3def70853fe1e6614dd48d9c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87698141"
---
# <a name="parameter-and-rowset-metadata"></a><span data-ttu-id="0d806-102">Métadonnées de paramètre et d'ensemble de lignes</span><span class="sxs-lookup"><span data-stu-id="0d806-102">Parameter and Rowset Metadata</span></span>
  <span data-ttu-id="0d806-103">Cette rubrique fournit des informations sur le type et les membres de type suivants en rapport avec les améliorations de date et d'heure OLE DB.</span><span class="sxs-lookup"><span data-stu-id="0d806-103">This topic provides information about the following type and type members, related to the OLE DB date and time enhancements.</span></span>  
  
-   <span data-ttu-id="0d806-104">Structure DBBINDING</span><span class="sxs-lookup"><span data-stu-id="0d806-104">DBBINDING structure</span></span>  
  
-   `ICommandWithParameters::GetParameterInfo`  
  
-   `ICommandWithParameters::SetParameterInfo`  
  
-   `IColumnsRowset::GetColumnsRowset`  
  
-   `IColumnsInfo::GetColumnInfo`  
  
## <a name="icommandwithparametersgetparameterinfo"></a><span data-ttu-id="0d806-105">ICommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="0d806-105">ICommandWithParameters::GetParameterInfo</span></span>  
 <span data-ttu-id="0d806-106">Les informations suivantes sont retournées dans la structure DBPARAMINFO via *prgParamInfo* :</span><span class="sxs-lookup"><span data-stu-id="0d806-106">The following information is returned in the DBPARAMINFO structure through *prgParamInfo*:</span></span>  
  
|<span data-ttu-id="0d806-107">Type de paramètre</span><span class="sxs-lookup"><span data-stu-id="0d806-107">Parameter Type</span></span>|<span data-ttu-id="0d806-108">*wType*</span><span class="sxs-lookup"><span data-stu-id="0d806-108">*wType*</span></span>|<span data-ttu-id="0d806-109">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="0d806-109">*ulParamSize*</span></span>|<span data-ttu-id="0d806-110">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="0d806-110">*bPrecision*</span></span>|<span data-ttu-id="0d806-111">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0d806-111">*bScale*</span></span>|<span data-ttu-id="0d806-112">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="0d806-112">*dwFlags*</span></span><br /><br /> <span data-ttu-id="0d806-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="0d806-113">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|-------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="0d806-114">Date</span><span class="sxs-lookup"><span data-stu-id="0d806-114">date</span></span>|<span data-ttu-id="0d806-115">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="0d806-115">DBTYPE_DBDATE</span></span>|<span data-ttu-id="0d806-116">6</span><span class="sxs-lookup"><span data-stu-id="0d806-116">6</span></span>|<span data-ttu-id="0d806-117">10</span><span class="sxs-lookup"><span data-stu-id="0d806-117">10</span></span>|<span data-ttu-id="0d806-118">0</span><span class="sxs-lookup"><span data-stu-id="0d806-118">0</span></span>|<span data-ttu-id="0d806-119">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-119">Clear</span></span>|  
|<span data-ttu-id="0d806-120">time</span><span class="sxs-lookup"><span data-stu-id="0d806-120">time</span></span>|<span data-ttu-id="0d806-121">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0d806-121">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="0d806-122">10</span><span class="sxs-lookup"><span data-stu-id="0d806-122">10</span></span>|<span data-ttu-id="0d806-123">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="0d806-123">8, 10..16</span></span>|<span data-ttu-id="0d806-124">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-124">0..7</span></span>|<span data-ttu-id="0d806-125">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-125">Set</span></span>|  
|<span data-ttu-id="0d806-126">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0d806-126">smalldatetime</span></span>|<span data-ttu-id="0d806-127">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-127">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-128">16</span><span class="sxs-lookup"><span data-stu-id="0d806-128">16</span></span>|<span data-ttu-id="0d806-129">16</span><span class="sxs-lookup"><span data-stu-id="0d806-129">16</span></span>|<span data-ttu-id="0d806-130">0</span><span class="sxs-lookup"><span data-stu-id="0d806-130">0</span></span>|<span data-ttu-id="0d806-131">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-131">Clear</span></span>|  
|<span data-ttu-id="0d806-132">DATETIME</span><span class="sxs-lookup"><span data-stu-id="0d806-132">datetime</span></span>|<span data-ttu-id="0d806-133">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-133">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-134">16</span><span class="sxs-lookup"><span data-stu-id="0d806-134">16</span></span>|<span data-ttu-id="0d806-135">23</span><span class="sxs-lookup"><span data-stu-id="0d806-135">23</span></span>|<span data-ttu-id="0d806-136">3</span><span class="sxs-lookup"><span data-stu-id="0d806-136">3</span></span>|<span data-ttu-id="0d806-137">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-137">Clear</span></span>|  
|<span data-ttu-id="0d806-138">datetime2</span><span class="sxs-lookup"><span data-stu-id="0d806-138">datetime2</span></span>|<span data-ttu-id="0d806-139">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-139">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-140">16</span><span class="sxs-lookup"><span data-stu-id="0d806-140">16</span></span>|<span data-ttu-id="0d806-141">19, 21.. 27</span><span class="sxs-lookup"><span data-stu-id="0d806-141">19,21..27</span></span>|<span data-ttu-id="0d806-142">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-142">0..7</span></span>|<span data-ttu-id="0d806-143">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-143">Set</span></span>|  
|<span data-ttu-id="0d806-144">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0d806-144">datetimeoffset</span></span>|<span data-ttu-id="0d806-145">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0d806-145">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="0d806-146">20</span><span class="sxs-lookup"><span data-stu-id="0d806-146">20</span></span>|<span data-ttu-id="0d806-147">26, 28.. 34</span><span class="sxs-lookup"><span data-stu-id="0d806-147">26,28..34</span></span>|<span data-ttu-id="0d806-148">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-148">0..7</span></span>|<span data-ttu-id="0d806-149">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-149">Set</span></span>|  
  
 <span data-ttu-id="0d806-150">Notez que, dans certains cas, les plages de valeurs ne sont pas continues.</span><span class="sxs-lookup"><span data-stu-id="0d806-150">Notice that in some cases value ranges are not continuous.</span></span> <span data-ttu-id="0d806-151">Cela est dû à l'ajout d'une virgule décimale lorsque la précision fractionnaire est supérieure à zéro.</span><span class="sxs-lookup"><span data-stu-id="0d806-151">This is due to the addition of a decimal point when fractional precision is greater than zero.</span></span>  
  
 <span data-ttu-id="0d806-152">DBPARAMFLAGS_SS_ISVARIABLESCALE est valide seulement en cas de connexion à un serveur [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (ou ultérieur).</span><span class="sxs-lookup"><span data-stu-id="0d806-152">DBPARAMFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="0d806-153">DBPARAMFLAGS_SS_ISVARIABLESCALE n’est jamais défini en cas de connexion à des serveurs de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="0d806-153">DBPARAMFLAGS_SS_ISVARIABLESCALE is never set when connected to down-level servers.</span></span>  
  
## <a name="icommandwithparameterssetparameterinfo-and-implied-parameter-types"></a><span data-ttu-id="0d806-154">ICommandWithParameters::SetParameterInfo et types de paramètre implicites</span><span class="sxs-lookup"><span data-stu-id="0d806-154">ICommandWithParameters::SetParameterInfo and Implied Parameter Types</span></span>  
 <span data-ttu-id="0d806-155">Les informations fournies dans la structure DBPARAMBINDINFO doivent respecter les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d806-155">The information provided in the DBPARAMBINDINFO structure must conform to the following:</span></span>  
  
|<span data-ttu-id="0d806-156">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="0d806-156">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="0d806-157">(spécifique au fournisseur)</span><span class="sxs-lookup"><span data-stu-id="0d806-157">(provider specific)</span></span>|<span data-ttu-id="0d806-158">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="0d806-158">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="0d806-159">(OLE DB générique)</span><span class="sxs-lookup"><span data-stu-id="0d806-159">(OLE DB generic)</span></span>|<span data-ttu-id="0d806-160">*ulParamSize*</span><span class="sxs-lookup"><span data-stu-id="0d806-160">*ulParamSize*</span></span>|<span data-ttu-id="0d806-161">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0d806-161">*bScale*</span></span>|  
|----------------------------------------------------|-------------------------------------------------|-------------------|--------------|  
||<span data-ttu-id="0d806-162">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="0d806-162">DBTYPE_DATE</span></span>|<span data-ttu-id="0d806-163">6</span><span class="sxs-lookup"><span data-stu-id="0d806-163">6</span></span>|<span data-ttu-id="0d806-164">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0d806-164">Ignored</span></span>|  
|<span data-ttu-id="0d806-165">Date</span><span class="sxs-lookup"><span data-stu-id="0d806-165">date</span></span>|<span data-ttu-id="0d806-166">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="0d806-166">DBTYPE_DBDATE</span></span>|<span data-ttu-id="0d806-167">6</span><span class="sxs-lookup"><span data-stu-id="0d806-167">6</span></span>|<span data-ttu-id="0d806-168">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0d806-168">Ignored</span></span>|  
||<span data-ttu-id="0d806-169">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="0d806-169">DBTYPE_DBTIME</span></span>|<span data-ttu-id="0d806-170">10</span><span class="sxs-lookup"><span data-stu-id="0d806-170">10</span></span>|<span data-ttu-id="0d806-171">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0d806-171">Ignored</span></span>|  
|<span data-ttu-id="0d806-172">time</span><span class="sxs-lookup"><span data-stu-id="0d806-172">time</span></span>|<span data-ttu-id="0d806-173">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0d806-173">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="0d806-174">10</span><span class="sxs-lookup"><span data-stu-id="0d806-174">10</span></span>|<span data-ttu-id="0d806-175">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-175">0..7</span></span>|  
|<span data-ttu-id="0d806-176">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0d806-176">smalldatetime</span></span>||<span data-ttu-id="0d806-177">16</span><span class="sxs-lookup"><span data-stu-id="0d806-177">16</span></span>|<span data-ttu-id="0d806-178">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0d806-178">Ignored</span></span>|  
|<span data-ttu-id="0d806-179">DATETIME</span><span class="sxs-lookup"><span data-stu-id="0d806-179">datetime</span></span>||<span data-ttu-id="0d806-180">16</span><span class="sxs-lookup"><span data-stu-id="0d806-180">16</span></span>|<span data-ttu-id="0d806-181">Ignoré</span><span class="sxs-lookup"><span data-stu-id="0d806-181">Ignored</span></span>|  
|<span data-ttu-id="0d806-182">datetime2 ou DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-182">datetime2 or DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-183">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-183">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-184">16</span><span class="sxs-lookup"><span data-stu-id="0d806-184">16</span></span>|<span data-ttu-id="0d806-185">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-185">0..7</span></span>|  
|<span data-ttu-id="0d806-186">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0d806-186">datetimeoffset</span></span>|<span data-ttu-id="0d806-187">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0d806-187">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="0d806-188">20</span><span class="sxs-lookup"><span data-stu-id="0d806-188">20</span></span>|<span data-ttu-id="0d806-189">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-189">0..7</span></span>|  
  
 <span data-ttu-id="0d806-190">Le paramètre *bPrecision* est ignoré.</span><span class="sxs-lookup"><span data-stu-id="0d806-190">The *bPrecision* parameter is ignored.</span></span>  
  
 <span data-ttu-id="0d806-191">« DBPARAMFLAGS_SS_ISVARIABLESCALE » est ignoré lors de l'envoi de données au serveur.</span><span class="sxs-lookup"><span data-stu-id="0d806-191">"DBPARAMFLAGS_SS_ISVARIABLESCALE" is ignored when sending data to the server.</span></span> <span data-ttu-id="0d806-192">Les applications peuvent forcer l'utilisation de types TDS (Tabular Data Stream) hérités en utilisant les noms de types spécifiques au fournisseur « `datetime` » et « `smalldatetime` ».</span><span class="sxs-lookup"><span data-stu-id="0d806-192">Applications can force the use of legacy tabular-data stream (TDS) types by using the provider-specific type names "`datetime`" and "`smalldatetime`".</span></span> <span data-ttu-id="0d806-193">En cas de connexion à des [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] serveurs (ou ultérieurs), `datetime2` le format « » est utilisé et une conversion de serveur implicite se produit, si nécessaire, lorsque le nom de type est « `datetime2` » ou « DBTYPE_DBTIMESTAMP ».</span><span class="sxs-lookup"><span data-stu-id="0d806-193">When connected to [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) servers, "`datetime2`" format will be used and an implicit server conversion will occur, if necessary, when the type name is "`datetime2`" or "DBTYPE_DBTIMESTAMP".</span></span> <span data-ttu-id="0d806-194">*bScale* est ignoré si les noms de types spécifiques au fournisseur « `datetime` » ou «» `smalldatetime` sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="0d806-194">*bScale* is ignored if the provider specific type names "`datetime`" or "`smalldatetime`" are used.</span></span> <span data-ttu-id="0d806-195">Dans le cas contraire, appications doit s’assurer que *bScale* est défini correctement.</span><span class="sxs-lookup"><span data-stu-id="0d806-195">Otherwise, appications must ensure that *bScale* is set correctly.</span></span> <span data-ttu-id="0d806-196">Les applications mises à niveau à partir de MDAC et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] native client à partir de [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] qui utilisent « DBTYPE_DBTIMESTAMP » échouent si elles ne définissent pas correctement *bScale* .</span><span class="sxs-lookup"><span data-stu-id="0d806-196">Applications upgraded from MDAC and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client from [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] that use "DBTYPE_DBTIMESTAMP" will fail if they do not set *bScale* correctly.</span></span> <span data-ttu-id="0d806-197">En cas de connexion à instances de serveur antérieures à [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], une valeur *bScale* autre que 0 ou 3 avec « DBTYPE_DBTIMESTAMP » est une erreur, et E_FAIL est retourné.</span><span class="sxs-lookup"><span data-stu-id="0d806-197">When connected to server instances earlier than [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)], a *bScale* value other than 0 or 3 with "DBTYPE_DBTIMESTAMP" is an error and E_FAIL will be returned.</span></span>  
  
 <span data-ttu-id="0d806-198">Quand ICommandWithParameters :: SetParameterInfo n’est pas appelé, le fournisseur implique le type de serveur à partir du type de liaison comme indiqué dans IAccessor :: CreateAccessor comme suit :</span><span class="sxs-lookup"><span data-stu-id="0d806-198">When ICommandWithParameters::SetParameterInfo is not called, the provider imples the server type from the binding type as specified in IAccessor::CreateAccessor as follows:</span></span>  
  
|<span data-ttu-id="0d806-199">Type de liaison</span><span class="sxs-lookup"><span data-stu-id="0d806-199">Binding Type</span></span>|<span data-ttu-id="0d806-200">*pwszDataSourceType*</span><span class="sxs-lookup"><span data-stu-id="0d806-200">*pwszDataSourceType*</span></span><br /><br /> <span data-ttu-id="0d806-201">(spécifique au fournisseur)</span><span class="sxs-lookup"><span data-stu-id="0d806-201">(provider specific)</span></span>|  
|------------------|----------------------------------------------------|  
|<span data-ttu-id="0d806-202">DBTYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="0d806-202">DBTYPE_DATE</span></span>|<span data-ttu-id="0d806-203">datetime2(0)</span><span class="sxs-lookup"><span data-stu-id="0d806-203">datetime2(0)</span></span>|  
|<span data-ttu-id="0d806-204">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="0d806-204">DBTYPE_DBDATE</span></span>|<span data-ttu-id="0d806-205">Date</span><span class="sxs-lookup"><span data-stu-id="0d806-205">date</span></span>|  
|<span data-ttu-id="0d806-206">DBTYPE_DBTIME</span><span class="sxs-lookup"><span data-stu-id="0d806-206">DBTYPE_DBTIME</span></span>|<span data-ttu-id="0d806-207">time(0)</span><span class="sxs-lookup"><span data-stu-id="0d806-207">time(0)</span></span>|  
|<span data-ttu-id="0d806-208">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0d806-208">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="0d806-209">time(7)</span><span class="sxs-lookup"><span data-stu-id="0d806-209">time(7)</span></span>|  
|<span data-ttu-id="0d806-210">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-210">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-211">datetime2(7)</span><span class="sxs-lookup"><span data-stu-id="0d806-211">datetime2(7)</span></span>|  
|<span data-ttu-id="0d806-212">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0d806-212">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="0d806-213">datetimeoffset(7)</span><span class="sxs-lookup"><span data-stu-id="0d806-213">datetimeoffset(7)</span></span>|  
  
## <a name="icolumnsrowsetgetcolumnsrowset"></a><span data-ttu-id="0d806-214">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="0d806-214">IColumnsRowset::GetColumnsRowset</span></span>  
 <span data-ttu-id="0d806-215">`IColumnsRowset::GetColumnsRowset` retourne les colonnes suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d806-215">`IColumnsRowset::GetColumnsRowset` returns the following columns:</span></span>  
  
|<span data-ttu-id="0d806-216">Type de colonne</span><span class="sxs-lookup"><span data-stu-id="0d806-216">Column Type</span></span>|<span data-ttu-id="0d806-217">DBCOLUMN_TYPE</span><span class="sxs-lookup"><span data-stu-id="0d806-217">DBCOLUMN_TYPE</span></span>|<span data-ttu-id="0d806-218">DBCOLUM_COLUMNSIZE</span><span class="sxs-lookup"><span data-stu-id="0d806-218">DBCOLUM_COLUMNSIZE</span></span>|<span data-ttu-id="0d806-219">DBCOLUMN_PRECISION</span><span class="sxs-lookup"><span data-stu-id="0d806-219">DBCOLUMN_PRECISION</span></span>|<span data-ttu-id="0d806-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span><span class="sxs-lookup"><span data-stu-id="0d806-220">DBCOLUMN_SCALE, DBCOLUMN_DATETIMEPRECISION</span></span>|<span data-ttu-id="0d806-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="0d806-221">DBCOLUMN_FLAGS, DBCOLUMNFLAGS_SS_ISVARIABLESCALE</span></span>|  
|-----------------|--------------------|-------------------------|-------------------------|--------------------------------------------------|---------------------------------------------------------|  
|<span data-ttu-id="0d806-222">Date</span><span class="sxs-lookup"><span data-stu-id="0d806-222">date</span></span>|<span data-ttu-id="0d806-223">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="0d806-223">DBTYPE_DBDATE</span></span>|<span data-ttu-id="0d806-224">6</span><span class="sxs-lookup"><span data-stu-id="0d806-224">6</span></span>|<span data-ttu-id="0d806-225">10</span><span class="sxs-lookup"><span data-stu-id="0d806-225">10</span></span>|<span data-ttu-id="0d806-226">0</span><span class="sxs-lookup"><span data-stu-id="0d806-226">0</span></span>|<span data-ttu-id="0d806-227">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-227">Clear</span></span>|  
|<span data-ttu-id="0d806-228">time</span><span class="sxs-lookup"><span data-stu-id="0d806-228">time</span></span>|<span data-ttu-id="0d806-229">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0d806-229">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="0d806-230">10</span><span class="sxs-lookup"><span data-stu-id="0d806-230">10</span></span>|<span data-ttu-id="0d806-231">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="0d806-231">8, 10..16</span></span>|<span data-ttu-id="0d806-232">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-232">0..7</span></span>|<span data-ttu-id="0d806-233">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-233">Set</span></span>|  
|<span data-ttu-id="0d806-234">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0d806-234">smalldatetime</span></span>|<span data-ttu-id="0d806-235">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-235">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-236">16</span><span class="sxs-lookup"><span data-stu-id="0d806-236">16</span></span>|<span data-ttu-id="0d806-237">16</span><span class="sxs-lookup"><span data-stu-id="0d806-237">16</span></span>|<span data-ttu-id="0d806-238">0</span><span class="sxs-lookup"><span data-stu-id="0d806-238">0</span></span>|<span data-ttu-id="0d806-239">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-239">Clear</span></span>|  
|<span data-ttu-id="0d806-240">DATETIME</span><span class="sxs-lookup"><span data-stu-id="0d806-240">datetime</span></span>|<span data-ttu-id="0d806-241">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-241">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-242">16</span><span class="sxs-lookup"><span data-stu-id="0d806-242">16</span></span>|<span data-ttu-id="0d806-243">23</span><span class="sxs-lookup"><span data-stu-id="0d806-243">23</span></span>|<span data-ttu-id="0d806-244">3</span><span class="sxs-lookup"><span data-stu-id="0d806-244">3</span></span>|<span data-ttu-id="0d806-245">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-245">Clear</span></span>|  
|<span data-ttu-id="0d806-246">datetime2</span><span class="sxs-lookup"><span data-stu-id="0d806-246">datetime2</span></span>|<span data-ttu-id="0d806-247">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-247">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-248">16</span><span class="sxs-lookup"><span data-stu-id="0d806-248">16</span></span>|<span data-ttu-id="0d806-249">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="0d806-249">19, 21..27</span></span>|<span data-ttu-id="0d806-250">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-250">0..7</span></span>|<span data-ttu-id="0d806-251">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-251">Set</span></span>|  
|<span data-ttu-id="0d806-252">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0d806-252">datetimeoffset</span></span>|<span data-ttu-id="0d806-253">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0d806-253">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="0d806-254">20</span><span class="sxs-lookup"><span data-stu-id="0d806-254">20</span></span>|<span data-ttu-id="0d806-255">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="0d806-255">26, 28..34</span></span>|<span data-ttu-id="0d806-256">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-256">0..7</span></span>|<span data-ttu-id="0d806-257">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-257">Set</span></span>|  
  
 <span data-ttu-id="0d806-258">Dans DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH a toujours la valeur True pour les types date/heure et les indicateurs suivants sont toujours False :</span><span class="sxs-lookup"><span data-stu-id="0d806-258">In DBCOLUMN_FLAGS, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="0d806-259">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="0d806-259">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="0d806-260">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="0d806-260">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="0d806-261">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="0d806-261">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="0d806-262">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0d806-262">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="0d806-263">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="0d806-263">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="0d806-264">DBCOLUMNFLAGS_ISROWVER</span><span class="sxs-lookup"><span data-stu-id="0d806-264">DBCOLUMNFLAGS_ISROWVER</span></span>  
  
-   <span data-ttu-id="0d806-265">DBCOLUMNFLAGS_MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="0d806-265">DBCOLUMNFLAGS_MAYDEFER</span></span>  
  
 <span data-ttu-id="0d806-266">Les indicateurs restants (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE et DBCOLUMNFLAGS_WRITEUNKNOWN) peuvent être définis, en fonction de la manière dont la colonne est définie et de la requête réelle.</span><span class="sxs-lookup"><span data-stu-id="0d806-266">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set, depending on how the column is defined and the actual query.</span></span>  
  
 <span data-ttu-id="0d806-267">Un nouvel indicateur DBCOLUMNFLAGS_SS_ISVARIABLESCALE est fourni dans DBCOLUMN_FLAGS pour permettre à une application de déterminer le type de serveur de colonnes, où DBCOLUMN_TYPE représente DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="0d806-267">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in DBCOLUMN_FLAGS to allow an application to determine the server type of columns, where DBCOLUMN_TYPE is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="0d806-268">DBCOLUMN_SCALE ou DBCOLUMN_DATETIMEPRECISION doit également être utilisé pour identifier le type de serveur.</span><span class="sxs-lookup"><span data-stu-id="0d806-268">DBCOLUMN_SCALE or DBCOLUMN_DATETIMEPRECISION must also be used to identify the server type.</span></span>  
  
 <span data-ttu-id="0d806-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE est valide seulement en cas de connexion à un serveur [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (ou ultérieur).</span><span class="sxs-lookup"><span data-stu-id="0d806-269">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is only valid when connected to a [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] (or later) server.</span></span> <span data-ttu-id="0d806-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE est non défini en cas de connexion à des serveurs de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="0d806-270">DBCOLUMNFLAGS_SS_ISVARIABLESCALE is undefined when connected to down-level servers.</span></span>  
  
## <a name="icolumnsinfogetcolumninfo"></a><span data-ttu-id="0d806-271">IColumnsInfo::GetColumnInfo</span><span class="sxs-lookup"><span data-stu-id="0d806-271">IColumnsInfo::GetColumnInfo</span></span>  
 <span data-ttu-id="0d806-272">La structure DBCOLUMNINFO retourne les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="0d806-272">DBCOLUMNINFO structure returns the following information:</span></span>  
  
|<span data-ttu-id="0d806-273">Type de paramètre</span><span class="sxs-lookup"><span data-stu-id="0d806-273">Parameter Type</span></span>|<span data-ttu-id="0d806-274">*wType*</span><span class="sxs-lookup"><span data-stu-id="0d806-274">*wType*</span></span>|<span data-ttu-id="0d806-275">*ulColumnSize*</span><span class="sxs-lookup"><span data-stu-id="0d806-275">*ulColumnSize*</span></span>|<span data-ttu-id="0d806-276">*bPrecision*</span><span class="sxs-lookup"><span data-stu-id="0d806-276">*bPrecision*</span></span>|<span data-ttu-id="0d806-277">*bScale*</span><span class="sxs-lookup"><span data-stu-id="0d806-277">*bScale*</span></span>|<span data-ttu-id="0d806-278">*dwFlags*</span><span class="sxs-lookup"><span data-stu-id="0d806-278">*dwFlags*</span></span><br /><br /> <span data-ttu-id="0d806-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span><span class="sxs-lookup"><span data-stu-id="0d806-279">DBPARAMFLAGS_SS_ISVARIABLESCALE</span></span>|  
|--------------------|-------------|--------------------|------------------|--------------|-----------------------------------------------------|  
|<span data-ttu-id="0d806-280">Date</span><span class="sxs-lookup"><span data-stu-id="0d806-280">date</span></span>|<span data-ttu-id="0d806-281">DBTYPE_DBDATE</span><span class="sxs-lookup"><span data-stu-id="0d806-281">DBTYPE_DBDATE</span></span>|<span data-ttu-id="0d806-282">6</span><span class="sxs-lookup"><span data-stu-id="0d806-282">6</span></span>|<span data-ttu-id="0d806-283">10</span><span class="sxs-lookup"><span data-stu-id="0d806-283">10</span></span>|<span data-ttu-id="0d806-284">0</span><span class="sxs-lookup"><span data-stu-id="0d806-284">0</span></span>|<span data-ttu-id="0d806-285">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-285">Clear</span></span>|  
|<span data-ttu-id="0d806-286">time(1..7)</span><span class="sxs-lookup"><span data-stu-id="0d806-286">time(1..7)</span></span>|<span data-ttu-id="0d806-287">DBTYPE_DBTIME2</span><span class="sxs-lookup"><span data-stu-id="0d806-287">DBTYPE_DBTIME2</span></span>|<span data-ttu-id="0d806-288">10</span><span class="sxs-lookup"><span data-stu-id="0d806-288">10</span></span>|<span data-ttu-id="0d806-289">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="0d806-289">8, 10..16</span></span>|<span data-ttu-id="0d806-290">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-290">0..7</span></span>|<span data-ttu-id="0d806-291">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-291">Set</span></span>|  
|<span data-ttu-id="0d806-292">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0d806-292">smalldatetime</span></span>|<span data-ttu-id="0d806-293">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-293">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-294">16</span><span class="sxs-lookup"><span data-stu-id="0d806-294">16</span></span>|<span data-ttu-id="0d806-295">16</span><span class="sxs-lookup"><span data-stu-id="0d806-295">16</span></span>|<span data-ttu-id="0d806-296">0</span><span class="sxs-lookup"><span data-stu-id="0d806-296">0</span></span>|<span data-ttu-id="0d806-297">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-297">Clear</span></span>|  
|<span data-ttu-id="0d806-298">DATETIME</span><span class="sxs-lookup"><span data-stu-id="0d806-298">datetime</span></span>|<span data-ttu-id="0d806-299">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-299">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-300">16</span><span class="sxs-lookup"><span data-stu-id="0d806-300">16</span></span>|<span data-ttu-id="0d806-301">23</span><span class="sxs-lookup"><span data-stu-id="0d806-301">23</span></span>|<span data-ttu-id="0d806-302">3</span><span class="sxs-lookup"><span data-stu-id="0d806-302">3</span></span>|<span data-ttu-id="0d806-303">Désactiver</span><span class="sxs-lookup"><span data-stu-id="0d806-303">Clear</span></span>|  
|<span data-ttu-id="0d806-304">datetime2</span><span class="sxs-lookup"><span data-stu-id="0d806-304">datetime2</span></span>|<span data-ttu-id="0d806-305">DBTYPE_DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0d806-305">DBTYPE_DBTIMESTAMP</span></span>|<span data-ttu-id="0d806-306">16</span><span class="sxs-lookup"><span data-stu-id="0d806-306">16</span></span>|<span data-ttu-id="0d806-307">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="0d806-307">19, 21..27</span></span>|<span data-ttu-id="0d806-308">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-308">0..7</span></span>|<span data-ttu-id="0d806-309">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-309">Set</span></span>|  
|<span data-ttu-id="0d806-310">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0d806-310">datetimeoffset</span></span>|<span data-ttu-id="0d806-311">DBTYPE_DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0d806-311">DBTYPE_DBTIMESTAMPOFFSET</span></span>|<span data-ttu-id="0d806-312">20</span><span class="sxs-lookup"><span data-stu-id="0d806-312">20</span></span>|<span data-ttu-id="0d806-313">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="0d806-313">26, 28..34</span></span>|<span data-ttu-id="0d806-314">0..7</span><span class="sxs-lookup"><span data-stu-id="0d806-314">0..7</span></span>|<span data-ttu-id="0d806-315">Définissez</span><span class="sxs-lookup"><span data-stu-id="0d806-315">Set</span></span>|  
  
 <span data-ttu-id="0d806-316">Dans *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH a toujours la valeur True pour les types date/heure et les indicateurs suivants sont toujours False :</span><span class="sxs-lookup"><span data-stu-id="0d806-316">In *dwFlags*, DBCOLUMNFLAGS_ISFIXEDLENGTH is always true for date/time types and the following flags are always false:</span></span>  
  
-   <span data-ttu-id="0d806-317">DBCOLUMNFLAGS_CACHEDEFERRED</span><span class="sxs-lookup"><span data-stu-id="0d806-317">DBCOLUMNFLAGS_CACHEDEFERRED</span></span>  
  
-   <span data-ttu-id="0d806-318">DBCOLUMNFLAGS_ISBOOKMARK</span><span class="sxs-lookup"><span data-stu-id="0d806-318">DBCOLUMNFLAGS_ISBOOKMARK</span></span>  
  
-   <span data-ttu-id="0d806-319">DBCOLUMNFLAGS_ISCHAPTER</span><span class="sxs-lookup"><span data-stu-id="0d806-319">DBCOLUMNFLAGS_ISCHAPTER</span></span>  
  
-   <span data-ttu-id="0d806-320">DBCOLUMNFLAGS_ISLONG</span><span class="sxs-lookup"><span data-stu-id="0d806-320">DBCOLUMNFLAGS_ISLONG</span></span>  
  
-   <span data-ttu-id="0d806-321">DBCOLUMNFLAGS_ISROWID</span><span class="sxs-lookup"><span data-stu-id="0d806-321">DBCOLUMNFLAGS_ISROWID</span></span>  
  
-   <span data-ttu-id="0d806-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span><span class="sxs-lookup"><span data-stu-id="0d806-322">DBCOLUMNFLAGS_ISROWVER, MAYDEFER</span></span>  
  
 <span data-ttu-id="0d806-323">Les indicateurs restants (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE et DBCOLUMNFLAGS_WRITEUNKNOWN) peuvent être définis.</span><span class="sxs-lookup"><span data-stu-id="0d806-323">The remaining flags (DBCOLUMNFLAGS_ISNULLABLE, DBCOLUMNFLAGS_MAYBENULL, DBCOLUMNFLAGS_WRITE, and DBCOLUMNFLAGS_WRITEUNKNOWN) can be set.</span></span>  
  
 <span data-ttu-id="0d806-324">Un nouvel indicateur, DBCOLUMNFLAGS_SS_ISVARIABLESCALE, est fourni dans *dwFlags* pour permettre à une application de déterminer le type de serveur des colonnes, où *wType* est DBTYPE_DBTIMESTAMP.</span><span class="sxs-lookup"><span data-stu-id="0d806-324">A new flag DBCOLUMNFLAGS_SS_ISVARIABLESCALE is provided in *dwFlags* to allow an application to determine the server type of columns, where *wType* is DBTYPE_DBTIMESTAMP.</span></span> <span data-ttu-id="0d806-325">*bScale* doit aussi être utilisé pour identifier le type de serveur.</span><span class="sxs-lookup"><span data-stu-id="0d806-325">*bScale* must also be used to identify the server type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0d806-326">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0d806-326">See Also</span></span>  
 [<span data-ttu-id="0d806-327">Métadonnées &#40;OLE DB&#41;</span><span class="sxs-lookup"><span data-stu-id="0d806-327">Metadata &#40;OLE DB&#41;</span></span>](../../database-engine/dev-guide/metadata-ole-db.md)  
  
  
