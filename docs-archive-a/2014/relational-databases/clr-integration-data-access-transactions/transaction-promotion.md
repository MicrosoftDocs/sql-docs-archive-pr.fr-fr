---
title: Promotion de la transaction | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: clr
ms.topic: reference
helpviewer_keywords:
- distributed transactions [CLR integration]
- promoting transactions [CLR integration]
- Enlist keyword
- transaction promotion [CLR integration]
ms.assetid: 5bc7e26e-28ad-4198-a40d-8b2c648ba304
author: rothja
ms.author: jroth
ms.openlocfilehash: e78cbb3d2fc888e56c0b55780daf7b449fe6dc40
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87709648"
---
# <a name="transaction-promotion"></a><span data-ttu-id="23151-102">Promotion des transactions</span><span class="sxs-lookup"><span data-stu-id="23151-102">Transaction Promotion</span></span>
  <span data-ttu-id="23151-103">La *promotion* des transactions décrit une transaction locale légère qui peut être promue automatiquement en une transaction entièrement distribuable si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="23151-103">Transaction *promotion* describes a lightweight, local transaction that can be automatically promoted to a fully distributable transaction as needed.</span></span> <span data-ttu-id="23151-104">Lorsqu'une procédure stockée managée est appelée au sein d'une transaction de base de données sur le serveur, le CLR s'exécute dans le contexte d'une transaction locale.</span><span class="sxs-lookup"><span data-stu-id="23151-104">When a managed stored procedure is invoked within a database transaction on the server, the common language runtime (CLR) code is run in the context of a local transaction.</span></span>  <span data-ttu-id="23151-105">Si une connexion à un serveur distant est ouverte dans une transaction de base de données, la connexion au serveur distant est inscrite dans la transaction distribuée et la transaction locale est promue automatiquement en une transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="23151-105">If a connection to a remote server is opened within a database transaction, the connection to the remote server is enlisted into the distributed transaction and the local transaction is automatically promoted to a distributed transaction.</span></span> <span data-ttu-id="23151-106">Ainsi, la promotion des transactions réduit les charges mémoire des transactions distribuées en différant la création d'une transaction distribuée tant qu'elle n'est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="23151-106">So, transaction promotion minimizes the overhead of distributed transactions by deferring the creation of a distributed transaction until it is needed.</span></span> <span data-ttu-id="23151-107">La promotion des transactions est automatique, si elle a été activée à l'aide du mot clé `Enlist`, et ne requiert aucune intervention du développeur.</span><span class="sxs-lookup"><span data-stu-id="23151-107">Transaction promotion is automatic, if it has been enabled using the `Enlist` keyword, and does not require intervention from the developer.</span></span> <span data-ttu-id="23151-108">Le fournisseur de données .NET Framework pour [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] assure la prise en charge de la promotion des transactions au travers des classes de l'espace de noms `System.Data.SqlClient` du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="23151-108">The .NET Framework Data Provider for [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] provides support for transaction promotion, handled through the classes in the .NET Framework `System.Data.SqlClient` namespace.</span></span>  
  
## <a name="the-enlist-keyword"></a><span data-ttu-id="23151-109">Mot clé Enlist</span><span class="sxs-lookup"><span data-stu-id="23151-109">The Enlist Keyword</span></span>  
 <span data-ttu-id="23151-110">La propriété `ConnectionString` d'un objet `SqlConnection` prend en charge le mot clé `Enlist`, qui indique si `System.Data.SqlClient` détecte les contextes transactionnels et inscrit automatiquement la connexion dans une transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="23151-110">The `ConnectionString` property of a `SqlConnection` object supports the `Enlist` keyword, which indicates whether `System.Data.SqlClient` detects transactional contexts and automatically enlists the connection in a distributed transaction.</span></span> <span data-ttu-id="23151-111">Si le mot clé est défini avec la valeur true (valeur par défaut), la connexion est automatiquement inscrite dans le contexte de transaction actif du thread d'ouverture.</span><span class="sxs-lookup"><span data-stu-id="23151-111">If this keyword is set to true (the default), the connection is automatically enlisted in the current transaction context of the opening thread.</span></span> <span data-ttu-id="23151-112">S'il est défini avec la valeur false, la connexion SqlClient n'interagit pas avec une transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="23151-112">If this keyword is set to false, the SqlClient connection does not interact with a distributed transaction.</span></span> <span data-ttu-id="23151-113">Si `Enlist` n'est pas spécifié dans la chaîne de connexion, la connexion est inscrite automatiquement dans une transaction distribuée si celle-ci est détectée au moment où la connexion est ouverte.</span><span class="sxs-lookup"><span data-stu-id="23151-113">If `Enlist` is not specified in the connection string, the connection is automatically enlisted in a distributed transaction if one is detected at the time the connection is opened.</span></span>  
  
## <a name="distributed-transactions"></a><span data-ttu-id="23151-114">Transactions distribuées</span><span class="sxs-lookup"><span data-stu-id="23151-114">Distributed Transactions</span></span>  
 <span data-ttu-id="23151-115">Les transactions distribuées consomment en général d'importantes ressources système.</span><span class="sxs-lookup"><span data-stu-id="23151-115">Distributed transactions typically consume significant system resources.</span></span> [!INCLUDE[msCoName](../../includes/msconame-md.md)] <span data-ttu-id="23151-116">Distributed Transaction Coordinator (MS DTC) gère ces transactions et intègre tous les gestionnaires de ressources qui y sont accédés.</span><span class="sxs-lookup"><span data-stu-id="23151-116">Distributed Transaction Coordinator (MS DTC) manages such transactions, and integrates all of the resource managers accessed in these transactions.</span></span> <span data-ttu-id="23151-117">La promotion des transactions, en revanche, est une forme spéciale de transaction `System.Transactions` qui délègue efficacement le travail à une simple transaction [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="23151-117">Transaction promotion, on the other hand, is a special form of a `System.Transactions` transaction that effectively delegates the work to a simple [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] transaction.</span></span> <span data-ttu-id="23151-118">`System.Transactions`, `System.Data.SqlClient` et [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] coordonnent le travail nécessité par la gestion de la transaction, en la promouvant autant que nécessaire en une transaction distribuée complète.</span><span class="sxs-lookup"><span data-stu-id="23151-118">`System.Transactions`, `System.Data.SqlClient`, and [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] coordinate the work involved in handling the transaction, promoting it to a full distributed transaction as needed.</span></span>  
  
 <span data-ttu-id="23151-119">L'avantage de l'utilisation de la promotion des transaction est que lorsqu'une connexion est ouverte avec une transaction `TransactionScope` active et qu'aucune autre connexion n'est ouverte, la transaction est validée comme transaction légère, au lieu d'encourir les charges mémoire supplémentaires d'une transaction distribuée complète.</span><span class="sxs-lookup"><span data-stu-id="23151-119">The benefit of using transaction promotion is that when a connection is opened with an active `TransactionScope` transaction, and no other connections are opened, the transaction commits as a lightweight transaction, rather than incurring the additional overhead of a full distributed transaction.</span></span> <span data-ttu-id="23151-120">Pour plus d’informations sur `TransactionScope` , consultez [utilisation de System. transactions](../native-client-ole-db-transactions/transactions.md).</span><span class="sxs-lookup"><span data-stu-id="23151-120">For more information about `TransactionScope`, see [Using System.Transactions](../native-client-ole-db-transactions/transactions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="23151-121">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="23151-121">See Also</span></span>  
 [<span data-ttu-id="23151-122">Intégration et transactions du CLR</span><span class="sxs-lookup"><span data-stu-id="23151-122">CLR Integration and Transactions</span></span>](clr-integration-and-transactions.md)  
  
  
