---
title: Générateur de requêtes | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.querybuilder.f1
helpviewer_keywords:
- Query Builder dialog box
ms.assetid: 780752c9-6e3c-4f44-aaff-4f4d5e5a45c5
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 81be066d92ef1e19a141414dad4359b60efca2f9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87696963"
---
# <a name="query-builder"></a><span data-ttu-id="62174-102">Générateur de requêtes</span><span class="sxs-lookup"><span data-stu-id="62174-102">Query Builder</span></span>
  <span data-ttu-id="62174-103">Utilisez la boîte de dialogue **Générateur de requêtes** pour créer une requête à utiliser dans la tâche Exécution SQL, la source OLE DB et la destination OLE DB, ainsi que la transformation de recherche.</span><span class="sxs-lookup"><span data-stu-id="62174-103">Use the **Query Builder** dialog box to create a query for use in the Execute SQL task, the OLE DB source and the OLE DB destination, and the Lookup transformation.</span></span>  
  
 <span data-ttu-id="62174-104">Vous pouvez utiliser le générateur de requêtes pour réaliser les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="62174-104">You can use Query Builder to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="62174-105">**Utilisation d'une représentation graphique d'une requête ou des commandes SQL** Le générateur de requêtes inclut un volet qui affiche votre requête graphiquement et un volet qui affiche le texte SQL de votre requête.</span><span class="sxs-lookup"><span data-stu-id="62174-105">**Working with a graphical representation of a query or with SQL commands** Query Builder includes a pane that displays your query graphically and a pane that displays the SQL text of your query.</span></span> <span data-ttu-id="62174-106">Vous pouvez travailler dans le volet graphique ou dans le volet texte.</span><span class="sxs-lookup"><span data-stu-id="62174-106">You can work in either the graphical pane or the text pane.</span></span> <span data-ttu-id="62174-107">Le générateur de requêtes synchronise les vues de manière à ce qu'elles soient toujours actualisées.</span><span class="sxs-lookup"><span data-stu-id="62174-107">Query Builder synchronizes the views so that they are always current.</span></span>  
  
-   <span data-ttu-id="62174-108">**Jointure de tables associées** Si vous ajoutez plusieurs tables à votre requête, le générateur de requêtes détermine automatiquement la manière dont les tables sont associées et construit la commande de jointure appropriée.</span><span class="sxs-lookup"><span data-stu-id="62174-108">**Joining related tables** If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="62174-109">**Requête ou mise à jour de bases de données** Vous pouvez utiliser le générateur de requêtes pour renvoyer des données à l’aide d’instructions Transact-SQL SELECT et pour créer des requêtes qui mettent à jour, ajoutent ou suppriment des enregistrements dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="62174-109">**Querying or updating databases** You can use Query Builder to return data by using Transact-SQL SELECT statements and to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="62174-110">**Affichage et modification immédiate des résultats** Vous pouvez exécuter votre requête et travailler avec un jeu d'enregistrements dans une grille qui vous permet de faire défiler et de modifier les enregistrements de la base de données.</span><span class="sxs-lookup"><span data-stu-id="62174-110">**Viewing and editing results immediately** You can run your query and work with a recordset in a grid that allows you to scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="62174-111">Les outils graphiques de la boîte de dialogue **Générateur de requêtes** permettent de créer des requêtes par glisser-déplacer.</span><span class="sxs-lookup"><span data-stu-id="62174-111">The graphical tools in the **Query Builder** dialog box let you construct queries using drag-and-drop operations.</span></span> <span data-ttu-id="62174-112">Par défaut, la boîte de dialogue Générateur de requêtes crée des requêtes SELECT, mais vous pouvez également générer des requêtes INSERT, UPDATE ou DELETE.</span><span class="sxs-lookup"><span data-stu-id="62174-112">By default, the Query Builder dialog box constructs SELECT queries, but you can also build INSERT, UPDATE, or DELETE queries.</span></span> <span data-ttu-id="62174-113">Tous les types d'instructions SQL peuvent être analysés et exécutés dans la boîte de dialogue **Générateur de requêtes** .</span><span class="sxs-lookup"><span data-stu-id="62174-113">All types of SQL statements can be parsed and run in the **Query Builder** dialog box.</span></span> <span data-ttu-id="62174-114">Pour plus d’informations sur les instructions SQL dans les packages, consultez [Requêtes Integration Services &#40;SSIS&#41;](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="62174-114">For more information about SQL statements in packages, see [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="62174-115">Pour en savoir plus sur le langage Transact-SQL et sa syntaxe, consultez [Référence Transact-SQL &#40;moteur de base de données&#41;](/sql/t-sql/language-reference).</span><span class="sxs-lookup"><span data-stu-id="62174-115">To learn more about the Transact-SQL language and its syntax, see [Transact-SQL Reference &#40;Database Engine&#41;](/sql/t-sql/language-reference).</span></span>  
  
 <span data-ttu-id="62174-116">Vous pouvez aussi utiliser des variables dans une requête pour fournir des valeurs à un paramètre d'entrée, pour capturer les valeurs des paramètres de sortie et pour stocker des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="62174-116">You can also use variables in a query to provide values to an input parameter, to capture values of output parameters, and to store return codes.</span></span> <span data-ttu-id="62174-117">Pour en savoir plus sur l’utilisation de variables dans les requêtes utilisées par les packages, consultez [Tâche d’exécution de requêtes SQL](control-flow/execute-sql-task.md), [Source OLE DB](data-flow/ole-db-source.md)et [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="62174-117">To learn more about using variables in the queries that packages use, see [Execute SQL Task](control-flow/execute-sql-task.md), [OLE DB Source](data-flow/ole-db-source.md), and [Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md).</span></span> <span data-ttu-id="62174-118">Pour en savoir plus sur l’utilisation de variables dans la tâche d’exécution de requêtes SQL, consultez [Paramètres et codes de retour dans la tâche d’exécution SQL](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) et [Ensembles de résultats dans la tâche d’exécution SQL](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="62174-118">To learn more about using variables in the Execute SQL Task, see [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md) and [Result Sets in the Execute SQL Task](../../2014/integration-services/result-sets-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="62174-119">Les transformations de recherche et de recherche floue peuvent aussi utiliser des variables avec des paramètres et des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="62174-119">The Lookup and Fuzzy lookup transformations can also use variables with parameters and return codes.</span></span> <span data-ttu-id="62174-120">Les informations relatives à la source OLE DB s'appliquent également à ces deux transformations.</span><span class="sxs-lookup"><span data-stu-id="62174-120">The information about the OLE DB source applies to these two transformations also.</span></span>  
  
## <a name="options"></a><span data-ttu-id="62174-121">Options</span><span class="sxs-lookup"><span data-stu-id="62174-121">Options</span></span>  
 <span data-ttu-id="62174-122">**Barre d’outils**</span><span class="sxs-lookup"><span data-stu-id="62174-122">**Toolbar**</span></span>  
 <span data-ttu-id="62174-123">Utilisez la barre d'outils pour gérer les datasets, sélectionner les volets à afficher et contrôler les fonctions de requête.</span><span class="sxs-lookup"><span data-stu-id="62174-123">Use the toolbar to manage datasets, select panes to display, and control query functions.</span></span>  
  
|<span data-ttu-id="62174-124">Valeur</span><span class="sxs-lookup"><span data-stu-id="62174-124">Value</span></span>|<span data-ttu-id="62174-125">Description</span><span class="sxs-lookup"><span data-stu-id="62174-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="62174-126">**Afficher/Masquer le volet Diagramme**</span><span class="sxs-lookup"><span data-stu-id="62174-126">**Show/Hide Diagram Pane**</span></span>|<span data-ttu-id="62174-127">Affiche ou masque le volet **Diagramme** .</span><span class="sxs-lookup"><span data-stu-id="62174-127">Shows or hides the **Diagram** pane.</span></span>|  
|<span data-ttu-id="62174-128">**Afficher/Masquer le volet Grille**</span><span class="sxs-lookup"><span data-stu-id="62174-128">**Show/Hide Grid Pane**</span></span>|<span data-ttu-id="62174-129">Affiche ou masque le volet **Grille** .</span><span class="sxs-lookup"><span data-stu-id="62174-129">Shows or hides the **Grid** pane.</span></span>|  
|<span data-ttu-id="62174-130">**Afficher/Masquer le volet SQL**</span><span class="sxs-lookup"><span data-stu-id="62174-130">**Show/Hide SQL Pane**</span></span>|<span data-ttu-id="62174-131">Affiche ou masque le volet **SQL** .</span><span class="sxs-lookup"><span data-stu-id="62174-131">Shows or hides the **SQL** pane.</span></span>|  
|<span data-ttu-id="62174-132">**Afficher/Masquer le volet Résultats**</span><span class="sxs-lookup"><span data-stu-id="62174-132">**Show/Hide Results Pane**</span></span>|<span data-ttu-id="62174-133">Affiche ou masque le volet **Résultats** .</span><span class="sxs-lookup"><span data-stu-id="62174-133">Shows or hides the **Results** pane.</span></span>|  
|<span data-ttu-id="62174-134">**Exécuter**</span><span class="sxs-lookup"><span data-stu-id="62174-134">**Run**</span></span>|<span data-ttu-id="62174-135">Exécute la requête.</span><span class="sxs-lookup"><span data-stu-id="62174-135">Runs the query.</span></span> <span data-ttu-id="62174-136">Les résultats s'affichent dans le volet Résultats.</span><span class="sxs-lookup"><span data-stu-id="62174-136">Results are displayed in the result pane.</span></span>|  
|<span data-ttu-id="62174-137">**Vérifier SQL**</span><span class="sxs-lookup"><span data-stu-id="62174-137">**Verify SQL**</span></span>|<span data-ttu-id="62174-138">Vérifie que l'instruction SQL est valide.</span><span class="sxs-lookup"><span data-stu-id="62174-138">Verifies that the SQL statement is valid.</span></span>|  
|<span data-ttu-id="62174-139">**Tri croissant**</span><span class="sxs-lookup"><span data-stu-id="62174-139">**Sort Ascending**</span></span>|<span data-ttu-id="62174-140">Trie dans l'ordre croissant les lignes de sortie sur la colonne sélectionnée du volet de la grille.</span><span class="sxs-lookup"><span data-stu-id="62174-140">Sorts output rows on the selected column in the grid pane, in ascending order.</span></span>|  
|<span data-ttu-id="62174-141">**Tri décroissant**</span><span class="sxs-lookup"><span data-stu-id="62174-141">**Sort Descending**</span></span>|<span data-ttu-id="62174-142">Trie dans l'ordre décroissant les lignes de sortie sur la colonne sélectionnée du volet de la grille.</span><span class="sxs-lookup"><span data-stu-id="62174-142">Sorts output rows on the selected column in the grid pane, in descending order.</span></span>|  
|<span data-ttu-id="62174-143">**Supprimer le filtre**</span><span class="sxs-lookup"><span data-stu-id="62174-143">**Remove Filter**</span></span>|<span data-ttu-id="62174-144">Sélectionnez le nom d'une colonne dans le volet de la grille, puis choisissez **Supprimer le filtre** pour supprimer les critères de tri de la colonne.</span><span class="sxs-lookup"><span data-stu-id="62174-144">Select a column name in the grid pane, and then click **Remove Filter** to remove sort criteria for the column.</span></span>|  
|<span data-ttu-id="62174-145">**Utiliser GROUP BY**</span><span class="sxs-lookup"><span data-stu-id="62174-145">**Use Group By**</span></span>|<span data-ttu-id="62174-146">Ajoute la fonctionnalité GROUP BY à la requête.</span><span class="sxs-lookup"><span data-stu-id="62174-146">Adds GROUP BY functionality to the query.</span></span>|  
|<span data-ttu-id="62174-147">**Ajouter une table**</span><span class="sxs-lookup"><span data-stu-id="62174-147">**Add Table**</span></span>|<span data-ttu-id="62174-148">Ajoute une table à la requête.</span><span class="sxs-lookup"><span data-stu-id="62174-148">Adds a new table to the query.</span></span>|  
  
 <span data-ttu-id="62174-149">**Définition de la requête**</span><span class="sxs-lookup"><span data-stu-id="62174-149">**Query Definition**</span></span>  
 <span data-ttu-id="62174-150">La définition de la requête fournit une barre d'outils et des volets dans lesquels définir et tester la requête.</span><span class="sxs-lookup"><span data-stu-id="62174-150">The query definition provides a toolbar and panes in which to define and test the query.</span></span>  
  
|<span data-ttu-id="62174-151">Volet</span><span class="sxs-lookup"><span data-stu-id="62174-151">Pane</span></span>|<span data-ttu-id="62174-152">Description</span><span class="sxs-lookup"><span data-stu-id="62174-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="62174-153">Volet **schéma**</span><span class="sxs-lookup"><span data-stu-id="62174-153">**Diagram** pane</span></span>|<span data-ttu-id="62174-154">Affiche la requête dans un diagramme.</span><span class="sxs-lookup"><span data-stu-id="62174-154">Displays the query in a diagram.</span></span> <span data-ttu-id="62174-155">Le diagramme illustre les tables contenues dans la requête et leur mode de jointure.</span><span class="sxs-lookup"><span data-stu-id="62174-155">The diagram shows the tables included in the query, and how they are joined.</span></span> <span data-ttu-id="62174-156">Activez ou désactivez la case à cocher correspondant à une colonne de la table pour l'ajouter ou la supprimer du résultat de la requête.</span><span class="sxs-lookup"><span data-stu-id="62174-156">Select or clear the check box next to a column in a table to add or remove it from the query output.</span></span><br /><br /> <span data-ttu-id="62174-157">Lorsque vous ajoutez des tables à la requête, le Générateur de requêtes crée des jointures entre les tables basées sur les tables, en fonction des clés de la table.</span><span class="sxs-lookup"><span data-stu-id="62174-157">When you add tables to the query, Query Builder creates joins between tables based on tables, depending on the keys in the table.</span></span> <span data-ttu-id="62174-158">Pour ajouter une jointure, faites glisser le champ d'une table vers un champ situé dans une autre table.</span><span class="sxs-lookup"><span data-stu-id="62174-158">To add a join, drag a field from one table onto a field in another table.</span></span> <span data-ttu-id="62174-159">Pour gérer une jointure, cliquez dessus avec le bouton droit, puis sélectionnez une option du menu.</span><span class="sxs-lookup"><span data-stu-id="62174-159">To manage a join, right-click the join, and then select a menu option.</span></span><br /><br /> <span data-ttu-id="62174-160">Cliquez avec le bouton droit sur le volet **diagramme** pour ajouter ou supprimer des tables, sélectionner toutes les tables et afficher ou masquer des volets.</span><span class="sxs-lookup"><span data-stu-id="62174-160">Right-click the **Diagram** pane to add or remove tables, select all the tables, and show or hide panes.</span></span>|  
|<span data-ttu-id="62174-161">Volet **grille**</span><span class="sxs-lookup"><span data-stu-id="62174-161">**Grid** pane</span></span>|<span data-ttu-id="62174-162">Affiche la requête dans une grille.</span><span class="sxs-lookup"><span data-stu-id="62174-162">Displays the query in a grid.</span></span> <span data-ttu-id="62174-163">Vous pouvez utiliser ce volet pour ajouter et supprimer des colonnes dans la requête et modifier les paramètres de chaque colonne.</span><span class="sxs-lookup"><span data-stu-id="62174-163">You can use this pane to add to and remove columns from the query and change the settings for each column.</span></span>|  
|<span data-ttu-id="62174-164">Volet **SQL**</span><span class="sxs-lookup"><span data-stu-id="62174-164">**SQL** pane</span></span>|<span data-ttu-id="62174-165">Affiche la requête sous forme de texte SQL.</span><span class="sxs-lookup"><span data-stu-id="62174-165">Displays the query as SQL text.</span></span> <span data-ttu-id="62174-166">Les modifications effectuées dans le volet **Diagramme** et le volet **Grille** sont affichées ici et les modifications apportées ici sont affichées dans les volets **Diagramme** et **Grille** .</span><span class="sxs-lookup"><span data-stu-id="62174-166">Changes made in the **Diagram** pane and the **Grid** pane will appear here, and changes made here will appear in the **Diagram** pane and the **Grid** pane.</span></span>|  
|<span data-ttu-id="62174-167">Volet**Résultats**</span><span class="sxs-lookup"><span data-stu-id="62174-167">**Results** pane</span></span>|<span data-ttu-id="62174-168">Affiche les résultats de la requête lorsque vous cliquez sur **Exécuter** dans la barre d'outils.</span><span class="sxs-lookup"><span data-stu-id="62174-168">Displays the results of the query when you click **Run** on the toolbar.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="62174-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="62174-169">See Also</span></span>  
 <span data-ttu-id="62174-170">[Tâche d’exécution SQL](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="62174-170">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 <span data-ttu-id="62174-171">[Source OLE DB](data-flow/ole-db-source.md) </span><span class="sxs-lookup"><span data-stu-id="62174-171">[OLE DB Source](data-flow/ole-db-source.md) </span></span>  
 <span data-ttu-id="62174-172">[Destination OLE DB](data-flow/ole-db-destination.md) </span><span class="sxs-lookup"><span data-stu-id="62174-172">[OLE DB Destination](data-flow/ole-db-destination.md) </span></span>  
 <span data-ttu-id="62174-173">[Transformation de recherche](data-flow/transformations/lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="62174-173">[Lookup Transformation](data-flow/transformations/lookup-transformation.md) </span></span>  
 <span data-ttu-id="62174-174">[Integration Services &#40;requêtes de&#41; SSIS](integration-services-ssis-queries.md) </span><span class="sxs-lookup"><span data-stu-id="62174-174">[Integration Services &#40;SSIS&#41; Queries](integration-services-ssis-queries.md) </span></span>  
 [<span data-ttu-id="62174-175">MERGE dans les packages Integration Services</span><span class="sxs-lookup"><span data-stu-id="62174-175">MERGE in Integration Services Packages</span></span>](control-flow/merge-in-integration-services-packages.md)  
  
  
