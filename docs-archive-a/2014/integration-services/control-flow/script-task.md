---
title: Script, tâche | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scripttask.f1
helpviewer_keywords:
- scripts [Integration Services], tasks
- Script task [Integration Services], about Script task
- Script task [Integration Services]
ms.assetid: f6cce7df-4bd6-4b75-9f89-6c37b4bb5558
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 69c051994eb06cbab041db3db2683a487a6e1994
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600181"
---
# <a name="script-task"></a><span data-ttu-id="07422-102">Tâche de script</span><span class="sxs-lookup"><span data-stu-id="07422-102">Script Task</span></span>
  <span data-ttu-id="07422-103">La tâche de script fournit du code permettant d’exécuter des fonctions qui ne sont pas disponibles dans les tâches et transformations intégrées de [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="07422-103">The Script task provides code to perform functions that are not available in the built-in tasks and transformations that [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span> <span data-ttu-id="07422-104">La tâche de script peut également combiner des fonctions dans un même script au lieu d'utiliser plusieurs tâches et transformations.</span><span class="sxs-lookup"><span data-stu-id="07422-104">The Script task can also combine functions in one script instead of using multiple tasks and transformations.</span></span> <span data-ttu-id="07422-105">Utilisez la tâche de script pour le travail devant être effectué une fois dans un package (ou une fois par objet énuméré), et non une fois par ligne de données.</span><span class="sxs-lookup"><span data-stu-id="07422-105">You use the Script task for work that must be done once in a package (or once per enumerated object), instead than once per data row.</span></span>  
  
 <span data-ttu-id="07422-106">Vous pouvez utiliser la tâche de script aux fins suivantes :</span><span class="sxs-lookup"><span data-stu-id="07422-106">You can use the Script task for the following purposes:</span></span>  
  
-   <span data-ttu-id="07422-107">Accéder aux données à l'aide d'autres technologies non prises en charge par les types de connexion intégrés.</span><span class="sxs-lookup"><span data-stu-id="07422-107">Access data by using other technologies that are not supported by built-in connection types.</span></span> <span data-ttu-id="07422-108">Par exemple, un script peut utiliser des interfaces ADSI (Active Directory Service Interfaces) pour accéder aux noms d'utilisateur et les extraire d'Active Directory.</span><span class="sxs-lookup"><span data-stu-id="07422-108">For example, a script can use Active Directory Service Interfaces (ADSI) to access and extract user names from Active Directory.</span></span>  
  
-   <span data-ttu-id="07422-109">Créer un compteur de performances spécifique au package.</span><span class="sxs-lookup"><span data-stu-id="07422-109">Create a package-specific performance counter.</span></span> <span data-ttu-id="07422-110">Par exemple, un script peut créer un compteur de performances mis à jour pendant l'exécution d'une tâche complexe ou peu performante.</span><span class="sxs-lookup"><span data-stu-id="07422-110">For example, a script can create a performance counter that is updated while a complex or poorly performing task runs.</span></span>  
  
-   <span data-ttu-id="07422-111">Déterminez si les fichiers spécifiés sont vides ou combien de lignes ils contiennent, puis en fonction de ces informations, affectez le flux de contrôle dans un package.</span><span class="sxs-lookup"><span data-stu-id="07422-111">Identify whether specified files are empty or how many rows they contain, and then based on that information affect the control flow in a package.</span></span> <span data-ttu-id="07422-112">Par exemple, si un fichier ne contient aucune ligne, la valeur 0 d'une variable et une contrainte de précédence qui évalue la valeur empêchent une tâche de système de fichiers de copier le fichier.</span><span class="sxs-lookup"><span data-stu-id="07422-112">For example, if a file contains zero rows, the value of a variable set to 0, and a precedence constraint that evaluates the value prevents a File System task from copying the file.</span></span>  
  
 <span data-ttu-id="07422-113">Si vous devez utiliser le script afin d'effectuer le même travail pour chaque ligne de données d'un ensemble, vous devriez utiliser le composant Script à la place de la tâche de script.</span><span class="sxs-lookup"><span data-stu-id="07422-113">If you have to use the script to do the same work for each row of data in a set, you should use the Script component instead of the Script task.</span></span> <span data-ttu-id="07422-114">Par exemple, si vous souhaitez évaluer un montant de frais de port raisonnable et ignorer les lignes de données présentant des montants extrêmement élevés ou bas, il convient d'utiliser un composant Script.</span><span class="sxs-lookup"><span data-stu-id="07422-114">For example, if you want to assess the reasonableness of a postage amount and skip data rows that have very high or low amounts, you would use a Script component.</span></span> <span data-ttu-id="07422-115">Pour plus d’informations, voir [Script Component](../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="07422-115">For more information, see [Script Component](../data-flow/transformations/script-component.md).</span></span>  
  
 <span data-ttu-id="07422-116">Si plusieurs packages utilisent un script, envisagez l'écriture d'une tâche personnalisée plutôt que de recourir à la tâche de script.</span><span class="sxs-lookup"><span data-stu-id="07422-116">If more than one package uses a script, consider writing a custom task instead of using the Script task.</span></span> <span data-ttu-id="07422-117">Pour plus d’informations, consultez [Développement d’une tâche personnalisée](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span><span class="sxs-lookup"><span data-stu-id="07422-117">For more information, see [Developing a Custom Task](../extending-packages-custom-objects/task/developing-a-custom-task.md).</span></span>  
  
 <span data-ttu-id="07422-118">Si vous choisissez la tâche de script pour votre package, vous devez développer le script utilisé par la tâche et configurer cette dernière.</span><span class="sxs-lookup"><span data-stu-id="07422-118">After you decide that the Script task is the appropriate choice for your package, you have to both develop the script that the task uses and configure the task itself.</span></span>  
  
## <a name="writing-and-running-the-script-that-the-task-uses"></a><span data-ttu-id="07422-119">Écriture et exécution du script utilisé par la tâche</span><span class="sxs-lookup"><span data-stu-id="07422-119">Writing and Running the Script that the Task Uses</span></span>  
 <span data-ttu-id="07422-120">La tâche de script utilise [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) comme environnement d’écriture des scripts et moteur d’exécution de ces derniers.</span><span class="sxs-lookup"><span data-stu-id="07422-120">The Script task uses [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts and the engine that runs those scripts.</span></span>  
  
 <span data-ttu-id="07422-121">VSTA fournit l’ensemble des fonctionnalités standard de l’environnement [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] , telles que l’éditeur [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] à code de couleur, IntelliSense et **l’Explorateur d’objets**.</span><span class="sxs-lookup"><span data-stu-id="07422-121">VSTA provides all the standard features of the [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] editor, IntelliSense, and **Object Explorer**.</span></span> <span data-ttu-id="07422-122">VSTA utilise également le même débogueur que les autres outils de développement [!INCLUDE[msCoName](../../includes/msconame-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="07422-122">VSTA also uses the same debugger that other [!INCLUDE[msCoName](../../includes/msconame-md.md)] development tools use.</span></span> <span data-ttu-id="07422-123">Les points d'arrêt dans le script fonctionnent de façon transparente avec ceux des tâches et des conteneurs [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="07422-123">Breakpoints in the script work seamlessly with breakpoints on [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] tasks and containers.</span></span> <span data-ttu-id="07422-124">VSTA prend en charge les langages de programmation [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic et [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C#.</span><span class="sxs-lookup"><span data-stu-id="07422-124">VSTA supports both the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual Basic and [!INCLUDE[msCoName](../../includes/msconame-md.md)] Visual C# programming languages.</span></span>  
  
 <span data-ttu-id="07422-125">Vous ne pouvez lancer un script que si VSTA est installé sur l'ordinateur où le package est exécuté.</span><span class="sxs-lookup"><span data-stu-id="07422-125">To run a script, you must have VSTA installed on the computer where the package runs.</span></span> <span data-ttu-id="07422-126">Lorsque le package s'exécute, la tâche charge le moteur de script puis exécute le script.</span><span class="sxs-lookup"><span data-stu-id="07422-126">When the package runs, the task loads the script engine and runs the script.</span></span> <span data-ttu-id="07422-127">Vous pouvez accéder aux assemblys .NET externes dans les scripts en ajoutant des références aux assemblys du projet.</span><span class="sxs-lookup"><span data-stu-id="07422-127">You can access external .NET assemblies in scripts by adding references to the assemblies in the project.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="07422-128">Contrairement aux versions antérieures pour lesquelles il était possible d’indiquer si les scripts étaient précompilés, tous les scripts de [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] et des versions ultérieures sont précompilés.</span><span class="sxs-lookup"><span data-stu-id="07422-128">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="07422-129">Lorsqu'un script est précompilé, le moteur de langage n'est pas chargé au moment de l'exécution et le package s'exécute plus rapidement.</span><span class="sxs-lookup"><span data-stu-id="07422-129">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="07422-130">Toutefois, les fichiers binaires précompilés occupent un espace disque important.</span><span class="sxs-lookup"><span data-stu-id="07422-130">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-task"></a><span data-ttu-id="07422-131">Configuration de la tâche de script</span><span class="sxs-lookup"><span data-stu-id="07422-131">Configuring the Script Task</span></span>  
 <span data-ttu-id="07422-132">Vous pouvez configurer la tâche de script comme suit :</span><span class="sxs-lookup"><span data-stu-id="07422-132">You can configure the Script task in the following ways:</span></span>  
  
-   <span data-ttu-id="07422-133">Fournissez le script personnalisé que la tâche exécute.</span><span class="sxs-lookup"><span data-stu-id="07422-133">Provide the custom script that the task runs.</span></span>  
  
-   <span data-ttu-id="07422-134">Spécifiez la méthode dans le projet VSTA utilisée au moment de l’exécution de [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] comme point d’entrée du code de tâche de script.</span><span class="sxs-lookup"><span data-stu-id="07422-134">Specify the method in the VSTA project that the [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] runtime calls as the entry point into the Script task code.</span></span>  
  
-   <span data-ttu-id="07422-135">Spécifiez le langage de script</span><span class="sxs-lookup"><span data-stu-id="07422-135">Specify the script language.</span></span>  
  
-   <span data-ttu-id="07422-136">Éventuellement, fournissez les listes des variables en lecture seule et en lecture/écriture à utiliser dans le script.</span><span class="sxs-lookup"><span data-stu-id="07422-136">Optionally, provide lists of read-only and read/write variables for use in the script.</span></span>  
  
 <span data-ttu-id="07422-137">Vous pouvez définir ces propriétés via le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] ou par programme.</span><span class="sxs-lookup"><span data-stu-id="07422-137">You can set these properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-task-in-the-designer"></a><span data-ttu-id="07422-138">Configuration de la tâche de script dans le concepteur</span><span class="sxs-lookup"><span data-stu-id="07422-138">Configuring the Script Task in the Designer</span></span>  
 <span data-ttu-id="07422-139">Le tableau suivant décrit l'événement `ScriptTaskLogEntry` pouvant être consigné pour la tâche de script.</span><span class="sxs-lookup"><span data-stu-id="07422-139">The following table describes the `ScriptTaskLogEntry` event that can be logged for Script task.</span></span> <span data-ttu-id="07422-140">L' `ScriptTaskLogEntry` événement est sélectionné pour la journalisation sous l’onglet **Détails** de la boîte de dialogue **configurer les journaux SSIS** .</span><span class="sxs-lookup"><span data-stu-id="07422-140">The `ScriptTaskLogEntry` event is selected for logging on the **Details** tab of the **Configure SSIS Logs** dialog box.</span></span> <span data-ttu-id="07422-141">Pour plus d’informations, consultez [Journalisation d’Integration Services &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) et [Messages personnalisés pour la journalisation](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="07422-141">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="07422-142">Entrée du journal</span><span class="sxs-lookup"><span data-stu-id="07422-142">Log entry</span></span>|<span data-ttu-id="07422-143">Description</span><span class="sxs-lookup"><span data-stu-id="07422-143">Description</span></span>|  
|---------------|-----------------|  
|`ScriptTaskLogEntry`|<span data-ttu-id="07422-144">Indique les résultats de l'implémentation de la journalisation dans le script.</span><span class="sxs-lookup"><span data-stu-id="07422-144">Reports the results of implementing logging in the script.</span></span> <span data-ttu-id="07422-145">La tâche écrit une entrée de journal pour chaque appel de la méthode `Log` de l'objet `Dts`.</span><span class="sxs-lookup"><span data-stu-id="07422-145">The task writes a log entry for each call to the `Log` method of the `Dts` object.</span></span> <span data-ttu-id="07422-146">La tâche écrit ces entrées lorsque le code est exécuté.</span><span class="sxs-lookup"><span data-stu-id="07422-146">The task writes these entries when the code is run.</span></span> <span data-ttu-id="07422-147">Pour plus d’informations, consultez [Journalisation dans la tâche de script](../extending-packages-scripting/task/logging-in-the-script-task.md).</span><span class="sxs-lookup"><span data-stu-id="07422-147">For more information, see [Logging in the Script Task](../extending-packages-scripting/task/logging-in-the-script-task.md).</span></span>|  
  
 <span data-ttu-id="07422-148">Pour plus d'informations sur les propriétés définissables dans le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="07422-148">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topics:</span></span>  
  
-   [<span data-ttu-id="07422-149">Éditeur de tâche de script &#40;page Général&#41;</span><span class="sxs-lookup"><span data-stu-id="07422-149">Script Task Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="07422-150">Éditeur de tâche de script &#40;page Script&#41;</span><span class="sxs-lookup"><span data-stu-id="07422-150">Script Task Editor &#40;Script Page&#41;</span></span>](../script-task-editor-script-page.md)  
  
-   [<span data-ttu-id="07422-151">Page Expressions</span><span class="sxs-lookup"><span data-stu-id="07422-151">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="07422-152">Pour plus d’informations sur la définition de ces propriétés dans le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , consultez la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="07422-152">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, see the following topic:</span></span>  
  
-   [<span data-ttu-id="07422-153">Définir les propriétés d'une tâche ou d'un conteneur</span><span class="sxs-lookup"><span data-stu-id="07422-153">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
### <a name="configuring-the-script-task-programmatically"></a><span data-ttu-id="07422-154">Configuration par programme de la tâche de script</span><span class="sxs-lookup"><span data-stu-id="07422-154">Configuring the Script Task Programmatically</span></span>  
 <span data-ttu-id="07422-155">Pour plus d’informations sur la définition par programmation de ces propriétés, consultez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="07422-155">For more information about programmatically setting these properties, see the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ScriptTask.ScriptTask>  
  
## <a name="related-content"></a><span data-ttu-id="07422-156">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="07422-156">Related Content</span></span>  
  
-   <span data-ttu-id="07422-157">Article technique [Procédure d'envoi de courrier électronique avec notification de remise en C#](https://go.microsoft.com/fwlink/?LinkId=237625)(Procédure d’envoi d’e-mail avec notification de remise en C#) sur shareourideas.com</span><span class="sxs-lookup"><span data-stu-id="07422-157">Technical article, [How to send email with delivery notification in C#](https://go.microsoft.com/fwlink/?LinkId=237625), on shareourideas.com</span></span>  
  
  
