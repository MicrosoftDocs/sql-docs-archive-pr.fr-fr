---
title: Exécuter des requêtes SQL, tâche | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.executesqltask.f1
helpviewer_keywords:
- Transact-SQL statements, SSIS
- statements [Integration Services]
- batches [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: bebb2e8c-0410-43b2-ac2f-6fc80c8f2e9e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: e77b9f442ae8478c57d5b0e68955b541eda38aff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87697068"
---
# <a name="execute-sql-task"></a><span data-ttu-id="64f3c-102">Tâche d’exécution de requêtes SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-102">Execute SQL Task</span></span>
  <span data-ttu-id="64f3c-103">La tâche d'exécution SQL exécute des instructions ou des procédures stockées SQL à partir d'un package.</span><span class="sxs-lookup"><span data-stu-id="64f3c-103">The Execute SQL task runs SQL statements or stored procedures from a package.</span></span> <span data-ttu-id="64f3c-104">La tâche peut contenir une seule ou plusieurs instructions SQL s'exécutant de façon séquentielle.</span><span class="sxs-lookup"><span data-stu-id="64f3c-104">The task can contain either a single SQL statement or multiple SQL statements that run sequentially.</span></span> <span data-ttu-id="64f3c-105">Vous pouvez utiliser la tâche d'exécution SQL aux fins suivantes :</span><span class="sxs-lookup"><span data-stu-id="64f3c-105">You can use the Execute SQL task for the following purposes:</span></span>  
  
-   <span data-ttu-id="64f3c-106">Tronquer une table ou une vue pour la préparer à l'insertion de données.</span><span class="sxs-lookup"><span data-stu-id="64f3c-106">Truncate a table or view in preparation for inserting data.</span></span>  
  
-   <span data-ttu-id="64f3c-107">Créer, modifier et supprimer des objets de base de données tels que des tables et des vues.</span><span class="sxs-lookup"><span data-stu-id="64f3c-107">Create, alter, and drop database objects such as tables and views.</span></span>  
  
-   <span data-ttu-id="64f3c-108">Recréer des tables de faits et de dimension avant d'y charger des données.</span><span class="sxs-lookup"><span data-stu-id="64f3c-108">Re-create fact and dimension tables before loading data into them.</span></span>  
  
-   <span data-ttu-id="64f3c-109">Exécuter des procédures stockées.</span><span class="sxs-lookup"><span data-stu-id="64f3c-109">Run stored procedures.</span></span> <span data-ttu-id="64f3c-110">Si l'instruction SQL appelle une procédure stockée qui retourne des résultats à partir d'une table temporaire, utilisez l'option WITH RESULT SETS afin de définir les métadonnées du jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="64f3c-110">If the SQL statement invokes a stored procedure that returns results from a temporary table, use the WITH RESULT SETS option to define metadata for the result set.</span></span>  
  
-   <span data-ttu-id="64f3c-111">Enregistrer dans une variable l'ensemble de lignes retourné par une requête.</span><span class="sxs-lookup"><span data-stu-id="64f3c-111">Save the rowset returned from a query into a variable.</span></span>  
  
 <span data-ttu-id="64f3c-112">Vous pouvez combiner la tâche d'exécution SQL et les conteneurs de boucles Foreach et For pour exécuter plusieurs instructions SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-112">The Execute SQL task can be used in combination with the Foreach Loop and For Loop containers to run multiple SQL statements.</span></span> <span data-ttu-id="64f3c-113">Ces conteneurs mettent en œuvre des flux de contrôle répétitifs dans un package et peuvent exécuter la tâche d'exécution SQL de façon répétée.</span><span class="sxs-lookup"><span data-stu-id="64f3c-113">These containers implement repeating control flows in a package and they can run the Execute SQL task repeatedly.</span></span> <span data-ttu-id="64f3c-114">Par exemple, à l'aide du conteneur de boucles Foreach, un package peut passer en revue les fichiers d'un dossier et exécuter une tâche d'exécution SQL de façon répétée afin d'exécuter l'instruction SQL stockée dans chaque fichier.</span><span class="sxs-lookup"><span data-stu-id="64f3c-114">For example, using the Foreach Loop container, a package can enumerate files in a folder and run an Execute SQL task repeatedly to execute the SQL statement stored in each file.</span></span>  
  
## <a name="connecting-to-a-data-source"></a><span data-ttu-id="64f3c-115">Connexion à une source de données</span><span class="sxs-lookup"><span data-stu-id="64f3c-115">Connecting to a Data Source</span></span>  
 <span data-ttu-id="64f3c-116">La tâche d'exécution SQL peut utiliser différents types de gestionnaires de connexions pour se connecter à la source de données dans laquelle elle exécute l'instruction ou la procédure stockée SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-116">The Execute SQL task can use different types of connection managers to connect to the data source where it runs the SQL statement or stored procedure.</span></span> <span data-ttu-id="64f3c-117">La tâche peut utiliser les types de connexion décrits dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="64f3c-117">The task can use the connection types listed in the following table.</span></span>  
  
|<span data-ttu-id="64f3c-118">Type de connexion</span><span class="sxs-lookup"><span data-stu-id="64f3c-118">Connection type</span></span>|<span data-ttu-id="64f3c-119">Gestionnaire de connexions</span><span class="sxs-lookup"><span data-stu-id="64f3c-119">Connection manager</span></span>|  
|---------------------|------------------------|  
|<span data-ttu-id="64f3c-120">EXCEL</span><span class="sxs-lookup"><span data-stu-id="64f3c-120">EXCEL</span></span>|[<span data-ttu-id="64f3c-121">Gestionnaire de connexions Excel</span><span class="sxs-lookup"><span data-stu-id="64f3c-121">Excel Connection Manager</span></span>](../connection-manager/excel-connection-manager.md)|  
|<span data-ttu-id="64f3c-122">OLE DB</span><span class="sxs-lookup"><span data-stu-id="64f3c-122">OLE DB</span></span>|[<span data-ttu-id="64f3c-123">Gestionnaire de connexions OLE DB</span><span class="sxs-lookup"><span data-stu-id="64f3c-123">OLE DB Connection Manager</span></span>](../connection-manager/ole-db-connection-manager.md)|  
|<span data-ttu-id="64f3c-124">ODBC</span><span class="sxs-lookup"><span data-stu-id="64f3c-124">ODBC</span></span>|[<span data-ttu-id="64f3c-125">Gestionnaire de connexions ODBC</span><span class="sxs-lookup"><span data-stu-id="64f3c-125">ODBC Connection Manager</span></span>](../connection-manager/odbc-connection-manager.md)|  
|<span data-ttu-id="64f3c-126">ADO</span><span class="sxs-lookup"><span data-stu-id="64f3c-126">ADO</span></span>|[<span data-ttu-id="64f3c-127">Gestionnaire de connexions ADO</span><span class="sxs-lookup"><span data-stu-id="64f3c-127">ADO Connection Manager</span></span>](../connection-manager/ado-connection-manager.md)|  
|<span data-ttu-id="64f3c-128">ADO.NET</span><span class="sxs-lookup"><span data-stu-id="64f3c-128">ADO.NET</span></span>|[<span data-ttu-id="64f3c-129">Gestionnaire de connexions ADO.NET</span><span class="sxs-lookup"><span data-stu-id="64f3c-129">ADO.NET Connection Manager</span></span>](../connection-manager/ado-net-connection-manager.md)|  
|<span data-ttu-id="64f3c-130">SQLMOBILE</span><span class="sxs-lookup"><span data-stu-id="64f3c-130">SQLMOBILE</span></span>|[<span data-ttu-id="64f3c-131">Gestionnaire de connexions de SQL Server Compact Edition</span><span class="sxs-lookup"><span data-stu-id="64f3c-131">SQL Server Compact Edition Connection Manager</span></span>](../connection-manager/sql-server-compact-edition-connection-manager.md)|  
  
## <a name="creating-sql-statements"></a><span data-ttu-id="64f3c-132">Création d'instructions SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-132">Creating SQL Statements</span></span>  
 <span data-ttu-id="64f3c-133">La source des instructions SQL utilisée par cette tâche peut être une propriété de tâche contenant une instruction, une connexion à un fichier contenant une ou plusieurs instructions ou le nom d'une variable contenant une instruction.</span><span class="sxs-lookup"><span data-stu-id="64f3c-133">The source of the SQL statements used by this task can be a task property that contains a statement, a connection to a file that contains one or multiple statements, or the name of a variable that contains a statement.</span></span> <span data-ttu-id="64f3c-134">Les instructions SQL doivent être écrites dans le langage du système de gestion de bases de données (SGBD) source.</span><span class="sxs-lookup"><span data-stu-id="64f3c-134">The SQL statements must be written in the dialect of the source database management system (DBMS).</span></span> <span data-ttu-id="64f3c-135">Pour plus d’informations, consultez [Requêtes Integration Services &#40;SSIS&#41;](../integration-services-ssis-queries.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-135">For more information, see [Integration Services &#40;SSIS&#41; Queries](../integration-services-ssis-queries.md).</span></span>  
  
 <span data-ttu-id="64f3c-136">Si les instructions SQL sont stockées dans un fichier, la tâche utilise un gestionnaire de connexions de fichiers pour se connecter au fichier.</span><span class="sxs-lookup"><span data-stu-id="64f3c-136">If the SQL statements are stored in a file, the task uses a File connection manager to connect to the file.</span></span> <span data-ttu-id="64f3c-137">Pour plus d’informations, consultez [File Connection Manager](../connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-137">For more information, see [File Connection Manager](../connection-manager/file-connection-manager.md).</span></span>  
  
 <span data-ttu-id="64f3c-138">Dans le Concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , vous pouvez utiliser la boîte de dialogue **Éditeur de tâche d’exécution de requêtes SQL** pour taper des instructions SQL ou utiliser le **Générateur de requêtes**, une interface graphique utilisateur permettant de créer des requêtes SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-138">In [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, you can use the **Execute SQL Task Editor** dialog box to type SQL statements, or use **Query Builder**, a graphical user interface for creating SQL queries.</span></span> <span data-ttu-id="64f3c-139">Pour plus d’informations, consultez [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) et [Générateur de requêtes](../query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-139">For more information, see [Execute SQL Task Editor &#40;General Page&#41;](../execute-sql-task-editor-general-page.md) and [Query Builder](../query-builder.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64f3c-140">Les instructions SQL valides écrites en dehors de la tâche d'exécution SQL peuvent ne pas être analysées correctement par celle-ci.</span><span class="sxs-lookup"><span data-stu-id="64f3c-140">Valid SQL statements written outside the Execute SQL task may not be parsed successfully by the Execute SQL task.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64f3c-141">La tâche d'exécution SQL utilise la valeur d'énumération `RecognizeAll` ParseMode.</span><span class="sxs-lookup"><span data-stu-id="64f3c-141">The Execute SQL Task uses the `RecognizeAll` ParseMode enumeration value.</span></span> <span data-ttu-id="64f3c-142">Pour plus d’informations, consultez [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617)(Espace de noms ManagedBatchParser).</span><span class="sxs-lookup"><span data-stu-id="64f3c-142">For more information, see [ManagedBatchParser Namespace](https://go.microsoft.com/fwlink/?LinkId=223617).</span></span>  
  
## <a name="sending-multiple-statements-in-a-batch"></a><span data-ttu-id="64f3c-143">Envoi de plusieurs instructions dans un traitement</span><span class="sxs-lookup"><span data-stu-id="64f3c-143">Sending Multiple Statements in a Batch</span></span>  
 <span data-ttu-id="64f3c-144">Si vous incluez plusieurs instructions dans une tâche d'exécution SQL, vous pouvez les regrouper et les exécuter sous forme de traitement.</span><span class="sxs-lookup"><span data-stu-id="64f3c-144">If you include multiple statements in an Execute SQL task, you can group them and run them as a batch.</span></span> <span data-ttu-id="64f3c-145">Pour indiquer la fin d'un traitement, utilisez la commande GO.</span><span class="sxs-lookup"><span data-stu-id="64f3c-145">To signal the end of a batch, use the GO command.</span></span> <span data-ttu-id="64f3c-146">Toutes les instructions SQL comprises entre deux commandes GO sont envoyées dans un traitement au fournisseur OLE DB afin d'être exécutées.</span><span class="sxs-lookup"><span data-stu-id="64f3c-146">All the SQL statements between two GO commands are sent in a batch to the OLE DB provider to be run.</span></span> <span data-ttu-id="64f3c-147">La commande SQL peut comprendre plusieurs traitements séparés par des commandes GO.</span><span class="sxs-lookup"><span data-stu-id="64f3c-147">The SQL command can include multiple batches separated by GO commands.</span></span>  
  
 <span data-ttu-id="64f3c-148">Il existe des restrictions sur les types d'instructions SQL pouvant être regroupées dans un traitement.</span><span class="sxs-lookup"><span data-stu-id="64f3c-148">There are restrictions on the kinds of SQL statements that you can group in a batch.</span></span> <span data-ttu-id="64f3c-149">Pour plus d’informations, consultez [Lots d’instructions](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-149">For more information, see [Batches of Statements](../../relational-databases/native-client-odbc-queries/executing-statements/batches-of-statements.md).</span></span>  
  
 <span data-ttu-id="64f3c-150">Si la tâche d'exécution SQL exécute un traitement d'instructions SQL, les règles suivantes s'appliquent à celui-ci :</span><span class="sxs-lookup"><span data-stu-id="64f3c-150">If the Execute SQL task runs a batch of SQL statements, the following rules apply to the batch:</span></span>  
  
-   <span data-ttu-id="64f3c-151">Une seule instruction peut retourner un ensemble de résultats et il doit s'agir de la première instruction du traitement.</span><span class="sxs-lookup"><span data-stu-id="64f3c-151">Only one statement can return a result set and it must be the first statement in the batch.</span></span>  
  
-   <span data-ttu-id="64f3c-152">Si l'ensemble de résultats utilise des liaisons de résultats, les requêtes doivent retourner le même nombre de colonnes.</span><span class="sxs-lookup"><span data-stu-id="64f3c-152">If the result set uses result bindings, the queries must return the same number of columns.</span></span> <span data-ttu-id="64f3c-153">Si les requêtes retournent un nombre différent de colonnes, la tâche échoue.</span><span class="sxs-lookup"><span data-stu-id="64f3c-153">If the queries return a different number of columns, the task fails.</span></span> <span data-ttu-id="64f3c-154">Toutefois, même si la tâche échoue, les requêtes qu'elle exécute, telles que les requêtes DELETE ou INSERT, peuvent réussir.</span><span class="sxs-lookup"><span data-stu-id="64f3c-154">However, even if the task fails, the queries that it runs, such as DELETE or INSERT queries, may succeed.</span></span>  
  
-   <span data-ttu-id="64f3c-155">Si les liaisons de résultats utilisent des noms de colonne, la requête doit retourner des colonnes portant les mêmes noms que l'ensemble de résultats utilisé par la tâche.</span><span class="sxs-lookup"><span data-stu-id="64f3c-155">If the result bindings use column names, the query must return columns that have the same names as the result set names that are used in the task.</span></span> <span data-ttu-id="64f3c-156">Si les colonnes sont manquantes, la tâche échoue.</span><span class="sxs-lookup"><span data-stu-id="64f3c-156">If the columns are missing, the task fails.</span></span>  
  
-   <span data-ttu-id="64f3c-157">Si la tâche utilise la liaison de paramètre, toutes les requêtes du traitement doivent avoir le même nombre et les mêmes types de paramètres.</span><span class="sxs-lookup"><span data-stu-id="64f3c-157">If the task uses parameter binding, all the queries in the batch must have the same number and types of parameters.</span></span>  
  
## <a name="running-parameterized-sql-commands"></a><span data-ttu-id="64f3c-158">Exécution de commandes SQL paramétrables</span><span class="sxs-lookup"><span data-stu-id="64f3c-158">Running Parameterized SQL Commands</span></span>  
 <span data-ttu-id="64f3c-159">Les instructions et les procédures stockées SQL utilisent fréquemment des paramètres d'entrée, des paramètres de sortie et des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="64f3c-159">SQL statements and stored procedures frequently use input parameters, output parameters, and return codes.</span></span> <span data-ttu-id="64f3c-160">La tâche d'exécution SQL prend en charge les types de paramètres `Input`, `Output` et `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="64f3c-160">The Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="64f3c-161">Vous utilisez le type `Input` pour les paramètres d'entrée, `Output` pour les paramètres de sortie et `ReturnValue` pour les codes de retour.</span><span class="sxs-lookup"><span data-stu-id="64f3c-161">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="64f3c-162">Vous ne pouvez utiliser des paramètres dans une tâche d'exécution SQL que si le fournisseur de données les prend en charge.</span><span class="sxs-lookup"><span data-stu-id="64f3c-162">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="64f3c-163">Pour plus d’informations sur l’utilisation de paramètres et de codes de retour dans la tâche d’exécution de requêtes SQL, consultez [Paramètres et codes de retour dans la tâche d’exécution SQL](execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-163">For information on using parameters and return codes in the Execute SQL task, see [Parameters and Return Codes in the Execute SQL Task](execute-sql-task.md).</span></span>  
  
## <a name="specifying-a-result-set-type"></a><span data-ttu-id="64f3c-164">Spécification d'un type d'ensemble de résultats</span><span class="sxs-lookup"><span data-stu-id="64f3c-164">Specifying a Result Set Type</span></span>  
 <span data-ttu-id="64f3c-165">Selon le type de commande SQL, un ensemble de résultats peut ou non être retourné à la tâche d'exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-165">Depending on the type of SQL command, a result set may or may not be returned to the Execute SQL task.</span></span> <span data-ttu-id="64f3c-166">Par exemple, une instruction SELECT retourne généralement un ensemble de résultats, contrairement à une instruction INSERT.</span><span class="sxs-lookup"><span data-stu-id="64f3c-166">For example, a SELECT statement typically returns a result set, but an INSERT statement does not.</span></span> <span data-ttu-id="64f3c-167">L'ensemble de résultats issu d'une instruction SELECT peut contenir un nombre de lignes quelconque (aucune ligne, une ligne ou de nombreuses lignes).</span><span class="sxs-lookup"><span data-stu-id="64f3c-167">The result set from a SELECT statement can contain zero rows, one row, or many rows.</span></span> <span data-ttu-id="64f3c-168">Les procédures stockées peuvent également retourner une valeur entière, appelée « code de retour », qui indique l'état de leur exécution.</span><span class="sxs-lookup"><span data-stu-id="64f3c-168">Stored procedures can also return an integer value, called a return code, that indicates the execution status of the procedure.</span></span> <span data-ttu-id="64f3c-169">Dans ce cas, l'ensemble de résultats comprend une seule ligne.</span><span class="sxs-lookup"><span data-stu-id="64f3c-169">In that case, the result set consists of a single row.</span></span>  
  
 <span data-ttu-id="64f3c-170">Pour plus d’informations sur la récupération de jeux de résultats à partir de commandes SQL dans la tâche d’exécution SQL, consultez [Ensembles de résultats dans la tâche d’exécution SQL](../result-sets-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-170">For information on retrieving result sets from SQL commands in the Execute SQL task, see [Result Sets in the Execute SQL Task](../result-sets-in-the-execute-sql-task.md).</span></span>  
  
## <a name="troubleshooting-the-execute-sql-task"></a><span data-ttu-id="64f3c-171">Résolution des problèmes liés à la tâche d'exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-171">Troubleshooting the Execute SQL Task</span></span>  
 <span data-ttu-id="64f3c-172">Vous pouvez consigner les appels que la tâche d'exécution SQL effectue auprès de fournisseurs de données externes.</span><span class="sxs-lookup"><span data-stu-id="64f3c-172">You can log the calls that the Execute SQL task makes to external data providers.</span></span> <span data-ttu-id="64f3c-173">Vous pouvez utiliser cette fonctionnalité de journalisation pour résoudre les problèmes liés aux commandes SQL qu'exécute la tâche d'exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-173">You can use this logging capability to troubleshoot the SQL commands that the Execute SQL task runs.</span></span> <span data-ttu-id="64f3c-174">Pour consigner les appels que la tâche d’exécution SQL passe à des fournisseurs de données externes, activez la journalisation des packages et sélectionnez l’événement **Diagnostic** au niveau du package.</span><span class="sxs-lookup"><span data-stu-id="64f3c-174">To log the calls that the Execute SQL task makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="64f3c-175">Pour plus d’informations, consultez [Outils de dépannage pour l’exécution des packages](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-175">For more information, see [Troubleshooting Tools for Package Execution](../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
 <span data-ttu-id="64f3c-176">Parfois, une commande SQL ou une procédure stockée retourne plusieurs jeux de résultats.</span><span class="sxs-lookup"><span data-stu-id="64f3c-176">Sometimes a SQL command or stored procedure returns multiple result sets.</span></span> <span data-ttu-id="64f3c-177">Ces jeux de résultats incluent non seulement des ensembles de lignes qui sont le résultat de requêtes `SELECT`, mais également des valeurs uniques qui sont le résultat d'erreurs d'instructions `RAISERROR` ou `PRINT`.</span><span class="sxs-lookup"><span data-stu-id="64f3c-177">These result sets include not only rowsets that are the result of `SELECT` queries, but single values that are the result of errors of `RAISERROR` or `PRINT` statements.</span></span> <span data-ttu-id="64f3c-178">Le fait que la tâche ignore les erreurs dans des jeux de résultats qui se produisent après le premier jeu de résultats dépend du type de gestionnaire de connexions utilisé :</span><span class="sxs-lookup"><span data-stu-id="64f3c-178">Whether the task ignores errors in result sets that occur after the first result set depends on the type of connection manager that is used:</span></span>  
  
-   <span data-ttu-id="64f3c-179">Lorsque vous utilisez les gestionnaires de connexions OLE DB et ADO, la tâche ignore les jeux de résultats qui se produisent après le premier jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="64f3c-179">When you use OLE DB and ADO connection managers, the task ignores the result sets that occur after the first result set.</span></span> <span data-ttu-id="64f3c-180">Par conséquent, avec ces gestionnaires de connexions, la tâche ignore une erreur retournée par une commande SQL ou une procédure stockée lorsque l'erreur ne fait pas partie du premier jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="64f3c-180">Therefore, with these connection managers, the task ignores an error returned by an SQL command or a stored procedure when the error is not part of the first result set.</span></span>  
  
-   <span data-ttu-id="64f3c-181">Lorsque vous utilisez les gestionnaires de connexions ODBC et ADO.NET, la tâche n'ignore pas les jeux de résultats qui se produisent après le premier jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="64f3c-181">When you use ODBC and ADO.NET connection managers, the task does not ignore result sets that occur after the first result set.</span></span> <span data-ttu-id="64f3c-182">Avec ces gestionnaires de connexions, la tâche échoue avec une erreur quand un jeu de résultats autre que le premier jeu de résultats contient une erreur.</span><span class="sxs-lookup"><span data-stu-id="64f3c-182">With these connection managers, the task will fail with an error when a result set other than the first result set contains an error.</span></span>  
  
### <a name="custom-log-entries"></a><span data-ttu-id="64f3c-183">Entrées de journal personnalisées</span><span class="sxs-lookup"><span data-stu-id="64f3c-183">Custom Log Entries</span></span>  
 <span data-ttu-id="64f3c-184">Le tableau suivant décrit les entrées de journal personnalisées pour la tâche d'exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-184">The following table describes the custom log entry for the Execute SQL task.</span></span> <span data-ttu-id="64f3c-185">Pour plus d’informations, consultez [Journalisation d’Integration Services &#40;SSIS&#41;](../performance/integration-services-ssis-logging.md) et [Messages personnalisés pour la journalisation](../custom-messages-for-logging.md).</span><span class="sxs-lookup"><span data-stu-id="64f3c-185">For more information, see [Integration Services &#40;SSIS&#41; Logging](../performance/integration-services-ssis-logging.md) and [Custom Messages for Logging](../custom-messages-for-logging.md).</span></span>  
  
|<span data-ttu-id="64f3c-186">Entrée du journal</span><span class="sxs-lookup"><span data-stu-id="64f3c-186">Log entry</span></span>|<span data-ttu-id="64f3c-187">Description</span><span class="sxs-lookup"><span data-stu-id="64f3c-187">Description</span></span>|  
|---------------|-----------------|  
|`ExecuteSQLExecutingQuery`|<span data-ttu-id="64f3c-188">Fournit des informations sur les phases d'exécution de l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-188">Provides information about the execution phases of the SQL statement.</span></span> <span data-ttu-id="64f3c-189">Des entrées de journal sont écrites lorsque la tâche acquiert la connexion à la base de données, lorsqu'elle commence à préparer l'instruction SQL et à la fin de l'exécution de l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-189">Log entries are written when the task acquires connection to the database, when the task starts to prepare the SQL statement, and after the execution of the SQL statement is completed.</span></span> <span data-ttu-id="64f3c-190">L'entrée de journal concernant la phase de préparation inclut l'instruction SQL que la tâche utilise.</span><span class="sxs-lookup"><span data-stu-id="64f3c-190">The log entry for the prepare phase includes the SQL statement that the task uses.</span></span>|  
  
## <a name="configuring-the-execute-sql-task"></a><span data-ttu-id="64f3c-191">Configuration de la tâche d'exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-191">Configuring the Execute SQL Task</span></span>  
 <span data-ttu-id="64f3c-192">Vous pouvez configurer la tâche d'exécution SQL comme suit :</span><span class="sxs-lookup"><span data-stu-id="64f3c-192">You can configure the Execute SQL task in the following ways:</span></span>  
  
-   <span data-ttu-id="64f3c-193">Spécifiez le type de gestionnaire de connexions à utiliser pour établir la connexion à une base de données.</span><span class="sxs-lookup"><span data-stu-id="64f3c-193">Specify the type of connection manager to use to connect to a database.</span></span>  
  
-   <span data-ttu-id="64f3c-194">Spécifiez le type d'ensemble de résultats retourné par l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-194">Specify the type of result set that the SQL statement returns.</span></span>  
  
-   <span data-ttu-id="64f3c-195">Spécifiez un délai d'expiration pour les instructions SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-195">Specify a time-out for the SQL statements.</span></span>  
  
-   <span data-ttu-id="64f3c-196">Spécifiez la source de l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-196">Specify the source of the SQL statement.</span></span>  
  
-   <span data-ttu-id="64f3c-197">Indiquez si la tâche passe la phase de préparation de l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="64f3c-197">Indicate whether the task skips the prepare phase for the SQL statement.</span></span>  
  
-   <span data-ttu-id="64f3c-198">Si vous utilisez le type de connexion ADO, indiquez si l'instruction SQL est une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="64f3c-198">If you use the ADO connection type, you must indicate whether the SQL statement is a stored procedure.</span></span> <span data-ttu-id="64f3c-199">Pour d'autres types de connexion, cette propriété est définie en lecture seule et sa valeur est toujours `false`.</span><span class="sxs-lookup"><span data-stu-id="64f3c-199">For other connection types, this property is read-only and its value is always `false`.</span></span>  
  
 <span data-ttu-id="64f3c-200">Vous pouvez définir les propriétés par programmation ou par le biais du concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="64f3c-200">You can set properties programmatically or through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer.</span></span>  
  
 <span data-ttu-id="64f3c-201">Pour plus d'informations sur les propriétés définissables dans le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , cliquez sur l'une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="64f3c-201">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="64f3c-202">Éditeur de tâche d’exécution de SQL &#40;&#41;page général</span><span class="sxs-lookup"><span data-stu-id="64f3c-202">Execute SQL Task Editor &#40;General Page&#41;</span></span>](../execute-sql-task-editor-general-page.md)  
  
-   [<span data-ttu-id="64f3c-203">Éditeur de tâche d’exécution de SQL &#40;page mappage de paramètre&#41;</span><span class="sxs-lookup"><span data-stu-id="64f3c-203">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../execute-sql-task-editor-parameter-mapping-page.md)  
  
-   [<span data-ttu-id="64f3c-204">Éditeur de tâche d’exécution de SQL &#40;page ensemble de résultats&#41;</span><span class="sxs-lookup"><span data-stu-id="64f3c-204">Execute SQL Task Editor &#40;Result Set Page&#41;</span></span>](../execute-sql-task-editor-result-set-page.md)  
  
-   [<span data-ttu-id="64f3c-205">Page Expressions</span><span class="sxs-lookup"><span data-stu-id="64f3c-205">Expressions Page</span></span>](../expressions/expressions-page.md)  
  
 <span data-ttu-id="64f3c-206">Pour plus d'informations sur la définition de ces propriétés dans le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , cliquez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="64f3c-206">For more information about how to set these properties in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="64f3c-207">Définir les propriétés d'une tâche ou d'un conteneur</span><span class="sxs-lookup"><span data-stu-id="64f3c-207">Set the Properties of a Task or Container</span></span>](../set-the-properties-of-a-task-or-container.md)  
  
## <a name="configuring-the-execute-sql-task-programmatically"></a><span data-ttu-id="64f3c-208">Configuration de la tâche d'exécution SQL par programmation</span><span class="sxs-lookup"><span data-stu-id="64f3c-208">Configuring the Execute SQL Task Programmatically</span></span>  
 <span data-ttu-id="64f3c-209">Pour plus d'informations sur la définition par programme de ces propriétés, cliquez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="64f3c-209">For more information about programmatically setting these properties, click the following topic:</span></span>  
  
-   <xref:Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask>  
  
## <a name="related-tasks"></a><span data-ttu-id="64f3c-210">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="64f3c-210">Related Tasks</span></span>  
  
-   [<span data-ttu-id="64f3c-211">Mapper des paramètres de requête à des variables dans une tâche d’exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-211">Map Query Parameters to Variables in an Execute SQL Task</span></span>](../map-query-parameters-to-variables-in-an-execute-sql-task.md)  
  
-   [<span data-ttu-id="64f3c-212">Mapper des ensembles de résultats à des variables dans une tâche d’exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-212">Map Result Sets to Variables in an Execute SQL Task</span></span>](../map-result-sets-to-variables-in-an-execute-sql-task.md)  
  
## <a name="related-content"></a><span data-ttu-id="64f3c-213">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="64f3c-213">Related Content</span></span>  
  
-   [<span data-ttu-id="64f3c-214">Paramètres et codes de retour dans la tâche d'exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-214">Parameters and Return Codes in the Execute SQL Task</span></span>](execute-sql-task.md)  
  
-   [<span data-ttu-id="64f3c-215">Ensembles de résultats dans la tâche d’exécution SQL</span><span class="sxs-lookup"><span data-stu-id="64f3c-215">Result Sets in the Execute SQL Task</span></span>](../result-sets-in-the-execute-sql-task.md)  
  
-   [<span data-ttu-id="64f3c-216">Référence Transact-SQL &#40;moteur de base de données&#41;</span><span class="sxs-lookup"><span data-stu-id="64f3c-216">Transact-SQL Reference &#40;Database Engine&#41;</span></span>](/sql/t-sql/language-reference)  
  
-   <span data-ttu-id="64f3c-217">Entrée de blog, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), sur le site mssqltips.com</span><span class="sxs-lookup"><span data-stu-id="64f3c-217">Blog entry, [New Date and Time Functions in SQL Server 2012](https://go.microsoft.com/fwlink/?LinkId=239783), on mssqltips.com</span></span>  
  
  
