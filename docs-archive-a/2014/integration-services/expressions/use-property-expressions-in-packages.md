---
title: Utiliser des expressions de propriété dans des packages | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- packages [Integration Services], expressions
- Integration Services packages, expressions
- SQL Server Integration Services packages, expressions
- dynamic properties
- updating package properties
- SSIS packages, expressions
- expressions [Integration Services], property expressions
- property expressions [Integration Services]
ms.assetid: a4bfc925-3ef6-431e-b1dd-7e0023d3a92d
author: chugugrace
ms.author: chugu
ms.openlocfilehash: bb373428e91cfc8cb4b26a986da6d795ab2fea98
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87612457"
---
# <a name="use-property-expressions-in-packages"></a><span data-ttu-id="2aa7c-102">Expressions de propriété dans des packages</span><span class="sxs-lookup"><span data-stu-id="2aa7c-102">Use Property Expressions in Packages</span></span>
  <span data-ttu-id="2aa7c-103">Une expression de propriété est une expression affectée à une propriété pour permettre la mise à jour dynamique de la propriété au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-103">A property expression is an expression that is assigned to a property to enable dynamic update of the property at run time.</span></span> <span data-ttu-id="2aa7c-104">Par exemple, une expression de propriété peut mettre à jour la ligne À utilisée par une tâche Envoyer un message en insérant une adresse électronique qui est stockée dans une variable.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-104">For example, a property expression can update the To line that a Send Mail task uses by inserting an e-mail address that is stored in a variable.</span></span>

 <span data-ttu-id="2aa7c-105">Une expression peut être ajoutée à un package, une tâche, une boucle Foreach, une boucle For, une séquence, un énumérateur Foreach, un gestionnaire d'événements, un gestionnaire de connexions aux niveaux des packages ou du projet, ou un module fournisseur d'informations.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-105">An expression can be added to a package, task, Foreach Loop, For Loop, Sequence, Foreach enumerator, event handler, a package or project level connection manager, or log provider.</span></span> <span data-ttu-id="2aa7c-106">Toute propriété de ces objets qui est en lecture/écriture peut implémenter une expression de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-106">Any property of these objects that is read/write can implement a property expression.</span></span> [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="2aa7c-107">prend également en charge l'utilisation d'expressions de propriété dans certaines propriétés personnalisées de composants de flux de données.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-107">also supports the use of property expressions in some custom properties of data flow components.</span></span> <span data-ttu-id="2aa7c-108">Les variables et les contraintes de précédence ne prennent pas en charge les expressions de propriété, mais elles incluent des propriétés spéciales dans lesquelles vous pouvez utiliser des expressions.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-108">Variables and precedence constraints do not support property expressions, but they include special properties in which you can use expressions.</span></span>

 <span data-ttu-id="2aa7c-109">Les expressions de propriété peuvent être mises à jour de différentes manières :</span><span class="sxs-lookup"><span data-stu-id="2aa7c-109">Property expressions can be updated in different ways:</span></span>

-   <span data-ttu-id="2aa7c-110">Les variables définies par l'utilisateur peuvent être incluses dans des configurations de package, puis mises à jour lorsque le package est déployé.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-110">User-defined variables can be included in package configurations and then updated when the package is deployed.</span></span> <span data-ttu-id="2aa7c-111">À l'exécution, l'expression de propriété est évaluée à l'aide de la valeur de variable mise à jour.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-111">At run time, the property expression is evaluated using the updated variable value.</span></span>

-   <span data-ttu-id="2aa7c-112">Les variables système incluses dans les expressions sont mises à jour à l'exécution, ce qui modifie les résultats de l'évaluation des propriétés.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-112">System variables that are included in expressions are updated at run time, which changes the results of the property evaluation.</span></span>

-   <span data-ttu-id="2aa7c-113">Les fonctions de date et d'heure sont calculées à l'exécution et fournissent les valeurs mises à jour aux expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-113">Date and time functions are evaluated at run time and provide the updated values to property expressions.</span></span>

-   <span data-ttu-id="2aa7c-114">Les variables dans les expressions peuvent être mises à jour par les scripts exécutés par la tâche de script et le composant de script.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-114">Variables in expressions can be updated by the scripts that the Script task and the Script component run.</span></span>

 <span data-ttu-id="2aa7c-115">Les expressions sont générées avec le langage d’expression [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2aa7c-115">The expressions are built using the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression language.</span></span> <span data-ttu-id="2aa7c-116">Les expressions peuvent utiliser des variables système ou définies par l'utilisateur, ainsi que des opérateurs, des fonctions et des conversions de type fournis par le langage d'expressions.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-116">The expressions can use system or user-defined variables, together with the operators, functions, and type casts that the expression language provides.</span></span>

> [!NOTE]
>  <span data-ttu-id="2aa7c-117">Les noms des variables définies par l'utilisateur et des variables système respectent la casse.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-117">The names of user-defined and system variables are case-sensitive.</span></span>

 <span data-ttu-id="2aa7c-118">Pour plus d’informations, consultez [Expressions Integration Services &#40;SSIS&#41;](integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="2aa7c-118">For more information, see [Integration Services &#40;SSIS&#41; Expressions](integration-services-ssis-expressions.md).</span></span>

 <span data-ttu-id="2aa7c-119">Une utilisation importante des expressions de propriété consiste à personnaliser les configurations pour chaque instance déployée d'un package.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-119">An important use of property expressions is to customize configurations for each deployed instance of a package.</span></span> <span data-ttu-id="2aa7c-120">Cela permet la mise à jour dynamique des propriétés de package dans différents environnements.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-120">This makes it possible to dynamically update package properties for different environments.</span></span> <span data-ttu-id="2aa7c-121">Par exemple, vous pouvez créer une expression de propriété qui affecte une variable à la chaîne de connexion d'un gestionnaire de connexions, puis mettre à jour la variable lorsque le package est déployé, ce qui garantit que la chaîne de connexion est correcte à l'exécution.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-121">For example, you can create a property expression that assigns a variable to the connection string of a connection manager, and then update the variable when the package is deployed, ensuring that the connection string is correct at run time.</span></span> <span data-ttu-id="2aa7c-122">Les configurations de package sont chargées avant l'évaluation des expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-122">Package configurations are loaded before the property expressions are evaluated.</span></span>

 <span data-ttu-id="2aa7c-123">Une propriété ne peut utiliser qu'une expression de propriété et une expression de propriété ne peut s'appliquer qu'à une propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-123">A property can use only one property expression and a property expression can apply only to one property.</span></span> <span data-ttu-id="2aa7c-124">Cependant, vous pouvez générer plusieurs expressions de propriété identiques et les affecter à différentes propriétés.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-124">However, you can build multiple identical property expressions and assign them to different properties.</span></span>

 <span data-ttu-id="2aa7c-125">Certaines propriétés sont définies à l'aide de valeurs provenant d'énumérateurs.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-125">Some properties are set by using values from enumerators.</span></span> <span data-ttu-id="2aa7c-126">Lorsque vous faites référence au membre d'énumérateur dans une expression de propriété, vous devez utiliser la valeur numérique équivalant au nom convivial du membre de l'énumérateur.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-126">When you reference the enumerator member in a property expression, you must use the numeric value that is equivalent to the friendly name of the enumerator member.</span></span> <span data-ttu-id="2aa7c-127">Par exemple, si une expression de propriété définit la propriété `LoggingMode` qui utilise une valeur de l'énumération `DTSLoggingMode`, l'expression de la propriété doit utiliser 0, 1 ou 2 à la place des noms conviviaux `Enabled`, `Disabled` ou `UseParentSetting`.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-127">For example, if a property expression sets the `LoggingMode` property, which uses a value from the `DTSLoggingMode` enumeration, the property expression must use 0, 1, or 2 instead of the friendly names `Enabled`, `Disabled`, or `UseParentSetting`.</span></span> <span data-ttu-id="2aa7c-128">Pour plus d’informations, consultez la page [Constantes énumérées dans des expressions de propriété](enumerated-constants-in-property-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="2aa7c-128">For more information, see [Enumerated Constants in Property Expressions](enumerated-constants-in-property-expressions.md).</span></span>

## <a name="property-expression-user-interface"></a><span data-ttu-id="2aa7c-129">Interface utilisateur de l'expression de propriété</span><span class="sxs-lookup"><span data-stu-id="2aa7c-129">Property Expression User Interface</span></span>
 [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] <span data-ttu-id="2aa7c-130">fournit un ensemble d'outils pour la création et la gestion d'expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-130">provides a set of tools for building and managing property expressions.</span></span>

-   <span data-ttu-id="2aa7c-131">La page **Expressions** , trouvée dans les éditeurs personnalisés pour les tâches, le conteneur de boucles For et les conteneurs Foreach.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-131">The **Expressions** page, found in the custom editors for tasks, the For Loop container, and the Foreach containers.</span></span> <span data-ttu-id="2aa7c-132">La page **Expressions** vous permet de modifier des expressions et d'afficher une liste des expressions de propriété utilisées par une tâche, une boucle For ou une boucle Foreach.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-132">The **Expressions** page lets you edit expressions and view a list of the property expressions that a task, Foreach Loop, or For Loop uses.</span></span>

-   <span data-ttu-id="2aa7c-133">La fenêtre **Propriétés** vous permet de modifier des expressions et d'afficher une liste des expressions de propriété utilisées par un package ou les objets d'un package.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-133">The **Properties** window, for editing expressions and viewing a list of the property expressions that a package or package objects use.</span></span>

-   <span data-ttu-id="2aa7c-134">La boîte de dialogue **Éditeur d'expressions de la propriété** , pour la création, la mise à jour et la suppression des expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-134">The **Property Expressions Editor** dialog box, for creating, updating, and deleting property expressions.</span></span>

-   <span data-ttu-id="2aa7c-135">La boîte de dialogue **Générateur d'expressions** permet de générer une expression à l'aide d'outils graphiques.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-135">The **Expression Builder** dialog box, for building an expression using graphical tools.</span></span> <span data-ttu-id="2aa7c-136">La boîte de dialogue **Générateur d'expression** peut évaluer des expressions pour vous permettre de les vérifier, sans que le résultat de l'évaluation soit affecté à la propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-136">The **Expression Builder** dialog box can evaluate expressions for your review without assigning the evaluation result to the property.</span></span>

 <span data-ttu-id="2aa7c-137">Le schéma suivant montre les interfaces utilisateur que vous pouvez utiliser pour ajouter, modifier et supprimer des expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-137">The following diagram shows the user interfaces that you use to add, change, and remove property expressions.</span></span>

 <span data-ttu-id="2aa7c-138">![Interface utilisateur des expressions de propriété](../media/ssis-propertyexpressionui.gif "Interface utilisateur des expressions de propriété")</span><span class="sxs-lookup"><span data-stu-id="2aa7c-138">![The user interface for property expressions](../media/ssis-propertyexpressionui.gif "The user interface for property expressions")</span></span>

 <span data-ttu-id="2aa7c-139">Dans la fenêtre **Propriétés** et dans la page **Expressions**, cliquez sur le bouton de navigation **(...)** au niveau de la collection **Expressions** pour ouvrir la boîte de dialogue **Éditeur d’expressions de la propriété**.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-139">In the **Properties** window and the **Expressions** page, click the browse button **(...)** at the **Expressions** collection level to open the **Property Expressions Editor** dialog box.</span></span> <span data-ttu-id="2aa7c-140">L'Éditeur d'expressions de la propriété permet de mapper une propriété à une expression et de taper une expression de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-140">The Property Expressions Editor allows you to map a property to an expression and to type a property expression.</span></span> <span data-ttu-id="2aa7c-141">Si vous souhaitez utiliser les outils d’expression graphique pour créer, puis valider l’expression, cliquez sur le bouton de navigation **(...)** au niveau de l’expression pour ouvrir la boîte de dialogue **Générateur d’expressions**, puis créez ou modifiez et éventuellement validez l’expression.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-141">If you want to use the graphical expression tools to create and then validate the expression, click the browse button **(...)** at the expression level to open the **Expression Builder** dialog box, and then create or modify and optionally validate the expression.</span></span>

 <span data-ttu-id="2aa7c-142">Vous pouvez également ouvrir la boîte de dialogue **Générateur d'expression** à partir de la boîte de dialogue **Éditeur d'expressions de la propriété** .</span><span class="sxs-lookup"><span data-stu-id="2aa7c-142">You can also open the **Expression Builder** dialog box from the **Property Expressions Editor** dialog box.</span></span>

#### <a name="to-work-with-property-expressions"></a><span data-ttu-id="2aa7c-143">Pour travailler avec les expressions de propriété</span><span class="sxs-lookup"><span data-stu-id="2aa7c-143">To work with property expressions</span></span>

-   [<span data-ttu-id="2aa7c-144">Ajouter ou modifier une expression de propriété</span><span class="sxs-lookup"><span data-stu-id="2aa7c-144">Add or Change a Property Expression</span></span>](add-or-change-a-property-expression.md)

### <a name="setting-property-expressions-of-data-flow-components"></a><span data-ttu-id="2aa7c-145">Définition d'expressions de propriété de composants de flux de données</span><span class="sxs-lookup"><span data-stu-id="2aa7c-145">Setting Property Expressions of Data Flow Components</span></span>
 <span data-ttu-id="2aa7c-146">Si vous construisez un package dans [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], les propriétés des composants de flux de données qui prennent en charge des expressions de propriété sont exposées dans la tâche de flux de données à laquelle ils appartiennent.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-146">If you construct a package in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)], the properties of data flow components that support property expressions are exposed on the Data Flow task to which they belong.</span></span> <span data-ttu-id="2aa7c-147">Pour ajouter, modifier ou supprimer les expressions de propriété de composants de flux de données, cliquez avec le bouton droit sur la tâche de flux de données pour le flux de données auquel les composants de flux de données appartiennent, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-147">To add, change, and remove the property expressions of data flow components, you right-click the Data Flow task for the data flow to which the data flow components belong and click **Properties**.</span></span> <span data-ttu-id="2aa7c-148">La fenêtre Propriétés répertorie les propriétés des composants de flux de données avec lesquels vous pouvez utiliser des expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-148">The Properties window lists the properties of data flow components with which you can use property expressions.</span></span> <span data-ttu-id="2aa7c-149">Par exemple, pour créer ou modifier une expression de propriété pour la propriété SamplingValue d’une transformation d’échantillonnage de lignes nommée SampleCustomer, cliquez avec le bouton droit sur la tâche de flux de données pour le flux de données auquel la transformation d’échantillonnage de lignes appartient, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-149">For example, to create or modify a property expression for the SamplingValue property of a Row Sampling transformation in a data flow named SampleCustomer, right-click the Data Flow task for the data flow to which the Row Sampling transformation belongs and click **Properties**.</span></span> <span data-ttu-id="2aa7c-150">La propriété SamplingValue figure dans la liste de la fenêtre Propriétés et utilise le format [SampleCustomer].[SamplingValue].</span><span class="sxs-lookup"><span data-stu-id="2aa7c-150">The SamplingValue property is listed in the Properties window, and has the format [SampleCustomer].[SamplingValue].</span></span>

 <span data-ttu-id="2aa7c-151">Dans la fenêtre Propriétés, vous ajoutez, modifiez et supprimez des expressions de propriété pour les composants de flux de données de la même manière que les expressions de propriété d'autres types d'objets [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2aa7c-151">In the Properties window, you add, change, and remove property expressions for data flow components in the same way as property expressions for other [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] object types.</span></span> <span data-ttu-id="2aa7c-152">La fenêtre Propriétés donne également accès aux diverses boîtes de dialogue et aux divers générateurs permettant d'ajouter, de modifier ou de supprimer des expressions de propriété pour des composants de flux de données.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-152">The Properties window also provides access to the various dialog boxes and builders that you use to add, change, or remove property expressions for data flow components.</span></span> <span data-ttu-id="2aa7c-153">Pour plus d'informations sur les propriétés des composants de flux de données pouvant être mis à jour par des expressions de propriété, consultez [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="2aa7c-153">For more information about the properties of data flow components that can be updated by property expressions, see [Transformation Custom Properties](../data-flow/transformations/transformation-custom-properties.md).</span></span>

## <a name="loading-property-expressions"></a><span data-ttu-id="2aa7c-154">Chargement d'expressions de propriété</span><span class="sxs-lookup"><span data-stu-id="2aa7c-154">Loading Property Expressions</span></span>
 <span data-ttu-id="2aa7c-155">Vous ne pouvez pas spécifier ou contrôler le moment où les expressions de propriété sont chargées.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-155">You cannot specify or control when property expressions are loaded.</span></span> <span data-ttu-id="2aa7c-156">Les expressions de propriété sont évaluées et chargées lors de la validation du package et de ses objets.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-156">The property expressions are evaluated and loaded when the package and the package objects are validated.</span></span> <span data-ttu-id="2aa7c-157">La validation a lieu au moment où vous enregistrez le package, ouvrez le package dans le concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , puis l'exécutez.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-157">Validation occurs when you save the package, open the package in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, and run the package.</span></span>

 <span data-ttu-id="2aa7c-158">Vous ne verrez donc pas les valeurs mises à jour des propriétés des objets du package qui utilisent des expressions de la propriété dans le concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] tant que vous n'avez pas enregistré le package, exécuté le package ou rouvert le package après avoir ajouté des expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-158">You will therefore not see the updated values of the properties of the package objects that use property expressions in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer until you save the package, run the package, or reopen the package after adding the property expressions.</span></span>

 <span data-ttu-id="2aa7c-159">Les expressions de propriété associées à différents types d’objets (gestionnaires de connexions, modules fournisseurs d’informations et énumérateurs) sont également chargées quand des méthodes spécifiques de ce type d’objet sont appelées.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-159">The property expressions associated with different types of objects-connection managers, log providers, and enumerators-are also loaded when methods specific to that object type are called.</span></span> <span data-ttu-id="2aa7c-160">Par exemple, les propriétés des gestionnaires de connexions sont chargées avant que [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] ne crée une instance de la connexion.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-160">For example, the properties of connection managers are loaded before [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] creates an instance of the connection.</span></span>

 <span data-ttu-id="2aa7c-161">Les expressions de propriété sont chargées après le chargement des configurations de package.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-161">Property expressions are loaded after package configurations have loaded.</span></span> <span data-ttu-id="2aa7c-162">Par exemple, les variables sont d'abord mises à jour par leurs configurations, puis les expressions de propriété qui utilisent les variables sont évaluées et chargées.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-162">For example, variables are updated first by their configurations, and then the property expressions that use the variables are evaluated and loaded.</span></span> <span data-ttu-id="2aa7c-163">Cela signifie que les expressions de propriété utilisent toujours les valeurs de variables qui sont définies par des configurations.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-163">This means that the property expressions always use the values of variables that are set by configurations.</span></span>

> [!NOTE]
>  <span data-ttu-id="2aa7c-164">Vous ne pouvez pas utiliser l' `Set` option de l’utilitaire **dtexec** pour remplir une expression de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-164">You cannot use the `Set` option of the **dtexec** utility to populate a property expression.</span></span>

 <span data-ttu-id="2aa7c-165">Le tableau suivant indique à quel moment les expressions de propriété d' [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] sont évaluées et chargées.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-165">The following table summarizes when property expressions of [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] are evaluated and loaded.</span></span>

|<span data-ttu-id="2aa7c-166">Type d'objet</span><span class="sxs-lookup"><span data-stu-id="2aa7c-166">Object type</span></span>|<span data-ttu-id="2aa7c-167">Charger et évaluer</span><span class="sxs-lookup"><span data-stu-id="2aa7c-167">Load and evaluate</span></span>|
|-----------------|-----------------------|
|<span data-ttu-id="2aa7c-168">Package, boucle Foreach, boucle For, séquence, tâches et composants de flux de données</span><span class="sxs-lookup"><span data-stu-id="2aa7c-168">Package, Foreach loop, For Loop, Sequence, tasks, and data flow components</span></span>|<span data-ttu-id="2aa7c-169">Après le chargement de configurations</span><span class="sxs-lookup"><span data-stu-id="2aa7c-169">After loading configurations</span></span><br /><br /> <span data-ttu-id="2aa7c-170">Avant la validation</span><span class="sxs-lookup"><span data-stu-id="2aa7c-170">Before validation</span></span><br /><br /> <span data-ttu-id="2aa7c-171">Avant l'exécution</span><span class="sxs-lookup"><span data-stu-id="2aa7c-171">Before execution</span></span>|
|<span data-ttu-id="2aa7c-172">Gestionnaires de connexions</span><span class="sxs-lookup"><span data-stu-id="2aa7c-172">Connection managers</span></span>|<span data-ttu-id="2aa7c-173">Après le chargement de configurations</span><span class="sxs-lookup"><span data-stu-id="2aa7c-173">After loading configurations</span></span><br /><br /> <span data-ttu-id="2aa7c-174">Avant la validation</span><span class="sxs-lookup"><span data-stu-id="2aa7c-174">Before validation</span></span><br /><br /> <span data-ttu-id="2aa7c-175">Avant l'exécution</span><span class="sxs-lookup"><span data-stu-id="2aa7c-175">Before execution</span></span><br /><br /> <span data-ttu-id="2aa7c-176">Avant la création d'une instance de connexion</span><span class="sxs-lookup"><span data-stu-id="2aa7c-176">Before creating a connection instance</span></span>|
|<span data-ttu-id="2aa7c-177">Modules fournisseurs d'informations</span><span class="sxs-lookup"><span data-stu-id="2aa7c-177">Log providers</span></span>|<span data-ttu-id="2aa7c-178">Après le chargement de configurations</span><span class="sxs-lookup"><span data-stu-id="2aa7c-178">After loading configurations</span></span><br /><br /> <span data-ttu-id="2aa7c-179">Avant la validation</span><span class="sxs-lookup"><span data-stu-id="2aa7c-179">Before validation</span></span><br /><br /> <span data-ttu-id="2aa7c-180">Avant l'exécution</span><span class="sxs-lookup"><span data-stu-id="2aa7c-180">Before execution</span></span><br /><br /> <span data-ttu-id="2aa7c-181">Avant l'ouverture des journaux</span><span class="sxs-lookup"><span data-stu-id="2aa7c-181">Before opening logs</span></span>|
|<span data-ttu-id="2aa7c-182">Énumérateurs Foreach</span><span class="sxs-lookup"><span data-stu-id="2aa7c-182">Foreach enumerators</span></span>|<span data-ttu-id="2aa7c-183">Après le chargement de configurations</span><span class="sxs-lookup"><span data-stu-id="2aa7c-183">After loading configurations</span></span><br /><br /> <span data-ttu-id="2aa7c-184">Avant la validation</span><span class="sxs-lookup"><span data-stu-id="2aa7c-184">Before validation</span></span><br /><br /> <span data-ttu-id="2aa7c-185">Avant l'exécution</span><span class="sxs-lookup"><span data-stu-id="2aa7c-185">Before execution</span></span><br /><br /> <span data-ttu-id="2aa7c-186">Avant chaque énumération de la boucle</span><span class="sxs-lookup"><span data-stu-id="2aa7c-186">Before each enumeration of the loop</span></span>|

## <a name="using-property-expressions-in-the-foreach-loop"></a><span data-ttu-id="2aa7c-187">Utilisation d'expressions de propriété dans la boucle Foreach</span><span class="sxs-lookup"><span data-stu-id="2aa7c-187">Using Property Expressions in the Foreach Loop</span></span>
 <span data-ttu-id="2aa7c-188">Il est souvent utile d'implémenter une expression de propriété pour définir la valeur de la propriété `ConnectionString` des gestionnaires de connexions que les énumérateurs de boucles Foreach utilisent.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-188">It is frequently useful to implement a property expression to set the value of the `ConnectionString` property of connection managers that are used inside the Foreach Loop container.</span></span> <span data-ttu-id="2aa7c-189">Après que l’énumérateur a mappé sa valeur actuelle à une variable dans chaque itération de la boucle, l’expression de propriété peut utiliser la valeur de cette variable pour mettre à jour la valeur de la propriété `ConnectionString` de manière dynamique.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-189">After the enumerator maps its current value to a variable on each iteration of the loop, the property expression can use the value of this variable to update the value of the `ConnectionString` property dynamically .</span></span>

 <span data-ttu-id="2aa7c-190">Si vous souhaitez utiliser des expressions de propriété avec la propriété `ConnectionString` des gestionnaires de connexions de fichiers, de fichiers multiples, de fichiers plats et de fichiers plats multiples qu'une boucle Foreach utilise, vous devez tenir compte de certains aspects.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-190">If you want to use property expressions with the `ConnectionString` property of File, Multiple Files, Flat Files, and Multiple Flat Files connection managers that a Foreach Loop uses, there are some things that you should consider.</span></span> <span data-ttu-id="2aa7c-191">Un package peut être configuré pour exécuter plusieurs exécutables simultanément en attribuant à la propriété `MaxConcurrentExecutables` soit une valeur supérieure à 1, soit la valeur -1.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-191">A package can be configured to run multiple executables concurrently by setting the `MaxConcurrentExecutables` property either to a value greater than 1 or to the value -1.</span></span> <span data-ttu-id="2aa7c-192">La valeur -1 permet au nombre maximal d'exécutables exécutés simultanément d'être égal au nombre de processeurs plus deux.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-192">A value of -1 allows the maximum number of concurrently running executables to equal the number of processors plus two.</span></span> <span data-ttu-id="2aa7c-193">Pour éviter les conséquences négatives d'une exécution parallèle d'exécutables, la propriété `MaxConcurrentExecutables` doit avoir la valeur 1.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-193">To avoid negative consequences from the parallel execution of executables, the value `MaxConcurrentExecutables` should be set to 1.</span></span> <span data-ttu-id="2aa7c-194">Si `MaxConcurrentExecutables` n'a pas la valeur 1, la valeur de la propriété `ConnectionString` ne peut pas être garantie et les résultats sont imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-194">If `MaxConcurrentExecutables` is not set to 1, then the value of the `ConnectionString` property cannot be guaranteed and results are unpredictable.</span></span>

 <span data-ttu-id="2aa7c-195">Par exemple, imaginez une boucle Foreach qui énumère des fichiers dans un dossier, récupère les noms de fichiers, puis utilise une tâche d'exécution SQL pour insérer les noms de fichiers dans une table.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-195">For example, consider a Foreach Loop that enumerates files in a folder, retrieves the file names, and then uses an Execute SQL task to insert each file name into a table.</span></span> <span data-ttu-id="2aa7c-196">Si `MaxConcurrentExecutables` n'a pas la valeur 1, des conflits d'écriture peuvent éventuellement survenir si les deux instances de la tâche d'exécution SQL tentent d'écrire simultanément dans la table.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-196">If `MaxConcurrentExecutables` is not set to 1, then write conflicts could occur if two instances of the Execute SQL task attempted to write to the table at the same time.</span></span>

## <a name="sample-property-expressions"></a><span data-ttu-id="2aa7c-197">Exemples d'expressions de propriété</span><span class="sxs-lookup"><span data-stu-id="2aa7c-197">Sample Property Expressions</span></span>
 <span data-ttu-id="2aa7c-198">Les exemples d'expression suivants montrent comment utiliser les variables système, les opérateurs, les fonctions et les littéraux de chaîne dans les expressions de propriété.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-198">The following sample expressions show how to use system variables, operators, functions, and string literals in property expressions.</span></span>

### <a name="property-expression-for-the-loggingmode-property-of-a-package"></a><span data-ttu-id="2aa7c-199">Expression de propriété pour la propriété LoggingMode d'un package</span><span class="sxs-lookup"><span data-stu-id="2aa7c-199">Property Expression for the LoggingMode Property of a Package</span></span>
 <span data-ttu-id="2aa7c-200">L’expression de propriété suivante peut être utilisée pour définir la propriété LoggingMode d’un package.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-200">The following property expression can be used to set the LoggingMode property of a package.</span></span> <span data-ttu-id="2aa7c-201">L'expression utilise les fonctions DAY et GETDATE pour obtenir un entier qui représente la partie jour d'une date.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-201">The expression uses the DAY and GETDATE functions to get an integer that represents the day datepart of a date.</span></span> <span data-ttu-id="2aa7c-202">Si le jour est le premier ou le 15, la journalisation est activée ; sinon, elle est désactivée.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-202">If the day is the 1st or 15th, logging is enabled; otherwise, logging is disabled.</span></span> <span data-ttu-id="2aa7c-203">La valeur 1 est l’équivalent entier du membre de l’énumérateur LoggingMode `Enabled` , et la valeur 2 est l’équivalent entier du membre `Disabled` .</span><span class="sxs-lookup"><span data-stu-id="2aa7c-203">The value 1 is the integer equivalent of the LoggingMode enumerator member `Enabled`, and the value 2 is the integer equivalent of the member `Disabled`.</span></span> <span data-ttu-id="2aa7c-204">Vous devez utiliser la valeur numérique à la place du nom du membre d'énumérateur dans l'expression.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-204">You must use the numeric value instead of the enumerator member name in the expression.</span></span>

 `DAY((DT_DBTIMESTAMP)GETDATE())==1||DAY((DT_DBTIMESTAMP)GETDATE())==15?1:2`

### <a name="property-expression-for-the-subject-of-an-e-mail-message"></a><span data-ttu-id="2aa7c-205">Expression de propriété pour l'objet d'un message électronique</span><span class="sxs-lookup"><span data-stu-id="2aa7c-205">Property Expression for the Subject of an E-mail Message</span></span>
 <span data-ttu-id="2aa7c-206">L’expression de propriété suivante peut être utilisée pour définir la propriété Subject d’une tâche d’envoi de message et fournir un objet de courrier électronique.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-206">The following property expression can be used to set the Subject property of a Send Mail task and provide a useful e-mail subject.</span></span> <span data-ttu-id="2aa7c-207">L'expression utilise une combinaison de littéraux de chaîne, de variables système, les opérateurs de concaténation (+) et de conversion, et les fonctions DATEDIFF et GETDATE.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-207">The expression uses a combination of string literals, system variables, the concatenation (+) and cast operators, and the DATEDIFF and GETDATE functions.</span></span> <span data-ttu-id="2aa7c-208">Les variables système sont les variables `PackageName` et `StartTime` .</span><span class="sxs-lookup"><span data-stu-id="2aa7c-208">The system variables are the `PackageName` and `StartTime` variables.</span></span>

 `"PExpression-->Package: (" + @[System::PackageName] + ") Started:"+  (DT_WSTR, 30) @[System::StartTime] + " Duration:"  +  (DT_WSTR,10) (DATEDIFF( "ss", @[System::StartTime] , GETDATE()  )) + " seconds"`

 <span data-ttu-id="2aa7c-209">Si le nom du package est EmailRowCountPP, s'il a été exécuté le 03/04/2005 et que la durée de l'exécution était de 9 secondes, l'expression s'évalue à la chaîne.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-209">If the package name is EmailRowCountPP, was run on 3/4/2005, and the duration of the run was 9 seconds, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="2aa7c-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-210">PExpression-->Package: (EmailRowCountPP) Started:3/4/2005 11:06:18 AM Duration:9 seconds.</span></span>

### <a name="property-expression-for-the-message-of-an-e-mail-message"></a><span data-ttu-id="2aa7c-211">Expression de propriété pour le message d'un message électronique</span><span class="sxs-lookup"><span data-stu-id="2aa7c-211">Property Expression for the Message of an E-mail Message</span></span>
 <span data-ttu-id="2aa7c-212">L’expression de propriété suivante peut être utilisée pour définir la propriété MessageSource d’une tâche d’envoi de message.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-212">The following property expression can be used to set the MessageSource property of a Send Mail task.</span></span> <span data-ttu-id="2aa7c-213">L'expression utilise une combinaison de littéraux de chaîne, de variables définies par l'utilisateur et l'opérateur de concaténation (+).</span><span class="sxs-lookup"><span data-stu-id="2aa7c-213">The expression uses a combination of string literals, user-defined variables, and the concatenation (+) operator.</span></span> <span data-ttu-id="2aa7c-214">Les variables définies par l’utilisateur sont appelées `nasdaqrawrows`, `nyserawrows`et `amexrawrows`.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-214">The user-defined variables are named `nasdaqrawrows`, `nyserawrows`, and `amexrawrows`.</span></span> <span data-ttu-id="2aa7c-215">La chaîne "\n" indique un retour chariot.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-215">The string "\n" indicates a carriage return.</span></span>

 `"Rows Processed: "  +   "\n" +"   NASDAQ: "  +   (dt_wstr,9)@[nasdaqrawrows]   + "\n" + "   NYSE: "  +  (dt_wstr,9)@[nyserawrows]  + "\n" + "   Amex: "  +  (dt_wstr,9)@[amexrawrows]`

 <span data-ttu-id="2aa7c-216">Si `nasdaqrawrows` a pour valeur 7058, `nyserawrows` 3528 et `amexrawrows` 1102, l'expression renvoie la chaîne suivante.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-216">If `nasdaqrawrows` is 7058, `nyserawrows` is 3528, and `amexrawrows` is 1102, the expression evaluates to the following string.</span></span>

 <span data-ttu-id="2aa7c-217">Lignes traitées :</span><span class="sxs-lookup"><span data-stu-id="2aa7c-217">Rows Processed:</span></span>

 <span data-ttu-id="2aa7c-218">NASDAQ: 7058</span><span class="sxs-lookup"><span data-stu-id="2aa7c-218">NASDAQ: 7058</span></span>

 <span data-ttu-id="2aa7c-219">NYSE: 3528</span><span class="sxs-lookup"><span data-stu-id="2aa7c-219">NYSE: 3528</span></span>

 <span data-ttu-id="2aa7c-220">AMEX: 1102</span><span class="sxs-lookup"><span data-stu-id="2aa7c-220">AMEX: 1102</span></span>

### <a name="property-expression-for-the-executable-property-of-an-execute-process-task"></a><span data-ttu-id="2aa7c-221">Expression de propriété pour la propriété exécutable d'une tâche d'exécution de processus</span><span class="sxs-lookup"><span data-stu-id="2aa7c-221">Property Expression for the Executable Property of an Execute Process Task</span></span>
 <span data-ttu-id="2aa7c-222">L’expression de propriété suivante peut être utilisée pour définir la propriété Executable d’une tâche d’exécution de processus.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-222">The following property expression can be used to set the Executable property of an Execute Process task.</span></span> <span data-ttu-id="2aa7c-223">L'expression utilise une combinaison de littéraux de chaîne, d'opérateurs et de fonctions.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-223">The expression uses a combination of string literals, operators, and functions.</span></span> <span data-ttu-id="2aa7c-224">L'expression utilise les fonctions DATEPART et GETDATE et l'opérateur conditionnel.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-224">The expression uses the DATEPART and GETDATE functions and the conditional operator.</span></span>

 `DATEPART("weekday", GETDATE()) ==2?"notepad.exe":"mspaint.exe"`

 <span data-ttu-id="2aa7c-225">S'il s'agit du second jour de la semaine, la tâche d'exécution de processus exécute notepad.exe, sinon la tâche exécute mspaint.exe.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-225">If it is the second day in the week, the Execute Process task runs notepad.exe, otherwise the task runs mspaint.exe.</span></span>

### <a name="property-expression-for-the-connectionstring-property-of-a-flat-file-connection-manager"></a><span data-ttu-id="2aa7c-226">Expression de propriété pour la propriété ConnectionString d'un gestionnaire de connexions de fichier plat</span><span class="sxs-lookup"><span data-stu-id="2aa7c-226">Property Expression for the ConnectionString Property of a Flat File Connection Manager</span></span>
 <span data-ttu-id="2aa7c-227">L’expression de propriété suivante peut être utilisée pour définir la propriété ConnectionString d’un gestionnaire de connexions de fichier plat.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-227">The following property expression can be used to set the ConnectionString property of a Flat File connection manager.</span></span> <span data-ttu-id="2aa7c-228">L'expression utilise une seule variable définie par l'utilisateur ( `myfilenamefull`) contenant le chemin d'accès vers un fichier texte.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-228">The expression uses a single user-defined variable, `myfilenamefull`, which contains the path to a text file.</span></span>

 `@[User::myfilenamefull]`

> [!NOTE]
>  <span data-ttu-id="2aa7c-229">Les expressions de propriétés pour les gestionnaires de connexions sont accessibles seulement via la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-229">Property expressions for connection managers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="2aa7c-230">Pour visualiser les propriétés d’un gestionnaire de connexions, vous devez sélectionner le gestionnaire de connexions dans la zone **Gestionnaires de connexions** du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] quand la fenêtre Propriétés est ouverte, ou bien cliquer avec le bouton droit sur le gestionnaire de connexions, puis sélectionner **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-230">To view the properties for a connection manager, you must select the connection manager in the **Connection Managers** area of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the connection manager and select **Properties**.</span></span>

### <a name="property-expression-for-the-configstring-property-of-a-text-file-log-provider"></a><span data-ttu-id="2aa7c-231">Expression de propriété pour la propriété ConfigString d'un module fournisseur d'informations de fichier texte</span><span class="sxs-lookup"><span data-stu-id="2aa7c-231">Property Expression for the ConfigString Property of a Text File Log Provider</span></span>
 <span data-ttu-id="2aa7c-232">L’expression de propriété suivante peut être utilisée pour définir la propriété ConfigString d’un module fournisseur d’informations de fichier texte.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-232">The following property expression can be used to set the ConfigString property of a Text File log provider.</span></span> <span data-ttu-id="2aa7c-233">L’expression utilise une variable définie par l’utilisateur, `varConfigString`, contenant le nom du gestionnaire de connexions de fichiers à utiliser.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-233">The expression uses a single user-defined variable, `varConfigString`, which contains the name of the File connection manager to use.</span></span> <span data-ttu-id="2aa7c-234">Le gestionnaire de connexions de fichiers spécifie le chemin d'accès du fichier texte dans lequel des entrées de journal sont écrites.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-234">The File connection manager specifies the path of the text file to which log entries are written.</span></span>

 `@[User::varConfigString]`

> [!NOTE]
>  <span data-ttu-id="2aa7c-235">Les expressions de propriété pour les modules fournisseurs d'informations sont accessibles seulement via la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-235">Property expressions for log providers can be accessed only by using the Properties window.</span></span> <span data-ttu-id="2aa7c-236">Pour visualiser les propriétés d’un module fournisseur d’informations, vous devez sélectionner le module fournisseur d’informations sous l’onglet **Explorateur de package** du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] quand la fenêtre Propriétés est ouverte, ou bien cliquer avec le bouton droit sur le module fournisseur d’informations, puis sélectionner **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2aa7c-236">To view the properties of a log provider, you must select the log provider on the **Package Explorer** tab of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer when the Properties window is open, or right-click the log provider in Package Explorer and click **Properties**.</span></span>

## <a name="external-resources"></a><span data-ttu-id="2aa7c-237">Ressources externes</span><span class="sxs-lookup"><span data-stu-id="2aa7c-237">External Resources</span></span>

-   [<span data-ttu-id="2aa7c-238">Expression and Configuration Highlighter (projet CodePlex)</span><span class="sxs-lookup"><span data-stu-id="2aa7c-238">Expression and Configuration Highlighter (CodePlex Project)</span></span>](https://go.microsoft.com/fwlink/?LinkId=146625)

-   <span data-ttu-id="2aa7c-239">Article technique, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), sur social.technet.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="2aa7c-239">Technical article, [SSIS Expression Examples](https://go.microsoft.com/fwlink/?LinkId=220761), on social.technet.microsoft.com</span></span>

## <a name="see-also"></a><span data-ttu-id="2aa7c-240">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2aa7c-240">See Also</span></span>
 [<span data-ttu-id="2aa7c-241">Utiliser des variables dans des packages</span><span class="sxs-lookup"><span data-stu-id="2aa7c-241">Use Variables in Packages</span></span>](../use-variables-in-packages.md)


