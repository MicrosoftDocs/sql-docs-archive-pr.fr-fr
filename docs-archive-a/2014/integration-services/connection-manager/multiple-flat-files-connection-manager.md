---
title: Gestionnaire de connexions de fichiers plats multiples | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Multiple Flat Files connection manager
- connections [Integration Services], flat files
- flat files
- flat file connections [Integration Services]
- connection managers [Integration Services], Multiple Flat Files
- multiple flat file connections
ms.assetid: 31fc3f7a-d323-44f5-a907-1fa3de66631a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a17125fedb495daabc4838161b3260c0d5590319
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613087"
---
# <a name="multiple-flat-files-connection-manager"></a><span data-ttu-id="4b5d4-102">Gestionnaire de connexions de fichiers plats multiples</span><span class="sxs-lookup"><span data-stu-id="4b5d4-102">Multiple Flat Files Connection Manager</span></span>
  <span data-ttu-id="4b5d4-103">Un gestionnaire de connexions de fichiers plats multiples permet à un package d'accéder aux données de plusieurs fichiers plats.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-103">A Multiple Flat Files connection manager enables a package to access data in multiple flat files.</span></span> <span data-ttu-id="4b5d4-104">Par exemple, une source de fichier plat peut utiliser un gestionnaire de connexions de fichiers plats multiples lorsque la tâche de flux de données se trouve dans un conteneur de boucles (conteneur de boucles For, par exemple).</span><span class="sxs-lookup"><span data-stu-id="4b5d4-104">For example, a Flat File source can use a Multiple Flat Files connection manager when the Data Flow task is inside a loop container, such as the For Loop container.</span></span> <span data-ttu-id="4b5d4-105">Dans chaque boucle du conteneur, la source de fichier plat charge les données à partir du nom de fichier suivant fourni par le gestionnaire de connexions de fichiers plats multiples.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-105">On each loop of the container, the Flat File source loads data from the next file name that the Multiple Flat Files connection manager provides.</span></span>  
  
 <span data-ttu-id="4b5d4-106">Lorsque vous ajoutez un gestionnaire de connexions de fichiers plats multiples à un package, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] crée un gestionnaire de connexions qui sera résolu en une connexion de fichiers plats multiples au moment de l’exécution, définit les propriétés sur le gestionnaire de connexions de fichiers plats multiples, puis ajoute le gestionnaire de connexions de fichiers plats multiples à la `Connections` collection du package.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-106">When you add a Multiple Flat Files connection manager to a package, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] creates a connection manager that will resolve to a Multiple Flat Files connection at run time, sets the properties on the Multiple Flat Files connection manager, and adds the Multiple Flat Files connection manager to the `Connections` collection of the package.</span></span>  
  
 <span data-ttu-id="4b5d4-107">La propriété `ConnectionManagerType` du gestionnaire de connexions a pour valeur `MULTIFLATFILE`.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-107">The `ConnectionManagerType` property of the connection manager is set to `MULTIFLATFILE`.</span></span>  
  
 <span data-ttu-id="4b5d4-108">Vous pouvez configurer un gestionnaire de connexions de fichiers plats multiples de plusieurs manières :</span><span class="sxs-lookup"><span data-stu-id="4b5d4-108">You can configure the Multiple Flat Files connection manager in the following ways:</span></span>  
  
-   <span data-ttu-id="4b5d4-109">Spécifiez les fichiers, paramètres régionaux et pages de codes à utiliser.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-109">Specify the files, locale, and code page to use.</span></span> <span data-ttu-id="4b5d4-110">Les paramètres régionaux sont utilisés pour interpréter les données spécifiques à un pays comme les dates, tandis que la page de codes est utilisée pour convertir les données chaînes au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-110">The locale is used to interpret locale-sensitive data such as dates, and the code page is used to convert string data to Unicode.</span></span>  
  
-   <span data-ttu-id="4b5d4-111">Spécifiez le format de fichier.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-111">Specify the file format.</span></span> <span data-ttu-id="4b5d4-112">Vous pouvez utiliser un format délimité, à largeur fixe ou en drapeau à droite.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-112">You can use a delimited, fixed width, or ragged right format.</span></span>  
  
-   <span data-ttu-id="4b5d4-113">Spécifiez une ligne d'en-tête, une ligne de données et des séparateurs de colonnes.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-113">Specify a header row, data row, and column delimiters.</span></span> <span data-ttu-id="4b5d4-114">Les séparateurs de colonnes peuvent être définis au niveau du fichier et remplacés au niveau de la colonne.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-114">Column delimiters can be set at the file level and overwritten at the column level.</span></span>  
  
-   <span data-ttu-id="4b5d4-115">Indiquez si la première ligne des fichiers contient les noms de colonnes.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-115">Indicate whether the first row in the files contains column names.</span></span>  
  
-   <span data-ttu-id="4b5d4-116">Spécifiez un caractère d'identificateur de texte.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-116">Specify a text qualifier character.</span></span> <span data-ttu-id="4b5d4-117">Chaque colonne peut être configurée pour reconnaître un identificateur de texte.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-117">Each column can be configured to recognize a text qualifier.</span></span>  
  
-   <span data-ttu-id="4b5d4-118">Définissez des propriétés comme le nom, le type de données et la largeur maximale pour des colonnes individuelles.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-118">Set properties such as the name, data type, and maximum width on individual columns.</span></span>  
  
 <span data-ttu-id="4b5d4-119">Lorsque le gestionnaire de connexions de fichiers plats multiples référence plusieurs fichiers, les chemins d'accès aux fichiers sont séparés par une barre verticale (|).</span><span class="sxs-lookup"><span data-stu-id="4b5d4-119">When the Multiple Flat Files connection manager references multiple files, the paths of the files are separated by the pipe (|) character.</span></span> <span data-ttu-id="4b5d4-120">La propriété `ConnectionString` du gestionnaire de connexions utilise le format suivant :</span><span class="sxs-lookup"><span data-stu-id="4b5d4-120">The `ConnectionString` property of the connection manager has the following format:</span></span>  
  
 \<*path*>|\<*path*>  
  
 <span data-ttu-id="4b5d4-121">Vous pouvez également spécifier plusieurs fichiers en utilisant des caractères génériques.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-121">You can also specify multiple files by using wildcard characters.</span></span> <span data-ttu-id="4b5d4-122">Par exemple, pour référencer tous les fichiers texte sur le lecteur C, la valeur de la `ConnectionString` propriété peut être définie sur C : \\ \*. txt.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-122">For example, to reference all the text files on the C drive, the value of the `ConnectionString` property can be set to C:\\*.txt.</span></span>  
  
 <span data-ttu-id="4b5d4-123">Si un gestionnaire de connexions de fichiers plats multiples référence plusieurs fichiers, tous les fichiers doivent utiliser le même format.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-123">If a Multiple Flat Files connection manager references multiple files, all the files must have the same format.</span></span>  
  
 <span data-ttu-id="4b5d4-124">Par défaut, le gestionnaire de connexions de fichiers plats multiples définit pour les colonnes de type chaîne une longueur de 50 caractères.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-124">By default, the Multiple Flat Files connection manager sets the length of string columns to 50 characters.</span></span> <span data-ttu-id="4b5d4-125">Dans la boîte de dialogue **Éditeur du gestionnaire de connexions de fichiers plats multiples** , vous pouvez évaluer des exemples de données et redimensionner automatiquement la longueur de ces colonnes pour empêcher la troncation des données ou la largeur de colonne excessive.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-125">In the **Multiple Flat Files Connection Manager Editor** dialog box, you can evaluate sample data and automatically resize the length of these columns to prevent truncation of data or excess column width.</span></span> <span data-ttu-id="4b5d4-126">Sauf si vous redimensionnez la longueur de colonne dans une source de fichier plat ou une transformation, celle-ci reste la même dans le flux de données.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-126">Unless you resize the column length in a Flat File source or a transformation, the column length remains the same throughout the data flow.</span></span> <span data-ttu-id="4b5d4-127">Si ces colonnes mappent dans des colonnes de destination plus étroites, des avertissements apparaissent dans l'interface de l'utilisateur et, à l'exécution, des erreurs peuvent se produire du fait de la troncation des données.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-127">If these columns map to destination columns that are narrower, warnings appear in the user interface, and at run time, errors may occur due to data truncation.</span></span> <span data-ttu-id="4b5d4-128">Vous pouvez redimensionner les colonnes pour les rendre compatibles avec les colonnes de destination dans le gestionnaire de connexions de fichiers plats multiples, la source du fichier plat ou une transformation.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-128">You can resize the columns to be compatible with the destination columns in the Flat File connection manager, the Flat File source, or a transformation.</span></span> <span data-ttu-id="4b5d4-129">Pour modifier la longueur des colonnes de sortie, définissez la `Length` propriété de la colonne de sortie sous l’onglet **propriétés d’entrée et de sortie** de la boîte de dialogue **éditeur avancé** .</span><span class="sxs-lookup"><span data-stu-id="4b5d4-129">To modify the length of output columns, you set the `Length` property of the output column on the **Input and Output Properties** tab in the **Advanced Editor** dialog box.</span></span>  
  
 <span data-ttu-id="4b5d4-130">Si vous mettez à jour des longueurs de colonne dans le gestionnaire de connexions de fichiers plats multiples après avoir ajouté et configuré la source de fichier plat qui utilise le gestionnaire de connexions, vous n'avez pas à redimensionner manuellement les colonnes de sortie dans la source de fichier plat.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-130">If you update column lengths in the Multiple Flat Files connection manager after you have added and configured the Flat File source that uses the connection manager, you do not have to manually resize the output columns in the Flat File source.</span></span> <span data-ttu-id="4b5d4-131">Quand vous ouvrez la boîte de dialogue **Source du fichier plat** , la source du fichier plat offre la possibilité de synchroniser les métadonnées de la colonne.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-131">When you open the **Flat File Source** dialog box, the Flat File source provides an option to synchronize the column metadata.</span></span>  
  
## <a name="configuration-of-the-multiple-flat-files-connection-manager"></a><span data-ttu-id="4b5d4-132">Configuration du gestionnaire de connexions de fichiers plats multiples</span><span class="sxs-lookup"><span data-stu-id="4b5d4-132">Configuration of the Multiple Flat Files Connection Manager</span></span>  
 <span data-ttu-id="4b5d4-133">Vous pouvez définir les propriétés par le biais du concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] ou par programmation.</span><span class="sxs-lookup"><span data-stu-id="4b5d4-133">You can set properties through [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
 <span data-ttu-id="4b5d4-134">Pour plus d'informations sur les propriétés définissables dans le concepteur [!INCLUDE[ssIS](../../includes/ssis-md.md)] , cliquez sur l'une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="4b5d4-134">For more information about the properties that you can set in [!INCLUDE[ssIS](../../includes/ssis-md.md)] Designer, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="4b5d4-135">Éditeur du gestionnaire de connexions de fichiers plats multiples &#40;page Général&#41;</span><span class="sxs-lookup"><span data-stu-id="4b5d4-135">Multiple Flat Files Connection Manager Editor &#40;General Page&#41;</span></span>](../general-page-of-integration-services-designers-options.md)  
  
-   [<span data-ttu-id="4b5d4-136">Éditeur du gestionnaire de connexions de fichiers plats multiples &#40;page Colonnes&#41;</span><span class="sxs-lookup"><span data-stu-id="4b5d4-136">Multiple Flat Files Connection Manager Editor &#40;Columns Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-columns-page.md)  
  
-   [<span data-ttu-id="4b5d4-137">Éditeur du gestionnaire de connexions de fichiers plats multiples &#40;page Avancé&#41;</span><span class="sxs-lookup"><span data-stu-id="4b5d4-137">Multiple Flat Files Connection Manager Editor &#40;Advanced Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-advanced-page.md)  
  
-   [<span data-ttu-id="4b5d4-138">Éditeur du gestionnaire de connexions de fichiers plats multiples &#40;page Aperçu&#41;</span><span class="sxs-lookup"><span data-stu-id="4b5d4-138">Multiple Flat Files Connection Manager Editor &#40;Preview Page&#41;</span></span>](../multiple-flat-files-connection-manager-editor-preview-page.md)  
  
 <span data-ttu-id="4b5d4-139">Pour plus d’informations sur la configuration d’un gestionnaire de connexions par programmation, consultez <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> et [Ajout de connexions par programme](../building-packages-programmatically/adding-connections-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="4b5d4-139">For information about configuring a connection manager programmatically, see <xref:Microsoft.SqlServer.Dts.Runtime.ConnectionManager> and [Adding Connections Programmatically](../building-packages-programmatically/adding-connections-programmatically.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4b5d4-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4b5d4-140">See Also</span></span>  
 <span data-ttu-id="4b5d4-141">[Source de fichier plat](../data-flow/flat-file-source.md) </span><span class="sxs-lookup"><span data-stu-id="4b5d4-141">[Flat File Source](../data-flow/flat-file-source.md) </span></span>  
 <span data-ttu-id="4b5d4-142">[Destination de fichier plat](../data-flow/flat-file-destination.md) </span><span class="sxs-lookup"><span data-stu-id="4b5d4-142">[Flat File Destination](../data-flow/flat-file-destination.md) </span></span>  
 [<span data-ttu-id="4b5d4-143">Connexions Integration Services &#40;SSIS&#41;</span><span class="sxs-lookup"><span data-stu-id="4b5d4-143">Integration Services &#40;SSIS&#41; Connections</span></span>](integration-services-ssis-connections.md)  
  
  
