---
title: Gestionnaires d’événements Integration Services (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Integration Services packages, events
- run-time [Integration Services]
- SQL Server Integration Services packages, events
- event handlers [Integration Services], about event handlers
- events [Integration Services]
- packages [Integration Services], events
- event handlers [Integration Services]
- SSIS packages, events
- containers [Integration Services], events
- events [Integration Services], about events
ms.assetid: 6f60cf93-35dc-431c-908d-2049c4ab66ba
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 78bcd6579aa8306c89fd9530fad3557ac57f102a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605617"
---
# <a name="integration-services-ssis-event-handlers"></a><span data-ttu-id="955c8-102">Gestionnaires d'événements Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="955c8-102">Integration Services (SSIS) Event Handlers</span></span>
  <span data-ttu-id="955c8-103">Lors de l'exécution, les exécutables (packages, conteneurs de boucles Foreach, conteneurs de boucles For, conteneurs de séquences et conteneurs d'hôtes de tâches) déclenchent des événements.</span><span class="sxs-lookup"><span data-stu-id="955c8-103">At run time, executables (packages and Foreach Loop, For Loop, Sequence, and task host containers) raise events.</span></span> <span data-ttu-id="955c8-104">Par exemple, un événement OnError se déclenche lorsqu'une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="955c8-104">For example, an OnError event is raised when an error occurs.</span></span> <span data-ttu-id="955c8-105">Vous pouvez créer des gestionnaires d'événements personnalisés pour ces événements afin d'étendre les fonctionnalités des packages et les rendre plus faciles à gérer au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="955c8-105">You can create custom event handlers for these events to extend package functionality and make packages easier to manage at run time.</span></span> <span data-ttu-id="955c8-106">Les gestionnaires d'événements peuvent réaliser des tâches comme les suivantes :</span><span class="sxs-lookup"><span data-stu-id="955c8-106">Event handlers can perform tasks such as the following:</span></span>

-   <span data-ttu-id="955c8-107">nettoyer l'emplacement de stockage des données temporaires une fois l'exécution d'un package ou d'une tâche terminée ;</span><span class="sxs-lookup"><span data-stu-id="955c8-107">Clean up temporary data storage when a package or task finishes running.</span></span>

-   <span data-ttu-id="955c8-108">récupérer les informations système de manière à évaluer la disponibilité des ressources avant exécution d'un package ;</span><span class="sxs-lookup"><span data-stu-id="955c8-108">Retrieve system information to assess resource availability before a package runs.</span></span>

-   <span data-ttu-id="955c8-109">actualiser les données d'une table en cas d'échec d'une recherche dans une table de référence ;</span><span class="sxs-lookup"><span data-stu-id="955c8-109">Refresh data in a table when a lookup in a reference table fails.</span></span>

-   <span data-ttu-id="955c8-110">envoyer un message électronique lorsqu'une erreur ou un avertissement se produit ou lorsqu'une tâche échoue.</span><span class="sxs-lookup"><span data-stu-id="955c8-110">Send an e-mail message when an error or a warning occurs or when a task fails.</span></span>

 <span data-ttu-id="955c8-111">Si un événement ne possède pas de gestionnaire d'événements, il est remonté au conteneur qui se trouve un niveau au-dessus dans la hiérarchie des conteneurs d'un package.</span><span class="sxs-lookup"><span data-stu-id="955c8-111">If an event has no event handler, the event is raised to the next container up the container hierarchy in a package.</span></span> <span data-ttu-id="955c8-112">Si ce conteneur possède un gestionnaire d'événements, ce dernier est exécuté en réponse à l'événement.</span><span class="sxs-lookup"><span data-stu-id="955c8-112">If this container has an event handler, the event handler runs in response to the event.</span></span> <span data-ttu-id="955c8-113">Dans le cas contraire, l'événement est remonté au conteneur qui se trouve un niveau au-dessus dans la hiérarchie des conteneurs.</span><span class="sxs-lookup"><span data-stu-id="955c8-113">If not, the event is raised to the next container up the container hierarchy.</span></span>

 <span data-ttu-id="955c8-114">Le diagramme qui suit montre un package simple composé d'un conteneur de boucles For contenant une tâche d'exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="955c8-114">The following diagram shows a simple package that has a For Loop container that contains one Execute SQL task.</span></span>

 <span data-ttu-id="955c8-115">![Package, boucle For, hôte de tâche et tâche d'exécution SQL](media/mw-dts-eventhandlerpkg.gif "Package, boucle For, hôte de tâche et tâche d'exécution SQL")</span><span class="sxs-lookup"><span data-stu-id="955c8-115">![Package, For Loop, task host, and Execute SQL task](media/mw-dts-eventhandlerpkg.gif "Package, For Loop, task host, and Execute SQL task")</span></span>

 <span data-ttu-id="955c8-116">Seul le package possède un gestionnaire d'événements (pour son événement `OnError`).</span><span class="sxs-lookup"><span data-stu-id="955c8-116">Only the package has an event handler, for its `OnError` event.</span></span> <span data-ttu-id="955c8-117">Si une erreur se produit pendant l'exécution de la tâche d'exécution SQL, le gestionnaire d'événements `OnError` du package s'exécute.</span><span class="sxs-lookup"><span data-stu-id="955c8-117">If an error occurs when the Execute SQL task runs, the `OnError` event handler for the package runs.</span></span> <span data-ttu-id="955c8-118">Le diagramme qui suit montre la séquence d'appels qui conduit à l'exécution du gestionnaire d'événements `OnError` du package.</span><span class="sxs-lookup"><span data-stu-id="955c8-118">The following diagram shows the sequence of calls that causes the `OnError` event handler for the package to execute.</span></span>

 <span data-ttu-id="955c8-119">![Flux de gestionnaire d'événements](media/mw-dts-eventhandlers.gif "Flux de gestionnaire d’événements")</span><span class="sxs-lookup"><span data-stu-id="955c8-119">![Event handler flow](media/mw-dts-eventhandlers.gif "Event handler flow")</span></span>

 <span data-ttu-id="955c8-120">Les gestionnaires d'événements sont membres d'une collection de gestionnaires d'événements. Tous les conteneurs incluent cette collection.</span><span class="sxs-lookup"><span data-stu-id="955c8-120">Event handlers are members of an event handler collection, and all containers include this collection.</span></span> <span data-ttu-id="955c8-121">Si vous créez le package à l’aide du concepteur [!INCLUDE[ssIS](../includes/ssis-md.md)] , vous pouvez afficher les membres des collections de gestionnaires d’événements dans les dossiers **Gestionnaires d’événements** de l’onglet **Explorateur de package** du concepteur [!INCLUDE[ssIS](../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="955c8-121">If you create the package using [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, you can see the members of the event handler collections in the **Event Handlers** folders on the **Package Explorer** tab of [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer.</span></span>

 <span data-ttu-id="955c8-122">Vous pouvez configurer le conteneur du gestionnaire d'événements de plusieurs manières :</span><span class="sxs-lookup"><span data-stu-id="955c8-122">You can configure the event handler container in the following ways:</span></span>

-   <span data-ttu-id="955c8-123">indiquez le nom et la description du gestionnaire d'événements ;</span><span class="sxs-lookup"><span data-stu-id="955c8-123">Specify a name and description for the event handler.</span></span>

-   <span data-ttu-id="955c8-124">indiquez si le gestionnaire d'événements s'exécute, si le package échoue en cas d'échec du gestionnaire d'événements et indiquez le nombre d'erreurs autorisées avant échec du gestionnaire d'événements ;</span><span class="sxs-lookup"><span data-stu-id="955c8-124">Indicate whether the event handler runs, whether the package fails if the event handler fails, and the number of errors that can occur before the event handler fails.</span></span>

-   <span data-ttu-id="955c8-125">spécifiez un résultat d'exécution à renvoyer à la place du résultat d'exécution réel renvoyé au moment de l'exécution par le gestionnaire d'événements ;</span><span class="sxs-lookup"><span data-stu-id="955c8-125">Specify an execution result to return instead of the actual execution result that the event handler returns at run time.</span></span>

-   <span data-ttu-id="955c8-126">spécifiez l'option de transaction du gestionnaire d'événements ;</span><span class="sxs-lookup"><span data-stu-id="955c8-126">Specify the transaction option for the event handler.</span></span>

-   <span data-ttu-id="955c8-127">spécifiez le mode de journalisation utilisé par le gestionnaire d'événements.</span><span class="sxs-lookup"><span data-stu-id="955c8-127">Specify the logging mode that the event handler uses.</span></span>

## <a name="event-handler-content"></a><span data-ttu-id="955c8-128">Contenu du gestionnaire d'événements</span><span class="sxs-lookup"><span data-stu-id="955c8-128">Event Handler Content</span></span>
 <span data-ttu-id="955c8-129">La création d'un gestionnaire d'événements est similaire à la création d'un package. Un gestionnaire d'événements contient des tâches et des conteneurs qui sont mis en séquence de manière à former un flux de contrôle et peut inclure des flux de données.</span><span class="sxs-lookup"><span data-stu-id="955c8-129">Creating an event handler is similar to building a package; an event handler has tasks and containers, which are sequenced into a control flow, and an event handler can also include data flows.</span></span> <span data-ttu-id="955c8-130">Le concepteur [!INCLUDE[ssIS](../includes/ssis-md.md)] comprend un onglet **Gestionnaires d’événements** qui permet de créer des gestionnaires d’événements personnalisés.</span><span class="sxs-lookup"><span data-stu-id="955c8-130">The [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer includes the **Event Handlers** tab for creating custom event handlers.</span></span> <span data-ttu-id="955c8-131">Pour plus d’informations, consultez [gestionnaires d’événements de package SSIS](integration-services-ssis-event-handlers.md).</span><span class="sxs-lookup"><span data-stu-id="955c8-131">For more information, see [SSIS Package Event Handlers](integration-services-ssis-event-handlers.md).</span></span>

 <span data-ttu-id="955c8-132">Vous pouvez également créer des gestionnaires d'événements par programme.</span><span class="sxs-lookup"><span data-stu-id="955c8-132">You can also create event handlers programmatically.</span></span> <span data-ttu-id="955c8-133">Pour plus d’informations, consultez [Gestion des erreurs et des avertissements](building-packages-programmatically/handling-events-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="955c8-133">For more information, see [Handling Events Programmatically](building-packages-programmatically/handling-events-programmatically.md).</span></span>

## <a name="run-time-events"></a><span data-ttu-id="955c8-134">Événements d'exécution</span><span class="sxs-lookup"><span data-stu-id="955c8-134">Run-Time Events</span></span>
 <span data-ttu-id="955c8-135">Le tableau qui suit énumère les gestionnaires d'événements fournis par [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] et décrit les événements d'exécution provoquant leur exécution.</span><span class="sxs-lookup"><span data-stu-id="955c8-135">The following table lists the event handlers that [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] provides, and describes the run-time events that cause the event handler to run.</span></span>

|<span data-ttu-id="955c8-136">Gestionnaire d'événements</span><span class="sxs-lookup"><span data-stu-id="955c8-136">Event handler</span></span>|<span data-ttu-id="955c8-137">Événement</span><span class="sxs-lookup"><span data-stu-id="955c8-137">Event</span></span>|
|-------------------|-----------|
|`OnError`|<span data-ttu-id="955c8-138">Gestionnaire d'événements de l'événement `OnError`.</span><span class="sxs-lookup"><span data-stu-id="955c8-138">The event handler for the `OnError` event.</span></span> <span data-ttu-id="955c8-139">Cet événement est déclenché par un exécutable lorsqu'une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="955c8-139">This event is raised by an executable when an error occurs.</span></span>|
|<span data-ttu-id="955c8-140">**OnExecStatusChanged**</span><span class="sxs-lookup"><span data-stu-id="955c8-140">**OnExecStatusChanged**</span></span>|<span data-ttu-id="955c8-141">Gestionnaire d’événements de l’événement **OnExecStatusChanged** .</span><span class="sxs-lookup"><span data-stu-id="955c8-141">The event handler for the **OnExecStatusChanged** event.</span></span> <span data-ttu-id="955c8-142">Cet événement est déclenché par un exécutable lorsque son état d'exécution change.</span><span class="sxs-lookup"><span data-stu-id="955c8-142">This event is raised by an executable when its execution status changes.</span></span>|
|<span data-ttu-id="955c8-143">**OnInformation**</span><span class="sxs-lookup"><span data-stu-id="955c8-143">**OnInformation**</span></span>|<span data-ttu-id="955c8-144">Gestionnaire d’événements de l’événement **OnInformation** .</span><span class="sxs-lookup"><span data-stu-id="955c8-144">The event handler for the **OnInformation** event.</span></span> <span data-ttu-id="955c8-145">Cet événement se déclenche au cours de la validation et de l'exécution d'un exécutable afin de rapporter des informations.</span><span class="sxs-lookup"><span data-stu-id="955c8-145">This event is raised during the validation and execution of an executable to report information.</span></span> <span data-ttu-id="955c8-146">Cet événement véhicule des informations uniquement (aucune erreur ni avertissement).</span><span class="sxs-lookup"><span data-stu-id="955c8-146">This event conveys information only, no errors or warnings.</span></span>|
|<span data-ttu-id="955c8-147">**OnPostExecute**</span><span class="sxs-lookup"><span data-stu-id="955c8-147">**OnPostExecute**</span></span>|<span data-ttu-id="955c8-148">Gestionnaire d’événements de l’événement **OnPostExecute** .</span><span class="sxs-lookup"><span data-stu-id="955c8-148">The event handler for the **OnPostExecute** event.</span></span> <span data-ttu-id="955c8-149">Cet événement est déclenché par un exécutable immédiatement après la fin de son exécution.</span><span class="sxs-lookup"><span data-stu-id="955c8-149">This event is raised by an executable immediately after it has finished running.</span></span>|
|<span data-ttu-id="955c8-150">**OnPostValidate**</span><span class="sxs-lookup"><span data-stu-id="955c8-150">**OnPostValidate**</span></span>|<span data-ttu-id="955c8-151">Gestionnaire d’événements de l’événement **OnPostValidate** .</span><span class="sxs-lookup"><span data-stu-id="955c8-151">The event handler for the **OnPostValidate** event.</span></span> <span data-ttu-id="955c8-152">Cet événement est déclenché par un exécutable lorsque sa validation est terminée.</span><span class="sxs-lookup"><span data-stu-id="955c8-152">This event is raised by an executable when its validation is finished.</span></span>|
|<span data-ttu-id="955c8-153">**OnPreExecute**</span><span class="sxs-lookup"><span data-stu-id="955c8-153">**OnPreExecute**</span></span>|<span data-ttu-id="955c8-154">Gestionnaire d’événements de l’événement **OnPreExecute** .</span><span class="sxs-lookup"><span data-stu-id="955c8-154">The event handler for the **OnPreExecute** event.</span></span> <span data-ttu-id="955c8-155">Cet événement est déclenché par un exécutable immédiatement avant son exécution.</span><span class="sxs-lookup"><span data-stu-id="955c8-155">This event is raised by an executable immediately before it runs.</span></span>|
|<span data-ttu-id="955c8-156">**OnPreValidate**</span><span class="sxs-lookup"><span data-stu-id="955c8-156">**OnPreValidate**</span></span>|<span data-ttu-id="955c8-157">Gestionnaire d’événements de l’événement **OnPreValidate** .</span><span class="sxs-lookup"><span data-stu-id="955c8-157">The event handler for the **OnPreValidate** event.</span></span> <span data-ttu-id="955c8-158">Cet événement est déclenché par un exécutable lorsque sa validation démarre.</span><span class="sxs-lookup"><span data-stu-id="955c8-158">This event is raised by an executable when its validation starts.</span></span>|
|<span data-ttu-id="955c8-159">**OnProgress**</span><span class="sxs-lookup"><span data-stu-id="955c8-159">**OnProgress**</span></span>|<span data-ttu-id="955c8-160">Gestionnaire d’événements de l’événement **OnProgress** .</span><span class="sxs-lookup"><span data-stu-id="955c8-160">The event handler for the **OnProgress** event.</span></span> <span data-ttu-id="955c8-161">Cet événement est déclenché par un exécutable lorsqu'une progression mesurable est réalisée par l'exécutable.</span><span class="sxs-lookup"><span data-stu-id="955c8-161">This event is raised by an executable when measurable progress is made by the executable.</span></span>|
|<span data-ttu-id="955c8-162">**OnQueryCancel**</span><span class="sxs-lookup"><span data-stu-id="955c8-162">**OnQueryCancel**</span></span>|<span data-ttu-id="955c8-163">Gestionnaire d’événements de l’événement **OnQueryCancel** .</span><span class="sxs-lookup"><span data-stu-id="955c8-163">The event handler for the **OnQueryCancel** event.</span></span> <span data-ttu-id="955c8-164">Cet événement est déclenché par un exécutable pour déterminer si son exécution doit s'arrêter.</span><span class="sxs-lookup"><span data-stu-id="955c8-164">This event is raised by an executable to determine whether it should stop running.</span></span>|
|<span data-ttu-id="955c8-165">**OnTaskFailed**</span><span class="sxs-lookup"><span data-stu-id="955c8-165">**OnTaskFailed**</span></span>|<span data-ttu-id="955c8-166">Gestionnaire d’événements de l’événement **OnTaskFailed** .</span><span class="sxs-lookup"><span data-stu-id="955c8-166">The event handler for the **OnTaskFailed** event.</span></span> <span data-ttu-id="955c8-167">Cet événement est déclenché par une tâche lorsqu'elle échoue.</span><span class="sxs-lookup"><span data-stu-id="955c8-167">This event is raised by a task when it fails.</span></span>|
|<span data-ttu-id="955c8-168">**OnVariableValueChanged**</span><span class="sxs-lookup"><span data-stu-id="955c8-168">**OnVariableValueChanged**</span></span>|<span data-ttu-id="955c8-169">Gestionnaire d’événements de l’événement **OnVariableValueChanged** .</span><span class="sxs-lookup"><span data-stu-id="955c8-169">The event handler for the **OnVariableValueChanged** event.</span></span> <span data-ttu-id="955c8-170">Cet événement est déclenché par un exécutable lorsque la valeur d'une variable change.</span><span class="sxs-lookup"><span data-stu-id="955c8-170">This event is raised by an executable when the value of a variable changes.</span></span> <span data-ttu-id="955c8-171">L'événement est déclenché par l'exécutable sur lequel la variable est définie.</span><span class="sxs-lookup"><span data-stu-id="955c8-171">The event is raised by the executable on which the variable is defined.</span></span> <span data-ttu-id="955c8-172">Cet événement n’est pas déclenché si vous affectez à la propriété **RaiseChangeEvent** de la variable la valeur `False` .</span><span class="sxs-lookup"><span data-stu-id="955c8-172">This event is not raised if you set the **RaiseChangeEvent** property for the variable to `False`.</span></span> <span data-ttu-id="955c8-173">Pour plus d’informations, consultez [Variables Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="955c8-173">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>|
|<span data-ttu-id="955c8-174">**OnWarning**</span><span class="sxs-lookup"><span data-stu-id="955c8-174">**OnWarning**</span></span>|<span data-ttu-id="955c8-175">Gestionnaire d’événements de l’événement **OnWarning** .</span><span class="sxs-lookup"><span data-stu-id="955c8-175">The event handler for the **OnWarning** event.</span></span> <span data-ttu-id="955c8-176">Cet événement est déclenché par un exécutable lorsqu'un avertissement se produit.</span><span class="sxs-lookup"><span data-stu-id="955c8-176">This event is raised by an executable when a warning occurs.</span></span>|

## <a name="configuration-of-an-event-handler"></a><span data-ttu-id="955c8-177">Configuration d'un gestionnaire d'événements</span><span class="sxs-lookup"><span data-stu-id="955c8-177">Configuration of an Event Handler</span></span>
 <span data-ttu-id="955c8-178">Vous pouvez définir les propriétés dans la fenêtre **Propriétés** de [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] ou par programmation.</span><span class="sxs-lookup"><span data-stu-id="955c8-178">You can set properties in the **Properties** window of [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] or programmatically.</span></span>

 <span data-ttu-id="955c8-179">Pour plus d’informations sur la définition de ces propriétés dans [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], consultez [Définir les propriétés d’une tâche ou d’un conteneur](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span><span class="sxs-lookup"><span data-stu-id="955c8-179">For information about how to set these properties in [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)], see [Set the Properties of a Task or Container](../../2014/integration-services/set-the-properties-of-a-task-or-container.md).</span></span>

 <span data-ttu-id="955c8-180">Pour plus d’informations sur la définition par programmation de ces propriétés, consultez <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span><span class="sxs-lookup"><span data-stu-id="955c8-180">For information about programmatically setting these properties, see <xref:Microsoft.SqlServer.Dts.Runtime.DtsEventHandler>.</span></span>

## <a name="related-tasks"></a><span data-ttu-id="955c8-181">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="955c8-181">Related Tasks</span></span>
 <span data-ttu-id="955c8-182">Pour plus d’informations sur l’ajout d’un gestionnaire d’événements à un package, consultez [Ajouter un gestionnaire d’événements à un package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span><span class="sxs-lookup"><span data-stu-id="955c8-182">For information about how to add an event handler to a package, see [Add an Event Handler to a Package](../../2014/integration-services/add-an-event-handler-to-a-package.md).</span></span>


