---
title: Comparaison de données de chaînes | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613569"
---
# <a name="comparing-string-data"></a><span data-ttu-id="2bc4f-102">comparaison de données de chaînes</span><span class="sxs-lookup"><span data-stu-id="2bc4f-102">Comparing String Data</span></span>
  <span data-ttu-id="2bc4f-103">Les comparaisons de chaînes représentent une partie importante des transformations réalisées par [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]et peuvent également être utilisées pour l'évaluation d'expressions dans des variables et des expressions de propriétés.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="2bc4f-104">Ainsi, la transformation de tri peut comparer les valeurs d'un dataset afin de trier les données dans l'ordre croissant ou décroissant.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="2bc4f-105">Configuration des transformations pour les comparaisons de chaînes</span><span class="sxs-lookup"><span data-stu-id="2bc4f-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="2bc4f-106">Les transformations de tri, d'agrégation, de regroupement probable et de recherche floue peuvent être personnalisées afin de changer le mode de comparaison des chaînes au niveau de la colonne.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="2bc4f-107">Par exemple, vous pouvez spécifier qu'une comparaison ignore la casse, ce qui signifie que les caractères minuscules et majuscules sont considérés comme identiques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="2bc4f-108">Les transformations suivantes utilisent des expressions contenant des comparaisons de chaînes.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="2bc4f-109">La transformation de fractionnement conditionnel peut utiliser des comparaisons de chaînes dans des expressions afin de déterminer à quelle sortie envoyer la ligne de données.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="2bc4f-110">Pour plus d'informations, consultez [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="2bc4f-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="2bc4f-111">La transformation de colonne dérivée peut utiliser des comparaisons de chaînes dans des expressions afin de générer de nouvelles valeurs de colonnes.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="2bc4f-112">Pour plus d'informations, consultez [Transformation de colonne dérivée](transformations/derived-column-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="2bc4f-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="2bc4f-113">Les variables, les mappages de variables et les contraintes de précédence utilisent également des expressions qui peuvent inclure des comparaisons de chaînes.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="2bc4f-114">Pour plus d’informations sur les expressions, consultez [Expressions Integration Services &#40;SSIS&#41;](../expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="2bc4f-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="2bc4f-115">Traitement pendant la comparaison de chaînes</span><span class="sxs-lookup"><span data-stu-id="2bc4f-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="2bc4f-116">En fonction des données et de la configuration de la transformation, le traitement suivant peut être réalisé au cours de la comparaison de données chaînes :</span><span class="sxs-lookup"><span data-stu-id="2bc4f-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="2bc4f-117">conversion des données au format Unicode.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-117">Converting data to Unicode.</span></span> <span data-ttu-id="2bc4f-118">Si les données sources ne sont pas au format Unicode, elles sont automatiquement converties dans ce format avant la comparaison ;</span><span class="sxs-lookup"><span data-stu-id="2bc4f-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="2bc4f-119">utilisation de paramètres régionaux afin d'appliquer des règles spécifiques à un pays pour interpréter la date, l'heure, les données décimales et l'ordre de tri ;</span><span class="sxs-lookup"><span data-stu-id="2bc4f-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="2bc4f-120">application d'options de comparaison au niveau de la colonne afin de changer la sensibilité des comparaisons.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="2bc4f-121">Conversion de données de chaîne au format Unicode</span><span class="sxs-lookup"><span data-stu-id="2bc4f-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="2bc4f-122">En fonction des opérations réalisées par la transformation et de sa configuration, les données de chaîne peuvent être converties en type de données DT_WSTR, qui est une représentation Unicode des caractères.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="2bc4f-123">Les données de chaîne de type DT_STR sont converties en chaînes Unicode à l'aide de la page de codes de la colonne.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="2bc4f-124">prend en charge les pages de codes au niveau de la colonne et chaque colonne peut être convertie à l'aide d'une page de codes différente.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="2bc4f-125">Dans la plupart des cas, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] peut identifier la page de codes correcte à partir de la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="2bc4f-126">Par exemple, dans [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , vous pouvez définir un classement au niveau de la base de données et de la colonne.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="2bc4f-127">La page de codes provient d'un classement [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , qui peut être un classement Windows ou SQL.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="2bc4f-128">Si [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] propose une page de codes non attendue ou si le package accède à une source de données à l'aide d'un fournisseur ne donnant pas suffisamment d'informations pour déterminer la page de codes correcte, vous pouvez spécifier une page de codes par défaut dans la source ou la destination OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="2bc4f-129">Les pages de codes par défaut sont utilisées à la place des pages de codes fournies par [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="2bc4f-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="2bc4f-130">Les fichiers n'ont pas de pages de codes.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-130">Files do not have code pages.</span></span> <span data-ttu-id="2bc4f-131">À la place, les gestionnaires de connexions de fichiers plats et de fichiers plats multiples utilisés par un package pour se connecter aux données du fichier utilisent une propriété permettant de spécifier la page de codes du fichier.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="2bc4f-132">Cette page de codes peut être définie au niveau du fichier uniquement, pas au niveau de la colonne.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="2bc4f-133">Définition des paramètres régionaux</span><span class="sxs-lookup"><span data-stu-id="2bc4f-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="2bc4f-134">n’utilise pas la page de codes pour déduire les règles spécifiques à un pays servant à trier les données ou à interpréter la date, l’heure et les données décimales.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="2bc4f-135">Au lieu de cela, la transformation lit les paramètres régionaux définis par la propriété LocaleId au niveau du composant de flux de données, de la tâche de flux de données, du conteneur ou du package.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="2bc4f-136">Par défaut, les paramètres régionaux d'une transformation sont hérités de sa tâche de flux de données, qui elle-même les héritent du package.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="2bc4f-137">Si la tâche de flux de données se trouve dans un conteneur comme le conteneur de boucles For, elle hérite ses paramètres régionaux du conteneur.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="2bc4f-138">Vous pouvez également spécifier des paramètres régionaux pour un gestionnaire de connexions de fichiers plats et un gestionnaire de connexions de fichiers plats multiples.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="2bc4f-139">Définition des options de comparaison</span><span class="sxs-lookup"><span data-stu-id="2bc4f-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="2bc4f-140">Les paramètres régionaux déterminent les règles de base pour la comparaison de données chaînes.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="2bc4f-141">Ils indiquent par exemple la position de tri de chaque lettre dans l'alphabet.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="2bc4f-142">Cependant, ces règles ne suffisent pas toujours dans les comparaisons réalisées par certaines transformations et [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] prend en charge un ensemble d'options de comparaison avancées extrapolant les règles de comparaison des paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="2bc4f-143">Ces options de comparaison sont définies au niveau de la colonne.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="2bc4f-144">Une de ces options de comparaison permet par exemple d'ignorer les caractères sans espace.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="2bc4f-145">L’effet de cette option est d’ignorer les signes diacritiques tels que l’accent, ce qui rend « a » et « å » identiques à des fins de comparaison.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="2bc4f-146">Le tableau qui suit décrit les options de comparaison et un style de tri.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="2bc4f-147">Option de comparaison</span><span class="sxs-lookup"><span data-stu-id="2bc4f-147">Comparison option</span></span>|<span data-ttu-id="2bc4f-148">Description</span><span class="sxs-lookup"><span data-stu-id="2bc4f-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="2bc4f-149">Ignorer la casse</span><span class="sxs-lookup"><span data-stu-id="2bc4f-149">Ignore case</span></span>|<span data-ttu-id="2bc4f-150">Indique si la comparaison fait la distinction entre les lettres majuscules et minuscules.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="2bc4f-151">Si cette option est définie, la comparaison de chaînes ignore la casse.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="2bc4f-152">Par exemple, « ABC » est alors identique à « abc ».</span><span class="sxs-lookup"><span data-stu-id="2bc4f-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="2bc4f-153">Ignorer le type de caractères Kana</span><span class="sxs-lookup"><span data-stu-id="2bc4f-153">Ignore kana type</span></span>|<span data-ttu-id="2bc4f-154">Indique si la comparaison fait la distinction entre les deux types de caractères japonais Kana : Hiragana et Katakana.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="2bc4f-155">Si cette option est définie, la comparaison de chaînes ignore le type Kana.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="2bc4f-156">Ignorer la largeur des caractères</span><span class="sxs-lookup"><span data-stu-id="2bc4f-156">Ignore character width</span></span>|<span data-ttu-id="2bc4f-157">Indique si la comparaison fait la distinction entre un caractère sur un octet et le même caractère représenté sur deux octets.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="2bc4f-158">Si cette option est définie, la comparaison de chaînes traite les représentations sur un octet et sur deux octets du même caractère comme identiques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="2bc4f-159">Ignorer les caractères sans espace</span><span class="sxs-lookup"><span data-stu-id="2bc4f-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="2bc4f-160">Indique si la comparaison fait la distinction entre les caractères avec espace et les caractères diacritiques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="2bc4f-161">Si cette option est définie, la comparaison ignore les caractères diacritiques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="2bc4f-162">Par exemple, « å » est identique à « a ».</span><span class="sxs-lookup"><span data-stu-id="2bc4f-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="2bc4f-163">Ignorer les symboles</span><span class="sxs-lookup"><span data-stu-id="2bc4f-163">Ignore symbols</span></span>|<span data-ttu-id="2bc4f-164">Indique si la comparaison fait la distinction entre les lettres et les symboles comme les espaces blancs, la ponctuation, les symboles de devise et les symboles mathématiques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="2bc4f-165">Si cette option est définie, la comparaison de chaînes ignore les symboles.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="2bc4f-166">Par exemple, «  New York »" est identique à « New York » et « \*ABC » est identique à « ABC ».</span><span class="sxs-lookup"><span data-stu-id="2bc4f-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="2bc4f-167">Trier la ponctuation comme des symboles</span><span class="sxs-lookup"><span data-stu-id="2bc4f-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="2bc4f-168">Indique si la comparaison trie tous les symboles de ponctuation, à l'exception du tiret et de l'apostrophe, avant les caractères alphanumériques.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="2bc4f-169">Par exemple, si cette option est définie ; « .ABC » arrive avant « ABC » dans le tri.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="2bc4f-170">Les transformations de tri, d'agrégation, de regroupement probable et de recherche floue incluent ces options pour la comparaison de données.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="2bc4f-171">La balise de comparaison **FullySensitive** s'affiche dans la boîte de dialogue **Éditeur avancé** pour les transformations de regroupement probable et de recherche floue.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="2bc4f-172">Le fait de sélectionner l'indicateur de comparaison **FullySensitive** signifie que toutes les options de comparaison s'appliquent.</span><span class="sxs-lookup"><span data-stu-id="2bc4f-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2bc4f-173">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2bc4f-173">See Also</span></span>  
 <span data-ttu-id="2bc4f-174">[Types de données d’Integration Services](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="2bc4f-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="2bc4f-175">[Analyse rapide](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="2bc4f-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="2bc4f-176">Analyse standard</span><span class="sxs-lookup"><span data-stu-id="2bc4f-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
