---
title: Composant Script | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.scriptcomponentdetails.f1
helpviewer_keywords:
- Script transformation
- scripts [Integration Services], transformations
- Script component [Integration Services], about Script component
- Script component [Integration Services]
ms.assetid: 131c2d0c-2e33-4785-94af-ada5c049821e
author: chugugrace
ms.author: chugu
ms.openlocfilehash: af8e500e399b0f69a7e34c9e2e01c74d83256107
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87710775"
---
# <a name="script-component"></a><span data-ttu-id="781f0-102">Composant Script</span><span class="sxs-lookup"><span data-stu-id="781f0-102">Script Component</span></span>
  <span data-ttu-id="781f0-103">Le composant Script héberge le script et permet à un package d'inclure du code de script personnalisé et de l'exécuter.</span><span class="sxs-lookup"><span data-stu-id="781f0-103">The Script component hosts script and enables a package to include and run custom script code.</span></span> <span data-ttu-id="781f0-104">Vous pouvez utiliser le composant Script dans des packages pour :</span><span class="sxs-lookup"><span data-stu-id="781f0-104">You can use the Script component in packages for the following purposes:</span></span>  
  
-   <span data-ttu-id="781f0-105">Appliquer plusieurs transformations aux données, au lieu d'utiliser plusieurs transformations dans le flux de données.</span><span class="sxs-lookup"><span data-stu-id="781f0-105">Apply multiple transformations to data instead of using multiple transformations in the data flow.</span></span> <span data-ttu-id="781f0-106">Par exemple, un script peut ajouter les valeurs de deux colonnes, puis calculer la moyenne de la somme.</span><span class="sxs-lookup"><span data-stu-id="781f0-106">For example, a script can add the values in two columns and then calculate the average of the sum.</span></span>  
  
-   <span data-ttu-id="781f0-107">Accéder aux règles métier dans un assembly .NET existant.</span><span class="sxs-lookup"><span data-stu-id="781f0-107">Access business rules in an existing .NET assembly.</span></span> <span data-ttu-id="781f0-108">Par exemple, un script peut appliquer une règle métier qui spécifie la plage de valeurs correctes dans une colonne `Income`.</span><span class="sxs-lookup"><span data-stu-id="781f0-108">For example, a script can apply a business rule that specifies the range of values that are valid in an `Income` column.</span></span>  
  
-   <span data-ttu-id="781f0-109">Utiliser des formules et des fonctions personnalisées en plus des fonctions et des opérateurs fournis par la grammaire des expressions [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="781f0-109">Use custom formulas and functions in addition to the functions and operators that the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] expression grammar provides.</span></span> <span data-ttu-id="781f0-110">Par exemple, validez les numéros de carte de crédit qui utilisent la formule LUHN.</span><span class="sxs-lookup"><span data-stu-id="781f0-110">For example, validate credit card numbers that use the LUHN formula.</span></span>  
  
-   <span data-ttu-id="781f0-111">Valider les données des colonnes et ignorer les enregistrements contenant des données non valides.</span><span class="sxs-lookup"><span data-stu-id="781f0-111">Validate column data and skip records that contain invalid data.</span></span> <span data-ttu-id="781f0-112">Par exemple, un script peut évaluer un montant de frais de port raisonnable et ignorer les enregistrements présentant des montants extrêmement élevés ou bas.</span><span class="sxs-lookup"><span data-stu-id="781f0-112">For example, a script can assess the reasonableness of a postage amount and skip records with extremely high or low amounts.</span></span>  
  
 <span data-ttu-id="781f0-113">Le composant Script est un moyen simple et rapide d'inclure des fonctions personnalisées dans un flux de données.</span><span class="sxs-lookup"><span data-stu-id="781f0-113">The Script component provides an easy and quick way to include custom functions in a data flow.</span></span> <span data-ttu-id="781f0-114">Néanmoins, si vous envisagez de réutiliser le code de script dans plusieurs packages, vous devez envisager de programmer un composant personnalisé au lieu d'utiliser le composant Script.</span><span class="sxs-lookup"><span data-stu-id="781f0-114">However, if you plan to reuse the script code in multiple packages, you should consider programming a custom component instead of using the Script component.</span></span> <span data-ttu-id="781f0-115">Pour plus d’informations, consultez [Développement d’un composant de flux de données personnalisé](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="781f0-115">For more information, see [Developing a Custom Data Flow Component](../../extending-packages-custom-objects/data-flow/developing-a-custom-data-flow-component.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="781f0-116">Si le composant Script contient un script qui essaie de lire la valeur d'une colonne qui est NULL, il échoue lorsque vous exécutez le package.</span><span class="sxs-lookup"><span data-stu-id="781f0-116">If the Script component contains a script that tries to read the value of a column that is NULL, the Script component fails when you run the package.</span></span> <span data-ttu-id="781f0-117">Il est recommandé que votre script utilise la méthode <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> pour déterminer si la colonne est NULL avant d’essayer de lire la valeur de la colonne.</span><span class="sxs-lookup"><span data-stu-id="781f0-117">We recommend that your script use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer.IsNull%2A> method to determine whether the column is NULL before trying to read the column value.</span></span>  
  
 <span data-ttu-id="781f0-118">Le composant Script peut être utilisé en tant que source, transformation ou destination.</span><span class="sxs-lookup"><span data-stu-id="781f0-118">The Script component can be used as a source, a transformation, or a destination.</span></span> <span data-ttu-id="781f0-119">Il prend en charge une entrée et plusieurs sorties.</span><span class="sxs-lookup"><span data-stu-id="781f0-119">This component supports one input and multiple outputs.</span></span> <span data-ttu-id="781f0-120">En fonction de l'utilisation qui est faite du composant, il prendra en charge une entrée ou des sorties, ou bien les deux.</span><span class="sxs-lookup"><span data-stu-id="781f0-120">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="781f0-121">Le script est appelé par chaque ligne de l'entrée ou de la sortie.</span><span class="sxs-lookup"><span data-stu-id="781f0-121">The script is invoked by every row in the input or output.</span></span>  
  
-   <span data-ttu-id="781f0-122">Utilisé comme source, le composant Script prend en charge plusieurs sorties.</span><span class="sxs-lookup"><span data-stu-id="781f0-122">If used as a source, the Script component supports multiple outputs.</span></span>  
  
-   <span data-ttu-id="781f0-123">Utilisé comme transformation, le composant Script prend en charge une entrée et plusieurs sorties.</span><span class="sxs-lookup"><span data-stu-id="781f0-123">If used as a transformation, the Script component supports one input and multiple outputs.</span></span>  
  
-   <span data-ttu-id="781f0-124">Utilisé comme destination, le composant Script prend en charge une entrée.</span><span class="sxs-lookup"><span data-stu-id="781f0-124">If used as a destination, the Script component supports one input.</span></span>  
  
 <span data-ttu-id="781f0-125">Le composant Script ne prend pas en charge les affichages des erreurs.</span><span class="sxs-lookup"><span data-stu-id="781f0-125">The Script component does not support error outputs.</span></span>  
  
 <span data-ttu-id="781f0-126">Lorsque vous avez décidé que le composant Script est le choix approprié pour votre package, vous devez configurer les entrées et sorties, développer le script que le composant utilise et configurer le composant lui-même.</span><span class="sxs-lookup"><span data-stu-id="781f0-126">After you decide that the Script component is the appropriate choice for your package, you have to configure the inputs and outputs, develop the script that the component uses, and configure the component itself.</span></span>  
  
## <a name="understanding-the-script-component-modes"></a><span data-ttu-id="781f0-127">Présentation des modes du composant Script</span><span class="sxs-lookup"><span data-stu-id="781f0-127">Understanding the Script Component Modes</span></span>  
 <span data-ttu-id="781f0-128">Dans le concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , le composant Script propose deux modes : le mode Création des métadonnées et le mode Création du code.</span><span class="sxs-lookup"><span data-stu-id="781f0-128">In the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata-design mode and code-design mode.</span></span> <span data-ttu-id="781f0-129">En mode Création des métadonnées, vous pouvez ajouter et modifier les entrées et les sorties du composant Script, mais vous ne pouvez pas écrire de code.</span><span class="sxs-lookup"><span data-stu-id="781f0-129">In metadata-design mode, you can add and modify the Script component inputs and outputs, but you cannot write code.</span></span> <span data-ttu-id="781f0-130">Une fois toutes les entrées et sorties configurées, vous devez basculer en mode Création du code afin d'écrire le script.</span><span class="sxs-lookup"><span data-stu-id="781f0-130">After all the inputs and outputs are configured, you switch to code-design mode to write the script.</span></span> <span data-ttu-id="781f0-131">Le composant Script génère automatiquement le code de base à partir des métadonnées des entrées et des sorties.</span><span class="sxs-lookup"><span data-stu-id="781f0-131">The Script component automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="781f0-132">Si vous modifiez les métadonnées une fois que le composant Script a généré le code de base, votre code risque de ne plus se compiler, car le code de base compilé mis à jour sera peut-être incompatible avec votre code.</span><span class="sxs-lookup"><span data-stu-id="781f0-132">If you change the metadata after the Script component generates the base code, your code may no longer compile because the updated base code may be incompatible with your code.</span></span>  
  
## <a name="writing-the-script-that-the-component-uses"></a><span data-ttu-id="781f0-133">Écriture du script utilisé par le composant</span><span class="sxs-lookup"><span data-stu-id="781f0-133">Writing the Script that the Component Uses</span></span>  
 <span data-ttu-id="781f0-134">Le composant Script utilise [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) comme environnement d’écriture des scripts.</span><span class="sxs-lookup"><span data-stu-id="781f0-134">The Script component uses [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) as the environment in which you write the scripts.</span></span> <span data-ttu-id="781f0-135">Vous pouvez accéder à VSTA à partir de **l’Éditeur de transformation de script**.</span><span class="sxs-lookup"><span data-stu-id="781f0-135">You access VSTA from the **Script Transformation Editor**.</span></span> <span data-ttu-id="781f0-136">Pour plus d’informations, consultez [Éditeur de transformation de script &#40;page Script&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="781f0-136">For more information, see [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="781f0-137">Le composant Script propose un projet VSTA qui inclut une classe auto-générée, nommée ScriptMain, qui représente les métadonnées du composant.</span><span class="sxs-lookup"><span data-stu-id="781f0-137">The Script component provides a VSTA project that includes an auto-generated class, named ScriptMain, that represents the component metadata.</span></span> <span data-ttu-id="781f0-138">Par exemple, si le composant Script est utilisé en tant que transformation avec trois sorties, ScriptMain inclut une méthode pour chaque sortie.</span><span class="sxs-lookup"><span data-stu-id="781f0-138">For example, if the Script component is used as a transformation that has three outputs, ScriptMain includes a method for each output.</span></span> <span data-ttu-id="781f0-139">ScriptMain est le point d'entrée dans le script.</span><span class="sxs-lookup"><span data-stu-id="781f0-139">ScriptMain is the entry point to the script.</span></span>  
  
 <span data-ttu-id="781f0-140">VSTA contient l'ensemble des fonctionnalités standard de l'environnement [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] , comme l'éditeur [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] à code de couleur, IntelliSense et l'Explorateur d'objets.</span><span class="sxs-lookup"><span data-stu-id="781f0-140">VSTA includes all the standard features of the [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] environment, such as the color-coded [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] editor, IntelliSense, and Object Browser.</span></span> <span data-ttu-id="781f0-141">Le script utilisé par le composant Script est stocké dans la définition du package.</span><span class="sxs-lookup"><span data-stu-id="781f0-141">The script that the Script component uses is stored in the package definition.</span></span> <span data-ttu-id="781f0-142">Quand vous concevez le package, le code de script est écrit temporairement dans un fichier projet.</span><span class="sxs-lookup"><span data-stu-id="781f0-142">When you are designing the package, the script code is temporarily written to a project file.</span></span>  
  
 <span data-ttu-id="781f0-143">VSTA prend en charge les langages de programmation [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# et [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="781f0-143">VSTA supports the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# and [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic programming languages.</span></span>  
  
 <span data-ttu-id="781f0-144">Pour plus d’informations sur la programmation du composant Script, consultez [Extension du flux de données avec le composant Script](script-component.md).</span><span class="sxs-lookup"><span data-stu-id="781f0-144">For information about how to program the Script component, see [Extending the Data Flow with the Script Component](script-component.md).</span></span> <span data-ttu-id="781f0-145">Pour obtenir des informations spécifiques sur la configuration du composant Script en tant que source, transformation ou destination, consultez [Développement de types spécifiques de composants Script](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="781f0-145">For more specific information about how to configure the Script component as a source, transformation, or destination, see [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span> <span data-ttu-id="781f0-146">Pour obtenir d’autres exemples, notamment une destination ODBC, démontrant l’utilisation du composant Script, consultez [Exemples supplémentaires du composant Script](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span><span class="sxs-lookup"><span data-stu-id="781f0-146">For additional examples such as an ODBC destination that demonstrate the use of the Script component, see [Additional Script Component Examples](../../extending-packages-scripting-data-flow-script-component-examples/additional-script-component-examples.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="781f0-147">Contrairement aux versions antérieures pour lesquelles il était possible d’indiquer si les scripts étaient précompilés, tous les scripts de [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] et des versions ultérieures sont précompilés.</span><span class="sxs-lookup"><span data-stu-id="781f0-147">Unlike earlier versions where you could indicate whether the scripts were precompiled, all scripts are precompiled in [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions.</span></span> <span data-ttu-id="781f0-148">Lorsqu'un script est précompilé, le moteur de langage n'est pas chargé au moment de l'exécution et le package s'exécute plus rapidement.</span><span class="sxs-lookup"><span data-stu-id="781f0-148">When a script is precompiled, the language engine is not loaded at run time and the package runs more quickly.</span></span> <span data-ttu-id="781f0-149">Toutefois, les fichiers binaires précompilés occupent un espace disque important.</span><span class="sxs-lookup"><span data-stu-id="781f0-149">However, precompiled binary files consume significant disk space.</span></span>  
  
## <a name="configuring-the-script-component"></a><span data-ttu-id="781f0-150">Configuration du composant Script</span><span class="sxs-lookup"><span data-stu-id="781f0-150">Configuring the Script Component</span></span>  
 <span data-ttu-id="781f0-151">Vous pouvez configurer le composant Script de plusieurs manières :</span><span class="sxs-lookup"><span data-stu-id="781f0-151">You can configure the Script component in the following ways:</span></span>  
  
-   <span data-ttu-id="781f0-152">Sélectionnez les colonnes d'entrée à référencer.</span><span class="sxs-lookup"><span data-stu-id="781f0-152">Select the input columns to reference.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="781f0-153">Vous pouvez configurer une seule entrée quand vous utilisez le concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="781f0-153">You can configure only one input when you use the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer.</span></span>  
  
-   <span data-ttu-id="781f0-154">Indiquez le script exécuté par le composant.</span><span class="sxs-lookup"><span data-stu-id="781f0-154">Provide the script that the component runs.</span></span>  
  
-   <span data-ttu-id="781f0-155">Spécifiez le langage de script</span><span class="sxs-lookup"><span data-stu-id="781f0-155">Specify the script language.</span></span>  
  
-   <span data-ttu-id="781f0-156">Fournissez des listes de variables en lecture seule et en lecture/écrite séparées par des virgules.</span><span class="sxs-lookup"><span data-stu-id="781f0-156">Provide comma-separated lists of read-only and read/write variables.</span></span>  
  
-   <span data-ttu-id="781f0-157">Ajoutez des sorties supplémentaires, ainsi que des colonnes de sortie auxquelles le script affecte des valeurs.</span><span class="sxs-lookup"><span data-stu-id="781f0-157">Add more outputs, and add output columns to which the script assigns.</span></span>  
  
 <span data-ttu-id="781f0-158">Vous pouvez définir les propriétés par le biais du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] ou par programmation.</span><span class="sxs-lookup"><span data-stu-id="781f0-158">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
### <a name="configuring-the-script-component-in-the-designer"></a><span data-ttu-id="781f0-159">Configuration du composant Script dans le concepteur</span><span class="sxs-lookup"><span data-stu-id="781f0-159">Configuring the Script Component in the Designer</span></span>  
 <span data-ttu-id="781f0-160">Pour plus d’informations sur les propriétés définissables dans la boîte de dialogue **Éditeur de transformation de script**, cliquez sur l’une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="781f0-160">For more information about the properties that you can set in the **Script Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="781f0-161">Éditeur de transformation de script &#40;page Colonnes d’entrée&#41;</span><span class="sxs-lookup"><span data-stu-id="781f0-161">Script Transformation Editor &#40;Input Columns Page&#41;</span></span>](../../script-transformation-editor-input-columns-page.md)  
  
-   [<span data-ttu-id="781f0-162">Éditeur de transformation de script &#40;page Entrées et sorties&#41;</span><span class="sxs-lookup"><span data-stu-id="781f0-162">Script Transformation Editor &#40;Inputs and Outputs Page&#41;</span></span>](../../script-transformation-editor-inputs-and-outputs-page.md)  
  
-   [<span data-ttu-id="781f0-163">Éditeur de transformation de script &#40;page Script&#41;</span><span class="sxs-lookup"><span data-stu-id="781f0-163">Script Transformation Editor &#40;Script Page&#41;</span></span>](../../script-transformation-editor-script-page.md)  
  
-   [<span data-ttu-id="781f0-164">Éditeur de transformation de script &#40;page Gestionnaires de connexions&#41;</span><span class="sxs-lookup"><span data-stu-id="781f0-164">Script Transformation Editor &#40;Connection Managers Page&#41;</span></span>](../../script-transformation-editor-connection-managers-page.md)  
  
 <span data-ttu-id="781f0-165">Pour plus d'informations sur la définition de ces propriétés dans le concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , cliquez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="781f0-165">For more information about how to set these properties in [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="781f0-166">Définir les propriétés d’un composant de flux de données</span><span class="sxs-lookup"><span data-stu-id="781f0-166">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
### <a name="configuring-the-script-component-programmatically"></a><span data-ttu-id="781f0-167">Configuration du composant Script par programmation</span><span class="sxs-lookup"><span data-stu-id="781f0-167">Configuring the Script Component Programmatically</span></span>  
 <span data-ttu-id="781f0-168">Pour plus d’informations sur les propriétés définissables dans la fenêtre **Propriétés** ou par programmation, cliquez sur l’une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="781f0-168">For more information about the properties that you can set in the **Properties** window or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="781f0-169">Propriétés communes</span><span class="sxs-lookup"><span data-stu-id="781f0-169">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="781f0-170">Propriétés personnalisées des transformations</span><span class="sxs-lookup"><span data-stu-id="781f0-170">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
 <span data-ttu-id="781f0-171">Pour plus d'informations sur la définition des propriétés, cliquez sur l'une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="781f0-171">For more information about how to set properties, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="781f0-172">Définir les propriétés d’un composant de flux de données</span><span class="sxs-lookup"><span data-stu-id="781f0-172">Set the Properties of a Data Flow Component</span></span>](../set-the-properties-of-a-data-flow-component.md)  
  
## <a name="related-content"></a><span data-ttu-id="781f0-173">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="781f0-173">Related Content</span></span>  
 [<span data-ttu-id="781f0-174">Transformations Integration Services</span><span class="sxs-lookup"><span data-stu-id="781f0-174">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
 [<span data-ttu-id="781f0-175">Extension du flux de données avec le composant Script</span><span class="sxs-lookup"><span data-stu-id="781f0-175">Extending the Data Flow with the Script Component</span></span>](script-component.md)  
  
  
