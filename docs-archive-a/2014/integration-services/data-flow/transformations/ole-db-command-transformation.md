---
title: Commande OLE DB, transformation | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.oledbcommandtrans.f1
helpviewer_keywords:
- statements [Integration Services]
- OLE DB Command transformation
ms.assetid: baa6735c-5acf-4759-b077-1216aca16c6c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: a6b0498d0ae5fa61a00cc7f6fc89e4dc506cd25a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87710788"
---
# <a name="ole-db-command-transformation"></a><span data-ttu-id="60007-102">transformation de commande OLE DB</span><span class="sxs-lookup"><span data-stu-id="60007-102">OLE DB Command Transformation</span></span>
  <span data-ttu-id="60007-103">La transformation de commande OLE DB exécute une instruction SQL pour chaque ligne d'un flux de données.</span><span class="sxs-lookup"><span data-stu-id="60007-103">The OLE DB Command transformation runs an SQL statement for each row in a data flow.</span></span> <span data-ttu-id="60007-104">Par exemple, vous pouvez exécuter une instruction SQL qui insère, met à jour ou supprime des lignes d'une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="60007-104">For example, you can run an SQL statement that inserts, updates, or deletes rows in a database table.</span></span>  
  
 <span data-ttu-id="60007-105">Vous pouvez configurer la transformation de commande OLE DB de plusieurs manières :</span><span class="sxs-lookup"><span data-stu-id="60007-105">You can configure the OLE DB Command Transformation in the following ways:</span></span>  
  
-   <span data-ttu-id="60007-106">Spécifiez l'instruction SQL exécutée par la transformation pour chaque ligne.</span><span class="sxs-lookup"><span data-stu-id="60007-106">Provide the SQL statement that the transformation runs for each row.</span></span>  
  
-   <span data-ttu-id="60007-107">Spécifiez le nombre de secondes accordées pour l'exécution de l'instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="60007-107">Specify the number of seconds before the SQL statement times out.</span></span>  
  
-   <span data-ttu-id="60007-108">Spécifiez la page de codes par défaut.</span><span class="sxs-lookup"><span data-stu-id="60007-108">Specify the default code page.</span></span>  
  
 <span data-ttu-id="60007-109">En général, l'instruction SQL inclut des paramètres.</span><span class="sxs-lookup"><span data-stu-id="60007-109">Typically, the SQL statement includes parameters.</span></span> <span data-ttu-id="60007-110">Les valeurs des paramètres sont stockées dans des colonnes externes dans l'entrée de transformation et le mappage d'une colonne d'entrée à une colonne externe mappe une colonne d'entrée à un paramètre.</span><span class="sxs-lookup"><span data-stu-id="60007-110">The parameter values are stored in external columns in the transformation input, and mapping an input column to an external column maps an input column to a parameter.</span></span> <span data-ttu-id="60007-111">Par exemple, pour rechercher des lignes dans la table **DimProduct** par la valeur de leur colonne **ProductKey** et pour les supprimer, vous pouvez mapper la colonne externe nommée **Param_0** à la colonne d’entrée nommée **ProductKey** , puis exécuter l’instruction SQL `DELETE FROM DimProduct WHERE ProductKey = ?`.</span><span class="sxs-lookup"><span data-stu-id="60007-111">For example, to locate rows in the **DimProduct** table by the value in their **ProductKey** column and then delete them, you can map the external column named **Param_0** to the input column named **ProductKey,** and then run the SQL statement `DELETE FROM DimProduct WHERE ProductKey = ?`..</span></span> <span data-ttu-id="60007-112">La transformation de commande OLE DB fournit les noms des paramètres, que vous ne pouvez pas modifier.</span><span class="sxs-lookup"><span data-stu-id="60007-112">The OLE DB Command transformation provides the parameter names and you cannot modify them.</span></span> <span data-ttu-id="60007-113">Les noms des paramètres sont **Param_0**, **Param_1**et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="60007-113">The parameter names are **Param_0**, **Param_1**, and so on.</span></span>  
  
 <span data-ttu-id="60007-114">Si vous configurez la transformation de commande OLE DB à l'aide de la boîte de dialogue **Éditeur avancé** , les paramètres de l'instruction SQL peuvent être mappés automatiquement à des colonnes externes dans l'entrée de transformation (et les caractéristiques de chaque paramètre définis) en cliquant sur le bouton **Actualiser** .</span><span class="sxs-lookup"><span data-stu-id="60007-114">If you configure the OLE DB Command transformation by using the **Advanced Editor** dialog box, the parameters in the SQL statement may be mapped automatically to external columns in the transformation input, and the characteristics of each parameter defined, by clicking the **Refresh** button.</span></span> <span data-ttu-id="60007-115">Toutefois, si le fournisseur OLE DB utilisé par la transformation de commande OLE DB ne prend pas en charge la dérivation d'informations de paramètres à partir du paramètre, vous devez configurer les colonnes externes manuellement.</span><span class="sxs-lookup"><span data-stu-id="60007-115">However, if the OLE DB provider that the OLE DB Command transformation uses does not support deriving parameter information from the parameter, you must configure the external columns manually.</span></span> <span data-ttu-id="60007-116">Cela signifie que vous devez ajouter une colonne pour chaque paramètre à l’entrée externe de la transformation, mettre à jour les noms de colonnes de façon à utiliser des noms tels que **Param_0**, spécifier la valeur de la propriété DBParamInfoFlags, puis mapper les colonnes d’entrée qui contiennent des valeurs de paramètres aux colonnes externes.</span><span class="sxs-lookup"><span data-stu-id="60007-116">This means that you must add a column for each parameter to the external input to the transformation, update the column names to use names like **Param_0**, specify the value of the DBParamInfoFlags property, and map the input columns that contain parameter values to the external columns.</span></span>  
  
 <span data-ttu-id="60007-117">La valeur de DBParamInfoFlags représente les caractéristiques du paramètre.</span><span class="sxs-lookup"><span data-stu-id="60007-117">The value of DBParamInfoFlags represents the characteristics of the parameter.</span></span> <span data-ttu-id="60007-118">Par exemple, la valeur **1** indique qu'il s'agit d'un paramètre d'entrée et la valeur **65** indique qu'il s'agit d'un paramètre d'entrée pouvant contenir une valeur nulle.</span><span class="sxs-lookup"><span data-stu-id="60007-118">For example, the value **1** specifies that the parameter is an input parameter, and the value **65** specifies that the parameter is an input parameter and may contain a null value.</span></span> <span data-ttu-id="60007-119">Les valeurs doivent correspondre aux valeurs de l'énumération OLE DB DBPARAMFLAGSENUM.</span><span class="sxs-lookup"><span data-stu-id="60007-119">The values must match the values in the OLE DB DBPARAMFLAGSENUM enumeration.</span></span> <span data-ttu-id="60007-120">Pour plus d'informations, consultez la documentation de référence OLE DB.</span><span class="sxs-lookup"><span data-stu-id="60007-120">For more information, see the OLE DB reference documentation.</span></span>  
  
 <span data-ttu-id="60007-121">La transformation de commande OLE DB inclut la propriété personnalisée `SQLCommand`.</span><span class="sxs-lookup"><span data-stu-id="60007-121">The OLE DB Command transformation includes the `SQLCommand` custom property.</span></span> <span data-ttu-id="60007-122">La propriété peut être mise à jour par une expression de propriété lors du chargement du package.</span><span class="sxs-lookup"><span data-stu-id="60007-122">This property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="60007-123">Pour plus d’informations, consultez [Expressions Integration Services &#40;SSIS&#41; ](../../expressions/integration-services-ssis-expressions.md), [Expressions de propriété dans des packages](../../expressions/use-property-expressions-in-packages.md) et [Propriétés personnalisées des transformations](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="60007-123">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
 <span data-ttu-id="60007-124">Cette transformation a une entrée, une sortie standard et une sortie d'erreur.</span><span class="sxs-lookup"><span data-stu-id="60007-124">This transformation has one input, one regular output, and one error output.</span></span>  
  
## <a name="logging"></a><span data-ttu-id="60007-125">Journalisation</span><span class="sxs-lookup"><span data-stu-id="60007-125">Logging</span></span>  
 <span data-ttu-id="60007-126">Vous pouvez consigner les appels émis par la transformation de commande OLE DB vers les fournisseurs de données externes.</span><span class="sxs-lookup"><span data-stu-id="60007-126">You can log the calls that the OLE DB Command transformation makes to external data providers.</span></span> <span data-ttu-id="60007-127">Vous pouvez utiliser cette fonctionnalité de journalisation pour résoudre des problèmes liés aux connexions et aux commandes vers des sources de données externes effectuées par la transformation de commande OLE DB.</span><span class="sxs-lookup"><span data-stu-id="60007-127">You can use this logging capability to troubleshoot the connections and commands to external data sources that the OLE DB Command transformation performs.</span></span> <span data-ttu-id="60007-128">Pour consigner les appels que la transformation de commande OLE DB adresse à des fournisseurs de données externes, activez la journalisation des packages et sélectionnez l'événement **Diagnostic** au niveau du package.</span><span class="sxs-lookup"><span data-stu-id="60007-128">To log the calls that the OLE DB Command transformation makes to external data providers, enable package logging and select the **Diagnostic** event at the package level.</span></span> <span data-ttu-id="60007-129">Pour plus d’informations, consultez [Outils de dépannage pour l’exécution des packages](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span><span class="sxs-lookup"><span data-stu-id="60007-129">For more information, see [Troubleshooting Tools for Package Execution](../../troubleshooting/troubleshooting-tools-for-package-execution.md).</span></span>  
  
## <a name="related-tasks"></a><span data-ttu-id="60007-130">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="60007-130">Related Tasks</span></span>  
 <span data-ttu-id="60007-131">Vous pouvez configurer la transformation à l'aide du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] ou du modèle objet.</span><span class="sxs-lookup"><span data-stu-id="60007-131">You can configure the transformation by either using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or the object model.</span></span> <span data-ttu-id="60007-132">Pour plus d’informations sur la configuration de la transformation à l’aide du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] , consultez  [Configurer la transformation de commande OLE DB](../../configure-the-ole-db-command-transformation.md).</span><span class="sxs-lookup"><span data-stu-id="60007-132">For details about configuring the transformation using the [!INCLUDE[ssIS](../../../includes/ssis-md.md)] designer, see  [Configure the OLE DB Command Transformation](../../configure-the-ole-db-command-transformation.md).</span></span> <span data-ttu-id="60007-133">Pour plus d'informations sur la configuration par programmation de cette transformation, consultez le Guide du développeur.</span><span class="sxs-lookup"><span data-stu-id="60007-133">See the Developer Guide for details about programmatically configuring this transformation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="60007-134">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="60007-134">See Also</span></span>  
 <span data-ttu-id="60007-135">[Flux de données](../data-flow.md) </span><span class="sxs-lookup"><span data-stu-id="60007-135">[Data Flow](../data-flow.md) </span></span>  
 [<span data-ttu-id="60007-136">Transformations Integration Services</span><span class="sxs-lookup"><span data-stu-id="60007-136">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
