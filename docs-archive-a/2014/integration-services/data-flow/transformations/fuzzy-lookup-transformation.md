---
title: Recherche floue, transformation | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.dts.designer.fuzzylookuptrans.f1
helpviewer_keywords:
- cleaning data
- comparing data
- token delimiters [Integration Services]
- temporary indexes [Integration Services]
- temporary tables [Integration Services]
- Fuzzy Lookup transformation
- reference tables [Integration Services]
- match similar data [Integration Services]
- replacing missing values
- correcting data [Integration Services]
- cache [Integration Services]
- standardizing data [Integration Services]
- lookups [Integration Services]
- confidence scores [Integration Services]
- fuzzy matches
- missing values replaced [Integration Services]
- similarity thresholds [Integration Services]
ms.assetid: 019db426-3de2-4ca9-8667-79fd9a47a068
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 742a87e7425fd65b8af7bcda87c237151d382f77
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611192"
---
# <a name="fuzzy-lookup-transformation"></a><span data-ttu-id="15dab-102">transformation de recherche floue</span><span class="sxs-lookup"><span data-stu-id="15dab-102">Fuzzy Lookup Transformation</span></span>
  <span data-ttu-id="15dab-103">La transformation de recherche floue effectue des tâches de nettoyage des données telles que la standardisation des données, la correction des données et la fourniture de données manquantes.</span><span class="sxs-lookup"><span data-stu-id="15dab-103">The Fuzzy Lookup transformation performs data cleaning tasks such as standardizing data, correcting data, and providing missing values.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15dab-104">Pour plus d’informations sur la transformation de recherche floue, y compris les limitations en termes de performances et de mémoire, consultez le livre blanc, [Présentation des transformations Fuzzy Lookup (recherche approximative) et Fuzzy Grouping (regroupement approximatif) dans les services DTS (Data Transformation Services) de SQL Server 2005](https://go.microsoft.com/fwlink/?LinkId=96604).</span><span class="sxs-lookup"><span data-stu-id="15dab-104">For more detailed information about the Fuzzy Lookup transformation, including performance and memory limitations, see the white paper, [Fuzzy Lookup and Fuzzy Grouping in SQL Server Integration Services 2005](https://go.microsoft.com/fwlink/?LinkId=96604).</span></span>  
  
 <span data-ttu-id="15dab-105">La transformation de recherche floue diffère de la transformation de recherche par son utilisation de la correspondance approximative.</span><span class="sxs-lookup"><span data-stu-id="15dab-105">The Fuzzy Lookup transformation differs from the Lookup transformation in its use of fuzzy matching.</span></span> <span data-ttu-id="15dab-106">La transformation de recherche utilise une équijointure pour localiser les enregistrements équivalents dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-106">The Lookup transformation uses an equi-join to locate matching records in the reference table.</span></span> <span data-ttu-id="15dab-107">Elle retourne les enregistrements avec au moins un enregistrement correspondant et les enregistrements sans enregistrements correspondants.</span><span class="sxs-lookup"><span data-stu-id="15dab-107">It returns records with at least one matching record, and returns records with no matching records.</span></span> <span data-ttu-id="15dab-108">Par contre, la transformation de recherche floue utilise la correspondance floue pour renvoyer un ou plusieurs résultats dont la correspondance est proche dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-108">In contrast, the Fuzzy Lookup transformation uses fuzzy matching to return one or more close matches in the reference table.</span></span>  
  
 <span data-ttu-id="15dab-109">Une transformation de recherche floue suit souvent une transformation de recherche dans le flux de données d'un package.</span><span class="sxs-lookup"><span data-stu-id="15dab-109">A Fuzzy Lookup transformation frequently follows a Lookup transformation in a package data flow.</span></span> <span data-ttu-id="15dab-110">D'abord, la transformation de recherche tente de trouver une correspondance exacte.</span><span class="sxs-lookup"><span data-stu-id="15dab-110">First, the Lookup transformation tries to find an exact match.</span></span> <span data-ttu-id="15dab-111">Si elle échoue, la transformation de recherche floue fournit des correspondances proches dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-111">If it fails, the Fuzzy Lookup transformation provides close matches from the reference table.</span></span>  
  
 <span data-ttu-id="15dab-112">La transformation doit accéder à la source de données de référence contenant les valeurs utilisées pour nettoyer et étendre les données d'entrée.</span><span class="sxs-lookup"><span data-stu-id="15dab-112">The transformation needs access to a reference data source that contains the values that are used to clean and extend the input data.</span></span> <span data-ttu-id="15dab-113">La source de données de référence doit être une table d’une base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15dab-113">The reference data source must be a table in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="15dab-114">La correspondance entre la valeur dans une colonne d'entrée et la valeur dans la table de référence doit être une correspondance exacte ou approximative.</span><span class="sxs-lookup"><span data-stu-id="15dab-114">The match between the value in an input column and the value in the reference table can be an exact match or a fuzzy match.</span></span> <span data-ttu-id="15dab-115">Cependant, la transformation nécessite au moins une correspondance de colonne pour être configurée en correspondance floue.</span><span class="sxs-lookup"><span data-stu-id="15dab-115">However, the transformation requires at least one column match to be configured for fuzzy matching.</span></span> <span data-ttu-id="15dab-116">Si vous ne souhaitez utiliser que la correspondance exacte, utilisez plutôt la transformation de recherche.</span><span class="sxs-lookup"><span data-stu-id="15dab-116">If you want to use only exact matching, use the Lookup transformation instead.</span></span>  
  
 <span data-ttu-id="15dab-117">Cette transformation a une entrée et une sortie.</span><span class="sxs-lookup"><span data-stu-id="15dab-117">This transformation has one input and one output.</span></span>  
  
 <span data-ttu-id="15dab-118">Seules les colonnes d'entrée avec les types de données `DT_WSTR` et `DT_STR` peuvent être utilisées dans la correspondance floue.</span><span class="sxs-lookup"><span data-stu-id="15dab-118">Only input columns with the `DT_WSTR` and `DT_STR` data types can be used in fuzzy matching.</span></span> <span data-ttu-id="15dab-119">La correspondance exacte peut utiliser n'importe quel type de données DTS, à l'exception des types `DT_TEXT`, `DT_NTEXT` et `DT_IMAGE`.</span><span class="sxs-lookup"><span data-stu-id="15dab-119">Exact matching can use any DTS data type except `DT_TEXT`, `DT_NTEXT`, and `DT_IMAGE`.</span></span> <span data-ttu-id="15dab-120">Pour plus d’informations, consultez [Types de données Integration Services](../integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="15dab-120">For more information, see [Integration Services Data Types](../integration-services-data-types.md).</span></span> <span data-ttu-id="15dab-121">Les colonnes participant à la jointure entre l'entrée et la table de référence doivent avoir des types de données compatibles.</span><span class="sxs-lookup"><span data-stu-id="15dab-121">Columns that participate in the join between the input and the reference table must have compatible data types.</span></span> <span data-ttu-id="15dab-122">Par exemple, il est possible de joindre une colonne avec le type de `DT_WSTR` données DTS à une colonne avec le [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] `nvarchar` type de données, mais non valide pour joindre une colonne avec le type de données `DT_WSTR` à une colonne avec le `int` type de données.</span><span class="sxs-lookup"><span data-stu-id="15dab-122">For example, it is valid to join a column with the DTS `DT_WSTR` data type to a column with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] `nvarchar` data type, but invalid to join a column with the `DT_WSTR` data type to a column with the `int` data type.</span></span>  
  
 <span data-ttu-id="15dab-123">Vous pouvez personnaliser cette transformation en spécifiant le volume maximum de mémoire, l'algorithme de comparaison de lignes et la mise en cache d'index et de tables de référence utilisés par la transformation.</span><span class="sxs-lookup"><span data-stu-id="15dab-123">You can customize this transformation by specifying the maximum amount of memory, the row comparison algorithm, and the caching of indexes and reference tables that the transformation uses.</span></span>  
  
 <span data-ttu-id="15dab-124">Vous pouvez configurer la quantité de mémoire utilisée par la transformation de recherche floue en définissant la propriété personnalisée MaxMemoryUsage.</span><span class="sxs-lookup"><span data-stu-id="15dab-124">The amount of memory that the Fuzzy Lookup transformation uses can be configured by setting the MaxMemoryUsage custom property.</span></span> <span data-ttu-id="15dab-125">Vous pouvez spécifier le nombre de mégaoctets (Mo) ou utiliser la valeur 0, ce qui permet à la transformation d'utiliser une quantité de mémoire dynamique basée sur ses besoins et sur la mémoire physique disponible.</span><span class="sxs-lookup"><span data-stu-id="15dab-125">You can specify the number of megabytes (MB), or use the value 0, which lets the transformation use a dynamic amount of memory based on its needs and the physical memory available.</span></span> <span data-ttu-id="15dab-126">La propriété personnalisée MaxMemoryUsage peut être mise à jour par une expression de la propriété au moment du chargement du package.</span><span class="sxs-lookup"><span data-stu-id="15dab-126">The MaxMemoryUsage custom property can be updated by a property expression when the package is loaded.</span></span> <span data-ttu-id="15dab-127">Pour plus d’informations, consultez [Expressions Integration Services &#40;SSIS&#41; ](../../expressions/integration-services-ssis-expressions.md), [Expressions de propriété dans des packages](../../expressions/use-property-expressions-in-packages.md) et [Propriétés personnalisées des transformations](transformation-custom-properties.md).</span><span class="sxs-lookup"><span data-stu-id="15dab-127">For more information, see [Integration Services &#40;SSIS&#41; Expressions](../../expressions/integration-services-ssis-expressions.md), [Use Property Expressions in Packages](../../expressions/use-property-expressions-in-packages.md), and [Transformation Custom Properties](transformation-custom-properties.md).</span></span>  
  
## <a name="controlling-fuzzy-matching-behavior"></a><span data-ttu-id="15dab-128">Contrôle du comportement de la correspondance floue</span><span class="sxs-lookup"><span data-stu-id="15dab-128">Controlling Fuzzy Matching Behavior</span></span>  
 <span data-ttu-id="15dab-129">La transformation de recherche floue comprend trois fonctionnalités de personnalisation de la recherche qu'elle effectue : le nombre maximum de correspondances à retourner par ligne d'entrée, les séparateurs de jetons et les seuils de similarité.</span><span class="sxs-lookup"><span data-stu-id="15dab-129">The Fuzzy Lookup transformation includes three features for customizing the lookup it performs: maximum number of matches to return per input row, token delimiters, and similarity thresholds.</span></span>  
  
 <span data-ttu-id="15dab-130">La transformation renvoie zéro ou plusieurs correspondances, jusqu'au nombre de correspondances spécifiées.</span><span class="sxs-lookup"><span data-stu-id="15dab-130">The transformation returns zero or more matches up to the number of matches specified.</span></span> <span data-ttu-id="15dab-131">La spécification du nombre maximal de correspondances ne garantit pas que la transformation renvoie le nombre maximal de correspondances. Elle garantit uniquement que la transformation renvoie un nombre inférieur ou égal de correspondances.</span><span class="sxs-lookup"><span data-stu-id="15dab-131">Specifying a maximum number of matches does not guarantee that the transformation returns the maximum number of matches; it only guarantees that the transformation returns at most that number of matches.</span></span> <span data-ttu-id="15dab-132">Si vous définissez le nombre maximal de correspondances à une valeur supérieure à 1, la sortie de la transformation peut inclure plusieurs lignes par recherche et certaines des lignes peuvent être des doublons.</span><span class="sxs-lookup"><span data-stu-id="15dab-132">If you set the maximum number of matches to a value greater than 1, the output of the transformation may include more than one row per lookup and some of the rows may be duplicates.</span></span>  
  
 <span data-ttu-id="15dab-133">La transformation fournit un ensemble par défaut de délimiteurs utilisés pour marquer les données, mais vous pouvez ajouter des délimiteurs de jetons pour répondre aux besoins de vos données.</span><span class="sxs-lookup"><span data-stu-id="15dab-133">The transformation provides a default set of delimiters used to tokenize the data, but you can add token delimiters to suit the needs of your data.</span></span> <span data-ttu-id="15dab-134">La propriété Delimiters contient les délimiteurs par défaut.</span><span class="sxs-lookup"><span data-stu-id="15dab-134">The Delimiters property contains the default delimiters.</span></span> <span data-ttu-id="15dab-135">La création de jetons est importante car elle définit les unités qui sont comparées entre elles au sein des données.</span><span class="sxs-lookup"><span data-stu-id="15dab-135">Tokenization is important because it defines the units within the data that are compared to each other.</span></span>  
  
 <span data-ttu-id="15dab-136">Les seuils de similarité peuvent être définis au niveau du composant et de la jointure.</span><span class="sxs-lookup"><span data-stu-id="15dab-136">The similarity thresholds can be set at the component and join levels.</span></span> <span data-ttu-id="15dab-137">La similarité au niveau de la jointure n'est disponible que lorsque la transformation effectue une correspondance floue entre des colonnes dans l'entrée et la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-137">The join-level similarity threshold is only available when the transformation performs a fuzzy match between columns in the input and the reference table.</span></span> <span data-ttu-id="15dab-138">La plage de similarité va de 0 à 1.</span><span class="sxs-lookup"><span data-stu-id="15dab-138">The similarity range is 0 to 1.</span></span> <span data-ttu-id="15dab-139">Plus le seuil s'approche de 1, plus les lignes et les colonnes doivent être similaires pour être répertoriées comme doublons.</span><span class="sxs-lookup"><span data-stu-id="15dab-139">The closer to 1 the threshold is, the more similar the rows and columns must be to qualify as duplicates.</span></span> <span data-ttu-id="15dab-140">Vous spécifiez le seuil de similarité en définissant la propriété MinSimilarity au niveau du composant et de la jointure.</span><span class="sxs-lookup"><span data-stu-id="15dab-140">You specify the similarity threshold by setting the MinSimilarity property at the component and join levels.</span></span> <span data-ttu-id="15dab-141">Pour obtenir la similarité spécifiée au niveau du composant, toutes les lignes doivent montrer une similarité à travers toutes les correspondances, qui soit supérieure ou égale au seuil de similarité spécifié au niveau du composant.</span><span class="sxs-lookup"><span data-stu-id="15dab-141">To satisfy the similarity that is specified at the component level, all rows must have a similarity across all matches that is greater than or equal to the similarity threshold that is specified at the component level.</span></span> <span data-ttu-id="15dab-142">En d'autres termes, vous ne pouvez pas spécifier une correspondance très proche au niveau du composant à moins que les correspondances au niveau de la ligne et de la jointure ne soient également proches.</span><span class="sxs-lookup"><span data-stu-id="15dab-142">That is, you cannot specify a very close match at the component level unless the matches at the row or join level are equally close.</span></span>  
  
 <span data-ttu-id="15dab-143">Chaque correspondance comprend un score de similarité et un score de confiance.</span><span class="sxs-lookup"><span data-stu-id="15dab-143">Each match includes a similarity score and a confidence score.</span></span> <span data-ttu-id="15dab-144">Le score de similarité est une mesure mathématique de la similarité de texture entre l'enregistrement d'entrée et l'enregistrement que la transformation de recherche floue renvoie de la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-144">The similarity score is a mathematical measure of the textural similarity between the input record and the record that Fuzzy Lookup transformation returns from the reference table.</span></span> <span data-ttu-id="15dab-145">Le score de confiance est une mesure de la probabilité qu'une valeur particulière soit la meilleure correspondance parmi les correspondances trouvées dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-145">The confidence score is a measure of how likely it is that a particular value is the best match among the matches found in the reference table.</span></span> <span data-ttu-id="15dab-146">Le score de confiance affecté à un enregistrement dépend des autres enregistrements correspondants renvoyés.</span><span class="sxs-lookup"><span data-stu-id="15dab-146">The confidence score assigned to a record depends on the other matching records that are returned.</span></span> <span data-ttu-id="15dab-147">Par exemple, la correspondance entre *St.* et *Saint* renvoie un faible score de similarité indépendamment des autres correspondances.</span><span class="sxs-lookup"><span data-stu-id="15dab-147">For example, matching *St.* and *Saint* returns a low similarity score regardless of other matches.</span></span> <span data-ttu-id="15dab-148">Si *Saint* est la seule correspondance renvoyée, le score de confiance est élevé.</span><span class="sxs-lookup"><span data-stu-id="15dab-148">If *Saint* is the only match returned, the confidence score is high.</span></span> <span data-ttu-id="15dab-149">Si *Saint* et *St.* apparaissent tous les deux dans la table de référence, la confiance est élevée pour *St.* et faible pour *Saint* .</span><span class="sxs-lookup"><span data-stu-id="15dab-149">If both *Saint* and *St.* appear in the reference table, the confidence in *St.* is high and the confidence in *Saint* is low.</span></span> <span data-ttu-id="15dab-150">Cependant, une similarité élevée ne signifie pas forcément une confiance élevée.</span><span class="sxs-lookup"><span data-stu-id="15dab-150">However, high similarity may not mean high confidence.</span></span> <span data-ttu-id="15dab-151">Par exemple, si vous cherchez la valeur *Chapitre 4*, les résultats renvoyés *Chapitre 1*, *Chapitre 2*et *Chapitre 3* possèdent un score de similarité élevé mais un score de confiance faible, car aucun des résultats ne se dégage clairement comme étant la meilleure correspondance.</span><span class="sxs-lookup"><span data-stu-id="15dab-151">For example, if you are looking up the value *Chapter 4*, the returned results *Chapter 1*, *Chapter 2*, and *Chapter 3* have a high similarity score but a low confidence score because it is unclear which of the results is the best match.</span></span>  
  
 <span data-ttu-id="15dab-152">Le score de similarité est représenté par une valeur décimale entre 0 et 1, où la valeur 1 signifie que la correspondance entre la valeur dans la colonne d'entrée et la valeur dans la table de référence est exacte.</span><span class="sxs-lookup"><span data-stu-id="15dab-152">The similarity score is represented by a decimal value between 0 and 1, where a similarity score of 1 means an exact match between the value in the input column and the value in the reference table.</span></span> <span data-ttu-id="15dab-153">Le score de confiance, qui est également une valeur décimale entre 0 et 1, indique la confiance par rapport à la correspondance.</span><span class="sxs-lookup"><span data-stu-id="15dab-153">The confidence score, also a decimal value between 0 and 1, indicates the confidence in the match.</span></span> <span data-ttu-id="15dab-154">Si aucune correspondance utilisable n'est trouvée, des scores de similarité et de confiance de 0 sont affectés à la ligne, et les colonnes de sortie copiées à partir de la table de référence contiendront des valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="15dab-154">If no usable match is found, similarity and confidence scores of 0 are assigned to the row, and the output columns copied from the reference table will contain null values.</span></span>  
  
 <span data-ttu-id="15dab-155">Parfois, la transformation de recherche floue peut ne pas localiser de correspondances appropriées dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-155">Sometimes, Fuzzy Lookup may not locate appropriate matches in the reference table.</span></span> <span data-ttu-id="15dab-156">Cela peut être le cas si la valeur d'entrée utilisée dans une recherche est un mot seul et court.</span><span class="sxs-lookup"><span data-stu-id="15dab-156">This can occur if the input value that is used in a lookup is a single, short word.</span></span> <span data-ttu-id="15dab-157">Par exemple, *helo* n’est pas mis en correspondance avec *hello* dans une table de référence quand aucun autre jeton n’est présent dans cette colonne ni dans aucune autre colonne de la ligne.</span><span class="sxs-lookup"><span data-stu-id="15dab-157">For example, *helo* is not matched with the value *hello* in a reference table when no other tokens are present in that column or any other column in the row.</span></span>  
  
 <span data-ttu-id="15dab-158">Les colonnes de sortie de transformation comprennent les colonnes d'entrée marquées comme colonnes SQL directes, les colonnes sélectionnées dans la table de recherche et les colonnes supplémentaires suivantes :</span><span class="sxs-lookup"><span data-stu-id="15dab-158">The transformation output columns include the input columns that are marked as pass-through columns, the selected columns in the lookup table, and the following additional columns:</span></span>  
  
-   <span data-ttu-id="15dab-159">**_Similarity**, une colonne décrivant la similarité entre des valeurs des colonnes d’entrée et de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-159">**_Similarity**, a column that describes the similarity between values in the input and reference columns.</span></span>  
  
-   <span data-ttu-id="15dab-160">**_Confidence**, une colonne décrivant la qualité de la correspondance.</span><span class="sxs-lookup"><span data-stu-id="15dab-160">**_Confidence**, a column that describes the quality of the match.</span></span>  
  
 <span data-ttu-id="15dab-161">La transformation utilise la connexion à la base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour créer les tables temporaires utilisées par l'algorithme de correspondance approximative.</span><span class="sxs-lookup"><span data-stu-id="15dab-161">The transformation uses the connection to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database to create the temporary tables that the fuzzy matching algorithm uses.</span></span>  
  
## <a name="running-the-fuzzy-lookup-transformation"></a><span data-ttu-id="15dab-162">Exécution de la transformation de recherche floue</span><span class="sxs-lookup"><span data-stu-id="15dab-162">Running the Fuzzy Lookup Transformation</span></span>  
 <span data-ttu-id="15dab-163">Lorsque le package exécute la transformation pour la première fois, la transformation copie la table de référence, ajoute une clé avec un type de données entier à la nouvelle table et génère un index sur la colonne clé.</span><span class="sxs-lookup"><span data-stu-id="15dab-163">When the package first runs the transformation, the transformation copies the reference table, adds a key with an integer data type to the new table, and builds an index on the key column.</span></span> <span data-ttu-id="15dab-164">Ensuite, la transformation génère un index appelé index de correspondances sur la copie de la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-164">Next, the transformation builds an index, called a match index, on the copy of the reference table.</span></span> <span data-ttu-id="15dab-165">L'index de correspondances stocke les résultats de la création de jetons pour les valeurs dans les colonnes d'entrée de la transformation. La transformation utilise ensuite les jetons dans l'opération de recherche.</span><span class="sxs-lookup"><span data-stu-id="15dab-165">The match index stores the results of tokenizing the values in the transformation input columns, and the transformation then uses the tokens in the lookup operation.</span></span> <span data-ttu-id="15dab-166">L’index de correspondances est une table dans une base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="15dab-166">The match index is a table in a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span>  
  
 <span data-ttu-id="15dab-167">Lorsque le package est exécuté de nouveau, la transformation peut utiliser un index de correspondances existant ou en créer un nouveau.</span><span class="sxs-lookup"><span data-stu-id="15dab-167">When the package runs again, the transformation can either use an existing match index or create a new index.</span></span> <span data-ttu-id="15dab-168">Si la table de référence est statique, le package peut éviter le processus éventuellement coûteux de recréation de l'index pour des sessions répétées de nettoyage des données.</span><span class="sxs-lookup"><span data-stu-id="15dab-168">If the reference table is static, the package can avoid the potentially expensive process of rebuilding the index for repeat sessions of data cleaning.</span></span> <span data-ttu-id="15dab-169">Si vous choisissez d'utiliser un index existant, celui-ci est créé lors de la première exécution du package.</span><span class="sxs-lookup"><span data-stu-id="15dab-169">If you choose to use an existing index, the index is created the first time that the package runs.</span></span> <span data-ttu-id="15dab-170">Si les transformations de recherche floue utilisent la même table de référence, elles peuvent toutes utiliser le même index.</span><span class="sxs-lookup"><span data-stu-id="15dab-170">If multiple Fuzzy Lookup transformations use the same reference table, they can all use the same index.</span></span> <span data-ttu-id="15dab-171">Pour réutiliser l'index, les opérations de recherche doivent être identiques ; la recherche doit utiliser les mêmes colonnes.</span><span class="sxs-lookup"><span data-stu-id="15dab-171">To reuse the index, the lookup operations must be identical; the lookup must use the same columns.</span></span> <span data-ttu-id="15dab-172">Vous pouvez nommer l’index et sélectionner la connexion à la base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour enregistrer l’index.</span><span class="sxs-lookup"><span data-stu-id="15dab-172">You can name the index and select the connection to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database that saves the index.</span></span>  
  
 <span data-ttu-id="15dab-173">Si la transformation enregistre l'index de correspondances, il peut être géré automatiquement.</span><span class="sxs-lookup"><span data-stu-id="15dab-173">If the transformation saves the match index, the match index can be maintained automatically.</span></span> <span data-ttu-id="15dab-174">Cela signifie que chaque fois qu'un enregistrement dans la table de référence est mis à jour, l'index de correspondances est également mis à jour.</span><span class="sxs-lookup"><span data-stu-id="15dab-174">This means that every time a record in the reference table is updated, the match index is also updated.</span></span> <span data-ttu-id="15dab-175">La gestion de l'index de correspondances peut réduire le temps de traitement, car l'index ne doit pas être recréé à chaque exécution du package.</span><span class="sxs-lookup"><span data-stu-id="15dab-175">Maintaining the match index can save processing time, because the index does not have to be rebuilt when the package runs.</span></span> <span data-ttu-id="15dab-176">Vous pouvez spécifier comment la transformation gère l'index de correspondances.</span><span class="sxs-lookup"><span data-stu-id="15dab-176">You can specify how the transformation manages the match index.</span></span>  
  
 <span data-ttu-id="15dab-177">Le tableau suivant décrit les options de l'index de correspondances.</span><span class="sxs-lookup"><span data-stu-id="15dab-177">The following table describes the match index options.</span></span>  
  
|<span data-ttu-id="15dab-178">Option</span><span class="sxs-lookup"><span data-stu-id="15dab-178">Option</span></span>|<span data-ttu-id="15dab-179">Description</span><span class="sxs-lookup"><span data-stu-id="15dab-179">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="15dab-180">**GenerateAndMaintainNewIndex**</span><span class="sxs-lookup"><span data-stu-id="15dab-180">**GenerateAndMaintainNewIndex**</span></span>|<span data-ttu-id="15dab-181">Créer un nouvel index, l'enregistrer et le gérer.</span><span class="sxs-lookup"><span data-stu-id="15dab-181">Create a new index, save it, and maintain it.</span></span> <span data-ttu-id="15dab-182">La transformation installe des déclencheurs dans la table de référence pour garder la table de référence et la table d'index synchronisées.</span><span class="sxs-lookup"><span data-stu-id="15dab-182">The transformation installs triggers on the reference table to keep the reference table and index table synchronized.</span></span>|  
|<span data-ttu-id="15dab-183">**GenerateAndPersistNewIndex**</span><span class="sxs-lookup"><span data-stu-id="15dab-183">**GenerateAndPersistNewIndex**</span></span>|<span data-ttu-id="15dab-184">Créer un nouvel index et l'enregistrer, sans le gérer.</span><span class="sxs-lookup"><span data-stu-id="15dab-184">Create a new index and save it, but do not maintain it.</span></span>|  
|<span data-ttu-id="15dab-185">**GenerateNewIndex**</span><span class="sxs-lookup"><span data-stu-id="15dab-185">**GenerateNewIndex**</span></span>|<span data-ttu-id="15dab-186">Créer un nouvel index, sans l'enregistrer.</span><span class="sxs-lookup"><span data-stu-id="15dab-186">Create a new index, but do not save it.</span></span>|  
|<span data-ttu-id="15dab-187">**ReuseExistingIndex**</span><span class="sxs-lookup"><span data-stu-id="15dab-187">**ReuseExistingIndex**</span></span>|<span data-ttu-id="15dab-188">Réutiliser un index existant.</span><span class="sxs-lookup"><span data-stu-id="15dab-188">Reuse an existing index.</span></span>|  
  
### <a name="maintenance-of-the-match-index-table"></a><span data-ttu-id="15dab-189">Maintenance de la table d'index de correspondances</span><span class="sxs-lookup"><span data-stu-id="15dab-189">Maintenance of the Match Index Table</span></span>  
 <span data-ttu-id="15dab-190">L’option **GenerateAndMaintainNewIndex** installe des déclencheurs dans la table de référence pour garder la table de référence et la table d’index synchronisées.</span><span class="sxs-lookup"><span data-stu-id="15dab-190">The **GenerateAndMaintainNewIndex** option installs triggers on the reference table to keep the match index table and the reference table synchronized.</span></span> <span data-ttu-id="15dab-191">Si vous devez supprimer le déclencheur installé, vous devez exécuter la procédure stockée **sp_FuzzyLookupTableMaintenanceUnInstall** et fournir le nom spécifié dans la propriété MatchIndexName comme valeur de paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="15dab-191">If you have to remove the installed trigger, you must run the **sp_FuzzyLookupTableMaintenanceUnInstall** stored procedure, and provide the name specified in the MatchIndexName property as the input parameter value.</span></span>  
  
 <span data-ttu-id="15dab-192">Vous ne devez pas supprimer la table d’index de correspondances gérée avant d’exécuter la procédure stockée **sp_FuzzyLookupTableMaintenanceUnInstall** .</span><span class="sxs-lookup"><span data-stu-id="15dab-192">You should not delete the maintained match index table before running the **sp_FuzzyLookupTableMaintenanceUnInstall** stored procedure.</span></span> <span data-ttu-id="15dab-193">Si la table d'index de correspondances est supprimée, les déclencheurs de la table de référence ne seront pas exécutés correctement.</span><span class="sxs-lookup"><span data-stu-id="15dab-193">If the match index table is deleted, the triggers on the reference table will not execute correctly.</span></span> <span data-ttu-id="15dab-194">Toutes les mises à jour suivantes de la table de référence échoueront tant que vous ne supprimerez pas les déclencheurs dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-194">All subsequent updates to the reference table will fail until you manually drop the triggers on the reference table.</span></span>  
  
 <span data-ttu-id="15dab-195">La commande SQL TRUNCATE TABLE n'appelle pas de déclencheurs DELETE.</span><span class="sxs-lookup"><span data-stu-id="15dab-195">The SQL TRUNCATE TABLE command does not invoke DELETE triggers.</span></span> <span data-ttu-id="15dab-196">Si la commande TRUNCATE TABLE est utilisée sur la table de référence, celle-ci ne sera plus synchronisée avec l'index de correspondances et la transformation de recherche floue échouera.</span><span class="sxs-lookup"><span data-stu-id="15dab-196">If the TRUNCATE TABLE command is used on the reference table, the reference table and the match index will no longer be synchronized and the Fuzzy Lookup transformation fails.</span></span> <span data-ttu-id="15dab-197">Lorsque les déclencheurs qui gèrent la table d'index de correspondances sont installés sur la table de référence, vous devez utiliser la commande SQL DELETE au lieu de TRUNCATE TABLE.</span><span class="sxs-lookup"><span data-stu-id="15dab-197">While the triggers that maintain the match index table are installed on the reference table, you should use the SQL DELETE command instead of the TRUNCATE TABLE command.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="15dab-198">Lorsque vous sélectionnez **Conserver l’index stocké** sous l’onglet **Table de référence** de **l’Éditeur de transformation de recherche floue**, la transformation utilise des procédures stockées managées pour maintenir l’index.</span><span class="sxs-lookup"><span data-stu-id="15dab-198">When you select **Maintain stored index** on the **Reference Table** tab of the **Fuzzy Lookup Transformation Editor**, the transformation uses managed stored procedures to maintain the index.</span></span> <span data-ttu-id="15dab-199">Ces procédures stockées managées utilisent la fonctionnalité de l’intégration du common language runtime (CLR) dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="15dab-199">These managed stored procedures use the common language runtime (CLR) integration feature in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="15dab-200">Par défaut, l'intégration CLR dans [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] est désactivée.</span><span class="sxs-lookup"><span data-stu-id="15dab-200">By default, CLR integration in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] is not enabled.</span></span> <span data-ttu-id="15dab-201">Pour utiliser la fonctionnalité **Conserver l’index stocké** , vous devez activer l’intégration du CLR.</span><span class="sxs-lookup"><span data-stu-id="15dab-201">To use the **Maintain stored index** functionality, you must enable CLR integration.</span></span> <span data-ttu-id="15dab-202">Pour plus d’informations, consultez [Activation de l’intégration du CLR](../../../relational-databases/clr-integration/clr-integration-enabling.md).</span><span class="sxs-lookup"><span data-stu-id="15dab-202">For more information, see [Enabling CLR Integration](../../../relational-databases/clr-integration/clr-integration-enabling.md).</span></span>  
>   
>  <span data-ttu-id="15dab-203">Dans la mesure où l’option **Conserver l’index stocké** requiert l’intégration du CLR, cette fonctionnalité n’est effective que lorsque vous sélectionnez une table de référence dans une instance de [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] pour laquelle l’intégration du CLR est activée.</span><span class="sxs-lookup"><span data-stu-id="15dab-203">Because the **Maintain stored index** option requires CLR integration, this feature works only when you select a reference table on an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] where CLR integration is enabled.</span></span>  
  
## <a name="row-comparison"></a><span data-ttu-id="15dab-204">Comparaison de lignes</span><span class="sxs-lookup"><span data-stu-id="15dab-204">Row Comparison</span></span>  
 <span data-ttu-id="15dab-205">Lorsque vous configurez la transformation de configuration floue, vous pouvez spécifier l'algorithme de comparaison utilisé par la transformation pour rechercher les enregistrements correspondants dans la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-205">When you configure the Fuzzy Lookup transformation, you can specify the comparison algorithm that the transformation uses to locate matching records in the reference table.</span></span> <span data-ttu-id="15dab-206">Si vous affectez à la propriété exhaustif la valeur `True` , la transformation compare chaque ligne de l’entrée à chaque ligne de la table de référence.</span><span class="sxs-lookup"><span data-stu-id="15dab-206">If you set the Exhaustive property to `True`, the transformation compares every row in the input to every row in the reference table.</span></span> <span data-ttu-id="15dab-207">Cet algorithme de comparaison peut produire des résultats plus précis, mais peut ralentir la transformation, sauf si le nombre de lignes dans la table de référence est faible.</span><span class="sxs-lookup"><span data-stu-id="15dab-207">This comparison algorithm may produce more accurate results, but it is likely to make the transformation perform more slowly unless the number of rows is the reference table is small.</span></span> <span data-ttu-id="15dab-208">Si la propriété exhaustive a la valeur `True` , la totalité de la table de référence est chargée en mémoire.</span><span class="sxs-lookup"><span data-stu-id="15dab-208">If the Exhaustive property is set to `True`, the entire reference table is loaded into memory.</span></span> <span data-ttu-id="15dab-209">Pour éviter les problèmes de performances, il est recommandé de définir la propriété exhaustive sur au `True` cours du développement du package uniquement.</span><span class="sxs-lookup"><span data-stu-id="15dab-209">To avoid performance issues, it is advisable to set the Exhaustive property to `True` during package development only.</span></span>  
  
 <span data-ttu-id="15dab-210">Si la propriété exhaustive a la valeur `False` , la transformation de recherche floue renvoie uniquement les correspondances qui ont au moins un jeton indexé ou une sous-chaîne (la sous-chaîne est appelée un *q-Gram*) en commun avec l’enregistrement d’entrée.</span><span class="sxs-lookup"><span data-stu-id="15dab-210">If the Exhaustive property is set to `False`, the Fuzzy Lookup transformation returns only matches that have at least one indexed token or substring (the substring is called a *q-gram*) in common with the input record.</span></span> <span data-ttu-id="15dab-211">Pour améliorer l'efficacité des recherches, seul un sous-ensemble des jetons de chaque ligne de la table est indexé dans la structure d'index inversée dont se sert la transformation de recherche floue pour rechercher les correspondances.</span><span class="sxs-lookup"><span data-stu-id="15dab-211">To maximize the efficiency of lookups, only a subset of the tokens in each row in the table is indexed in the inverted index structure that the Fuzzy Lookup transformation uses to locate matches.</span></span> <span data-ttu-id="15dab-212">Lorsque le jeu de données d’entrée est petit, vous pouvez définir exhaustive sur `True` afin d’éviter les correspondances manquantes pour lesquelles il n’existe aucun jeton commun dans la table d’index.</span><span class="sxs-lookup"><span data-stu-id="15dab-212">When the input dataset is small, you can set Exhaustive to `True` to avoid missing matches for which no common tokens exist in the index table.</span></span>  
  
## <a name="caching-of-indexes-and-reference-tables"></a><span data-ttu-id="15dab-213">Mise en cache des index et tables de référence</span><span class="sxs-lookup"><span data-stu-id="15dab-213">Caching of Indexes and Reference Tables</span></span>  
 <span data-ttu-id="15dab-214">Lorsque vous configurez la transformation de recherche floue, vous pouvez spécifier si la transformation met partiellement en cache l'index et la table de référence dans la mémoire avant que la transformation soit exécutée.</span><span class="sxs-lookup"><span data-stu-id="15dab-214">When you configure the Fuzzy Lookup transformation, you can specify whether the transformation partially caches the index and reference table in memory before the transformation does its work.</span></span> <span data-ttu-id="15dab-215">Si vous affectez à la propriété WarmCaches avec la valeur `True` , l’index et la table de référence sont chargés en mémoire.</span><span class="sxs-lookup"><span data-stu-id="15dab-215">If you set the WarmCaches property to `True`, the index and reference table are loaded into memory.</span></span> <span data-ttu-id="15dab-216">Lorsque l’entrée contient de nombreuses lignes, la définition de la propriété WarmCaches avec sur `True` peut améliorer les performances de la transformation.</span><span class="sxs-lookup"><span data-stu-id="15dab-216">When the input has many rows, setting the WarmCaches property to `True` can improve the performance of the transformation.</span></span> <span data-ttu-id="15dab-217">Lorsque le nombre de lignes d’entrée est faible, l’affectation de la valeur à la propriété WarmCaches avec `False` peut rendre plus rapide la réutilisation d’un index volumineux.</span><span class="sxs-lookup"><span data-stu-id="15dab-217">When the number of input rows is small, setting the WarmCaches property to `False` can make the reuse of a large index faster.</span></span>  
  
## <a name="temporary-tables-and-indexes"></a><span data-ttu-id="15dab-218">Tables et index temporaires</span><span class="sxs-lookup"><span data-stu-id="15dab-218">Temporary Tables and Indexes</span></span>  
 <span data-ttu-id="15dab-219">Lors de l'exécution, la transformation de recherche floue crée des objets temporaires tels que des tables et des index, dans la base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] à laquelle la transformation se connecte.</span><span class="sxs-lookup"><span data-stu-id="15dab-219">At run time, the Fuzzy Lookup transformation creates temporary objects, such as tables and indexes, in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database that the transformation connects to.</span></span> <span data-ttu-id="15dab-220">La taille de ces tables et index temporaires est proportionnelle au nombre de lignes et de jetons dans la table de référence et au nombre de jetons que la transformation de recherche floue crée ; ils peuvent donc occuper un volume important de l'espace disque.</span><span class="sxs-lookup"><span data-stu-id="15dab-220">The size of these temporary tables and indexes is proportionate to the number of rows and tokens in the reference table and the number of tokens that the Fuzzy Lookup transformation creates; therefore, they could potentially consume a significant amount of disk space.</span></span> <span data-ttu-id="15dab-221">La transformation exécute également des requêtes sur ces tables temporaires.</span><span class="sxs-lookup"><span data-stu-id="15dab-221">The transformation also queries these temporary tables.</span></span> <span data-ttu-id="15dab-222">Vous devez donc envisager de connecter la transformation de recherche floue à une instance d’une base de données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] qui ne soit pas en production, notamment si le serveur de production dispose d’un espace disque disponible limité.</span><span class="sxs-lookup"><span data-stu-id="15dab-222">You should therefore consider connecting the Fuzzy Lookup transformation to a non-production instance of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database, especially if the production server has limited disk space available.</span></span>  
  
 <span data-ttu-id="15dab-223">Les performances de cette transformation peuvent s'améliorer si les tables et les index qu'elle utilise sont situés sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="15dab-223">The performance of this transformation may improve if the tables and indexes it uses are located on the local computer.</span></span> <span data-ttu-id="15dab-224">Si la table de référence que la transformation de recherche floue utilise se trouve sur le serveur de production, vous devez envisager de copier la table sur un serveur qui ne soit pas un serveur production et de configurer la transformation de recherche floue pour accéder à la copie.</span><span class="sxs-lookup"><span data-stu-id="15dab-224">If the reference table that the Fuzzy Lookup transformation uses is on the production server, you should consider copying the table to a non-production server and configuring the Fuzzy Lookup transformation to access the copy.</span></span> <span data-ttu-id="15dab-225">Ce faisant, vous pouvez empêcher les requêtes de recherche de consommer des ressources sur le serveur de production.</span><span class="sxs-lookup"><span data-stu-id="15dab-225">By doing this, you can prevent the lookup queries from consuming resources on the production server.</span></span> <span data-ttu-id="15dab-226">En outre, si la transformation de recherche floue gère l’index de correspondances (c’est-à-dire si MatchIndexOptionsis a pour valeur **GenerateAndMaintainNewIndex**), la transformation peut verrouiller la table de référence durant l’opération de nettoyage des données et empêcher les autres utilisateurs et applications d’accéder à la table.</span><span class="sxs-lookup"><span data-stu-id="15dab-226">In addition, if the Fuzzy Lookup transformation maintains the match index-that is, if MatchIndexOptionsis set to **GenerateAndMaintainNewIndex**-the transformation may lock the reference table for the duration of the data cleaning operation and prevent other users and applications from accessing the table.</span></span>  
  
## <a name="configuring-the-fuzzy-lookup-transformation"></a><span data-ttu-id="15dab-227">Configuration de la transformation de recherche floue</span><span class="sxs-lookup"><span data-stu-id="15dab-227">Configuring the Fuzzy Lookup Transformation</span></span>  
 <span data-ttu-id="15dab-228">Vous pouvez définir les propriétés par le biais du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)] ou par programmation.</span><span class="sxs-lookup"><span data-stu-id="15dab-228">You can set properties through [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer or programmatically.</span></span>  
  
 <span data-ttu-id="15dab-229">Pour plus d’informations sur les propriétés définissables dans la boîte de dialogue **Éditeur de transformation de recherche floue** , cliquez sur l’une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="15dab-229">For more information about the properties that you can set in the **Fuzzy Lookup Transformation Editor** dialog box, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="15dab-230">Éditeur de transformation de recherche floue &#40;onglet Table de référence&#41;</span><span class="sxs-lookup"><span data-stu-id="15dab-230">Fuzzy Lookup Transformation Editor &#40;Reference Table Tab&#41;</span></span>](../../fuzzy-lookup-transformation-editor-reference-table-tab.md)  
  
-   [<span data-ttu-id="15dab-231">Éditeur de transformation de recherche floue &#40;onglet Colonnes&#41;</span><span class="sxs-lookup"><span data-stu-id="15dab-231">Fuzzy Lookup Transformation Editor &#40;Columns Tab&#41;</span></span>](../../fuzzy-lookup-transformation-editor-columns-tab.md)  
  
-   [<span data-ttu-id="15dab-232">Éditeur de transformation de recherche floue &#40;onglet Avancé&#41;</span><span class="sxs-lookup"><span data-stu-id="15dab-232">Fuzzy Lookup Transformation Editor &#40;Advanced Tab&#41;</span></span>](../../fuzzy-lookup-transformation-editor-advanced-tab.md)  
  
 <span data-ttu-id="15dab-233">Pour plus d'informations sur les propriétés définissables dans la boîte de dialogue **Éditeur avancé** ou par programmation, cliquez sur l'une des rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="15dab-233">For more information about the properties that you can set in the **Advanced Editor** dialog box or programmatically, click one of the following topics:</span></span>  
  
-   [<span data-ttu-id="15dab-234">Propriétés communes</span><span class="sxs-lookup"><span data-stu-id="15dab-234">Common Properties</span></span>](../../common-properties.md)  
  
-   [<span data-ttu-id="15dab-235">Propriétés personnalisées des transformations</span><span class="sxs-lookup"><span data-stu-id="15dab-235">Transformation Custom Properties</span></span>](transformation-custom-properties.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="15dab-236">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="15dab-236">Related Tasks</span></span>  
 <span data-ttu-id="15dab-237">Pour plus d’informations sur la définition des propriétés d’un composant de flux de données, consultez [Définir les propriétés d’un composant de flux de données](../set-the-properties-of-a-data-flow-component.md).</span><span class="sxs-lookup"><span data-stu-id="15dab-237">For details about how to set properties of a data flow component, see [Set the Properties of a Data Flow Component](../set-the-properties-of-a-data-flow-component.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="15dab-238">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="15dab-238">See Also</span></span>  
 <span data-ttu-id="15dab-239">[Transformation de recherche](lookup-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="15dab-239">[Lookup Transformation](lookup-transformation.md) </span></span>  
 <span data-ttu-id="15dab-240">[Transformation de regroupement approximatif](fuzzy-grouping-transformation.md) </span><span class="sxs-lookup"><span data-stu-id="15dab-240">[Fuzzy Grouping Transformation](fuzzy-grouping-transformation.md) </span></span>  
 [<span data-ttu-id="15dab-241">Transformations Integration Services</span><span class="sxs-lookup"><span data-stu-id="15dab-241">Integration Services Transformations</span></span>](integration-services-transformations.md)  
  
  
