---
title: Utiliser des variables dans des packages | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: chugugrace
ms.author: chugu
ms.openlocfilehash: acfb6813406bd3a143712e40ec510a4658d4e5da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87602188"
---
# <a name="use-variables-in-packages"></a><span data-ttu-id="c8897-102">Utiliser des variables dans des packages</span><span class="sxs-lookup"><span data-stu-id="c8897-102">Use Variables in Packages</span></span>
  <span data-ttu-id="c8897-103">Les variables constituent un ajout souple et utile aux packages [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] . Elles permettent une communication entre les objets du package et entre les packages parents et enfants.</span><span class="sxs-lookup"><span data-stu-id="c8897-103">Variables are a useful and flexible addition to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages; they can provide communication among objects in the package, and between parent and child packages.</span></span> <span data-ttu-id="c8897-104">Les variables peuvent également être utilisées dans les expressions et les scripts.</span><span class="sxs-lookup"><span data-stu-id="c8897-104">Variables can also be used in expressions and scripts.</span></span>  
  
## <a name="user-defined-variables-and-system-variables"></a><span data-ttu-id="c8897-105">Variables définies par l'utilisateur et variables système</span><span class="sxs-lookup"><span data-stu-id="c8897-105">User-Defined Variables and System Variables</span></span>  
 [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] <span data-ttu-id="c8897-106">fournit les variables système et prend en charge les variables définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c8897-106">provides system variables and supports user-defined variables.</span></span> <span data-ttu-id="c8897-107">Quand vous créez un nouveau package, quand vous ajoutez un conteneur ou une tâche à un package ou quand vous créez un gestionnaire d'événements, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] inclut un ensemble de variables système pour le conteneur.</span><span class="sxs-lookup"><span data-stu-id="c8897-107">When you create a new package, add a container or a task to a package, or create an event handler, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] includes a set of system variables for the container.</span></span> <span data-ttu-id="c8897-108">Les variables système contiennent des informations utiles sur un package, conteneur, tâche ou gestionnaire d'événements.</span><span class="sxs-lookup"><span data-stu-id="c8897-108">System variables contain useful information about a package, container, task, or event handler.</span></span> <span data-ttu-id="c8897-109">Par exemple, au moment de l’exécution, la variable système **MachineName** contient le nom de l’ordinateur sur lequel le package est exécuté et **StartTime** contient l’heure à laquelle le package a démarré son exécution.</span><span class="sxs-lookup"><span data-stu-id="c8897-109">For example, at run time the **MachineName** system variable contains the name of the computer on which the package is running and **StartTime** the time the package started to run.</span></span> <span data-ttu-id="c8897-110">Les variables système sont en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c8897-110">System variables are read-only.</span></span> <span data-ttu-id="c8897-111">Pour plus d’informations, consultez [Variables système](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-111">For more information, see [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="c8897-112">Vous pouvez créer des variables définies par l'utilisateur et les utiliser ensuite dans des packages.</span><span class="sxs-lookup"><span data-stu-id="c8897-112">You can create user-defined variables and then use them in packages.</span></span> <span data-ttu-id="c8897-113">Les variables définies par l’utilisateur peuvent être utilisées de diverses façons dans [!INCLUDE[ssIS](../includes/ssis-md.md)]: dans les scripts, les expressions utilisées par des contraintes de précédence, le conteneur de boucles For, la transformation de colonne dérivée, la transformation de fractionnement conditionnel et les expressions de propriété qui mettent à jour des valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="c8897-113">User-defined variables can be used in many ways in [!INCLUDE[ssIS](../includes/ssis-md.md)]: in scripts; in the expressions used by precedence constraints, the For Loop container, the Derived Column transformation, and the Conditional Split transformation; and in the property expressions that update property values.</span></span>  
  
 <span data-ttu-id="c8897-114">Par exemple, vous pouvez utiliser une variable définie par l'utilisateur dans la condition d'évaluation pour le conteneur de boucles For.</span><span class="sxs-lookup"><span data-stu-id="c8897-114">For example, you can use a user-defined variable in the evaluation condition for the For Loop container.</span></span> <span data-ttu-id="c8897-115">Vous pouvez également mapper la valeur de la collection de l'énumérateur dans un conteneur de boucles Foreach à une variable, et si une tâche d'exécution SQL utilise une instruction SQL paramétrable, vous pouvez mapper les paramètres de l'instruction à des variables.</span><span class="sxs-lookup"><span data-stu-id="c8897-115">You can also map the enumerator collection value in a Foreach Loop container to a variable, and if an Execute SQL task uses a parameterized SQL statement, you can map the parameters for the statement to variables.</span></span> <span data-ttu-id="c8897-116">Pour plus d’informations, consultez [Variables Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-116">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md).</span></span>  
  
## <a name="variables-usage-scenarios"></a><span data-ttu-id="c8897-117">Scénarios d'utilisation de variables</span><span class="sxs-lookup"><span data-stu-id="c8897-117">Variables Usage Scenarios</span></span>  
 <span data-ttu-id="c8897-118">Les variables sont utilisées de nombreuses manières différentes dans les packages [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c8897-118">Variables are used in many different ways in [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] packages.</span></span> <span data-ttu-id="c8897-119">Vous constaterez sans doute que le développement de package est limité tant que vous n'avez pas ajouté une variable définie par l'utilisateur à votre package pour mettre en œuvre la flexibilité et la gestion nécessaires à votre solution.</span><span class="sxs-lookup"><span data-stu-id="c8897-119">You will probably find that package development does not progress far before you have to add a user-defined variable to your package to implement the flexibility and manageability your solution requires.</span></span> <span data-ttu-id="c8897-120">En fonction du scénario, les variables système sont aussi couramment utilisées.</span><span class="sxs-lookup"><span data-stu-id="c8897-120">Depending on the scenario, system variables are also commonly used.</span></span>  
  
 <span data-ttu-id="c8897-121">**Expressions de propriété** : les variables permettent de fournir des valeurs dans les expressions de propriété qui définissent les propriétés d’objets de package et de packages.</span><span class="sxs-lookup"><span data-stu-id="c8897-121">**Property Expressions** Use variables to provide values in the property expressions that set the properties of packages and package objects.</span></span> <span data-ttu-id="c8897-122">Par exemple, l’expression `SELECT * FROM @varTableName` inclut la variable `varTableName` qui met à jour l’instruction SQL exécutée par une tâche d’exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="c8897-122">For example, the expression, `SELECT * FROM @varTableName` includes the variable `varTableName` that updates the SQL statement that an Execute SQL task runs.</span></span> <span data-ttu-id="c8897-123">L’expression `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`met à jour le package exécuté par la tâche d’exécution de package en exécutant le package spécifié dans la variable `varPackageFirst` le premier jour du mois et en exécutant le package spécifié dans la variable `varPackageOther` les autres jours.</span><span class="sxs-lookup"><span data-stu-id="c8897-123">The expression, `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`", updates the package that the Execute Package task runs, by running the package specified in the `varPackageFirst` variable on the first day of the month and running the package specified in the `varPackageOther` variable on other days.</span></span> <span data-ttu-id="c8897-124">Pour plus d’informations, consultez [Expressions de propriété dans des packages](expressions/use-property-expressions-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-124">For more information, see [Use Property Expressions in Packages](expressions/use-property-expressions-in-packages.md).</span></span>  
  
 <span data-ttu-id="c8897-125">**Expressions de flux de données** : les variables permettent de fournir des valeurs dans les expressions dont se servent les transformations de fractionnement conditionnel et de colonne dérivée pour remplir les colonnes ou diriger les lignes de données vers différentes sorties de transformation.</span><span class="sxs-lookup"><span data-stu-id="c8897-125">**Data Flow Expressions** Use variables to provide values in the expressions that the Derived Column and Conditional Split transformations use to populate columns, or to direct data rows to different transformation outputs.</span></span> <span data-ttu-id="c8897-126">Par exemple, l'expression `@varSalutation + LastName`concatène la valeur dans la variable `VarSalutation` et la colonne `LastName` .</span><span class="sxs-lookup"><span data-stu-id="c8897-126">For example, the expression, `@varSalutation + LastName`, concatenates the value in the `VarSalutation` variable and the `LastName` column.</span></span> <span data-ttu-id="c8897-127">L’expression `Income < @HighIncome` dirige vers une sortie les lignes de données dans lesquelles la valeur de la colonne `Income` est inférieure à la valeur de la variable `HighIncome`.</span><span class="sxs-lookup"><span data-stu-id="c8897-127">The expression, `Income < @HighIncome`, directs data rows in which the value of the `Income` column is less than the value in the `HighIncome` variable to an output.</span></span> <span data-ttu-id="c8897-128">Pour plus d’informations, consultez [Transformation de colonne dérivée](data-flow/transformations/derived-column-transformation.md), [Transformation de fractionnement conditionnel](data-flow/transformations/conditional-split-transformation.md) et [Expressions Integration Services &#40;SSIS&#41;](expressions/integration-services-ssis-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-128">For more information, see [Derived Column Transformation](data-flow/transformations/derived-column-transformation.md), [Conditional Split Transformation](data-flow/transformations/conditional-split-transformation.md), and [Integration Services &#40;SSIS&#41; Expressions](expressions/integration-services-ssis-expressions.md).</span></span>  
  
 <span data-ttu-id="c8897-129">**Expressions de contrainte de précédence** : elles fournissent les valeurs à utiliser dans des contraintes de précédence pour déterminer si un exécutable contraint s’exécute.</span><span class="sxs-lookup"><span data-stu-id="c8897-129">**Precedence Constraint Expressions** Provide values to use in precedence constraints to determine whether a constrained executable runs.</span></span> <span data-ttu-id="c8897-130">Les expressions peuvent être utilisées avec un résultat d'exécution (succès, échec, achèvement de l'opération) ou à la place d'un résultat d'exécution.</span><span class="sxs-lookup"><span data-stu-id="c8897-130">The expressions can be used either together with an execution outcome (success, failure, completion), or instead of an execution outcome.</span></span> <span data-ttu-id="c8897-131">Par exemple, si l'expression `@varMax > @varMin` s'évalue à `true`, l'exécutable s'exécute.</span><span class="sxs-lookup"><span data-stu-id="c8897-131">For example, if the expression, `@varMax > @varMin`, evaluates to `true`, the executable runs.</span></span> <span data-ttu-id="c8897-132">Pour plus d’informations, consultez [Ajouter des expressions aux contraintes de précédence](control-flow/precedence-constraints.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-132">For more information, see [Add Expressions to Precedence Constraints](control-flow/precedence-constraints.md).</span></span>  
  
 <span data-ttu-id="c8897-133">**Paramètres et codes de retour** : ils fournissent des valeurs aux paramètres d’entrée ou stockent les valeurs des paramètres de sortie et des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="c8897-133">**Parameters and Return Codes** Provide values to input parameters, or store the values of output parameters and return codes.</span></span> <span data-ttu-id="c8897-134">Cette opération s'effectue en mappant les variables aux paramètres et aux valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="c8897-134">You do this by mapping the variables to parameters and return values.</span></span> <span data-ttu-id="c8897-135">Par exemple, si vous affectez à la variable `varProductId` la valeur 23 et que vous exécutez l’instruction SQL `SELECT * from Production.Product WHERE ProductID = ?`, la requête récupère le produit associé à la valeur `ProductID` 23.</span><span class="sxs-lookup"><span data-stu-id="c8897-135">For example, if you set the variable `varProductId` to 23 and run the SQL statement, `SELECT * from Production.Product WHERE ProductID = ?`, the query retrieves the product with a `ProductID` of 23.</span></span> <span data-ttu-id="c8897-136">Pour plus d’informations, consultez [Tâche d’exécution de requêtes SQL](control-flow/execute-sql-task.md) et [Paramètres et codes de retour dans la tâche d’exécution SQL](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-136">For more information, see [Execute SQL Task](control-flow/execute-sql-task.md) and [Parameters and Return Codes in the Execute SQL Task](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).</span></span>  
  
 <span data-ttu-id="c8897-137">**Expressions de boucle For** : elles fournissent les valeurs à utiliser dans les expressions d’initialisation, d’évaluation et d’assignation de la boucle For.</span><span class="sxs-lookup"><span data-stu-id="c8897-137">**For Loop Expressions** Provide values to use in the initialization, evaluation, and assignment expressions of the For Loop.</span></span> <span data-ttu-id="c8897-138">Par exemple, si la variable `varCount` a la valeur 2 et la variable `varMaxCount` la valeur 10 et que l’expression d’initialisation est `@varCount`, l’expression d’évaluation  `@varCount < @varMaxCount`et l’expression d’assignation `@varCount =@varCount +1`, la boucle se répète 8 fois.</span><span class="sxs-lookup"><span data-stu-id="c8897-138">For example, if the variable `varCount` is 2 and `varMaxCount` is 10, the initialization expression is `@varCount`, the evaluation expression is  `@varCount < @varMaxCount`, and the assignment expression is `@varCount =@varCount +1`, then the loop repeats 8 times.</span></span> <span data-ttu-id="c8897-139">Pour plus d’informations, consultez [Conteneur de boucles For](control-flow/for-loop-container.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-139">For more information, see [For Loop Container](control-flow/for-loop-container.md).</span></span>  
  
 <span data-ttu-id="c8897-140">**Configurations de variable de package parent** : elles permettent de passer des valeurs des packages parents aux packages enfants.</span><span class="sxs-lookup"><span data-stu-id="c8897-140">**Parent Package Variable Configurations** Pass values from parent packages to child packages.</span></span> <span data-ttu-id="c8897-141">Les packages enfants peuvent accéder à des variables dans le package parent à l'aide de configurations de variable de package parent.</span><span class="sxs-lookup"><span data-stu-id="c8897-141">Child packages can access variables in the parent package by using parent package variable configurations.</span></span> <span data-ttu-id="c8897-142">Par exemple, si le package enfant doit utiliser la même date que le package parent, le package enfant peut définir une configuration de variable de package parent qui spécifie une variable définie par la fonction GETDATE dans le package parent.</span><span class="sxs-lookup"><span data-stu-id="c8897-142">For example, if the child package must use the same date as the parent package, the child package can define a parent package variable configuration that specifies a variable set by the GETDATE function in the parent package.</span></span> <span data-ttu-id="c8897-143">Pour plus d’informations, consultez [Tâche d’exécution de package](control-flow/execute-package-task.md) et [Configurations de package](../../2014/integration-services/package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-143">For more information, see [Execute Package Task](control-flow/execute-package-task.md) and [Package Configurations](../../2014/integration-services/package-configurations.md).</span></span>  
  
 <span data-ttu-id="c8897-144">**Tâche de script et composant de script** : ils fournissent une liste de variables en lecture seule et en lecture/écriture à la tâche de script ou au composant de script, mettent à jour les variables en lecture/écriture dans le script, puis utilisent les valeurs mises à jour à l’intérieur ou à l’extérieur du script.</span><span class="sxs-lookup"><span data-stu-id="c8897-144">**Script Task and Script Component** Provide a list of read-only and read/write variable to the Script task or Script component, update the read/write variables within the script, and then use the updated values in or outside the script.</span></span> <span data-ttu-id="c8897-145">Par exemple, dans le code `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, la variable de script `numberOfCars` est mise à jour par la valeur dans la variable `NumberOfCars`.</span><span class="sxs-lookup"><span data-stu-id="c8897-145">For example, in the code, `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`, the script variable `numberOfCars` is updated by the value in the variable, `NumberOfCars`.</span></span> <span data-ttu-id="c8897-146">Pour plus d’informations, consultez [Utilisation de variables dans la tâche de script](control-flow/script-task.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-146">For more information, see [Using Variables in the Script Task](control-flow/script-task.md).</span></span>  
  
## <a name="configurations-and-variables"></a><span data-ttu-id="c8897-147">Configurations et variables</span><span class="sxs-lookup"><span data-stu-id="c8897-147">Configurations and Variables</span></span>  
 <span data-ttu-id="c8897-148">Pour mettre à jour dynamiquement des variables, vous pouvez créer des configurations pour les variables, déployer les configurations dans le package, puis mettre à jour les valeurs de variable dans un fichier de configuration lorsque vous déployez les packages.</span><span class="sxs-lookup"><span data-stu-id="c8897-148">To dynamically update variables, you can create configurations for the variables, deploy the configurations with the package, and then update the variable values in the configuration file when you deploy the packages.</span></span> <span data-ttu-id="c8897-149">À l'exécution, le package utilise les valeurs de variable mises à jour.</span><span class="sxs-lookup"><span data-stu-id="c8897-149">At run time, the package uses the updated variable values.</span></span> <span data-ttu-id="c8897-150">Pour plus d’informations, consultez [Créer des configurations de package](../../2014/integration-services/create-package-configurations.md).</span><span class="sxs-lookup"><span data-stu-id="c8897-150">For more information, see [Create Package Configurations](../../2014/integration-services/create-package-configurations.md).</span></span>  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a><span data-ttu-id="c8897-151">Pour ajouter, modifier et supprimer des variables définies par l'utilisateur</span><span class="sxs-lookup"><span data-stu-id="c8897-151">To add, modify, and delete user-defined variables</span></span>  
  
-   [<span data-ttu-id="c8897-152">Ajouter, supprimer, modifier l'étendue de la variable définie par l'utilisateur dans un package</span><span class="sxs-lookup"><span data-stu-id="c8897-152">Add, Delete, Change Scope of User-Defined Variable in a Package</span></span>](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [<span data-ttu-id="c8897-153">Définir les propriétés d’une variable définie par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="c8897-153">Set the Properties of a User-Defined Variable</span></span>](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
