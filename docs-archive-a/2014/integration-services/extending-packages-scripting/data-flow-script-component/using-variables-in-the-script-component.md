---
title: Utilisation de variables dans le composant Script | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], using variables
ms.assetid: 92d1881a-1ef1-43ae-b1ca-48d0536bdbc2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4328a938c56ad8383c12cdae1d6511604ec65582
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704315"
---
# <a name="using-variables-in-the-script-component"></a><span data-ttu-id="9ae7f-102">Utilisation de variables dans le composant Script</span><span class="sxs-lookup"><span data-stu-id="9ae7f-102">Using Variables in the Script Component</span></span>
  <span data-ttu-id="9ae7f-103">Les variables stockent les valeurs qu'un package et ses conteneurs, tâches et gestionnaires d'événements peuvent utiliser au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-103">Variables store values that a package and its containers, tasks, and event handlers can use at run time.</span></span> <span data-ttu-id="9ae7f-104">Pour plus d’informations, consultez [Variables Integration Services &#40;SSIS&#41;](../../integration-services-ssis-variables.md).</span><span class="sxs-lookup"><span data-stu-id="9ae7f-104">For more information, see [Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md).</span></span>  
  
 <span data-ttu-id="9ae7f-105">Vous pouvez rendre des variables existantes disponibles pour l’accès en lecture seule ou en lecture/écriture par votre script personnalisé en entrant des listes délimitées par des virgules de variables dans les `ReadOnlyVariables` champs et de `ReadWriteVariables` la page **script** de l **'éditeur de transformation de script**.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-105">You can make existing variables available for read-only or read/write access by your custom script by entering comma-delimited lists of variables in the `ReadOnlyVariables` and `ReadWriteVariables` fields on the **Script** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="9ae7f-106">N'oubliez pas que les noms de variables respectent la casse.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-106">Keep in mind that variable names are case-sensitive.</span></span> <span data-ttu-id="9ae7f-107">Utilisez la propriété `Value` pour lire et écrire des variables individuelles.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-107">Use the `Value` property to read from and write to individual variables.</span></span> <span data-ttu-id="9ae7f-108">Le composant Script gère tout le verrouillage sous-jacent requis quand votre script manipule les variables au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-108">The Script component handles any required locking behind the scenes as your script manipulates the variables at run time.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="9ae7f-109">La collection de `ReadWriteVariables` est uniquement disponible dans la méthode `PostExecute` pour maximiser les performances et réduire le risque de conflits de verrouillage.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-109">The collection of `ReadWriteVariables` is only available in the `PostExecute` method to maximize performance and minimize the risk of locking conflicts.</span></span> <span data-ttu-id="9ae7f-110">Par conséquent, vous ne pouvez pas incrémenter directement la valeur d'une variable de package à mesure que vous traitez chaque ligne de données.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-110">Therefore you cannot directly increment the value of a package variable as you process each row of data.</span></span> <span data-ttu-id="9ae7f-111">Incrémentez plutôt la valeur d'une variable locale, puis définissez la valeur de la variable de package sur la valeur de la variable locale dans la méthode `PostExecute` une fois que toutes les données ont été traitées.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-111">Increment the value of a local variable instead, and set the value of the package variable to the value of the local variable in the `PostExecute` method after all data has been processed.</span></span> <span data-ttu-id="9ae7f-112">Vous pouvez également utiliser la propriété <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> pour contourner cette limitation, comme décrit ultérieurement dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-112">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property to work around this limitation, as described later in this topic.</span></span> <span data-ttu-id="9ae7f-113">Toutefois, l'écriture directe dans une variable de package au fut et à mesure du traitement de chaque ligne aura des effets négatifs sur les performances et augmentera le risque de conflits de verrouillage.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-113">However, writing directly to a package variable as each row is processed will negatively impact performance and increase the risk of locking conflicts.</span></span>  
  
 <span data-ttu-id="9ae7f-114">Pour plus d’informations sur la page **Scripts** de l’**Éditeur de transformation de script**, consultez [Configuration du composant Script dans l’Éditeur de composant de script](configuring-the-script-component-in-the-script-component-editor.md) et [Éditeur de transformation de script &#40;Page Script&#41;](../../script-transformation-editor-script-page.md).</span><span class="sxs-lookup"><span data-stu-id="9ae7f-114">For more information about the **Script** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Script Page&#41;](../../script-transformation-editor-script-page.md).</span></span>  
  
 <span data-ttu-id="9ae7f-115">Le composant Script crée une classe de collection `Variables` dans l'élément de projet `ComponentWrapper` avec une propriété d'accesseur fortement typé pour la valeur de chaque variable préconfigurée où la propriété porte le même nom que la variable elle-même.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-115">The Script component creates a `Variables` collection class in the `ComponentWrapper` project item with a strongly-typed accessor property for the value of each preconfigured variable where the property has the same name as the variable itself.</span></span> <span data-ttu-id="9ae7f-116">Cette collection est exposée via la propriété `Variables` de la classe `ScriptMain`.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-116">This collection is exposed through the `Variables` property of the `ScriptMain` class.</span></span> <span data-ttu-id="9ae7f-117">La propriété de l'accesseur fournit une autorisation de lecture seule ou de lecture/écriture à la valeur de la variable.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-117">The accessor property provides read-only or read/write permission to the value of the variable as appropriate.</span></span> <span data-ttu-id="9ae7f-118">Par exemple, si vous avez ajouté qu'une variable de type entier nommée `MyIntegerVariable` à la liste `ReadOnlyVariables`, vous pouvez extraire sa valeur dans votre script en utilisant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="9ae7f-118">For example, if you have added an integer variable named `MyIntegerVariable` to the `ReadOnlyVariables` list, you can retrieve its value in your script by using the following code:</span></span>  
  
 `Dim myIntegerVariableValue As Integer = Me.Variables.MyIntegerVariable`  
  
 <span data-ttu-id="9ae7f-119">Vous pouvez également utiliser la propriété <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, accessible en appelant `Me.VariableDispenser`, pour utiliser des variables dans le composant Script.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-119">You can also use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property, accessed by calling `Me.VariableDispenser`, to work with variables in the Script component.</span></span> <span data-ttu-id="9ae7f-120">Dans ce cas, vous n'utilisez pas les propriétés de l'accesseur typé et nommé pour les variables, mais vous accédez directement aux variables.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-120">In this case you are not using the typed and named accessor properties for variables, but accessing the variables directly.</span></span> <span data-ttu-id="9ae7f-121">Lorsque vous utilisez la propriété <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, vous devez gérer à la fois la sémantique de verrouillage et la conversion des types de données pour les valeurs de variables dans votre propre code.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-121">When using the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A>, you must handle both the locking semantics and the casting of data types for variable values in your own code.</span></span> <span data-ttu-id="9ae7f-122">Vous devez utiliser la propriété <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> au lieu des propriétés de l'accesseur nommé et typé si vous souhaitez utiliser une variable qui n'est pas disponible au moment du design mais qui est créée par programme au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-122">You have to use the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.VariableDispenser%2A> property instead of the named and typed accessor properties if you want to work with a variable that is not available at design time but is created programmatically at run time.</span></span>  
  
<span data-ttu-id="9ae7f-123">![Icône de Integration Services (petite)](../../media/dts-16.gif "Icône Integration Services (petite)")  **restez à jour avec Integration Services**</span><span class="sxs-lookup"><span data-stu-id="9ae7f-123">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="9ae7f-124">Pour obtenir les derniers téléchargements, articles, exemples et vidéos de Microsoft, ainsi que des solutions sélectionnées par la communauté, visitez la page [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] sur MSDN :</span><span class="sxs-lookup"><span data-stu-id="9ae7f-124">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="9ae7f-125">Visiter la page Integration Services sur MSDN</span><span class="sxs-lookup"><span data-stu-id="9ae7f-125">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="9ae7f-126">Pour recevoir une notification automatique de ces mises à jour, abonnez-vous aux flux RSS disponibles sur la page.</span><span class="sxs-lookup"><span data-stu-id="9ae7f-126">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9ae7f-127">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9ae7f-127">See Also</span></span>  
 <span data-ttu-id="9ae7f-128">[Variables Integration Services &#40;SSIS&#41;](../../integration-services-ssis-variables.md) </span><span class="sxs-lookup"><span data-stu-id="9ae7f-128">[Integration Services &#40;SSIS&#41; Variables](../../integration-services-ssis-variables.md) </span></span>  
 [<span data-ttu-id="9ae7f-129">Utiliser des variables dans des packages</span><span class="sxs-lookup"><span data-stu-id="9ae7f-129">Use Variables in Packages</span></span>](../../use-variables-in-packages.md)  
  
  
