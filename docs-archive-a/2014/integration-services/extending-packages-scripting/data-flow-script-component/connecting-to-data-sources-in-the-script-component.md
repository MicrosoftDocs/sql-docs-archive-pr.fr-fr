---
title: Connexion aux sources de données dans le composant Script | Microsoft Docs
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
helpviewer_keywords:
- Script component [Integration Services], connecting to data sources
ms.assetid: 96de63ab-ff48-4e7e-89e0-ffd6a89c63b6
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 9272f946abb68a1c54cd6f4851806ec6a1b15de7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611168"
---
# <a name="connecting-to-data-sources-in-the-script-component"></a><span data-ttu-id="3befb-102">Connexion aux sources de données dans le composant Script</span><span class="sxs-lookup"><span data-stu-id="3befb-102">Connecting to Data Sources in the Script Component</span></span>
  <span data-ttu-id="3befb-103">Un gestionnaire de connexions est une unité pratique qui encapsule et stocke les informations requises pour se connecter à une source de données d'un type particulier.</span><span class="sxs-lookup"><span data-stu-id="3befb-103">A connection manager is a convenient unit that encapsulates and stores the information that is required to connect to a data source of a particular type.</span></span> <span data-ttu-id="3befb-104">Pour plus d’informations, consultez [Connexions Integration Services &#40;SSIS&#41;](../../connection-manager/integration-services-ssis-connections.md).</span><span class="sxs-lookup"><span data-stu-id="3befb-104">For more information, see [Integration Services &#40;SSIS&#41; Connections](../../connection-manager/integration-services-ssis-connections.md).</span></span>  
  
 <span data-ttu-id="3befb-105">Vous pouvez faire en sorte que des gestionnaires de connexions existants soient accessibles par le script personnalisé compris dans le composant source ou de destination en cliquant sur les boutons **Ajouter** et **Supprimer** de la page **Gestionnaires de connexions** de l’**Éditeur de transformation de script**.</span><span class="sxs-lookup"><span data-stu-id="3befb-105">You can make existing connection managers available for access by the custom script in the source or destination component by clicking the **Add** and **Remove** buttons on the **Connection Managers** page of the **Script Transformation Editor**.</span></span> <span data-ttu-id="3befb-106">Toutefois, vous devez écrire votre propre code personnalisé pour charger ou enregistrer vos données et éventuellement ouvrir et fermer la connexion à la source de données.</span><span class="sxs-lookup"><span data-stu-id="3befb-106">However, you must write your own custom code to load or save your data, and possibly to open and close the connection to the data source.</span></span> <span data-ttu-id="3befb-107">Pour plus d’informations sur la page **Gestionnaires de connexions** de l’**Éditeur de transformation de script**, consultez [Configuration du composant Script dans l’Éditeur de composant de script](configuring-the-script-component-in-the-script-component-editor.md) et [Éditeur de transformation de script &#40;Page Gestionnaires de connexions&#41;](../../script-transformation-editor-connection-managers-page.md).</span><span class="sxs-lookup"><span data-stu-id="3befb-107">For more information about the **Connection Managers** page of the **Script Transformation Editor**, see [Configuring the Script Component in the Script Component Editor](configuring-the-script-component-in-the-script-component-editor.md) and [Script Transformation Editor &#40;Connection Managers Page&#41;](../../script-transformation-editor-connection-managers-page.md).</span></span>  
  
 <span data-ttu-id="3befb-108">Le composant Script crée une classe de collection `Connections` dans l'élément de projet `ComponentWrapper` qui contient un accesseur fortement typé pour chaque gestionnaire de connexions qui porte le même nom que le gestionnaire de connexions lui-même.</span><span class="sxs-lookup"><span data-stu-id="3befb-108">The Script component creates a `Connections` collection class in the `ComponentWrapper` project item that contains a strongly-typed accessor for each connection manager that has the same name as the connection manager itself.</span></span> <span data-ttu-id="3befb-109">Cette collection est exposée via la propriété `Connections` de la classe `ScriptMain`.</span><span class="sxs-lookup"><span data-stu-id="3befb-109">This collection is exposed through the `Connections` property of the `ScriptMain` class.</span></span> <span data-ttu-id="3befb-110">La propriété de l'accesseur renvoie une référence au gestionnaire de connexions sous forme d'instance de l'objet <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span><span class="sxs-lookup"><span data-stu-id="3befb-110">The accessor property returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="3befb-111">Par exemple, si vous avez ajouté un gestionnaire de connexion nommé `MyADONETConnection` dans la page Gestionnaires de connexions de la boîte de dialogue, vous pouvez obtenir une référence à ce dernier dans votre script en ajoutant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="3befb-111">For example, if you have added a connection manager named `MyADONETConnection` on the Connection Managers page of the dialog box, you can obtain a reference to it in your script by adding the following code:</span></span>  
  
 `Dim myADONETConnectionManager As IDTSConnectionManager100 = _`  
  
 `Me.Connections.MyADONETConnection`  
  
> [!NOTE]  
>  <span data-ttu-id="3befb-112">Vous devez connaître le type de connexion renvoyé par le gestionnaire de connexions avant d'appeler `AcquireConnection`.</span><span class="sxs-lookup"><span data-stu-id="3befb-112">You must know the type of connection that is returned by the connection manager before you call `AcquireConnection`.</span></span> <span data-ttu-id="3befb-113">Étant donné que la tâche de script a `Option Strict` activé, vous devez effectuer un cast de la connexion, qui est retournée en tant que type `Object`, vers le type de connexion approprié avant de pouvoir l'utiliser.</span><span class="sxs-lookup"><span data-stu-id="3befb-113">Because the Script task has `Option Strict` enabled, you must cast the connection, which is returned as type `Object`, to the appropriate connection type before you can use it.</span></span>  
  
 <span data-ttu-id="3befb-114">Ensuite, vous appelez la méthode `AcquireConnection` du gestionnaire de connexions spécifique pour obtenir soit la connexion sous-jacente, soit les informations requises pour vous connecter à la source de données.</span><span class="sxs-lookup"><span data-stu-id="3befb-114">Next, you call the `AcquireConnection` method of the specific connection manager to obtain either the underlying connection or the information that is required to connect to the data source.</span></span> <span data-ttu-id="3befb-115">Par exemple, vous obtenez une référence au **System.Data.SqlConnection** encapsulé par un gestionnaire de connexions ADO.NET en utilisant le code suivant :</span><span class="sxs-lookup"><span data-stu-id="3befb-115">For example, you obtain a reference to the **System.Data.SqlConnection** wrapped by an ADO.NET connection manager by using the following code:</span></span>  
  
 `Dim myADOConnection As SqlConnection = _`  
  
 `CType(MyADONETConnectionManager.AcquireConnection(Nothing), SqlConnection)`  
  
 <span data-ttu-id="3befb-116">Par opposition, le même appel d'un gestionnaire de connexions de fichier plat retourne uniquement le chemin d'accès et le nom de fichier de la source de données.</span><span class="sxs-lookup"><span data-stu-id="3befb-116">In contrast, the same call to a flat file connection manager returns only the path and file name of the file data source.</span></span>  
  
 `Dim myFlatFile As String = _`  
  
 `CType(MyFlatFileConnectionManager.AcquireConnection(Nothing), String)`  
  
 <span data-ttu-id="3befb-117">Vous devez alors fournir ce chemin d'accès et ce nom de fichier à un `System.IO.StreamReader` ou `Streamwriter` pour lire ou écrire les données dans le fichier plat.</span><span class="sxs-lookup"><span data-stu-id="3befb-117">You then must provide this path and file name to a `System.IO.StreamReader` or `Streamwriter` to read or write the data in the flat file.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="3befb-118">Lorsque vous écrivez du code managé dans un composant Script, vous ne pouvez pas appeler la méthode AcquireConnection des gestionnaires de connexions qui retournent des objets non managés, comme le gestionnaire de connexions OLE DB et le gestionnaire de connexions Excel.</span><span class="sxs-lookup"><span data-stu-id="3befb-118">When you write managed code in a Script component, you cannot call the AcquireConnection method of connection managers that return unmanaged objects, such as the OLE DB connection manager and the Excel connection manager.</span></span> <span data-ttu-id="3befb-119">Toutefois, vous pouvez lire la propriété ConnectionString de ces gestionnaires de connexions et vous connecter directement à la source de données dans votre code en utilisant la chaîne de connexion d’une **connexion** OLEDB à partir de l’espace de noms **System.Data.OleDb**.</span><span class="sxs-lookup"><span data-stu-id="3befb-119">However, you can read the ConnectionString property of these connection managers, and connect to the data source directly in your code by using the connection string of an OLEDB **connection** from the **System.Data.OleDb** namespace.</span></span>  
>   
>  <span data-ttu-id="3befb-120">Si vous devez appeler la méthode AcquireConnection d’un gestionnaire de connexions qui retourne un objet non managé, utilisez un gestionnaire de connexions ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="3befb-120">If you need to call the AcquireConnection method of a connection manager that returns an unmanaged object, use an ADO.NET connection manager.</span></span> <span data-ttu-id="3befb-121">Lorsque vous configurez le gestionnaire de connexions ADO.NET afin d'utiliser un fournisseur OLE DB, il se connecte en utilisant le fournisseur de données .NET Framework pour OLE DB.</span><span class="sxs-lookup"><span data-stu-id="3befb-121">When you configure the ADO.NET connection manager to use an OLE DB provider, it connects by using the .NET Framework Data Provider for OLE DB.</span></span> <span data-ttu-id="3befb-122">Dans ce cas, la méthode AcquireConnection retourne un `System.Data.OleDb.OleDbConnection` au lieu d’un objet non managé.</span><span class="sxs-lookup"><span data-stu-id="3befb-122">In this case, the AcquireConnection method returns a `System.Data.OleDb.OleDbConnection` instead of an unmanaged object.</span></span> <span data-ttu-id="3befb-123">Pour configurer un gestionnaire de connexions ADO.NET en vue de son utilisation avec une source de données Excel, sélectionnez le fournisseur Microsoft OLE DB pour Jet, spécifiez un classeur Excel, puis entrez `Excel 8.0` (pour Excel 97 et versions ultérieures) comme valeur de **Propriétés étendues** dans la page **Tout** de la boîte de dialogue **Gestionnaire de connexions**.</span><span class="sxs-lookup"><span data-stu-id="3befb-123">To configure an ADO.NET connection manager for use with an Excel data source, select the Microsoft OLE DB Provider for Jet, specify an Excel workbook, and then enter `Excel 8.0` (for Excel 97 and later) as the value of **Extended Properties** on the **All** page of the **Connection Manager** dialog box.</span></span>  
  
 <span data-ttu-id="3befb-124">Pour plus d’informations sur l’utilisation des gestionnaires de connexions avec le composant Script, consultez [Création d’une source avec le composant Script](../../extending-packages-scripting-data-flow-script-component-types/creating-a-source-with-the-script-component.md) et [Création d’une destination avec le composant Script](../../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="3befb-124">For more information about how to use connection managers with the script component, see [Creating a Source with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-source-with-the-script-component.md) and [Creating a Destination with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-destination-with-the-script-component.md).</span></span>  
  
<span data-ttu-id="3befb-125">![Icône de Integration Services (petite)](../../media/dts-16.gif "Icône Integration Services (petite)")  **restez à jour avec Integration Services**</span><span class="sxs-lookup"><span data-stu-id="3befb-125">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="3befb-126">Pour obtenir les derniers téléchargements, articles, exemples et vidéos de Microsoft, ainsi que des solutions sélectionnées par la communauté, visitez la page [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] sur MSDN :</span><span class="sxs-lookup"><span data-stu-id="3befb-126">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="3befb-127">Visiter la page Integration Services sur MSDN</span><span class="sxs-lookup"><span data-stu-id="3befb-127">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="3befb-128">Pour recevoir une notification automatique de ces mises à jour, abonnez-vous aux flux RSS disponibles sur la page.</span><span class="sxs-lookup"><span data-stu-id="3befb-128">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3befb-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3befb-129">See Also</span></span>  
 <span data-ttu-id="3befb-130">[Integration Services &#40;les connexions de&#41; SSIS](../../connection-manager/integration-services-ssis-connections.md) </span><span class="sxs-lookup"><span data-stu-id="3befb-130">[Integration Services &#40;SSIS&#41; Connections](../../connection-manager/integration-services-ssis-connections.md) </span></span>  
 [<span data-ttu-id="3befb-131">Créer des gestionnaires de connexions</span><span class="sxs-lookup"><span data-stu-id="3befb-131">Create Connection Managers</span></span>](../../create-connection-managers.md)  
  
  
