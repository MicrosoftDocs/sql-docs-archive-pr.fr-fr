---
title: Configuration du composant Script dans l’éditeur de composant de script | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: reference
dev_langs:
- VB
helpviewer_keywords:
- SSIS Script component
- Script Component Editor
- SSIS Script component, configuring
- Script component [Integration Services], configuring
ms.assetid: 586dd799-f383-4d6d-b1a1-f09233d14f0a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 4a9925d29c7a960c46e217f1e96c0bcae4f217b9
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87611171"
---
# <a name="configuring-the-script-component-in-the-script-component-editor"></a><span data-ttu-id="5dce5-102">Configuration du composant Script dans l'éditeur de composant de script</span><span class="sxs-lookup"><span data-stu-id="5dce5-102">Configuring the Script Component in the Script Component Editor</span></span>
  <span data-ttu-id="5dce5-103">Avant d’écrire du code personnalisé dans le composant Script, vous devez sélectionner le type de composant de flux de données que vous souhaitez créer (source, transformation ou destination), puis configurer les métadonnées et propriétés du composant dans l’**Éditeur de transformation de script**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-103">Before you write custom code in the Script component, you must select the type of data flow component that you want to create-source, transformation, or destination-and then configure the component's metadata and properties in the **Script Transformation Editor**.</span></span>

## <a name="selecting-the-type-of-component-to-create"></a><span data-ttu-id="5dce5-104">Sélection du type de composant à créer</span><span class="sxs-lookup"><span data-stu-id="5dce5-104">Selecting the Type of Component to Create</span></span>
 <span data-ttu-id="5dce5-105">Lorsque vous ajoutez un composant Script au volet Flux de données du concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)], la boîte de dialogue **Sélectionner le type de composant de script** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="5dce5-105">When you add a Script component to the Data Flow pane of [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the **Select Script Component Type** dialog box appears.</span></span> <span data-ttu-id="5dce5-106">Préconfigurez le composant en tant que source, transformation ou destination.</span><span class="sxs-lookup"><span data-stu-id="5dce5-106">You preconfigure the component as a source, transformation, or destination.</span></span> <span data-ttu-id="5dce5-107">Une fois cette sélection initiale effectuée, vous pouvez continuer à configurer le composant dans l’**Éditeur de transformation de script**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-107">After you make this initial selection, you can continue to configure the component in the **Script Transformation Editor**.</span></span>

 <span data-ttu-id="5dce5-108">Pour définir le langage de script par défaut du composant Script, utilisez l’option **Langage de script** dans la page **Général** de la boîte de dialogue **Options**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-108">To set the default script language for the Script component, use the **Scripting language** option on the **General** page of the **Options** dialog box.</span></span> <span data-ttu-id="5dce5-109">Pour plus d'informations, consultez [General Page](../../general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-109">For more information, see [General Page](../../general-page-of-integration-services-designers-options.md).</span></span>

## <a name="understanding-the-two-design-time-modes"></a><span data-ttu-id="5dce5-110">Fonctionnement des deux modes au moment du design</span><span class="sxs-lookup"><span data-stu-id="5dce5-110">Understanding the Two Design-Time Modes</span></span>
 <span data-ttu-id="5dce5-111">Dans le Concepteur [!INCLUDE[ssIS](../../../includes/ssis-md.md)], le composant Script propose deux modes : le mode Création des métadonnées et le mode Création du code.</span><span class="sxs-lookup"><span data-stu-id="5dce5-111">In [!INCLUDE[ssIS](../../../includes/ssis-md.md)] Designer, the Script component has two modes: metadata design mode and code design mode.</span></span>

 <span data-ttu-id="5dce5-112">Lorsque vous ouvrez l’**Éditeur de transformation de script**, le composant passe en mode Création des métadonnées.</span><span class="sxs-lookup"><span data-stu-id="5dce5-112">When you open the **Script Transformation Editor**, the component enters metadata design mode.</span></span> <span data-ttu-id="5dce5-113">Ce mode vous permet de sélectionner des colonnes d'entrée et d'ajouter ou configurer des sorties et des colonnes de sortie, mais il ne vous permet pas d'écrire du code.</span><span class="sxs-lookup"><span data-stu-id="5dce5-113">In this mode, you can select input columns, and add or configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="5dce5-114">Après avoir configuré les métadonnées du composant, vous pouvez basculer en mode Création de code afin d'écrire le script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-114">After you have configured the component's metadata, you can switch to code design mode to write the script.</span></span>

 <span data-ttu-id="5dce5-115">Lorsque vous basculez en mode Création du code en cliquant sur **Modifier le script**, le composant Script verrouille les métadonnées pour empêcher toute modification supplémentaire, puis il génère automatiquement le code de base à partir des métadonnées des entrées et des sorties.</span><span class="sxs-lookup"><span data-stu-id="5dce5-115">When you switch to code design mode by clicking **Edit Script**, the Script component locks metadata to prevent additional changes, and then automatically generates base code from the metadata of the inputs and outputs.</span></span> <span data-ttu-id="5dce5-116">Une fois que le code généré automatiquement est complet, vous êtes en mesure d'entrer votre code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="5dce5-116">After the autogenerated code is complete, you will be able to enter your custom code.</span></span> <span data-ttu-id="5dce5-117">Votre code utilise les classes de base générées automatiquement pour traiter les lignes d'entrée, accéder à des mémoires tampons et des colonnes dans les mémoires tampons et extraire du package des gestionnaires de connexions et des variables, sous la forme d'objets fortement typés.</span><span class="sxs-lookup"><span data-stu-id="5dce5-117">Your code uses the auto-generated base classes to process input rows, to access buffers and columns in the buffers, and to retrieve connection managers and variables from the package, all as strongly-typed objects.</span></span>

 <span data-ttu-id="5dce5-118">Après avoir entré votre code personnalisé en mode Création de code, vous pouvez revenir en mode Création de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="5dce5-118">After entering your custom code in code design mode, you can switch back to metadata design mode.</span></span> <span data-ttu-id="5dce5-119">Cette opération ne supprime pas le code entré, mais les modifications ultérieures apportées aux métadonnées provoquent la régénération de la classe de base.</span><span class="sxs-lookup"><span data-stu-id="5dce5-119">This does not delete any code that you have entered; however, subsequent changes to the metadata cause the base class to be regenerated.</span></span> <span data-ttu-id="5dce5-120">Après quoi, la validation de votre composant risque d'échouer du fait que des objets référencés par votre code personnalisé peuvent ne plus exister ou avoir été modifiés.</span><span class="sxs-lookup"><span data-stu-id="5dce5-120">Afterward, your component may fail validation because objects referenced by your custom code may no longer exist or may have been modified.</span></span> <span data-ttu-id="5dce5-121">Dans ce cas, vous devez corriger votre code manuellement afin qu'il puisse être correctement compilé avec la classe de base régénérée.</span><span class="sxs-lookup"><span data-stu-id="5dce5-121">In this case, you must fix your code manually so that it can be compiled successfully against the regenerated base class.</span></span>

## <a name="configuring-the-component-in-metadata-design-mode"></a><span data-ttu-id="5dce5-122">Configuration du composant en mode Création de métadonnées</span><span class="sxs-lookup"><span data-stu-id="5dce5-122">Configuring the Component in Metadata Design Mode</span></span>
 <span data-ttu-id="5dce5-123">Le mode Création de métadonnées vous permet de sélectionner des colonnes d'entrée; et d'ajouter et configurer des sorties et des colonnes de sortie, mais il ne vous permet pas d'écrire du code.</span><span class="sxs-lookup"><span data-stu-id="5dce5-123">In metadata design mode, you can select input columns, and add and configure outputs and output columns, but you cannot write code.</span></span> <span data-ttu-id="5dce5-124">Après avoir configuré les métadonnées du composant, basculez en mode Création de code afin d'écrire le script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-124">After you have configured the component's metadata, switch to code design mode to write the script.</span></span>

 <span data-ttu-id="5dce5-125">Les propriétés que vous devez configurer dans l'éditeur personnalisé dépendent de l'utilisation du composant Script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-125">The properties that you must configure in the custom editor depend on the usage of the Script component.</span></span> <span data-ttu-id="5dce5-126">Le composant Script peut être configuré en tant que source, transformation ou destination.</span><span class="sxs-lookup"><span data-stu-id="5dce5-126">The Script component can be configured as a source, a transformation, or a destination.</span></span> <span data-ttu-id="5dce5-127">En fonction de l'utilisation qui est faite du composant, il prendra en charge une entrée ou des sorties, ou bien les deux.</span><span class="sxs-lookup"><span data-stu-id="5dce5-127">Depending on how the component is used, it supports either an input or outputs or both.</span></span> <span data-ttu-id="5dce5-128">Le code personnalisé que vous écrivez traite les lignes et les colonnes d'entrée et de sortie.</span><span class="sxs-lookup"><span data-stu-id="5dce5-128">The custom code that you will write processes the input and output rows and columns.</span></span>

### <a name="inputs-columns-page-of-the-script-transformation-editor"></a><span data-ttu-id="5dce5-129">Page Colonnes d'entrée de l'Éditeur de transformation de script</span><span class="sxs-lookup"><span data-stu-id="5dce5-129">Inputs Columns Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="5dce5-130">La page **Colonnes d’entrée** de l’**Éditeur de transformation de script** s’affiche pour les transformations et les destinations, mais pas pour les sources.</span><span class="sxs-lookup"><span data-stu-id="5dce5-130">The **Input Columns** page of the **Script Transformation Editor** is displayed for transformations and destinations, but not for sources.</span></span> <span data-ttu-id="5dce5-131">Cette page vous permet de sélectionner les colonnes d'entrée disponibles à mettre à la disposition de votre script personnalisé et spécifier les accès en lecture seule ou en lecture/écriture à ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="5dce5-131">On this page, you select the available input columns that you want to make available to your custom script, and specify read-only or read/write access to them.</span></span>

 <span data-ttu-id="5dce5-132">Dans le projet de code qui doit être généré en fonction de ces métadonnées, l'élément de projet BufferWrapper contient une classe pour chaque entrée, et cette classe contient des propriétés d'accesseur typées pour chaque colonne d'entrée sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="5dce5-132">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input, and this class contains typed accessor properties for each input column selected.</span></span> <span data-ttu-id="5dce5-133">Par exemple, si vous sélectionnez une colonne **CustomerID** entière et une colonne **CustomerName** de type chaîne dans une entrée nommée `CustomerInput` , l’élément de projet BufferWrapper contient une `CustomerInput` classe qui dérive de <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , et la `CustomerInput` classe expose une propriété de type entier nommée **CustomerID** et une propriété de type chaîne nommée **CustomerName**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-133">For example, if you select an integer **CustomerID** column and a string **CustomerName** column from an input named `CustomerInput`, the BufferWrapper project item will contain a `CustomerInput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerInput` class will expose an integer property named **CustomerID** and a string property named **CustomerName**.</span></span> <span data-ttu-id="5dce5-134">Cette convention permet d'écrire du code avec la vérification de type tel que ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="5dce5-134">This convention makes it possible to write code with type-checking like the following:</span></span>

```vb
Dim currentCustomerID as Integer = CustomerInput.CustomerID
Dim currentCustomerName as String = CustomerInput.CustomerName
```

 <span data-ttu-id="5dce5-135">Pour plus d’informations sur la configuration des colonnes d’entrée d’un type de composant de flux de données spécifique, consultez l’exemple approprié sous [Développement de types spécifiques de composants Script](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-135">For more information about how to configure input columns for a specific type of data flow component, see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

### <a name="inputs-and-outputs-page-of-the-script-transformation-editor"></a><span data-ttu-id="5dce5-136">Page Entrées et sorties de l'Éditeur de transformation de script</span><span class="sxs-lookup"><span data-stu-id="5dce5-136">Inputs and Outputs Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="5dce5-137">La page **Entrées et sorties** de l’**Éditeur de transformation de script** s’affiche pour les sources, les transformations et les destinations.</span><span class="sxs-lookup"><span data-stu-id="5dce5-137">The **Input and Outputs** page of the **Script Transformation Editor** is displayed for sources, transformations, and destinations.</span></span> <span data-ttu-id="5dce5-138">Cette page vous permet d'ajouter, supprimer et configurer des entrées, des sorties et des colonnes de sortie à utiliser dans votre script personnalisé, en tenant compte des contraintes suivantes :</span><span class="sxs-lookup"><span data-stu-id="5dce5-138">On this page, you add, remove, and configure inputs, outputs, and output columns that you want to use in your custom script, within the following limitations:</span></span>

-   <span data-ttu-id="5dce5-139">Lorsqu'il est utilisé en tant que source, le composant Script ne possède pas d'entrée et prend en charge plusieurs sorties.</span><span class="sxs-lookup"><span data-stu-id="5dce5-139">When used as a source, the Script component has no input and supports multiple outputs.</span></span>

-   <span data-ttu-id="5dce5-140">Lorsqu'il est utilisé en tant que transformation, le composant Script prend en charge une entrée et plusieurs sorties.</span><span class="sxs-lookup"><span data-stu-id="5dce5-140">When used as a transformation, the Script component supports one input and multiple outputs.</span></span>

-   <span data-ttu-id="5dce5-141">Lorsqu'il est utilisé en tant que destination, le composant Script prend en charge une entrée et ne possède pas de sortie.</span><span class="sxs-lookup"><span data-stu-id="5dce5-141">When used as a destination, the Script component supports one input and has no outputs.</span></span>

 <span data-ttu-id="5dce5-142">Dans le projet de code qui doit être généré en fonction de ces métadonnées, l'élément de projet BufferWrapper contient une classe pour chaque entrée et chaque sortie.</span><span class="sxs-lookup"><span data-stu-id="5dce5-142">In the code project that will be generated based on this metadata, the BufferWrapper project item contains a class for each input and output.</span></span> <span data-ttu-id="5dce5-143">Par exemple, si vous créez une sortie nommée `CustomerOutput` , l’élément de projet BufferWrapper contient une `CustomerOutput` classe qui dérive de <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer> , et la `CustomerOutput` classe contient des propriétés d’accesseur typées pour chaque colonne de sortie créée.</span><span class="sxs-lookup"><span data-stu-id="5dce5-143">For example, if you create an output named `CustomerOutput`, the BufferWrapper project item will contain a `CustomerOutput` class that derives from <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptBuffer>, and the `CustomerOutput` class will contain typed accessor properties for each output column created.</span></span>

 <span data-ttu-id="5dce5-144">La page **Entrée et sorties** vous permet de configurer uniquement des colonnes de sortie.</span><span class="sxs-lookup"><span data-stu-id="5dce5-144">You can configure output columns only on the **Input and Outputs** page.</span></span> <span data-ttu-id="5dce5-145">Vous pouvez sélectionner des colonnes d’entrée pour les transformations et les destinations dans la page **Colonnes d’entrée**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-145">You can select input columns for transformations and destinations on the **Input Columns** page.</span></span> <span data-ttu-id="5dce5-146">Les propriétés d'accesseur typées créées dans l'élément de projet BufferWrapper sont en écriture seule pour les colonnes de sortie.</span><span class="sxs-lookup"><span data-stu-id="5dce5-146">The typed accessor properties created for you in the BufferWrapper project item will be write-only for output columns.</span></span> <span data-ttu-id="5dce5-147">Les propriétés d’accesseur des colonnes d’entrée peuvent être en lecture seule ou en lecture/écriture selon le type d’utilisation sélectionné pour chaque colonne dans la page **Colonnes d’entrée**.</span><span class="sxs-lookup"><span data-stu-id="5dce5-147">The accessor properties for input columns will be read-only or read/write depending on the usage type that you have selected for each column on the **Input Columns** page.</span></span>

 <span data-ttu-id="5dce5-148">Pour plus d’informations sur la configuration des entrées et des sorties d’un type de composant de flux de données spécifique, consultez l’exemple approprié sous [Développement de types spécifiques de composants Script](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-148">For more information about configuring inputs and outputs for a specific type of data flow component see the appropriate example under [Developing Specific Types of Script Components](../../extending-packages-scripting-data-flow-script-component-types/developing-specific-types-of-script-components.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="5dce5-149">Bien qu'il soit impossible de configurer directement une sortie en tant que sortie d'erreur dans le composant Script pour la gestion automatique des lignes d'erreur, vous pouvez reproduire les fonctionnalités d'une sortie d'erreur en créant une sortie supplémentaire et en utilisant un script pour diriger des lignes vers cette sortie, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-149">Although you cannot directly configure an output as an error output in the Script component for automatic handling of error rows, you can reproduce the functionality of an error output by creating an additional output and using script to direct rows to this output when appropriate.</span></span> <span data-ttu-id="5dce5-150">Pour plus d’informations, consultez [Simulation d’une sortie d’erreur pour le composant Script](../../data-flow/transformations/script-component.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-150">For more information, see [Simulating an Error Output for the Script Component](../../data-flow/transformations/script-component.md).</span></span>

#### <a name="exclusiongroup-and-synchronousinputid-properties-of-outputs"></a><span data-ttu-id="5dce5-151">Propriétés ExclusionGroup et SynchronousInputID des sorties</span><span class="sxs-lookup"><span data-stu-id="5dce5-151">ExclusionGroup and SynchronousInputID Properties of Outputs</span></span>
 <span data-ttu-id="5dce5-152">La propriété `ExclusionGroup` a une valeur non nulle uniquement dans les transformations à sorties synchrones, dans lesquelles votre code effectue des opérations de filtrage ou de création de branche et dirige chaque ligne vers l'une des sorties qui partagent la même valeur `ExclusionGroup` non nulle.</span><span class="sxs-lookup"><span data-stu-id="5dce5-152">The `ExclusionGroup` property has a non-zero value only in transformations with synchronous outputs, where your code performs filtering or branching and directs each row to one of the outputs that share the same non-zero `ExclusionGroup` value.</span></span> <span data-ttu-id="5dce5-153">Par exemple, la transformation peut diriger des lignes vers la sortie par défaut ou vers une sortie d'erreur.</span><span class="sxs-lookup"><span data-stu-id="5dce5-153">For example, the transformation can direct rows either to the default output or to an error output.</span></span> <span data-ttu-id="5dce5-154">Lorsque vous créez des sorties supplémentaires dans ce scénario, veillez à affecter à la propriété `SynchronousInputID` la valeur de type entier correspondant à l'`ID` de l'entrée du composant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-154">When you create additional outputs for this scenario, make sure to set the value of the `SynchronousInputID` property to the integer that matches the `ID` of the component's input.</span></span>

 <span data-ttu-id="5dce5-155">La propriété `SynchronousInputID` a une valeur non nulle uniquement dans les transformations à sorties synchrones.</span><span class="sxs-lookup"><span data-stu-id="5dce5-155">The `SynchronousInputID` property has a non-zero value only in transformations with synchronous outputs.</span></span> <span data-ttu-id="5dce5-156">Si la valeur de cette propriété est zéro, cela signifie que la sortie est asynchrone.</span><span class="sxs-lookup"><span data-stu-id="5dce5-156">If the value of this property is zero, it means that the output is asynchronous.</span></span> <span data-ttu-id="5dce5-157">Pour une sortie synchrone, où les lignes sont transférées aux sorties sélectionnées sans que de nouvelles lignes ne soient ajoutées, cette propriété doit contenir l'`ID` de l'entrée du composant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-157">For a synchronous output, where rows are passed through to the selected output or outputs without adding any new rows, this property should contain the `ID` of the component's input.</span></span>

> [!NOTE]
>  <span data-ttu-id="5dce5-158">Lorsque l' **éditeur de transformation de script** crée la première sortie, l’éditeur définit la `SynchronousInputID` propriété de la sortie sur le `ID` de l’entrée du composant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-158">When the **Script Transformation Editor** creates the first output, the editor sets the `SynchronousInputID` property of the output to the `ID` of the component's input.</span></span> <span data-ttu-id="5dce5-159">Toutefois, lorsque l'éditeur crée les sorties suivantes, il attribue la valeur zéro aux propriétés `SynchronousInputID` de ces sorties.</span><span class="sxs-lookup"><span data-stu-id="5dce5-159">However, when the editor creates subsequent outputs, the editor sets the `SynchronousInputID` properties of those outputs to zero.</span></span>
> 
>  <span data-ttu-id="5dce5-160">Si vous créez un composant avec des sorties synchrones, la propriété de chaque sortie doit être `SynchronousInputID` définie sur l `ID` 'de l’entrée du composant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-160">If you are creating a component with synchronous outputs, each output must have its `SynchronousInputID` property set to the `ID` of the component's input.</span></span> <span data-ttu-id="5dce5-161">Par conséquent, la valeur zéro de la propriété `SynchronousInputID` de chaque sortie créée par l'éditeur après la première sortie doit être remplacée par l'`ID` de l'entrée du composant.</span><span class="sxs-lookup"><span data-stu-id="5dce5-161">Therefore, each output that the editor creates after the first output must have its `SynchronousInputID` value changed from zero to the `ID` of the component's input.</span></span>
> 
>  <span data-ttu-id="5dce5-162">Si vous créez un composant à sorties asynchrones, la propriété `SynchronousInputID` de chaque sortie doit avoir la valeur zéro.</span><span class="sxs-lookup"><span data-stu-id="5dce5-162">If you are creating a component with asynchronous outputs, each output must have its `SynchronousInputID` property set to zero.</span></span> <span data-ttu-id="5dce5-163">Par conséquent, la valeur de la première sortie doit être `SynchronousInputID` modifiée de la valeur `ID` de l’entrée du composant à zéro.</span><span class="sxs-lookup"><span data-stu-id="5dce5-163">Therefore, the first output must have its `SynchronousInputID` value changed from the `ID` of the component's input to zero.</span></span>

 <span data-ttu-id="5dce5-164">Pour obtenir un exemple de direction de lignes vers l’une des deux sorties synchrones dans le composant Script, consultez [Création d’une transformation synchrone à l’aide du composant Script](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-164">For an example of directing rows to one of two synchronous outputs in the Script component, see [Creating a Synchronous Transformation with the Script Component](../../extending-packages-scripting-data-flow-script-component-types/creating-a-synchronous-transformation-with-the-script-component.md).</span></span>

### <a name="object-names-in-generated-script"></a><span data-ttu-id="5dce5-165">Noms d'objets dans le script généré</span><span class="sxs-lookup"><span data-stu-id="5dce5-165">Object Names in Generated Script</span></span>
 <span data-ttu-id="5dce5-166">Le composant Script analyse les noms des entrées et des sorties, ainsi que les noms des colonnes dans les entrées et sorties. Puis, en fonction de ces noms, il génère des classes et des propriétés dans l'élément de projet BufferWrapper.</span><span class="sxs-lookup"><span data-stu-id="5dce5-166">The Script component parses the names of inputs and outputs, and parse the names of columns in the inputs and outputs, and based on these names generates classes and properties in the BufferWrapper project item.</span></span> <span data-ttu-id="5dce5-167">Si les noms trouvés contiennent des caractères qui n'appartiennent pas aux catégories Unicode `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter` ou `DecimalDigitLetter`, les caractères non valides sont supprimés des noms générés.</span><span class="sxs-lookup"><span data-stu-id="5dce5-167">If the found names include characters that do not belong to the Unicode categories `UppercaseLetter`, `LowercaseLetter`, `TitlecaseLetter`, `ModifierLetter`, `OtherLetter`, or `DecimalDigitLetter`, the invalid characters are dropped in the generated names.</span></span> <span data-ttu-id="5dce5-168">Par exemple, les espaces étant supprimés, deux colonnes d’entrée nommées **FirstName** et [**First Name**] sont interprétées comme une seule colonne nommée **FirstName**, ce qui peut entraîner des résultats imprévisibles.</span><span class="sxs-lookup"><span data-stu-id="5dce5-168">For example, spaces are dropped, therefore two input columns that have the names **FirstName** and [**First Name**] are both interpreted as having the column name **FirstName**, with unpredictable results.</span></span> <span data-ttu-id="5dce5-169">Pour éviter cette situation, les noms des entrées et des sorties, ainsi que des colonnes d'entrée et de sortie, utilisés par le composant Script doivent comporter uniquement des caractères appartenant aux catégories Unicode répertoriées dans cette section.</span><span class="sxs-lookup"><span data-stu-id="5dce5-169">To avoid this situation, the names of inputs and outputs and of input and output columns used by the Script component should contain only characters in the Unicode categories listed in this section.</span></span>

### <a name="script-page-of-the-script-transformation-editor"></a><span data-ttu-id="5dce5-170">Page Script de l'Éditeur de transformation de script</span><span class="sxs-lookup"><span data-stu-id="5dce5-170">Script Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="5dce5-171">La page **Script** de l’**Éditeur de tâche de script** vous permet d’assigner un nom unique et une description à la tâche de script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-171">On the **Script** page of the **Script Task Editor**, you assign a unique name and a description for the Script task.</span></span> <span data-ttu-id="5dce5-172">Vous pouvez également assigner des valeurs pour les propriétés suivantes.</span><span class="sxs-lookup"><span data-stu-id="5dce5-172">You can also assign values for the following properties.</span></span>

> [!NOTE]
>  <span data-ttu-id="5dce5-173">Dans [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] et les versions ultérieures, tous les scripts sont précompilés.</span><span class="sxs-lookup"><span data-stu-id="5dce5-173">In [!INCLUDE[ssISversion10](../../../includes/ssisversion10-md.md)] and later versions, all scripts are precompiled.</span></span> <span data-ttu-id="5dce5-174">Les versions antérieures vous permettaient de spécifier si les scripts étaient précompilés en définissant une propriété `Precompile` pour la tâche.</span><span class="sxs-lookup"><span data-stu-id="5dce5-174">In previous versions, you specified whether scripts were precompiled by setting a `Precompile` property for the task.</span></span>

#### <a name="validateexternalmetadata-property"></a><span data-ttu-id="5dce5-175">Propriété ValidateExternalMetadata</span><span class="sxs-lookup"><span data-stu-id="5dce5-175">ValidateExternalMetadata Property</span></span>
 <span data-ttu-id="5dce5-176">La valeur booléenne de la propriété `ValidateExternalMetadata` spécifie si le composant doit procéder à une validation par rapport à des sources de données externes au moment de la conception, ou s'il doit reporter la validation jusqu'à moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="5dce5-176">The Boolean value of the `ValidateExternalMetadata` property specifies whether the component should perform validation against external data sources at design time, or whether it should postpone validation until run time.</span></span> <span data-ttu-id="5dce5-177">Par défaut, cette propriété a la valeur `True` ; c'est à dire que les métadonnées externes sont validées au moment de la conception et au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="5dce5-177">By default, the value of this property is `True`; that is, the external metadata is validated both at design time and at run time.</span></span> <span data-ttu-id="5dce5-178">Vous pouvez attribuer à cette propriété la valeur `False` lorsqu'une source de données externe n'est pas disponible au moment de la conception : par exemple, lorsque le package télécharge la source ou crée la destination uniquement au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="5dce5-178">You may want to set the value of this property to `False` when an external data source is not available at design time: for example, when the package downloads the source or creates the destination only at run time.</span></span>

#### <a name="readonlyvariables-and-readwritevariables-properties"></a><span data-ttu-id="5dce5-179">Propriétés ReadOnlyVariables et ReadWriteVariables</span><span class="sxs-lookup"><span data-stu-id="5dce5-179">ReadOnlyVariables and ReadWriteVariables Properties</span></span>
 <span data-ttu-id="5dce5-180">Vous pouvez entrer des listes délimitées par des virgules de variables existantes comme valeurs de ces propriétés pour rendre les variables accessibles en lecture seule ou en lecture/écriture dans le code du composant Script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-180">You can enter comma-delimited lists of existing variables as the values of these properties to make the variables available for read-only or read/write access within the Script component code.</span></span> <span data-ttu-id="5dce5-181">Les variables sont accessibles dans le code par le biais des propriétés <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> et <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> de la classe de base générée automatiquement.</span><span class="sxs-lookup"><span data-stu-id="5dce5-181">Variables are accessed in code through the <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadOnlyVariables%2A> and <xref:Microsoft.SqlServer.Dts.Pipeline.ScriptComponent.ReadWriteVariables%2A> properties of the autogenerated base class.</span></span> <span data-ttu-id="5dce5-182">Pour plus d’informations, consultez [Utilisation de variables dans le composant Script](using-variables-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-182">For more information, see [Using Variables in the Script Component](using-variables-in-the-script-component.md).</span></span>

> [!NOTE]
>  <span data-ttu-id="5dce5-183">Les noms de variable respectent la casse.</span><span class="sxs-lookup"><span data-stu-id="5dce5-183">Variable names are case-sensitive.</span></span>

#### <a name="scriptlanguage"></a><span data-ttu-id="5dce5-184">ScriptLanguage</span><span class="sxs-lookup"><span data-stu-id="5dce5-184">ScriptLanguage</span></span>
 <span data-ttu-id="5dce5-185">Vous pouvez sélectionner [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic ou [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# comme langage de programmation du composant Script.</span><span class="sxs-lookup"><span data-stu-id="5dce5-185">You can select either [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual Basic or [!INCLUDE[msCoName](../../../includes/msconame-md.md)] Visual C# as the programming language for the Script component.</span></span>

#### <a name="edit-script-button"></a><span data-ttu-id="5dce5-186">Bouton Modifier le script</span><span class="sxs-lookup"><span data-stu-id="5dce5-186">Edit Script Button</span></span>
 <span data-ttu-id="5dce5-187">Le bouton **Modifier le script** permet d’ouvrir l’environnement de développement intégré [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) dans lequel vous écrivez votre script personnalisé.</span><span class="sxs-lookup"><span data-stu-id="5dce5-187">The **Edit Script** button opens the [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] Tools for Applications (VSTA) IDE in which you write your custom script.</span></span> <span data-ttu-id="5dce5-188">Pour plus d’informations, consultez [Codage et débogage du composant Script](coding-and-debugging-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-188">For more information, see [Coding and Debugging the Script Component](coding-and-debugging-the-script-component.md).</span></span>

### <a name="connection-managers-page-of-the-script-transformation-editor"></a><span data-ttu-id="5dce5-189">Page Gestionnaires de connexions de l'Éditeur de transformation de script</span><span class="sxs-lookup"><span data-stu-id="5dce5-189">Connection Managers Page of the Script Transformation Editor</span></span>
 <span data-ttu-id="5dce5-190">La page **Gestionnaires de connexions** de l’**Éditeur de transformation de script** vous permet d’ajouter et de supprimer des gestionnaires de connexions que vous souhaitez utiliser dans votre script personnalisé.</span><span class="sxs-lookup"><span data-stu-id="5dce5-190">On the **Connection Managers** page of the **Script Transformation Editor**, you add and remove connection managers that you want to use in your custom script.</span></span> <span data-ttu-id="5dce5-191">En principe, vous devez référencer des gestionnaires de connexions lorsque vous créez un composant source ou un composant de destination.</span><span class="sxs-lookup"><span data-stu-id="5dce5-191">Normally you need to reference connection managers when you create a source or destination component.</span></span>

 <span data-ttu-id="5dce5-192">Dans le projet de code qui doit être généré selon ces métadonnées, l'élément de projet `ComponentWrapper` contient une classe de collection `Connections` qui possède une propriété d'accesseur typée pour chaque gestionnaire de connexions sélectionné.</span><span class="sxs-lookup"><span data-stu-id="5dce5-192">In the code project that will be generated based on this metadata, the `ComponentWrapper` project item contains a `Connections` collection class that has a typed accessor property for each selected connection manager.</span></span> <span data-ttu-id="5dce5-193">Chaque propriété d'accesseur typée porte le même nom que le gestionnaire de connexions lui-même et retourne une référence à ce dernier sous la forme d'une instance de <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span><span class="sxs-lookup"><span data-stu-id="5dce5-193">Each typed accessor property has the same name as the connection manager itself and returns a reference to the connection manager as an instance of <xref:Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100>.</span></span> <span data-ttu-id="5dce5-194">Par exemple, si vous avez ajouté un gestionnaire de connexions nommé `MyADONETConnection` dans la page **Gestionnaires de connexions** de l’éditeur, vous pouvez obtenir une référence au gestionnaire de connexions dans votre script à l’aide du code suivant :</span><span class="sxs-lookup"><span data-stu-id="5dce5-194">For example, if you have added a connection manager named `MyADONETConnection` on the **Connection Managers** page of the editor, you can obtain a reference to the connection manager in your script by using the following code:</span></span>

```vb
Dim myADONETConnectionManager As IDTSConnectionManager100 = _
    Me.Connections.MyADONETConnection
```

 <span data-ttu-id="5dce5-195">Pour plus d’informations, consultez [Connexion aux sources de données dans le composant Script](connecting-to-data-sources-in-the-script-component.md).</span><span class="sxs-lookup"><span data-stu-id="5dce5-195">For more information, see [Connecting to Data Sources in the Script Component](connecting-to-data-sources-in-the-script-component.md).</span></span>

<span data-ttu-id="5dce5-196">![Icône de Integration Services (petite)](../../media/dts-16.gif "Icône Integration Services (petite)")  **restez à jour avec Integration Services**</span><span class="sxs-lookup"><span data-stu-id="5dce5-196">![Integration Services icon (small)](../../media/dts-16.gif "Integration Services icon (small)")  **Stay Up to Date with Integration Services**</span></span><br /> <span data-ttu-id="5dce5-197">Pour obtenir les derniers téléchargements, articles, exemples et vidéos de Microsoft, ainsi que des solutions sélectionnées par la communauté, visitez la page [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] sur MSDN :</span><span class="sxs-lookup"><span data-stu-id="5dce5-197">For the latest downloads, articles, samples, and videos from Microsoft, as well as selected solutions from the community, visit the [!INCLUDE[ssISnoversion](../../../includes/ssisnoversion-md.md)] page on MSDN:</span></span><br /><br /> [<span data-ttu-id="5dce5-198">Visiter la page Integration Services sur MSDN</span><span class="sxs-lookup"><span data-stu-id="5dce5-198">Visit the Integration Services page on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=136655)<br /><br /> <span data-ttu-id="5dce5-199">Pour recevoir une notification automatique de ces mises à jour, abonnez-vous aux flux RSS disponibles sur la page.</span><span class="sxs-lookup"><span data-stu-id="5dce5-199">For automatic notification of these updates, subscribe to the RSS feeds available on the page.</span></span>

## <a name="see-also"></a><span data-ttu-id="5dce5-200">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5dce5-200">See Also</span></span>
 [<span data-ttu-id="5dce5-201">Codage et débogage du composant Script</span><span class="sxs-lookup"><span data-stu-id="5dce5-201">Coding and Debugging the Script Component</span></span>](coding-and-debugging-the-script-component.md)


