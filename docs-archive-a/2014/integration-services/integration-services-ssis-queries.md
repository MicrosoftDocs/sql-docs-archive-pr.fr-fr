---
title: Requêtes Integration Services (SSIS) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- Query Builder [Integration Services]
- queries [Integration Services]
- statements [Integration Services]
- queries [Integration Services], about queries in packages
ms.assetid: 8822bd29-4575-46c8-92a0-1a39bc2604c1
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5119ff27606ce4e43f65cc129f3caac764e78e0b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605610"
---
# <a name="integration-services-ssis-queries"></a><span data-ttu-id="1fa8d-102">Requêtes Integration Services (SSIS)</span><span class="sxs-lookup"><span data-stu-id="1fa8d-102">Integration Services (SSIS) Queries</span></span>
  <span data-ttu-id="1fa8d-103">La tâche Exécution SQL, la source OLE DB, la destination OLE DB et la transformation de recherche peuvent utiliser des requêtes SQL.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-103">The Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation can use SQL queries.</span></span> <span data-ttu-id="1fa8d-104">Dans la tâche d'exécution SQL, les instructions SQL peuvent créer, mettre à jour et supprimer des données et des objets de base de données, exécuter des procédures stockées et des instructions SELECT.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-104">In the Execute SQL task, the SQL statements can create, update, and delete database objects and data; run stored procedures; and perform SELECT statements.</span></span> <span data-ttu-id="1fa8d-105">Dans la source OLE DB et la transformation de recherche, les instructions SQL sont généralement des instructions SELECT ou EXEC.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-105">In the OLE DB source and the Lookup transformation, the SQL statements are typically SELECT statements or EXEC statements.</span></span> <span data-ttu-id="1fa8d-106">Cette dernière exécute le plus souvent des procédures stockées qui retournent des jeux de résultats.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-106">The latter most frequently run stored procedures that return result sets.</span></span>  
  
 <span data-ttu-id="1fa8d-107">Un requête peut être analysée pour déterminer si elle est valide.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-107">A query can be parsed to establish whether it is valid.</span></span> <span data-ttu-id="1fa8d-108">Pendant l’analyse d’une requête utilisant une connexion vers [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], la requête est analysée, exécutée et le résultat de l’exécution (succès ou échec) est affecté au résultat de l’analyse.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-108">When parsing a query that uses a connection to [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the query is parsed, executed, and the execution outcome (success or failure) is assigned to the parsing outcome.</span></span> <span data-ttu-id="1fa8d-109">Si la requête utilise une connexion à des données qui ne sont pas [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], l'instruction est seulement analysée.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-109">If the query uses a connection to a data other than [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], the statement is parsed only.</span></span>  
  
 <span data-ttu-id="1fa8d-110">L'instruction SQL peut être définie soit en l'entrant directement dans le concepteur, soit en spécifiant une connexion de fichier ou une variable qui contient l'instruction.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-110">The SQL statement can be defined either by entering it directly in the designer, or by specifying a file connection or a variable that contains the statement.</span></span>  
  
## <a name="direct-input-sql"></a><span data-ttu-id="1fa8d-111">SQL à entrée directe</span><span class="sxs-lookup"><span data-stu-id="1fa8d-111">Direct Input SQL</span></span>  
 <span data-ttu-id="1fa8d-112">Le Générateur de requêtes est disponible dans l'interface utilisateur pour la tâche d'exécution SQL, la source OLE DB, la destination OLE DB et la transformation de recherche.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-112">Query Builder is available in the user interface for the Execute SQL task, the OLE DB source, the OLE DB destination, and the Lookup transformation.</span></span> <span data-ttu-id="1fa8d-113">Le générateur de requêtes présente les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="1fa8d-113">Query Builder offers the following advantages:</span></span>  
  
-   <span data-ttu-id="1fa8d-114">Travailler visuellement ou avec des commandes SQL.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-114">Work visually or with SQL commands.</span></span>  
  
     <span data-ttu-id="1fa8d-115">Le Générateur de requêtes comprend des volets graphiques qui composent visuellement votre requête et un volet de texte qui contient le texte SQL de votre requête.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-115">Query Builder includes graphical panes that compose your query visually and a text pane that displays the SQL text of your query.</span></span> <span data-ttu-id="1fa8d-116">Vous pouvez travailler dans le volet graphique ou le volet de texte.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-116">You can work in either the graphical or text panes.</span></span> <span data-ttu-id="1fa8d-117">Le Générateur de requêtes synchronise les vues afin de toujours faire correspondre le texte de la requête et la représentation graphique.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-117">Query Builder synchronizes the views so that the query text and graphical representation always match.</span></span>  
  
-   <span data-ttu-id="1fa8d-118">Joindre des tables liées.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-118">Join related tables.</span></span>  
  
     <span data-ttu-id="1fa8d-119">Si vous ajoutez plusieurs tables à votre requête, le générateur de requêtes détermine automatiquement la manière dont les tables sont associées entre elles et construit la commande de jointure appropriée.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-119">If you add more than one table to your query, Query Builder automatically determines how the tables are related and constructs the appropriate join command.</span></span>  
  
-   <span data-ttu-id="1fa8d-120">Interroger ou mettre à jour les bases de données.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-120">Query or update databases.</span></span>  
  
     <span data-ttu-id="1fa8d-121">Vous pouvez utiliser le générateur de requêtes pour renvoyer des données à l'aide d'instructions Transact-SQL SELECT, ou pour créer des requêtes qui mettent à jour, ajoutent ou suppriment des enregistrements dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-121">You can use Query Builder to return data using Transact-SQL SELECT statements, or to create queries that update, add, or delete records in a database.</span></span>  
  
-   <span data-ttu-id="1fa8d-122">Afficher et modifier les résultats immédiatement.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-122">View and edit results immediately.</span></span>  
  
     <span data-ttu-id="1fa8d-123">Vous pouvez exécuter votre requête et travailler avec un jeu d'enregistrements dans une grille qui vous permet de faire défiler et de modifier les enregistrements de la base de données.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-123">You can execute your query and work with a recordset in a grid that lets you scroll through and edit records in the database.</span></span>  
  
 <span data-ttu-id="1fa8d-124">Bien que le générateur de requêtes soit limité visuellement à la création de requêtes SELECT, vous pouvez tapez le SQL pour d'autres types d'instructions, par exemple des instructions DELETE et UPDATE, dans le volet de texte.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-124">Although Query Builder is visually limited to creating SELECT queries, you can type the SQL for other types of statements such as DELETE and UPDATE statements in the text pane.</span></span> <span data-ttu-id="1fa8d-125">Le volet graphique est automatiquement mis à jour pour prendre en compte l'instruction SQL que vous avez tapée.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-125">The graphical pane is automatically updated to reflect the SQL statement that you typed.</span></span>  
  
 <span data-ttu-id="1fa8d-126">Vous pouvez également fournir une entrée directe en tapant la requête dans la boîte de dialogue de la tâche ou du composant de flux de données ou dans la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-126">You can also provide direct input by typing the query in the task or data flow component dialog box or the Properties window.</span></span>  
  
 <span data-ttu-id="1fa8d-127">Pour plus d’informations, consultez [Générateur de requêtes](../../2014/integration-services/query-builder.md).</span><span class="sxs-lookup"><span data-stu-id="1fa8d-127">For more information, see [Query Builder](../../2014/integration-services/query-builder.md).</span></span>  
  
## <a name="sql-in-files"></a><span data-ttu-id="1fa8d-128">SQL dans des fichiers</span><span class="sxs-lookup"><span data-stu-id="1fa8d-128">SQL in Files</span></span>  
 <span data-ttu-id="1fa8d-129">L'instruction SQL pour la tâche d'exécution SQL peut également se trouver dans un fichier distinct.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-129">The SQL statement for the Execute SQL task can also reside in a separate file.</span></span> <span data-ttu-id="1fa8d-130">Par exemple, vous pouvez écrire des requêtes à l'aide d'outils tels que l'éditeur de requêtes dans [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], enregistrer la requête dans un fichier, puis lire la requête à partir du fichier lors de l'exécution d'un package.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-130">For example, you can write queries using tools such as the Query Editor in [!INCLUDE[ssManStudioFull](../includes/ssmanstudiofull-md.md)], save the query to a file, and then read the query from the file when running a package.</span></span> <span data-ttu-id="1fa8d-131">Le fichier ne peut contenir que les instructions SQL à exécuter et des commentaires.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-131">The file can contain only the SQL statements to run and comments.</span></span> <span data-ttu-id="1fa8d-132">Pour utiliser une instruction SQL stockée dans un fichier, vous devez fournir une connexion de fichiers qui spécifie le nom et l'emplacement du fichier.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-132">To use a SQL statement stored in a file, you must provide a file connection that specifies the file name and location.</span></span> <span data-ttu-id="1fa8d-133">Pour plus d’informations, consultez [File Connection Manager](connection-manager/file-connection-manager.md).</span><span class="sxs-lookup"><span data-stu-id="1fa8d-133">For more information, see [File Connection Manager](connection-manager/file-connection-manager.md).</span></span>  
  
## <a name="sql-in-variables"></a><span data-ttu-id="1fa8d-134">SQL dans des variables</span><span class="sxs-lookup"><span data-stu-id="1fa8d-134">SQL in Variables</span></span>  
 <span data-ttu-id="1fa8d-135">Si la source de l'instruction SQL dans la tâche d'exécution SQL est une variable, vous fournissez le nom de la variable qui contient la requête.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-135">If the source of the SQL statement in the Execute SQL task is a variable, you provide the name of the variable that contains the query.</span></span> <span data-ttu-id="1fa8d-136">La propriété Value de la variable contient le texte de la requête.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-136">The Value property of the variable contains the query text.</span></span> <span data-ttu-id="1fa8d-137">Vous définissez la propriété ValueType de la variable en tant que type de données String, puis vous tapez ou copiez l’instruction SQL dans la propriété Value.</span><span class="sxs-lookup"><span data-stu-id="1fa8d-137">You set the ValueType property of the variable to a string data type and then type or copy the SQL statement into the Value property.</span></span> <span data-ttu-id="1fa8d-138">Pour plus d’informations, consultez [Variables Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) et [Utiliser des variables dans des packages](../../2014/integration-services/use-variables-in-packages.md).</span><span class="sxs-lookup"><span data-stu-id="1fa8d-138">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [Use Variables in Packages](../../2014/integration-services/use-variables-in-packages.md).</span></span>  
  
  
