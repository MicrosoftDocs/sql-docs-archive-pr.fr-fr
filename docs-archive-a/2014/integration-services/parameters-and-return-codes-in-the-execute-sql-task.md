---
title: Paramètres et codes de retour dans la tâche d’exécution SQL | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- return codes [Integration Services]
- parameters [Integration Services]
- parameterized SQL statements [Integration Services]
- Execute SQL task [Integration Services]
ms.assetid: a3ca65e8-65cf-4272-9a81-765a706b8663
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cdc32e103642e086e81f6499bf56e5fbb71c3bd1
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613536"
---
# <a name="parameters-and-return-codes-in-the-execute-sql-task"></a><span data-ttu-id="f8153-102">Paramètres et codes de retour dans la tâche d'exécution SQL</span><span class="sxs-lookup"><span data-stu-id="f8153-102">Parameters and Return Codes in the Execute SQL Task</span></span>
  <span data-ttu-id="f8153-103">Les instructions SQL et les procédures stockées utilisent fréquemment des paramètres de types `input`, `output` et des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="f8153-103">SQL statements and stored procedures frequently use `input` parameters, `output` parameters, and return codes.</span></span> <span data-ttu-id="f8153-104">Dans [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], la tâche d'exécution SQL prend en charge les types de paramètres `Input`, `Output` et `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="f8153-104">In [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], the Execute SQL task supports the `Input`, `Output`, and `ReturnValue` parameter types.</span></span> <span data-ttu-id="f8153-105">Vous utilisez le type `Input` pour les paramètres d'entrée, `Output` pour les paramètres de sortie et `ReturnValue` pour les codes de retour.</span><span class="sxs-lookup"><span data-stu-id="f8153-105">You use the `Input` type for input parameters, `Output` for output parameters, and `ReturnValue` for return codes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f8153-106">Vous ne pouvez utiliser des paramètres dans une tâche d'exécution SQL que si le fournisseur de données les prend en charge.</span><span class="sxs-lookup"><span data-stu-id="f8153-106">You can use parameters in an Execute SQL task only if the data provider supports them.</span></span>  
  
 <span data-ttu-id="f8153-107">Les paramètres des commandes SQL, notamment les requêtes et les procédures stockées, sont mappés à des variables définies par l'utilisateur créées dans l'étendue de la tâche d'exécution SQL, un conteneur parent ou dans l'étendue du package.</span><span class="sxs-lookup"><span data-stu-id="f8153-107">Parameters in SQL commands, including queries and stored procedures, are mapped to user-defined variables that are created within the scope of the Execute SQL task, a parent container, or within the scope of the package.</span></span> <span data-ttu-id="f8153-108">Les variables peuvent être définies au moment de la conception ou être remplies dynamiquement lors de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="f8153-108">The values of variables can be set at design time or populated dynamically at run time.</span></span> <span data-ttu-id="f8153-109">Vous pouvez également mapper des paramètres à des variables système.</span><span class="sxs-lookup"><span data-stu-id="f8153-109">You can also map parameters to system variables.</span></span> <span data-ttu-id="f8153-110">Pour plus d’informations, consultez [Variables Integration Services &#40;SSIS&#41;](integration-services-ssis-variables.md) et [Variables système](system-variables.md).</span><span class="sxs-lookup"><span data-stu-id="f8153-110">For more information, see [Integration Services &#40;SSIS&#41; Variables](integration-services-ssis-variables.md) and [System Variables](system-variables.md).</span></span>  
  
 <span data-ttu-id="f8153-111">Toutefois, l'utilisation de paramètres et de codes de retour dans une tâche d'exécution SQL ne permet pas uniquement de savoir quels types de paramètres sont pris en charge par la tâche et de quelle manière ces paramètres seront mappés.</span><span class="sxs-lookup"><span data-stu-id="f8153-111">However, working with parameters and return codes in an Execute SQL task is more than just knowing what parameter types the task supports and how these parameters will be mapped.</span></span> <span data-ttu-id="f8153-112">D'autres indications et spécifications d'utilisation permettent d'utiliser avec succès des paramètres et des codes de retour dans la tâche d'exécution SQL.</span><span class="sxs-lookup"><span data-stu-id="f8153-112">There are additional usage requirements and guidelines to successfully use parameters and return codes in the Execute SQL task.</span></span> <span data-ttu-id="f8153-113">Le reste de cette rubrique traite de ces indications et spécifications d'utilisation.</span><span class="sxs-lookup"><span data-stu-id="f8153-113">The remainder of this topic covers these usage requirements and guidelines:</span></span>  
  
-   [<span data-ttu-id="f8153-114">Utiliser des marqueurs et des noms de paramètres</span><span class="sxs-lookup"><span data-stu-id="f8153-114">Using parameters names and markers</span></span>](#Parameter_names_and_markers)  
  
-   [<span data-ttu-id="f8153-115">Utiliser des paramètres avec les types de données de date et d’heure</span><span class="sxs-lookup"><span data-stu-id="f8153-115">Using parameters with date and time data types</span></span>](#Date_and_time_data_types)  
  
-   [<span data-ttu-id="f8153-116">Utiliser des paramètres dans les clauses WHERE</span><span class="sxs-lookup"><span data-stu-id="f8153-116">Using parameters in WHERE clauses</span></span>](#WHERE_clauses)  
  
-   [<span data-ttu-id="f8153-117">Utiliser des paramètres avec les procédures stockées</span><span class="sxs-lookup"><span data-stu-id="f8153-117">Using parameters with stored procedures</span></span>](#Stored_procedures)  
  
-   [<span data-ttu-id="f8153-118">Obtenir les valeurs de codes de retour</span><span class="sxs-lookup"><span data-stu-id="f8153-118">Getting values of return codes</span></span>](#Return_codes)  
  
-   [<span data-ttu-id="f8153-119">Configuration de paramètres et de codes de retour dans l'éditeur de tâche d'exécution SQL</span><span class="sxs-lookup"><span data-stu-id="f8153-119">Configuring parameters and return codes in the Execute SQL Task Editor</span></span>](#Configure_parameters_and_return_codes)  
  
##  <a name="using-parameter-names-and-markers"></a><a name="Parameter_names_and_markers"></a><span data-ttu-id="f8153-120">Utilisation des marqueurs et des noms de paramètres</span><span class="sxs-lookup"><span data-stu-id="f8153-120">Using Parameter Names and Markers</span></span>  
 <span data-ttu-id="f8153-121">Selon le type de connexion que la tâche d'exécution SQL utilise, la syntaxe de la commande SQL utilise différents marqueurs de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-121">Depending on the connection type that the Execute SQL task uses, the syntax of the SQL command uses different parameter markers.</span></span> <span data-ttu-id="f8153-122">Par exemple, le type de gestionnaire de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] impose que la commande SQL utilise un marqueur de paramètre au format **\@varParameter**, tandis que le type de connexion OLE DB exige le marqueur de paramètre point d’interrogation (?).</span><span class="sxs-lookup"><span data-stu-id="f8153-122">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type requires that the SQL command uses a parameter marker in the format **\@varParameter**, whereas OLE DB connection type requires the question mark (?) parameter marker.</span></span>  
  
 <span data-ttu-id="f8153-123">Les noms que vous pouvez utiliser comme noms de paramètres dans les mappages entre variables et paramètres varient également selon le type de gestionnaire de connexions.</span><span class="sxs-lookup"><span data-stu-id="f8153-123">The names that you can use as parameter names in the mappings between variables and parameters also vary by connection manager type.</span></span> <span data-ttu-id="f8153-124">Par exemple, le type de gestionnaire de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] utilise un nom défini par l'utilisateur avec le préfixe \@, tandis que le type de gestionnaire de connexions OLE DB impose l'utilisation de la valeur numérique d'un ordinal de base 0 comme nom de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f8153-124">For example, the [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager type uses a user-defined name with a \@ prefix, whereas the OLE DB connection manager type requires that you use the numeric value of a 0-based ordinal as the parameter name.</span></span>  
  
 <span data-ttu-id="f8153-125">Le tableau suivant indique les conditions requises des commandes SQL pour les types de gestionnaires de connexions que la tâche d'exécution SQL peut utiliser.</span><span class="sxs-lookup"><span data-stu-id="f8153-125">The following table summarizes the requirements for SQL commands for the connection manager types that the Execute SQL task can use.</span></span>  
  
|<span data-ttu-id="f8153-126">Type de connexion</span><span class="sxs-lookup"><span data-stu-id="f8153-126">Connection type</span></span>|<span data-ttu-id="f8153-127">Marqueur de paramètre</span><span class="sxs-lookup"><span data-stu-id="f8153-127">Parameter marker</span></span>|<span data-ttu-id="f8153-128">Nom du paramètre</span><span class="sxs-lookup"><span data-stu-id="f8153-128">Parameter name</span></span>|<span data-ttu-id="f8153-129">Exemple de commande SQL</span><span class="sxs-lookup"><span data-stu-id="f8153-129">Example SQL command</span></span>|  
|---------------------|----------------------|--------------------|-------------------------|  
|<span data-ttu-id="f8153-130">ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-130">ADO</span></span>|<span data-ttu-id="f8153-131">?</span><span class="sxs-lookup"><span data-stu-id="f8153-131">?</span></span>|<span data-ttu-id="f8153-132">Param1, Param2, ...</span><span class="sxs-lookup"><span data-stu-id="f8153-132">Param1, Param2, ...</span></span>|<span data-ttu-id="f8153-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="f8153-133">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|\@\<parameter name>|\@\<parameter name>|<span data-ttu-id="f8153-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span><span class="sxs-lookup"><span data-stu-id="f8153-134">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = \@parmContactID</span></span>|  
|<span data-ttu-id="f8153-135">ODBC</span><span class="sxs-lookup"><span data-stu-id="f8153-135">ODBC</span></span>|<span data-ttu-id="f8153-136">?</span><span class="sxs-lookup"><span data-stu-id="f8153-136">?</span></span>|<span data-ttu-id="f8153-137">1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="f8153-137">1, 2, 3, ...</span></span>|<span data-ttu-id="f8153-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="f8153-138">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
|<span data-ttu-id="f8153-139">EXCEL et OLE DB</span><span class="sxs-lookup"><span data-stu-id="f8153-139">EXCEL and OLE DB</span></span>|<span data-ttu-id="f8153-140">?</span><span class="sxs-lookup"><span data-stu-id="f8153-140">?</span></span>|<span data-ttu-id="f8153-141">0, 1, 2, 3, ...</span><span class="sxs-lookup"><span data-stu-id="f8153-141">0, 1, 2, 3, ...</span></span>|<span data-ttu-id="f8153-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span><span class="sxs-lookup"><span data-stu-id="f8153-142">SELECT FirstName, LastName, Title FROM Person.Contact WHERE ContactID = ?</span></span>|  
  
### <a name="using-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="f8153-143">Utilisation de paramètres avec les gestionnaires de connexions ADO.NET et ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-143">Using Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="f8153-144">Les gestionnaires de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] et ADO ont des spécifications particulières pour les commandes SQL qui utilisent des paramètres :</span><span class="sxs-lookup"><span data-stu-id="f8153-144">[!INCLUDE[vstecado](../includes/vstecado-md.md)] and ADO connection managers have specific requirements for SQL commands that use parameters:</span></span>  
  
-   <span data-ttu-id="f8153-145">Les gestionnaires de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] exigent que la commande SQL utilise des noms de paramètres comme marqueurs de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-145">[!INCLUDE[vstecado](../includes/vstecado-md.md)] connection managers require that the SQL command use parameter names as parameter markers.</span></span> <span data-ttu-id="f8153-146">Cela signifie que des variables peuvent être mappées directement à des paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-146">This means that variables can be mapped directly to parameters.</span></span> <span data-ttu-id="f8153-147">Par exemple, la variable `@varName` est mappée au paramètre nommé `@parName` et fournit une valeur au paramètre `@parName`.</span><span class="sxs-lookup"><span data-stu-id="f8153-147">For example, the variable `@varName` is mapped to the parameter named `@parName` and provides a value to the parameter `@parName`.</span></span>  
  
-   <span data-ttu-id="f8153-148">Les gestionnaires de connexions ADO.NET imposent que la commande SQL utilise des points d'interrogation (?) comme marqueurs de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-148">ADO connection managers require that the SQL command use question marks (?) as parameter markers.</span></span> <span data-ttu-id="f8153-149">Toutefois, vous pouvez utiliser les noms définis par l'utilisateur, à l'exception des valeurs entières, comme noms de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-149">However, you can use any user-defined name, except for integer values, as parameter names.</span></span>  
  
 <span data-ttu-id="f8153-150">Pour fournir des valeurs aux paramètres, les variables sont mappées à des noms de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-150">To provide values to parameters, variables are mapped to parameter names.</span></span> <span data-ttu-id="f8153-151">Puis, la tâche d'exécution SQL utilise la valeur ordinale du nom de paramètre dans la liste des paramètres pour charger des valeurs de variables dans des paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-151">Then, the Execute SQL task uses the ordinal value of the parameter name in the parameter list to load values from variables to parameters.</span></span>  
  
### <a name="using-parameters-with-excel-odbc-and-ole-db-connection-managers"></a><span data-ttu-id="f8153-152">Utilisation de paramètres avec les gestionnaires de connexions EXCEL, ODBC et OLE DB</span><span class="sxs-lookup"><span data-stu-id="f8153-152">Using Parameters with EXCEL, ODBC, and OLE DB Connection Managers</span></span>  
 <span data-ttu-id="f8153-153">Les gestionnaires de connexions EXCEL, ODBC et OLE DB imposent que la commande SQL utilise des points d'interrogation (?) comme marqueurs de paramètres et des valeurs numériques de base 0 et de base 1 comme noms de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-153">EXCEL, ODBC, and OLE DB connection managers require that the SQL command use question marks (?) as parameter markers and 0-based or 1-based numeric values as parameter names.</span></span> <span data-ttu-id="f8153-154">Si la tâche d'exécution SQL utilise le gestionnaire de connexions ODBC, le nom de paramètre qui mappe au premier paramètre dans la requête est nommé 1 ; sinon, le paramètre est nommé 0.</span><span class="sxs-lookup"><span data-stu-id="f8153-154">If the Execute SQL task uses the ODBC connection manager, the parameter name that maps to the first parameter in the query is named 1; otherwise, the parameter is named 0.</span></span> <span data-ttu-id="f8153-155">Pour les paramètres suivants, la valeur numérique du nom de paramètre indique le paramètre dans la commande SQL à laquelle le nom de paramètre mappe.</span><span class="sxs-lookup"><span data-stu-id="f8153-155">For subsequent parameters, the numeric value of the parameter name indicates the parameter in the SQL command that the parameter name maps to.</span></span> <span data-ttu-id="f8153-156">Par exemple, le paramètre nommé 3 est mappé au troisième paramètre, qui est représenté par le troisième point d'interrogation (?) dans la commande SQL.</span><span class="sxs-lookup"><span data-stu-id="f8153-156">For example, the parameter named 3 maps to the third parameter, which is represented by the third question mark (?) in the SQL command.</span></span>  
  
 <span data-ttu-id="f8153-157">Pour fournir des valeurs aux paramètres, les variables sont mappées à des noms de paramètres et la tâche d'exécution SQL utilise la valeur ordinale du nom du paramètre pour charger des valeurs de variables dans des paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-157">To provide values to parameters, variables are mapped to parameter names and the Execute SQL task uses the ordinal value of the parameter name to load values from variables to parameters.</span></span>  
  
 <span data-ttu-id="f8153-158">Selon le fournisseur que le gestionnaire de connexions utilise, certains types de données OLE DB peuvent ne pas être pris en charge.</span><span class="sxs-lookup"><span data-stu-id="f8153-158">Depending on the provider that the connection manager uses, some OLE DB data types may not be supported.</span></span> <span data-ttu-id="f8153-159">Par exemple, le pilote Excel ne reconnaît qu'un ensemble limité de types de données.</span><span class="sxs-lookup"><span data-stu-id="f8153-159">For example, the Excel driver recognizes only a limited set of data types.</span></span> <span data-ttu-id="f8153-160">Pour plus d’informations sur le comportement du fournisseur Jet avec le pilote Excel, consultez [Source Excel](data-flow/excel-source.md).</span><span class="sxs-lookup"><span data-stu-id="f8153-160">For more information about the behavior of the Jet provider with the Excel driver, see [Excel Source](data-flow/excel-source.md).</span></span>  
  
#### <a name="using-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="f8153-161">Utilisation de paramètres avec les gestionnaires de connexions OLE DB</span><span class="sxs-lookup"><span data-stu-id="f8153-161">Using Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="f8153-162">Quand la tâche d’exécution SQL utilise le gestionnaire de connexions OLE DB, la propriété BypassPrepare de la tâche est disponible.</span><span class="sxs-lookup"><span data-stu-id="f8153-162">When the Execute SQL task uses the OLE DB connection manager, the BypassPrepare property of the task is available.</span></span> <span data-ttu-id="f8153-163">Vous devez définir cette propriété à `true` si la tâche d'exécution SQL utilise des instructions SQL avec des paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-163">You should set this property to `true` if the Execute SQL task uses SQL statements with parameters.</span></span>  
  
 <span data-ttu-id="f8153-164">Lorsque vous utilisez un gestionnaire de connexions OLE DB, vous ne pouvez pas utiliser de sous-requêtes paramétrables, car la tâche d'exécution SQL ne peut pas dériver d'informations de paramètre par le biais du fournisseur OLE DB.</span><span class="sxs-lookup"><span data-stu-id="f8153-164">When you use an OLE DB connection manager, you cannot use parameterized subqueries because the Execute SQL Task cannot derive parameter information through the OLE DB provider.</span></span> <span data-ttu-id="f8153-165">Toutefois, vous pouvez utiliser une expression pour concaténer les valeurs des paramètres dans la chaîne de requête et définir la propriété SqlStatementSource de la tâche.</span><span class="sxs-lookup"><span data-stu-id="f8153-165">However, you can use an expression to concatenate the parameter values into the query string and to set the SqlStatementSource property of the task.</span></span>  
  
##  <a name="using-parameters-with-date-and-time-data-types"></a><a name="Date_and_time_data_types"></a><span data-ttu-id="f8153-166">Utilisation de paramètres avec des types de données de date et d’heure</span><span class="sxs-lookup"><span data-stu-id="f8153-166">Using Parameters with Date and Time Data Types</span></span>  
  
### <a name="using-date-and-time-parameters-with-adonet-and-ado-connection-managers"></a><span data-ttu-id="f8153-167">Utilisation de paramètres de date et d'heure avec les gestionnaires de connexions ADO.NET et ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-167">Using Date and Time Parameters with ADO.NET and ADO Connection Managers</span></span>  
 <span data-ttu-id="f8153-168">Lors de la lecture des données des types [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `time` et `datetimeoffset`, une tâche d'exécution SQL qui utilise un gestionnaire de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] ou ADO a les spécifications supplémentaires suivantes :</span><span class="sxs-lookup"><span data-stu-id="f8153-168">When reading data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] types, `time` and `datetimeoffset`, an Execute SQL task that uses either an [!INCLUDE[vstecado](../includes/vstecado-md.md)] or ADO connection manager has the following additional requirements:</span></span>  
  
-   <span data-ttu-id="f8153-169">Pour les `time` données, un [!INCLUDE[vstecado](../includes/vstecado-md.md)] Gestionnaire de connexions requiert que ces données soient stockées dans un paramètre dont le type de paramètre est `Input` ou `Output` , et dont le type de données est `string` .</span><span class="sxs-lookup"><span data-stu-id="f8153-169">For `time` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `string`.</span></span>  
  
-   <span data-ttu-id="f8153-170">Pour les données `datetimeoffset`, un gestionnaire de connexions [!INCLUDE[vstecado](../includes/vstecado-md.md)] impose que ces données soient stockées dans l'un des paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="f8153-170">For `datetimeoffset` data, an [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection manager requires this data to be stored in one of the following parameters:</span></span>  
  
    -   <span data-ttu-id="f8153-171">Un paramètre de type `Input` et dont le type de données est `string`.</span><span class="sxs-lookup"><span data-stu-id="f8153-171">A parameter whose parameter type is `Input` and whose data type is `string`.</span></span>  
  
    -   <span data-ttu-id="f8153-172">Un paramètre de type `Output` ou `ReturnValue` et dont le type de données est `datetimeoffset`, `string` ou `datetime2`.</span><span class="sxs-lookup"><span data-stu-id="f8153-172">A parameter whose parameter type is `Output` or `ReturnValue`, and whose data type is `datetimeoffset`, `string`, or `datetime2`.</span></span> <span data-ttu-id="f8153-173">Si vous sélectionnez un paramètre dont le type de données est `string` ou `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] convertit les données en string ou datetime2.</span><span class="sxs-lookup"><span data-stu-id="f8153-173">If you select a parameter whose data type is either `string` or `datetime2`, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] converts the data to either string or datetime2.</span></span>  
  
-   <span data-ttu-id="f8153-174">Un gestionnaire de connexions ADO impose que les données `time` ou `datetimeoffset` soient stockées dans un paramètre de type `Input` ou `Output` et dont le type de données est `adVarWchar`.</span><span class="sxs-lookup"><span data-stu-id="f8153-174">An ADO connection manager requires that either `time` or `datetimeoffset` data be stored in a parameter whose parameter type is `Input` or `Output`, and whose data type is `adVarWchar`.</span></span>  
  
 <span data-ttu-id="f8153-175">Pour plus d’informations sur les types de données [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] et leur mappage aux types de données [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)], consultez [Types de données &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) et [Types de données d’Integration Services](data-flow/integration-services-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="f8153-175">For more information about [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types and how they map to [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) and [Integration Services Data Types](data-flow/integration-services-data-types.md).</span></span>  
  
### <a name="using-date-and-time-parameters-with-ole-db-connection-managers"></a><span data-ttu-id="f8153-176">Utilisation de paramètres de date et d'heure avec les gestionnaires de connexions OLE DB</span><span class="sxs-lookup"><span data-stu-id="f8153-176">Using Date and Time Parameters with OLE DB Connection Managers</span></span>  
 <span data-ttu-id="f8153-177">Lors de l'utilisation d'un gestionnaire de connexions OLE DB, une tâche d'exécution SQL a des spécifications de stockage particulières pour les données des types [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `date`, `time`, `datetime`, `datetime2` et `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="f8153-177">When using an OLE DB connection manager, an Execute SQL task has specific storage requirements for data of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, and `datetimeoffset`.</span></span> <span data-ttu-id="f8153-178">Vous devez stocker ces données dans l'un des types de paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="f8153-178">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="f8153-179">Un paramètre d'entrée doté du type de données NVARCHAR.</span><span class="sxs-lookup"><span data-stu-id="f8153-179">An input parameter of the NVARCHAR data type.</span></span>  
  
-   <span data-ttu-id="f8153-180">Un paramètre de sortie doté du type de données approprié, tel que répertorié dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="f8153-180">An output parameter of with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="f8153-181">Type de paramètre `Output`</span><span class="sxs-lookup"><span data-stu-id="f8153-181">`Output` parameter type</span></span>|<span data-ttu-id="f8153-182">Type de données Date</span><span class="sxs-lookup"><span data-stu-id="f8153-182">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="f8153-183">DBDATE</span><span class="sxs-lookup"><span data-stu-id="f8153-183">DBDATE</span></span>|`date`|  
    |<span data-ttu-id="f8153-184">DBTIME2</span><span class="sxs-lookup"><span data-stu-id="f8153-184">DBTIME2</span></span>|`time`|  
    |<span data-ttu-id="f8153-185">DBTIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="f8153-185">DBTIMESTAMP</span></span>|<span data-ttu-id="f8153-186">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="f8153-186">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="f8153-187">DBTIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="f8153-187">DBTIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="f8153-188">Si les données ne sont pas stockées dans le paramètre d'entrée ou de sortie approprié, le package échoue.</span><span class="sxs-lookup"><span data-stu-id="f8153-188">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
### <a name="using-date-and-time-parameters-with-odbc-connection-managers"></a><span data-ttu-id="f8153-189">Utilisation de paramètres de date et d'heure avec les gestionnaires de connexions ODBC</span><span class="sxs-lookup"><span data-stu-id="f8153-189">Using Date and Time Parameters with ODBC Connection Managers</span></span>  
 <span data-ttu-id="f8153-190">Lors de l'utilisation d'un gestionnaire de connexions ODBC, une tâche d'exécution SQL a des spécifications de stockage particulières pour les données de l'un des types [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)], `date`, `time`, `datetime`, `datetime2` ou `datetimeoffset`.</span><span class="sxs-lookup"><span data-stu-id="f8153-190">When using an ODBC connection manager, an Execute SQL task has specific storage requirements for data with one of the [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] data types, `date`, `time`, `datetime`, `datetime2`, or `datetimeoffset`.</span></span> <span data-ttu-id="f8153-191">Vous devez stocker ces données dans l'un des types de paramètres suivants :</span><span class="sxs-lookup"><span data-stu-id="f8153-191">You must store this data in one of the following parameter types:</span></span>  
  
-   <span data-ttu-id="f8153-192">Un paramètre de type `input` doté du type de données SQL_WVARCHAR</span><span class="sxs-lookup"><span data-stu-id="f8153-192">An `input` parameter of the SQL_WVARCHAR data type</span></span>  
  
-   <span data-ttu-id="f8153-193">Un paramètre de type `output` doté du type de données approprié, tel que répertorié dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="f8153-193">An `output` parameter with the appropriate data type, as listed in the following table.</span></span>  
  
    |<span data-ttu-id="f8153-194">Type de paramètre `Output`</span><span class="sxs-lookup"><span data-stu-id="f8153-194">`Output` parameter type</span></span>|<span data-ttu-id="f8153-195">Type de données Date</span><span class="sxs-lookup"><span data-stu-id="f8153-195">Date data type</span></span>|  
    |-------------------------------|--------------------|  
    |<span data-ttu-id="f8153-196">SQL_DATE</span><span class="sxs-lookup"><span data-stu-id="f8153-196">SQL_DATE</span></span>|`date`|  
    |<span data-ttu-id="f8153-197">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="f8153-197">SQL_SS_TIME2</span></span>|`time`|  
    |<span data-ttu-id="f8153-198">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="f8153-198">SQL_TYPE_TIMESTAMP</span></span><br /><br /> <span data-ttu-id="f8153-199">-ou-</span><span class="sxs-lookup"><span data-stu-id="f8153-199">-or-</span></span><br /><br /> <span data-ttu-id="f8153-200">SQL_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="f8153-200">SQL_TIMESTAMP</span></span>|<span data-ttu-id="f8153-201">`datetime`, `datetime2`</span><span class="sxs-lookup"><span data-stu-id="f8153-201">`datetime`, `datetime2`</span></span>|  
    |<span data-ttu-id="f8153-202">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="f8153-202">SQL_SS_TIMESTAMPOFFSET</span></span>|`datetimeoffset`|  
  
 <span data-ttu-id="f8153-203">Si les données ne sont pas stockées dans le paramètre d'entrée ou de sortie approprié, le package échoue.</span><span class="sxs-lookup"><span data-stu-id="f8153-203">If the data is not stored in the appropriate input or output parameter, the package fails.</span></span>  
  
##  <a name="using-parameters-in-where-clauses"></a><a name="WHERE_clauses"></a><span data-ttu-id="f8153-204">Utilisation de paramètres dans les clauses WHERE</span><span class="sxs-lookup"><span data-stu-id="f8153-204">Using Parameters in WHERE Clauses</span></span>  
 <span data-ttu-id="f8153-205">Les commandes SELECT, INSERT, UPDATE et DELETE incluent fréquemment des clauses WHERE pour spécifier des filtres qui définissent les conditions auxquelles chaque ligne des tables sources doit satisfaire pour se qualifier pour une commande SQL.</span><span class="sxs-lookup"><span data-stu-id="f8153-205">SELECT, INSERT, UPDATE, and DELETE commands frequently include WHERE clauses to specify filters that define the conditions each row in the source tables must meet to qualify for an SQL command.</span></span> <span data-ttu-id="f8153-206">Les paramètres fournissent les valeurs de filtre dans les clauses WHERE.</span><span class="sxs-lookup"><span data-stu-id="f8153-206">Parameters provide the filter values in the WHERE clauses.</span></span>  
  
 <span data-ttu-id="f8153-207">Vous pouvez utiliser des marqueurs de paramètres pour fournir dynamiquement des valeurs de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-207">You can use parameter markers to dynamically provide parameter values.</span></span> <span data-ttu-id="f8153-208">Les règles pour lesquelles des marqueurs de paramètres et des noms de paramètres peuvent être utilisés dans l'instruction SQL varient selon le type de gestionnaire de connexions que la tâche d'exécution SQL utilise.</span><span class="sxs-lookup"><span data-stu-id="f8153-208">The rules for which parameter markers and parameter names can be used in the SQL statement depend on the type of connection manager that the Execute SQL uses.</span></span>  
  
 <span data-ttu-id="f8153-209">Le tableau suivant présente des exemples de la commande SELECT par type de gestionnaire de connexions.</span><span class="sxs-lookup"><span data-stu-id="f8153-209">The following table lists examples of the SELECT command by connection manager type.</span></span> <span data-ttu-id="f8153-210">Les instructions INSERT, UPDATE et DELETE sont similaires.</span><span class="sxs-lookup"><span data-stu-id="f8153-210">The INSERT, UPDATE, and DELETE statements are similar.</span></span> <span data-ttu-id="f8153-211">Les exemples utilisent la commande SELECT pour retourner les produits de la table **Product** dans [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] qui ont un **ProductID** supérieur et inférieur aux valeurs spécifiées par deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-211">The examples use SELECT to return products from the **Product** table in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)] that have a **ProductID** greater than and less than the values specified by two parameters.</span></span>  
  
|<span data-ttu-id="f8153-212">Type de connexion</span><span class="sxs-lookup"><span data-stu-id="f8153-212">Connection type</span></span>|<span data-ttu-id="f8153-213">Syntaxe SELECT</span><span class="sxs-lookup"><span data-stu-id="f8153-213">SELECT syntax</span></span>|  
|---------------------|-------------------|  
|<span data-ttu-id="f8153-214">EXCEL, ODBC et OLEDB</span><span class="sxs-lookup"><span data-stu-id="f8153-214">EXCEL, ODBC, and OLEDB</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|<span data-ttu-id="f8153-215">ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-215">ADO</span></span>|`SELECT* FROM Production.Product WHERE ProductId > ? AND ProductID < ?`|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|`SELECT* FROM Production.Product WHERE ProductId > @parmMinProductID AND ProductID < @parmMaxProductID`|  
  
 <span data-ttu-id="f8153-216">Les exemples requièrent des paramètres avec les noms suivants :</span><span class="sxs-lookup"><span data-stu-id="f8153-216">The examples would require parameters that have the following names:</span></span>  
  
-   <span data-ttu-id="f8153-217">Les gestionnaires de connexions EXCEL et OLED DB utilisent les noms de paramètres 0 et 1.</span><span class="sxs-lookup"><span data-stu-id="f8153-217">The EXCEL and OLED DB connection managers use the parameter names 0 and 1.</span></span> <span data-ttu-id="f8153-218">Le type de connexion ODBC utilise 1 et 2.</span><span class="sxs-lookup"><span data-stu-id="f8153-218">The ODBC connection type uses 1 and 2.</span></span>  
  
-   <span data-ttu-id="f8153-219">Le type de connexion ADO peut utiliser deux noms de paramètres (par exemple, Param1 et Param2), mais les paramètres doivent être mappés selon leur position ordinale dans la liste des paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-219">The ADO connection type could use any two parameter names, such as Param1 and Param2, but the parameters must be mapped by their ordinal position in the parameter list.</span></span>  
  
-   <span data-ttu-id="f8153-220">Le type de connexion [!INCLUDE[vstecado](../includes/vstecado-md.md)] utilise les noms de paramètres \@parmMinProductID et \@parmMaxProductID.</span><span class="sxs-lookup"><span data-stu-id="f8153-220">The [!INCLUDE[vstecado](../includes/vstecado-md.md)] connection type uses the parameter names \@parmMinProductID and \@parmMaxProductID.</span></span>  
  
##  <a name="using-parameters-with-stored-procedures"></a><a name="Stored_procedures"></a><span data-ttu-id="f8153-221">Utilisation de paramètres avec des procédures stockées</span><span class="sxs-lookup"><span data-stu-id="f8153-221">Using Parameters with Stored Procedures</span></span>  
 <span data-ttu-id="f8153-222">Les commandes SQL qui exécutent des procédures stockées peuvent également utiliser le mappage de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-222">SQL commands that run stored procedures can also use parameter mapping.</span></span> <span data-ttu-id="f8153-223">Les règles d'utilisation des marqueurs de paramètres et des noms de paramètres varient selon le type de gestionnaire de connexions que la tâche d'exécution SQL utilise, tout comme les règles des requêtes paramétrables.</span><span class="sxs-lookup"><span data-stu-id="f8153-223">The rules for how to use parameter markers and parameter names depends on the type of connection manager that the Execute SQL uses, just like the rules for parameterized queries.</span></span>  
  
 <span data-ttu-id="f8153-224">Le tableau suivant présente des exemples de la commande EXEC par type de gestionnaire de connexions.</span><span class="sxs-lookup"><span data-stu-id="f8153-224">The following table lists examples of the EXEC command by connection manager type.</span></span> <span data-ttu-id="f8153-225">Les exemples exécutent la procédure stockée **uspGetBillOfMaterials** dans [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8153-225">The examples run the **uspGetBillOfMaterials** stored procedure in [!INCLUDE[ssSampleDBUserInputNonLocal](../includes/sssampledbuserinputnonlocal-md.md)].</span></span> <span data-ttu-id="f8153-226">La procédure stockée utilise `@StartProductID` les `@CheckDate` `input` paramètres et.</span><span class="sxs-lookup"><span data-stu-id="f8153-226">The stored procedure uses the `@StartProductID` and `@CheckDate` `input` parameters.</span></span>  
  
|<span data-ttu-id="f8153-227">Type de connexion</span><span class="sxs-lookup"><span data-stu-id="f8153-227">Connection type</span></span>|<span data-ttu-id="f8153-228">Syntaxe EXEC</span><span class="sxs-lookup"><span data-stu-id="f8153-228">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="f8153-229">EXCEL et OLEDB</span><span class="sxs-lookup"><span data-stu-id="f8153-229">EXCEL and OLEDB</span></span>|`EXEC uspGetBillOfMaterials ?, ?`|  
|<span data-ttu-id="f8153-230">ODBC</span><span class="sxs-lookup"><span data-stu-id="f8153-230">ODBC</span></span>|`{call uspGetBillOfMaterials(?, ?)}`<br /><br /> <span data-ttu-id="f8153-231">Pour plus d’informations sur la syntaxe d’appel ODBC, consultez la rubrique [Paramètres de procédure](https://go.microsoft.com/fwlink/?LinkId=89462)dans le Guide de référence du programmeur ODBC publié dans MSDN Library.</span><span class="sxs-lookup"><span data-stu-id="f8153-231">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="f8153-232">ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-232">ADO</span></span>|<span data-ttu-id="f8153-233">Si IsQueryStoredProcedure a la valeur `False` ,`EXEC uspGetBillOfMaterials ?, ?`</span><span class="sxs-lookup"><span data-stu-id="f8153-233">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials ?, ?`</span></span><br /><br /> <span data-ttu-id="f8153-234">Si IsQueryStoredProcedure a la valeur `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="f8153-234">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="f8153-235">Si IsQueryStoredProcedure a la valeur `False` ,`EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span><span class="sxs-lookup"><span data-stu-id="f8153-235">If IsQueryStoredProcedure is set to `False`, `EXEC uspGetBillOfMaterials @StartProductID, @CheckDate`</span></span><br /><br /> <span data-ttu-id="f8153-236">Si IsQueryStoredProcedure a la valeur `True` ,`uspGetBillOfMaterials`</span><span class="sxs-lookup"><span data-stu-id="f8153-236">If IsQueryStoredProcedure is set to `True`, `uspGetBillOfMaterials`</span></span>|  
  
 <span data-ttu-id="f8153-237">Pour utiliser des paramètres de sortie, la syntaxe impose que le mot clé OUTPUT suive chaque marqueur de paramètre.</span><span class="sxs-lookup"><span data-stu-id="f8153-237">To use output parameters, the syntax requires that the OUTPUT keyword follow each parameter marker.</span></span> <span data-ttu-id="f8153-238">Par exemple, la syntaxe de paramètre de sortie suivante est correcte : `EXEC myStoredProcedure ? OUTPUT`.</span><span class="sxs-lookup"><span data-stu-id="f8153-238">For example, the following output parameter syntax is correct: `EXEC myStoredProcedure ? OUTPUT`.</span></span>  
  
 <span data-ttu-id="f8153-239">Pour plus d’informations sur l’utilisation de paramètres d’entrée et de sortie avec des procédures stockées Transact-SQL, consultez [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f8153-239">For more information about using input and output parameters with Transact-SQL stored procedures, see [EXECUTE &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/execute-transact-sql).</span></span>  
  
##  <a name="getting-values-of-return-codes"></a><a name="Return_codes"></a><span data-ttu-id="f8153-240">Obtention de valeurs de codes de retour</span><span class="sxs-lookup"><span data-stu-id="f8153-240">Getting Values of Return Codes</span></span>  
 <span data-ttu-id="f8153-241">Une procédure stockée peut retourner une valeur entière appelée « code de retour » pour indiquer l'état d'exécution d'une procédure.</span><span class="sxs-lookup"><span data-stu-id="f8153-241">A stored procedure can return an integer value, called a return code, to indicate the execution status of a procedure.</span></span> <span data-ttu-id="f8153-242">Pour implémenter des codes de retour dans la tâche d'exécution SQL, vous utilisez des paramètres du type `ReturnValue`.</span><span class="sxs-lookup"><span data-stu-id="f8153-242">To implement return codes in the Execute SQL task, you use parameters of the `ReturnValue` type.</span></span>  
  
 <span data-ttu-id="f8153-243">Le tableau suivant présente par type de connexion des exemples de commandes EXEC qui implémentent des codes de retour.</span><span class="sxs-lookup"><span data-stu-id="f8153-243">The following table lists by connection type some examples of EXEC commands that implement return codes.</span></span> <span data-ttu-id="f8153-244">Tous les exemples utilisent un paramètre de type `input`.</span><span class="sxs-lookup"><span data-stu-id="f8153-244">All examples use an `input` parameter.</span></span> <span data-ttu-id="f8153-245">Les règles d’utilisation des marqueurs de paramètres et des noms de paramètres sont les mêmes pour tous les types de paramètres : `Input` , `Output` et `ReturnValue` .</span><span class="sxs-lookup"><span data-stu-id="f8153-245">The rules for how to use parameter markers and parameter names are the same for all parameter types-`Input`, `Output`, and `ReturnValue`.</span></span>  
  
 <span data-ttu-id="f8153-246">Certaines syntaxes ne prennent pas en charge les littéraux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="f8153-246">Some syntax does not support parameter literals.</span></span> <span data-ttu-id="f8153-247">Dans ce cas, vous devez fournir la valeur du paramètre en utilisant une variable.</span><span class="sxs-lookup"><span data-stu-id="f8153-247">In that case, you must provide the parameter value by using a variable.</span></span>  
  
|<span data-ttu-id="f8153-248">Type de connexion</span><span class="sxs-lookup"><span data-stu-id="f8153-248">Connection type</span></span>|<span data-ttu-id="f8153-249">Syntaxe EXEC</span><span class="sxs-lookup"><span data-stu-id="f8153-249">EXEC syntax</span></span>|  
|---------------------|-----------------|  
|<span data-ttu-id="f8153-250">EXCEL et OLEDB</span><span class="sxs-lookup"><span data-stu-id="f8153-250">EXCEL and OLEDB</span></span>|`EXEC ? = myStoredProcedure 1`|  
|<span data-ttu-id="f8153-251">ODBC</span><span class="sxs-lookup"><span data-stu-id="f8153-251">ODBC</span></span>|`{? = call myStoredProcedure(1)}`<br /><br /> <span data-ttu-id="f8153-252">Pour plus d’informations sur la syntaxe d’appel ODBC, consultez la rubrique [Paramètres de procédure](https://go.microsoft.com/fwlink/?LinkId=89462)dans le Guide de référence du programmeur ODBC publié dans MSDN Library.</span><span class="sxs-lookup"><span data-stu-id="f8153-252">For more information about ODBC call syntax, see the topic, [Procedure Parameters](https://go.microsoft.com/fwlink/?LinkId=89462), in the ODBC Programmer's Reference in the  MSDN Library.</span></span>|  
|<span data-ttu-id="f8153-253">ADO</span><span class="sxs-lookup"><span data-stu-id="f8153-253">ADO</span></span>|<span data-ttu-id="f8153-254">Si IsQueryStoreProcedure a la valeur `False` ,`EXEC ? = myStoredProcedure 1`</span><span class="sxs-lookup"><span data-stu-id="f8153-254">If IsQueryStoreProcedure is set to `False`, `EXEC ? = myStoredProcedure 1`</span></span><br /><br /> <span data-ttu-id="f8153-255">Si IsQueryStoreProcedure a la valeur `True` ,`myStoredProcedure`</span><span class="sxs-lookup"><span data-stu-id="f8153-255">If IsQueryStoreProcedure is set to `True`, `myStoredProcedure`</span></span>|  
|[!INCLUDE[vstecado](../includes/vstecado-md.md)]|<span data-ttu-id="f8153-256">Set IsQueryStoreProcedure a la valeur `True` .</span><span class="sxs-lookup"><span data-stu-id="f8153-256">Set IsQueryStoreProcedure is set to `True`.</span></span><br /><br /> `myStoredProcedure`|  
  
 <span data-ttu-id="f8153-257">Dans la syntaxe affichée dans la table précédente, la tâche d’exécution SQL utilise le type de source **Entrée directe** pour exécuter la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="f8153-257">In the syntax shown in the previous table, the Execute SQL task uses the **Direct Input** source type to run the stored procedure.</span></span> <span data-ttu-id="f8153-258">La tâche d’exécution SQL peut aussi utiliser le type de source **Connexion de fichiers** pour exécuter une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="f8153-258">The Execute SQL task can also use the **File Connection** source type to run a stored procedure.</span></span> <span data-ttu-id="f8153-259">Que la tâche d’exécution SQL utilise ou non le type de source de **connexion de fichiers** ou **d’entrée directe** , utilisez un paramètre du `ReturnValue` type pour implémenter le code de retour.</span><span class="sxs-lookup"><span data-stu-id="f8153-259">Regardless of whether the Execute SQL task uses the **Direct Input** or **File Connection** source type, use a parameter of the `ReturnValue` type to implement the return code.</span></span> <span data-ttu-id="f8153-260">Pour plus d’informations sur la configuration du type de source de l’instruction SQL exécutée par la tâche d’exécution SQL, consultez [Éditeur de tâche d’exécution de requêtes SQL &#40;page Général&#41;](general-page-of-integration-services-designers-options.md).</span><span class="sxs-lookup"><span data-stu-id="f8153-260">For more information about how to configure the source type of the SQL statement that the Execute SQL task runs, see [Execute SQL Task Editor &#40;General Page&#41;](general-page-of-integration-services-designers-options.md).</span></span>  
  
 <span data-ttu-id="f8153-261">Pour plus d’informations sur l’utilisation de codes de retour avec des procédures stockées Transact-SQL, consultez [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="f8153-261">For more information about using return codes with Transact-SQL stored procedures, see [RETURN &#40;Transact-SQL&#41;](/sql/t-sql/language-elements/return-transact-sql).</span></span>  
  
##  <a name="configuring-parameters-and-return-codes-in-the-execute-sql-task"></a><a name="Configure_parameters_and_return_codes"></a><span data-ttu-id="f8153-262">Configuration des paramètres et des codes de retour dans la tâche d’exécution SQL</span><span class="sxs-lookup"><span data-stu-id="f8153-262">Configuring Parameters and Return Codes in the Execute SQL Task</span></span>  
 <span data-ttu-id="f8153-263">Pour plus d’informations sur les propriétés de paramètres et de codes de retour que vous pouvez définir dans le concepteur [!INCLUDE[ssIS](../includes/ssis-md.md)] , cliquez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="f8153-263">For more information about the properties of parameters and return codes that you can set in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="f8153-264">Éditeur de tâche d’exécution de SQL &#40;page mappage de paramètre&#41;</span><span class="sxs-lookup"><span data-stu-id="f8153-264">Execute SQL Task Editor &#40;Parameter Mapping Page&#41;</span></span>](../../2014/integration-services/execute-sql-task-editor-parameter-mapping-page.md)  
  
 <span data-ttu-id="f8153-265">Pour plus d'informations sur la définition de ces propriétés dans le concepteur [!INCLUDE[ssIS](../includes/ssis-md.md)] , cliquez sur la rubrique suivante :</span><span class="sxs-lookup"><span data-stu-id="f8153-265">For more information about how to set these properties in [!INCLUDE[ssIS](../includes/ssis-md.md)] Designer, click the following topic:</span></span>  
  
-   [<span data-ttu-id="f8153-266">Définir les propriétés d'une tâche ou d'un conteneur</span><span class="sxs-lookup"><span data-stu-id="f8153-266">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="f8153-267">Tâches associées</span><span class="sxs-lookup"><span data-stu-id="f8153-267">Related Tasks</span></span>  
 [<span data-ttu-id="f8153-268">Définir les propriétés d'une tâche ou d'un conteneur</span><span class="sxs-lookup"><span data-stu-id="f8153-268">Set the Properties of a Task or Container</span></span>](../../2014/integration-services/set-the-properties-of-a-task-or-container.md)  
  
## <a name="related-content"></a><span data-ttu-id="f8153-269">Contenu associé</span><span class="sxs-lookup"><span data-stu-id="f8153-269">Related Content</span></span>  
  
-   <span data-ttu-id="f8153-270">Entrée de blog, [Procédures stockées avec paramètres de sortie](https://go.microsoft.com/fwlink/?LinkId=157786), sur blogs.msdn.com</span><span class="sxs-lookup"><span data-stu-id="f8153-270">Blog entry, [Stored procedures with output parameters](https://go.microsoft.com/fwlink/?LinkId=157786), on blogs.msdn.com</span></span>  
  
-   <span data-ttu-id="f8153-271">Exemple CodePlex, [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863)(en anglais), sur msftisprodsamples.codeplex.com</span><span class="sxs-lookup"><span data-stu-id="f8153-271">CodePlex sample, [Execute SQL Parameters and Result Sets](https://go.microsoft.com/fwlink/?LinkId=157863), on msftisprodsamples.codeplex.com</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8153-272">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f8153-272">See Also</span></span>  
 <span data-ttu-id="f8153-273">[Tâche d’exécution SQL](control-flow/execute-sql-task.md) </span><span class="sxs-lookup"><span data-stu-id="f8153-273">[Execute SQL Task](control-flow/execute-sql-task.md) </span></span>  
 [<span data-ttu-id="f8153-274">Ensembles de résultats dans la tâche d’exécution SQL</span><span class="sxs-lookup"><span data-stu-id="f8153-274">Result Sets in the Execute SQL Task</span></span>](../../2014/integration-services/result-sets-in-the-execute-sql-task.md)  
  
  
