---
title: Types de données dans les expressions (Générateur de rapports et SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 94fdf921-270c-4c12-87b3-46b1cc98fae5
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 86aa646865ecfe3da6ed1ad4bacb75907ab39472
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704932"
---
# <a name="data-types-in-expressions-report-builder-and-ssrs"></a><span data-ttu-id="817e5-102">Types de données dans les expressions (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="817e5-102">Data Types in Expressions (Report Builder and SSRS)</span></span>
  <span data-ttu-id="817e5-103">Les données sont représentées par différents types de données permettant de les stocker et de les traiter de manière efficace.</span><span class="sxs-lookup"><span data-stu-id="817e5-103">Data types represent different kinds of data so that it can be stored and processed efficiently.</span></span> <span data-ttu-id="817e5-104">Les types de données typiques incluent du texte (également appelé chaînes), des numéros avec et sans décimales, des dates, des heures et des images.</span><span class="sxs-lookup"><span data-stu-id="817e5-104">Typical data types include text (also known as strings), numbers with and without decimal places, dates and times, and images.</span></span> <span data-ttu-id="817e5-105">Les valeurs dans un rapport doivent être un type de données RDL (Report Definition Language).</span><span class="sxs-lookup"><span data-stu-id="817e5-105">Values in a report must be an Report Definition Language (RDL) data type.</span></span> <span data-ttu-id="817e5-106">Vous pouvez mettre en forme une valeur selon votre préférence lorsque vous l'affichez dans un rapport.</span><span class="sxs-lookup"><span data-stu-id="817e5-106">You can format a value according to your preference when you display it in a report.</span></span> <span data-ttu-id="817e5-107">Par exemple, un champ qui représente une devise est stocké dans la définition de rapport sous la forme d'un nombre à virgule flottante, mais peut être affiché sous divers formats en fonction de la propriété de format choisie.</span><span class="sxs-lookup"><span data-stu-id="817e5-107">For example, a field that represents currency is stored in the report definition as a floating point number, but can be displayed in a variety of formats depending on the format property you choose.</span></span>  
  
 <span data-ttu-id="817e5-108">Pour plus d’informations sur les formats d’affichage, consultez [Mise en forme des éléments de rapport &#40;Générateur de rapports et SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="817e5-108">For more information about display formats, see [Formatting Report Items &#40;Report Builder and SSRS&#41;](formatting-report-items-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-definition-language-rdl-data-types-and-common-language-runtime-clr-data-types"></a><span data-ttu-id="817e5-109">Types de données RDL (Report Definition Language) et CLR (Common Language Runtime)</span><span class="sxs-lookup"><span data-stu-id="817e5-109">Report Definition Language (RDL) Data Types and Common Language Runtime (CLR) Data Types</span></span>  
 <span data-ttu-id="817e5-110">Les valeurs spécifiées dans un fichier RDL doivent être un type de données RDL.</span><span class="sxs-lookup"><span data-stu-id="817e5-110">Values that are specified in an RDL file must be an RDL data type.</span></span> <span data-ttu-id="817e5-111">Lorsque le rapport est compilé et traité, les types de données RDL sont convertis en types de données CLR.</span><span class="sxs-lookup"><span data-stu-id="817e5-111">When the report is compiled and processed, RDL data types are converted to CLR data types.</span></span> <span data-ttu-id="817e5-112">Le tableau suivant affiche la conversion, marquée Valeur par défaut :</span><span class="sxs-lookup"><span data-stu-id="817e5-112">The following table displays the conversion, which is marked Default:</span></span>  
  
|<span data-ttu-id="817e5-113">Type RDL</span><span class="sxs-lookup"><span data-stu-id="817e5-113">RDL Type</span></span>|<span data-ttu-id="817e5-114">Types CLR</span><span class="sxs-lookup"><span data-stu-id="817e5-114">CLR Types</span></span>|  
|--------------|---------------|  
|<span data-ttu-id="817e5-115">String</span><span class="sxs-lookup"><span data-stu-id="817e5-115">String</span></span>|<span data-ttu-id="817e5-116">Valeur par défaut : String</span><span class="sxs-lookup"><span data-stu-id="817e5-116">Default: String</span></span><br /><br /> <span data-ttu-id="817e5-117">Chart, GUID, Timespan</span><span class="sxs-lookup"><span data-stu-id="817e5-117">Chart, GUID, Timespan</span></span>|  
|<span data-ttu-id="817e5-118">Boolean</span><span class="sxs-lookup"><span data-stu-id="817e5-118">Boolean</span></span>|<span data-ttu-id="817e5-119">Valeur par défaut : Boolean</span><span class="sxs-lookup"><span data-stu-id="817e5-119">Default: Boolean</span></span>|  
|<span data-ttu-id="817e5-120">Integer</span><span class="sxs-lookup"><span data-stu-id="817e5-120">Integer</span></span>|<span data-ttu-id="817e5-121">Valeur par défaut : Int64</span><span class="sxs-lookup"><span data-stu-id="817e5-121">Default: Int64</span></span><br /><br /> <span data-ttu-id="817e5-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span><span class="sxs-lookup"><span data-stu-id="817e5-122">Int16, Int32, Uint16, Uint64, Byte, Sbyte</span></span>|  
|<span data-ttu-id="817e5-123">DateTime</span><span class="sxs-lookup"><span data-stu-id="817e5-123">DateTime</span></span>|<span data-ttu-id="817e5-124">Valeur par défaut : DateTime</span><span class="sxs-lookup"><span data-stu-id="817e5-124">Default: DateTime</span></span><br /><br /> <span data-ttu-id="817e5-125">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="817e5-125">DateTimeOffset</span></span>|  
|<span data-ttu-id="817e5-126">Float</span><span class="sxs-lookup"><span data-stu-id="817e5-126">Float</span></span>|<span data-ttu-id="817e5-127">Valeur par défaut : Double</span><span class="sxs-lookup"><span data-stu-id="817e5-127">Default: Double</span></span><br /><br /> <span data-ttu-id="817e5-128">Single, Decimal</span><span class="sxs-lookup"><span data-stu-id="817e5-128">Single, Decimal</span></span>|  
|<span data-ttu-id="817e5-129">Binary</span><span class="sxs-lookup"><span data-stu-id="817e5-129">Binary</span></span>|<span data-ttu-id="817e5-130">Valeur par défaut : Byte[]</span><span class="sxs-lookup"><span data-stu-id="817e5-130">Default: Byte[]</span></span>|  
|<span data-ttu-id="817e5-131">Variant</span><span class="sxs-lookup"><span data-stu-id="817e5-131">Variant</span></span>|<span data-ttu-id="817e5-132">Une des valeurs ci-dessus à l'exception de Byte[]</span><span class="sxs-lookup"><span data-stu-id="817e5-132">Any of the above except Byte[]</span></span>|  
|<span data-ttu-id="817e5-133">VariantArray</span><span class="sxs-lookup"><span data-stu-id="817e5-133">VariantArray</span></span>|<span data-ttu-id="817e5-134">Tableau de type Variant</span><span class="sxs-lookup"><span data-stu-id="817e5-134">Array of Variant</span></span>|  
|<span data-ttu-id="817e5-135">Sérialisable</span><span class="sxs-lookup"><span data-stu-id="817e5-135">Serializable</span></span>|<span data-ttu-id="817e5-136">Variant ou types marqués avec Serializable ou qui implémentent ISerializable.</span><span class="sxs-lookup"><span data-stu-id="817e5-136">Variant or types marked with Serializable or that implement ISerializable.</span></span>|  
  
## <a name="understanding-data-types-and-writing-expressions"></a><span data-ttu-id="817e5-137">Fonctionnement des types de données et écriture des expressions</span><span class="sxs-lookup"><span data-stu-id="817e5-137">Understanding Data Types and Writing Expressions</span></span>  
 <span data-ttu-id="817e5-138">Il est important de maîtriser les types de données lorsque vous écrivez des expressions de comparaison ou de combinaison de valeurs, notamment lorsque vous définissez des expressions de groupe ou de filtre ou calculez des agrégats.</span><span class="sxs-lookup"><span data-stu-id="817e5-138">It is important to understand data types when you write expressions to compare or combine values, for example, when you define group or filter expressions, or calculate aggregates.</span></span> <span data-ttu-id="817e5-139">Les comparaisons et calculs sont uniquement valides entre éléments du même type de données.</span><span class="sxs-lookup"><span data-stu-id="817e5-139">Comparisons and calculations are valid only between items of the same data type.</span></span> <span data-ttu-id="817e5-140">Si les types de données ne concordent pas, vous devez convertir le type de données de manière explicite dans l'élément de rapport à l'aide d'une expression.</span><span class="sxs-lookup"><span data-stu-id="817e5-140">If the data types do not match, you must explicitly convert the data type in the report item by using an expression.</span></span>  
  
 <span data-ttu-id="817e5-141">La liste suivante décrit les circonstances dans lesquelles vous pouvez être amené à convertir des données dans un type différent :</span><span class="sxs-lookup"><span data-stu-id="817e5-141">The following list describes cases when you may need to convert data to a different data type:</span></span>  
  
-   <span data-ttu-id="817e5-142">Comparaison de la valeur d'un paramètre de rapport d'un type de données spécifique avec un champ de dataset d'un type de données différent.</span><span class="sxs-lookup"><span data-stu-id="817e5-142">Comparing the value of a report parameter of one data type to a dataset field of a different data type.</span></span>  
  
-   <span data-ttu-id="817e5-143">Écriture d'expressions de filtre qui comparent des valeurs de types de données différents.</span><span class="sxs-lookup"><span data-stu-id="817e5-143">Writing filter expressions that compare values of different data types.</span></span>  
  
-   <span data-ttu-id="817e5-144">Écriture d'expressions de tri qui associent des champs de types de données différents.</span><span class="sxs-lookup"><span data-stu-id="817e5-144">Writing sort expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="817e5-145">Écriture d'expressions de groupe qui associent des champs de types de données différents.</span><span class="sxs-lookup"><span data-stu-id="817e5-145">Writing group expressions that combine fields of different data types.</span></span>  
  
-   <span data-ttu-id="817e5-146">Conversion d'une valeur extraite d'une source de données d'un type de données à un autre.</span><span class="sxs-lookup"><span data-stu-id="817e5-146">Converting a value retrieved from the data source from one data type to a different data type.</span></span>  
  
## <a name="determining-the-data-type-of-report-data"></a><span data-ttu-id="817e5-147">Détermination du type de données d'un rapport</span><span class="sxs-lookup"><span data-stu-id="817e5-147">Determining the Data Type of Report Data</span></span>  
 <span data-ttu-id="817e5-148">Pour déterminer le type de données d'un élément de rapport, vous pouvez écrire une expression qui retourne son type de données.</span><span class="sxs-lookup"><span data-stu-id="817e5-148">To determine the data type of a report item, you can write an expression that returns its data type.</span></span> <span data-ttu-id="817e5-149">Par exemple, pour afficher le type de données du champ `MyField`, ajoutez l'expression suivante à une cellule de tableau : `=Fields!MyField.Value.GetType().ToString()`.</span><span class="sxs-lookup"><span data-stu-id="817e5-149">For example, to show the data type for the field `MyField`, add the following expression to a table cell: `=Fields!MyField.Value.GetType().ToString()`.</span></span> <span data-ttu-id="817e5-150">Le résultat affiche le type de données CLR utilisé pour représenter `MyField`, par exemple, `System.String` ou `System.DateTime`.</span><span class="sxs-lookup"><span data-stu-id="817e5-150">The result displays the CLR data type used to represent `MyField`, for example, `System.String` or `System.DateTime`.</span></span>  
  
## <a name="converting-dataset-fields-to-a-different-data-type"></a><span data-ttu-id="817e5-151">Conversion de champs de dataset en un type de données différent</span><span class="sxs-lookup"><span data-stu-id="817e5-151">Converting Dataset Fields to a Different Data Type</span></span>  
 <span data-ttu-id="817e5-152">Vous pouvez également convertir des champs de dataset avant de les utiliser dans un rapport.</span><span class="sxs-lookup"><span data-stu-id="817e5-152">You can also convert dataset fields before you use them in a report.</span></span> <span data-ttu-id="817e5-153">La liste suivante décrit les différentes méthodes de conversion d'un champ de dataset existant :</span><span class="sxs-lookup"><span data-stu-id="817e5-153">The following list describes ways that you can convert an existing dataset field:</span></span>  
  
-   <span data-ttu-id="817e5-154">Modifiez la requête de dataset pour ajouter un nouveau champ de requête avec les données converties.</span><span class="sxs-lookup"><span data-stu-id="817e5-154">Modify the dataset query to add a new query field with the converted data.</span></span> <span data-ttu-id="817e5-155">Pour les sources de données relationnelles ou multidimensionnelles, cette procédure utilise les ressources de la source de données pour effectuer la conversion.</span><span class="sxs-lookup"><span data-stu-id="817e5-155">For relational or multidimensional data sources, this uses data source resources to perform the conversion.</span></span>  
  
-   <span data-ttu-id="817e5-156">Créez un champ calculé à partir d'un champ de dataset du rapport existant en écrivant une expression qui convertit toutes les données d'une colonne d'ensemble de résultats en une nouvelle colonne utilisant un type de données différent.</span><span class="sxs-lookup"><span data-stu-id="817e5-156">Create a calculated field based on an existing report dataset field by writing an expression that converts all the data in one result set column to a new column with a different data type.</span></span> <span data-ttu-id="817e5-157">Par exemple, l'expression suivante convertit la valeur du champ Année de nombre entier en chaîne : `=CStr(Fields!Year.Value)`.</span><span class="sxs-lookup"><span data-stu-id="817e5-157">For example, the following expression converts the field Year from an integer value to a string value: `=CStr(Fields!Year.Value)`.</span></span> <span data-ttu-id="817e5-158">Pour plus d’informations, consultez [Ajouter, modifier ou actualiser des champs dans le volet des données de rapport &#40;Générateur de rapports et SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="817e5-158">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="817e5-159">Vérifiez si l'extension de traitement des données que vous utilisez inclut les métadonnées permettant d'extraire des données préformatées.</span><span class="sxs-lookup"><span data-stu-id="817e5-159">Check whether the data processing extension you are using includes metadata for retrieving preformatted data.</span></span> <span data-ttu-id="817e5-160">Par exemple, une requête MDX [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] inclut une propriété étendue FORMATTED_VALUE pour les valeurs de cube qui ont déjà été mises en forme pendant le traitement du cube.</span><span class="sxs-lookup"><span data-stu-id="817e5-160">For example, a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] MDX query includes a FORMATTED_VALUE extended property for cube values that have already been formatted when processing the cube.</span></span> <span data-ttu-id="817e5-161">Pour plus d’informations, consultez [Propriétés de champ étendues pour une base de données Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="817e5-161">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
## <a name="understanding-parameter-data-types"></a><span data-ttu-id="817e5-162">Présentation des types de données des paramètres</span><span class="sxs-lookup"><span data-stu-id="817e5-162">Understanding Parameter Data Types</span></span>  
 <span data-ttu-id="817e5-163">Les cinq types de données possibles pour les paramètres de rapport sont les suivants : Boolean, DateTime, Integer, Float ou Text (également appelé String).</span><span class="sxs-lookup"><span data-stu-id="817e5-163">Report parameters must be one of five data types: Boolean, DateTime, Integer, Float, or Text (also known as String).</span></span> <span data-ttu-id="817e5-164">Lorsqu'une requête de dataset comprend des paramètres de requête, des paramètres de rapport sont automatiquement créés et liés aux paramètres de requête.</span><span class="sxs-lookup"><span data-stu-id="817e5-164">When a dataset query includes query parameters, report parameters are automatically created and linked to the query parameters.</span></span> <span data-ttu-id="817e5-165">Le type de données par défaut d'un paramètre de rapport est String.</span><span class="sxs-lookup"><span data-stu-id="817e5-165">The default data type for a report parameter is String.</span></span> <span data-ttu-id="817e5-166">Pour modifier le type de données par défaut d’un paramètre de rapport, sélectionnez la valeur correcte dans la liste déroulante **Type de données** de la page **Général** de la boîte de dialogue **Propriétés du paramètre de rapport** .</span><span class="sxs-lookup"><span data-stu-id="817e5-166">To change the default data type of a report parameter, select the correct value from the **Data type** drop-down list on the **General** page of the **Report Parameter Properties** dialog box.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="817e5-167">Les paramètres de rapport utilisant le type de données DateTime ne prennent pas en charge les millisecondes.</span><span class="sxs-lookup"><span data-stu-id="817e5-167">Report parameters that are DateTime data types do not support milliseconds.</span></span> <span data-ttu-id="817e5-168">Même s'il est possible de créer un paramètre basé sur des valeurs incluant des millisecondes, vous ne pouvez pas sélectionner de valeur dans une liste déroulante de valeurs disponibles qui comprend des valeurs Date ou Time utilisant des millisecondes.</span><span class="sxs-lookup"><span data-stu-id="817e5-168">Although you can create a parameter based on values that include milliseconds, you cannot select a value from an available values drop-down list that includes Date or Time values that include milliseconds.</span></span>  
  
## <a name="writing-expressions-that-convert-data-types-or-extract-parts-of-data"></a><span data-ttu-id="817e5-169">Écriture d'expressions convertissant des types de données ou extrayant des données partielles</span><span class="sxs-lookup"><span data-stu-id="817e5-169">Writing Expressions that Convert Data Types or Extract Parts of Data</span></span>  
 <span data-ttu-id="817e5-170">Lorsque vous associez des champs de dataset et de texte à l'aide de l'opérateur de l'opérateur de concaténation (&), le common language runtime (CLR) fournit généralement des formats par défaut.</span><span class="sxs-lookup"><span data-stu-id="817e5-170">When you combine text and dataset fields using the concatenation operator (&), the common language runtime (CLR) generally provides default formats.</span></span> <span data-ttu-id="817e5-171">Lorsque vous devez convertir explicitement un champ de dataset ou un paramètre dans un type de données spécifique, vous devez utiliser une méthode CLR ou une fonction de bibliothèque Runtime Visual Basic pour convertir les données.</span><span class="sxs-lookup"><span data-stu-id="817e5-171">When you need to explicitly convert a dataset field or parameter to a specific data type, you must use a CLR method or a Visual Basic runtime library function to convert the data.</span></span>  
  
 <span data-ttu-id="817e5-172">Le tableau suivant présente des exemples de conversion de types de données.</span><span class="sxs-lookup"><span data-stu-id="817e5-172">The following table shows examples of converting data types.</span></span>  
  
|<span data-ttu-id="817e5-173">Type de conversion</span><span class="sxs-lookup"><span data-stu-id="817e5-173">Type of conversion</span></span>|<span data-ttu-id="817e5-174">Exemple</span><span class="sxs-lookup"><span data-stu-id="817e5-174">Example</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="817e5-175">DateTime en String</span><span class="sxs-lookup"><span data-stu-id="817e5-175">DateTime to String</span></span>|`=CStr(Fields!Date.Value)`|  
|<span data-ttu-id="817e5-176">String en DateTime</span><span class="sxs-lookup"><span data-stu-id="817e5-176">String to DateTime</span></span>|`=DateTime.Parse(Fields!DateTimeinStringFormat.Value)`|  
|<span data-ttu-id="817e5-177">String en DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="817e5-177">String to DateTimeOffset</span></span>|`=DateTimeOffset.Parse(Fields!DateTimeOffsetinStringFormat.Value)`|  
|<span data-ttu-id="817e5-178">Extraction de l'année</span><span class="sxs-lookup"><span data-stu-id="817e5-178">Extracting the Year</span></span>|`=Year(Fields!TimeinStringFormat.Value)`<br /><br /> `-- or --`<br /><br /> `=Year(Fields!TimeinDateTimeFormat.Value)`|  
|<span data-ttu-id="817e5-179">Boolean en Integer</span><span class="sxs-lookup"><span data-stu-id="817e5-179">Boolean to Integer</span></span>|`=CInt(Parameters!BooleanField.Value)`<br /><br /> <span data-ttu-id="817e5-180">-1 est True et 0 est False.</span><span class="sxs-lookup"><span data-stu-id="817e5-180">-1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="817e5-181">Boolean en Integer</span><span class="sxs-lookup"><span data-stu-id="817e5-181">Boolean to Integer</span></span>|`=System.Convert.ToInt32(Fields!BooleanFormat.Value)`<br /><br /> <span data-ttu-id="817e5-182">1 est True et 0 est False.</span><span class="sxs-lookup"><span data-stu-id="817e5-182">1 is True and 0 is False.</span></span>|  
|<span data-ttu-id="817e5-183">Uniquement la partie DateTime d'une valeur DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="817e5-183">Just the DateTime part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.DateTime`|  
|<span data-ttu-id="817e5-184">Uniquement la partie Offset d'une valeur DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="817e5-184">Just the Offset part of a DateTimeOffset value</span></span>|`=Fields!MyDatetimeOffset.Value.Offset`|  
  
 <span data-ttu-id="817e5-185">Vous pouvez également utiliser la fonction Format pour contrôler le format d'affichage de la valeur.</span><span class="sxs-lookup"><span data-stu-id="817e5-185">You can also use the Format function to control the display format for value.</span></span> <span data-ttu-id="817e5-186">Pour plus d’informations, consultez [Fonctions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span><span class="sxs-lookup"><span data-stu-id="817e5-186">For more information, see [Functions (Visual Basic)](https://go.microsoft.com/fwlink/?linkid=111483).</span></span>  
  
## <a name="advanced-examples"></a><span data-ttu-id="817e5-187">Exemples avancés</span><span class="sxs-lookup"><span data-stu-id="817e5-187">Advanced Examples</span></span>  
 <span data-ttu-id="817e5-188">Lorsque vous vous connectez à une source de données par le biais d'un fournisseur de données qui ne prend pas en charge la conversion de tous les types de données de la source, le type de données par défaut utilisé pour les types de source de données non pris en charge est Chaîne.</span><span class="sxs-lookup"><span data-stu-id="817e5-188">When you connect to a data source with a data provider that does not provide conversion support for all the data types on the data source, the default data type for unsupported data source types is String.</span></span> <span data-ttu-id="817e5-189">Les exemples suivants proposent des solutions pour les types de données spécifiques retournés en tant que chaîne.</span><span class="sxs-lookup"><span data-stu-id="817e5-189">The following examples provide solutions to specific data types that are returned as a string.</span></span>  
  
### <a name="concatenating-a-string-and-a-clr-datetimeoffset-data-type"></a><span data-ttu-id="817e5-190">Concaténation d'une chaîne en type de données CLR DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="817e5-190">Concatenating a String and a CLR DateTimeOffset Data Type</span></span>  
 <span data-ttu-id="817e5-191">Pour la plupart des types de données, le CLR assure des conversions par défaut vous permettant de concaténer des valeurs utilisant des types de données différents en une seule chaîne à l'aide de l'opérateur &.</span><span class="sxs-lookup"><span data-stu-id="817e5-191">For most data types, the CLR provides default conversions so that you can concatenate values that are different data types into one string by using the & operator.</span></span> <span data-ttu-id="817e5-192">Par exemple, l’expression suivante concatène le texte « Les date et heure sont : » avec un champ de dataset StartDate, qui est une valeur <xref:System.DateTime> : `="The date and time are: " & Fields!StartDate.Value`.</span><span class="sxs-lookup"><span data-stu-id="817e5-192">For example, the following expression concatenates the text "The date and time are: " with a dataset field StartDate, which is a <xref:System.DateTime> value: `="The date and time are: " & Fields!StartDate.Value`.</span></span>  
  
 <span data-ttu-id="817e5-193">Pour certains types de données, il peut être nécessaire d'inclure la fonction ToString.</span><span class="sxs-lookup"><span data-stu-id="817e5-193">For some data types, you may need to include the ToString function.</span></span> <span data-ttu-id="817e5-194">Par exemple, l’expression suivante affiche le même exemple en utilisant le type de données CLR <xref:System.DateTimeOffset>qui inclut la date, l’heure et un décalage de fuseau horaire par rapport au fuseau horaire UTC : `="The time is: " & Fields!StartDate.Value.ToString()`.</span><span class="sxs-lookup"><span data-stu-id="817e5-194">For example, the following expression shows the same example using the CLR data type <xref:System.DateTimeOffset>, which include the date, the time, and a time-zone offset relative to the UTC time zone: `="The time is: " & Fields!StartDate.Value.ToString()`.</span></span>  
  
### <a name="converting-a-string-data-type-to-a-clr-datetime-data-type"></a><span data-ttu-id="817e5-195">Conversion d'un type de données String en type de données CLR DateTime</span><span class="sxs-lookup"><span data-stu-id="817e5-195">Converting a String Data Type to a CLR DateTime Data Type</span></span>  
 <span data-ttu-id="817e5-196">Si une extension de traitement de données ne prend pas en charge tous les types de données définis dans une source de données, les données peuvent être extraites au format texte.</span><span class="sxs-lookup"><span data-stu-id="817e5-196">If a data processing extension does not support all data types defined on a data source, the data may be retrieved as text.</span></span> <span data-ttu-id="817e5-197">Par exemple, une valeur utilisant le type de données `datetimeoffset(7)` peut être extraite en tant que type de données String.</span><span class="sxs-lookup"><span data-stu-id="817e5-197">For example, a `datetimeoffset(7)` data type value may be retrieved as a String data type.</span></span> <span data-ttu-id="817e5-198">À Perth, en Australie, la valeur de chaîne pour le 1er juillet 2008, à 6:05:07.9999999 A.M. s'affiche alors</span><span class="sxs-lookup"><span data-stu-id="817e5-198">In Perth, Australia, the string value for July 1, 2008, at 6:05:07.9999999 A.M.</span></span> <span data-ttu-id="817e5-199">sous la forme :</span><span class="sxs-lookup"><span data-stu-id="817e5-199">would resemble:</span></span>  
  
 `2008-07-01 06:05:07.9999999 +08:00`  
  
 <span data-ttu-id="817e5-200">Cet exemple montre la date (le 1er juillet 2008), suivie de l'heure avec une précision de 7 chiffres (6:05:07.9999999 A.M.), suivie d'un décalage par rapport au fuseau horaire UTC exprimé en heures et en minutes (plus 8 heures, 0 minutes).</span><span class="sxs-lookup"><span data-stu-id="817e5-200">This example shows the date (July 1, 2008), followed by the time to a 7-digit precision (6:05:07.9999999 A.M.), followed by a UTC time zone offset in hours and minutes (plus 8 hours, 0 minutes).</span></span> <span data-ttu-id="817e5-201">Dans les exemples suivants, cette valeur a été placée dans un champ `String` appelé `MyDateTime.Value`.</span><span class="sxs-lookup"><span data-stu-id="817e5-201">For the following examples, this value has been placed in a `String` field called `MyDateTime.Value`.</span></span>  
  
 <span data-ttu-id="817e5-202">Vous pouvez utiliser l'une des méthodes suivantes pour convertir ces données en une ou plusieurs valeurs CLR :</span><span class="sxs-lookup"><span data-stu-id="817e5-202">You can use one of the following strategies to convert this data to one or more CLR values:</span></span>  
  
-   <span data-ttu-id="817e5-203">Dans une zone de texte, utilisez une expression pour extraire certaines parties de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="817e5-203">In a text box, use an expression to extract parts of the string.</span></span> <span data-ttu-id="817e5-204">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="817e5-204">For example:</span></span>  
  
    -   <span data-ttu-id="817e5-205">L'expression suivante extrait uniquement la partie Heure du décalage par rapport au fuseau horaire UTC et la convertit en minutes : `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span><span class="sxs-lookup"><span data-stu-id="817e5-205">The following expression extracts just the hour part of the UTC time zone offset and converts it to minutes: `=CInt(Fields!MyDateTime.Value.Substring(Fields!MyDateTime.Value.Length-5,2)) * 60`</span></span>  
  
         <span data-ttu-id="817e5-206">Le résultat est `480`.</span><span class="sxs-lookup"><span data-stu-id="817e5-206">The result is `480`.</span></span>  
  
    -   <span data-ttu-id="817e5-207">L'expression suivante convertit la chaîne en une valeur de date et heure : `=DateTime.Parse(Fields!MyDateTime.Value)`</span><span class="sxs-lookup"><span data-stu-id="817e5-207">The following expression converts the string to a date and time value: `=DateTime.Parse(Fields!MyDateTime.Value)`</span></span>  
  
         <span data-ttu-id="817e5-208">Si la chaîne `MyDateTime.Value` utilise un décalage UTC, la fonction `DateTime.Parse` ajuste tout d'abord le décalage UTC (7 A.M.</span><span class="sxs-lookup"><span data-stu-id="817e5-208">If the `MyDateTime.Value` string has a UTC offset, the `DateTime.Parse` function first adjusts for the UTC offset (7 A.M.</span></span> <span data-ttu-id="817e5-209">- [`+08:00`] de manière à afficher l'heure UTC 11 P.M.</span><span class="sxs-lookup"><span data-stu-id="817e5-209">- [`+08:00`] to the UTC time of 11 P.M.</span></span> <span data-ttu-id="817e5-210">la nuit précédente).</span><span class="sxs-lookup"><span data-stu-id="817e5-210">the night before).</span></span> <span data-ttu-id="817e5-211">La fonction `DateTime.Parse` applique ensuite le décalage UTC du serveur de rapports local et, si nécessaire, ajuste à nouveau l'heure pour tenir compte de l'heure d'été.</span><span class="sxs-lookup"><span data-stu-id="817e5-211">The `DateTime.Parse` function then applies the local report server UTC offset and, if necessary, adjusts the time again for Daylight Saving Time.</span></span> <span data-ttu-id="817e5-212">Par exemple, à Redmond, dans l'état de Washington, le décalage horaire local ajusté pour tenir compte de l'heure d'été est `[-07:00]`, ou 7 heures avant 11 PM.</span><span class="sxs-lookup"><span data-stu-id="817e5-212">For example, in Redmond, Washington, the local time offset adjusted for Daylight Saving Time is `[-07:00]`, or 7 hours earlier than 11 PM.</span></span> <span data-ttu-id="817e5-213">Le résultat correspond à la valeur `DateTime` suivante : `2007-07-06 04:07:07 PM` (6 juillet 2007 à 4:07 P.M).</span><span class="sxs-lookup"><span data-stu-id="817e5-213">The result is the following `DateTime` value: `2007-07-06 04:07:07 PM` (July 6, 2007 at 4:07 P.M).</span></span>  
  
 <span data-ttu-id="817e5-214">Pour plus d’informations sur la conversion de chaînes en `DateTime` types de données, consultez [analyse des chaînes de date et d’heure](https://go.microsoft.com/fwlink/?LinkId=89703), [mise en forme de la date et de l’heure pour une culture spécifique](https://go.microsoft.com/fwlink/?LinkId=89704)et [choix entre DateTime, DateTimeOffset et TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="817e5-214">For more information about converting strings to `DateTime` data types, see [Parsing Date and Time Strings](https://go.microsoft.com/fwlink/?LinkId=89703), [Formatting Date and Time for a Specific Culture](https://go.microsoft.com/fwlink/?LinkId=89704), and [Choosing Between DateTime, DateTimeOffset, and TimeZoneInfo](https://go.microsoft.com/fwlink/?linkid=110652) on MSDN.</span></span>  
  
-   <span data-ttu-id="817e5-215">Ajoutez un nouveau champ calculé au dataset du rapport qui utilise une expression pour extraire certaines parties de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="817e5-215">Add a new calculated field to the report dataset that uses an expression to extract parts of the string.</span></span> <span data-ttu-id="817e5-216">Pour plus d’informations, consultez [Ajouter, modifier ou actualiser des champs dans le volet des données de rapport &#40;Générateur de rapports et SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="817e5-216">For more information, see [Add, Edit, Refresh Fields in the Report Data Pane &#40;Report Builder and SSRS&#41;](../report-data/add-edit-refresh-fields-in-the-report-data-pane-report-builder-and-ssrs.md).</span></span>  
  
-   <span data-ttu-id="817e5-217">Modifiez la requête de dataset du rapport pour utiliser des fonctions [!INCLUDE[tsql](../../includes/tsql-md.md)] afin d'extraire indépendamment les valeurs de date et heure et de créer des colonnes séparées.</span><span class="sxs-lookup"><span data-stu-id="817e5-217">Change the report dataset query to use [!INCLUDE[tsql](../../includes/tsql-md.md)] functions to extract the date and time values independently to create separate columns.</span></span> <span data-ttu-id="817e5-218">L'exemple suivant montre comment utiliser la fonction `DatePart` afin d'ajouter une colonne pour l'année et une autre pour le fuseau horaire UTC converti en minutes.</span><span class="sxs-lookup"><span data-stu-id="817e5-218">The following example shows how to use the function `DatePart` to add a column for the year and a column for the UTC time zone converted to minutes:</span></span>  
  
     `SELECT`  
  
     `MyDateTime,`  
  
     `DATEPART(year, MyDateTime) AS Year,`  
  
     `DATEPART(tz, MyDateTime) AS OffsetinMinutes`  
  
     `FROM MyDates`  
  
     <span data-ttu-id="817e5-219">L'ensemble de résultats comporte trois colonnes.</span><span class="sxs-lookup"><span data-stu-id="817e5-219">The result set has three columns.</span></span> <span data-ttu-id="817e5-220">La première colonne correspond à la date et à l'heure, la deuxième à l'année, et la troisième au décalage UTC en minutes</span><span class="sxs-lookup"><span data-stu-id="817e5-220">The first column is the date and time, the second column is the year, and the third column is the UTC offset in minutes.</span></span> <span data-ttu-id="817e5-221">La ligne suivante affiche des exemples de données :</span><span class="sxs-lookup"><span data-stu-id="817e5-221">The following row shows example data:</span></span>  
  
     `2008-07-01 06:05:07             2008                   480`  
  
 <span data-ttu-id="817e5-222">Pour plus d’informations sur les types de base de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], consultez [Types de données &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql) et [Types de données et fonctions de date et d’heure &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) dans la [documentation en ligne SQL Server](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="817e5-222">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database data types, see [Data Types &#40;Transact-SQL&#41;](/sql/t-sql/data-types/data-types-transact-sql), and [Date and Time Data Types and Functions &#40;Transact-SQL&#41;](/sql/t-sql/functions/date-and-time-data-types-and-functions-transact-sql) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
 <span data-ttu-id="817e5-223">Pour plus d’et dans laformations sur les types de données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] , consultez [Types de données dans Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) et dans la [SQL Server Books Onlet dans lae](https://go.microsoft.com/fwlink/?linkid=120955).</span><span class="sxs-lookup"><span data-stu-id="817e5-223">For more information about [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data types, see [Data Types in Analysis Services](https://docs.microsoft.com/analysis-services/multidimensional-models/olap-physical/data-types-in-analysis-services) in [SQL Server Books Online](https://go.microsoft.com/fwlink/?linkid=120955).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="817e5-224">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="817e5-224">See Also</span></span>  
 [<span data-ttu-id="817e5-225">Mise en forme des éléments de rapport &#40;Générateur de rapports et SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="817e5-225">Formatting Report Items &#40;Report Builder and SSRS&#41;</span></span>](formatting-report-items-report-builder-and-ssrs.md)  
  
  
