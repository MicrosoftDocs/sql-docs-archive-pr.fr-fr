---
title: Références à des collections de variables de rapport et de groupe (Générateur de rapports et SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10404"
- sql12.rtp.rptdesigner.categorygroupproperties.variables.f1
- "10083"
- sql12.rtp.rptdesigner.seriesgroupproperties.variables.f1
- sql12.rtp.rptdesigner.reportproperties.variables.f1
- sql12.rtp.rptdesigner.groupproperties.variables.f1
- "10292"
- "10412"
ms.assetid: 4be5b463-3ce2-483d-a3c6-dae752cb543e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 41dd652bf39721b13801131a5ec268495edf9d29
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87695411"
---
# <a name="report-and-group-variables-collections-references-report-builder-and-ssrs"></a><span data-ttu-id="1d680-102">Références à des collections de variables de rapport et de groupe (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="1d680-102">Report and Group Variables Collections References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="1d680-103">Lorsqu'un calcul complexe est utilisé plusieurs fois dans les expressions d'un rapport, vous pouvez créer une variable.</span><span class="sxs-lookup"><span data-stu-id="1d680-103">When you have a complex calculation that is used more than once in expressions in a report, you might want to create a variable.</span></span> <span data-ttu-id="1d680-104">Vous pouvez créer une variable de rapport ou une variable de groupe.</span><span class="sxs-lookup"><span data-stu-id="1d680-104">You can create a report variable or a group variable.</span></span> <span data-ttu-id="1d680-105">Les noms de variable doivent être uniques dans un rapport.</span><span class="sxs-lookup"><span data-stu-id="1d680-105">Variable names must be unique in a report.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-variables"></a><span data-ttu-id="1d680-106">Variables de rapport</span><span class="sxs-lookup"><span data-stu-id="1d680-106">Report Variables</span></span>  
 <span data-ttu-id="1d680-107">Utilisez une variable de rapport pour contenir une valeur dans le cadre de calculs qui dépendent du temps, tels que les taux de change ou horodatages, ou pour un calcul complexe référencé plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="1d680-107">Use a report variable to hold a value for time-dependent calculations, such as currency rates or time stamps, or for a complex calculation that is referenced multiple times.</span></span> <span data-ttu-id="1d680-108">Par défaut, une variable de rapport est calculée une fois et peut être utilisée dans les expressions de l'ensemble d'un rapport.</span><span class="sxs-lookup"><span data-stu-id="1d680-108">By default, a report variable is calculated once and can be used in expressions throughout a report.</span></span> <span data-ttu-id="1d680-109">Les variables de rapport sont en lecture seule par défaut.</span><span class="sxs-lookup"><span data-stu-id="1d680-109">Report variables are read-only by default.</span></span> <span data-ttu-id="1d680-110">Vous pouvez modifier la valeur par défaut pour permettre à une variable de rapport d'être en lecture-écriture.</span><span class="sxs-lookup"><span data-stu-id="1d680-110">You can change the default to enable a report variable as read-write.</span></span> <span data-ttu-id="1d680-111">La valeur d'une variable de rapport est conservée tout au long d'une session, jusqu'à ce que le rapport soit traité une nouvelle fois.</span><span class="sxs-lookup"><span data-stu-id="1d680-111">The value in a report variable is preserved throughout a session, until the report is processed again.</span></span>  
  
 <span data-ttu-id="1d680-112">Pour ajouter une variable de rapport, ouvrez la boîte de dialogue **Propriétés du rapport** , cliquez sur **Variables**, puis spécifiez un nom et une valeur.</span><span class="sxs-lookup"><span data-stu-id="1d680-112">To add a report variable, open the **ReportProperties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="1d680-113">Les noms sont des chaînes sensibles à la casse qui commencent par une lettre et qui ne contiennent aucun espace.</span><span class="sxs-lookup"><span data-stu-id="1d680-113">Names are case-sensitive strings that begin with a letter and have no spaces.</span></span> <span data-ttu-id="1d680-114">Un nom peut inclure des lettres, des nombres et des traits de soulignement (_).</span><span class="sxs-lookup"><span data-stu-id="1d680-114">A name can include letters, numbers, or underscores (_).</span></span>  
  
 <span data-ttu-id="1d680-115">Pour faire référence à la variable dans une expression, utilisez la syntaxe de collection globale, par exemple `=Variables!CustomTimeStamp.Value`.</span><span class="sxs-lookup"><span data-stu-id="1d680-115">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!CustomTimeStamp.Value`.</span></span> <span data-ttu-id="1d680-116">Sur l’aire de conception, la valeur s’affiche dans une zone de texte sous la forme `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="1d680-116">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
 <span data-ttu-id="1d680-117">Vous pouvez utiliser les variables de rapport des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="1d680-117">You can use report variables in the following ways:</span></span>  
  
-   <span data-ttu-id="1d680-118">**Utilisation en lecture seule** Définissez une valeur une fois pour créer une constante pour la session de rapport, par exemple pour créer un horodatage.</span><span class="sxs-lookup"><span data-stu-id="1d680-118">**Read-only use** Set a value once to create a constant for the report session, for example, to create a time stamp.</span></span>  
  
     <span data-ttu-id="1d680-119">Dans la mesure où les expressions dans les zones de texte sont évaluées à la demande quand un utilisateur navigue parmi les pages d’un rapport, les valeurs dynamiques (par exemple, une expression qui inclut la fonction `Now()` , qui retourne l’heure du jour) peuvent retourner des valeurs différentes si vous passez aux pages suivante et précédente à l’aide du bouton **Précédent** .</span><span class="sxs-lookup"><span data-stu-id="1d680-119">Because expressions in text boxes are evaluated on-demand as a user pages through a report, dynamic values (for example, an expression that includes the `Now()` function, which returns the time of day) can return different values if you page forward and backward by using the **Back** button.</span></span> <span data-ttu-id="1d680-120">En définissant la valeur d'une variable de rapport avec l'expression `=Now()`, puis en ajoutant la variable à votre expression, vous garantissez que la même valeur est utilisée dans l'intégralité du traitement des rapports.</span><span class="sxs-lookup"><span data-stu-id="1d680-120">By setting a the value of a report variable to the expression `=Now()`, and then adding the variable to your expression, you ensure the same value is used throughout report processing.</span></span>  
  
-   <span data-ttu-id="1d680-121">**Utilisation en lecture/écriture** Définissez une valeur une fois et sérialisez-la dans une session de rapport.</span><span class="sxs-lookup"><span data-stu-id="1d680-121">**Read-write use** Set a value once and serialize the value within a report session.</span></span> <span data-ttu-id="1d680-122">L'option en lecture-écriture pour les variables fournit une meilleure alternative que l'utilisation d'une variable statique dans le bloc de code dans la définition de rapport.</span><span class="sxs-lookup"><span data-stu-id="1d680-122">The read-write option for variables provides a better alternative than using a static variable in the Code block in the report definition.</span></span>  
  
     <span data-ttu-id="1d680-123">Lorsque vous désactivez l’option **lecture seule** pour une variable, la propriété accessible en écriture de la variable a la valeur `true` .</span><span class="sxs-lookup"><span data-stu-id="1d680-123">When you clear the **Read-Only** option for a variable, the Writable property for the variable is set to `true`.</span></span> <span data-ttu-id="1d680-124">Pour mettre à jour la valeur à partir d’une expression, utilisez la méthode SetValue, par exemple `=Variables!MyVariable.SetValue("123")`.</span><span class="sxs-lookup"><span data-stu-id="1d680-124">To update the value from an expression, use the SetValue method, for example, `=Variables!MyVariable.SetValue("123")`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="1d680-125">Vous ne pouvez pas contrôler le moment où le processeur de rapports initialise une variable ou évalue une expression qui met à jour une variable.</span><span class="sxs-lookup"><span data-stu-id="1d680-125">You cannot control when the report processor initializes a variable or evaluates an expression that updates a variable.</span></span> <span data-ttu-id="1d680-126">L'ordre d'exécution pour l'initialisation d'une variable est non défini.</span><span class="sxs-lookup"><span data-stu-id="1d680-126">The order of execution for variable initialization is undefined.</span></span>  
  
 <span data-ttu-id="1d680-127">Pour plus d’informations sur les sessions, consultez [Aperçu des rapports dans le Générateur de rapports](../report-builder/previewing-reports-in-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="1d680-127">For more information about sessions, see [Previewing Reports in Report Builder](../report-builder/previewing-reports-in-report-builder.md).</span></span>  
  
## <a name="group-variables"></a><span data-ttu-id="1d680-128">Variables de groupe</span><span class="sxs-lookup"><span data-stu-id="1d680-128">Group Variables</span></span>  
 <span data-ttu-id="1d680-129">Utilisez une variable de groupe pour calculer une expression complexe dans l'étendue d'un groupe.</span><span class="sxs-lookup"><span data-stu-id="1d680-129">Use a group variable to calculate a complex expression once in the scope of a group.</span></span> <span data-ttu-id="1d680-130">Une variable de groupe est valide uniquement dans l'étendue du groupe et ses groupes enfants.</span><span class="sxs-lookup"><span data-stu-id="1d680-130">A group variable is valid only in the scope of the group and its child groups.</span></span>  
  
 <span data-ttu-id="1d680-131">Par exemple, supposez qu'une région de données affiche des données d'inventaire pour des éléments qui sont dans différentes catégories d'impôts et que vous souhaitez appliquer différents taux de taxe pour chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="1d680-131">For example, suppose a data region displays inventory data for items that are in different tax categories and you want to apply different tax rates for each category.</span></span> <span data-ttu-id="1d680-132">Vous regroupez les données en fonction des catégories et définissez une variable *Tax* sur le groupe parent.</span><span class="sxs-lookup"><span data-stu-id="1d680-132">You would group the data on Category and define a *Tax* variable on the parent group.</span></span> <span data-ttu-id="1d680-133">Vous définissez ensuite une variable de groupe pour *ItemTax* pour chaque catégorie d’impôts et affectez chacun des différents sous-groupes de catégories à la variable de groupe correcte.</span><span class="sxs-lookup"><span data-stu-id="1d680-133">Then you would define a group variable for *ItemTax* for each tax category and assign each of the different Category subgroups to the correct group variable.</span></span> <span data-ttu-id="1d680-134">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="1d680-134">For example:</span></span>  
  
-   <span data-ttu-id="1d680-135">Pour le groupe parent basé sur `[Category]`, affectez à la variable *Tax* la valeur `[Tax]`.</span><span class="sxs-lookup"><span data-stu-id="1d680-135">For the parent group based on `[Category]`, define the variable *Tax* with a value `[Tax]`.</span></span> <span data-ttu-id="1d680-136">Supposez que les valeurs des catégories sont Food et Clothing.</span><span class="sxs-lookup"><span data-stu-id="1d680-136">Assume the category values are Food and Clothing.</span></span>  
  
-   <span data-ttu-id="1d680-137">Pour le groupe enfant basé sur `[Subcategory]`, affectez à la variable *ItemsTax* la valeur `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span><span class="sxs-lookup"><span data-stu-id="1d680-137">For the child group based on `[Subcategory]`, define the variable *ItemsTax* as `=Variables!Tax.Value * Sum(Fields!Price.Value)`.</span></span> <span data-ttu-id="1d680-138">Supposez que les valeurs des sous-catégories pour la catégorie Food sont Beverages et Bread.</span><span class="sxs-lookup"><span data-stu-id="1d680-138">Assume the subcategory values for the category Food are Beverages and Bread.</span></span> <span data-ttu-id="1d680-139">Supposez que les valeurs des sous-catégories pour Clothing sont Shirts et Hats.</span><span class="sxs-lookup"><span data-stu-id="1d680-139">Assume the subcategory values for Clothing are Shirts and Hats.</span></span>  
  
-   <span data-ttu-id="1d680-140">Pour une zone de texte d’une ligne située dans le groupe enfant, ajoutez l’expression `=Variables!ItemsTax.Value`.</span><span class="sxs-lookup"><span data-stu-id="1d680-140">For a text box in a row in the child group, add the expression `=Variables!ItemsTax.Value`.</span></span>  
  
     <span data-ttu-id="1d680-141">La zone de texte affiche l'impôt total pour Beverages et Bread à l'aide de l'impôt de la catégorie Food, et pour Shirts et Hats à l'aide de l'impôt de la catégorie Clothing.</span><span class="sxs-lookup"><span data-stu-id="1d680-141">The text box displays the total tax for Beverages and Bread using the Food tax and for Shirts and Hats using the Clothing tax.</span></span>  
  
 <span data-ttu-id="1d680-142">Pour ajouter une variable de groupe, ouvrez la boîte de dialogue **Propriétés du groupe de tableaux matriciels** , cliquez sur **Variables**, puis indiquez un nom et une valeur.</span><span class="sxs-lookup"><span data-stu-id="1d680-142">To add a group variable, open the **Tablix Group Properties** dialog box, click **Variables**, and provide a name and a value.</span></span> <span data-ttu-id="1d680-143">La variable de groupe est calculée une fois par valeur de groupe unique.</span><span class="sxs-lookup"><span data-stu-id="1d680-143">The group variable is calculated once per unique group value.</span></span>  
  
 <span data-ttu-id="1d680-144">Pour faire référence à la variable dans une expression, utilisez la syntaxe de collection globale, par exemple `=Variables!GroupDescription.Value`.</span><span class="sxs-lookup"><span data-stu-id="1d680-144">To refer to the variable in an expression, use the global collection syntax, for example, `=Variables!GroupDescription.Value`.</span></span> <span data-ttu-id="1d680-145">Sur l’aire de conception, la valeur s’affiche dans une zone de texte sous la forme `<<Expr>>`.</span><span class="sxs-lookup"><span data-stu-id="1d680-145">On the design surface, the value appears in a text box as `<<Expr>>`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1d680-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1d680-146">See Also</span></span>  
 <span data-ttu-id="1d680-147">[Filtrer, regrouper et trier des données &#40;Générateur de rapports et SSRS&#41;](filter-group-and-sort-data-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="1d680-147">[Filter, Group, and Sort Data &#40;Report Builder and SSRS&#41;](filter-group-and-sort-data-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="1d680-148">[Collections intégrées dans les expressions &#40;Générateur de rapports et SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span><span class="sxs-lookup"><span data-stu-id="1d680-148">[Built-in Collections in Expressions &#40;Report Builder and SSRS&#41;](built-in-collections-in-expressions-report-builder.md) </span></span>  
 [<span data-ttu-id="1d680-149">Exemples d’expressions &#40;Générateur de rapports et SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="1d680-149">Expression Examples &#40;Report Builder and SSRS&#41;</span></span>](expression-examples-report-builder-and-ssrs.md)  
  
  
