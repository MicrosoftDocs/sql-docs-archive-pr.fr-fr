---
title: Fonction Aggregate (Générateur de rapports et SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 16ce643f-bbb3-40a5-ba78-7aed73156f3e
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: fcc65f1e60c29ba9ea6a4206b419eb0b13edb0ff
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87610449"
---
# <a name="aggregate-function-report-builder-and-ssrs"></a><span data-ttu-id="fe554-102">Fonction d'agrégation (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="fe554-102">Aggregate Function (Report Builder and SSRS)</span></span>
  <span data-ttu-id="fe554-103">Retourne un agrégat personnalisé de l'expression spécifiée, comme défini par le fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="fe554-103">Returns a custom aggregate of the specified expression, as defined by the data provider.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="syntax"></a><span data-ttu-id="fe554-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="fe554-104">Syntax</span></span>  
  
```  
  
Aggregate(expression, scope)  
```  
  
#### <a name="parameters"></a><span data-ttu-id="fe554-105">Paramètres</span><span class="sxs-lookup"><span data-stu-id="fe554-105">Parameters</span></span>  
 <span data-ttu-id="fe554-106">*expression*</span><span class="sxs-lookup"><span data-stu-id="fe554-106">*expression*</span></span>  
 <span data-ttu-id="fe554-107">Expression sur laquelle effectuer l'agrégation.</span><span class="sxs-lookup"><span data-stu-id="fe554-107">The expression on which to perform the aggregation.</span></span> <span data-ttu-id="fe554-108">Elle doit être une référence de champ simple.</span><span class="sxs-lookup"><span data-stu-id="fe554-108">The expression must be a simple field reference.</span></span>  
  
 <span data-ttu-id="fe554-109">*scope*</span><span class="sxs-lookup"><span data-stu-id="fe554-109">*scope*</span></span>  
 <span data-ttu-id="fe554-110">(`String`) Nom d'un dataset, d'un groupe ou d'une région de données qui contient les éléments de rapport auxquels appliquer la fonction d'agrégation.</span><span class="sxs-lookup"><span data-stu-id="fe554-110">(`String`) The name of a dataset, group, or data region that contains the report items to which to apply the aggregate function.</span></span> <span data-ttu-id="fe554-111">*Scope* doit être une constante de type chaîne et ne peut pas être une expression.</span><span class="sxs-lookup"><span data-stu-id="fe554-111">*Scope* must be a string constant andcannot be an expression.</span></span> <span data-ttu-id="fe554-112">Si le paramètre *scope* n'est pas spécifié, l'étendue actuelle est utilisée.</span><span class="sxs-lookup"><span data-stu-id="fe554-112">If *scope* is not specified, the current scope is used.</span></span>  
  
## <a name="return-type"></a><span data-ttu-id="fe554-113">Type de retour</span><span class="sxs-lookup"><span data-stu-id="fe554-113">Return Type</span></span>  
 <span data-ttu-id="fe554-114">Le type de retour est déterminé par le fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="fe554-114">Return type is determined by the data provider.</span></span> <span data-ttu-id="fe554-115">La fonction retourne `Nothing` si le fournisseur de données ne prend pas en charge cette fonction ou si les données ne sont pas disponibles.</span><span class="sxs-lookup"><span data-stu-id="fe554-115">Returns `Nothing` if the data provider does not support this function or data is not available.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="fe554-116">Notes</span><span class="sxs-lookup"><span data-stu-id="fe554-116">Remarks</span></span>  
 <span data-ttu-id="fe554-117">La fonction `Aggregate` offre un moyen d'utiliser des agrégats calculés sur la source de données externe.</span><span class="sxs-lookup"><span data-stu-id="fe554-117">The `Aggregate` function provides a way to use aggregates that are calculated on the external data source.</span></span> <span data-ttu-id="fe554-118">La prise en charge de cette fonctionnalité est déterminée par l'extension de données.</span><span class="sxs-lookup"><span data-stu-id="fe554-118">Support for this feature is determined by the data extension.</span></span> <span data-ttu-id="fe554-119">Par exemple, l'extension pour le traitement des données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] récupère des ensembles de lignes aplatis d'une requête MDX.</span><span class="sxs-lookup"><span data-stu-id="fe554-119">For example, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data processing extension retrieves flattened rowsets from an MDX query.</span></span> <span data-ttu-id="fe554-120">Certaines lignes du jeu de résultats peuvent contenir des valeurs d'agrégation calculées sur le serveur de la source de données.</span><span class="sxs-lookup"><span data-stu-id="fe554-120">Some rows in the result set can contain aggregate values calculated on the data source server.</span></span> <span data-ttu-id="fe554-121">Elles sont connues sous le nom d' *agrégats de serveur*.</span><span class="sxs-lookup"><span data-stu-id="fe554-121">These are known as *server aggregates*.</span></span> <span data-ttu-id="fe554-122">Pour afficher les agrégats de serveur dans le concepteur de requêtes graphique pour [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], vous pouvez utiliser le bouton **Afficher les agrégations** dans la barre d'outils.</span><span class="sxs-lookup"><span data-stu-id="fe554-122">To view server aggregates in the graphical query designer for [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], you can use the **Show Aggregate** button on the toolbar.</span></span> <span data-ttu-id="fe554-123">Pour plus d’informations, consultez [Interface utilisateur du Concepteur de requêtes MDX Analysis Services &#40;Générateur de rapports&#41;](../analysis-services-mdx-query-designer-user-interface-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="fe554-123">For more information, see [Analysis Services MDX Query Designer User Interface &#40;Report Builder&#41;](../analysis-services-mdx-query-designer-user-interface-report-builder.md).</span></span>  
  
 <span data-ttu-id="fe554-124">Lorsque vous affichez la combinaison des valeurs d'agrégation et de dataset détaillées sur les lignes de détails d'une région de données d'un tableau matriciel, les agrégats de serveur ne sont en général pas inclus, car il ne s'agit pas de données de détail.</span><span class="sxs-lookup"><span data-stu-id="fe554-124">When you display the combination of aggregate and detail dataset values on detail rows of a Tablix data region, server aggregates would not typically be included because they are not detail data.</span></span> <span data-ttu-id="fe554-125">Toutefois, vous pouvez afficher toutes les valeurs récupérées pour le dataset et personnaliser la façon dont les données d'agrégation sont calculées et affichées.</span><span class="sxs-lookup"><span data-stu-id="fe554-125">However, you may want to display all values retrieved for the dataset and customize the way aggregate data is calculated and displayed.</span></span>  
  
 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] <span data-ttu-id="fe554-126">détecte l'utilisation de la fonction `Aggregate` dans les expressions de votre rapport pour déterminer s'il convient d'afficher les agrégats de serveur sur les lignes de détails.</span><span class="sxs-lookup"><span data-stu-id="fe554-126">detects the use of the `Aggregate` function in expressions in your report in order to determine whether to display server aggregates on detail rows.</span></span> <span data-ttu-id="fe554-127">Si vous incluez `Aggregate` dans une expression d'une région de données, les agrégats de serveur peuvent apparaître uniquement sur les lignes du total de groupe ou du total général, mais pas sur les lignes de détails.</span><span class="sxs-lookup"><span data-stu-id="fe554-127">If you include `Aggregate` in an expression in a data region, server aggregates can only appear on group total or grand total rows, not on detail rows.</span></span> <span data-ttu-id="fe554-128">Si vous souhaitez afficher les agrégats de serveur sur les lignes de détails, n'utilisez pas la fonction `Aggregate`.</span><span class="sxs-lookup"><span data-stu-id="fe554-128">If you want to display server aggregates on detail rows, do not use the `Aggregate` function.</span></span>  
  
 <span data-ttu-id="fe554-129">Vous pouvez modifier ce comportement par défaut en changeant la valeur de l'option **Interpréter les sous-totaux comme des lignes de détails** dans la boîte de dialogue **Propriétés du dataset** .</span><span class="sxs-lookup"><span data-stu-id="fe554-129">You can change this default behavior by changing the value of the **Interpret subtotals as details** option on the **Dataset Properties** dialog box.</span></span> <span data-ttu-id="fe554-130">Lorsque cette option a la valeur `True`, toutes les données, y compris les agrégats de serveur, apparaissent comme données de détail.</span><span class="sxs-lookup"><span data-stu-id="fe554-130">When this option is set to `True`, all data, including server aggregates, appears as detail data.</span></span> <span data-ttu-id="fe554-131">Lorsque cette option a la valeur `False`, les agrégats de serveur apparaissent comme totaux.</span><span class="sxs-lookup"><span data-stu-id="fe554-131">When set to `False`, server aggregates appear as totals.</span></span> <span data-ttu-id="fe554-132">Le paramètre de cette propriété affecte toutes les régions de données liées à ce dataset.</span><span class="sxs-lookup"><span data-stu-id="fe554-132">The setting for this property affects all data regions that are linked to this dataset.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="fe554-133">Tous les groupes contenant l'élément de rapport qui fait référence à `Aggregate` doivent disposer de références de champ simples pour leurs expressions de groupe, par exemple `[FieldName]`.</span><span class="sxs-lookup"><span data-stu-id="fe554-133">All containing groups for the report item that references `Aggregate` must have simple field references for their group expressions, for example, `[FieldName]`.</span></span> <span data-ttu-id="fe554-134">Vous ne pouvez pas utiliser `Aggregate` dans une région de données qui utilise des expressions de groupe complexes.</span><span class="sxs-lookup"><span data-stu-id="fe554-134">You cannot use `Aggregate` in a data region that uses complex group expressions.</span></span> <span data-ttu-id="fe554-135">Pour l'extension pour le traitement des données [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], votre requête doit inclure des champs MDX de type `LevelProperty` (et non `MemberProperty`) pour prendre en charge l'agrégation à l'aide de la fonction `Aggregate`.</span><span class="sxs-lookup"><span data-stu-id="fe554-135">For the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)][!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] data processing extension, your query must include MDX fields of type `LevelProperty` (not `MemberProperty`) to support aggregation using the `Aggregate`function.</span></span>  
  
 <span data-ttu-id="fe554-136">*Expression* peut contenir des appels aux fonctions d'agrégation imbriquées avec les exceptions et conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="fe554-136">*Expression* can contain calls to nested aggregate functions with the following exceptions and conditions:</span></span>  
  
-   <span data-ttu-id="fe554-137">Le paramètre*Scope* des agrégats imbriqués doit être identique à l'étendue de l'agrégat externe ou contenu par celle-ci.</span><span class="sxs-lookup"><span data-stu-id="fe554-137">*Scope* for nested aggregates must be the same as, or contained by, the scope of the outer aggregate.</span></span> <span data-ttu-id="fe554-138">Pour toutes les étendues distinctes de l'expression, une étendue doit figurer dans une relation enfant avec toutes les autres étendues.</span><span class="sxs-lookup"><span data-stu-id="fe554-138">For all distinct scopes in the expression, one scope must be in a child relationship to all other scopes.</span></span>  
  
-   <span data-ttu-id="fe554-139">Le paramètre*Scope* des agrégats imbriqués ne peut pas être le nom d'un dataset.</span><span class="sxs-lookup"><span data-stu-id="fe554-139">*Scope* for nested aggregates cannot be the name of a dataset.</span></span>  
  
-   <span data-ttu-id="fe554-140">L' *expression* ne doit pas contenir `First` de fonctions, `Last` , `Previous` ou `RunningValue` .</span><span class="sxs-lookup"><span data-stu-id="fe554-140">*Expression* must not contain `First`, `Last`, `Previous`, or `RunningValue` functions.</span></span>  
  
-   <span data-ttu-id="fe554-141">*Expression* ne doit pas contenir les agrégats imbriqués qui spécifient *recursive*.</span><span class="sxs-lookup"><span data-stu-id="fe554-141">*Expression* must not contain nested aggregates that specify *recursive*.</span></span>  
  
 <span data-ttu-id="fe554-142">Pour plus d’informations, consultez [Référence aux fonctions d’agrégation &#40;Générateur de rapports et SSRS&#41;](report-builder-functions-aggregate-functions-reference.md) et [Étendue des expressions pour les totaux, les agrégats et les collections intégrées &#40;Générateur de rapports et SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span><span class="sxs-lookup"><span data-stu-id="fe554-142">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md) and [Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;](expression-scope-for-totals-aggregates-and-built-in-collections.md).</span></span>  
  
 <span data-ttu-id="fe554-143">Pour plus d’informations sur les agrégats récursifs, consultez [Création de groupes de hiérarchies récursives &#40;Générateur de rapports et SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="fe554-143">For more information about recursive aggregates, see [Creating Recursive Hierarchy Groups &#40;Report Builder and SSRS&#41;](creating-recursive-hierarchy-groups-report-builder-and-ssrs.md).</span></span>  
  
## <a name="comparing-the-aggregate-and-sum-functions"></a><span data-ttu-id="fe554-144">Comparaison des fonctions Aggregate et Sum</span><span class="sxs-lookup"><span data-stu-id="fe554-144">Comparing the Aggregate and Sum Functions</span></span>  
 <span data-ttu-id="fe554-145">La fonction `Aggregate` diffère des fonctions d'agrégation numériques comme `Sum`, car la fonction `Aggregate` retourne une valeur calculée par le fournisseur de données ou l'extension pour le traitement des données.</span><span class="sxs-lookup"><span data-stu-id="fe554-145">The `Aggregate` function differs from numeric aggregate functions like `Sum` in that the `Aggregate` function returns a value that is calculated by the data provider or data processing extension.</span></span> <span data-ttu-id="fe554-146">Les fonctions d’agrégation numériques telles que `Sum` retournent une valeur calculée par le processeur de rapports sur un jeu de données du DataSet déterminé par le paramètre *scope* .</span><span class="sxs-lookup"><span data-stu-id="fe554-146">Numeric aggregate functions like `Sum` return a value that is calculated by the report processor on a set of data from the dataset that is determined by the *scope* parameter.</span></span> <span data-ttu-id="fe554-147">Pour plus d’informations, consultez les expressions d’agrégation répertoriées dans [Référence aux fonctions d’agrégation &#40;Générateur de rapports et SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="fe554-147">For more information, see the aggregate functions listed in [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="fe554-148">Exemple</span><span class="sxs-lookup"><span data-stu-id="fe554-148">Example</span></span>  
 <span data-ttu-id="fe554-149">L'exemple de code suivant affiche une expression qui récupère un agrégat de serveur pour le champ `LineTotal`.</span><span class="sxs-lookup"><span data-stu-id="fe554-149">The following code example shows an expression that retrieves a server aggregate for the field `LineTotal`.</span></span> <span data-ttu-id="fe554-150">L'expression est ajoutée à une cellule d'une ligne qui appartient au groupe `GroupbyOrder`.</span><span class="sxs-lookup"><span data-stu-id="fe554-150">The expression is added to a cell in a row that belongs to the group `GroupbyOrder`.</span></span>  
  
```  
=Aggregate(Fields!LineTotal.Value, "GroupbyOrder")  
```  
  
## <a name="see-also"></a><span data-ttu-id="fe554-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fe554-151">See Also</span></span>  
 <span data-ttu-id="fe554-152">[Utilisation d’expressions dans les rapports &#40;Générateur de rapport et SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="fe554-152">[Expression Uses in Reports &#40;Report Builder and SSRS&#41;](expression-uses-in-reports-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="fe554-153">[Exemples d’expressions &#40;Générateur de rapports et SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="fe554-153">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 <span data-ttu-id="fe554-154">[Types de données dans les expressions &#40;Générateur de rapports et SSRS&#41;](expressions-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="fe554-154">[Data Types in Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="fe554-155">Étendue des expressions pour les totaux, les agrégats et les collections intégrées &#40;Générateur de rapports et SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="fe554-155">Expression Scope for Totals, Aggregates, and Built-in Collections &#40;Report Builder and SSRS&#41;</span></span>](expression-scope-for-totals-aggregates-and-built-in-collections.md)  
  
  
