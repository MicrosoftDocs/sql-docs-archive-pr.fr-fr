---
title: En-têtes et pieds de page (Générateur de rapports et SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- sql12.rtp.rptdesigner.pagefooter.fill.f1
- "10125"
- "10121"
- "10120"
- "10122"
- "10123"
- sql12.rtp.rptdesigner.pageheader.border.f1
- sql12.rtp.rptdesigner.pageheader.general.f1
- sql12.rtp.rptdesigner.pagefooter.border.f1
- sql12.rtp.rptdesigner.pageheader.fill.f1
- sql12.rtp.rptdesigner.pagefooter.general.f1
- "10124"
ms.assetid: 4fb9faac-511e-404a-b8d7-1f2e3cb47b11
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d534833a6820c9924e69ae0575341d578b746732
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87605179"
---
# <a name="page-headers-and-footers-report-builder-and-ssrs"></a><span data-ttu-id="21195-102">En-têtes et pieds de page (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="21195-102">Page Headers and Footers (Report Builder and SSRS)</span></span>
  <span data-ttu-id="21195-103">Un rapport peut contenir un en-tête et un pied de page. Ces informations sont situées respectivement le long des bords supérieur et inférieur de chaque page.</span><span class="sxs-lookup"><span data-stu-id="21195-103">A report can contain a header and footer that run along the top and bottom of each page, respectively.</span></span> <span data-ttu-id="21195-104">Les en-têtes et pieds de page peuvent contenir du texte statique, des images, des rectangles, des bordures, une couleur d'arrière-plan, des images d'arrière-plan et des expressions.</span><span class="sxs-lookup"><span data-stu-id="21195-104">Headers and footers can contain static text, images, lines, rectangles, borders, background color, background images, and expressions.</span></span> <span data-ttu-id="21195-105">Les expressions contiennent des références de champs de dataset pour des rapports qui utilisent un seul dataset, ainsi que des appels de fonction d'agrégation qui intègrent le dataset sous forme d'étendue.</span><span class="sxs-lookup"><span data-stu-id="21195-105">Expressions include dataset field references for reports with exactly one dataset and aggregate function calls that include the dataset as a scope.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="21195-106">Chaque extension du rendu traite les pages différemment.</span><span class="sxs-lookup"><span data-stu-id="21195-106">Each rendering extension processes pages differently.</span></span> <span data-ttu-id="21195-107">Pour plus d’informations sur la pagination des rapports et les extensions de rendu, consultez [Pagination dans Reporting Services &#40;Générateur de rapports et SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-107">For more information about report pagination and rendering extensions, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="21195-108">Par défaut, les rapports contiennent des pieds de page mais pas d'en-têtes de page.</span><span class="sxs-lookup"><span data-stu-id="21195-108">By default, reports have page footers, but not page headers.</span></span> <span data-ttu-id="21195-109">Pour plus d’informations sur leur ajout ou leur suppression, consultez [Ajouter ou supprimer un en-tête ou un pied de page &#40;Générateur de rapports et SSRS&#41;](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-109">For more information about how to add or remove them, see [Add or Remove a Page Header or Footer &#40;Report Builder and SSRS&#41;](add-or-remove-a-page-header-or-footer-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="21195-110">En règle générale, les en-têtes et pieds de page contiennent des numéros de page, des titres de rapport et d'autres propriétés de rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-110">Headers and footers commonly contain page numbers, report titles, and other report properties.</span></span> <span data-ttu-id="21195-111">Pour plus d’informations sur l’ajout de ces éléments à un en-tête ou pied de page dans votre rapport, consultez [Afficher les numéros de page ou d’autres propriétés de rapport &#40;Générateur de rapports et SSRS&#41;](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-111">For more information about how to add these items to your report header or footer, see [Display Page Numbers or Other Report Properties &#40;Report Builder and SSRS&#41;](display-page-numbers-or-other-report-properties-report-builder-and-ssrs.md).</span></span>  
  
 <span data-ttu-id="21195-112">Une fois créés, les en-têtes et pieds de page s'affichent sur toutes les pages du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-112">After you create a page header or footer, it is displayed on each report page.</span></span> <span data-ttu-id="21195-113">Pour plus d’informations sur la suppression des en-têtes et pieds de page figurant sur les première et dernière pages, consultez [Masquer un en-tête ou un pied de page sur la première ou la dernière page &#40;Générateur de rapports et SSRS&#41;](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-113">For more information about how to suppress page headers and footers on the first and last pages, see [Hide a Page Header or Footer on the First or Last Page &#40;Report Builder and SSRS&#41;](hide-a-page-header-or-footer-on-the-first-or-last-page-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="report-headers-and-footers"></a><span data-ttu-id="21195-114">En-têtes et pieds de page de rapport</span><span class="sxs-lookup"><span data-stu-id="21195-114">Report Headers and Footers</span></span>  
 <span data-ttu-id="21195-115">Les en-têtes et pieds de page ne sont pas identiques aux en-têtes et pieds de page de rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-115">Page headers and footers are not the same as report headers and footers.</span></span> <span data-ttu-id="21195-116">Les rapports ne contiennent pas en effet de zone spécialement réservée aux en-têtes ou pieds de page.</span><span class="sxs-lookup"><span data-stu-id="21195-116">Reports do not have a special report header or report footer area.</span></span> <span data-ttu-id="21195-117">Les en-têtes de rapport contiennent les éléments qui figurent en haut du corps du rapport, c'est-à-dire sur son aire de conception.</span><span class="sxs-lookup"><span data-stu-id="21195-117">A report header consists of the report items that are placed at the top of the report body on the report design surface.</span></span> <span data-ttu-id="21195-118">Ces éléments apparaissent une fois seulement et correspondent au premier contenu du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-118">They appear only once as the first content in the report.</span></span> <span data-ttu-id="21195-119">Les pieds de page de rapport contiennent les éléments qui figurent en bas du corps du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-119">A report footer consists of report items that are placed at the bottom of the report body.</span></span> <span data-ttu-id="21195-120">Ces éléments apparaissent une fois seulement et correspondent au dernier contenu du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-120">They appear only once as the last content in the report.</span></span>  
  
## <a name="displaying-variable-data-in-a-page-header-or-footer"></a><span data-ttu-id="21195-121">Affichage de données variables dans les en-têtes ou pieds de page</span><span class="sxs-lookup"><span data-stu-id="21195-121">Displaying Variable Data in a Page Header or Footer</span></span>  
 <span data-ttu-id="21195-122">Les en-têtes et pieds de page peuvent contenir du contenu statique, mais ils servent généralement à afficher des éléments qui varient, tels que des numéros de page ou des informations sur le contenu d'une page.</span><span class="sxs-lookup"><span data-stu-id="21195-122">Page headers and footers can contain static content, but they are more commonly used to display varying content like page numbers or information about the contents of a page.</span></span> <span data-ttu-id="21195-123">Pour afficher des données variables d'une page à l'autre, vous devez définir une expression.</span><span class="sxs-lookup"><span data-stu-id="21195-123">To display variable data that is different on each page, you must use an expression.</span></span>  
  
 <span data-ttu-id="21195-124">Quand un seul dataset est défini dans le rapport, vous pouvez ajouter des expressions simples telles que `[FieldName]` aux en-têtes ou pieds de page.</span><span class="sxs-lookup"><span data-stu-id="21195-124">If there is only one dataset defined in the report, you can add simple expressions such as `[FieldName]` to a page header or footer.</span></span> <span data-ttu-id="21195-125">Faites glisser le champ de la collection de champs du dataset du volet des données de rapportou de la collection de champs prédéfinis vers l'en-tête ou le pied de page.</span><span class="sxs-lookup"><span data-stu-id="21195-125">Drag the field from the Report Data pane dataset field collection or the Built-in Fields collection to the page header or page footer.</span></span> <span data-ttu-id="21195-126">Une zone de texte contenant l'expression adéquate est alors automatiquement ajoutée.</span><span class="sxs-lookup"><span data-stu-id="21195-126">A text box with the appropriate expression is automatically added for you.</span></span>  
  
 <span data-ttu-id="21195-127">Pour calculer la somme ou les autres agrégats des valeurs d'une page, vous pouvez utiliser les expressions d'agrégat qui permettent de définir les éléments apparaissant dans le rapport et le nom du dataset.</span><span class="sxs-lookup"><span data-stu-id="21195-127">To calculate sums or other aggregates for values on the page, you can use aggregate expressions that specify ReportItems or the name of a dataset.</span></span> <span data-ttu-id="21195-128">La collection ReportItems correspond à la collection de zones de texte qui apparaissent sur chaque page du rapport une fois celui-ci rendu.</span><span class="sxs-lookup"><span data-stu-id="21195-128">The ReportItems collection is the collection of text boxes on each page after report rendering occurs.</span></span> <span data-ttu-id="21195-129">La définition du rapport doit contenir le nom du dataset.</span><span class="sxs-lookup"><span data-stu-id="21195-129">The dataset name must exist in the report definition.</span></span> <span data-ttu-id="21195-130">Le tableau ci-après répertorie les éléments pris en charge en fonction de chaque type d'expression d'agrégat utilisée :</span><span class="sxs-lookup"><span data-stu-id="21195-130">The following table displays which items are supported in each type of aggregate expression:</span></span>  
  
|<span data-ttu-id="21195-131">Pris en charge par l'expression</span><span class="sxs-lookup"><span data-stu-id="21195-131">Supported in expression</span></span>|<span data-ttu-id="21195-132">Agrégats ReportItems</span><span class="sxs-lookup"><span data-stu-id="21195-132">ReportItems aggregates</span></span>|<span data-ttu-id="21195-133">Agrégats du dataset (le nom du dataset doit correspondre à l'étendue)</span><span class="sxs-lookup"><span data-stu-id="21195-133">Dataset aggregates (scope must be name of dataset)</span></span>|  
|-----------------------------|----------------------------|----------------------------------------------------------|  
|<span data-ttu-id="21195-134">Zones de texte apparaissant dans le corps du rapport</span><span class="sxs-lookup"><span data-stu-id="21195-134">Text boxes in body of report</span></span>|<span data-ttu-id="21195-135">Oui</span><span class="sxs-lookup"><span data-stu-id="21195-135">Yes</span></span>|<span data-ttu-id="21195-136">Non</span><span class="sxs-lookup"><span data-stu-id="21195-136">No</span></span>|  
|<span data-ttu-id="21195-137">&PageNumber</span><span class="sxs-lookup"><span data-stu-id="21195-137">&PageNumber</span></span>|<span data-ttu-id="21195-138">Oui</span><span class="sxs-lookup"><span data-stu-id="21195-138">Yes</span></span>|<span data-ttu-id="21195-139">Non</span><span class="sxs-lookup"><span data-stu-id="21195-139">No</span></span>|  
|<span data-ttu-id="21195-140">&TotalPages</span><span class="sxs-lookup"><span data-stu-id="21195-140">&TotalPages</span></span>|<span data-ttu-id="21195-141">Oui</span><span class="sxs-lookup"><span data-stu-id="21195-141">Yes</span></span>|<span data-ttu-id="21195-142">Non</span><span class="sxs-lookup"><span data-stu-id="21195-142">No</span></span>|  
|<span data-ttu-id="21195-143">Fonction d'agrégation</span><span class="sxs-lookup"><span data-stu-id="21195-143">Aggregate function</span></span>|<span data-ttu-id="21195-144">Oui.</span><span class="sxs-lookup"><span data-stu-id="21195-144">Yes.</span></span> <span data-ttu-id="21195-145">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="21195-145">For example,</span></span><br /><br /> `=First(ReportItems!TXT_LastName.Value)`|<span data-ttu-id="21195-146">Oui.</span><span class="sxs-lookup"><span data-stu-id="21195-146">Yes.</span></span> <span data-ttu-id="21195-147">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="21195-147">For example,</span></span><br /><br /> `=Max(Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="21195-148">Collection de champs pour les éléments figurant sur les pages</span><span class="sxs-lookup"><span data-stu-id="21195-148">Fields collection for items on the page</span></span>|<span data-ttu-id="21195-149">Indirectement.</span><span class="sxs-lookup"><span data-stu-id="21195-149">Indirectly.</span></span> <span data-ttu-id="21195-150">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="21195-150">For example,</span></span><br /><br /> `=Sum(ReportItems!Textbox1.Value)`|<span data-ttu-id="21195-151">Oui.</span><span class="sxs-lookup"><span data-stu-id="21195-151">Yes.</span></span> <span data-ttu-id="21195-152">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="21195-152">For example,</span></span><br /><br /> `=Sum(Fields!Quantity.Value,"DataSet1")`|  
|<span data-ttu-id="21195-153">Image liée aux données</span><span class="sxs-lookup"><span data-stu-id="21195-153">Data-bound image</span></span>|<span data-ttu-id="21195-154">Indirectement.</span><span class="sxs-lookup"><span data-stu-id="21195-154">Indirectly.</span></span> <span data-ttu-id="21195-155">Par exemple : `=ReportItems!TXT_Photo.Value`</span><span class="sxs-lookup"><span data-stu-id="21195-155">For example, `=ReportItems!TXT_Photo.Value`</span></span>|<span data-ttu-id="21195-156">Oui.</span><span class="sxs-lookup"><span data-stu-id="21195-156">Yes.</span></span> <span data-ttu-id="21195-157">Par exemple,</span><span class="sxs-lookup"><span data-stu-id="21195-157">For example,</span></span><br /><br /> `=First(Fields!Photo.Value,"DataSet1")`|  
  
 <span data-ttu-id="21195-158">Les sections suivantes de cette rubrique illustrent des expressions prêtes à l'emploi permettant d'obtenir les données variables utilisées couramment dans les en-têtes et pieds de page.</span><span class="sxs-lookup"><span data-stu-id="21195-158">The following sections in this topic show ready-to-use expressions that get variable data commonly used in headers and footers.</span></span> <span data-ttu-id="21195-159">Une section explique également le mode de traitement de l'extension de rendu Excel pour les en-têtes et les pieds de page.</span><span class="sxs-lookup"><span data-stu-id="21195-159">There is also a section on how the Excel rendering extension processes headers and footers.</span></span> <span data-ttu-id="21195-160">Pour plus d’informations sur les expressions, consultez [Expressions &#40;Générateur de rapports et SSRS&#41;](expressions-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-160">For more information about expressions, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md).</span></span>  
  
### <a name="adding-calculated-page-totals-to-a-header-or-footer"></a><span data-ttu-id="21195-161">Ajout de totaux calculés de page à un en-tête ou à un pied de page</span><span class="sxs-lookup"><span data-stu-id="21195-161">Adding Calculated Page Totals to a Header or Footer</span></span>  
 <span data-ttu-id="21195-162">Pour certains rapports, il est pratique d'inclure une valeur calculée dans l'en-tête ou le pied de page de chaque rapport (par exemple, une somme totale par page si celle-ci comprend des valeurs numériques).</span><span class="sxs-lookup"><span data-stu-id="21195-162">For some reports, it is useful to include a calculated value in the header or footer of each report; for example, a per-page sum total if the page includes numeric values.</span></span> <span data-ttu-id="21195-163">Étant donné que vous ne pouvez pas référencer les champs directement, l'expression placée dans l'en-tête ou le pied de page doit référencer le nom de l'élément du rapport (par exemple, une zone de texte) plutôt que le champ de données :</span><span class="sxs-lookup"><span data-stu-id="21195-163">Because you cannot reference the fields directly, the expression that you put in the header or footer must reference the name of the report item (for example, a text box) rather than the data field:</span></span>  
  
 `=Sum(ReportItems!Textbox1.Value)`  
  
 <span data-ttu-id="21195-164">Si la zone de texte apparaît dans une table ou dans une liste avec des lignes répétées de données, la valeur qui s'affiche dans l'en-tête ou le pied de page de la page actuelle au moment de l'exécution du rapport représente la somme de toutes les valeurs de toutes les données de l'instance `TextBox1` qui figurent dans cette table ou liste.</span><span class="sxs-lookup"><span data-stu-id="21195-164">If the text box is in a table or list that contains repeated rows of data, the value that appears in the header or footer at run time is a sum of all values of all `TextBox1` instance data in the table or list for the current page.</span></span>  
  
 <span data-ttu-id="21195-165">Lors du calcul des totaux de la page, vous pouvez noter des différences de totaux lorsque vous utilisez différentes extensions de rendu pour consulter le rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-165">When calculating page totals, you can expect to see differences in the totals when you use different rendering extensions to view the report.</span></span> <span data-ttu-id="21195-166">La sortie paginée est calculée différemment pour chaque extension de rendu.</span><span class="sxs-lookup"><span data-stu-id="21195-166">Paginated output is calculated differently for each rendering extension.</span></span> <span data-ttu-id="21195-167">La même page que vous consultez au format HTML risque de montrer des totaux différents au format PDF si le montant de données sur la page PDF est différent.</span><span class="sxs-lookup"><span data-stu-id="21195-167">The same page that you view in HTML might show different totals when viewed in PDF if the amount of data on the PDF page is different.</span></span> <span data-ttu-id="21195-168">Pour plus d’informations, consultez [Comportements de rendu &#40;Générateur de rapports et SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-168">For more information, see [Rendering Behaviors &#40;Report Builder  and SSRS&#41;](rendering-behaviors-report-builder-and-ssrs.md).</span></span>  
  
### <a name="for-reports-with-multiple-datasets"></a><span data-ttu-id="21195-169">Pour les rapports contenant plusieurs datasets</span><span class="sxs-lookup"><span data-stu-id="21195-169">For Reports with Multiple Datasets</span></span>  
 <span data-ttu-id="21195-170">Pour les rapports qui contiennent plusieurs datasets, vous ne pouvez pas ajouter de champs ou d'images liées aux données directement aux en-têtes ou pieds de page.</span><span class="sxs-lookup"><span data-stu-id="21195-170">For reports with more than one dataset, you cannot add fields or data-bound images directly to a header or footer.</span></span> <span data-ttu-id="21195-171">Cependant, vous pouvez écrire une expression qui renvoie indirectement au champ ou à l'image liée aux données à utiliser dans les en-têtes ou pieds de page de votre choix.</span><span class="sxs-lookup"><span data-stu-id="21195-171">However, you can write an expression that indirectly references a field or data-bound image that you want to use in a header or footer.</span></span>  
  
 <span data-ttu-id="21195-172">Pour placer des données variables dans un en-tête ou un pied de page, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="21195-172">To put variable data in a header or footer:</span></span>  
  
-   <span data-ttu-id="21195-173">Ajoutez une zone de texte à l'en-tête ou au pied de page.</span><span class="sxs-lookup"><span data-stu-id="21195-173">Add a text box to the header or footer.</span></span>  
  
-   <span data-ttu-id="21195-174">Dans la zone de texte, écrivez l'expression permettant de générer les données variables à afficher.</span><span class="sxs-lookup"><span data-stu-id="21195-174">In the text box, write an expression that produces the variable data that you want to appear.</span></span>  
  
-   <span data-ttu-id="21195-175">Dans cette expression, insérez des références aux éléments de rapport apparaissant sur la page (vous pouvez, par exemple, référencer une zone de texte contenant des données issues d'un champ particulier).</span><span class="sxs-lookup"><span data-stu-id="21195-175">In the expression, include references to report items on the page; for example, you can reference a text box that contains data from a particular field.</span></span> <span data-ttu-id="21195-176">N'insérez pas de référence directe aux champs dans un dataset.</span><span class="sxs-lookup"><span data-stu-id="21195-176">Do not include a direct reference to fields in a dataset.</span></span> <span data-ttu-id="21195-177">Par exemple, vous ne pouvez pas utiliser l’expression `[LastName]`.</span><span class="sxs-lookup"><span data-stu-id="21195-177">For example, you cannot use the expression `[LastName]`.</span></span> <span data-ttu-id="21195-178">L'expression suivante permet d'afficher le contenu de la première instance de la zone de texte intitulée `TXT_LastName`:</span><span class="sxs-lookup"><span data-stu-id="21195-178">You can use the following expression to display the contents of the first instance of a text box named `TXT_LastName`:</span></span>  
  
     `=First(ReportItems!TXT_LastName.Value)`  
  
 <span data-ttu-id="21195-179">Vous ne pouvez pas utiliser de fonctions d'agrégation pour des champs figurant dans les en-têtes ou pieds de page du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-179">You cannot use aggregate functions on fields in the page header or footer.</span></span> <span data-ttu-id="21195-180">Vous pouvez utiliser uniquement une fonction d'agrégation pour les éléments qui apparaissent effectivement dans le corps du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-180">You can only use an aggregate function on report items in the report body.</span></span> <span data-ttu-id="21195-181">Pour plus d’informations sur les expressions couramment utilisées dans les en-têtes et pieds de page, consultez [Exemples d’expressions &#40;Générateur de rapports et SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-181">For common expressions in page headers and footers, see [Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md).</span></span>  
  
#### <a name="adding-a-data-bound-image-to-a-header-or-footer"></a><span data-ttu-id="21195-182">Ajout d'une image liée aux données à un en-tête ou à un pied de page</span><span class="sxs-lookup"><span data-stu-id="21195-182">Adding a Data-Bound Image to a Header or Footer</span></span>  
 <span data-ttu-id="21195-183">Vous pouvez utiliser des données d'image stockées dans la base de données d'en-têtes ou de pieds de page spécifiques.</span><span class="sxs-lookup"><span data-stu-id="21195-183">You can use image data stored in a database in a header or footer.</span></span> <span data-ttu-id="21195-184">Cependant, vous ne pouvez pas référencer les champs de base de données directement à partir d'un élément d'image figurant dans le rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-184">However, you cannot reference database fields from the Image report item directly.</span></span> <span data-ttu-id="21195-185">Pour ce faire, vous devez d'abord ajouter une zone de texte dans le corps du rapport et la définir sur un champ de données contenant l'image (notez que l'encodage de cette valeur doit être de type base64).</span><span class="sxs-lookup"><span data-stu-id="21195-185">Instead, you must add a text box in the body of the report and then set the text box to the data field that contains the image (note that the value must be base64 encoded).</span></span> <span data-ttu-id="21195-186">Vous pouvez masquer la zone de texte dans le corps du rapport pour éviter de montrer l'image à l'encodage base64.</span><span class="sxs-lookup"><span data-stu-id="21195-186">You can hide the text box in the body of the report to avoid showing the base64-encoded image.</span></span> <span data-ttu-id="21195-187">Vous pouvez ensuite référencer la valeur de la zone de texte masquée depuis l'élément de rapport d'image dans l'en-tête ou le pied de page de la page.</span><span class="sxs-lookup"><span data-stu-id="21195-187">Then, you can reference the value of the hidden text box from the Image report item in the page header or footer.</span></span>  
  
 <span data-ttu-id="21195-188">Imaginons, par exemple, que vous avez un rapport constitué de pages d'informations sur le produit.</span><span class="sxs-lookup"><span data-stu-id="21195-188">For example, suppose you have a report that consists of product information pages.</span></span> <span data-ttu-id="21195-189">Dans l'en-tête de chaque page, vous souhaitez afficher une photo du produit.</span><span class="sxs-lookup"><span data-stu-id="21195-189">In the header of each page, you want to display a photograph of the product.</span></span> <span data-ttu-id="21195-190">Pour imprimer une image stockée dans l’en-tête du rapport, définissez une zone de texte masquée intitulée `TXT_Photo` dans le corps du rapport qui récupère cette image à partir de la base de données, puis utilisez une expression pour lui affecter une valeur :</span><span class="sxs-lookup"><span data-stu-id="21195-190">To print a stored image in the report header, define a hidden text box named `TXT_Photo` in the body of the report that retrieves the image from the database and use an expression to give it a value:</span></span>  
  
 `=Convert.ToBase64String(Fields!Photo.Value)`  
  
 <span data-ttu-id="21195-191">Dans l’en-tête, ajoutez un élément de rapport d’image qui utilise la zone de texte `TXT_Photo` décodée afin que l’image puisse être affichée :</span><span class="sxs-lookup"><span data-stu-id="21195-191">In the header, add an Image report item which uses the `TXT_Photo` text box, decoded to show the image:</span></span>  
  
 `=Convert.FromBase64String(ReportItems!TXT_Photo.Value)`  
  
## <a name="using-headers-and-footers-to-position-text"></a><span data-ttu-id="21195-192">Utilisation d'en-têtes et de pieds de page pour positionner du texte</span><span class="sxs-lookup"><span data-stu-id="21195-192">Using Headers and Footers to Position Text</span></span>  
 <span data-ttu-id="21195-193">Vous pouvez utiliser des en-têtes et des pieds de page pour positionner du texte dans une page.</span><span class="sxs-lookup"><span data-stu-id="21195-193">You can use headers and footers to position text on a page.</span></span> <span data-ttu-id="21195-194">Imaginons, par exemple, que vous créez un rapport à envoyer aux clients.</span><span class="sxs-lookup"><span data-stu-id="21195-194">For example, suppose you are creating a report that you want to mail out to customers.</span></span> <span data-ttu-id="21195-195">Vous pouvez utiliser un en-tête ou un pied de page pour positionner l'adresse du client de manière à ce qu'elle s'affiche dans la fenêtre d'une enveloppe pliée.</span><span class="sxs-lookup"><span data-stu-id="21195-195">You can use a header or footer to position the customer address so that it appears in an envelope window when folded.</span></span>  
  
 <span data-ttu-id="21195-196">Si vous utilisez uniquement la zone de texte pour remplir un en-tête ou un pied de page, vous pouvez masquer la zone de texte dans le corps du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-196">If you are only using the text box to populate a header or footer, you can hide the text box in the report body.</span></span> <span data-ttu-id="21195-197">Le positionnement de la zone de texte dans le corps du rapport peut affecter l'affichage de la valeur sur l'en-tête ou le pied de page pour la première ou la dernière page d'un rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-197">Placement of the text box in the report body can have an effect on whether the value appears on the header or footer of the first or last page of a report.</span></span> <span data-ttu-id="21195-198">Par exemple, si le rapport couvre plusieurs pages en raison de la présence de tables, matrices ou listes, la valeur de la zone de texte masquée s'affiche sur la dernière page.</span><span class="sxs-lookup"><span data-stu-id="21195-198">For example, if you have tables, matrices, or lists that cause the report to span multiple pages, the hidden text box value appears on the last page.</span></span> <span data-ttu-id="21195-199">Si vous souhaitez un affichage sur la première page, placez la zone de texte masquée en haut du corps du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-199">If you want it to appear on the first page, place the hidden text box at the top of the report body.</span></span>  
  
## <a name="designing-reports-with-page-headers-and-footers-for-specific-renderers"></a><span data-ttu-id="21195-200">Conception de rapports à l'aide d'en-têtes et de pieds de page pour des convertisseurs spécifiques</span><span class="sxs-lookup"><span data-stu-id="21195-200">Designing Reports with Page Headers and Footers for Specific Renderers</span></span>  
 <span data-ttu-id="21195-201">Une fois le rapport traité, les données et les informations de disposition sont associées.</span><span class="sxs-lookup"><span data-stu-id="21195-201">When a report is processed, data and layout information are combined.</span></span> <span data-ttu-id="21195-202">Lorsque vous consultez un rapport, les informations associées sont passées à un convertisseur qui détermine la quantité de données qui s'affiche sur chacune des pages du rapport.</span><span class="sxs-lookup"><span data-stu-id="21195-202">When you view a report, the combined information is passed to a renderer that determines how much report data fits on each report page.</span></span>  
  
 <span data-ttu-id="21195-203">Si vous consultez un rapport stocké sur le serveur de rapports à l'aide d'un navigateur, le convertisseur HTML contrôle le contenu qui s'affiche sur les pages consultées.</span><span class="sxs-lookup"><span data-stu-id="21195-203">If you view a report on the report server using a browser, the HTML renderer controls the content on the report pages that you see.</span></span> <span data-ttu-id="21195-204">Si vous envisagez de créer des rapports dans un format autre que celui utilisé pour les afficher ou si vous souhaitez les imprimer dans un format spécifique, vous souhaiterez probablement optimiser leur disposition en fonction du convertisseur que vous envisagez d'utiliser pour leur format final.</span><span class="sxs-lookup"><span data-stu-id="21195-204">If you plan to deliver reports in a different format than you use for viewing, or if you plan to print reports in a specific format, you may want to optimize the report layout for the renderer you plan to use for the final report format.</span></span> <span data-ttu-id="21195-205">Pour plus d’informations sur la pagination des rapports, consultez [Pagination dans Reporting Services &#40;Générateur de rapports et SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-205">For more information about report pagination, see [Pagination in Reporting Services &#40;Report Builder  and SSRS&#41;](pagination-in-reporting-services-report-builder-and-ssrs.md).</span></span>  
  
### <a name="working-with-page-headers-and-footers-in-excel"></a><span data-ttu-id="21195-206">Utilisation des en-têtes et des pieds de page dans Excel</span><span class="sxs-lookup"><span data-stu-id="21195-206">Working with Page Headers and Footers in Excel</span></span>  
 <span data-ttu-id="21195-207">Lors de la définition des en-têtes et des pieds de page pour les rapports qui ciblent l'extension de rendu Excel, suivez ces directives pour maximiser les résultats :</span><span class="sxs-lookup"><span data-stu-id="21195-207">When defining page headers and footers for reports that target the Excel rendering extension, follow these guidelines to achieve best results:</span></span>  
  
-   <span data-ttu-id="21195-208">Utilisez les pieds de page pour afficher les numéros de page.</span><span class="sxs-lookup"><span data-stu-id="21195-208">Use page footers to display page numbers.</span></span>  
  
-   <span data-ttu-id="21195-209">Utilisez les en-têtes de page pour afficher les images, les titres ou un autre contenu textuel.</span><span class="sxs-lookup"><span data-stu-id="21195-209">Use page headers to display images, titles, or other text.</span></span> <span data-ttu-id="21195-210">N'insérez pas de numéros de page dans l'en-tête.</span><span class="sxs-lookup"><span data-stu-id="21195-210">Do not put page numbers in the header.</span></span>  
  
 <span data-ttu-id="21195-211">Dans Excel, la mise en page des pieds de page est limitée.</span><span class="sxs-lookup"><span data-stu-id="21195-211">In Excel, page footers have a limited layout.</span></span> <span data-ttu-id="21195-212">Si vous définissez un rapport comportant des éléments complexes dans le pied de page, son traitement ne répondra pas à vos attentes lorsqu'il sera consulté dans Excel.</span><span class="sxs-lookup"><span data-stu-id="21195-212">If you define a report that includes complex report items in the page footer, the page footer won't process as you expect when the report is viewed in Excel.</span></span>  
  
 <span data-ttu-id="21195-213">L'extension de rendu Excel peut accueillir des images et un positionnement absolu pour des éléments de rapports simples ou complexes dans l'en-tête de page.</span><span class="sxs-lookup"><span data-stu-id="21195-213">The Excel rendering extension can accommodate images and absolute positioning of simple or complex report items in the page header.</span></span> <span data-ttu-id="21195-214">Une prise en charge restreinte des numéros de pages calculés dans l'en-tête représente un effet secondaire associé à la prise en charge d'une mise en page plus élaborée de l'en-tête de page.</span><span class="sxs-lookup"><span data-stu-id="21195-214">A side effect of supporting a richer page header layout is reduced support for calculating page numbers in the header.</span></span> <span data-ttu-id="21195-215">Dans l'extension de rendu Excel, les paramètres par défaut se soldent par le calcul des numéros de pages en fonction du nombre de classeurs.</span><span class="sxs-lookup"><span data-stu-id="21195-215">In the Excel rendering extension, default settings cause page numbers to be calculated based on the number of worksheets.</span></span> <span data-ttu-id="21195-216">En fonction de votre mode de définition du rapport, vos numéros de pages risquent d'être erronés.</span><span class="sxs-lookup"><span data-stu-id="21195-216">Depending on how you define the report, this might produce erroneous page numbers.</span></span> <span data-ttu-id="21195-217">Imaginons, par exemple, que votre rapport rend un seul grand classeur qui s'imprime sur quatre pages.</span><span class="sxs-lookup"><span data-stu-id="21195-217">For example, suppose you have a report that renders as a single large worksheet that prints on four pages.</span></span> <span data-ttu-id="21195-218">Si vous insérez des informations sur les numéros de page dans l'en-tête, chaque page imprimée affichera « Page 1 de 1 » dans l'en-tête.</span><span class="sxs-lookup"><span data-stu-id="21195-218">If you include page number information in the header, each printed page will show "Page 1 of 1" in the header.</span></span>  
  
 <span data-ttu-id="21195-219">Un nombre de pages plus précis dépend des pages logiques qui mettent en corrélation les dimensions d'une page imprimée.</span><span class="sxs-lookup"><span data-stu-id="21195-219">A more accurate page count is based on logical pages that correlate to the dimensions of a printed page.</span></span> <span data-ttu-id="21195-220">Dans Excel, le pied de page utilise les numéros de pages logiques automatiquement.</span><span class="sxs-lookup"><span data-stu-id="21195-220">In Excel, the page footer uses logical page numbers automatically.</span></span> <span data-ttu-id="21195-221">Pour placer le nombre de pages logique dans l'en-tête, vous devez configurer les paramètres d'informations du dispositif en vue d'utiliser des en-têtes simples.</span><span class="sxs-lookup"><span data-stu-id="21195-221">To put the logical page count in the page header, you must configure the device information settings to use simple headers.</span></span> <span data-ttu-id="21195-222">Sachez que lorsque vous utilisez des en-têtes simples, il devient impossible de gérer une mise en page de rapport complexe dans la région de l'en-tête.</span><span class="sxs-lookup"><span data-stu-id="21195-222">Be aware that when you use simple headers, you remove the capability of handling complex report layout in the header region.</span></span>  
  
 <span data-ttu-id="21195-223">Pour plus d’informations, consultez [Exportation vers Microsoft Excel &#40;Générateur de rapports et SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="21195-223">For more information, see [Exporting to Microsoft Excel &#40;Report Builder and SSRS&#41;](../report-builder/exporting-to-microsoft-excel-report-builder-and-ssrs.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="21195-224">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="21195-224">See Also</span></span>  
 <span data-ttu-id="21195-225">[Incorporer une image dans un rapport &#40;Générateur de rapports et SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="21195-225">[Embed an Image in a Report &#40;Report Builder and SSRS&#41;](embed-an-image-in-a-report-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="21195-226">Rectangles et lignes &#40;Générateur de rapports et SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="21195-226">Rectangles and Lines &#40;Report Builder and SSRS&#41;</span></span>](rectangles-and-lines-report-builder-and-ssrs.md)  
  
  
