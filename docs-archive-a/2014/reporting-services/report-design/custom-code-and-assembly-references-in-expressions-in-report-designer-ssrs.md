---
title: Code personnalisé et références d’assembly dans les expressions du Concepteur de rapports (SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87704952"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="49e17-102">Code personnalisé et références d'assembly dans les expressions du Concepteur de rapports (SSRS)</span><span class="sxs-lookup"><span data-stu-id="49e17-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="49e17-103">Vous pouvez ajouter des références à du code personnalisé incorporé dans un rapport ou à des assemblys personnalisés que vous générez et enregistrez sur votre ordinateur et déployez sur le serveur de rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="49e17-104">L'incorporation de code convient dans le cas de constantes personnalisées, de fonctions complexes ou de fonctions utilisées plusieurs fois dans un même rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="49e17-105">Quant aux assemblys personnalisés, il est préférable de les utiliser si vous voulez centraliser du code en un emplacement unique et le partager en vue de son utilisation par plusieurs rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="49e17-106">Le code personnalisé peut inclure de nouvelles constantes personnalisées, variables, fonctions ou sous-routines.</span><span class="sxs-lookup"><span data-stu-id="49e17-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="49e17-107">Vous pouvez inclure des références en lecture seule à des collections intégrées, telles que la collection de paramètres.</span><span class="sxs-lookup"><span data-stu-id="49e17-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="49e17-108">Cependant, les fonctions personnalisées ne peuvent pas recevoir des ensembles de valeurs de données de rapport : les agrégations personnalisées ne sont notamment pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="49e17-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="49e17-109">Pour les calculs pour lesquels le temps est important qui sont évalués une fois au moment de l'exécution et qui doivent conserver la même valeur pendant le traitement du rapport, voyez s'il convient d'utiliser une variable de rapport ou une variable de groupe.</span><span class="sxs-lookup"><span data-stu-id="49e17-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="49e17-110">Pour plus d’informations, consultez [Références à des collections de variables de rapport et de groupe &#40;Générateur de rapports et SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="49e17-111">Le Concepteur de rapports est l'environnement de création recommandé pour ajouter du code personnalisé à un rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="49e17-112">Le Générateur de rapports prend en charge le traitement des rapports qui contiennent des expressions valides, ou qui incluent des références à des assemblys personnalisés sur un serveur de rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="49e17-113">Le Générateur de rapports ne permet pas d'ajouter une référence à un assembly personnalisé.</span><span class="sxs-lookup"><span data-stu-id="49e17-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="49e17-114">Sachez que la mise à niveau d'un serveur de rapports peut nécessiter des étapes supplémentaires lorsque les rapports dépendent d'assemblys personnalisés.</span><span class="sxs-lookup"><span data-stu-id="49e17-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="49e17-115">Pour plus d'informations, consultez [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a><span data-ttu-id="49e17-116">Utilisation de code personnalisé dans Générateur de rapports</span><span class="sxs-lookup"><span data-stu-id="49e17-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="49e17-117">Dans le Générateur de rapports, vous pouvez ouvrir un rapport d'un serveur de rapports qui inclut des références aux assemblys personnalisés.</span><span class="sxs-lookup"><span data-stu-id="49e17-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="49e17-118">Par exemple, vous pouvez modifier les rapports qui sont créés et déployés à l'aide du Concepteur de rapports dans [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span><span class="sxs-lookup"><span data-stu-id="49e17-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="49e17-119">Les assemblys personnalisés doivent être déployés sur le serveur de rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="49e17-120">Vous ne pouvez pas effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="49e17-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="49e17-121">Ajouter des références ou des instances de membre de classe à un rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="49e17-122">Afficher l'aperçu d'un rapport avec des références aux assemblys personnalisés en mode local.</span><span class="sxs-lookup"><span data-stu-id="49e17-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="49e17-123">Inclusion de références aux fonctions couramment utilisées</span><span class="sxs-lookup"><span data-stu-id="49e17-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="49e17-124">Utilisez la boîte de dialogue **Expression** pour consulter une liste classée par catégorie de fonctions courantes intégrées à [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="49e17-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="49e17-125">Lorsque vous développez **Fonctions communes** et cliquez sur une catégorie, le volet **Élément** affiche la liste des fonctions que vous incluez dans une expression.</span><span class="sxs-lookup"><span data-stu-id="49e17-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="49e17-126">Les fonctions courantes incluent des classes des [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> <xref:System.Convert> espaces de noms et et des fonctions de la [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] bibliothèque Runtime.</span><span class="sxs-lookup"><span data-stu-id="49e17-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="49e17-127">Pour plus de commodité, vous pouvez consulter les fonctions le plus communément utilisées dans la boîte de dialogue **Expression** , où elles sont répertoriées par catégorie : Texte, Date et heure, Math, Inspection, Flux de programme, Agrégat, Financier, Conversion et Divers.</span><span class="sxs-lookup"><span data-stu-id="49e17-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="49e17-128">Les fonctions moins souvent utilisées n'apparaissent pas dans la liste, mais peuvent cependant être utilisées dans une expression.</span><span class="sxs-lookup"><span data-stu-id="49e17-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="49e17-129">Pour utiliser une fonction intégrée, double-cliquez sur son nom dans le volet Élément.</span><span class="sxs-lookup"><span data-stu-id="49e17-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="49e17-130">Une description de la fonction s'affiche dans le volet Description et un exemple de l'appel de la fonction apparaît dans le volet d'exemple.</span><span class="sxs-lookup"><span data-stu-id="49e17-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="49e17-131">Dans le volet de code, lorsque vous tapez le nom de la fonction suivi d’une parenthèse ouvrante **(**, l’aide d’IntelliSense affiche chaque syntaxe valide pour l’appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="49e17-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="49e17-132">Par exemple, pour calculer la valeur maximale pour un champ nommé `Quantity` dans une table, ajoutez l'expression simple `=Max(` au volet du code, puis utilisez les balises actives pour consulter toutes les syntaxes valides possibles pour l'appel de la fonction.</span><span class="sxs-lookup"><span data-stu-id="49e17-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="49e17-133">Pour compléter cet exemple, tapez `=Max(Fields!Quantity.Value)`.</span><span class="sxs-lookup"><span data-stu-id="49e17-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="49e17-134">Pour plus d’informations sur chaque fonction, consultez <xref:System.Math>, <xref:System.Convert>et [Membres de la bibliothèque runtime Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="49e17-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a><span data-ttu-id="49e17-135">Inclusion de références à des fonctions moins couramment utilisées</span><span class="sxs-lookup"><span data-stu-id="49e17-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="49e17-136">Pour inclure une référence à d’autres espaces de noms CLR moins couramment utilisés, vous devez utiliser une référence complète, par exemple <xref:System.Text.StringBuilder>.</span><span class="sxs-lookup"><span data-stu-id="49e17-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="49e17-137">IntelliSense n'est pas pris en charge dans le volet du code de la boîte de dialogue **Expression** pour ces fonctions moins couramment utilisées.</span><span class="sxs-lookup"><span data-stu-id="49e17-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="49e17-138">Pour plus d'informations, consultez [Membres de la bibliothèque runtime Visual Basic](https://go.microsoft.com/fwlink/?LinkId=198941) sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="49e17-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a><span data-ttu-id="49e17-139">Inclusion de références à des assemblys externes</span><span class="sxs-lookup"><span data-stu-id="49e17-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="49e17-140">Pour inclure une référence à une classe dans un assembly externe, vous devez identifier l'assembly pour le processeur de rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="49e17-141">Utilisez la page **Références** de la boîte de dialogue **Propriétés du rapport** pour spécifier le nom complet de l'assembly à ajouter au rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="49e17-142">Dans votre expression, vous devez utiliser le nom complet de la classe dans l'assembly.</span><span class="sxs-lookup"><span data-stu-id="49e17-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="49e17-143">Les classes dans un assembly externe n'apparaissent pas dans la boîte de dialogue **Expression** ; vous devez fournir le nom correct de la classe.</span><span class="sxs-lookup"><span data-stu-id="49e17-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="49e17-144">Un nom complet comprend l'espace de noms, le nom de la classe et le nom du membre.</span><span class="sxs-lookup"><span data-stu-id="49e17-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a><span data-ttu-id="49e17-145">Inclure du code incorporé</span><span class="sxs-lookup"><span data-stu-id="49e17-145">Including Embedded Code</span></span>  
 <span data-ttu-id="49e17-146">Pour ajouter du code incorporé à un rapport, utilisez l'onglet Code de la boîte de dialogue **Propriétés du rapport** .</span><span class="sxs-lookup"><span data-stu-id="49e17-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="49e17-147">Le bloc de code que vous créez peut contenir plusieurs méthodes.</span><span class="sxs-lookup"><span data-stu-id="49e17-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="49e17-148">Les méthodes du code incorporé doivent être écrites dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] et doivent être basées sur une instance.</span><span class="sxs-lookup"><span data-stu-id="49e17-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="49e17-149">Le processeur de rapports ajoute automatiquement des références pour les espaces de noms System.Convert et System.Math.</span><span class="sxs-lookup"><span data-stu-id="49e17-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="49e17-150">Utilisez la page **Références** de la boîte de dialogue **Propriétés du rapport** pour ajouter des références d'assembly supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="49e17-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="49e17-151">Pour plus d’informations, consultez [Ajouter une référence d’assembly à un rapport &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="49e17-152">Les méthodes du code incorporé sont disponibles par l'intermédiaire d'un membre `Code` globalement défini.</span><span class="sxs-lookup"><span data-stu-id="49e17-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="49e17-153">Pour y accéder, vous devez faire référence au membre `Code` et au nom de la méthode.</span><span class="sxs-lookup"><span data-stu-id="49e17-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="49e17-154">L'exemple ci-dessous appelle la méthode `ToUSD`, qui convertit la valeur du champ `StandardCost` en une valeur exprimée en dollars :</span><span class="sxs-lookup"><span data-stu-id="49e17-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="49e17-155">Pour faire référence à des collections intégrées dans votre code personnalisé, incluez une référence à l'objet `Report` intégré :</span><span class="sxs-lookup"><span data-stu-id="49e17-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="49e17-156">Les exemples ci-dessous indiquent comment définir des variables et des constantes personnalisées.</span><span class="sxs-lookup"><span data-stu-id="49e17-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="49e17-157">Bien que les constantes personnalisées n’apparaissent pas dans la catégorie **Constantes** de la boîte de dialogue **Expression** (qui affiche uniquement les constantes intégrées), vous pouvez leur ajouter des références à partir de n’importe quelle expression, comme le montrent les exemples suivants.</span><span class="sxs-lookup"><span data-stu-id="49e17-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="49e17-158">Dans une expression, une constante personnalisée est traitée comme une valeur de type `Variant`.</span><span class="sxs-lookup"><span data-stu-id="49e17-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="49e17-159">L'exemple suivant inclut la référence au code et l'implémentation de code de la fonction `FixSpelling`, qui substitue le texte `"Bicycle"` à toutes les occurrences du texte « Bike » dans le champ `SubCategory`.</span><span class="sxs-lookup"><span data-stu-id="49e17-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="49e17-160">Le code suivant, lorsqu'il est incorporé dans un bloc de code de définition de rapport, affiche une implémentation de la méthode `FixSpelling`.</span><span class="sxs-lookup"><span data-stu-id="49e17-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="49e17-161">Cet exemple montre comment utiliser une référence qualifiée complète à la [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` classe.</span><span class="sxs-lookup"><span data-stu-id="49e17-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="49e17-162">Pour plus d’informations sur les collections d’objets intégrées et leur initialisation, consultez [Références à des champs Globals et Users prédéfinis &#40;Générateur de rapports et SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) et [Initialisation d’objets Assembly personnalisés](../custom-assemblies/initializing-custom-assembly-objects.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a><span data-ttu-id="49e17-163">Inclusion de références à des paramètres à partir du code</span><span class="sxs-lookup"><span data-stu-id="49e17-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="49e17-164">Vous pouvez référencer la collection globale de paramètres via du code personnalisé dans un bloc de code de la définition de rapport ou dans un assembly personnalisé que vous fournissez.</span><span class="sxs-lookup"><span data-stu-id="49e17-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="49e17-165">La collection de paramètres est en lecture seule et ne possède aucun itérateur public.</span><span class="sxs-lookup"><span data-stu-id="49e17-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="49e17-166">Vous ne pouvez pas utiliser une [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construction pour parcourir la collection.</span><span class="sxs-lookup"><span data-stu-id="49e17-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="49e17-167">Vous devez connaître le nom du paramètre défini dans la définition de rapport pour pouvoir ensuite le référencer dans votre code.</span><span class="sxs-lookup"><span data-stu-id="49e17-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="49e17-168">Cependant, vous pouvez effectuer une itération dans toutes les valeurs d'un paramètre à valeurs multiples.</span><span class="sxs-lookup"><span data-stu-id="49e17-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="49e17-169">Le tableau suivant présente des exemples du référencement de la collection `Parameters` intégrée à partir du code personnalisé :</span><span class="sxs-lookup"><span data-stu-id="49e17-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="49e17-170">Description</span><span class="sxs-lookup"><span data-stu-id="49e17-170">Description</span></span>|<span data-ttu-id="49e17-171">Référence dans une expression</span><span class="sxs-lookup"><span data-stu-id="49e17-171">Reference in Expression</span></span>|<span data-ttu-id="49e17-172">Définition de code personnalisé</span><span class="sxs-lookup"><span data-stu-id="49e17-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="49e17-173">Transmission de l'intégralité de la collection globale de paramètres au code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="49e17-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="49e17-174">Cette fonction retourne la valeur d'un paramètre de rapport spécifique *MyParameter*.</span><span class="sxs-lookup"><span data-stu-id="49e17-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="49e17-175">Transmission d'un seul paramètre au code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="49e17-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="49e17-176">Cet exemple retourne la valeur du paramètre transmis.</span><span class="sxs-lookup"><span data-stu-id="49e17-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="49e17-177">Si le paramètre est un paramètre à valeurs multiples, la chaîne de retour est une concaténation de toutes les valeurs.</span><span class="sxs-lookup"><span data-stu-id="49e17-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a><span data-ttu-id="49e17-178">Intégration de références à du code d’assemblys personnalisés</span><span class="sxs-lookup"><span data-stu-id="49e17-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="49e17-179">Pour utiliser un assembly personnalisé dans un rapport, vous devez créer l'assembly, le rendre accessible au Concepteur de rapports, ajouter une référence à l'assembly dans le rapport et utiliser une expression dans le rapport qui fait référence aux méthodes contenues dans cet assembly.</span><span class="sxs-lookup"><span data-stu-id="49e17-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="49e17-180">Lorsque le rapport est déployé sur le serveur de rapports, vous devez également déployer l'assembly personnalisé sur le serveur de rapports.</span><span class="sxs-lookup"><span data-stu-id="49e17-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="49e17-181">Pour plus d’informations sur la création d’un assembly personnalisé et sur la façon de le rendre disponible pour [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], consultez [Utilisation d’assemblys personnalisés avec des rapports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="49e17-182">Pour faire référence à du code personnalisé dans une expression, vous devez appeler le membre d'une classe au sein de l'assembly.</span><span class="sxs-lookup"><span data-stu-id="49e17-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="49e17-183">La procédure pour ce faire dépend du type de méthode, à savoir statique ou basée sur une instance.</span><span class="sxs-lookup"><span data-stu-id="49e17-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="49e17-184">Les méthodes statiques d'un assembly personnalisé sont disponibles de façon globale dans le rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="49e17-185">Elles sont accessibles dans les expressions en spécifiant l'espace de noms, la classe et le nom de la méthode.</span><span class="sxs-lookup"><span data-stu-id="49e17-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="49e17-186">L’exemple suivant appelle la méthode `ToGBP` , qui convertit la valeur de la valeur **StandardCost** du dollar en livres sterling :</span><span class="sxs-lookup"><span data-stu-id="49e17-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="49e17-187">Les méthodes basées sur des instances sont disponibles par l'intermédiaire d'un membre `Code` globalement défini.</span><span class="sxs-lookup"><span data-stu-id="49e17-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="49e17-188">Vous pouvez y accéder en faisant référence au membre `Code`, suivi du nom de l'instance et de la méthode.</span><span class="sxs-lookup"><span data-stu-id="49e17-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="49e17-189">L’exemple suivant appelle la méthode d’instance `ToEUR` , qui convertit la valeur de **StandardCost** de dollar en euro :</span><span class="sxs-lookup"><span data-stu-id="49e17-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="49e17-190">Dans le Concepteur de rapports, un assembly personnalisé est chargé une fois et il n'est pas déchargé tant que vous ne fermez pas [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="49e17-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="49e17-191">Si vous affichez un aperçu d'un rapport, modifiez un assembly personnalisé utilisé dans ce rapport, puis affichez à nouveau l'aperçu, vos modifications n'apparaissent pas dans ce deuxième aperçu.</span><span class="sxs-lookup"><span data-stu-id="49e17-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="49e17-192">Pour recharger l'assembly, fermez et rouvrez [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] , puis affichez l'aperçu du rapport.</span><span class="sxs-lookup"><span data-stu-id="49e17-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="49e17-193">Pour plus d'informations sur l'accès à votre code, consultez [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="49e17-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a><span data-ttu-id="49e17-194">Passage de collections intégrées dans les assemblys personnalisés</span><span class="sxs-lookup"><span data-stu-id="49e17-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="49e17-195">Si vous voulez transmettre des collections intégrées, telles que les collections *Globals* ou *Parameters* , dans un assembly personnalisé pour le traitement, vous devez ajouter une référence d’assembly dans votre projet de code au niveau de l’assembly qui définit les collections intégrées, et vous devez accéder à l’espace de noms correct.</span><span class="sxs-lookup"><span data-stu-id="49e17-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="49e17-196">Selon que vous développez l'assembly personnalisé pour un rapport exécuté sur un serveur de rapports (rapport du serveur) ou un rapport exécuté localement dans une application .NET. (rapport local), l'assembly que vous devez référencer est différent.</span><span class="sxs-lookup"><span data-stu-id="49e17-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="49e17-197">Voir les détails ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="49e17-197">See below for details.</span></span>  
  
-   <span data-ttu-id="49e17-198">**Espace de noms :** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="49e17-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="49e17-199">**Assembly (rapport local) :** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="49e17-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="49e17-200">**Assembly (rapport du serveur) :** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="49e17-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="49e17-201">Comme le contenu des collections *Fields* et *ReportItems* peut changer dynamiquement pendant l’exécution, vous ne devriez pas les conserver entre les appels à l’assembly personnalisé (par exemple, dans une variable membre).</span><span class="sxs-lookup"><span data-stu-id="49e17-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="49e17-202">La même recommandation s'applique généralement à toutes les collections intégrées.</span><span class="sxs-lookup"><span data-stu-id="49e17-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="49e17-203">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="49e17-203">See Also</span></span>  
 <span data-ttu-id="49e17-204">[Ajouter du code à un rapport &#40;&#41;SSRS](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="49e17-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="49e17-205">[Utilisation d’assemblys personnalisés avec des rapports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="49e17-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="49e17-206">[Ajouter une référence d’assembly à un rapport &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="49e17-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="49e17-207">[Didacticiels de Reporting Services &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="49e17-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="49e17-208">[Exemples d’expressions &#40;Générateur de rapports et SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="49e17-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="49e17-209">Exemples de rapports (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="49e17-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
