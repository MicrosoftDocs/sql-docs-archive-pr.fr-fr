---
title: Références à la collection Fields d’un dataset (Générateur de rapports et SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 006c6bd3-d776-4c20-9092-32e40688ac49
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 9e4140c35f8035e3ac8fae37aefb9d7f2afcaecc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87613333"
---
# <a name="dataset-fields-collection-references-report-builder-and-ssrs"></a><span data-ttu-id="84299-102">Références à une collection de champs de dataset (Générateur de rapports et SSRS)</span><span class="sxs-lookup"><span data-stu-id="84299-102">Dataset Fields Collection References (Report Builder and SSRS)</span></span>
  <span data-ttu-id="84299-103">Chaque dataset d’un rapport contient une collection Fields.</span><span class="sxs-lookup"><span data-stu-id="84299-103">Each dataset in a report contains one Fields collection.</span></span> <span data-ttu-id="84299-104">La collection Fields comprend l’ensemble de champs spécifiés par la requête de dataset, ainsi que tous les champs calculés supplémentaires que vous créez.</span><span class="sxs-lookup"><span data-stu-id="84299-104">The Fields collection is the set of fields specified by the dataset query plus any additional calculated fields that you create.</span></span> <span data-ttu-id="84299-105">Après avoir créé un dataset, la collection de champs apparaît dans le volet **Données du rapport** .</span><span class="sxs-lookup"><span data-stu-id="84299-105">After you create a dataset, the field collection appears in the **Report Data** pane.</span></span>  
  
 <span data-ttu-id="84299-106">Une référence de champ simple dans une expression s'affiche sur l'aire de conception comme une expression simple.</span><span class="sxs-lookup"><span data-stu-id="84299-106">A simple field reference in an expression displays on the design surface as a simple expression.</span></span> <span data-ttu-id="84299-107">Par exemple, lorsque vous faites glisser le champ `Sales` du volet des données de rapport vers une cellule de table sur l'aire de conception, `[Sales]` s'affiche.</span><span class="sxs-lookup"><span data-stu-id="84299-107">For example, when you drag the field `Sales` from the Report Data pane to a table cell on the design surface, `[Sales]` is displayed.</span></span> <span data-ttu-id="84299-108">Cela représente l’expression sous-jacente `=Fields!Sales.Value` définie sur la propriété Value de la zone de texte.</span><span class="sxs-lookup"><span data-stu-id="84299-108">This represents the underlying expression `=Fields!Sales.Value` that is set on the text box Value property.</span></span> <span data-ttu-id="84299-109">Lorsque le rapport s'exécute, le processeur de rapports évalue cette expression et affiche les données effectives de la source de données dans la zone de texte dans la cellule de table.</span><span class="sxs-lookup"><span data-stu-id="84299-109">When the report runs, the report processor evaluates this expression and displays the actual data from the data source in the text box in the table cell.</span></span> <span data-ttu-id="84299-110">Pour plus d’informations, consultez [Expressions &#40;Générateur de rapports et SSRS&#41;](expressions-report-builder-and-ssrs.md) et [Collection Fields d’un dataset &#40;Générateur de rapports et SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="84299-110">For more, see [Expressions &#40;Report Builder and SSRS&#41;](expressions-report-builder-and-ssrs.md) and [Dataset Fields Collection &#40;Report Builder and SSRS&#41;](../report-data/dataset-fields-collection-report-builder-and-ssrs.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="displaying-the-field-collection-for-a-dataset"></a><span data-ttu-id="84299-111">Affichage de la collection de champs pour un dataset</span><span class="sxs-lookup"><span data-stu-id="84299-111">Displaying the Field Collection for a Dataset</span></span>  
 <span data-ttu-id="84299-112">Pour afficher les valeurs individuelles pour une collection de champs, faites glisser chaque champ vers une ligne de détails du tableau et exécutez le rapport.</span><span class="sxs-lookup"><span data-stu-id="84299-112">To display the individual values for a field collection, drag each field to a table detail row and run the report.</span></span> <span data-ttu-id="84299-113">Les références de la ligne de détails d'une région de données de table ou de liste affichent une valeur pour chaque ligne du dataset.</span><span class="sxs-lookup"><span data-stu-id="84299-113">References from the detail row of a table or list data region display a value for each row in the dataset.</span></span>  
  
 <span data-ttu-id="84299-114">Pour afficher des valeurs résumées pour un champ, faites glisser chaque champ numérique vers la zone de données d'une matrice.</span><span class="sxs-lookup"><span data-stu-id="84299-114">To display summarized values for a field, drag each numeric field to the data area of a matrix.</span></span> <span data-ttu-id="84299-115">La fonction d'agrégation par défaut pour la ligne des totaux est Sum, par exemple `=Sum(Fields!Sales.Value)`.</span><span class="sxs-lookup"><span data-stu-id="84299-115">The default aggregate function for the total row is Sum, for example, `=Sum(Fields!Sales.Value)`.</span></span> <span data-ttu-id="84299-116">Vous pouvez modifier la fonction par défaut pour calculer des totaux différents.</span><span class="sxs-lookup"><span data-stu-id="84299-116">You can change the default function in order to calculate different totals.</span></span> <span data-ttu-id="84299-117">Pour plus d’informations, consultez [Informations de référence sur les fonctions d’agrégation &#40;Générateur de rapports et SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="84299-117">For more information, see [Aggregate Functions Reference &#40;Report Builder and SSRS&#41;](report-builder-functions-aggregate-functions-reference.md).</span></span>  
  
 <span data-ttu-id="84299-118">Pour afficher des valeurs résumées pour une collection de champs dans une zone de texte directement sur l'aire de conception (n'appartenant à aucune région de données), vous devez spécifier le nom du dataset comme une étendue pour la fonction d'agrégation.</span><span class="sxs-lookup"><span data-stu-id="84299-118">To display summarized values for a field collection in a text box directly on the design surface (not part of a data region), you must specify the dataset name as a scope for the aggregate function.</span></span> <span data-ttu-id="84299-119">Par exemple, pour un dataset nommé `SalesData`, l’expression suivante spécifie le total de toutes les valeurs pour le champ `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span><span class="sxs-lookup"><span data-stu-id="84299-119">For example, for a dataset named `SalesData`, the following expression specifies the total of all values for the field `Sales`: `=Sum(Fields!Sales,"SalesData")`.</span></span>  
  
 <span data-ttu-id="84299-120">Lorsque vous utilisez la boîte de dialogue **Expression** pour définir une référence de champ simple, vous pouvez sélectionner la collection Fields dans le volet Catégorie et afficher la liste des champs disponibles dans le volet **Champ** .</span><span class="sxs-lookup"><span data-stu-id="84299-120">When you use the **Expression** dialog box to define a simple field reference, you can select the Fields collection in the Category pane and see the list of available fields in the **Field** pane.</span></span> <span data-ttu-id="84299-121">Chaque champ a plusieurs propriétés, notamment Value et IsMissing.</span><span class="sxs-lookup"><span data-stu-id="84299-121">Each field has several properties, including Value and IsMissing.</span></span> <span data-ttu-id="84299-122">Les propriétés restantes sont des propriétés de champ étendues prédéfinies qui peuvent être disponibles pour le dataset en fonction du type de source de données.</span><span class="sxs-lookup"><span data-stu-id="84299-122">The remaining properties are predefined extended field properties that may be available to the dataset depending on the data source type.</span></span>  
  
### <a name="detecting-nulls-for-a-dataset-field"></a><span data-ttu-id="84299-123">Détection de valeurs Null pour un champ de dataset</span><span class="sxs-lookup"><span data-stu-id="84299-123">Detecting Nulls for a Dataset Field</span></span>  
 <span data-ttu-id="84299-124">Pour détecter une valeur de champ Null (`Nothing` dans [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), vous pouvez utiliser la fonction `IsNothing`.</span><span class="sxs-lookup"><span data-stu-id="84299-124">To detect a field value that is null (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]), you can use the function `IsNothing`.</span></span> <span data-ttu-id="84299-125">Lorsqu'elle est placée dans une zone de texte dans la ligne Détails d'un tableau, l'expression suivante teste le champ `MiddleName` et substitue le texte « No Middle Name » lorsque la valeur est Null, et la valeur de champ elle-même lorsque la valeur n'est pas Null :</span><span class="sxs-lookup"><span data-stu-id="84299-125">When placed in a text box in a table details row, the following expression tests the field `MiddleName` and substitutes the text "No Middle Name" when the value is null, and the field value itself when the value is not null:</span></span>  
  
 `=IIF(IsNothing(Fields!MiddleName.Value),"No Middle Name",Fields!MiddleName.Value)`  
  
### <a name="detecting-missing-fields-for-dynamic-queries-at-run-time"></a><span data-ttu-id="84299-126">Détection de champs manquants pour les requêtes dynamiques au moment de l'exécution</span><span class="sxs-lookup"><span data-stu-id="84299-126">Detecting Missing Fields for Dynamic Queries at Run Time</span></span>  
 <span data-ttu-id="84299-127">Par défaut, les éléments de la collection Fields disposent de deux propriétés : Value et IsMissing.</span><span class="sxs-lookup"><span data-stu-id="84299-127">By default, items in the Fields collection have two properties: Value and IsMissing.</span></span> <span data-ttu-id="84299-128">La propriété IsMissing indique si un champ défini pour un dataset au moment de la conception figure dans les champs récupérés au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="84299-128">The IsMissing property indicates whether a field that is defined for a dataset at design time is contained in the fields retrieved at run time.</span></span> <span data-ttu-id="84299-129">Par exemple, votre requête peut appeler une procédure stockée dans laquelle le jeu de résultats varie avec un paramètre d’entrée, ou votre requête peut être `SELECT * FROM` *\<table>* l’emplacement où la définition de la table a été modifiée.</span><span class="sxs-lookup"><span data-stu-id="84299-129">For example, your query might call a stored procedure in which the result set varies with an input parameter, or your query might be `SELECT * FROM` *\<table>* where the table definition changed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="84299-130">IsMissing détecte les modifications du schéma de dataset entre le moment de la conception et celui de l’exécution pour tout type de source de données.</span><span class="sxs-lookup"><span data-stu-id="84299-130">IsMissing detects changes in the dataset schema between design time and run time for any type of data source.</span></span> <span data-ttu-id="84299-131">IsMissing ne peut pas être utilisé pour détecter des membres vides dans un cube multidimensionnel et n’est pas lié aux concepts de langage de requête MDX de `EMPTY` et `NON EMPTY` .</span><span class="sxs-lookup"><span data-stu-id="84299-131">IsMissing cannot be used to detect empty members in a multidimensional cube and is not related to the MDX query language concepts of `EMPTY` and `NON EMPTY`.</span></span>  
  
 <span data-ttu-id="84299-132">Vous pouvez tester la propriété IsMissing dans le code personnalisé pour déterminer si un champ est présent dans le jeu de résultats.</span><span class="sxs-lookup"><span data-stu-id="84299-132">You can test the IsMissing property in custom code to determine if a field is present in the result set.</span></span> <span data-ttu-id="84299-133">Vous ne pouvez pas tester sa présence à l'aide d'une expression avec un appel de fonction [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)], par exemple `IIF` ou `SWITCH`, car [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] évalue tous les paramètres dans l'appel à la fonction, ce qui provoque une erreur lorsque la référence au champ manquant est évaluée.</span><span class="sxs-lookup"><span data-stu-id="84299-133">You cannot test for its presence using an expression with a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] function call such as `IIF` or `SWITCH`, because [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] evaluates all parameters in the call to the function, which results in an error when the reference to the missing is evaluated.</span></span>  
  
#### <a name="example-for-controlling-the-visibility-of-a-dynamic-column-for-a-missing-field"></a><span data-ttu-id="84299-134">Exemple de contrôle de la visibilité d'une colonne dynamique pour un champ manquant</span><span class="sxs-lookup"><span data-stu-id="84299-134">Example for Controlling the Visibility of a Dynamic Column for a Missing Field</span></span>  
 <span data-ttu-id="84299-135">Pour définir une expression qui contrôle la visibilité d’une colonne qui affiche un champ dans un dataset, vous devez d’abord définir une fonction de code personnalisé qui retourne une valeur booléenne si le champ manque.</span><span class="sxs-lookup"><span data-stu-id="84299-135">To set an expression that controls the visibility of a column that displays a field in a dataset, you must first define a custom code function that returns a Boolean value based on whether the field is missing.</span></span> <span data-ttu-id="84299-136">Par exemple, la fonction de code personnalisé suivante retourne la valeur True si le champ manque et la valeur False si le champ existe.</span><span class="sxs-lookup"><span data-stu-id="84299-136">For example, the following custom code function returns true if the field is missing and false if the field exists.</span></span>  
  
```  
Public Function IsFieldMissing(field as Field) as Boolean  
 If (field.IsMissing) Then  
 Return True  
  Else   
  Return False  
 End If  
End Function  
```  
  
 <span data-ttu-id="84299-137">Pour utiliser cette fonction pour contrôler la visibilité d’une colonne, affectez l’expression suivante à la propriété Hidden de la colonne :</span><span class="sxs-lookup"><span data-stu-id="84299-137">To use this function to control visibility of a column, set the Hidden property of the column to the following expression:</span></span>  
  
 `=Code.IsFieldMissing(Fields!FieldName)`  
  
 <span data-ttu-id="84299-138">La colonne est masquée lorsque le champ n'existe pas.</span><span class="sxs-lookup"><span data-stu-id="84299-138">The column is hidden when the field does not exist.</span></span>  
  
#### <a name="example-for-controlling-the-text-box-value-for-a-missing-field"></a><span data-ttu-id="84299-139">Exemple de contrôle de la valeur de zone de texte pour un champ manquant</span><span class="sxs-lookup"><span data-stu-id="84299-139">Example for Controlling the Text Box Value for a Missing Field</span></span>  
 <span data-ttu-id="84299-140">Pour remplacer la valeur d’un champ manquant par un texte que vous écrivez, vous devez écrire un code personnalisé qui retourne le texte que vous pouvez utiliser à la place d’une valeur de champ lorsque le champ est manquant.</span><span class="sxs-lookup"><span data-stu-id="84299-140">To substitute text that you write in place of the value of a missing field, you must write custom code that returns text you can use in place of a field value when the field is missing.</span></span> <span data-ttu-id="84299-141">Par exemple, la fonction de code personnalisé suivante retourne la valeur du champ si le champ existe et le message que vous spécifiez comme deuxième paramètre si le champ n'existe pas :</span><span class="sxs-lookup"><span data-stu-id="84299-141">For example, the following custom code function returns the value of the field if the field exists, and the message that you specify as the second parameter if the field does not exist:</span></span>  
  
```  
Public Function IsFieldMissingThenString(field as Field, strMessage as String) as String  
 If (field.IsMissing) Then  
  Return strMessage  
 Else   
  Return field.Value  
  End If  
End Function  
```  
  
 <span data-ttu-id="84299-142">Pour utiliser cette fonction dans une zone de texte, ajoutez l’expression suivante à la propriété Value :</span><span class="sxs-lookup"><span data-stu-id="84299-142">To use this function in a text box, add the following expression to the Value property:</span></span>  
  
 `=Code.IsFieldMissingThenString(Fields!FieldName,"Missing")`  
  
 <span data-ttu-id="84299-143">La zone de texte affiche la valeur de champ ou le texte que vous avez spécifié.</span><span class="sxs-lookup"><span data-stu-id="84299-143">The text box displays either the field value or the text that you specified.</span></span>  
  
### <a name="using-extended-field-properties"></a><span data-ttu-id="84299-144">Utilisation des propriétés de champ étendues</span><span class="sxs-lookup"><span data-stu-id="84299-144">Using Extended Field Properties</span></span>  
 <span data-ttu-id="84299-145">Les propriétés de champ étendues sont des propriétés supplémentaires définies sur un champ par l'extension pour le traitement des données, qui est déterminée par le type de source de données du dataset.</span><span class="sxs-lookup"><span data-stu-id="84299-145">Extended field properties are additional properties defined on a field by the data processing extension, which is determined by the data source type for the dataset.</span></span> <span data-ttu-id="84299-146">Les propriétés de champ étendues sont prédéfinies ou spécifiques à un type de source de données.</span><span class="sxs-lookup"><span data-stu-id="84299-146">Extended field properties are predefined or specific to a data source type.</span></span> <span data-ttu-id="84299-147">Pour plus d’informations, consultez [Propriétés de champ étendues pour une base de données Analysis Services &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span><span class="sxs-lookup"><span data-stu-id="84299-147">For more information, see [Extended Field Properties for an Analysis Services Database &#40;SSRS&#41;](../report-data/extended-field-properties-for-an-analysis-services-database-ssrs.md).</span></span>  
  
 <span data-ttu-id="84299-148">Si vous spécifiez une propriété qui n'est pas prise en charge pour ce champ, l'expression prend la valeur `null` (`Nothing` dans [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="84299-148">If you specify a property that is not supported for that field, the expression evaluates to `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="84299-149">Si un fournisseur de données ne prend pas en charge les propriétés de champ étendues ou si le champ est introuvable lors de l'exécution de la requête, la valeur de la propriété est `null` (`Nothing` dans [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) pour les propriétés de type `String` et `Object`, et zéro (0) pour les propriétés de type `Integer`.</span><span class="sxs-lookup"><span data-stu-id="84299-149">If a data provider does not support extended field properties, or if the field is not found when the query is executed, the value for the property is `null` (`Nothing` in [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)]) for properties of type `String` and `Object`, and zero (0) for properties of type `Integer`.</span></span> <span data-ttu-id="84299-150">Une extension pour le traitement des données peut tirer parti des propriétés prédéfinies en optimisant les requêtes qui intègrent cette syntaxe.</span><span class="sxs-lookup"><span data-stu-id="84299-150">A data processing extension may take advantage of predefined properties by optimizing queries that include this syntax.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="84299-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="84299-151">See Also</span></span>  
 <span data-ttu-id="84299-152">[Exemples d’expressions &#40;Générateur de rapports et SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="84299-152">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="84299-153">Ajouter des données à un rapport &#40;Générateur de rapports et SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="84299-153">Add Data to a Report &#40;Report Builder and SSRS&#41;</span></span>](../report-data/report-datasets-ssrs.md)  
  
  
