---
title: Implémentation d’une classe Connection pour une extension pour le traitement des données | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services
ms.topic: reference
helpviewer_keywords:
- connections [Reporting Services], data processing extensions
- Connection class
- data processing extensions [Reporting Services], connections
ms.assetid: 7047d29e-a2c9-4e6f-ad02-635851a38ed7
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 84caac40ec8df198d5c26ed89bf35fad71ad914f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87708948"
---
# <a name="implementing-a-connection-class-for-a-data-processing-extension"></a><span data-ttu-id="a87c6-102">Implémentation d'une classe Connection pour une extension pour le traitement des données</span><span class="sxs-lookup"><span data-stu-id="a87c6-102">Implementing a Connection Class for a Data Processing Extension</span></span>
  <span data-ttu-id="a87c6-103">L’objet **Connection** représente une connexion de base de données ou une ressource similaire et représente le point de départ pour les utilisateurs d’une extension pour le traitement des données [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a87c6-103">The **Connection** object represents a database connection or similar resource and is the starting point for users of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extension.</span></span> <span data-ttu-id="a87c6-104">Il représente des connexions aux serveurs de base de données, bien que toute entité ayant un comportement similaire puisse être exposée comme un objet **Connection**.</span><span class="sxs-lookup"><span data-stu-id="a87c6-104">It represents connections to database servers, though any entity with similar behavior can be exposed as a **Connection**.</span></span>  
  
 <span data-ttu-id="a87c6-105">Pour implémenter un objet **Connection**, créez une classe qui implémente <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> et peut implémenter <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-105">To implement a **Connection** object, create a class that implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and optionally implements <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span>  
  
 <span data-ttu-id="a87c6-106">Dans votre implémentation, vous devez garantir qu'une connexion est créée et ouverte avant que les commandes puissent être exécutées.</span><span class="sxs-lookup"><span data-stu-id="a87c6-106">In your implementation, you must ensure that a connection is created and opened before commands can be executed.</span></span> <span data-ttu-id="a87c6-107">Veillez à ce que votre implémentation oblige les clients à ouvrir et fermer des connexions explicitement, plutôt qu'une implémentation qui ouvre et ferme des connexions implicitement pour le client.</span><span class="sxs-lookup"><span data-stu-id="a87c6-107">Ensure that your implementation requires clients to open and close connections explicitly, rather than having your implementation open and close connections implicitly for the client.</span></span> <span data-ttu-id="a87c6-108">Effectuez vos vérifications de la sécurité lorsque la connexion est obtenue.</span><span class="sxs-lookup"><span data-stu-id="a87c6-108">Perform your security checks when the connection is obtained.</span></span> <span data-ttu-id="a87c6-109">La nécessité d'une connexion existante pour les autres classes dans votre extension pour le traitement des données [!INCLUDE[ssRS](../../../includes/ssrs.md)] garantit ensuite que les vérifications de la sécurité sont toujours effectuées lors de l'utilisation de votre source de données.</span><span class="sxs-lookup"><span data-stu-id="a87c6-109">Requiring an existing connection for the other classes in your [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extension will then ensure that security checks are always performed when working with your data source.</span></span>  
  
 <span data-ttu-id="a87c6-110">Les propriétés de la connexion souhaitée sont représentées sous la forme d'une chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="a87c6-110">The properties of the desired connection are represented as a connection string.</span></span> <span data-ttu-id="a87c6-111">Il est fortement recommandé que les extensions pour le traitement des données [!INCLUDE[ssRS](../../../includes/ssrs.md)] prennent en charge la propriété <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> à l'aide du système de paire nom/valeur familier défini par OLE DB.</span><span class="sxs-lookup"><span data-stu-id="a87c6-111">It is strongly recommended that [!INCLUDE[ssRS](../../../includes/ssrs.md)] data processing extensions support the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection.ConnectionString%2A> property using the familiar name/value pair system defined by OLE DB.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a87c6-112">Les objets **Connection** consomment souvent beaucoup de ressources, vous pouvez donc envisager de regrouper des connexions ou faire appel à d’autres techniques pour réduire ce problème.</span><span class="sxs-lookup"><span data-stu-id="a87c6-112">**Connection** objects are often resource-intensive to obtain, so you may want to consider pooling connections or other techniques to mitigate this.</span></span>  
  
 <span data-ttu-id="a87c6-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> hérite de <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-113"><xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> inherits from <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="a87c6-114">Vous devez implémenter l'interface <xref:Microsoft.ReportingServices.Interfaces.IExtension> dans le cadre de votre implémentation de classe de connexion.</span><span class="sxs-lookup"><span data-stu-id="a87c6-114">You must implement the <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface as part of your connection class implementation.</span></span> <span data-ttu-id="a87c6-115">L'interface <xref:Microsoft.ReportingServices.Interfaces.IExtension> permet à une classe d'implémenter un nom d'extension localisé et de traiter des informations de configuration spécifiques à l'extension stockées dans le fichier de configuration [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a87c6-115">The <xref:Microsoft.ReportingServices.Interfaces.IExtension> interface enables a class to implement a localized extension name and to process extension-specific configuration information stored in the [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] configuration file.</span></span>  
  
 <span data-ttu-id="a87c6-116">Votre objet **Connection** contient la propriété <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> dans le cadre de son implémentation de <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-116">Your **Connection** object contains the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property through its implementation of <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span></span> <span data-ttu-id="a87c6-117">Il est fortement recommandé que les extensions pour le traitement des données [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] prennent en charge la propriété <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A>, afin que les utilisateurs soient confrontés à un nom localisé familier pour l'extension dans une interface utilisateur, telle que Gestionnaire de rapports.</span><span class="sxs-lookup"><span data-stu-id="a87c6-117">It is strongly recommended that [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] data processing extensions support the <xref:Microsoft.ReportingServices.Interfaces.IExtension.LocalizedName%2A> property, so that users encounter a familiar, localized name for the extension in a user interface, such as Report Manager.</span></span>  
  
 <span data-ttu-id="a87c6-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> permet également à votre objet **Connection** d’extraire et traiter les données de configuration personnalisées stockées dans le fichier RSReportServer.config.</span><span class="sxs-lookup"><span data-stu-id="a87c6-118"><xref:Microsoft.ReportingServices.Interfaces.IExtension> also enables your **Connection** object to retrieve and process custom configuration data stored in the RSReportServer.config file.</span></span> <span data-ttu-id="a87c6-119">Pour plus d'informations sur le traitement des données de configuration personnalisées, consultez la méthode <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-119">For more information about processing custom configuration data, see the <xref:Microsoft.ReportingServices.Interfaces.IExtension.SetConfiguration%2A> method.</span></span>  
  
 <span data-ttu-id="a87c6-120">La classe qui implémente <xref:Microsoft.ReportingServices.Interfaces.IExtension> n'est pas déchargée de la mémoire lorsque vos classes restantes d'extension pour le traitement des données sont déchargées.</span><span class="sxs-lookup"><span data-stu-id="a87c6-120">The class that implements <xref:Microsoft.ReportingServices.Interfaces.IExtension> is not unloaded from memory when the rest of your data processing extension classes are unloaded.</span></span> <span data-ttu-id="a87c6-121">De ce fait, vous pouvez utiliser votre classe **Extension** pour stocker des informations d’état intra-connexion ou stocker des données qui peuvent être mises en cache dans la mémoire.</span><span class="sxs-lookup"><span data-stu-id="a87c6-121">Because of this, you can use your **Extension** class to store cross-connection state information or to store data that can be cached in memory.</span></span> <span data-ttu-id="a87c6-122">Votre classe **Extension** reste en mémoire durant l’exécution du serveur de rapports.</span><span class="sxs-lookup"><span data-stu-id="a87c6-122">Your **Extension** class remains in memory as long as the report server is running.</span></span>  
  
 <span data-ttu-id="a87c6-123">Vous pouvez étendre votre classe **Connection** pour inclure la prise en charge des informations d’identification dans [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] en implémentant <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-123">You can extend your **Connection** class to include support for credentials in [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] by implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>.</span></span> <span data-ttu-id="a87c6-124">Quand vous implémentez les propriétés <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A> et <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> de l’interface <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension>, vous cochez la case **Sécurité Intégrée** et activez les zones de texte **Nom d’utilisateur** et **Mot de passe** de la boîte de dialogue **Source de données** dans le Concepteur de rapports.</span><span class="sxs-lookup"><span data-stu-id="a87c6-124">When you implement the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.IntegratedSecurity%2A>, <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.UserName%2A>, and <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension.Password%2A> properties of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> interface, you enable the **Integrated Security** check box and **Username** and **Password** text boxes of the **Data Source** dialog in Report Designer.</span></span> <span data-ttu-id="a87c6-125">Cette opération permet au Générateur de rapports de stocker et d'extraire des informations d'identification pour les sources de données qui prennent en charge l'authentification.</span><span class="sxs-lookup"><span data-stu-id="a87c6-125">This enables Report Designer to store and retrieve credentials for data sources that support authentication.</span></span> <span data-ttu-id="a87c6-126">Les informations d'identification sont stockées de manière sécurisée et utilisées lors du rendu des rapports en mode aperçu.</span><span class="sxs-lookup"><span data-stu-id="a87c6-126">The credentials are stored securely and used when rendering reports in preview mode.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="a87c6-127">L'implémentation implicite de <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> nécessite d'implémenter les membres des interfaces <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> et <xref:Microsoft.ReportingServices.Interfaces.IExtension>.</span><span class="sxs-lookup"><span data-stu-id="a87c6-127">Implementing <xref:Microsoft.ReportingServices.DataProcessing.IDbConnectionExtension> implicitly requires you to implement the members of the <xref:Microsoft.ReportingServices.DataProcessing.IDbConnection> and <xref:Microsoft.ReportingServices.Interfaces.IExtension> interfaces.</span></span>  
>   
>  <span data-ttu-id="a87c6-128">Pour un exemple d’implémentation de la classe **Connection**, consultez [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889) (Exemples Reporting Services pour le produit SQL Server).</span><span class="sxs-lookup"><span data-stu-id="a87c6-128">For a sample **Connection** class implementation, see [SQL Server Reporting Services Product Samples](https://go.microsoft.com/fwlink/?LinkId=177889).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a87c6-129">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a87c6-129">See Also</span></span>  
 <span data-ttu-id="a87c6-130">[Extensions Reporting Services](../reporting-services-extensions.md) </span><span class="sxs-lookup"><span data-stu-id="a87c6-130">[Reporting Services Extensions](../reporting-services-extensions.md) </span></span>  
 <span data-ttu-id="a87c6-131">[Implémentation d’une extension pour le traitement des données](implementing-a-data-processing-extension.md) </span><span class="sxs-lookup"><span data-stu-id="a87c6-131">[Implementing a Data Processing Extension](implementing-a-data-processing-extension.md) </span></span>  
 [<span data-ttu-id="a87c6-132">Bibliothèque d'extensions Reporting Services</span><span class="sxs-lookup"><span data-stu-id="a87c6-132">Reporting Services Extension Library</span></span>](../reporting-services-extension-library.md)  
  
  
