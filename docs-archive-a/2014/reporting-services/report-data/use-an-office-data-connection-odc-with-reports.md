---
title: Utiliser une connexion de données Office (. odc) avec les rapports (Reporting Services en mode intégré SharePoint) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- Office Data Connection (.odc) files
- SharePoint integration [Reporting Services], shared data sources
- .odc files
ms.assetid: e8d6896d-f886-4390-8b5d-96f0a50c250c
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: d795c46f46b45511079ac03add2d18214ac54489
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87600557"
---
# <a name="use-an-office-data-connection-odc-with-reports-reporting-services-in-sharepoint-integrated-mode"></a><span data-ttu-id="44c41-102">Utiliser une connexion de données Office (.odc) avec les rapports (Reporting Services en mode intégré SharePoint)</span><span class="sxs-lookup"><span data-stu-id="44c41-102">Use an Office Data Connection (.odc) with Reports (Reporting Services in SharePoint Integrated Mode)</span></span>
  <span data-ttu-id="44c41-103">Pour certains scénarios, vous pouvez utiliser un fichier .odc (Office Data Connection) existant pour fournir des informations de connexion à un rapport [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="44c41-103">For limited scenarios, you can use an existing Office Data Connection (.odc) file to provide connection information to a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report.</span></span> <span data-ttu-id="44c41-104">Un fichier .odc peut être utilisé à la place d’un fichier .rsds quand vous créez une source de données partagée.</span><span class="sxs-lookup"><span data-stu-id="44c41-104">An .odc file can be used in place of an .rsds file when you create a shared data source.</span></span> <span data-ttu-id="44c41-105">Le serveur de rapports utilise le fichier .odc de la même manière qu'un fichier .rsds ; il le lit pour obtenir le type de sources de données, une chaîne de connexion et les informations d'identification.</span><span class="sxs-lookup"><span data-stu-id="44c41-105">The report server uses an .odc file in the same way it uses an .rsds file; it reads the file for the data source type, a connection string, and credential information.</span></span>  
  
 <span data-ttu-id="44c41-106">Tous les fichiers .odc ne peuvent pas être utilisés avec un rapport [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="44c41-106">Not all .odc files can be used with a [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] report.</span></span> <span data-ttu-id="44c41-107">L'extension pour le traitement des données et les caractéristiques du rapport et du fichier .odc déterminent si un fichier .odc peut être utilisé :</span><span class="sxs-lookup"><span data-stu-id="44c41-107">The data processing extension and characteristics of the report and .odc file determine whether an .odc can be used:</span></span>  
  
-   <span data-ttu-id="44c41-108">Le rapport doit être conçu pour fonctionner avec un fournisseur de données OLE DB ou ODBC.</span><span class="sxs-lookup"><span data-stu-id="44c41-108">The report must be designed to work with an OLE DB or ODBC data provider.</span></span> <span data-ttu-id="44c41-109">Si vous avez utilisé une autre extension de traitement des données pour créer le rapport, le rapport ou ses requêtes peuvent inclure des fonctionnalités non prises en charge par le fournisseur de données OLE DB ou ODBC.</span><span class="sxs-lookup"><span data-stu-id="44c41-109">If you used a different data processing extension to create the report, the report or its queries might include functionality that is not supported by the OLE DB or ODBC data provider.</span></span>  
  
-   <span data-ttu-id="44c41-110">Le fichier .odc doit présenter les éléments et la structure attendus.</span><span class="sxs-lookup"><span data-stu-id="44c41-110">The .odc file must have the expected elements and structure.</span></span> <span data-ttu-id="44c41-111">Les paramètres du fournisseur de données et des informations d'identification doivent être explicitement définis dans le fichier pour que le serveur de rapports puisse les lire.</span><span class="sxs-lookup"><span data-stu-id="44c41-111">The data provider and credential settings must be set explicitly in the file so that they can be read by the report server.</span></span> <span data-ttu-id="44c41-112">La meilleure méthode pour définir ces valeurs consiste à exporter le fichier .odc avant de le télécharger vers la bibliothèque SharePoint.</span><span class="sxs-lookup"><span data-stu-id="44c41-112">The best way to set these values is to export the .odc file before uploading it to the SharePoint library.</span></span>  
  
-   <span data-ttu-id="44c41-113">Le fichier .odc doit spécifier un type de connexion OLE DB ou ODBC.</span><span class="sxs-lookup"><span data-stu-id="44c41-113">The .odc file must specify a connection type of OLE DB or ODBC.</span></span>  
  
-   <span data-ttu-id="44c41-114">Le fichier .odc doit spécifier une chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="44c41-114">The .odc file must specify a connection string.</span></span>  
  
-   <span data-ttu-id="44c41-115">Les valeurs `None`, `Stored` ou `Integrated` peuvent être affectées aux informations d'identification.</span><span class="sxs-lookup"><span data-stu-id="44c41-115">Credentials can be set to `None`, `Stored`, or `Integrated`.</span></span> <span data-ttu-id="44c41-116">Si la méthode relative aux informations d'identification a la valeur `Stored`, le serveur de rapports invite l'utilisateur à fournir ses informations d'identification au lieu d'utiliser les informations d'identification stockées.</span><span class="sxs-lookup"><span data-stu-id="44c41-116">If the credentials method is set to `Stored`, the report server will prompt the user for credentials instead of using the stored credentials.</span></span> <span data-ttu-id="44c41-117">Le serveur de rapports ne peut pas utiliser les informations d'identification stockées telles qu'elles sont définies dans le fichier .odc.</span><span class="sxs-lookup"><span data-stu-id="44c41-117">The report server cannot use stored credentials as defined in the .odc file.</span></span>  
  
-   <span data-ttu-id="44c41-118">La source de données doit contenir un schéma identique à celui utilisé pour créer le rapport.</span><span class="sxs-lookup"><span data-stu-id="44c41-118">The data source must have schema that is identical to the one used to create the report.</span></span> <span data-ttu-id="44c41-119">Si les structures de données diffèrent, le rapport ne s'exécutera pas.</span><span class="sxs-lookup"><span data-stu-id="44c41-119">If the data structures are different, the report will not run.</span></span>  
  
-   <span data-ttu-id="44c41-120">Le fichier .odc doit être créé dans [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007 (les versions antérieures du fichier .odc ne sont pas compatibles avec les fichiers de définitions de rapports).</span><span class="sxs-lookup"><span data-stu-id="44c41-120">The .odc file must be created in [!INCLUDE[msCoName](../../includes/msconame-md.md)] Office 2007 (older versions of .odc are not compatible with report definition files).</span></span>  
  
 <span data-ttu-id="44c41-121">Vous ne pouvez pas utiliser de fichiers .odc qui spécifient des connexions à des sources de données que le serveur de rapports ne peut pas traiter, même si les types de source de données .odc sont similaires à ceux pris en charge.</span><span class="sxs-lookup"><span data-stu-id="44c41-121">You cannot use .odc files that specify connections to data sources that cannot be processed on a report server, even if the .odc data source types look similar to supported data source types.</span></span> <span data-ttu-id="44c41-122">En particulier, si vous avez créé un fichier .odc dans Microsoft Excel 2007 qui récupère des données de Microsoft Access, du Web ou d'un fichier texte, vous ne pouvez pas utiliser ce fichier .odc pour fournir des données à un rapport.</span><span class="sxs-lookup"><span data-stu-id="44c41-122">Specifically, if you created an .odc file in Microsoft Excel 2007 that retrieves data from Microsoft Access, the Web, or a text file, you cannot use that .odc file to provide data to a report.</span></span>  
  
 <span data-ttu-id="44c41-123">Les rapports et les modèles du Générateur de rapports ne fonctionnent pas avec le fichier .odc.</span><span class="sxs-lookup"><span data-stu-id="44c41-123">Report Builder reports and models do not work with .odc file.</span></span> <span data-ttu-id="44c41-124">Vous ne pouvez pas utiliser un fichier .odc pour créer un modèle, ni configurer le modèle pour qu'il utilise une source de données partagée qui se lie à un fichier .odc.</span><span class="sxs-lookup"><span data-stu-id="44c41-124">You cannot use an .odc file to generate a model, and you cannot configure the model to use a shared data source that links to an .odc file.</span></span>  
  
 <span data-ttu-id="44c41-125">Si vous n'êtes pas familier des fichiers .odc, vous pouvez utiliser les instructions suivantes pour en créer un et l'exporter.</span><span class="sxs-lookup"><span data-stu-id="44c41-125">If you are not familiar with .odc files, you can use the following instructions to create and export one.</span></span> <span data-ttu-id="44c41-126">Pour créer facilement un fichier .odc pour une source de données OLE DB, un des moyens consiste à utiliser Excel 2007 et l'Assistant Connexion de données.</span><span class="sxs-lookup"><span data-stu-id="44c41-126">One easy way to create an .odc file for an OLE DB data source is to use Excel 2007 and the Data Connection Wizard.</span></span> <span data-ttu-id="44c41-127">Notez que l'Assistant ne crée pas de source de données ; une source de données externe doit être déjà définie.</span><span class="sxs-lookup"><span data-stu-id="44c41-127">Note that the wizard does not create a data source; you must have an external data source that is already defined.</span></span>  
  
 <span data-ttu-id="44c41-128">Un fichier .odc doit être utilisé uniquement s'il est totalement compatible avec le rapport et les requêtes.</span><span class="sxs-lookup"><span data-stu-id="44c41-128">An existing .odc file should only be used if it is fully compatible with the report and queries.</span></span> <span data-ttu-id="44c41-129">Si vous rencontrez des erreurs qui imposent d'importantes modifications au rapport ou au fichier .odc, vous devez créer un nouveau fichier .rsds pour le rapport.</span><span class="sxs-lookup"><span data-stu-id="44c41-129">If you run into errors that require significant modifications to either the report or to the .odc file, you should create a new .rsds file for the report.</span></span> <span data-ttu-id="44c41-130">Pour plus d’informations sur la manière de créer une source de données partagée qui utilise un fichier .rsds, consultez [Créer et gérer des sources de données partagées &#40;Reporting Services en mode intégré SharePoint&#41;](../create-manage-shared-data-sources-reporting-services-sharepoint-integrated-mode.md).</span><span class="sxs-lookup"><span data-stu-id="44c41-130">For more information about how to create a shared data source that uses an .rsds file, see [Create and Manage Shared Data Sources &#40;Reporting Services in SharePoint Integrated Mode&#41;](../create-manage-shared-data-sources-reporting-services-sharepoint-integrated-mode.md).</span></span>  
  
### <a name="to-create-and-export-an-odc-file"></a><span data-ttu-id="44c41-131">Pour créer et exporter un fichier .odc</span><span class="sxs-lookup"><span data-stu-id="44c41-131">To create and export an .odc file</span></span>  
  
1.  <span data-ttu-id="44c41-132">Démarrez Excel 2007.</span><span class="sxs-lookup"><span data-stu-id="44c41-132">Start Excel 2007.</span></span>  
  
2.  <span data-ttu-id="44c41-133">Sous l’onglet **Données** , dans le groupe **Obtenir des données externes** , cliquez sur **À partir d’autres sources**, puis sur **Provenance : Assistant Connexion de données**.</span><span class="sxs-lookup"><span data-stu-id="44c41-133">On the **Data** tab, in the **Get External Data** group, click **From Other Sources**, and then click **From Data Connection Wizard**.</span></span>  
  
3.  <span data-ttu-id="44c41-134">Sélectionnez **Autres/Avancés**, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="44c41-134">Select **Other/Advanced**, and then click **Next**.</span></span>  
  
4.  <span data-ttu-id="44c41-135">Sélectionnez **Fournisseur Microsoft OLE DB pour SQL Server**, puis cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="44c41-135">Select **Microsoft OLE DB Provider for SQL Server**, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="44c41-136">Entrez le nom du serveur (par défaut, il s'agit du nom réseau de l'ordinateur) et un compte d'utilisateur disposant d'autorisations valides sur la connexion et la base de données.</span><span class="sxs-lookup"><span data-stu-id="44c41-136">Enter the name of the server (by default, it is the network name of the computer) and a user account that has a valid login and database permissions.</span></span> <span data-ttu-id="44c41-137">Cliquez sur **Suivant**.</span><span class="sxs-lookup"><span data-stu-id="44c41-137">Click **Next**.</span></span>  
  
6.  <span data-ttu-id="44c41-138">Sélectionnez une base de données, puis cliquez sur **OK** pour fermer la boîte de dialogue **Liaison de données** .</span><span class="sxs-lookup"><span data-stu-id="44c41-138">Select a database, and then click **OK** to close the **Data Link** dialog box.</span></span>  
  
7.  <span data-ttu-id="44c41-139">La case **Connexion à une table spécifique** est cochée par défaut.</span><span class="sxs-lookup"><span data-stu-id="44c41-139">The **Connect to specific table** check box is selected by default.</span></span> <span data-ttu-id="44c41-140">Elle sert à récupérer des données d'une table particulière.</span><span class="sxs-lookup"><span data-stu-id="44c41-140">It is used to retrieve data from a specific table.</span></span> <span data-ttu-id="44c41-141">Le serveur de rapports ignore toutes les requêtes dans un fichier .odc et il n'est donc pas important que vous activiez ou non cette case à cocher.</span><span class="sxs-lookup"><span data-stu-id="44c41-141">The report server ignores all queries in an .odc file, so it does not matter whether you select or clear the check box.</span></span> <span data-ttu-id="44c41-142">Les requêtes qui extraient des données pour un rapport sont incluses dans un fichier de définition de rapport et non dans les fichiers externes.</span><span class="sxs-lookup"><span data-stu-id="44c41-142">Queries that retrieve data for a report are included in a report definition file and not in external files.</span></span>  
  
8.  <span data-ttu-id="44c41-143">Tant que la connexion est ouverte, vous pouvez en modifier les propriétés et l'exporter.</span><span class="sxs-lookup"><span data-stu-id="44c41-143">While the connection is open, you can edit properties and export it.</span></span> <span data-ttu-id="44c41-144">Dans le groupe **Connexions** sous l’onglet **Données** , cliquez sur **Propriétés**, puis sur le bouton **Propriétés de connexion** en regard du nom de la connexion.</span><span class="sxs-lookup"><span data-stu-id="44c41-144">On the **Data** tab, in the **Connections** group, click **Properties**, and then click the **Connection Properties** button next to the connection name.</span></span>  
  
9. <span data-ttu-id="44c41-145">Sous l’onglet **Définition** , cliquez sur **Exporter le fichier de connexion**.</span><span class="sxs-lookup"><span data-stu-id="44c41-145">On the **Definition** tab, click **Export Connection File**.</span></span>  
  
10. <span data-ttu-id="44c41-146">Donnez un nom au fichier, puis cliquez sur **Enregistrer**.</span><span class="sxs-lookup"><span data-stu-id="44c41-146">Enter a name for the file, and then click **Save**.</span></span> <span data-ttu-id="44c41-147">Fermez l'application et tous les fichiers ouverts.</span><span class="sxs-lookup"><span data-stu-id="44c41-147">Close the application and all open files.</span></span>  
  
### <a name="to-upload-and-use-an-odc-file"></a><span data-ttu-id="44c41-148">Pour télécharger et utiliser un fichier .odc</span><span class="sxs-lookup"><span data-stu-id="44c41-148">To upload and use an .odc file</span></span>  
  
1.  <span data-ttu-id="44c41-149">Ouvrez la bibliothèque dans laquelle télécharger le fichier de connexion.</span><span class="sxs-lookup"><span data-stu-id="44c41-149">Open the library into which you want to upload the connection file.</span></span>  
  
2.  <span data-ttu-id="44c41-150">Dans le menu **Télécharger** , cliquez sur **Télécharger un document**.</span><span class="sxs-lookup"><span data-stu-id="44c41-150">On the **Upload** menu, click **Upload document**.</span></span>  
  
3.  <span data-ttu-id="44c41-151">Cliquez sur **Parcourir**.</span><span class="sxs-lookup"><span data-stu-id="44c41-151">Click **Browse**.</span></span>  
  
4.  <span data-ttu-id="44c41-152">Sélectionnez le fichier .odc créé.</span><span class="sxs-lookup"><span data-stu-id="44c41-152">Select the .odc file you created.</span></span> <span data-ttu-id="44c41-153">Par défaut, le fichier .odc se trouve dans le dossier My Documents, dans Mes sources de données.</span><span class="sxs-lookup"><span data-stu-id="44c41-153">By default, the .odc file is in the My Documents folder, in My Data Sources.</span></span>  
  
5.  <span data-ttu-id="44c41-154">Cliquez sur **Ouvrir** pour sélectionner le fichier, puis sur **OK** pour enregistrer la sélection.</span><span class="sxs-lookup"><span data-stu-id="44c41-154">Click **Open** to select the file, click **OK** to save the selection.</span></span> <span data-ttu-id="44c41-155">La page des propriétés du nouvel élément s'ouvre automatiquement</span><span class="sxs-lookup"><span data-stu-id="44c41-155">The properties page for the new item opens automatically.</span></span>  
  
6.  <span data-ttu-id="44c41-156">Dans Type de contenu, sélectionnez **Source de données du rapport**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="44c41-156">In Content Type, select **Report Data Source**, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="44c41-157">Pointez sur un rapport.</span><span class="sxs-lookup"><span data-stu-id="44c41-157">Point to a report.</span></span>  
  
8.  <span data-ttu-id="44c41-158">Cliquez sur la flèche orientée vers le bas et sélectionnez **Gérer les sources de données**.</span><span class="sxs-lookup"><span data-stu-id="44c41-158">Click the down arrow, and select **Manage Data Sources**.</span></span>  
  
9. <span data-ttu-id="44c41-159">Cliquez sur le nom de la source de données.</span><span class="sxs-lookup"><span data-stu-id="44c41-159">Click the data source name.</span></span>  
  
10. <span data-ttu-id="44c41-160">Si le rapport utilise des informations de source de données personnalisées, cliquez sur **Partagé**.</span><span class="sxs-lookup"><span data-stu-id="44c41-160">If the report uses custom data source information, click **Shared**.</span></span>  
  
11. <span data-ttu-id="44c41-161">Dans **Lien de source de données**, cliquez sur le bouton Parcourir ( **...** ).</span><span class="sxs-lookup"><span data-stu-id="44c41-161">In **Data Source Link**, click the browse (**...**) button.</span></span>  
  
12. <span data-ttu-id="44c41-162">Sélectionnez le fichier .odc que vous venez de télécharger.</span><span class="sxs-lookup"><span data-stu-id="44c41-162">Select the .odc file you just uploaded.</span></span>  
  
13. <span data-ttu-id="44c41-163">Cliquez sur **OK** pour sélectionner le fichier, puis sur **OK** pour enregistrer les modifications.</span><span class="sxs-lookup"><span data-stu-id="44c41-163">Click **OK** to select the file, and then click **OK** to save your changes.</span></span>  
  
     <span data-ttu-id="44c41-164">Si vous appliquez cette procédure avec l'exemple de base de données et les exemples de rapports [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] , soyez conscient que seul le rapport Company Sales fonctionnera immédiatement avec un fichier .odc.</span><span class="sxs-lookup"><span data-stu-id="44c41-164">If you are trying these steps with the [!INCLUDE[ssSampleDBobject](../../includes/sssampledbobject-md.md)] sample database and sample reports, be aware that only the Company Sales report will work out-of-the-box with an .odc file.</span></span> <span data-ttu-id="44c41-165">Les autres rapports exemple contiennent des paramètres de requête et des fonctionnalités non compatibles avec le fournisseur OLE DB.</span><span class="sxs-lookup"><span data-stu-id="44c41-165">The other sample reports contain query parameters and features that do not work with the OLE DB provider.</span></span> <span data-ttu-id="44c41-166">Vous pouvez cependant les faire fonctionner avec le fournisseur OLE DB si vous les modifiez au préalable dans le Concepteur de rapports.</span><span class="sxs-lookup"><span data-stu-id="44c41-166">However, you can make the reports work with the OLE DB provider if you modify them first in Report Designer.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="44c41-167">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="44c41-167">See Also</span></span>  
 [<span data-ttu-id="44c41-168">Créer, modifier et supprimer des sources de données partagées &#40;SSRS&#41;</span><span class="sxs-lookup"><span data-stu-id="44c41-168">Create, Modify, and Delete Shared Data Sources &#40;SSRS&#41;</span></span>](create-modify-and-delete-shared-data-sources-ssrs.md)  
  
  
